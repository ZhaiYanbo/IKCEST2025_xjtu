2025-08-04 10:57:12,408	INFO worker.py:1879 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=2905377)[0m TaskRunner hostname: c9b4e48bcef9567f98037c541e0f5862-taskrole1-0, PID: 2905377
[36m(TaskRunner pid=2905377)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2905377)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2905377)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2905377)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2905377)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2905377)[0m                                                                   'extra'],
[36m(TaskRunner pid=2905377)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2905377)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2905377)[0m                                                                   'extra']},
[36m(TaskRunner pid=2905377)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2905377)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2905377)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2905377)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2905377)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2905377)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2905377)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2905377)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2905377)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=2905377)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=2905377)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=2905377)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2905377)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2905377)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=2905377)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2905377)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2905377)[0m                                  'kl_loss_coef': 0.01,
[36m(TaskRunner pid=2905377)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2905377)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2905377)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2905377)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2905377)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2905377)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2905377)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2905377)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=2905377)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2905377)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2905377)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2905377)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2905377)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2905377)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2905377)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2905377)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2905377)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=2905377)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2905377)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2905377)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2905377)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2905377)[0m                                  'ppo_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=2905377)[0m                                  'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=2905377)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2905377)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2905377)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2905377)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2905377)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2905377)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=2905377)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2905377)[0m                                  'use_torch_compile': False},
[36m(TaskRunner pid=2905377)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2905377)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=2905377)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=2905377)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2905377)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2905377)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2905377)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2905377)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2905377)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2905377)[0m                                  'override_config': {},
[36m(TaskRunner pid=2905377)[0m                                  'path': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2905377)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2905377)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2905377)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2905377)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2905377)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2905377)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2905377)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2905377)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=2905377)[0m                                     'discrete': False,
[36m(TaskRunner pid=2905377)[0m                                     'ranks': []},
[36m(TaskRunner pid=2905377)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=2905377)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2905377)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2905377)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=2905377)[0m                                                'param_offload': False,
[36m(TaskRunner pid=2905377)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=2905377)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2905377)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2905377)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2905377)[0m                                'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2905377)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2905377)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2905377)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2905377)[0m                                'use_torch_compile': False},
[36m(TaskRunner pid=2905377)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=2905377)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=2905377)[0m                                                                      'path': None},
[36m(TaskRunner pid=2905377)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2905377)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2905377)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2905377)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2905377)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2905377)[0m                                    'enable_chunked_prefill': False,
[36m(TaskRunner pid=2905377)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2905377)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=2905377)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': True,
[36m(TaskRunner pid=2905377)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=2905377)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2905377)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=2905377)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2905377)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=2905377)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2905377)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2905377)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2905377)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2905377)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2905377)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2905377)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2905377)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2905377)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=2905377)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2905377)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=2905377)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2905377)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=2905377)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2905377)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2905377)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2905377)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=2905377)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2905377)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2905377)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2905377)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2905377)[0m                                    'n': 5,
[36m(TaskRunner pid=2905377)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2905377)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2905377)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=2905377)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2905377)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=2905377)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2905377)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2905377)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=2905377)[0m                                              'token2text': False},
[36m(TaskRunner pid=2905377)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2905377)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2905377)[0m                                                   'n': 1,
[36m(TaskRunner pid=2905377)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2905377)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2905377)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2905377)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2905377)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=2905377)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2905377)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2905377)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2905377)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2905377)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2905377)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2905377)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2905377)[0m                'lam': 1.0,
[36m(TaskRunner pid=2905377)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2905377)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2905377)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2905377)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2905377)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=2905377)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2905377)[0m                            'async_save': False,
[36m(TaskRunner pid=2905377)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2905377)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2905377)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2905377)[0m             'enable': None,
[36m(TaskRunner pid=2905377)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2905377)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2905377)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2905377)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2905377)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2905377)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=2905377)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=2905377)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2905377)[0m                       'external_lib': None,
[36m(TaskRunner pid=2905377)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2905377)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=2905377)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=2905377)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=2905377)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2905377)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2905377)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=2905377)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2905377)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=2905377)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=2905377)[0m                       'override_config': {},
[36m(TaskRunner pid=2905377)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2905377)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=2905377)[0m                       'tokenizer_path': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2905377)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=2905377)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=2905377)[0m                       'use_shm': False},
[36m(TaskRunner pid=2905377)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2905377)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2905377)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2905377)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2905377)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2905377)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2905377)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2905377)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2905377)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2905377)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2905377)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2905377)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2905377)[0m             'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=2905377)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2905377)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2905377)[0m                          'discrete': False,
[36m(TaskRunner pid=2905377)[0m                          'ranks': []},
[36m(TaskRunner pid=2905377)[0m             'rollout_n': 5,
[36m(TaskRunner pid=2905377)[0m             'shuffle': False,
[36m(TaskRunner pid=2905377)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2905377)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2905377)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2905377)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2905377)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2905377)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2905377)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2905377)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=2905377)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2905377)[0m           'image_key': 'images',
[36m(TaskRunner pid=2905377)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2905377)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=2905377)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2905377)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2905377)[0m           'return_multi_modal_inputs': False,
[36m(TaskRunner pid=2905377)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2905377)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2905377)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2905377)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2905377)[0m           'shuffle': True,
[36m(TaskRunner pid=2905377)[0m           'tokenizer': None,
[36m(TaskRunner pid=2905377)[0m           'train_batch_size': 64,
[36m(TaskRunner pid=2905377)[0m           'train_files': '/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/train.parquet',
[36m(TaskRunner pid=2905377)[0m           'truncation': 'error',
[36m(TaskRunner pid=2905377)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2905377)[0m           'use_shm': False,
[36m(TaskRunner pid=2905377)[0m           'val_batch_size': None,
[36m(TaskRunner pid=2905377)[0m           'val_files': '/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/test.parquet',
[36m(TaskRunner pid=2905377)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2905377)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2905377)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=2905377)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2905377)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2905377)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2905377)[0m                   'max_length': None,
[36m(TaskRunner pid=2905377)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2905377)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2905377)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2905377)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2905377)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=2905377)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=2905377)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2905377)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=2905377)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens:   0%|          | 0/2255 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens:  44%|████▍     | 1000/2255 [00:15<00:19, 64.67 examples/s]
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens:  44%|████▍     | 1000/2255 [00:29<00:19, 64.67 examples/s]
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens:  89%|████████▊ | 2000/2255 [00:30<00:03, 65.59 examples/s]
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens: 100%|██████████| 2255/2255 [00:34<00:00, 65.63 examples/s]Filtering prompts longer than 1024 tokens: 100%|██████████| 2255/2255 [00:34<00:00, 65.49 examples/s]
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens:   0%|          | 0/100 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2905377)[0m Filtering prompts longer than 1024 tokens: 100%|██████████| 100/100 [00:01<00:00, 66.59 examples/s]Filtering prompts longer than 1024 tokens: 100%|██████████| 100/100 [00:01<00:00, 66.54 examples/s]
[36m(TaskRunner pid=2905377)[0m /gemini/user/private/table_reasoning/zhaiyanbo/verl/verl/trainer/main_ppo.py:227: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2905377)[0m   trainer = RayPPOTrainer(
[36m(TaskRunner pid=2905377)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2905377)[0m WARNING:2025-08-04 10:58:06,201:Waiting for register center actor g32Jsp_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2906983)[0m Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
[36m(WorkerDict pid=2906983)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VLForConditionalGeneration is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2906983)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2906983)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VisionTransformerPretrainedModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(TaskRunner pid=2905377)[0m                             'input_tokenizer': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2905377)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2905377)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=2905377)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=2905377)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=2905377)[0m                             'use_shm': False},
[36m(TaskRunner pid=2905377)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2905377)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2905377)[0m                                'discrete': False,
[36m(TaskRunner pid=2905377)[0m                                'ranks': []},
[36m(TaskRunner pid=2905377)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2905377)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2905377)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2905377)[0m                                      'url': None},
[36m(TaskRunner pid=2905377)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2905377)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2905377)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2905377)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2905377)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2905377)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2905377)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2905377)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2905377)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2905377)[0m              'default_local_dir': '/gemini/platform/public/NLP/model/project_model/math/ckpts/',
[36m(TaskRunner pid=2905377)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2905377)[0m              'device': 'cuda',
[36m(TaskRunner pid=2905377)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2905377)[0m              'experiment_name': 'qwen2_5_vl_3b_function_rm',
[36m(TaskRunner pid=2905377)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2905377)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2905377)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2905377)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2905377)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=2905377)[0m              'nnodes': 1,
[36m(TaskRunner pid=2905377)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=2905377)[0m                                          'level': 'level1',
[36m(TaskRunner pid=2905377)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=2905377)[0m                                          'roles': ['all'],
[36m(TaskRunner pid=2905377)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=2905377)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=2905377)[0m                                          'with_memory': False,
[36m(TaskRunner pid=2905377)[0m                                          'with_module': False,
[36m(TaskRunner pid=2905377)[0m                                          'with_npu': True,
[36m(TaskRunner pid=2905377)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=2905377)[0m              'profile_continuous_steps': False,
[36m(TaskRunner pid=2905377)[0m              'profile_steps': None,
[36m(TaskRunner pid=2905377)[0m              'project_name': 'grpo_math_0803',
[36m(TaskRunner pid=2905377)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2905377)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2905377)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2905377)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2905377)[0m              'save_freq': 10,
[36m(TaskRunner pid=2905377)[0m              'test_freq': 50,
[36m(TaskRunner pid=2905377)[0m              'total_epochs': 15,
[36m(TaskRunner pid=2905377)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2905377)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=2905377)[0m              'val_before_train': True,
[36m(TaskRunner pid=2905377)[0m              'val_only': False,
[36m(TaskRunner pid=2905377)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=2905377)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2905377)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=2905377)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2905377)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2905377)[0m                                        'kill': 'none',
[36m(TaskRunner pid=2905377)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=2905377)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2905377)[0m dataset len: 2255
[36m(TaskRunner pid=2905377)[0m filter dataset len: 2255
[36m(TaskRunner pid=2905377)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2905377)[0m dataset len: 100
[36m(TaskRunner pid=2905377)[0m filter dataset len: 100
[36m(TaskRunner pid=2905377)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2905377)[0m Size of train dataloader: 35, Size of val dataloader: 1
[36m(TaskRunner pid=2905377)[0m Total training steps: 525
[36m(TaskRunner pid=2905377)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=2906719)[0m Model config after override: Qwen2_5_VLConfig {
[36m(WorkerDict pid=2906719)[0m   "architectures": [
[36m(WorkerDict pid=2906719)[0m     "Qwen2_5_VLForConditionalGeneration"
[36m(WorkerDict pid=2906719)[0m   ],
[36m(WorkerDict pid=2906719)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2906719)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2906719)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2906719)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=2906719)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2906719)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2906719)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=2906719)[0m   "max_position_embeddings": 128000,
[36m(WorkerDict pid=2906719)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=2906719)[0m   "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2906719)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=2906719)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=2906719)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2906719)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2906719)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2906719)[0m   "rope_scaling": {
[36m(WorkerDict pid=2906719)[0m     "mrope_section": [
[36m(WorkerDict pid=2906719)[0m       16,
[36m(WorkerDict pid=2906719)[0m       24,
[36m(WorkerDict pid=2906719)[0m       24
[36m(WorkerDict pid=2906719)[0m     ],
[36m(WorkerDict pid=2906719)[0m     "rope_type": "default",
[36m(WorkerDict pid=2906719)[0m     "type": "default"
[36m(WorkerDict pid=2906719)[0m   },
[36m(WorkerDict pid=2906719)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2906719)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=2906719)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2906983)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2906983)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:05<00:05,  5.57s/it]
[36m(WorkerDict pid=2906986)[0m Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2906986)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VisionTransformerPretrainedModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=2906986)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906983)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.06s/it]
[36m(WorkerDict pid=2906986)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.23s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906985)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2906986)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  4.89s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.09s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2906989)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.25s/it]
[36m(WorkerDict pid=2906988)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2906719)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.21s/it]
[36m(WorkerDict pid=2906989)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.85s/it]
[36m(WorkerDict pid=2906719)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2906719)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=2906719)[0m   "use_cache": true,
[36m(WorkerDict pid=2906719)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2906719)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2906719)[0m   "vision_config": {
[36m(WorkerDict pid=2906719)[0m     "depth": 32,
[36m(WorkerDict pid=2906719)[0m     "fullatt_block_indexes": [
[36m(WorkerDict pid=2906719)[0m       7,
[36m(WorkerDict pid=2906719)[0m       15,
[36m(WorkerDict pid=2906719)[0m       23,
[36m(WorkerDict pid=2906719)[0m       31
[36m(WorkerDict pid=2906719)[0m     ],
[36m(WorkerDict pid=2906719)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2906719)[0m     "hidden_size": 1280,
[36m(WorkerDict pid=2906719)[0m     "in_channels": 3,
[36m(WorkerDict pid=2906719)[0m     "in_chans": 3,
[36m(WorkerDict pid=2906719)[0m     "intermediate_size": 3420,
[36m(WorkerDict pid=2906719)[0m     "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2906719)[0m     "num_heads": 16,
[36m(WorkerDict pid=2906719)[0m     "out_hidden_size": 2048,
[36m(WorkerDict pid=2906719)[0m     "patch_size": 14,
[36m(WorkerDict pid=2906719)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2906719)[0m     "spatial_patch_size": 14,
[36m(WorkerDict pid=2906719)[0m     "temporal_patch_size": 2,
[36m(WorkerDict pid=2906719)[0m     "tokens_per_second": 2,
[36m(WorkerDict pid=2906719)[0m     "window_size": 112
[36m(WorkerDict pid=2906719)[0m   },
[36m(WorkerDict pid=2906719)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2906719)[0m   "vision_start_token_id": 151652,
[36m(WorkerDict pid=2906719)[0m   "vision_token_id": 151654,
[36m(WorkerDict pid=2906719)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2906719)[0m }
[36m(WorkerDict pid=2906719)[0m 
[36m(WorkerDict pid=2906983)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2906983)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2906983)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2906983)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2906719)[0m Qwen2_5_VLForConditionalGeneration contains 3.75B parameters
[36m(WorkerDict pid=2906719)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f8c2dc8d360>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f8c2dc8d240>, transformer_layer_cls={<class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLDecoderLayer'>, <class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLVisionBlock'>})])
[36m(WorkerDict pid=2906719)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2906719)[0m Ref use_remove_padding=True
[36m(WorkerDict pid=2906719)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=2906986)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m Model config after override: Qwen2_5_VLConfig {
[36m(WorkerDict pid=2906719)[0m   "architectures": [
[36m(WorkerDict pid=2906719)[0m     "Qwen2_5_VLForConditionalGeneration"
[36m(WorkerDict pid=2906719)[0m   ],
[36m(WorkerDict pid=2906719)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2906719)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2906719)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2906719)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=2906719)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2906719)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2906719)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=2906719)[0m   "max_position_embeddings": 128000,
[36m(WorkerDict pid=2906719)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=2906719)[0m   "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2906719)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=2906719)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=2906719)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2906719)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2906719)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2906719)[0m   "rope_scaling": {
[36m(WorkerDict pid=2906719)[0m     "mrope_section": [
[36m(WorkerDict pid=2906719)[0m       16,
[36m(WorkerDict pid=2906719)[0m       24,
[36m(WorkerDict pid=2906719)[0m       24
[36m(WorkerDict pid=2906719)[0m     ],
[36m(WorkerDict pid=2906719)[0m     "rope_type": "default",
[36m(WorkerDict pid=2906719)[0m     "type": "default"
[36m(WorkerDict pid=2906719)[0m   },
[36m(WorkerDict pid=2906719)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2906719)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=2906719)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2906719)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2906719)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=2906719)[0m   "use_cache": true,
[36m(WorkerDict pid=2906719)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2906719)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2906719)[0m   "vision_config": {
[36m(WorkerDict pid=2906719)[0m     "depth": 32,
[36m(WorkerDict pid=2906719)[0m     "fullatt_block_indexes": [
[36m(WorkerDict pid=2906719)[0m       7,
[36m(WorkerDict pid=2906719)[0m       15,
[36m(WorkerDict pid=2906719)[0m       23,
[36m(WorkerDict pid=2906719)[0m       31
[36m(WorkerDict pid=2906719)[0m     ],
[36m(WorkerDict pid=2906719)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2906719)[0m     "hidden_size": 1280,
[36m(WorkerDict pid=2906719)[0m     "in_channels": 3,
[36m(WorkerDict pid=2906719)[0m     "in_chans": 3,
[36m(WorkerDict pid=2906719)[0m     "intermediate_size": 3420,
[36m(WorkerDict pid=2906719)[0m     "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2906719)[0m     "num_heads": 16,
[36m(WorkerDict pid=2906719)[0m     "out_hidden_size": 2048,
[36m(WorkerDict pid=2906719)[0m     "patch_size": 14,
[36m(WorkerDict pid=2906719)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2906719)[0m     "spatial_patch_size": 14,
[36m(WorkerDict pid=2906719)[0m     "temporal_patch_size": 2,
[36m(WorkerDict pid=2906719)[0m     "tokens_per_second": 2,
[36m(WorkerDict pid=2906719)[0m     "window_size": 112
[36m(WorkerDict pid=2906719)[0m   },
[36m(WorkerDict pid=2906719)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2906719)[0m   "vision_start_token_id": 151652,
[36m(WorkerDict pid=2906719)[0m   "vision_token_id": 151654,
[36m(WorkerDict pid=2906719)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2906719)[0m }
[36m(WorkerDict pid=2906719)[0m 
[36m(WorkerDict pid=2906989)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2906989)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2906989)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2906989)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2906719)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2906719)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2906719)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2906986)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.23s/it][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2906987)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2906987)[0m   warnings.warn(
[36m(WorkerDict pid=2906986)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  5.95s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.14s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m wandb: Tracking run with wandb version 0.20.1
[36m(TaskRunner pid=2905377)[0m wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
[36m(WorkerDict pid=2906719)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2906719)[0m Qwen2_5_VLForConditionalGeneration contains 3.75B parameters
[36m(WorkerDict pid=2906719)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f8c2dc8d360>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f8c2dc8d240>, transformer_layer_cls={<class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLDecoderLayer'>, <class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLVisionBlock'>})])
[36m(WorkerDict pid=2906719)[0m Total steps: 525, num_warmup_steps: 0
[36m(WorkerDict pid=2906719)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2906719)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=2906983)[0m WARNING 08-04 10:59:20 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2906986)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2906986)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2906986)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2906986)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2906983)[0m WARNING 08-04 10:59:21 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fa7c2fdeb30>
[36m(WorkerDict pid=2906988)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2906987)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2906986)[0m WARNING 08-04 10:59:21 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m WARNING 08-04 10:59:22 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7ed75b0d2c50>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Checkpoint tracker file does not exist: /gemini/platform/public/NLP/model/project_model/math/ckpts/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2905377)[0m Training from scratch
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(WorkerDict pid=2906983)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <answer>The answer is \boxed{D}.</answer>
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m <think>
[36m(TaskRunner pid=2905377)[0m To solve this problem, we need to understand the properties of the given geometric figures and use the given information to find the required length.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m 1. **Identify the properties of the parabola and the hyperbola:**
[36m(TaskRunner pid=2905377)[0m    - The parabola \( y^2 = 16x \) has its focus at \( (4, 0) \) and its directrix at \( x = -4 \).
[36m(TaskRunner pid=2905377)[0m    - The hyperbola \( C \) is centered at the origin and has its foci on the x-axis. Since it is an equilateral hyperbola, its standard form is \( \frac{x^2}{a^2} - \frac{y^2}{a^2} = 1 \), which simplifies to \( x^2 - y^2 = a^2 \).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m 2. **Determine the coordinates of points A and B:**
[36m(TaskRunner pid=2905377)[0m    - The points A and B are the intersections of the hyperbola and the parabola. Since the hyperbola is symmetric about the x-axis, the y-coordinates of A and B will be of opposite signs.
[36m(TaskRunner pid=2905377)[0m    - Let the coordinates of A be \( (x_1, y_1) \) and the coordinates of B be \( (x_2, y_2) \). Since A and B are on the parabola, we have \( y_1^2 = 16x_1 \) and \( y_2^2 = 16x_2 \).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m 3. **Use the distance formula:**
[36m(TaskRunner pid=2905377)[0m    - The distance between A and B is given as \( |AB| = 4\sqrt{3} \). Using the distance formula, we get:
[36m(TaskRunner pid=2905377)[0m      \[
[36m(TaskRunner pid=2905377)[0m      |AB| = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m      \]
[36m(TaskRunner pid=2905377)[0m    - Since A and B are symmetric with respect to the x-axis, \( y_1 = -y_2 \). Therefore, \( y_1^2 = y_2^2 \) and \( y_1^2 = 16x_1 \), so \( y_1 = 4\sqrt{x_1} \) and \( y_2 = -4\sqrt{x_2} \).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m 4. **Substitute and solve for \( x_1 \) and \( x_2 \):**
[36m(TaskRunner pid=2905377)[0m    - Substitute \( y_1 = 4\sqrt{x_1} \) and \( y_2 = -4\sqrt{x_2} \) into the distance formula:
[36m(TaskRunner pid=2905377)[0m      \[
[36m(TaskRunner pid=2905377)[0m      \sqrt{(x_1 - x_2)^2 + (4\sqrt{x_1} + 4\sqrt{x_2})^2} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m      \]
[36m(TaskRunner pid=2905377)[0m    - Simplify the equation:
[36m(TaskRunner pid=2905377)[0m      \[
[36m(TaskRunner pid=2905377)[0m      \sqrt{(x_1 - x_2)^2 + 16(x_1 + x_2) + 32\sqrt{x_1 x_2}} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m      \]
[36m(TaskRunner pid=2905377)[0m    - Since the hyperbola is symmetric and the points are symmetric with respect to the x-axis, we can assume \( x_1 = x_2 \). However, this is not the case here, so we need to solve the equation directly. By trial and error or solving the quadratic equation, we find that \( x_1 = 1 \) and \( x_2 = 3 \).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m 5. **Determine the length of the real axis:**
[36m(TaskRunner pid=2905377)[0m    - The length of the real axis of the hyperbola is \( 2a \). From the coordinates of A and B, we can see that the distance between the points on the hyperbola is related to the real axis length. By solving the quadratic equation or using the properties of the hyperbola, we find that \( 2a = 8 \).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Therefore, the length of the real axis of the hyperbola is \( 8 \). The answer is \(\boxed{D}\).
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 0.0
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m ("Initial validation metrics: {'val-core/grpo_convert/reward/mean@50': "
[36m(TaskRunner pid=2905377)[0m Training Progress:   0%|          | 0/525 [00:00<?, ?it/s]
[36m(WorkerDict pid=2906983)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906983)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   0%|          | 1/525 [00:57<8:25:55, 57.93s/it]
[36m(TaskRunner pid=2905377)[0m  "0.02000000074505806, 'val-aux/grpo_convert/reward/std@50': "
[36m(TaskRunner pid=2905377)[0m  "0.08104401447042495, 'val-aux/grpo_convert/reward/best@2/mean': "
[36m(TaskRunner pid=2905377)[0m  "0.03785000140592456, 'val-aux/grpo_convert/reward/best@2/std': "
[36m(TaskRunner pid=2905377)[0m  "0.10846478162110734, 'val-aux/grpo_convert/reward/worst@2/mean': "
[36m(TaskRunner pid=2905377)[0m  "0.0009500000365078449, 'val-aux/grpo_convert/reward/worst@2/std': "
[36m(TaskRunner pid=2905377)[0m  "0.01798735943508334, 'val-aux/grpo_convert/reward/best@4/mean': "
[36m(TaskRunner pid=2905377)[0m  "0.06595000244304537, 'val-aux/grpo_convert/reward/best@4/std': "
[36m(TaskRunner pid=2905377)[0m  "0.136594201252691, 'val-aux/grpo_convert/reward/worst@4/mean': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@4/std': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/best@8/mean': 0.125750004645437, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/best@8/std': 0.16752434509017364, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@8/mean': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@8/std': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/best@16/mean': 0.2061500075943768, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/best@16/std': 0.17150699872693786, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@16/mean': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@16/std': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/best@32/mean': 0.29040001060068604, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/best@32/std': 0.1308969420702974, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@32/mean': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@32/std': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-core/grpo_convert/reward/best@50/mean': 0.3303500120304525, "
[36m(TaskRunner pid=2905377)[0m  "'val-core/grpo_convert/reward/best@50/std': 0.07891654191745397, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@50/mean': 0.0, "
[36m(TaskRunner pid=2905377)[0m  "'val-aux/grpo_convert/reward/worst@50/std': 0.0}")
[36m(TaskRunner pid=2905377)[0m step:0 - val-core/grpo_convert/reward/mean@50:0.02000000074505806 - val-aux/grpo_convert/reward/std@50:0.08104401447042495 - val-aux/grpo_convert/reward/best@2/mean:0.03785000140592456 - val-aux/grpo_convert/reward/best@2/std:0.10846478162110734 - val-aux/grpo_convert/reward/worst@2/mean:0.0009500000365078449 - val-aux/grpo_convert/reward/worst@2/std:0.01798735943508334 - val-aux/grpo_convert/reward/best@4/mean:0.06595000244304537 - val-aux/grpo_convert/reward/best@4/std:0.136594201252691 - val-aux/grpo_convert/reward/worst@4/mean:0.0 - val-aux/grpo_convert/reward/worst@4/std:0.0 - val-aux/grpo_convert/reward/best@8/mean:0.125750004645437 - val-aux/grpo_convert/reward/best@8/std:0.16752434509017364 - val-aux/grpo_convert/reward/worst@8/mean:0.0 - val-aux/grpo_convert/reward/worst@8/std:0.0 - val-aux/grpo_convert/reward/best@16/mean:0.2061500075943768 - val-aux/grpo_convert/reward/best@16/std:0.17150699872693786 - val-aux/grpo_convert/reward/worst@16/mean:0.0 - val-aux/grpo_convert/reward/worst@16/std:0.0 - val-aux/grpo_convert/reward/best@32/mean:0.29040001060068604 - val-aux/grpo_convert/reward/best@32/std:0.1308969420702974 - val-aux/grpo_convert/reward/worst@32/mean:0.0 - val-aux/grpo_convert/reward/worst@32/std:0.0 - val-core/grpo_convert/reward/best@50/mean:0.3303500120304525 - val-core/grpo_convert/reward/best@50/std:0.07891654191745397 - val-aux/grpo_convert/reward/worst@50/mean:0.0 - val-aux/grpo_convert/reward/worst@50/std:0.0
[36m(TaskRunner pid=2905377)[0m step:1 - global_seqlen/min:27116 - global_seqlen/max:32495 - global_seqlen/minmax_diff:5379 - global_seqlen/balanced_min:30062 - global_seqlen/balanced_max:30063 - global_seqlen/mean:30062.25 - actor/entropy:0.8765016794204712 - actor/kl_loss:0.0005736231207265519 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.026716180518269537 - actor/pg_clipfrac:0.0006691977439913898 - actor/ppo_kl:-0.0001490838256358984 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8274219185113907 - perf/mfu/actor:0.08206206466782334 - perf/max_memory_allocated_gb:59.374821186065674 - perf/max_memory_reserved_gb:75.044921875 - perf/cpu_memory_used_gb:91.72003555297852 - actor/lr:1e-06 - training/global_step:1 - training/epoch:0 - critic/score/mean:0.06937500089406967 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.06937500089406967 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.014978451654314995 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.0954251289367676 - critic/returns/mean:-0.014978451654314995 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.0954251289367676 - response_length/mean:341.9312438964844 - response_length/max:1252.0 - response_length/min:10.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003716312348842621 - timing_s/generate_sequences:32.29133224487305 - timing_s/reshard:0.6893109083175659 - timing_s/gen:40.92035167850554 - timing_s/reward:0.07187331840395927 - timing_s/old_log_prob:1.3491323590278625 - timing_s/ref:5.03217582590878 - timing_s/adv:0.007338458672165871 - timing_s/update_actor:7.832884652540088 - timing_s/step:55.53032532520592 - timing_s/stop_profile:4.6504661440849304e-05 - timing_per_token_ms/update_actor:0.03256943780214425 - timing_per_token_ms/gen:0.37398190131884645 - timing_per_token_ms/ref:0.02092398201194513 - timing_per_token_ms/adv:3.0513595423520656e-05 - perf/total_num_tokens:240498 - perf/time_per_step:55.53032532520592 - perf/throughput:541.3663583626505
[36m(TaskRunner pid=2905377)[0m Training Progress:   0%|          | 2/525 [02:09<9:36:23, 66.12s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   1%|          | 3/525 [03:22<9:59:56, 68.96s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   1%|          | 4/525 [04:12<8:55:58, 61.72s/it]
[36m(TaskRunner pid=2905377)[0m step:2 - global_seqlen/min:29196 - global_seqlen/max:32005 - global_seqlen/minmax_diff:2809 - global_seqlen/balanced_min:30175 - global_seqlen/balanced_max:30732 - global_seqlen/mean:30245.375 - actor/entropy:0.9253813028335571 - actor/kl_loss:0.001599945593625307 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11840120181441308 - actor/pg_clipfrac:0.0015221146924886853 - actor/ppo_kl:0.0003204826640285319 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.132989153265953 - perf/mfu/actor:0.08947515644497396 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.275390625 - perf/cpu_memory_used_gb:91.8941764831543 - actor/lr:1e-06 - training/global_step:2 - training/epoch:0 - critic/score/mean:0.11281250417232513 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.11281250417232513 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04961210861802101 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.0954416990280151 - critic/returns/mean:-0.04961210861802101 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.0954416990280151 - response_length/mean:346.1812438964844 - response_length/max:2048.0 - response_length/min:10.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.563697338104248e-05 - timing_s/generate_sequences:41.78750228881836 - timing_s/reshard:0.6651643514633179 - timing_s/gen:61.99056365899742 - timing_s/reward:0.0733590442687273 - timing_s/old_log_prob:1.1659813057631254 - timing_s/ref:1.363237239420414 - timing_s/adv:0.007326791062951088 - timing_s/update_actor:7.2340429443866014 - timing_s/step:71.84791393205523 - timing_s/stop_profile:4.501454532146454e-05 - timing_per_token_ms/update_actor:0.029897310516015265 - timing_per_token_ms/gen:0.5595927319413369 - timing_per_token_ms/ref:0.005634073141019139 - timing_per_token_ms/adv:3.0280625810355666e-05 - perf/total_num_tokens:241963 - perf/time_per_step:71.84791393205523 - perf/throughput:420.9638574698535
[36m(TaskRunner pid=2905377)[0m step:3 - global_seqlen/min:28174 - global_seqlen/max:32682 - global_seqlen/minmax_diff:4508 - global_seqlen/balanced_min:30175 - global_seqlen/balanced_max:30588 - global_seqlen/mean:30227.625 - actor/entropy:0.8788672089576721 - actor/kl_loss:0.0035960932553280147 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1021676691249013 - actor/pg_clipfrac:0.0026201455155387523 - actor/ppo_kl:-0.0003692308790050447 - actor/pg_clipfrac_lower:5.476451478898525e-05 - actor/grad_norm:0.9065457135438919 - perf/mfu/actor:0.08967251245369516 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.275390625 - perf/cpu_memory_used_gb:91.99262619018555 - actor/lr:1e-06 - training/global_step:3 - training/epoch:0 - critic/score/mean:0.08531250804662704 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.08531250804662704 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.002401746576651931 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.1533390283584595 - critic/returns/mean:0.002401746576651931 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.1533390283584595 - response_length/mean:346.72186279296875 - response_length/max:2048.0 - response_length/min:11.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.224323391914368e-05 - timing_s/generate_sequences:43.807254791259766 - timing_s/reshard:0.6535622477531433 - timing_s/gen:62.41104631498456 - timing_s/reward:0.07272385619580746 - timing_s/old_log_prob:1.2445793375372887 - timing_s/ref:1.3566181752830744 - timing_s/adv:0.007393594831228256 - timing_s/update_actor:7.215371856465936 - timing_s/step:72.32084747031331 - timing_s/stop_profile:4.305504262447357e-05 - timing_per_token_ms/update_actor:0.02983765618563291 - timing_per_token_ms/gen:0.5625099937358343 - timing_per_token_ms/ref:0.005610009781131806 - timing_per_token_ms/adv:3.057465989814059e-05 - perf/total_num_tokens:241821 - perf/time_per_step:72.32084747031331 - perf/throughput:417.9655805666273
[36m(TaskRunner pid=2905377)[0m step:4 - global_seqlen/min:27234 - global_seqlen/max:32118 - global_seqlen/minmax_diff:4884 - global_seqlen/balanced_min:29492 - global_seqlen/balanced_max:29492 - global_seqlen/mean:29492.0 - actor/entropy:0.9544726610183716 - actor/kl_loss:0.007551242696354166 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11893463507294655 - actor/pg_clipfrac:0.0020076933840755375 - actor/ppo_kl:-0.0002729234740399988 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1910658478736877 - perf/mfu/actor:0.08674308298359633 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.275390625 - perf/cpu_memory_used_gb:92.16649627685547 - actor/lr:1e-06 - training/global_step:4 - training/epoch:0 - critic/score/mean:0.17531251907348633 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.17531251907348633 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.051707398146390915 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.051707398146390915 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:327.34686279296875 - response_length/max:1249.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.438900113105774e-05 - timing_s/generate_sequences:32.70615768432617 - timing_s/reshard:0.6692795157432556 - timing_s/gen:40.80273482017219 - timing_s/reward:0.07290155254304409 - timing_s/old_log_prob:1.1100755725055933 - timing_s/ref:1.3513740561902523 - timing_s/adv:0.007426496595144272 - timing_s/update_actor:7.2635879553854465 - timing_s/step:50.62124085985124 - timing_s/stop_profile:3.972090780735016e-05 - timing_per_token_ms/update_actor:0.03078626388251664 - timing_per_token_ms/gen:0.3895211961716088 - timing_per_token_ms/ref:0.0057277145335610175 - timing_per_token_ms/adv:3.147674197724922e-05 - perf/total_num_tokens:235936 - perf/time_per_step:50.62124085985124 - perf/throughput:582.601285528556
[36m(TaskRunner pid=2905377)[0m Training Progress:   1%|          | 5/525 [05:24<9:26:00, 65.31s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   1%|          | 6/525 [06:36<9:44:32, 67.58s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   1%|▏         | 7/525 [07:26<8:55:08, 61.99s/it]
[36m(TaskRunner pid=2905377)[0m step:5 - global_seqlen/min:28412 - global_seqlen/max:32057 - global_seqlen/minmax_diff:3645 - global_seqlen/balanced_min:29265 - global_seqlen/balanced_max:29747 - global_seqlen/mean:29374.875 - actor/entropy:0.9235986471176147 - actor/kl_loss:0.010388485330622643 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13459028135985135 - actor/pg_clipfrac:0.001382332533830777 - actor/ppo_kl:-0.00016928082404774614 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4064521491527557 - perf/mfu/actor:0.08751593470343598 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.275390625 - perf/cpu_memory_used_gb:92.24874496459961 - actor/lr:1e-06 - training/global_step:5 - training/epoch:0 - critic/score/mean:0.23968751728534698 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.23968751728534698 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1138543039560318 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888143062591553 - critic/returns/mean:-0.1138543039560318 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888143062591553 - response_length/mean:324.52813720703125 - response_length/max:1971.0 - response_length/min:16.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.048675954341888e-05 - timing_s/generate_sequences:44.54606628417969 - timing_s/reshard:0.6693774461746216 - timing_s/gen:61.85907272994518 - timing_s/reward:0.07304192706942558 - timing_s/old_log_prob:1.1723265890032053 - timing_s/ref:1.3496149722486734 - timing_s/adv:0.007553920149803162 - timing_s/update_actor:7.175863618031144 - timing_s/step:71.65051544830203 - timing_s/stop_profile:4.170648753643036e-05 - timing_per_token_ms/update_actor:0.03053571980319552 - timing_per_token_ms/gen:0.5956636340257988 - timing_per_token_ms/ref:0.005743066873683179 - timing_per_token_ms/adv:3.21444778480043e-05 - perf/total_num_tokens:234999 - perf/time_per_step:71.65051544830203 - perf/throughput:409.97437096171126
[36m(TaskRunner pid=2905377)[0m step:6 - global_seqlen/min:26105 - global_seqlen/max:30806 - global_seqlen/minmax_diff:4701 - global_seqlen/balanced_min:28699 - global_seqlen/balanced_max:29592 - global_seqlen/mean:28922.625 - actor/entropy:0.9148104786872864 - actor/kl_loss:0.01635260202456266 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11478363897185773 - actor/pg_clipfrac:0.0032062325568404048 - actor/ppo_kl:0.000794700912956614 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.355681300163269 - perf/mfu/actor:0.08665014371004992 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.275390625 - perf/cpu_memory_used_gb:92.31837844848633 - actor/lr:1e-06 - training/global_step:6 - training/epoch:0 - critic/score/mean:0.2771874964237213 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.2771874964237213 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06460011005401611 - critic/advantages/max:1.7888476848602295 - critic/advantages/min:-1.7888463735580444 - critic/returns/mean:-0.06460011005401611 - critic/returns/max:1.7888476848602295 - critic/returns/min:-1.7888463735580444 - response_length/mean:313.11248779296875 - response_length/max:2048.0 - response_length/min:14.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.93207436800003e-05 - timing_s/generate_sequences:42.81503677368164 - timing_s/reshard:0.6507880687713623 - timing_s/gen:62.20261803455651 - timing_s/reward:0.08194946497678757 - timing_s/old_log_prob:1.157281767576933 - timing_s/ref:1.3770060259848833 - timing_s/adv:0.007583577185869217 - timing_s/update_actor:7.131738351657987 - timing_s/step:71.97123691998422 - timing_s/stop_profile:4.456937313079834e-05 - timing_per_token_ms/update_actor:0.030822489105233303 - timing_per_token_ms/gen:0.6208093939334555 - timing_per_token_ms/ref:0.005951249350572793 - timing_per_token_ms/adv:3.27752805367304e-05 - perf/total_num_tokens:231381 - perf/time_per_step:71.97123691998422 - perf/throughput:401.8636643990909
[36m(TaskRunner pid=2905377)[0m step:7 - global_seqlen/min:25300 - global_seqlen/max:29582 - global_seqlen/minmax_diff:4282 - global_seqlen/balanced_min:27585 - global_seqlen/balanced_max:27636 - global_seqlen/mean:27592.0 - actor/entropy:0.9205254316329956 - actor/kl_loss:0.026718171709217132 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.037976180016994474 - actor/pg_clipfrac:0.0019466412719339131 - actor/ppo_kl:0.00043818528229166986 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.475639820098877 - perf/mfu/actor:0.08276932255551375 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.9375 - perf/cpu_memory_used_gb:92.42045211791992 - actor/lr:1e-06 - training/global_step:7 - training/epoch:0 - critic/score/mean:0.390625 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.390625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.012330093421041965 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888463735580444 - critic/returns/mean:-0.012330093421041965 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888463735580444 - response_length/mean:280.39373779296875 - response_length/max:1272.0 - response_length/min:14.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.27200710773468e-05 - timing_s/generate_sequences:32.838504791259766 - timing_s/reshard:0.6471986770629883 - timing_s/gen:40.81422947533429 - timing_s/reward:0.07049823924899101 - timing_s/old_log_prob:1.1029666978865862 - timing_s/ref:1.3475965466350317 - timing_s/adv:0.007606843486428261 - timing_s/update_actor:7.105672949925065 - timing_s/step:50.461598571389914 - timing_s/stop_profile:4.0821731090545654e-05 - timing_per_token_ms/update_actor:0.032190820482046724 - timing_per_token_ms/gen:0.4548762841911407 - timing_per_token_ms/ref:0.006105014798832233 - timing_per_token_ms/adv:3.446127268061513e-05 - perf/total_num_tokens:220736 - perf/time_per_step:50.461598571389914 - perf/throughput:546.792031587437
[36m(TaskRunner pid=2905377)[0m Training Progress:   2%|▏         | 8/525 [08:21<8:34:43, 59.74s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   2%|▏         | 9/525 [09:32<9:02:08, 63.04s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 11:11:32,744:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 11:11:36,415:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 11:11:36,417:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 11:11:37,368:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/huggingface
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:11:33,212:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   2%|▏         | 10/525 [10:42<9:21:07, 65.37s/it]
[36m(TaskRunner pid=2905377)[0m step:8 - global_seqlen/min:25108 - global_seqlen/max:30913 - global_seqlen/minmax_diff:5805 - global_seqlen/balanced_min:27974 - global_seqlen/balanced_max:28266 - global_seqlen/mean:28011.25 - actor/entropy:0.9001803398132324 - actor/kl_loss:0.021646609739400448 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07938038446009159 - actor/pg_clipfrac:0.003106405687867664 - actor/ppo_kl:0.0005778835233286372 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.331379771232605 - perf/mfu/actor:0.08354146480836681 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.9375 - perf/cpu_memory_used_gb:92.4590835571289 - actor/lr:1e-06 - training/global_step:8 - training/epoch:0 - critic/score/mean:0.41999998688697815 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.41999998688697815 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004867915064096451 - critic/advantages/max:1.7888476848602295 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.004867915064096451 - critic/returns/max:1.7888476848602295 - critic/returns/min:-1.7888514995574951 - response_length/mean:291.09375 - response_length/max:1438.0 - response_length/min:35.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.318200707435608e-05 - timing_s/generate_sequences:31.21115493774414 - timing_s/reshard:0.750789999961853 - timing_s/gen:45.185486214235425 - timing_s/reward:0.07154688239097595 - timing_s/old_log_prob:1.1232660226523876 - timing_s/ref:1.3505966048687696 - timing_s/adv:0.007549259811639786 - timing_s/update_actor:7.152890209108591 - timing_s/step:54.90446879900992 - timing_s/stop_profile:4.630722105503082e-05 - timing_per_token_ms/update_actor:0.03191972068860097 - timing_per_token_ms/gen:0.4850830511458446 - timing_per_token_ms/ref:0.0060270275553071075 - timing_per_token_ms/adv:3.368851716560215e-05 - perf/total_num_tokens:224090 - perf/time_per_step:54.90446879900992 - perf/throughput:510.181604753184
[36m(TaskRunner pid=2905377)[0m step:9 - global_seqlen/min:24562 - global_seqlen/max:28258 - global_seqlen/minmax_diff:3696 - global_seqlen/balanced_min:25742 - global_seqlen/balanced_max:26892 - global_seqlen/mean:25914.875 - actor/entropy:0.8531196117401123 - actor/kl_loss:0.026002592325676234 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14222001563757658 - actor/pg_clipfrac:0.0021245734125841407 - actor/ppo_kl:0.0008225393077736954 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4646241664886475 - perf/mfu/actor:0.07953659228592663 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:82.9375 - perf/cpu_memory_used_gb:92.51549530029297 - actor/lr:1e-06 - training/global_step:9 - training/epoch:0 - critic/score/mean:0.5946874618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.5946874618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.023779861629009247 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.023779861629009247 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:238.3562469482422 - response_length/max:2048.0 - response_length/min:40.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.332969784736633e-05 - timing_s/generate_sequences:33.251487731933594 - timing_s/reshard:0.6904033422470093 - timing_s/gen:60.2528337277472 - timing_s/reward:0.06756039895117283 - timing_s/old_log_prob:1.1482922919094563 - timing_s/ref:1.3416504189372063 - timing_s/adv:0.0075408462435007095 - timing_s/update_actor:6.9334110878407955 - timing_s/step:69.76513805612922 - timing_s/stop_profile:4.233606159687042e-05 - timing_per_token_ms/update_actor:0.033443201481006546 - timing_per_token_ms/gen:0.789952457295372 - timing_per_token_ms/ref:0.006471430109817268 - timing_per_token_ms/adv:3.637315558873383e-05 - perf/total_num_tokens:207319 - perf/time_per_step:69.76513805612922 - perf/throughput:371.4588076805683
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10
[36m(TaskRunner pid=2905377)[0m step:10 - global_seqlen/min:26111 - global_seqlen/max:36505 - global_seqlen/minmax_diff:10394 - global_seqlen/balanced_min:28592 - global_seqlen/balanced_max:28772 - global_seqlen/mean:28615.125 - actor/entropy:0.8090883493423462 - actor/kl_loss:0.01744054201990366 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.006830949801951647 - actor/pg_clipfrac:0.0013551486132200806 - actor/ppo_kl:-0.00028948498220415786 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4657406210899353 - perf/mfu/actor:0.08631895940936908 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.60415649414062 - actor/lr:1e-06 - training/global_step:10 - training/epoch:0 - critic/score/mean:0.5331249833106995 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.5331249833106995 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.001591409556567669 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.001591409556567669 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:305.53436279296875 - response_length/max:1635.0 - response_length/min:38.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.971376180648804e-05 - timing_s/generate_sequences:33.2374267578125 - timing_s/reshard:0.7059006690979004 - timing_s/gen:52.06461093388498 - timing_s/reward:0.07256875932216644 - timing_s/old_log_prob:1.1258489340543747 - timing_s/ref:1.3500056844204664 - timing_s/adv:0.007792774587869644 - timing_s/update_actor:7.080059738829732 - timing_s/save_checkpoint:8.875565685331821 - timing_s/step:70.58989476971328 - timing_s/stop_profile:4.638358950614929e-05 - timing_per_token_ms/update_actor:0.03092796090716768 - timing_per_token_ms/gen:0.532515888493367 - timing_per_token_ms/ref:0.005897255753821041 - timing_per_token_ms/adv:3.404132686765148e-05 - perf/total_num_tokens:228921 - perf/time_per_step:70.58989476971328 - perf/throughput:405.37140752726225
[36m(TaskRunner pid=2905377)[0m Training Progress:   2%|▏         | 11/525 [11:54<9:37:04, 67.36s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:11:38,671:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:11:38,674:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_10/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   2%|▏         | 12/525 [12:49<9:02:32, 63.46s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   2%|▏         | 13/525 [13:41<8:33:50, 60.22s/it]
[36m(TaskRunner pid=2905377)[0m step:11 - global_seqlen/min:25126 - global_seqlen/max:29545 - global_seqlen/minmax_diff:4419 - global_seqlen/balanced_min:27174 - global_seqlen/balanced_max:28055 - global_seqlen/mean:27287.875 - actor/entropy:0.7700875401496887 - actor/kl_loss:0.017838375410065055 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.19664231091737747 - actor/pg_clipfrac:0.0022656603046925738 - actor/ppo_kl:0.0017356759888571105 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3994118869304657 - perf/mfu/actor:0.08247426950853987 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.4864501953125 - actor/lr:1e-06 - training/global_step:11 - training/epoch:0 - critic/score/mean:0.5356249809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.5356249809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.07351613789796829 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.07351613789796829 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:272.1343688964844 - response_length/max:2048.0 - response_length/min:24.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.184276521205902e-05 - timing_s/generate_sequences:38.09933853149414 - timing_s/reshard:0.8333740830421448 - timing_s/gen:62.27651328779757 - timing_s/reward:0.06978711485862732 - timing_s/old_log_prob:1.0955590065568686 - timing_s/ref:1.34623621404171 - timing_s/adv:0.00790041871368885 - timing_s/update_actor:7.052535178139806 - timing_s/step:71.86212501488626 - timing_s/stop_profile:4.340708255767822e-05 - timing_per_token_ms/update_actor:0.0323061761777887 - timing_per_token_ms/gen:0.7151397320693772 - timing_per_token_ms/ref:0.006166824157440392 - timing_per_token_ms/adv:3.619015182424818e-05 - perf/total_num_tokens:218303 - perf/time_per_step:71.86212501488626 - perf/throughput:379.7254116037803
[36m(TaskRunner pid=2905377)[0m step:12 - global_seqlen/min:25424 - global_seqlen/max:29587 - global_seqlen/minmax_diff:4163 - global_seqlen/balanced_min:27240 - global_seqlen/balanced_max:27560 - global_seqlen/mean:27283.375 - actor/entropy:0.6985318064689636 - actor/kl_loss:0.02063244073651731 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.011033965833485126 - actor/pg_clipfrac:0.0020956985012162478 - actor/ppo_kl:-0.001959636040555779 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.7272143363952637 - perf/mfu/actor:0.08305064824654915 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5213737487793 - actor/lr:1e-06 - training/global_step:12 - training/epoch:0 - critic/score/mean:0.606874942779541 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.606874942779541 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.010521232150495052 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.010521232150495052 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:271.3656311035156 - response_length/max:1454.0 - response_length/min:43.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.71875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.17632132768631e-05 - timing_s/generate_sequences:31.151994705200195 - timing_s/reshard:0.6480060815811157 - timing_s/gen:44.88623587228358 - timing_s/reward:0.06930410675704479 - timing_s/old_log_prob:1.0956882406026125 - timing_s/ref:1.3461043052375317 - timing_s/adv:0.007523782551288605 - timing_s/update_actor:7.000870389863849 - timing_s/step:54.41871729493141 - timing_s/stop_profile:4.187971353530884e-05 - timing_per_token_ms/update_actor:0.032074800083676636 - timing_per_token_ms/gen:0.5169021945977358 - timing_per_token_ms/ref:0.006167236940249931 - timing_per_token_ms/adv:3.4470545484606487e-05 - perf/total_num_tokens:218267 - perf/time_per_step:54.41871729493141 - perf/throughput:501.36012673972357
[36m(TaskRunner pid=2905377)[0m step:13 - global_seqlen/min:24329 - global_seqlen/max:31159 - global_seqlen/minmax_diff:6830 - global_seqlen/balanced_min:28246 - global_seqlen/balanced_max:28247 - global_seqlen/mean:28246.25 - actor/entropy:0.6993075609207153 - actor/kl_loss:0.023322203243151308 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06428422164171935 - actor/pg_clipfrac:0.0007124610245227813 - actor/ppo_kl:0.000445925477106357 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1750044524669647 - perf/mfu/actor:0.08529861470095797 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.56956100463867 - actor/lr:1e-06 - training/global_step:13 - training/epoch:0 - critic/score/mean:0.6796874403953552 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.6796874403953552 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04147554188966751 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04147554188966751 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:296.96875 - response_length/max:1304.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.0132856965065e-05 - timing_s/generate_sequences:34.03572463989258 - timing_s/reshard:0.7006032466888428 - timing_s/gen:43.128644708544016 - timing_s/reward:0.07224313542246819 - timing_s/old_log_prob:1.102387074381113 - timing_s/ref:1.3541178926825523 - timing_s/adv:0.007642596960067749 - timing_s/update_actor:7.067233057692647 - timing_s/step:52.74656725116074 - timing_s/stop_profile:4.355423152446747e-05 - timing_per_token_ms/update_actor:0.03127509429434282 - timing_per_token_ms/gen:0.4538424151167422 - timing_per_token_ms/ref:0.0059924675518102065 - timing_per_token_ms/adv:3.382129026006881e-05 - perf/total_num_tokens:225970 - perf/time_per_step:52.74656725116074 - perf/throughput:535.508782315657
[36m(TaskRunner pid=2905377)[0m Training Progress:   3%|▎         | 14/525 [14:29<8:00:21, 56.40s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   3%|▎         | 15/525 [15:13<7:28:37, 52.78s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   3%|▎         | 16/525 [16:23<8:10:19, 57.80s/it]
[36m(TaskRunner pid=2905377)[0m step:14 - global_seqlen/min:24492 - global_seqlen/max:30009 - global_seqlen/minmax_diff:5517 - global_seqlen/balanced_min:26467 - global_seqlen/balanced_max:26708 - global_seqlen/mean:26497.5 - actor/entropy:0.7664108872413635 - actor/kl_loss:0.02405897229909897 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.015357984602451325 - actor/pg_clipfrac:0.0010146734304726124 - actor/ppo_kl:0.000817662343615666 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2322998940944672 - perf/mfu/actor:0.08125609330171898 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.58944702148438 - actor/lr:1e-06 - training/global_step:14 - training/epoch:0 - critic/score/mean:0.7634375095367432 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7634375095367432 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01735920086503029 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01735920086503029 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:253.359375 - response_length/max:1195.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.172169327735901e-05 - timing_s/generate_sequences:25.69371795654297 - timing_s/reshard:0.641381025314331 - timing_s/gen:38.108290361240506 - timing_s/reward:0.06898529082536697 - timing_s/old_log_prob:1.0865466762334108 - timing_s/ref:1.3496843930333853 - timing_s/adv:0.007838834077119827 - timing_s/update_actor:6.94052043184638 - timing_s/step:47.57583081535995 - timing_s/stop_profile:4.0706247091293335e-05 - timing_per_token_ms/update_actor:0.032741392734439004 - timing_per_token_ms/gen:0.470037500601178 - timing_per_token_ms/ref:0.006367036480014083 - timing_per_token_ms/adv:3.697912103556858e-05 - perf/total_num_tokens:211980 - perf/time_per_step:47.57583081535995 - perf/throughput:556.9529642653183
[36m(TaskRunner pid=2905377)[0m step:15 - global_seqlen/min:23801 - global_seqlen/max:29096 - global_seqlen/minmax_diff:5295 - global_seqlen/balanced_min:26836 - global_seqlen/balanced_max:26837 - global_seqlen/mean:26836.25 - actor/entropy:0.7167364954948425 - actor/kl_loss:0.02549927532672882 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.030182930827140807 - actor/pg_clipfrac:0.0013760725152678788 - actor/ppo_kl:0.00037684327107854185 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.140063613653183 - perf/mfu/actor:0.08212593177385343 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.57349014282227 - actor/lr:1e-06 - training/global_step:15 - training/epoch:0 - critic/score/mean:0.6790624856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.6790624856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04565449431538582 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04565449431538582 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:261.28125 - response_length/max:1030.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.441321551799774e-05 - timing_s/generate_sequences:28.630680084228516 - timing_s/reshard:0.653464138507843 - timing_s/gen:34.78884984180331 - timing_s/reward:0.07070263661444187 - timing_s/old_log_prob:1.1828193590044975 - timing_s/ref:1.3529661782085896 - timing_s/adv:0.007674137130379677 - timing_s/update_actor:6.959811558946967 - timing_s/step:44.37625120021403 - timing_s/stop_profile:4.138238728046417e-05 - timing_per_token_ms/update_actor:0.032417958726288915 - timing_per_token_ms/gen:0.4160847965770041 - timing_per_token_ms/ref:0.006301952481292047 - timing_per_token_ms/adv:3.5745200663187276e-05 - perf/total_num_tokens:214690 - perf/time_per_step:44.37625120021403 - perf/throughput:604.7435119952306
[36m(TaskRunner pid=2905377)[0m step:16 - global_seqlen/min:25615 - global_seqlen/max:29459 - global_seqlen/minmax_diff:3844 - global_seqlen/balanced_min:27356 - global_seqlen/balanced_max:28119 - global_seqlen/mean:27460.25 - actor/entropy:0.6707468628883362 - actor/kl_loss:0.02544835493899882 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12039245376363397 - actor/pg_clipfrac:0.001204804889857769 - actor/ppo_kl:0.00011721497430698946 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.320376694202423 - perf/mfu/actor:0.08321441253892936 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.52935028076172 - actor/lr:1e-06 - training/global_step:16 - training/epoch:0 - critic/score/mean:0.8637499809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8637499809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04184751957654953 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.04184751957654953 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:277.1000061035156 - response_length/max:2048.0 - response_length/min:61.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.263625204563141e-05 - timing_s/generate_sequences:37.5362434387207 - timing_s/reshard:0.7272608876228333 - timing_s/gen:59.78843825310469 - timing_s/reward:0.07097704149782658 - timing_s/old_log_prob:1.1611107792705297 - timing_s/ref:1.3612468931823969 - timing_s/adv:0.007897032424807549 - timing_s/update_actor:7.038502236828208 - timing_s/step:69.4423567596823 - timing_s/stop_profile:4.174932837486267e-05 - timing_per_token_ms/update_actor:0.03203950363174137 - timing_per_token_ms/gen:0.6742651372823968 - timing_per_token_ms/ref:0.006196442554157359 - timing_per_token_ms/adv:3.594756249855495e-05 - perf/total_num_tokens:219682 - perf/time_per_step:69.4423567596823 - perf/throughput:395.43948796310457
[36m(TaskRunner pid=2905377)[0m Training Progress:   3%|▎         | 17/525 [17:08<7:36:11, 53.88s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   3%|▎         | 18/525 [17:54<7:15:16, 51.51s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   4%|▎         | 19/525 [18:35<6:48:59, 48.50s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 11:20:20,888:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:20:24,394:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:20:24,397:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 11:20:25,734:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:17 - global_seqlen/min:24990 - global_seqlen/max:28198 - global_seqlen/minmax_diff:3208 - global_seqlen/balanced_min:26249 - global_seqlen/balanced_max:26250 - global_seqlen/mean:26249.375 - actor/entropy:0.6634816527366638 - actor/kl_loss:0.03235974598210305 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.013011959008872509 - actor/pg_clipfrac:0.001939281669910997 - actor/ppo_kl:0.0009814741879381472 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4165213406085968 - perf/mfu/actor:0.08013142137421124 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.65890121459961 - actor/lr:1e-06 - training/global_step:17 - training/epoch:0 - critic/score/mean:0.7571874856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7571874856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.003493737196549773 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.003493737196549773 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:246.0625 - response_length/max:1021.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.969435632228851e-05 - timing_s/generate_sequences:27.304630279541016 - timing_s/reshard:0.6672542691230774 - timing_s/gen:34.65709302946925 - timing_s/reward:0.06711063534021378 - timing_s/old_log_prob:1.1408230867236853 - timing_s/ref:1.3606939762830734 - timing_s/adv:0.007525153458118439 - timing_s/update_actor:6.973936855792999 - timing_s/step:44.22066927142441 - timing_s/stop_profile:4.3394044041633606e-05 - timing_per_token_ms/update_actor:0.03321001383743898 - timing_per_token_ms/gen:0.44014596176618304 - timing_per_token_ms/ref:0.006479649402524219 - timing_per_token_ms/adv:3.5834917298594914e-05 - perf/total_num_tokens:209995 - perf/time_per_step:44.22066927142441 - perf/throughput:593.5996770849974
[36m(TaskRunner pid=2905377)[0m step:18 - global_seqlen/min:24002 - global_seqlen/max:28501 - global_seqlen/minmax_diff:4499 - global_seqlen/balanced_min:26397 - global_seqlen/balanced_max:26477 - global_seqlen/mean:26407.625 - actor/entropy:0.6880284547805786 - actor/kl_loss:0.03768618376925588 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10014736982993781 - actor/pg_clipfrac:0.0010987722896970808 - actor/ppo_kl:0.00036426927396178145 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2796216309070587 - perf/mfu/actor:0.0804437206015195 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.61491775512695 - actor/lr:1e-06 - training/global_step:18 - training/epoch:0 - critic/score/mean:0.809374988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.809374988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.033378612250089645 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.033378612250089645 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:250.4562530517578 - response_length/max:1119.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.009932935237885e-05 - timing_s/generate_sequences:28.47159767150879 - timing_s/reshard:0.6417605876922607 - timing_s/gen:36.451723761856556 - timing_s/reward:0.08565687760710716 - timing_s/old_log_prob:1.0888621546328068 - timing_s/ref:1.3463005796074867 - timing_s/adv:0.0076063163578510284 - timing_s/update_actor:6.986800050362945 - timing_s/step:45.98445271886885 - timing_s/stop_profile:4.230812191963196e-05 - timing_per_token_ms/update_actor:0.03307188761940417 - timing_per_token_ms/gen:0.45481650689811787 - timing_per_token_ms/ref:0.006372688662874297 - timing_per_token_ms/adv:3.6004356496708e-05 - perf/total_num_tokens:211261 - perf/time_per_step:45.98445271886885 - perf/throughput:574.2728996133976
[36m(TaskRunner pid=2905377)[0m step:19 - global_seqlen/min:23465 - global_seqlen/max:28764 - global_seqlen/minmax_diff:5299 - global_seqlen/balanced_min:26558 - global_seqlen/balanced_max:26559 - global_seqlen/mean:26558.75 - actor/entropy:0.6397153735160828 - actor/kl_loss:0.03555358853191137 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08617559131234884 - actor/pg_clipfrac:0.0015685770194977522 - actor/ppo_kl:0.00030102687760518164 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.129299521446228 - perf/mfu/actor:0.08049706632388476 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62237930297852 - actor/lr:1e-06 - training/global_step:19 - training/epoch:0 - critic/score/mean:0.731874942779541 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.731874942779541 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.029735881835222244 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.029735881835222244 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:253.359375 - response_length/max:935.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.609375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.298084139823914e-05 - timing_s/generate_sequences:25.64875030517578 - timing_s/reshard:0.6668439507484436 - timing_s/gen:31.90542422235012 - timing_s/reward:0.06799854896962643 - timing_s/old_log_prob:1.0794930271804333 - timing_s/ref:1.362370416522026 - timing_s/adv:0.0076730940490961075 - timing_s/update_actor:7.021503711119294 - timing_s/step:41.45779540017247 - timing_s/stop_profile:3.919564187526703e-05 - timing_per_token_ms/update_actor:0.033047035869154674 - timing_per_token_ms/gen:0.393529746806662 - timing_per_token_ms/ref:0.006412060133298941 - timing_per_token_ms/adv:3.611377629357607e-05 - perf/total_num_tokens:212470 - perf/time_per_step:41.45779540017247 - perf/throughput:640.6213775633981
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20
[36m(TaskRunner pid=2905377)[0m Training Progress:   4%|▍         | 20/525 [19:30<7:04:36, 50.45s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:20:21,275:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   4%|▍         | 21/525 [20:12<6:42:41, 47.94s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:20:26,485:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:20:26,489:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_20/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   4%|▍         | 22/525 [21:24<7:43:19, 55.27s/it]
[36m(TaskRunner pid=2905377)[0m step:20 - global_seqlen/min:23707 - global_seqlen/max:27576 - global_seqlen/minmax_diff:3869 - global_seqlen/balanced_min:25910 - global_seqlen/balanced_max:25911 - global_seqlen/mean:25910.625 - actor/entropy:0.7619358897209167 - actor/kl_loss:0.03608636343851686 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21197286956012248 - actor/pg_clipfrac:0.0016653851140290498 - actor/ppo_kl:-0.000522748067669454 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2630954682826996 - perf/mfu/actor:0.07808498101912165 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5869369506836 - actor/lr:1e-06 - training/global_step:20 - training/epoch:0 - critic/score/mean:0.9025000333786011 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9025000333786011 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.012979731895029545 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.012979731895029545 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:238.90625 - response_length/max:1104.0 - response_length/min:50.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.296461939811707e-05 - timing_s/generate_sequences:30.655611038208008 - timing_s/reshard:0.6634178757667542 - timing_s/gen:36.86121856980026 - timing_s/reward:0.06703822873532772 - timing_s/old_log_prob:1.0826924983412027 - timing_s/ref:1.3567310515791178 - timing_s/adv:0.0076884739100933075 - timing_s/update_actor:7.058709451928735 - timing_s/save_checkpoint:8.422644650563598 - timing_s/step:54.870210878551006 - timing_s/stop_profile:4.6854838728904724e-05 - timing_per_token_ms/update_actor:0.03405316087477982 - timing_per_token_ms/gen:0.482161132371488 - timing_per_token_ms/ref:0.006545244719005802 - timing_per_token_ms/adv:3.709131828204312e-05 - perf/total_num_tokens:207285 - perf/time_per_step:54.870210878551006 - perf/throughput:472.21661052752705
[36m(TaskRunner pid=2905377)[0m step:21 - global_seqlen/min:23956 - global_seqlen/max:28842 - global_seqlen/minmax_diff:4886 - global_seqlen/balanced_min:26167 - global_seqlen/balanced_max:26168 - global_seqlen/mean:26167.5 - actor/entropy:0.6644201874732971 - actor/kl_loss:0.04853714080527425 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2213837221264839 - actor/pg_clipfrac:0.002984314470086247 - actor/ppo_kl:0.0020714653253889994 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.403798595070839 - perf/mfu/actor:0.07951742211846773 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49000549316406 - actor/lr:1e-06 - training/global_step:21 - training/epoch:0 - critic/score/mean:0.8399999737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8399999737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02044101059436798 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02044101059436798 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:244.78125 - response_length/max:963.0 - response_length/min:45.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.208677172660828e-05 - timing_s/generate_sequences:29.773744583129883 - timing_s/reshard:0.6389793753623962 - timing_s/gen:32.574845330789685 - timing_s/reward:0.06720773503184319 - timing_s/old_log_prob:1.0676809791475534 - timing_s/ref:1.3417699802666903 - timing_s/adv:0.007746212184429169 - timing_s/update_actor:7.003166100010276 - timing_s/step:42.07860551029444 - timing_s/stop_profile:4.256702959537506e-05 - timing_per_token_ms/update_actor:0.033453549727764764 - timing_per_token_ms/gen:0.41586678578819974 - timing_per_token_ms/ref:0.006409525080093103 - timing_per_token_ms/adv:3.700301989313638e-05 - perf/total_num_tokens:209340 - perf/time_per_step:42.07860551029444 - perf/throughput:621.8718439611355
[36m(TaskRunner pid=2905377)[0m step:22 - global_seqlen/min:25139 - global_seqlen/max:30589 - global_seqlen/minmax_diff:5450 - global_seqlen/balanced_min:27894 - global_seqlen/balanced_max:28535 - global_seqlen/mean:27975.0 - actor/entropy:0.596856415271759 - actor/kl_loss:0.039417473645880816 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.006042150408029556 - actor/pg_clipfrac:0.002116506767924875 - actor/ppo_kl:-0.0006846547041277518 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.326308250427246 - perf/mfu/actor:0.08444385216072006 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55401992797852 - actor/lr:1e-06 - training/global_step:22 - training/epoch:0 - critic/score/mean:0.8293749690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8293749690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03312290087342262 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03312290087342262 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:289.96875 - response_length/max:2048.0 - response_length/min:57.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.21426510810852e-05 - timing_s/generate_sequences:38.17981719970703 - timing_s/reshard:0.6547659039497375 - timing_s/gen:62.576341331005096 - timing_s/reward:0.07108092494308949 - timing_s/old_log_prob:1.2521945871412754 - timing_s/ref:1.3551499098539352 - timing_s/adv:0.007816687226295471 - timing_s/update_actor:7.071764975786209 - timing_s/step:72.34757752716541 - timing_s/stop_profile:4.004873335361481e-05 - timing_per_token_ms/update_actor:0.03159859238510371 - timing_per_token_ms/gen:0.6743866939433678 - timing_per_token_ms/ref:0.006055182796487646 - timing_per_token_ms/adv:3.492711003706645e-05 - perf/total_num_tokens:223800 - perf/time_per_step:72.34757752716541 - perf/throughput:386.67500635381765
[36m(TaskRunner pid=2905377)[0m Training Progress:   4%|▍         | 23/525 [22:10<7:18:10, 52.37s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   5%|▍         | 24/525 [23:18<7:56:41, 57.09s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   5%|▍         | 25/525 [24:31<8:36:06, 61.93s/it]
[36m(TaskRunner pid=2905377)[0m step:23 - global_seqlen/min:25565 - global_seqlen/max:30375 - global_seqlen/minmax_diff:4810 - global_seqlen/balanced_min:27430 - global_seqlen/balanced_max:27431 - global_seqlen/mean:27430.75 - actor/entropy:0.5761833190917969 - actor/kl_loss:0.04086744696833193 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08963526785373688 - actor/pg_clipfrac:0.002383583068149164 - actor/ppo_kl:0.0006763215682440204 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.088781401515007 - perf/mfu/actor:0.08287406456149944 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5418586730957 - actor/lr:1e-06 - training/global_step:23 - training/epoch:0 - critic/score/mean:0.8221875429153442 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8221875429153442 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.016309639438986778 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.016309639438986778 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:276.03436279296875 - response_length/max:1098.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.220784366130829e-05 - timing_s/generate_sequences:29.91118812561035 - timing_s/reshard:0.6570731401443481 - timing_s/gen:36.02154880948365 - timing_s/reward:0.07047948613762856 - timing_s/old_log_prob:1.0860653053969145 - timing_s/ref:1.3476992826908827 - timing_s/adv:0.008067661896348 - timing_s/update_actor:7.053474489599466 - timing_s/step:45.600772365927696 - timing_s/stop_profile:4.113093018531799e-05 - timing_per_token_ms/update_actor:0.032142187552288336 - timing_per_token_ms/gen:0.40780189072334344 - timing_per_token_ms/ref:0.006141370919000039 - timing_per_token_ms/adv:3.6763768290823254e-05 - perf/total_num_tokens:219446 - perf/time_per_step:45.600772365927696 - perf/throughput:601.5413462710535
[36m(TaskRunner pid=2905377)[0m step:24 - global_seqlen/min:24063 - global_seqlen/max:30561 - global_seqlen/minmax_diff:6498 - global_seqlen/balanced_min:26906 - global_seqlen/balanced_max:27576 - global_seqlen/mean:27044.625 - actor/entropy:0.5773631930351257 - actor/kl_loss:0.04759642209392041 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04142106026411056 - actor/pg_clipfrac:0.002970032489974983 - actor/ppo_kl:0.0007322561490582302 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3318266868591309 - perf/mfu/actor:0.08209389367760475 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53928756713867 - actor/lr:1e-06 - training/global_step:24 - training/epoch:0 - critic/score/mean:0.8753125071525574 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8753125071525574 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.039686039090156555 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.039686039090156555 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:267.0375061035156 - response_length/max:1903.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.234009146690369e-05 - timing_s/generate_sequences:40.37299728393555 - timing_s/reshard:0.7558700442314148 - timing_s/gen:58.52343131415546 - timing_s/reward:0.06876995973289013 - timing_s/old_log_prob:1.0920075587928295 - timing_s/ref:1.3516078907996416 - timing_s/adv:0.007954491302371025 - timing_s/update_actor:7.022595651447773 - timing_s/step:68.0795954670757 - timing_s/stop_profile:4.036165773868561e-05 - timing_per_token_ms/update_actor:0.03245837043149874 - timing_per_token_ms/gen:0.684869064669703 - timing_per_token_ms/ref:0.006247118839693847 - timing_per_token_ms/adv:3.676558328305082e-05 - perf/total_num_tokens:216357 - perf/time_per_step:68.0795954670757 - perf/throughput:397.2500837358703
[36m(TaskRunner pid=2905377)[0m step:25 - global_seqlen/min:27000 - global_seqlen/max:30690 - global_seqlen/minmax_diff:3690 - global_seqlen/balanced_min:28919 - global_seqlen/balanced_max:29666 - global_seqlen/mean:29012.75 - actor/entropy:0.5556726455688477 - actor/kl_loss:0.0466527096927166 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.010811502858996392 - actor/pg_clipfrac:0.0023082062834873796 - actor/ppo_kl:0.0005330121202860028 - actor/pg_clipfrac_lower:0.0002242152579128742 - actor/grad_norm:0.9876753091812134 - perf/mfu/actor:0.08626987529133748 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46668243408203 - actor/lr:1e-06 - training/global_step:25 - training/epoch:0 - critic/score/mean:0.9056249856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9056249856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.042038362473249435 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.042038362473249435 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:316.3500061035156 - response_length/max:2048.0 - response_length/min:63.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.666197001934052e-05 - timing_s/generate_sequences:39.06095886230469 - timing_s/reshard:0.6495364308357239 - timing_s/gen:62.90534264408052 - timing_s/reward:0.0739124845713377 - timing_s/old_log_prob:1.1430698838084936 - timing_s/ref:1.350974215194583 - timing_s/adv:0.007613003253936768 - timing_s/update_actor:7.187601950019598 - timing_s/step:72.6817818954587 - timing_s/stop_profile:4.4325366616249084e-05 - timing_per_token_ms/update_actor:0.03096742789816373 - timing_per_token_ms/gen:0.6213978054773246 - timing_per_token_ms/ref:0.005820605661280742 - timing_per_token_ms/adv:3.280024839913817e-05 - perf/total_num_tokens:232102 - perf/time_per_step:72.6817818954587 - perf/throughput:399.1749960358742
[36m(TaskRunner pid=2905377)[0m Training Progress:   5%|▍         | 26/525 [25:39<8:48:33, 63.55s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   5%|▌         | 27/525 [26:23<7:59:30, 57.77s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   5%|▌         | 28/525 [27:38<8:40:09, 62.80s/it]
[36m(TaskRunner pid=2905377)[0m step:26 - global_seqlen/min:24696 - global_seqlen/max:28534 - global_seqlen/minmax_diff:3838 - global_seqlen/balanced_min:26564 - global_seqlen/balanced_max:27475 - global_seqlen/mean:26678.25 - actor/entropy:0.577427864074707 - actor/kl_loss:0.04311106675304473 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04502033218741417 - actor/pg_clipfrac:0.0013167691882699727 - actor/ppo_kl:-8.288105909741717e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1233244985342026 - perf/mfu/actor:0.08114050462327958 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49072265625 - actor/lr:1e-06 - training/global_step:26 - training/epoch:0 - critic/score/mean:0.8003123998641968 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8003123998641968 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.033296048641204834 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.033296048641204834 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:257.11248779296875 - response_length/max:1889.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.44765454530716e-05 - timing_s/generate_sequences:32.46318817138672 - timing_s/reshard:0.7822305560112 - timing_s/gen:57.79916465841234 - timing_s/reward:0.06817175447940826 - timing_s/old_log_prob:1.0799223370850086 - timing_s/ref:1.355881066992879 - timing_s/adv:0.007698576897382736 - timing_s/update_actor:7.000872103497386 - timing_s/step:67.3256865516305 - timing_s/stop_profile:3.983452916145325e-05 - timing_per_token_ms/update_actor:0.03280233946893718 - timing_per_token_ms/gen:0.7025033382567497 - timing_per_token_ms/ref:0.0063529329462805794 - timing_per_token_ms/adv:3.607141068746421e-05 - perf/total_num_tokens:213426 - perf/time_per_step:67.3256865516305 - perf/throughput:396.2566349700879
[36m(TaskRunner pid=2905377)[0m step:27 - global_seqlen/min:26100 - global_seqlen/max:29281 - global_seqlen/minmax_diff:3181 - global_seqlen/balanced_min:27410 - global_seqlen/balanced_max:27467 - global_seqlen/mean:27417.75 - actor/entropy:0.5542868971824646 - actor/kl_loss:0.05609562378376722 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.004671910405158996 - actor/pg_clipfrac:0.002668575942516327 - actor/ppo_kl:0.0005413395781033615 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2979484498500824 - perf/mfu/actor:0.08327821571747354 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.473388671875 - actor/lr:1e-06 - training/global_step:27 - training/epoch:0 - critic/score/mean:0.9178125262260437 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9178125262260437 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.017204079777002335 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.017204079777002335 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:276.1468811035156 - response_length/max:1072.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.232146501541138e-05 - timing_s/generate_sequences:27.54847526550293 - timing_s/reshard:0.7364802956581116 - timing_s/gen:34.72687010653317 - timing_s/reward:0.07019106112420559 - timing_s/old_log_prob:1.077710224315524 - timing_s/ref:1.3536108564585447 - timing_s/adv:0.01058017648756504 - timing_s/update_actor:7.01547734066844 - timing_s/step:44.26772869378328 - timing_s/stop_profile:4.392489790916443e-05 - timing_per_token_ms/update_actor:0.03198419518682441 - timing_per_token_ms/gen:0.39298459952847975 - timing_per_token_ms/ref:0.00617123422079923 - timing_per_token_ms/adv:4.823598074041926e-05 - perf/total_num_tokens:219342 - perf/time_per_step:44.26772869378328 - perf/throughput:619.3620230588067
[36m(TaskRunner pid=2905377)[0m step:28 - global_seqlen/min:26208 - global_seqlen/max:31534 - global_seqlen/minmax_diff:5326 - global_seqlen/balanced_min:27848 - global_seqlen/balanced_max:28502 - global_seqlen/mean:28011.75 - actor/entropy:0.5596199631690979 - actor/kl_loss:0.04524889450985938 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05750268567353487 - actor/pg_clipfrac:0.0022833509836345913 - actor/ppo_kl:0.0001653136499953689 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.308983862400055 - perf/mfu/actor:0.08411670519731107 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.48006439208984 - actor/lr:1e-06 - training/global_step:28 - training/epoch:0 - critic/score/mean:1.0078125 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0078125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008201454766094685 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008201454766094685 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:291.76251220703125 - response_length/max:2048.0 - response_length/min:58.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:408.53125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010159052908420563 - timing_s/generate_sequences:39.778499603271484 - timing_s/reshard:0.6442321538925171 - timing_s/gen:64.55180522240698 - timing_s/reward:0.07177171669900417 - timing_s/old_log_prob:1.2758292313665152 - timing_s/ref:1.3406485356390476 - timing_s/adv:0.00798080675303936 - timing_s/update_actor:7.113120133057237 - timing_s/step:74.37844731099904 - timing_s/stop_profile:4.271417856216431e-05 - timing_per_token_ms/update_actor:0.03174168042454165 - timing_per_token_ms/gen:0.6913993104666358 - timing_per_token_ms/ref:0.005982527580564619 - timing_per_token_ms/adv:3.5613656559476646e-05 - perf/total_num_tokens:224094 - perf/time_per_step:74.37844731099904 - perf/throughput:376.6111153527353
[36m(TaskRunner pid=2905377)[0m Training Progress:   6%|▌         | 29/525 [28:37<8:31:00, 61.82s/it]
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:30:43,139:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/model_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:30:46,664:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:30:46,667:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 11:30:47,625:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:   6%|▌         | 30/525 [29:52<9:02:31, 65.76s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:30:43,427:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   6%|▌         | 31/525 [30:35<8:05:30, 58.97s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:30:48,511:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:30:48,513:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:29 - global_seqlen/min:24611 - global_seqlen/max:30748 - global_seqlen/minmax_diff:6137 - global_seqlen/balanced_min:26556 - global_seqlen/balanced_max:27085 - global_seqlen/mean:26753.25 - actor/entropy:0.5494207143783569 - actor/kl_loss:0.05907235504128039 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06733256056904793 - actor/pg_clipfrac:0.002625140611780807 - actor/ppo_kl:0.0009146993819740601 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2491061687469482 - perf/mfu/actor:0.08131210401266212 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46169662475586 - actor/lr:1e-06 - training/global_step:29 - training/epoch:0 - critic/score/mean:0.9506250619888306 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9506250619888306 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.030956164002418518 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.030956164002418518 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:259.09686279296875 - response_length/max:1535.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.114108979701996e-05 - timing_s/generate_sequences:27.99648666381836 - timing_s/reshard:0.6543959379196167 - timing_s/gen:49.95916256122291 - timing_s/reward:0.06872466020286083 - timing_s/old_log_prob:1.1059271655976772 - timing_s/ref:1.3542511519044638 - timing_s/adv:0.00782238319516182 - timing_s/update_actor:7.007585056126118 - timing_s/step:59.51800156570971 - timing_s/stop_profile:4.0726736187934875e-05 - timing_per_token_ms/update_actor:0.03274174659212487 - timing_per_token_ms/gen:0.6025637437881934 - timing_per_token_ms/ref:0.006327507648157064 - timing_per_token_ms/adv:3.654875199817695e-05 - perf/total_num_tokens:214026 - perf/time_per_step:59.51800156570971 - perf/throughput:449.49845922604754
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_30
[36m(TaskRunner pid=2905377)[0m step:30 - global_seqlen/min:24050 - global_seqlen/max:31943 - global_seqlen/minmax_diff:7893 - global_seqlen/balanced_min:27339 - global_seqlen/balanced_max:27841 - global_seqlen/mean:27426.0 - actor/entropy:0.6053045392036438 - actor/kl_loss:0.04929585698992014 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07265949239954353 - actor/pg_clipfrac:0.002363675192464143 - actor/ppo_kl:0.0004976201642421074 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.398497611284256 - perf/mfu/actor:0.08249319747148968 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.42280578613281 - actor/lr:1e-06 - training/global_step:30 - training/epoch:0 - critic/score/mean:0.9815624952316284 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9815624952316284 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.03961843624711037 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.03961843624711037 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:276.4624938964844 - response_length/max:1814.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.046627044677734e-05 - timing_s/generate_sequences:32.26585388183594 - timing_s/reshard:0.6728667616844177 - timing_s/gen:57.142323050647974 - timing_s/reward:0.07064157724380493 - timing_s/old_log_prob:1.1615410186350346 - timing_s/ref:1.3473171591758728 - timing_s/adv:0.007737904787063599 - timing_s/update_actor:7.09060406498611 - timing_s/save_checkpoint:8.120570976287127 - timing_s/step:74.9547335896641 - timing_s/stop_profile:5.145743489265442e-05 - timing_per_token_ms/update_actor:0.03231698053391904 - timing_per_token_ms/gen:0.6459095158774695 - timing_per_token_ms/ref:0.006140692951833447 - timing_per_token_ms/adv:3.526719530310471e-05 - perf/total_num_tokens:219408 - perf/time_per_step:74.9547335896641 - perf/throughput:365.90084023435065
[36m(TaskRunner pid=2905377)[0m step:31 - global_seqlen/min:25516 - global_seqlen/max:30619 - global_seqlen/minmax_diff:5103 - global_seqlen/balanced_min:27585 - global_seqlen/balanced_max:27586 - global_seqlen/mean:27585.375 - actor/entropy:0.5578770637512207 - actor/kl_loss:0.04882336119189858 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09078021422028541 - actor/pg_clipfrac:0.001439698220929131 - actor/ppo_kl:0.0008390342176426202 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0947564393281937 - perf/mfu/actor:0.08287342282195292 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.2862548828125 - actor/lr:1e-06 - training/global_step:31 - training/epoch:0 - critic/score/mean:0.96812504529953 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.96812504529953 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.01101227942854166 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.01101227942854166 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:279.6812438964844 - response_length/max:990.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.164718747138977e-05 - timing_s/generate_sequences:27.75289535522461 - timing_s/reshard:0.633767306804657 - timing_s/gen:33.48031499236822 - timing_s/reward:0.07102704979479313 - timing_s/old_log_prob:1.089154189452529 - timing_s/ref:1.3479805290699005 - timing_s/adv:0.007881538942456245 - timing_s/update_actor:7.09484257735312 - timing_s/step:43.10522873699665 - timing_s/stop_profile:4.024989902973175e-05 - timing_per_token_ms/update_actor:0.03214947493623487 - timing_per_token_ms/gen:0.3740900913134173 - timing_per_token_ms/ref:0.006108220973386715 - timing_per_token_ms/adv:3.5714300342374564e-05 - perf/total_num_tokens:220683 - perf/time_per_step:43.10522873699665 - perf/throughput:639.9542656022107
[36m(TaskRunner pid=2905377)[0m Training Progress:   6%|▌         | 32/525 [31:33<8:02:12, 58.69s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   6%|▋         | 33/525 [32:20<7:32:09, 55.14s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   6%|▋         | 34/525 [33:14<7:27:58, 54.74s/it]
[36m(TaskRunner pid=2905377)[0m step:32 - global_seqlen/min:25960 - global_seqlen/max:33054 - global_seqlen/minmax_diff:7094 - global_seqlen/balanced_min:28509 - global_seqlen/balanced_max:28666 - global_seqlen/mean:28529.75 - actor/entropy:0.5766350030899048 - actor/kl_loss:0.04895805385895073 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16695843026973306 - actor/pg_clipfrac:0.0020934965054038913 - actor/ppo_kl:0.000517967536507058 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2819876372814178 - perf/mfu/actor:0.08460660712576679 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.3736686706543 - actor/lr:1e-06 - training/global_step:32 - training/epoch:0 - critic/score/mean:0.97718745470047 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.97718745470047 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.011139651760458946 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.011139651760458946 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:304.4937438964844 - response_length/max:1554.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.982924580574036e-05 - timing_s/generate_sequences:34.18011474609375 - timing_s/reshard:0.6604572534561157 - timing_s/gen:48.18882304802537 - timing_s/reward:0.07261092960834503 - timing_s/old_log_prob:1.1816120464354753 - timing_s/ref:1.3585883527994156 - timing_s/adv:0.007882259786128998 - timing_s/update_actor:7.198265330865979 - timing_s/step:58.0212124902755 - timing_s/stop_profile:4.359707236289978e-05 - timing_per_token_ms/update_actor:0.03153841748905081 - timing_per_token_ms/gen:0.4945588276445059 - timing_per_token_ms/ref:0.005952507263468027 - timing_per_token_ms/adv:3.453526488196092e-05 - perf/total_num_tokens:228238 - perf/time_per_step:58.0212124902755 - perf/throughput:491.71240612701183
[36m(TaskRunner pid=2905377)[0m step:33 - global_seqlen/min:24674 - global_seqlen/max:30909 - global_seqlen/minmax_diff:6235 - global_seqlen/balanced_min:27642 - global_seqlen/balanced_max:27745 - global_seqlen/mean:27655.75 - actor/entropy:0.529383659362793 - actor/kl_loss:0.06056486344896257 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.048991020582616326 - actor/pg_clipfrac:0.002114568563411012 - actor/ppo_kl:0.0014099985099164769 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9840760231018066 - perf/mfu/actor:0.08252480094525415 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.43284225463867 - actor/lr:1e-06 - training/global_step:33 - training/epoch:0 - critic/score/mean:0.8271874189376831 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8271874189376831 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.012158445082604885 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:0.012158445082604885 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:281.54998779296875 - response_length/max:1099.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.712390601634979e-05 - timing_s/generate_sequences:25.832290649414062 - timing_s/reshard:0.7225972414016724 - timing_s/gen:36.94409682415426 - timing_s/reward:0.07012050040066242 - timing_s/old_log_prob:1.090649588033557 - timing_s/ref:1.3574718311429024 - timing_s/adv:0.011870183050632477 - timing_s/update_actor:7.140445806086063 - timing_s/step:46.628296352922916 - timing_s/stop_profile:4.2397528886795044e-05 - timing_per_token_ms/update_actor:0.03227378486429614 - timing_per_token_ms/gen:0.41005257529917266 - timing_per_token_ms/ref:0.0061355768291535325 - timing_per_token_ms/adv:5.365151483250534e-05 - perf/total_num_tokens:221246 - perf/time_per_step:46.628296352922916 - perf/throughput:593.110882513862
[36m(TaskRunner pid=2905377)[0m step:34 - global_seqlen/min:25852 - global_seqlen/max:29850 - global_seqlen/minmax_diff:3998 - global_seqlen/balanced_min:27551 - global_seqlen/balanced_max:27767 - global_seqlen/mean:27614.625 - actor/entropy:0.543682873249054 - actor/kl_loss:0.060611051693558696 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08529777266085148 - actor/pg_clipfrac:0.002184703096281737 - actor/ppo_kl:-0.0002601448487439484 - actor/pg_clipfrac_lower:0.00012531328247860073 - actor/grad_norm:1.281874567270279 - perf/mfu/actor:0.08379703009551592 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.48270416259766 - actor/lr:1e-06 - training/global_step:34 - training/epoch:0 - critic/score/mean:0.9996875524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9996875524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0016555857146158814 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0016555857146158814 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:281.2875061035156 - response_length/max:1399.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.835589349269867e-05 - timing_s/generate_sequences:32.317623138427734 - timing_s/reshard:0.6352329254150391 - timing_s/gen:44.249028105288744 - timing_s/reward:0.07052634842693806 - timing_s/old_log_prob:1.0884342603385448 - timing_s/ref:1.3470210246741772 - timing_s/adv:0.0076736994087696075 - timing_s/update_actor:7.024610988795757 - timing_s/step:53.80061047151685 - timing_s/stop_profile:4.270300269126892e-05 - timing_per_token_ms/update_actor:0.031797512137118275 - timing_per_token_ms/gen:0.49159032246021356 - timing_per_token_ms/ref:0.006097407735367478 - timing_per_token_ms/adv:3.4735667281239594e-05 - perf/total_num_tokens:220917 - perf/time_per_step:53.80061047151685 - perf/throughput:513.2771683811981
[36m(TaskRunner pid=2905377)[0m Training Progress:   7%|▋         | 35/525 [34:09<7:29:03, 54.99s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   7%|▋         | 36/525 [35:03<7:24:54, 54.59s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   7%|▋         | 37/525 [35:41<6:44:20, 49.71s/it]
[36m(TaskRunner pid=2905377)[0m step:35 - global_seqlen/min:27225 - global_seqlen/max:29764 - global_seqlen/minmax_diff:2539 - global_seqlen/balanced_min:28572 - global_seqlen/balanced_max:28690 - global_seqlen/mean:28601.875 - actor/entropy:0.5301375985145569 - actor/kl_loss:0.04211515570059419 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15247324220836161 - actor/pg_clipfrac:0.001662576268427074 - actor/ppo_kl:-0.0002800227761326823 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.100171998143196 - perf/mfu/actor:0.08588471537751269 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55018615722656 - actor/lr:1e-06 - training/global_step:35 - training/epoch:0 - critic/score/mean:0.9399999380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9399999380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.023225629702210426 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.023225629702210426 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:305.53125 - response_length/max:1436.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.388422429561615e-05 - timing_s/generate_sequences:31.5885066986084 - timing_s/reshard:0.6456781029701233 - timing_s/gen:45.893764559179544 - timing_s/reward:0.07183627597987652 - timing_s/old_log_prob:1.0957514625042677 - timing_s/ref:1.3526214454323053 - timing_s/adv:0.0076890382915735245 - timing_s/update_actor:7.107647379860282 - timing_s/step:55.54355366155505 - timing_s/stop_profile:4.215911030769348e-05 - timing_per_token_ms/update_actor:0.031062855931037223 - timing_per_token_ms/gen:0.46940538569274365 - timing_per_token_ms/ref:0.005911419467396392 - timing_per_token_ms/adv:3.360373354707307e-05 - perf/total_num_tokens:228815 - perf/time_per_step:55.54355366155505 - perf/throughput:514.9449956745751
[36m(TaskRunner pid=2905377)[0m step:36 - global_seqlen/min:25951 - global_seqlen/max:30700 - global_seqlen/minmax_diff:4749 - global_seqlen/balanced_min:28164 - global_seqlen/balanced_max:28168 - global_seqlen/mean:28164.75 - actor/entropy:0.5084878206253052 - actor/kl_loss:0.04680098947137594 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05045121088624001 - actor/pg_clipfrac:0.002111632493324578 - actor/ppo_kl:-0.0008955134647294471 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1961766481399536 - perf/mfu/actor:0.08490094800026095 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.0648078918457 - actor/lr:1e-06 - training/global_step:36 - training/epoch:1 - critic/score/mean:0.964062511920929 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.964062511920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.01530962623655796 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01530962623655796 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:294.4937438964844 - response_length/max:1266.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003548804670572281 - timing_s/generate_sequences:31.302215576171875 - timing_s/reshard:0.7923991084098816 - timing_s/gen:41.79055912233889 - timing_s/reward:0.07180277444422245 - timing_s/old_log_prob:1.1293208058923483 - timing_s/ref:1.363976627588272 - timing_s/adv:0.009144512936472893 - timing_s/update_actor:7.074651261791587 - timing_s/step:51.47380333393812 - timing_s/stop_profile:4.483573138713837e-05 - timing_per_token_ms/update_actor:0.031398517924851044 - timing_per_token_ms/gen:0.44345761924424215 - timing_per_token_ms/ref:0.006053562642968037 - timing_per_token_ms/adv:4.0584919697817716e-05 - perf/total_num_tokens:225318 - perf/time_per_step:51.47380333393812 - perf/throughput:547.1666785001331
[36m(TaskRunner pid=2905377)[0m step:37 - global_seqlen/min:25795 - global_seqlen/max:30004 - global_seqlen/minmax_diff:4209 - global_seqlen/balanced_min:27697 - global_seqlen/balanced_max:27698 - global_seqlen/mean:27697.25 - actor/entropy:0.5611359477043152 - actor/kl_loss:0.0423615638166666 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1180838230997324 - actor/pg_clipfrac:0.00112864431575872 - actor/ppo_kl:-0.00042560692818369714 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0141952335834503 - perf/mfu/actor:0.08422141455948229 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.0610466003418 - actor/lr:1e-06 - training/global_step:37 - training/epoch:1 - critic/score/mean:0.9878125190734863 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9878125190734863 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.018811486661434174 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.018811486661434174 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:283.6812438964844 - response_length/max:817.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.085370063781738e-05 - timing_s/generate_sequences:24.23188591003418 - timing_s/reshard:0.6628521680831909 - timing_s/gen:28.678664453327656 - timing_s/reward:0.0704679824411869 - timing_s/old_log_prob:1.18974076397717 - timing_s/ref:1.3602449297904968 - timing_s/adv:0.007510025054216385 - timing_s/update_actor:7.0061132069677114 - timing_s/step:38.32604097761214 - timing_s/stop_profile:4.260055720806122e-05 - timing_per_token_ms/update_actor:0.031619173415085036 - timing_per_token_ms/gen:0.31592086687664034 - timing_per_token_ms/ref:0.006138898851828687 - timing_per_token_ms/adv:3.389336962250939e-05 - perf/total_num_tokens:221578 - perf/time_per_step:38.32604097761214 - perf/throughput:722.6744347577966
[36m(TaskRunner pid=2905377)[0m Training Progress:   7%|▋         | 38/525 [36:25<6:27:50, 47.78s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   7%|▋         | 39/525 [37:24<6:54:35, 51.18s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 11:39:21,058:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 11:39:24,653:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 11:39:24,655:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 11:39:25,612:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/huggingface
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:39:21,226:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   8%|▊         | 40/525 [38:30<7:29:27, 55.60s/it]
[36m(TaskRunner pid=2905377)[0m step:38 - global_seqlen/min:25675 - global_seqlen/max:30465 - global_seqlen/minmax_diff:4790 - global_seqlen/balanced_min:28053 - global_seqlen/balanced_max:28054 - global_seqlen/mean:28053.25 - actor/entropy:0.5464512705802917 - actor/kl_loss:0.05034247124567628 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.029402599576860665 - actor/pg_clipfrac:0.0011457589454948903 - actor/ppo_kl:-1.0883693903451785e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0167624354362488 - perf/mfu/actor:0.08549855441541598 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.10000228881836 - actor/lr:1e-06 - training/global_step:38 - training/epoch:1 - critic/score/mean:0.9078124761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9078124761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.0017554914811626077 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0017554914811626077 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:291.15936279296875 - response_length/max:999.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.293295443058014e-05 - timing_s/generate_sequences:26.670408248901367 - timing_s/reshard:0.6581439971923828 - timing_s/gen:33.58363892138004 - timing_s/reward:0.07004790008068085 - timing_s/old_log_prob:1.0979418456554413 - timing_s/ref:1.3492183554917574 - timing_s/adv:0.007496098056435585 - timing_s/update_actor:6.993691394105554 - timing_s/step:43.11541792936623 - timing_s/stop_profile:4.393234848976135e-05 - timing_per_token_ms/update_actor:0.03116257204648995 - timing_per_token_ms/gen:0.3604516311017381 - timing_per_token_ms/ref:0.0060118629547902536 - timing_per_token_ms/adv:3.340120153830476e-05 - perf/total_num_tokens:224426 - perf/time_per_step:43.11541792936623 - perf/throughput:650.6547158132202
[36m(TaskRunner pid=2905377)[0m step:39 - global_seqlen/min:26704 - global_seqlen/max:34777 - global_seqlen/minmax_diff:8073 - global_seqlen/balanced_min:29170 - global_seqlen/balanced_max:29297 - global_seqlen/mean:29186.0 - actor/entropy:0.5404939651489258 - actor/kl_loss:0.046252017840743065 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.014306723885238171 - actor/pg_clipfrac:0.0014635889703640715 - actor/ppo_kl:0.00034676440227485725 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9738967567682266 - perf/mfu/actor:0.08776470187554812 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.02050399780273 - actor/lr:1e-06 - training/global_step:39 - training/epoch:1 - critic/score/mean:0.9759374856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9759374856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.014588849619030952 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.014588849619030952 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:320.2437438964844 - response_length/max:1553.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.69980251789093e-05 - timing_s/generate_sequences:35.47295379638672 - timing_s/reshard:0.6309585571289062 - timing_s/gen:49.23369899392128 - timing_s/reward:0.07404816150665283 - timing_s/old_log_prob:1.3197228126227856 - timing_s/ref:1.3559087198227644 - timing_s/adv:0.007540764287114143 - timing_s/update_actor:7.1022887248545885 - timing_s/step:59.10674890875816 - timing_s/stop_profile:4.43141907453537e-05 - timing_per_token_ms/update_actor:0.030418217316755414 - timing_per_token_ms/gen:0.48043188776050744 - timing_per_token_ms/ref:0.005807188034600341 - timing_per_token_ms/adv:3.2296153494458575e-05 - perf/total_num_tokens:233488 - perf/time_per_step:59.10674890875816 - perf/throughput:493.78455995023194
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40
[36m(TaskRunner pid=2905377)[0m step:40 - global_seqlen/min:26094 - global_seqlen/max:33117 - global_seqlen/minmax_diff:7023 - global_seqlen/balanced_min:28694 - global_seqlen/balanced_max:28893 - global_seqlen/mean:28761.75 - actor/entropy:0.5394410490989685 - actor/kl_loss:0.05486201094463468 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02126191183924675 - actor/pg_clipfrac:0.002029617503285408 - actor/ppo_kl:0.0005737119885452557 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.022659420967102 - perf/mfu/actor:0.08234771821722763 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.0573616027832 - actor/lr:1e-06 - training/global_step:40 - training/epoch:1 - critic/score/mean:0.9125000238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9125000238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.007810460869222879 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.007810460869222879 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:309.96563720703125 - response_length/max:1476.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.189678192138672e-05 - timing_s/generate_sequences:29.944692611694336 - timing_s/reshard:0.6530701518058777 - timing_s/gen:47.91346270032227 - timing_s/reward:0.0720817968249321 - timing_s/old_log_prob:1.120327427983284 - timing_s/ref:1.354951187968254 - timing_s/adv:0.007529828697443008 - timing_s/update_actor:7.455983839929104 - timing_s/save_checkpoint:7.962340272963047 - timing_s/step:65.90048719197512 - timing_s/stop_profile:5.179643630981445e-05 - timing_per_token_ms/update_actor:0.032404077637526854 - timing_per_token_ms/gen:0.4830521801845192 - timing_per_token_ms/ref:0.005888685441464159 - timing_per_token_ms/adv:3.2725011071314366e-05 - perf/total_num_tokens:230094 - perf/time_per_step:65.90048719197512 - perf/throughput:436.44214520317536
[36m(TaskRunner pid=2905377)[0m Training Progress:   8%|▊         | 41/525 [39:05<6:40:08, 49.60s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:39:26,210:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:39:26,212:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_40/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:   8%|▊         | 42/525 [39:47<6:20:46, 47.30s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   8%|▊         | 43/525 [41:00<7:21:14, 54.93s/it]
[36m(TaskRunner pid=2905377)[0m step:41 - global_seqlen/min:25130 - global_seqlen/max:28093 - global_seqlen/minmax_diff:2963 - global_seqlen/balanced_min:26779 - global_seqlen/balanced_max:26780 - global_seqlen/mean:26779.125 - actor/entropy:0.6155178546905518 - actor/kl_loss:0.056783385761082175 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.007269820221699775 - actor/pg_clipfrac:0.0015383176621980965 - actor/ppo_kl:3.5462017694953826e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1912611722946167 - perf/mfu/actor:0.08134622596689563 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:91.95954513549805 - actor/lr:1e-06 - training/global_step:41 - training/epoch:1 - critic/score/mean:0.9006249308586121 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9006249308586121 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02168484404683113 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02168484404683113 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:259.1968688964844 - response_length/max:757.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.654221892356873e-05 - timing_s/generate_sequences:21.470272064208984 - timing_s/reshard:0.6594861149787903 - timing_s/gen:25.94814809039235 - timing_s/reward:0.06838032975792885 - timing_s/old_log_prob:1.1235565543174744 - timing_s/ref:1.3525912538170815 - timing_s/adv:0.007503330707550049 - timing_s/update_actor:7.004165316000581 - timing_s/step:35.5176313072443 - timing_s/stop_profile:4.16245311498642e-05 - timing_per_token_ms/update_actor:0.032694147568304514 - timing_per_token_ms/gen:0.31284313432589067 - timing_per_token_ms/ref:0.006313645674649011 - timing_per_token_ms/adv:3.502415924507451e-05 - perf/total_num_tokens:214233 - perf/time_per_step:35.5176313072443 - perf/throughput:753.9670866096872
[36m(TaskRunner pid=2905377)[0m step:42 - global_seqlen/min:26731 - global_seqlen/max:30237 - global_seqlen/minmax_diff:3506 - global_seqlen/balanced_min:28322 - global_seqlen/balanced_max:28322 - global_seqlen/mean:28322.0 - actor/entropy:0.5031130909919739 - actor/kl_loss:0.04575015995651484 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.18416161946952342 - actor/pg_clipfrac:0.0012400418694596738 - actor/ppo_kl:-0.0006030661047020658 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1004100143909454 - perf/mfu/actor:0.08554720334769522 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.00281524658203 - actor/lr:1e-06 - training/global_step:42 - training/epoch:1 - critic/score/mean:1.0281250476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0281250476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.012628319673240185 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.012628319673240185 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:298.64373779296875 - response_length/max:955.0 - response_length/min:90.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.030980825424194e-05 - timing_s/generate_sequences:25.775320053100586 - timing_s/reshard:0.6487923860549927 - timing_s/gen:32.30925572477281 - timing_s/reward:0.07106203399598598 - timing_s/old_log_prob:1.0960930734872818 - timing_s/ref:1.3603864163160324 - timing_s/adv:0.007547501474618912 - timing_s/update_actor:7.0589596424251795 - timing_s/step:41.916515327990055 - timing_s/stop_profile:4.343688488006592e-05 - timing_per_token_ms/update_actor:0.03115493098309256 - timing_per_token_ms/gen:0.33808316477379835 - timing_per_token_ms/ref:0.006004106420433022 - timing_per_token_ms/adv:3.331112507334807e-05 - perf/total_num_tokens:226576 - perf/time_per_step:41.916515327990055 - perf/throughput:675.6763957687051
[36m(TaskRunner pid=2905377)[0m step:43 - global_seqlen/min:24490 - global_seqlen/max:33570 - global_seqlen/minmax_diff:9080 - global_seqlen/balanced_min:28135 - global_seqlen/balanced_max:28908 - global_seqlen/mean:28232.625 - actor/entropy:0.5272580981254578 - actor/kl_loss:0.05738737536594272 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05457565858960152 - actor/pg_clipfrac:0.0013434224354568868 - actor/ppo_kl:0.0013665272985235789 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0384241342544556 - perf/mfu/actor:0.08571633087014349 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.06774139404297 - actor/lr:1e-06 - training/global_step:43 - training/epoch:1 - critic/score/mean:0.9556249380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9556249380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.025898445397615433 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.025898445397615433 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:296.08123779296875 - response_length/max:2048.0 - response_length/min:83.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.075684309005737e-05 - timing_s/generate_sequences:36.544036865234375 - timing_s/reshard:0.6670759916305542 - timing_s/gen:63.02155775204301 - timing_s/reward:0.07107210159301758 - timing_s/old_log_prob:1.2036898992955685 - timing_s/ref:1.3573274500668049 - timing_s/adv:0.007651692256331444 - timing_s/update_actor:7.028091572225094 - timing_s/step:72.70273098163307 - timing_s/stop_profile:4.628114402294159e-05 - timing_per_token_ms/update_actor:0.03111688858291203 - timing_per_token_ms/gen:0.6651632549346992 - timing_per_token_ms/ref:0.00600956982421403 - timing_per_token_ms/adv:3.387788177831252e-05 - perf/total_num_tokens:225861 - perf/time_per_step:72.70273098163307 - perf/throughput:388.3296351980564
[36m(TaskRunner pid=2905377)[0m Training Progress:   8%|▊         | 44/525 [41:51<7:10:55, 53.75s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   9%|▊         | 45/525 [43:03<7:52:43, 59.09s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   9%|▉         | 46/525 [43:43<7:07:43, 53.58s/it]
[36m(TaskRunner pid=2905377)[0m step:44 - global_seqlen/min:25050 - global_seqlen/max:30750 - global_seqlen/minmax_diff:5700 - global_seqlen/balanced_min:27239 - global_seqlen/balanced_max:27338 - global_seqlen/mean:27252.5 - actor/entropy:0.5707986354827881 - actor/kl_loss:0.05298329638317227 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.021128921955823898 - actor/pg_clipfrac:0.001254636439261958 - actor/ppo_kl:0.0007040957676508697 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1087487936019897 - perf/mfu/actor:0.08169880069691252 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.14581680297852 - actor/lr:1e-06 - training/global_step:44 - training/epoch:1 - critic/score/mean:0.9918750524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9918750524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0027668888214975595 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.0027668888214975595 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:271.578125 - response_length/max:1257.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.80211591720581e-05 - timing_s/generate_sequences:27.776214599609375 - timing_s/reshard:0.6579513549804688 - timing_s/gen:41.07388873398304 - timing_s/reward:0.06897307559847832 - timing_s/old_log_prob:1.0779586154967546 - timing_s/ref:1.3498117364943027 - timing_s/adv:0.007469018921256065 - timing_s/update_actor:7.106314357370138 - timing_s/step:50.697628792375326 - timing_s/stop_profile:4.430115222930908e-05 - timing_per_token_ms/update_actor:0.03259478193454792 - timing_per_token_ms/gen:0.4726297535697951 - timing_per_token_ms/ref:0.006191228953739578 - timing_per_token_ms/adv:3.4258411711109374e-05 - perf/total_num_tokens:218020 - perf/time_per_step:50.697628792375326 - perf/throughput:537.5497957036334
[36m(TaskRunner pid=2905377)[0m step:45 - global_seqlen/min:27254 - global_seqlen/max:31576 - global_seqlen/minmax_diff:4322 - global_seqlen/balanced_min:28541 - global_seqlen/balanced_max:29513 - global_seqlen/mean:28663.125 - actor/entropy:0.5487390160560608 - actor/kl_loss:0.05836519603617489 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14782478883862496 - actor/pg_clipfrac:0.0019613626354839653 - actor/ppo_kl:0.00011147112600156106 - actor/pg_clipfrac_lower:9.671180159784854e-05 - actor/grad_norm:0.914407029747963 - perf/mfu/actor:0.08664807911020858 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.12872314453125 - actor/lr:1e-06 - training/global_step:45 - training/epoch:1 - critic/score/mean:0.9271875619888306 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9271875619888306 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03725578635931015 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03725578635931015 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:306.953125 - response_length/max:2048.0 - response_length/min:79.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.785538375377655e-05 - timing_s/generate_sequences:35.07150650024414 - timing_s/reshard:0.6908829808235168 - timing_s/gen:61.75638624839485 - timing_s/reward:0.07425830326974392 - timing_s/old_log_prob:1.179628288373351 - timing_s/ref:1.3532489649951458 - timing_s/adv:0.007438203319907188 - timing_s/update_actor:7.059722056612372 - timing_s/step:71.44378240220249 - timing_s/stop_profile:4.3276697397232056e-05 - timing_per_token_ms/update_actor:0.03078747544367708 - timing_per_token_ms/gen:0.6287237083063868 - timing_per_token_ms/ref:0.005901524018207827 - timing_per_token_ms/adv:3.243803371015542e-05 - perf/total_num_tokens:229305 - perf/time_per_step:71.44378240220249 - perf/throughput:401.19831336248467
[36m(TaskRunner pid=2905377)[0m step:46 - global_seqlen/min:25308 - global_seqlen/max:31363 - global_seqlen/minmax_diff:6055 - global_seqlen/balanced_min:28173 - global_seqlen/balanced_max:28173 - global_seqlen/mean:28173.0 - actor/entropy:0.505536675453186 - actor/kl_loss:0.06615504790097475 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.055495196208357814 - actor/pg_clipfrac:0.002007259614765644 - actor/ppo_kl:-0.0012954384190379642 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1780256927013397 - perf/mfu/actor:0.08546058396975315 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.1773681640625 - actor/lr:1e-06 - training/global_step:46 - training/epoch:1 - critic/score/mean:0.9759374856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9759374856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0034058773890137672 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0034058773890137672 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:294.59063720703125 - response_length/max:904.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.975155651569366e-05 - timing_s/generate_sequences:26.2493896484375 - timing_s/reshard:0.6558178663253784 - timing_s/gen:30.991775834932923 - timing_s/reward:0.07189316675066948 - timing_s/old_log_prob:1.0897830706089735 - timing_s/ref:1.3567376974970102 - timing_s/adv:0.0075041186064481735 - timing_s/update_actor:7.028493385761976 - timing_s/step:40.559604965150356 - timing_s/stop_profile:4.3589621782302856e-05 - timing_per_token_ms/update_actor:0.031184526788778158 - timing_per_token_ms/gen:0.3287589327873736 - timing_per_token_ms/ref:0.0060196717490904866 - timing_per_token_ms/adv:3.3294815099777154e-05 - perf/total_num_tokens:225384 - perf/time_per_step:40.559604965150356 - perf/throughput:694.6073568568239
[36m(TaskRunner pid=2905377)[0m Training Progress:   9%|▉         | 47/525 [44:44<7:22:52, 55.59s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   9%|▉         | 48/525 [45:31<7:03:16, 53.24s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:   9%|▉         | 49/525 [46:43<7:46:54, 58.85s/it]
[36m(TaskRunner pid=2905377)[0m step:47 - global_seqlen/min:27328 - global_seqlen/max:33802 - global_seqlen/minmax_diff:6474 - global_seqlen/balanced_min:29211 - global_seqlen/balanced_max:29667 - global_seqlen/mean:29268.125 - actor/entropy:0.500612199306488 - actor/kl_loss:0.06279037287458777 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.037776595819741486 - actor/pg_clipfrac:0.001807755749905482 - actor/ppo_kl:0.0017776145904463193 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.957348421216011 - perf/mfu/actor:0.08864887289107928 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.17673110961914 - actor/lr:1e-06 - training/global_step:47 - training/epoch:1 - critic/score/mean:0.9606249928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9606249928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.014099047519266605 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.014099047519266605 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:322.1875 - response_length/max:1672.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.270144462585449e-05 - timing_s/generate_sequences:35.141357421875 - timing_s/reshard:0.8165578842163086 - timing_s/gen:50.648248152807355 - timing_s/reward:0.0728339608758688 - timing_s/old_log_prob:1.117156708613038 - timing_s/ref:1.3622420970350504 - timing_s/adv:0.00756491906940937 - timing_s/update_actor:7.0519929975271225 - timing_s/step:60.27329838089645 - timing_s/stop_profile:4.306621849536896e-05 - timing_per_token_ms/update_actor:0.03011805931165356 - timing_per_token_ms/gen:0.49125361932887834 - timing_per_token_ms/ref:0.005817942288048219 - timing_per_token_ms/adv:3.230869362749309e-05 - perf/total_num_tokens:234145 - perf/time_per_step:60.27329838089645 - perf/throughput:485.59023292603644
[36m(TaskRunner pid=2905377)[0m step:48 - global_seqlen/min:25345 - global_seqlen/max:31931 - global_seqlen/minmax_diff:6586 - global_seqlen/balanced_min:29641 - global_seqlen/balanced_max:29642 - global_seqlen/mean:29641.75 - actor/entropy:0.5292040705680847 - actor/kl_loss:0.053324205428361894 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14463815027847887 - actor/pg_clipfrac:0.0009195902675855905 - actor/ppo_kl:0.0008850515276378701 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9420692026615143 - perf/mfu/actor:0.08941674179509096 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.1652717590332 - actor/lr:1e-06 - training/global_step:48 - training/epoch:1 - critic/score/mean:0.9693750143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9693750143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.011240720748901367 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.011240720748901367 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:331.63751220703125 - response_length/max:1160.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.884018123149872e-05 - timing_s/generate_sequences:31.72613525390625 - timing_s/reshard:0.7170460224151611 - timing_s/gen:38.10581226833165 - timing_s/reward:0.0738692469894886 - timing_s/old_log_prob:1.1123177837580442 - timing_s/ref:1.352832006290555 - timing_s/adv:0.0074974242597818375 - timing_s/update_actor:7.083773234859109 - timing_s/step:47.749401995912194 - timing_s/stop_profile:4.133954644203186e-05 - timing_per_token_ms/update_actor:0.029872448636041684 - timing_per_token_ms/gen:0.3590687522928993 - timing_per_token_ms/ref:0.0057049263551011455 - timing_per_token_ms/adv:3.161682533833966e-05 - perf/total_num_tokens:237134 - perf/time_per_step:47.749401995912194 - perf/throughput:620.7774079042417
[36m(TaskRunner pid=2905377)[0m step:49 - global_seqlen/min:26123 - global_seqlen/max:33341 - global_seqlen/minmax_diff:7218 - global_seqlen/balanced_min:29308 - global_seqlen/balanced_max:30083 - global_seqlen/mean:29406.375 - actor/entropy:0.5001069903373718 - actor/kl_loss:0.06752158962190151 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0290747145190835 - actor/pg_clipfrac:0.000982426176778972 - actor/ppo_kl:0.00040484117653249996 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0855883955955505 - perf/mfu/actor:0.08873011248351902 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.17346572875977 - actor/lr:1e-06 - training/global_step:49 - training/epoch:1 - critic/score/mean:0.9728125333786011 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9728125333786011 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05390239879488945 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.05390239879488945 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:325.42498779296875 - response_length/max:2048.0 - response_length/min:82.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.737295866012573e-05 - timing_s/generate_sequences:36.220149993896484 - timing_s/reshard:0.6775368452072144 - timing_s/gen:62.16888222284615 - timing_s/reward:0.07438294030725956 - timing_s/old_log_prob:1.1573386769741774 - timing_s/ref:1.3551887907087803 - timing_s/adv:0.0075990185141563416 - timing_s/update_actor:7.080335520207882 - timing_s/step:71.85692581534386 - timing_s/stop_profile:4.326365888118744e-05 - timing_per_token_ms/update_actor:0.030096941225363046 - timing_per_token_ms/gen:0.5969970252635607 - timing_per_token_ms/ref:0.005760607991926837 - timing_per_token_ms/adv:3.2301747980481875e-05 - perf/total_num_tokens:235251 - perf/time_per_step:71.85692581534386 - perf/throughput:409.23508299767474
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <think>
[36m(TaskRunner pid=2905377)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and its foci on the \(x\)-axis, the standard form of the equation of the hyperbola is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the semi-major axis. The foci of the hyperbola are located at \((\pm c, 0)\) where \(c = \sqrt{2}a\).
[36m(TaskRunner pid=2905377)[0m 
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:49:59,460:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/model_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:50:02,780:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 11:50:02,783:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 11:50:04,390:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/huggingface
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 11:50:00,007:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m The equation of the parabola is \(y^2 = 16x\). The focus of the parabola is at \((4, 0)\) and the directrix is the line \(x = -4\). The hyperbola intersects the parabola at points \(A\) and \(B\), and the distance between these points is \(|AB| = 4\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Since the hyperbola and the parabola intersect at points that are symmetric with respect to the \(x\)-axis, let's assume the coordinates of \(A\) and \(B\) are \((x_1, y_1)\) and \((x_1, -y_1)\) respectively. The distance between these points is \(2|y_1| = 4\sqrt{3}\), so \(|y_1| = 2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Substituting \(y_1 = 2\sqrt{3}\) into the equation of the parabola, we get:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m (2\sqrt{3})^2 = 16x_1 \implies 12 = 16x_1 \implies x_1 = \frac{12}{16} = \frac{3}{4}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m So, the coordinates of \(A\) and \(B\) are \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) respectively.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Now, we need to find the distance between the foci of the hyperbola, which is \(2c = 2\sqrt{2}a\). The distance between the points \(A\) and \(B\) is the same as the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\), which is \(4\sqrt{3}\). This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) (or \(\left(\frac{3}{4}, 0\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\)), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - 0)^2} = 2\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - (-2\sqrt{3}))^2} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - 0)^2} = 2\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - (-2\sqrt{3}))^2} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - 0)^2} = 2\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - (-2\sqrt{3}))^2} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - 0)^2} = 2\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - (-2\sqrt{3}))^2} = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{\left(\frac{3}{4} - \frac{3}{4}\right)^2 + (2\sqrt{3} - 0)^2} = 2\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\)
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 0.0
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50
[36m(TaskRunner pid=2905377)[0m Training Progress:  10%|▉         | 50/525 [49:08<11:10:38, 84.71s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  10%|▉         | 51/525 [50:12<10:19:43, 78.45s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:50:04,785:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 11:50:04,787:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_50/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:50 - global_seqlen/min:25509 - global_seqlen/max:32682 - global_seqlen/minmax_diff:7173 - global_seqlen/balanced_min:29105 - global_seqlen/balanced_max:29864 - global_seqlen/mean:29200.875 - actor/entropy:0.4808540940284729 - actor/kl_loss:0.0670265367720276 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0789395347237587 - actor/pg_clipfrac:0.0009495294361840934 - actor/ppo_kl:-0.0002894439299780061 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9092287123203278 - perf/mfu/actor:0.08712379200624258 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.20298767089844 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.9620000231266022 - val-aux/grpo_convert/reward/std@50:0.4664095312125428 - val-aux/grpo_convert/reward/best@2/mean:1.1802000238299368 - val-aux/grpo_convert/reward/best@2/std:0.41502451626039755 - val-aux/grpo_convert/reward/worst@2/mean:0.7603000224232673 - val-aux/grpo_convert/reward/worst@2/std:0.37650385816058385 - val-aux/grpo_convert/reward/best@4/mean:1.346000023841858 - val-aux/grpo_convert/reward/best@4/std:0.3322862824451411 - val-aux/grpo_convert/reward/worst@4/mean:0.5950000211000442 - val-aux/grpo_convert/reward/worst@4/std:0.2953954790665159 - val-aux/grpo_convert/reward/best@8/mean:1.494000023841858 - val-aux/grpo_convert/reward/best@8/std:0.22599242644785167 - val-aux/grpo_convert/reward/worst@8/mean:0.4735000185966492 - val-aux/grpo_convert/reward/worst@8/std:0.2586936947911736 - val-aux/grpo_convert/reward/best@16/mean:1.572500023841858 - val-aux/grpo_convert/reward/best@16/std:0.11399013115177996 - val-aux/grpo_convert/reward/worst@16/mean:0.3678000146150589 - val-aux/grpo_convert/reward/worst@16/std:0.2875022033100715 - val-aux/grpo_convert/reward/best@32/mean:1.599000023841858 - val-aux/grpo_convert/reward/best@32/std:0.022338307903688678 - val-aux/grpo_convert/reward/worst@32/mean:0.23160000920295715 - val-aux/grpo_convert/reward/worst@32/std:0.2838015018283657 - val-core/grpo_convert/reward/best@50/mean:1.600000023841858 - val-core/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:0.14370000571012498 - val-aux/grpo_convert/reward/worst@50/std:0.24631503721427805 - training/global_step:50 - training/epoch:1 - critic/score/mean:0.9309374690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9309374690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04237915202975273 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04237915202975273 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:320.0687561035156 - response_length/max:2048.0 - response_length/min:70.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.760338485240936e-05 - timing_s/generate_sequences:36.4210319519043 - timing_s/reshard:0.8546446561813354 - timing_s/gen:61.32881336659193 - timing_s/reward:0.07292710617184639 - timing_s/old_log_prob:1.143576918169856 - timing_s/ref:1.3522932603955269 - timing_s/adv:0.007634008303284645 - timing_s/update_actor:7.159751964733005 - timing_s/testing:65.97362324781716 - timing_s/save_checkpoint:7.9876230340451 - timing_s/step:145.03976000100374 - timing_s/stop_profile:5.1783397793769836e-05 - timing_per_token_ms/update_actor:0.030648704725170926 - timing_per_token_ms/gen:0.5987855477006105 - timing_per_token_ms/ref:0.005788753164055559 - timing_per_token_ms/adv:3.2678850819045e-05 - perf/total_num_tokens:233607 - perf/time_per_step:145.03976000100374 - perf/throughput:201.33013871367353
[36m(TaskRunner pid=2905377)[0m step:51 - global_seqlen/min:28118 - global_seqlen/max:31363 - global_seqlen/minmax_diff:3245 - global_seqlen/balanced_min:29276 - global_seqlen/balanced_max:29709 - global_seqlen/mean:29331.0 - actor/entropy:0.540245532989502 - actor/kl_loss:0.07073166817426682 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09002188351005316 - actor/pg_clipfrac:0.0013686398917343468 - actor/ppo_kl:9.392807260155678e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9721639901399612 - perf/mfu/actor:0.08781032333171261 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.09798812866211 - actor/lr:1e-06 - training/global_step:51 - training/epoch:1 - critic/score/mean:0.9299999475479126 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9299999475479126 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01579836942255497 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01579836942255497 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:324.3062438964844 - response_length/max:1752.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.583200931549072e-05 - timing_s/generate_sequences:35.69783401489258 - timing_s/reshard:0.7422788739204407 - timing_s/gen:53.946306897327304 - timing_s/reward:0.07302934303879738 - timing_s/old_log_prob:1.2626465670764446 - timing_s/ref:1.3590746205300093 - timing_s/adv:0.008350955322384834 - timing_s/update_actor:7.135816695168614 - timing_s/step:63.80731094814837 - timing_s/stop_profile:4.402175545692444e-05 - timing_per_token_ms/update_actor:0.030410728815794784 - timing_per_token_ms/gen:0.5198241139483061 - timing_per_token_ms/ref:0.005791971892068159 - timing_per_token_ms/adv:3.5589288305823335e-05 - perf/total_num_tokens:234648 - perf/time_per_step:63.80731094814837 - perf/throughput:459.68086672442917
[36m(TaskRunner pid=2905377)[0m Training Progress:  10%|▉         | 52/525 [51:02<9:10:25, 69.82s/it] 
[36m(TaskRunner pid=2905377)[0m Training Progress:  10%|█         | 53/525 [52:14<9:15:12, 70.58s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  10%|█         | 54/525 [52:57<8:08:17, 62.20s/it]
[36m(TaskRunner pid=2905377)[0m step:52 - global_seqlen/min:25811 - global_seqlen/max:29230 - global_seqlen/minmax_diff:3419 - global_seqlen/balanced_min:27791 - global_seqlen/balanced_max:27959 - global_seqlen/mean:27812.5 - actor/entropy:0.5141585469245911 - actor/kl_loss:0.07153761954978108 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.012933886516839266 - actor/pg_clipfrac:0.0015104219259228558 - actor/ppo_kl:-0.0006841866131253483 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9175570607185364 - perf/mfu/actor:0.08420775118960552 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.1428337097168 - actor/lr:1e-06 - training/global_step:52 - training/epoch:1 - critic/score/mean:0.9850000143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9850000143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008415838703513145 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.008415838703513145 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:285.03125 - response_length/max:1271.0 - response_length/min:82.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001016668975353241 - timing_s/generate_sequences:29.127300262451172 - timing_s/reshard:0.6656491756439209 - timing_s/gen:39.78286515921354 - timing_s/reward:0.07045012339949608 - timing_s/old_log_prob:1.0926530007272959 - timing_s/ref:1.35691081546247 - timing_s/adv:0.007510580122470856 - timing_s/update_actor:7.040342403575778 - timing_s/step:49.36506059207022 - timing_s/stop_profile:4.377029836177826e-05 - timing_per_token_ms/update_actor:0.031641988330677655 - timing_per_token_ms/gen:0.43616780132895017 - timing_per_token_ms/ref:0.006098475575112225 - timing_per_token_ms/adv:3.375541628076789e-05 - perf/total_num_tokens:222500 - perf/time_per_step:49.36506059207022 - perf/throughput:563.4045550927101
[36m(TaskRunner pid=2905377)[0m step:53 - global_seqlen/min:26734 - global_seqlen/max:32199 - global_seqlen/minmax_diff:5465 - global_seqlen/balanced_min:29702 - global_seqlen/balanced_max:30130 - global_seqlen/mean:29756.375 - actor/entropy:0.4508415758609772 - actor/kl_loss:0.06964037949219345 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23949309457093476 - actor/pg_clipfrac:0.0016680199943948538 - actor/ppo_kl:0.0012474813788401207 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0358215123414993 - perf/mfu/actor:0.08860637990862304 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.20987701416016 - actor/lr:1e-06 - training/global_step:53 - training/epoch:1 - critic/score/mean:1.0021874904632568 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0021874904632568 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.017371201887726784 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.017371201887726784 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:334.39373779296875 - response_length/max:2048.0 - response_length/min:76.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.575059473514557e-05 - timing_s/generate_sequences:44.41366958618164 - timing_s/reshard:0.6742094159126282 - timing_s/gen:62.47596921399236 - timing_s/reward:0.07362891361117363 - timing_s/old_log_prob:1.143568554893136 - timing_s/ref:1.352708101272583 - timing_s/adv:0.007386302575469017 - timing_s/update_actor:7.180600104853511 - timing_s/step:72.24700652249157 - timing_s/stop_profile:4.145875573158264e-05 - timing_per_token_ms/update_actor:0.030164124934797632 - timing_per_token_ms/gen:0.5838548232247944 - timing_per_token_ms/ref:0.005682429820805555 - timing_per_token_ms/adv:3.102823586319325e-05 - perf/total_num_tokens:238051 - perf/time_per_step:72.24700652249157 - perf/throughput:411.8700058629612
[36m(TaskRunner pid=2905377)[0m step:54 - global_seqlen/min:25868 - global_seqlen/max:32697 - global_seqlen/minmax_diff:6829 - global_seqlen/balanced_min:28313 - global_seqlen/balanced_max:28314 - global_seqlen/mean:28313.625 - actor/entropy:0.4617655575275421 - actor/kl_loss:0.08275492768734694 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.058399925380945204 - actor/pg_clipfrac:0.0017709356965497137 - actor/ppo_kl:0.0008970693630544702 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0293312072753906 - perf/mfu/actor:0.08466364723946443 - perf/max_memory_allocated_gb:64.27729845046997 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.20561981201172 - actor/lr:1e-06 - training/global_step:54 - training/epoch:1 - critic/score/mean:0.890625 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.890625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.005776065867394209 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.005776065867394209 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:297.55938720703125 - response_length/max:960.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.820928633213043e-05 - timing_s/generate_sequences:25.982803344726562 - timing_s/reshard:0.7047017216682434 - timing_s/gen:32.84529579617083 - timing_s/reward:0.07107555493712425 - timing_s/old_log_prob:1.0830959882587194 - timing_s/ref:1.3461875971406698 - timing_s/adv:0.009030075743794441 - timing_s/update_actor:7.130904175341129 - timing_s/step:42.4990843757987 - timing_s/stop_profile:4.315190017223358e-05 - timing_per_token_ms/update_actor:0.03148176971043592 - timing_per_token_ms/gen:0.3449447672856345 - timing_per_token_ms/ref:0.005943196946437757 - timing_per_token_ms/adv:3.986629998717243e-05 - perf/total_num_tokens:226509 - perf/time_per_step:42.4990843757987 - perf/throughput:666.2172942277157
[36m(TaskRunner pid=2905377)[0m Training Progress:  10%|█         | 55/525 [54:12<8:37:53, 66.11s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  11%|█         | 56/525 [55:25<8:51:35, 68.01s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  11%|█         | 57/525 [56:36<8:59:11, 69.13s/it]
[36m(TaskRunner pid=2905377)[0m step:55 - global_seqlen/min:25668 - global_seqlen/max:36570 - global_seqlen/minmax_diff:10902 - global_seqlen/balanced_min:29566 - global_seqlen/balanced_max:29787 - global_seqlen/mean:29621.875 - actor/entropy:0.44400089979171753 - actor/kl_loss:0.08023304501548409 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1478592000901699 - actor/pg_clipfrac:0.0011520056810695677 - actor/ppo_kl:-0.0005575599772328132 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8938578516244888 - perf/mfu/actor:0.08734706366881127 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.25130844116211 - actor/lr:1e-06 - training/global_step:55 - training/epoch:1 - critic/score/mean:0.9587499499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9587499499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.014548632316291332 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.014548632316291332 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:330.59375 - response_length/max:2048.0 - response_length/min:81.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.207745850086212e-05 - timing_s/generate_sequences:41.13279342651367 - timing_s/reshard:0.6425347924232483 - timing_s/gen:65.38224057108164 - timing_s/reward:0.07470030337572098 - timing_s/old_log_prob:1.1406696997582912 - timing_s/ref:1.3567765727639198 - timing_s/adv:0.007542083039879799 - timing_s/update_actor:7.2561964355409145 - timing_s/step:75.23135948367417 - timing_s/stop_profile:4.216097295284271e-05 - timing_per_token_ms/update_actor:0.030620092564789175 - timing_per_token_ms/gen:0.6180380052092035 - timing_per_token_ms/ref:0.00572539961077717 - timing_per_token_ms/adv:3.182649241430446e-05 - perf/total_num_tokens:236975 - perf/time_per_step:75.23135948367417 - perf/throughput:393.74371543064024
[36m(TaskRunner pid=2905377)[0m step:56 - global_seqlen/min:24956 - global_seqlen/max:34537 - global_seqlen/minmax_diff:9581 - global_seqlen/balanced_min:28473 - global_seqlen/balanced_max:29139 - global_seqlen/mean:28557.75 - actor/entropy:0.4986605942249298 - actor/kl_loss:0.07607864956371486 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.036735419929027555 - actor/pg_clipfrac:0.001796349894721061 - actor/ppo_kl:-0.0002070057344099041 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8833959698677063 - perf/mfu/actor:0.08547793048108876 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.30445098876953 - actor/lr:1e-06 - training/global_step:56 - training/epoch:1 - critic/score/mean:0.9528124928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9528124928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0382317490875721 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0382317490875721 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:303.8812561035156 - response_length/max:2048.0 - response_length/min:68.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.82795250415802e-05 - timing_s/generate_sequences:33.666751861572266 - timing_s/reshard:0.7210389375686646 - timing_s/gen:62.72778404504061 - timing_s/reward:0.07313764095306396 - timing_s/old_log_prob:1.1110433153808117 - timing_s/ref:1.3490238953381777 - timing_s/adv:0.007508106529712677 - timing_s/update_actor:7.133717196062207 - timing_s/step:72.41559666022658 - timing_s/stop_profile:4.266388714313507e-05 - timing_per_token_ms/update_actor:0.03122496168317798 - timing_per_token_ms/gen:0.6450688390308776 - timing_per_token_ms/ref:0.005904806468201179 - timing_per_token_ms/adv:3.286369956365906e-05 - perf/total_num_tokens:228462 - perf/time_per_step:72.41559666022658 - perf/throughput:394.35910656088
[36m(TaskRunner pid=2905377)[0m step:57 - global_seqlen/min:25653 - global_seqlen/max:34877 - global_seqlen/minmax_diff:9224 - global_seqlen/balanced_min:29102 - global_seqlen/balanced_max:29771 - global_seqlen/mean:29186.75 - actor/entropy:0.44511178135871887 - actor/kl_loss:0.07599256038665772 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03617670298554003 - actor/pg_clipfrac:0.0010629582902765833 - actor/ppo_kl:-0.00021324255649233237 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8974955081939697 - perf/mfu/actor:0.08719960827771515 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.32232666015625 - actor/lr:1e-06 - training/global_step:57 - training/epoch:1 - critic/score/mean:0.9403125047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9403125047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05528191104531288 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.05528191104531288 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:319.60626220703125 - response_length/max:2048.0 - response_length/min:77.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.161792695522308e-05 - timing_s/generate_sequences:38.616172790527344 - timing_s/reshard:0.695481538772583 - timing_s/gen:61.8078720998019 - timing_s/reward:0.07235933840274811 - timing_s/old_log_prob:1.1717490907758474 - timing_s/ref:1.3532410468906164 - timing_s/adv:0.007458604872226715 - timing_s/update_actor:7.148744070902467 - timing_s/step:71.57475905306637 - timing_s/stop_profile:4.448741674423218e-05 - timing_per_token_ms/update_actor:0.030616393016105196 - timing_per_token_ms/gen:0.6043361176819319 - timing_per_token_ms/ref:0.005795613792605448 - timing_per_token_ms/adv:3.1943454102575294e-05 - perf/total_num_tokens:233494 - perf/time_per_step:71.57475905306637 - perf/throughput:407.77992669679264
[36m(TaskRunner pid=2905377)[0m Training Progress:  11%|█         | 58/525 [57:48<9:04:02, 69.90s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  11%|█         | 59/525 [58:42<8:26:01, 65.15s/it]
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 12:00:29,096:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/model_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 12:00:32,371:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 12:00:32,373:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:00:33,692:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/huggingface
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:00:29,575:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  11%|█▏        | 60/525 [59:38<8:04:10, 62.47s/it]
[36m(TaskRunner pid=2905377)[0m step:58 - global_seqlen/min:27181 - global_seqlen/max:33446 - global_seqlen/minmax_diff:6265 - global_seqlen/balanced_min:29664 - global_seqlen/balanced_max:30084 - global_seqlen/mean:29763.75 - actor/entropy:0.4574274718761444 - actor/kl_loss:0.06633699955418706 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.023815921507775784 - actor/pg_clipfrac:0.0008129019843181595 - actor/ppo_kl:-0.0006517154262837721 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8102316707372665 - perf/mfu/actor:0.0867594312523125 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.37433242797852 - actor/lr:1e-06 - training/global_step:58 - training/epoch:1 - critic/score/mean:1.0293749570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0293749570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04630805552005768 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04630805552005768 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:334.359375 - response_length/max:2048.0 - response_length/min:79.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.02706927061081e-05 - timing_s/generate_sequences:46.65696334838867 - timing_s/reshard:0.6442670822143555 - timing_s/gen:61.62011673115194 - timing_s/reward:0.07432358711957932 - timing_s/old_log_prob:1.2532475162297487 - timing_s/ref:1.375090129673481 - timing_s/adv:0.007576648145914078 - timing_s/update_actor:7.33865006454289 - timing_s/step:71.68219057656825 - timing_s/stop_profile:4.2458996176719666e-05 - timing_per_token_ms/update_actor:0.030820419405077022 - timing_per_token_ms/gen:0.5759158533683998 - timing_per_token_ms/ref:0.005775020493358032 - timing_per_token_ms/adv:3.181994937597782e-05 - perf/total_num_tokens:238110 - perf/time_per_step:71.68219057656825 - perf/throughput:415.21819800146136
[36m(TaskRunner pid=2905377)[0m step:59 - global_seqlen/min:26076 - global_seqlen/max:34621 - global_seqlen/minmax_diff:8545 - global_seqlen/balanced_min:28787 - global_seqlen/balanced_max:28900 - global_seqlen/mean:28802.0 - actor/entropy:0.5167039632797241 - actor/kl_loss:0.06861884966492653 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07608587071299552 - actor/pg_clipfrac:0.001467077451525256 - actor/ppo_kl:-0.0003922804735225327 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9340819865465164 - perf/mfu/actor:0.08644164416103181 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.35221481323242 - actor/lr:1e-06 - training/global_step:59 - training/epoch:1 - critic/score/mean:1.0281250476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0281250476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.004793948493897915 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.004793948493897915 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:310.53436279296875 - response_length/max:1381.0 - response_length/min:86.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.005090057849884e-05 - timing_s/generate_sequences:30.418014526367188 - timing_s/reshard:0.667611300945282 - timing_s/gen:44.31750962510705 - timing_s/reward:0.07220541127026081 - timing_s/old_log_prob:1.1954361721873283 - timing_s/ref:1.3532216921448708 - timing_s/adv:0.007570875808596611 - timing_s/update_actor:7.110697286203504 - timing_s/step:54.06981915049255 - timing_s/stop_profile:4.406645894050598e-05 - timing_per_token_ms/update_actor:0.030860258342317825 - timing_per_token_ms/gen:0.4459803124161682 - timing_per_token_ms/ref:0.005872950195059678 - timing_per_token_ms/adv:3.285742226493217e-05 - perf/total_num_tokens:230416 - perf/time_per_step:54.06981915049255 - perf/throughput:532.6816411173003
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60
[36m(TaskRunner pid=2905377)[0m step:60 - global_seqlen/min:25506 - global_seqlen/max:31073 - global_seqlen/minmax_diff:5567 - global_seqlen/balanced_min:27844 - global_seqlen/balanced_max:27992 - global_seqlen/mean:27873.375 - actor/entropy:0.48967963457107544 - actor/kl_loss:0.08127147685736417 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.022136267647147177 - actor/pg_clipfrac:0.001967822283040732 - actor/ppo_kl:0.000847017001160566 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9537752121686935 - perf/mfu/actor:0.08513193193891117 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.38251876831055 - actor/lr:1e-06 - training/global_step:60 - training/epoch:1 - critic/score/mean:1.0 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.01961071603000164 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01961071603000164 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:287.9750061035156 - response_length/max:1184.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.086355566978455e-05 - timing_s/generate_sequences:30.40732192993164 - timing_s/reshard:0.7570949792861938 - timing_s/gen:37.98681722767651 - timing_s/reward:0.07041926495730877 - timing_s/old_log_prob:1.2588301803916693 - timing_s/ref:1.3528425581753254 - timing_s/adv:0.007452553138136864 - timing_s/update_actor:6.977657115086913 - timing_s/save_checkpoint:8.23394738137722 - timing_s/step:55.90123923122883 - timing_s/stop_profile:4.8667192459106445e-05 - timing_per_token_ms/update_actor:0.03129176640381239 - timing_per_token_ms/gen:0.41221912956502854 - timing_per_token_ms/ref:0.006066912233337932 - timing_per_token_ms/adv:3.342146913558577e-05 - perf/total_num_tokens:222987 - perf/time_per_step:55.90123923122883 - perf/throughput:498.618194933123
[36m(TaskRunner pid=2905377)[0m Training Progress:  12%|█▏        | 61/525 [1:00:26<7:29:15, 58.09s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:00:34,713:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:00:34,715:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_60/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  12%|█▏        | 62/525 [1:01:33<7:47:45, 60.62s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  12%|█▏        | 63/525 [1:02:14<7:02:47, 54.91s/it]
[36m(TaskRunner pid=2905377)[0m step:61 - global_seqlen/min:26806 - global_seqlen/max:32093 - global_seqlen/minmax_diff:5287 - global_seqlen/balanced_min:28443 - global_seqlen/balanced_max:28444 - global_seqlen/mean:28443.625 - actor/entropy:0.4794101119041443 - actor/kl_loss:0.07552335876971483 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09879361279308796 - actor/pg_clipfrac:0.0013986949808895588 - actor/ppo_kl:-0.0009422523900866509 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8061140477657318 - perf/mfu/actor:0.08622568264729573 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.13516616821289 - actor/lr:1e-06 - training/global_step:61 - training/epoch:1 - critic/score/mean:0.981249988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.981249988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0027485040482133627 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0027485040482133627 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:301.68438720703125 - response_length/max:1148.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.612498641014099e-05 - timing_s/generate_sequences:28.544031143188477 - timing_s/reshard:0.6707902550697327 - timing_s/gen:38.11007425189018 - timing_s/reward:0.07204500772058964 - timing_s/old_log_prob:1.194917755201459 - timing_s/ref:1.3485760129988194 - timing_s/adv:0.007472535595297813 - timing_s/update_actor:7.035754708573222 - timing_s/step:47.78225595317781 - timing_s/stop_profile:4.287809133529663e-05 - timing_per_token_ms/update_actor:0.030919734688235157 - timing_per_token_ms/gen:0.39476350751396 - timing_per_token_ms/ref:0.005926530167123649 - timing_per_token_ms/adv:3.283923724251837e-05 - perf/total_num_tokens:227549 - perf/time_per_step:47.78225595317781 - perf/throughput:595.2758912821555
[36m(TaskRunner pid=2905377)[0m step:62 - global_seqlen/min:26969 - global_seqlen/max:35464 - global_seqlen/minmax_diff:8495 - global_seqlen/balanced_min:30183 - global_seqlen/balanced_max:30188 - global_seqlen/mean:30184.625 - actor/entropy:0.42319318652153015 - actor/kl_loss:0.08416327238082885 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05422801757231355 - actor/pg_clipfrac:0.0008972837647888809 - actor/ppo_kl:-0.0007591581778569889 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8359429687261581 - perf/mfu/actor:0.08660995618458894 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.18772888183594 - actor/lr:1e-06 - training/global_step:62 - training/epoch:1 - critic/score/mean:0.9893749952316284 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9893749952316284 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02716175839304924 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02716175839304924 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:345.2093811035156 - response_length/max:1788.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.481608867645264e-05 - timing_s/generate_sequences:43.31269073486328 - timing_s/reshard:0.6525610089302063 - timing_s/gen:56.270852809771895 - timing_s/reward:0.07457312941551208 - timing_s/old_log_prob:1.1596217509359121 - timing_s/ref:1.3596771620213985 - timing_s/adv:0.008556108921766281 - timing_s/update_actor:7.461535517126322 - timing_s/step:66.34806677512825 - timing_s/stop_profile:4.297122359275818e-05 - timing_per_token_ms/update_actor:0.03089957021632007 - timing_per_token_ms/gen:0.5093906126695927 - timing_per_token_ms/ref:0.005630669430303501 - timing_per_token_ms/adv:3.543239696437458e-05 - perf/total_num_tokens:241477 - perf/time_per_step:66.34806677512825 - perf/throughput:454.94354948281995
[36m(TaskRunner pid=2905377)[0m step:63 - global_seqlen/min:26518 - global_seqlen/max:29639 - global_seqlen/minmax_diff:3121 - global_seqlen/balanced_min:28145 - global_seqlen/balanced_max:28145 - global_seqlen/mean:28145.0 - actor/entropy:0.4367894232273102 - actor/kl_loss:0.07340267766267061 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1334793634712696 - actor/pg_clipfrac:0.0013317148026544602 - actor/ppo_kl:0.000669006123825966 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9582574218511581 - perf/mfu/actor:0.08316396359685871 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.22053909301758 - actor/lr:1e-06 - training/global_step:63 - training/epoch:1 - critic/score/mean:1.0203125476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0203125476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.0035765094216912985 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0035765094216912985 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:293.78125 - response_length/max:954.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.383447468280792e-05 - timing_s/generate_sequences:26.311725616455078 - timing_s/reshard:0.6670002937316895 - timing_s/gen:31.825483296066523 - timing_s/reward:0.07020722515881062 - timing_s/old_log_prob:1.095915112644434 - timing_s/ref:1.3414265792816877 - timing_s/adv:0.008166015148162842 - timing_s/update_actor:7.213146433234215 - timing_s/step:41.571723813191056 - timing_s/stop_profile:4.428252577781677e-05 - timing_per_token_ms/update_actor:0.0320356476871301 - timing_per_token_ms/gen:0.33853295709037895 - timing_per_token_ms/ref:0.005957659350158499 - timing_per_token_ms/adv:3.626761035780264e-05 - perf/total_num_tokens:225160 - perf/time_per_step:41.571723813191056 - perf/throughput:677.0226831697885
[36m(TaskRunner pid=2905377)[0m Training Progress:  12%|█▏        | 64/525 [1:03:09<7:01:20, 54.84s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  12%|█▏        | 65/525 [1:04:02<6:56:35, 54.34s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  13%|█▎        | 66/525 [1:04:56<6:54:56, 54.24s/it]
[36m(TaskRunner pid=2905377)[0m step:64 - global_seqlen/min:27384 - global_seqlen/max:30877 - global_seqlen/minmax_diff:3493 - global_seqlen/balanced_min:28946 - global_seqlen/balanced_max:29011 - global_seqlen/mean:28954.5 - actor/entropy:0.42018839716911316 - actor/kl_loss:0.07307584835216403 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09388749599456787 - actor/pg_clipfrac:0.0008468133397400379 - actor/ppo_kl:0.0002957287302706391 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.879791259765625 - perf/mfu/actor:0.08664073780742423 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.23890686035156 - actor/lr:1e-06 - training/global_step:64 - training/epoch:1 - critic/score/mean:1.0199999809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0199999809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.03474119305610657 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.03474119305610657 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:314.34686279296875 - response_length/max:1392.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.043700993061066e-05 - timing_s/generate_sequences:32.966636657714844 - timing_s/reshard:0.6727017760276794 - timing_s/gen:44.86013797298074 - timing_s/reward:0.07227495312690735 - timing_s/old_log_prob:1.2223828416317701 - timing_s/ref:1.3476926069706678 - timing_s/adv:0.00815395638346672 - timing_s/update_actor:7.136566828936338 - timing_s/step:54.66451563127339 - timing_s/stop_profile:3.966875374317169e-05 - timing_per_token_ms/update_actor:0.030809402808442292 - timing_per_token_ms/gen:0.44596572231094966 - timing_per_token_ms/ref:0.0058181483317388824 - timing_per_token_ms/adv:3.5201593808677065e-05 - perf/total_num_tokens:231636 - perf/time_per_step:54.66451563127339 - perf/throughput:529.6763296194877
[36m(TaskRunner pid=2905377)[0m step:65 - global_seqlen/min:26868 - global_seqlen/max:31565 - global_seqlen/minmax_diff:4697 - global_seqlen/balanced_min:29367 - global_seqlen/balanced_max:29452 - global_seqlen/mean:29398.875 - actor/entropy:0.49015915393829346 - actor/kl_loss:0.0888012196868658 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1313367437105626 - actor/pg_clipfrac:0.0007924514939077199 - actor/ppo_kl:0.00022612784669036047 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7774226516485214 - perf/mfu/actor:0.08827339969484661 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.25870132446289 - actor/lr:1e-06 - training/global_step:65 - training/epoch:1 - critic/score/mean:0.9371875524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9371875524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03198869526386261 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03198869526386261 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:325.56561279296875 - response_length/max:1315.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.669549763202667e-05 - timing_s/generate_sequences:34.496742248535156 - timing_s/reshard:0.6934370994567871 - timing_s/gen:43.364097364246845 - timing_s/reward:0.07303307950496674 - timing_s/old_log_prob:1.12231651134789 - timing_s/ref:1.35354570671916 - timing_s/adv:0.008401334285736084 - timing_s/update_actor:7.115986110642552 - timing_s/step:53.05427715368569 - timing_s/stop_profile:4.4016167521476746e-05 - timing_per_token_ms/update_actor:0.030256200750209628 - timing_per_token_ms/gen:0.416238060339667 - timing_per_token_ms/ref:0.005755091422372285 - timing_per_token_ms/adv:3.572132558531612e-05 - perf/total_num_tokens:235191 - perf/time_per_step:53.05427715368569 - perf/throughput:554.1282734818611
[36m(TaskRunner pid=2905377)[0m step:66 - global_seqlen/min:28098 - global_seqlen/max:32527 - global_seqlen/minmax_diff:4429 - global_seqlen/balanced_min:30351 - global_seqlen/balanced_max:30370 - global_seqlen/mean:30354.25 - actor/entropy:0.46570512652397156 - actor/kl_loss:0.07099714828655124 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13491058275103568 - actor/pg_clipfrac:0.0015551418851828202 - actor/ppo_kl:0.0005642562908178661 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8230297863483429 - perf/mfu/actor:0.08975317453779831 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.30970764160156 - actor/lr:1e-06 - training/global_step:66 - training/epoch:1 - critic/score/mean:0.9371874928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9371874928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.014647440984845161 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.014647440984845161 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:350.10626220703125 - response_length/max:1384.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.355826139450073e-05 - timing_s/generate_sequences:35.5609016418457 - timing_s/reshard:0.6442810297012329 - timing_s/gen:44.17364597693086 - timing_s/reward:0.07501235045492649 - timing_s/old_log_prob:1.1300531681627035 - timing_s/ref:1.3558446243405342 - timing_s/adv:0.008289283141493797 - timing_s/update_actor:7.23681315779686 - timing_s/step:53.99686877988279 - timing_s/stop_profile:4.279986023902893e-05 - timing_per_token_ms/update_actor:0.029801482320419955 - timing_per_token_ms/gen:0.3942878588368786 - timing_per_token_ms/ref:0.00558342169688155 - timing_per_token_ms/adv:3.41355952687589e-05 - perf/total_num_tokens:242834 - perf/time_per_step:53.99686877988279 - perf/throughput:562.1483372255996
[36m(TaskRunner pid=2905377)[0m Training Progress:  13%|█▎        | 67/525 [1:05:46<6:44:06, 52.94s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  13%|█▎        | 68/525 [1:06:34<6:32:44, 51.56s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  13%|█▎        | 69/525 [1:07:19<6:16:42, 49.57s/it]
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 12:09:11,924:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/model_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 12:09:15,573:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 12:09:15,576:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:09:16,433:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:67 - global_seqlen/min:24877 - global_seqlen/max:34665 - global_seqlen/minmax_diff:9788 - global_seqlen/balanced_min:30024 - global_seqlen/balanced_max:30025 - global_seqlen/mean:30024.75 - actor/entropy:0.46515876054763794 - actor/kl_loss:0.07660099826753139 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15781592866405844 - actor/pg_clipfrac:0.001452994448482059 - actor/ppo_kl:0.0007548611076344969 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9580190032720566 - perf/mfu/actor:0.08722454937674433 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.32115936279297 - actor/lr:1e-06 - training/global_step:67 - training/epoch:1 - critic/score/mean:1.0931249856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0931249856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03941087797284126 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03941087797284126 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:341.9781188964844 - response_length/max:1211.0 - response_length/min:78.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.02172178030014e-05 - timing_s/generate_sequences:34.687747955322266 - timing_s/reshard:0.6447458863258362 - timing_s/gen:39.9341255184263 - timing_s/reward:0.07446470484137535 - timing_s/old_log_prob:1.140729608014226 - timing_s/ref:1.3534148428589106 - timing_s/adv:0.008235320448875427 - timing_s/update_actor:7.364774625748396 - timing_s/step:49.89352807216346 - timing_s/stop_profile:3.9769336581230164e-05 - timing_per_token_ms/update_actor:0.030661265396666068 - timing_per_token_ms/gen:0.36491849367582263 - timing_per_token_ms/ref:0.005634579983425801 - timing_per_token_ms/adv:3.428554962520682e-05 - perf/total_num_tokens:240198 - perf/time_per_step:49.89352807216346 - perf/throughput:601.7764459665736
[36m(TaskRunner pid=2905377)[0m step:68 - global_seqlen/min:26563 - global_seqlen/max:29768 - global_seqlen/minmax_diff:3205 - global_seqlen/balanced_min:28379 - global_seqlen/balanced_max:28380 - global_seqlen/mean:28379.125 - actor/entropy:0.43011507391929626 - actor/kl_loss:0.08480109013617039 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.19213835999835283 - actor/pg_clipfrac:0.00092582693323493 - actor/ppo_kl:4.9919722368940714e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8552669137716293 - perf/mfu/actor:0.08438540314652876 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.31418991088867 - actor/lr:1e-06 - training/global_step:68 - training/epoch:1 - critic/score/mean:1.0234375 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0234375 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.02076881192624569 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.02076881192624569 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:300.2906188964844 - response_length/max:1166.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.991228580474854e-05 - timing_s/generate_sequences:31.816970825195312 - timing_s/reshard:0.6836047172546387 - timing_s/gen:38.52081336081028 - timing_s/reward:0.07065466046333313 - timing_s/old_log_prob:1.1097764074802399 - timing_s/ref:1.339715365320444 - timing_s/adv:0.008515404537320137 - timing_s/update_actor:7.177634574472904 - timing_s/step:48.24436446093023 - timing_s/stop_profile:4.407763481140137e-05 - timing_per_token_ms/update_actor:0.031614939565934926 - timing_per_token_ms/gen:0.40087012957041906 - timing_per_token_ms/ref:0.005900971952625584 - timing_per_token_ms/adv:3.750734270929837e-05 - perf/total_num_tokens:227033 - perf/time_per_step:48.24436446093023 - perf/throughput:588.2370991327348
[36m(TaskRunner pid=2905377)[0m step:69 - global_seqlen/min:24968 - global_seqlen/max:31373 - global_seqlen/minmax_diff:6405 - global_seqlen/balanced_min:28197 - global_seqlen/balanced_max:28198 - global_seqlen/mean:28197.5 - actor/entropy:0.4846067726612091 - actor/kl_loss:0.08703537415713072 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.030181003361940385 - actor/pg_clipfrac:0.00107547827064991 - actor/ppo_kl:0.0009700460883323103 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9674477428197861 - perf/mfu/actor:0.08526028613870182 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.36323928833008 - actor/lr:1e-06 - training/global_step:69 - training/epoch:1 - critic/score/mean:1.014062523841858 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.014062523841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.018150147050619125 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.018150147050619125 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:295.3125 - response_length/max:1101.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010102428495883942 - timing_s/generate_sequences:29.758365631103516 - timing_s/reshard:0.7589288949966431 - timing_s/gen:35.208184285089374 - timing_s/reward:0.07054458931088448 - timing_s/old_log_prob:1.1009369194507599 - timing_s/ref:1.3578157015144825 - timing_s/adv:0.007645860314369202 - timing_s/update_actor:7.051591204479337 - timing_s/step:44.81056008674204 - timing_s/stop_profile:4.3861567974090576e-05 - timing_per_token_ms/update_actor:0.03125982447237936 - timing_per_token_ms/gen:0.37257337867819446 - timing_per_token_ms/ref:0.006019220239003823 - timing_per_token_ms/adv:3.3894229605324944e-05 - perf/total_num_tokens:225580 - perf/time_per_step:44.81056008674204 - perf/throughput:629.2601553164408
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70
[36m(TaskRunner pid=2905377)[0m Training Progress:  13%|█▎        | 70/525 [1:08:21<6:43:23, 53.19s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:09:12,108:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  14%|█▎        | 71/525 [1:09:23<7:03:24, 55.96s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:09:17,356:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:09:17,358:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_70/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  14%|█▎        | 72/525 [1:10:35<7:38:47, 60.77s/it]
[36m(TaskRunner pid=2905377)[0m step:70 - global_seqlen/min:25539 - global_seqlen/max:31804 - global_seqlen/minmax_diff:6265 - global_seqlen/balanced_min:28891 - global_seqlen/balanced_max:28945 - global_seqlen/mean:28898.75 - actor/entropy:0.4061723053455353 - actor/kl_loss:0.06949653187766672 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1903787910938263 - actor/pg_clipfrac:0.0008990634174551815 - actor/ppo_kl:-0.0002599820754767279 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.822481632232666 - perf/mfu/actor:0.08643813519578178 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.36538696289062 - actor/lr:1e-06 - training/global_step:70 - training/epoch:1 - critic/score/mean:1.0274999141693115 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0274999141693115 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04147927835583687 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04147927835583687 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:313.171875 - response_length/max:1414.0 - response_length/min:28.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.386241436004639e-05 - timing_s/generate_sequences:31.78598403930664 - timing_s/reshard:0.6479470133781433 - timing_s/gen:43.58478077314794 - timing_s/reward:0.07242371328175068 - timing_s/old_log_prob:1.1725333128124475 - timing_s/ref:1.3573502395302057 - timing_s/adv:0.007564183324575424 - timing_s/update_actor:7.136667273938656 - timing_s/save_checkpoint:8.225970590487123 - timing_s/step:61.57078140601516 - timing_s/stop_profile:4.646182060241699e-05 - timing_per_token_ms/update_actor:0.03086927321224385 - timing_per_token_ms/gen:0.434912745329022 - timing_per_token_ms/ref:0.005871145981790759 - timing_per_token_ms/adv:3.271847106092575e-05 - perf/total_num_tokens:231190 - perf/time_per_step:61.57078140601516 - perf/throughput:469.35818159320513
[36m(TaskRunner pid=2905377)[0m step:71 - global_seqlen/min:25687 - global_seqlen/max:31036 - global_seqlen/minmax_diff:5349 - global_seqlen/balanced_min:28757 - global_seqlen/balanced_max:28921 - global_seqlen/mean:28777.875 - actor/entropy:0.45607057213783264 - actor/kl_loss:0.07396582830697299 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.018588444218039513 - actor/pg_clipfrac:0.0013841891021002084 - actor/ppo_kl:2.9935116617707536e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1245451867580414 - perf/mfu/actor:0.08642871880783842 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:91.97783660888672 - actor/lr:1e-06 - training/global_step:71 - training/epoch:2 - critic/score/mean:1.0243749618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0243749618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.003425816772505641 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.003425816772505641 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:309.4937438964844 - response_length/max:1588.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003356020897626877 - timing_s/generate_sequences:33.510276794433594 - timing_s/reshard:0.7006077766418457 - timing_s/gen:50.333714459091425 - timing_s/reward:0.07345971092581749 - timing_s/old_log_prob:1.231324089691043 - timing_s/ref:1.353828590363264 - timing_s/adv:0.009060436859726906 - timing_s/update_actor:7.109410144388676 - timing_s/step:60.13211002200842 - timing_s/stop_profile:4.319287836551666e-05 - timing_per_token_ms/update_actor:0.030880538192920238 - timing_per_token_ms/gen:0.508226281418157 - timing_per_token_ms/ref:0.005880509724759317 - timing_per_token_ms/adv:3.935504645377267e-05 - perf/total_num_tokens:230223 - perf/time_per_step:60.13211002200842 - perf/throughput:478.5775019281257
[36m(TaskRunner pid=2905377)[0m step:72 - global_seqlen/min:24591 - global_seqlen/max:32228 - global_seqlen/minmax_diff:7637 - global_seqlen/balanced_min:28736 - global_seqlen/balanced_max:29376 - global_seqlen/mean:28826.5 - actor/entropy:0.4383038282394409 - actor/kl_loss:0.08546520937234163 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10892572849988938 - actor/pg_clipfrac:0.00239936453581322 - actor/ppo_kl:-0.0012363380770068488 - actor/pg_clipfrac_lower:0.00017301038606092333 - actor/grad_norm:0.78690505027771 - perf/mfu/actor:0.08553087028593487 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.02510452270508 - actor/lr:1e-06 - training/global_step:72 - training/epoch:2 - critic/score/mean:0.9634374380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9634374380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.037408050149679184 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.037408050149679184 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:311.1468811035156 - response_length/max:2048.0 - response_length/min:76.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.038617670536041e-05 - timing_s/generate_sequences:41.71205139160156 - timing_s/reshard:0.6515625715255737 - timing_s/gen:62.10613189637661 - timing_s/reward:0.07216791063547134 - timing_s/old_log_prob:1.2374342419207096 - timing_s/ref:1.3502576723694801 - timing_s/adv:0.007416347041726112 - timing_s/update_actor:7.197160506621003 - timing_s/step:71.98363237082958 - timing_s/stop_profile:4.26173210144043e-05 - timing_per_token_ms/update_actor:0.03120895923291504 - timing_per_token_ms/gen:0.6237622093301657 - timing_per_token_ms/ref:0.00585510585905972 - timing_per_token_ms/adv:3.2159415128987705e-05 - perf/total_num_tokens:230612 - perf/time_per_step:71.98363237082958 - perf/throughput:400.45909119309124
[36m(TaskRunner pid=2905377)[0m Training Progress:  14%|█▍        | 73/525 [1:11:47<8:03:26, 64.17s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  14%|█▍        | 74/525 [1:12:58<8:17:00, 66.12s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  14%|█▍        | 75/525 [1:13:43<7:28:37, 59.82s/it]
[36m(TaskRunner pid=2905377)[0m step:73 - global_seqlen/min:25944 - global_seqlen/max:33776 - global_seqlen/minmax_diff:7832 - global_seqlen/balanced_min:29546 - global_seqlen/balanced_max:30324 - global_seqlen/mean:29644.375 - actor/entropy:0.44453349709510803 - actor/kl_loss:0.09121284196153283 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13198985159397125 - actor/pg_clipfrac:0.001657812955090776 - actor/ppo_kl:0.0002624404378593681 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9285580515861511 - perf/mfu/actor:0.08730322341533893 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.01803207397461 - actor/lr:1e-06 - training/global_step:73 - training/epoch:2 - critic/score/mean:1.0121874809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0121874809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004261478781700134 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.004261478781700134 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:332.03125 - response_length/max:2048.0 - response_length/min:87.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.877180516719818e-05 - timing_s/generate_sequences:38.34088134765625 - timing_s/reshard:0.6707143187522888 - timing_s/gen:62.09688241221011 - timing_s/reward:0.07472614571452141 - timing_s/old_log_prob:1.1307257171720266 - timing_s/ref:1.3573465626686811 - timing_s/adv:0.0073996651917696 - timing_s/update_actor:7.258616345003247 - timing_s/step:71.93866922520101 - timing_s/stop_profile:4.131719470024109e-05 - timing_per_token_ms/update_actor:0.03060705591281334 - timing_per_token_ms/gen:0.5844412462325657 - timing_per_token_ms/ref:0.005723457496863575 - timing_per_token_ms/adv:3.1201809752143534e-05 - perf/total_num_tokens:237155 - perf/time_per_step:71.93866922520101 - perf/throughput:412.0784456993431
[36m(TaskRunner pid=2905377)[0m step:74 - global_seqlen/min:26517 - global_seqlen/max:30317 - global_seqlen/minmax_diff:3800 - global_seqlen/balanced_min:28960 - global_seqlen/balanced_max:29863 - global_seqlen/mean:29073.375 - actor/entropy:0.4926733076572418 - actor/kl_loss:0.07737737717106938 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.023901616223156452 - actor/pg_clipfrac:0.001119529188144952 - actor/ppo_kl:5.3543100511888043e-05 - actor/pg_clipfrac_lower:0.0001396648003719747 - actor/grad_norm:1.0913156569004059 - perf/mfu/actor:0.08812812988659399 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.13554382324219 - actor/lr:1e-06 - training/global_step:74 - training/epoch:2 - critic/score/mean:1.0387499332427979 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0387499332427979 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05118432641029358 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.05118432641029358 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:317.4281311035156 - response_length/max:2048.0 - response_length/min:66.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.495097815990448e-05 - timing_s/generate_sequences:35.87077713012695 - timing_s/reshard:0.8451249599456787 - timing_s/gen:61.0496068187058 - timing_s/reward:0.07365384511649609 - timing_s/old_log_prob:1.1128094792366028 - timing_s/ref:1.3557283487170935 - timing_s/adv:0.007430408149957657 - timing_s/update_actor:7.044193001464009 - timing_s/step:70.65646929293871 - timing_s/stop_profile:3.9676204323768616e-05 - timing_per_token_ms/update_actor:0.03028627138001698 - timing_per_token_ms/gen:0.601018014104628 - timing_per_token_ms/ref:0.005828908531934689 - timing_per_token_ms/adv:3.194679044812331e-05 - perf/total_num_tokens:232587 - perf/time_per_step:70.65646929293871 - perf/throughput:411.47506082511745
[36m(TaskRunner pid=2905377)[0m step:75 - global_seqlen/min:26705 - global_seqlen/max:32084 - global_seqlen/minmax_diff:5379 - global_seqlen/balanced_min:28524 - global_seqlen/balanced_max:28524 - global_seqlen/mean:28524.0 - actor/entropy:0.4679023027420044 - actor/kl_loss:0.09209647327661515 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03148513995110989 - actor/pg_clipfrac:0.0012596021872013808 - actor/ppo_kl:-0.00038428687112173064 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9432912617921829 - perf/mfu/actor:0.0864849757631493 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.14525604248047 - actor/lr:1e-06 - training/global_step:75 - training/epoch:2 - critic/score/mean:1.0 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.015406676568090916 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.015406676568090916 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:303.4750061035156 - response_length/max:1034.0 - response_length/min:82.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.920712232589722e-05 - timing_s/generate_sequences:26.112865447998047 - timing_s/reshard:0.8111748695373535 - timing_s/gen:35.52073694765568 - timing_s/reward:0.07160051167011261 - timing_s/old_log_prob:1.0937484055757523 - timing_s/ref:1.3551076408475637 - timing_s/adv:0.00752774253487587 - timing_s/update_actor:7.033973457291722 - timing_s/step:45.09598267637193 - timing_s/stop_profile:4.0547922253608704e-05 - timing_per_token_ms/update_actor:0.030824803048712147 - timing_per_token_ms/gen:0.36577083107809205 - timing_per_token_ms/ref:0.005938453761952933 - timing_per_token_ms/adv:3.298863472372331e-05 - perf/total_num_tokens:228192 - perf/time_per_step:45.09598267637193 - perf/throughput:632.5175394158816
[36m(TaskRunner pid=2905377)[0m Training Progress:  14%|█▍        | 76/525 [1:14:32<7:02:51, 56.51s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  15%|█▍        | 77/525 [1:15:20<6:41:55, 53.83s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  15%|█▍        | 78/525 [1:16:10<6:32:51, 52.73s/it]
[36m(TaskRunner pid=2905377)[0m step:76 - global_seqlen/min:25869 - global_seqlen/max:31140 - global_seqlen/minmax_diff:5271 - global_seqlen/balanced_min:27615 - global_seqlen/balanced_max:27616 - global_seqlen/mean:27615.375 - actor/entropy:0.4856903553009033 - actor/kl_loss:0.07800839655101299 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.008306888863444328 - actor/pg_clipfrac:0.0016203471750486642 - actor/ppo_kl:0.0006200421981702675 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.084713637828827 - perf/mfu/actor:0.08392447679760753 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.1821517944336 - actor/lr:1e-06 - training/global_step:76 - training/epoch:2 - critic/score/mean:1.0109374523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0109374523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.020143458619713783 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.020143458619713783 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:281.0874938964844 - response_length/max:1197.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.488764822483063e-05 - timing_s/generate_sequences:29.852506637573242 - timing_s/reshard:0.8639516830444336 - timing_s/gen:39.176303651183844 - timing_s/reward:0.06977075338363647 - timing_s/old_log_prob:1.140169482678175 - timing_s/ref:1.347069762647152 - timing_s/adv:0.007577257230877876 - timing_s/update_actor:7.0118464436382055 - timing_s/step:48.76616262085736 - timing_s/stop_profile:4.051998257637024e-05 - timing_per_token_ms/update_actor:0.03173887030159017 - timing_per_token_ms/gen:0.4355439103835977 - timing_per_token_ms/ref:0.006097462747867591 - timing_per_token_ms/adv:3.42981818591902e-05 - perf/total_num_tokens:220923 - perf/time_per_step:48.76616262085736 - perf/throughput:566.281485272923
[36m(TaskRunner pid=2905377)[0m step:77 - global_seqlen/min:26838 - global_seqlen/max:32801 - global_seqlen/minmax_diff:5963 - global_seqlen/balanced_min:30039 - global_seqlen/balanced_max:30039 - global_seqlen/mean:30039.0 - actor/entropy:0.4470655024051666 - actor/kl_loss:0.07055187663063407 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0026747804135084153 - actor/pg_clipfrac:0.00128718851483427 - actor/ppo_kl:-0.0002434066693240311 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8735256791114807 - perf/mfu/actor:0.09040700076738638 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.1971321105957 - actor/lr:1e-06 - training/global_step:77 - training/epoch:2 - critic/score/mean:1.0390625 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0390625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.00645508524030447 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00645508524030447 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:342.1156311035156 - response_length/max:1136.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.196383714675903e-05 - timing_s/generate_sequences:32.51879119873047 - timing_s/reshard:0.6918109655380249 - timing_s/gen:37.8524288777262 - timing_s/reward:0.07486736588180065 - timing_s/old_log_prob:1.1520885564386845 - timing_s/ref:1.3693764675408602 - timing_s/adv:0.007565950974822044 - timing_s/update_actor:7.100591346621513 - timing_s/step:47.57027574814856 - timing_s/stop_profile:4.5083463191986084e-05 - timing_per_token_ms/update_actor:0.029547385676210566 - timing_per_token_ms/gen:0.34575690672676634 - timing_per_token_ms/ref:0.005698327455727805 - timing_per_token_ms/adv:3.148386670171296e-05 - perf/total_num_tokens:240312 - perf/time_per_step:47.57027574814856 - perf/throughput:631.4657530899244
[36m(TaskRunner pid=2905377)[0m step:78 - global_seqlen/min:27454 - global_seqlen/max:33887 - global_seqlen/minmax_diff:6433 - global_seqlen/balanced_min:29818 - global_seqlen/balanced_max:29819 - global_seqlen/mean:29818.375 - actor/entropy:0.45733642578125 - actor/kl_loss:0.06055404227226972 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.15655606165528296 - actor/pg_clipfrac:0.0012970422831131145 - actor/ppo_kl:0.0011799539563071449 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9573575705289841 - perf/mfu/actor:0.08542479218826265 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.23626708984375 - actor/lr:1e-06 - training/global_step:78 - training/epoch:2 - critic/score/mean:1.0640625953674316 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0640625953674316 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.006493471562862396 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.006493471562862396 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:335.7250061035156 - response_length/max:1215.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.792748510837555e-05 - timing_s/generate_sequences:30.006303787231445 - timing_s/reshard:0.6443851590156555 - timing_s/gen:40.09713001549244 - timing_s/reward:0.07468191906809807 - timing_s/old_log_prob:1.1452737338840961 - timing_s/ref:1.3633193708956242 - timing_s/adv:0.0076984502375125885 - timing_s/update_actor:7.4628713466227055 - timing_s/step:50.16437902674079 - timing_s/stop_profile:4.1350722312927246e-05 - timing_per_token_ms/update_actor:0.031284700065910304 - timing_per_token_ms/gen:0.37323264963411684 - timing_per_token_ms/ref:0.0057150975317049645 - timing_per_token_ms/adv:3.2272257615952366e-05 - perf/total_num_tokens:238547 - perf/time_per_step:50.16437902674079 - perf/throughput:594.4133183449738
[36m(TaskRunner pid=2905377)[0m Training Progress:  15%|█▌        | 79/525 [1:17:02<6:30:11, 52.49s/it]
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 12:18:51,054:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 12:18:54,849:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 12:18:54,851:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:18:55,981:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/huggingface
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:18:51,335:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  15%|█▌        | 80/525 [1:18:00<6:41:42, 54.16s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  15%|█▌        | 81/525 [1:18:51<6:33:31, 53.18s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:18:56,185:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:18:56,187:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:79 - global_seqlen/min:26647 - global_seqlen/max:33438 - global_seqlen/minmax_diff:6791 - global_seqlen/balanced_min:30010 - global_seqlen/balanced_max:30011 - global_seqlen/mean:30010.625 - actor/entropy:0.41549399495124817 - actor/kl_loss:0.0642114064656198 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0741336964070797 - actor/pg_clipfrac:0.000894146753125824 - actor/ppo_kl:0.0005418206277681747 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8053619265556335 - perf/mfu/actor:0.08970387930264118 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.20590591430664 - actor/lr:1e-06 - training/global_step:79 - training/epoch:2 - critic/score/mean:1.029687523841858 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.029687523841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.02899707481265068 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02899707481265068 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:340.640625 - response_length/max:1274.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.907727897167206e-05 - timing_s/generate_sequences:33.683753967285156 - timing_s/reshard:0.7487860321998596 - timing_s/gen:41.87317941710353 - timing_s/reward:0.0749205406755209 - timing_s/old_log_prob:1.2032328248023987 - timing_s/ref:1.3543734196573496 - timing_s/adv:0.007500855252146721 - timing_s/update_actor:7.1545032281428576 - timing_s/step:51.68107652105391 - timing_s/stop_profile:4.2071565985679626e-05 - timing_per_token_ms/update_actor:0.02979987599451385 - timing_per_token_ms/gen:0.3841399882308475 - timing_per_token_ms/ref:0.005641224648176061 - timing_per_token_ms/adv:3.124249849905959e-05 - perf/total_num_tokens:240085 - perf/time_per_step:51.68107652105391 - perf/throughput:580.688852094136
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_80
[36m(TaskRunner pid=2905377)[0m step:80 - global_seqlen/min:25699 - global_seqlen/max:30403 - global_seqlen/minmax_diff:4704 - global_seqlen/balanced_min:28543 - global_seqlen/balanced_max:28708 - global_seqlen/mean:28565.25 - actor/entropy:0.41767337918281555 - actor/kl_loss:0.07340306732803584 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04398224577307701 - actor/pg_clipfrac:0.0016698043909855187 - actor/ppo_kl:8.989820053102448e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8820515125989914 - perf/mfu/actor:0.08517630556313 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.26139450073242 - actor/lr:1e-06 - training/global_step:80 - training/epoch:2 - critic/score/mean:0.995312511920929 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.995312511920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.03627684712409973 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03627684712409973 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:304.5062561035156 - response_length/max:1271.0 - response_length/min:81.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.704885840415955e-05 - timing_s/generate_sequences:28.19017791748047 - timing_s/reshard:0.6747515797615051 - timing_s/gen:40.05400037020445 - timing_s/reward:0.07091603241860867 - timing_s/old_log_prob:1.1901479754596949 - timing_s/ref:1.3696829583495855 - timing_s/adv:0.007714938372373581 - timing_s/update_actor:7.1531048361212015 - timing_s/save_checkpoint:7.959242722019553 - timing_s/step:57.817856188863516 - timing_s/stop_profile:4.925578832626343e-05 - timing_per_token_ms/update_actor:0.031301602629598906 - timing_per_token_ms/gen:0.4110547851050312 - timing_per_token_ms/ref:0.00599365907155366 - timing_per_token_ms/adv:3.37601560128722e-05 - perf/total_num_tokens:228522 - perf/time_per_step:57.817856188863516 - perf/throughput:494.05584853735974
[36m(TaskRunner pid=2905377)[0m step:81 - global_seqlen/min:26561 - global_seqlen/max:32046 - global_seqlen/minmax_diff:5485 - global_seqlen/balanced_min:29595 - global_seqlen/balanced_max:29603 - global_seqlen/mean:29597.0 - actor/entropy:0.45422831177711487 - actor/kl_loss:0.07231355151161552 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.028981908783316614 - actor/pg_clipfrac:0.0015287821588572115 - actor/ppo_kl:9.030794481077465e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9067469388246536 - perf/mfu/actor:0.08737702798189556 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.13985824584961 - actor/lr:1e-06 - training/global_step:81 - training/epoch:2 - critic/score/mean:0.9962499737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9962499737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.016898993402719498 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.016898993402719498 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:330.19061279296875 - response_length/max:1265.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.653104305267334e-05 - timing_s/generate_sequences:32.31690216064453 - timing_s/reshard:0.6740355491638184 - timing_s/gen:40.88617901690304 - timing_s/reward:0.07458764314651489 - timing_s/old_log_prob:1.1262722201645374 - timing_s/ref:1.3649137765169144 - timing_s/adv:0.00748799555003643 - timing_s/update_actor:7.234447071328759 - timing_s/step:50.70731025747955 - timing_s/stop_profile:4.004873335361481e-05 - timing_per_token_ms/update_actor:0.03055397114288931 - timing_per_token_ms/gen:0.3869561997037984 - timing_per_token_ms/ref:0.005764578236463638 - timing_per_token_ms/adv:3.1624808046577486e-05 - perf/total_num_tokens:236776 - perf/time_per_step:50.70731025747955 - perf/throughput:583.6830991372553
[36m(TaskRunner pid=2905377)[0m Training Progress:  16%|█▌        | 82/525 [1:19:55<6:57:19, 56.52s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  16%|█▌        | 83/525 [1:20:39<6:27:56, 52.66s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  16%|█▌        | 84/525 [1:21:34<6:33:06, 53.48s/it]
[36m(TaskRunner pid=2905377)[0m step:82 - global_seqlen/min:26644 - global_seqlen/max:34878 - global_seqlen/minmax_diff:8234 - global_seqlen/balanced_min:29421 - global_seqlen/balanced_max:29596 - global_seqlen/mean:29464.875 - actor/entropy:0.42445024847984314 - actor/kl_loss:0.07367296367883683 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02393136974424124 - actor/pg_clipfrac:0.0010290837730281056 - actor/ppo_kl:0.0006496904457890196 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.790684312582016 - perf/mfu/actor:0.08789555630618819 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.1342544555664 - actor/lr:1e-06 - training/global_step:82 - training/epoch:2 - critic/score/mean:1.0824999809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0824999809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0023657847195863724 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0023657847195863724 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:326.88751220703125 - response_length/max:1656.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.991679012775421e-05 - timing_s/generate_sequences:36.346195220947266 - timing_s/reshard:0.667220950126648 - timing_s/gen:54.4505141787231 - timing_s/reward:0.07260737195611 - timing_s/old_log_prob:1.2566326968371868 - timing_s/ref:1.3521282877773046 - timing_s/adv:0.00741206668317318 - timing_s/update_actor:7.164352938532829 - timing_s/step:64.31686898879707 - timing_s/stop_profile:4.4619664549827576e-05 - timing_per_token_ms/update_actor:0.030393616715380725 - timing_per_token_ms/gen:0.5205395030660691 - timing_per_token_ms/ref:0.005736187103191956 - timing_per_token_ms/adv:3.144450249310908e-05 - perf/total_num_tokens:235719 - perf/time_per_step:64.31686898879707 - perf/throughput:458.1204816598316
[36m(TaskRunner pid=2905377)[0m step:83 - global_seqlen/min:27599 - global_seqlen/max:33710 - global_seqlen/minmax_diff:6111 - global_seqlen/balanced_min:30026 - global_seqlen/balanced_max:30027 - global_seqlen/mean:30026.75 - actor/entropy:0.4477493166923523 - actor/kl_loss:0.06477637831121683 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.20226076245307922 - actor/pg_clipfrac:0.0008501501404680311 - actor/ppo_kl:-0.0003383675153600052 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8194062560796738 - perf/mfu/actor:0.08868568374258659 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.20733642578125 - actor/lr:1e-06 - training/global_step:83 - training/epoch:2 - critic/score/mean:0.9546874761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9546874761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.045285794883966446 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.045285794883966446 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:340.71563720703125 - response_length/max:1020.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.120574057102203e-05 - timing_s/generate_sequences:30.16828155517578 - timing_s/reshard:0.6921820640563965 - timing_s/gen:33.77969756349921 - timing_s/reward:0.0742109976708889 - timing_s/old_log_prob:1.171155720949173 - timing_s/ref:1.35627312771976 - timing_s/adv:0.007563484832644463 - timing_s/update_actor:7.233615418896079 - timing_s/step:43.63567208126187 - timing_s/stop_profile:4.4036656618118286e-05 - timing_per_token_ms/update_actor:0.03011321329687728 - timing_per_token_ms/gen:0.30982305224755996 - timing_per_token_ms/ref:0.005646103589798096 - timing_per_token_ms/adv:3.1486444722807425e-05 - perf/total_num_tokens:240214 - perf/time_per_step:43.63567208126187 - perf/throughput:688.1239263161058
[36m(TaskRunner pid=2905377)[0m step:84 - global_seqlen/min:26480 - global_seqlen/max:32487 - global_seqlen/minmax_diff:6007 - global_seqlen/balanced_min:29217 - global_seqlen/balanced_max:29287 - global_seqlen/mean:29226.625 - actor/entropy:0.47591862082481384 - actor/kl_loss:0.0665648628026247 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08704334385693073 - actor/pg_clipfrac:0.0011414450651500373 - actor/ppo_kl:-0.000224686201181612 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9698755145072937 - perf/mfu/actor:0.08705597430108962 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.18778991699219 - actor/lr:1e-06 - training/global_step:84 - training/epoch:2 - critic/score/mean:1.1356250047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.1356250047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.021352870389819145 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.021352870389819145 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:321.3687438964844 - response_length/max:1402.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.294917643070221e-05 - timing_s/generate_sequences:31.900941848754883 - timing_s/reshard:0.7697964906692505 - timing_s/gen:45.612799141556025 - timing_s/reward:0.0738699808716774 - timing_s/old_log_prob:1.1133682820945978 - timing_s/ref:1.3849164471030235 - timing_s/adv:0.007599875330924988 - timing_s/update_actor:7.1685549188405275 - timing_s/step:55.37458606623113 - timing_s/stop_profile:4.501082003116608e-05 - timing_per_token_ms/update_actor:0.03065935135702689 - timing_per_token_ms/gen:0.44354031721305376 - timing_per_token_ms/ref:0.005923179836463428 - timing_per_token_ms/adv:3.2504075183693756e-05 - perf/total_num_tokens:233813 - perf/time_per_step:55.37458606623113 - perf/throughput:527.7985277405651
[36m(TaskRunner pid=2905377)[0m Training Progress:  16%|█▌        | 85/525 [1:22:46<7:13:43, 59.14s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  16%|█▋        | 86/525 [1:23:42<7:04:47, 58.06s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  17%|█▋        | 87/525 [1:24:53<7:32:38, 62.01s/it]
[36m(TaskRunner pid=2905377)[0m step:85 - global_seqlen/min:26609 - global_seqlen/max:32858 - global_seqlen/minmax_diff:6249 - global_seqlen/balanced_min:29602 - global_seqlen/balanced_max:29916 - global_seqlen/mean:29689.75 - actor/entropy:0.4047640860080719 - actor/kl_loss:0.07589983306825161 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06304280683398247 - actor/pg_clipfrac:0.001152768760221079 - actor/ppo_kl:-0.0004029309995530639 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0090175718069077 - perf/mfu/actor:0.08760017485119168 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.25406265258789 - actor/lr:1e-06 - training/global_step:85 - training/epoch:2 - critic/score/mean:0.9221875071525574 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9221875071525574 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.029695527628064156 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.029695527628064156 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:332.1812438964844 - response_length/max:2048.0 - response_length/min:58.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.9374760389328e-05 - timing_s/generate_sequences:51.111324310302734 - timing_s/reshard:0.698872983455658 - timing_s/gen:62.49505233205855 - timing_s/reward:0.07291717827320099 - timing_s/old_log_prob:1.152049295604229 - timing_s/ref:1.348045688122511 - timing_s/adv:0.007499495521187782 - timing_s/update_actor:7.251276155933738 - timing_s/step:72.34007547795773 - timing_s/stop_profile:4.328414797782898e-05 - timing_per_token_ms/update_actor:0.03052937527233194 - timing_per_token_ms/gen:0.5879231249135313 - timing_per_token_ms/ref:0.005675551697650329 - timing_per_token_ms/adv:3.157443023765686e-05 - perf/total_num_tokens:237518 - perf/time_per_step:72.34007547795773 - perf/throughput:410.4191183633278
[36m(TaskRunner pid=2905377)[0m step:86 - global_seqlen/min:27410 - global_seqlen/max:33536 - global_seqlen/minmax_diff:6126 - global_seqlen/balanced_min:30368 - global_seqlen/balanced_max:30369 - global_seqlen/mean:30368.125 - actor/entropy:0.4381464719772339 - actor/kl_loss:0.07120050452649593 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1689924456179142 - actor/pg_clipfrac:0.002130729838972911 - actor/ppo_kl:0.000617068403516896 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8842437267303467 - perf/mfu/actor:0.09092545624896575 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.22537612915039 - actor/lr:1e-06 - training/global_step:86 - training/epoch:2 - critic/score/mean:1.0806249380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0806249380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0031145394314080477 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0031145394314080477 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:350.34375 - response_length/max:1381.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.767416536808014e-05 - timing_s/generate_sequences:37.336387634277344 - timing_s/reshard:0.6502513885498047 - timing_s/gen:45.784646954387426 - timing_s/reward:0.07481412962079048 - timing_s/old_log_prob:1.132156740874052 - timing_s/ref:1.3586582839488983 - timing_s/adv:0.00769910030066967 - timing_s/update_actor:7.141670070588589 - timing_s/step:55.51284750364721 - timing_s/stop_profile:4.3060630559921265e-05 - timing_per_token_ms/update_actor:0.02939624223831974 - timing_per_token_ms/gen:0.4083903929568052 - timing_per_token_ms/ref:0.005592452135046609 - timing_per_token_ms/adv:3.169071312712618e-05 - perf/total_num_tokens:242945 - perf/time_per_step:55.51284750364721 - perf/throughput:547.0467894482409
[36m(TaskRunner pid=2905377)[0m step:87 - global_seqlen/min:26272 - global_seqlen/max:33254 - global_seqlen/minmax_diff:6982 - global_seqlen/balanced_min:29400 - global_seqlen/balanced_max:30000 - global_seqlen/mean:29518.125 - actor/entropy:0.44652605056762695 - actor/kl_loss:0.06693612202070653 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.075982162123546 - actor/pg_clipfrac:0.0016508116765180602 - actor/ppo_kl:-1.5324662808779976e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.900124654173851 - perf/mfu/actor:0.08926930937307749 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.14194107055664 - actor/lr:1e-06 - training/global_step:87 - training/epoch:2 - critic/score/mean:1.0315624475479126 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0315624475479126 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.024248110130429268 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.024248110130429268 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:328.765625 - response_length/max:2048.0 - response_length/min:70.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.953548967838287e-05 - timing_s/generate_sequences:45.38677978515625 - timing_s/reshard:0.7018469572067261 - timing_s/gen:61.26071812957525 - timing_s/reward:0.07289652712643147 - timing_s/old_log_prob:1.1604290306568146 - timing_s/ref:1.3603020142763853 - timing_s/adv:0.0075494591146707535 - timing_s/update_actor:7.066896613687277 - timing_s/step:70.9422852806747 - timing_s/stop_profile:4.089623689651489e-05 - timing_per_token_ms/update_actor:0.029926090383820436 - timing_per_token_ms/gen:0.5822985421755169 - timing_per_token_ms/ref:0.005760452324954521 - timing_per_token_ms/adv:3.1969591203162264e-05 - perf/total_num_tokens:236145 - perf/time_per_step:70.9422852806747 - perf/throughput:416.0864692082452
[36m(TaskRunner pid=2905377)[0m Training Progress:  17%|█▋        | 88/525 [1:26:06<7:55:31, 65.29s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  17%|█▋        | 89/525 [1:27:19<8:10:44, 67.53s/it]
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:29:08,107:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:29:11,657:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:29:11,659:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:29:12,353:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  17%|█▋        | 90/525 [1:28:17<7:49:06, 64.70s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 12:29:08,571:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:88 - global_seqlen/min:27415 - global_seqlen/max:33332 - global_seqlen/minmax_diff:5917 - global_seqlen/balanced_min:30249 - global_seqlen/balanced_max:30991 - global_seqlen/mean:30342.5 - actor/entropy:0.4241293668746948 - actor/kl_loss:0.07320507150143385 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1698000255972147 - actor/pg_clipfrac:0.00099922638037242 - actor/ppo_kl:-0.0003016221673533437 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8082441687583923 - perf/mfu/actor:0.09049433446792436 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.14302062988281 - actor/lr:1e-06 - training/global_step:88 - training/epoch:2 - critic/score/mean:1.018125057220459 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.018125057220459 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04883226752281189 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04883226752281189 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:349.8125 - response_length/max:2048.0 - response_length/min:59.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.135901927947998e-05 - timing_s/generate_sequences:38.586822509765625 - timing_s/reshard:0.6652923822402954 - timing_s/gen:62.840765649452806 - timing_s/reward:0.0748433955013752 - timing_s/old_log_prob:1.2410557996481657 - timing_s/ref:1.3590861167758703 - timing_s/adv:0.01059272512793541 - timing_s/update_actor:7.169851766899228 - timing_s/step:72.70933333039284 - timing_s/stop_profile:4.434958100318909e-05 - timing_per_token_ms/update_actor:0.029537166379250343 - timing_per_token_ms/gen:0.561379003479121 - timing_per_token_ms/ref:0.0055989376154563335 - timing_per_token_ms/adv:4.3638152459155514e-05 - perf/total_num_tokens:242740 - perf/time_per_step:72.70933333039284 - perf/throughput:417.312312053846
[36m(TaskRunner pid=2905377)[0m step:89 - global_seqlen/min:24402 - global_seqlen/max:32630 - global_seqlen/minmax_diff:8228 - global_seqlen/balanced_min:28749 - global_seqlen/balanced_max:29629 - global_seqlen/mean:28860.25 - actor/entropy:0.4383884370326996 - actor/kl_loss:0.08028578227385878 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.006092031672596932 - actor/pg_clipfrac:0.0009452789032366127 - actor/ppo_kl:0.0003024635490874061 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7938171327114105 - perf/mfu/actor:0.0866012128867297 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.39041519165039 - actor/lr:1e-06 - training/global_step:89 - training/epoch:2 - critic/score/mean:1.0043749809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0043749809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03724726289510727 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03724726289510727 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:311.9906311035156 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.036622941493988e-05 - timing_s/generate_sequences:35.80836868286133 - timing_s/reshard:0.663655161857605 - timing_s/gen:62.87479226849973 - timing_s/reward:0.07231845706701279 - timing_s/old_log_prob:1.1700919475406408 - timing_s/ref:1.3556229248642921 - timing_s/adv:0.007229600101709366 - timing_s/update_actor:7.114866541698575 - timing_s/step:72.60806378163397 - timing_s/stop_profile:4.37665730714798e-05 - timing_per_token_ms/update_actor:0.03081602958090529 - timing_per_token_ms/gen:0.6297744550467235 - timing_per_token_ms/ref:0.005871496802974213 - timing_per_token_ms/adv:3.131296550493051e-05 - perf/total_num_tokens:230882 - perf/time_per_step:72.60806378163397 - perf/throughput:397.47995603898926
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90
[36m(TaskRunner pid=2905377)[0m step:90 - global_seqlen/min:24791 - global_seqlen/max:33523 - global_seqlen/minmax_diff:8732 - global_seqlen/balanced_min:29383 - global_seqlen/balanced_max:29384 - global_seqlen/mean:29383.375 - actor/entropy:0.4554133415222168 - actor/kl_loss:0.07293941974639892 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1058458705432713 - actor/pg_clipfrac:0.0014363602676894516 - actor/ppo_kl:0.0006700782119878568 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9183294028043747 - perf/mfu/actor:0.0881074474864357 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.40565490722656 - actor/lr:1e-06 - training/global_step:90 - training/epoch:2 - critic/score/mean:0.9900000691413879 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9900000691413879 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.029659828171133995 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.029659828171133995 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:324.5218811035156 - response_length/max:1230.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.231773972511292e-05 - timing_s/generate_sequences:29.374120712280273 - timing_s/reshard:0.6408732533454895 - timing_s/gen:40.44704305380583 - timing_s/reward:0.07389392144978046 - timing_s/old_log_prob:1.1207300256937742 - timing_s/ref:1.3533544931560755 - timing_s/adv:0.008253902196884155 - timing_s/update_actor:7.124329641461372 - timing_s/save_checkpoint:7.943200286477804 - timing_s/step:58.088236663490534 - timing_s/stop_profile:4.813447594642639e-05 - timing_per_token_ms/update_actor:0.030307655440624897 - timing_per_token_ms/gen:0.3894868706251103 - timing_per_token_ms/ref:0.005757313843100373 - timing_per_token_ms/adv:3.511297713794006e-05 - perf/total_num_tokens:235067 - perf/time_per_step:58.088236663490534 - perf/throughput:505.8403678221474
[36m(TaskRunner pid=2905377)[0m Training Progress:  17%|█▋        | 91/525 [1:29:31<8:08:26, 67.53s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:29:13,357:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:29:13,360:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_90/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  18%|█▊        | 92/525 [1:30:11<7:08:17, 59.35s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  18%|█▊        | 93/525 [1:31:00<6:44:23, 56.17s/it]
[36m(TaskRunner pid=2905377)[0m step:91 - global_seqlen/min:28669 - global_seqlen/max:34242 - global_seqlen/minmax_diff:5573 - global_seqlen/balanced_min:31321 - global_seqlen/balanced_max:31652 - global_seqlen/mean:31363.125 - actor/entropy:0.37796103954315186 - actor/kl_loss:0.06803918723016977 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05006338953971863 - actor/pg_clipfrac:0.0012700713996309787 - actor/ppo_kl:-0.00024130382425937568 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1110573559999466 - perf/mfu/actor:0.09328819613187878 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.31131362915039 - actor/lr:1e-06 - training/global_step:91 - training/epoch:2 - critic/score/mean:0.9487498998641968 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9487498998641968 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.027257217094302177 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.027257217094302177 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:373.90625 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.05897468328476e-05 - timing_s/generate_sequences:42.57926559448242 - timing_s/reshard:0.684419572353363 - timing_s/gen:64.24664186313748 - timing_s/reward:0.07678521238267422 - timing_s/old_log_prob:1.1829126439988613 - timing_s/ref:1.3632827680557966 - timing_s/adv:0.008264612406492233 - timing_s/update_actor:7.2058878522366285 - timing_s/step:74.10154825076461 - timing_s/stop_profile:4.380755126476288e-05 - timing_per_token_ms/update_actor:0.028719586505795536 - timing_per_token_ms/gen:0.5369548003605306 - timing_per_token_ms/ref:0.005433461940000385 - timing_per_token_ms/adv:3.293920968690235e-05 - perf/total_num_tokens:250905 - perf/time_per_step:74.10154825076461 - perf/throughput:423.2452052670355
[36m(TaskRunner pid=2905377)[0m step:92 - global_seqlen/min:27218 - global_seqlen/max:29548 - global_seqlen/minmax_diff:2330 - global_seqlen/balanced_min:28578 - global_seqlen/balanced_max:28578 - global_seqlen/mean:28578.0 - actor/entropy:0.4581746757030487 - actor/kl_loss:0.08363973749801516 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06078090383671224 - actor/pg_clipfrac:0.0015493527229409666 - actor/ppo_kl:0.0002329969276615884 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9826313704252243 - perf/mfu/actor:0.08701041763229948 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.43160629272461 - actor/lr:1e-06 - training/global_step:92 - training/epoch:2 - critic/score/mean:0.9603124856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9603124856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03136283904314041 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.03136283904314041 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:304.82501220703125 - response_length/max:906.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.822418749332428e-05 - timing_s/generate_sequences:26.21788215637207 - timing_s/reshard:0.6477301120758057 - timing_s/gen:30.71226198039949 - timing_s/reward:0.07152194529771805 - timing_s/old_log_prob:1.0900551825761795 - timing_s/ref:1.3533387277275324 - timing_s/adv:0.007545411586761475 - timing_s/update_actor:7.003281539306045 - timing_s/step:40.25184683687985 - timing_s/stop_profile:4.111044108867645e-05 - timing_per_token_ms/update_actor:0.030632311302864285 - timing_per_token_ms/gen:0.31485547015090104 - timing_per_token_ms/ref:0.005919495449854487 - timing_per_token_ms/adv:3.3003584867561915e-05 - perf/total_num_tokens:228624 - perf/time_per_step:40.25184683687985 - perf/throughput:709.9798455412995
[36m(TaskRunner pid=2905377)[0m step:93 - global_seqlen/min:26278 - global_seqlen/max:32470 - global_seqlen/minmax_diff:6192 - global_seqlen/balanced_min:29080 - global_seqlen/balanced_max:29081 - global_seqlen/mean:29080.375 - actor/entropy:0.4164431095123291 - actor/kl_loss:0.07680735550820827 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03083767555654049 - actor/pg_clipfrac:0.0015934970113448798 - actor/ppo_kl:0.0007403954688925297 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8765921145677567 - perf/mfu/actor:0.08782320918290484 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.4417953491211 - actor/lr:1e-06 - training/global_step:93 - training/epoch:2 - critic/score/mean:1.0215624570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0215624570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.023291800171136856 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.023291800171136856 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:317.0562438964844 - response_length/max:1182.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.68173485994339e-05 - timing_s/generate_sequences:32.43623352050781 - timing_s/reshard:0.6527130603790283 - timing_s/gen:39.00636570341885 - timing_s/reward:0.07302360981702805 - timing_s/old_log_prob:1.1926390454173088 - timing_s/ref:1.3531386144459248 - timing_s/adv:0.008382651954889297 - timing_s/update_actor:7.073089491575956 - timing_s/step:48.72496701031923 - timing_s/stop_profile:3.9344653487205505e-05 - timing_per_token_ms/update_actor:0.030403190689494018 - timing_per_token_ms/gen:0.38445825566656994 - timing_per_token_ms/ref:0.00581637364737355 - timing_per_token_ms/adv:3.603225523608833e-05 - perf/total_num_tokens:232643 - perf/time_per_step:48.72496701031923 - perf/throughput:596.826981819017
[36m(TaskRunner pid=2905377)[0m Training Progress:  18%|█▊        | 94/525 [1:32:05<7:03:28, 58.95s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  18%|█▊        | 95/525 [1:33:08<7:10:01, 60.00s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  18%|█▊        | 96/525 [1:33:48<6:25:25, 53.91s/it]
[36m(TaskRunner pid=2905377)[0m step:94 - global_seqlen/min:26426 - global_seqlen/max:33129 - global_seqlen/minmax_diff:6703 - global_seqlen/balanced_min:30022 - global_seqlen/balanced_max:30023 - global_seqlen/mean:30022.125 - actor/entropy:0.4309270977973938 - actor/kl_loss:0.06935975961387157 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.19552554488182067 - actor/pg_clipfrac:0.001089157338719815 - actor/ppo_kl:-0.0002237387587229023 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.384205013513565 - perf/mfu/actor:0.08415856470561152 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49586868286133 - actor/lr:1e-06 - training/global_step:94 - training/epoch:2 - critic/score/mean:0.9793750047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9793750047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.012467287480831146 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.012467287480831146 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:340.8187561035156 - response_length/max:1708.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.75033438205719e-05 - timing_s/generate_sequences:35.113895416259766 - timing_s/reshard:0.6670462489128113 - timing_s/gen:55.196078546345234 - timing_s/reward:0.07450014166533947 - timing_s/old_log_prob:1.1479587145149708 - timing_s/ref:1.3644693326205015 - timing_s/adv:0.008396754041314125 - timing_s/update_actor:7.631776450201869 - timing_s/step:65.44087251462042 - timing_s/stop_profile:4.314444959163666e-05 - timing_per_token_ms/update_actor:0.03177563401242362 - timing_per_token_ms/gen:0.5060981693563774 - timing_per_token_ms/ref:0.005681099075350685 - timing_per_token_ms/adv:3.4960691662041434e-05 - perf/total_num_tokens:240177 - perf/time_per_step:65.44087251462042 - perf/throughput:458.76718702509095
[36m(TaskRunner pid=2905377)[0m step:95 - global_seqlen/min:28528 - global_seqlen/max:33926 - global_seqlen/minmax_diff:5398 - global_seqlen/balanced_min:30613 - global_seqlen/balanced_max:30819 - global_seqlen/mean:30653.5 - actor/entropy:0.43084046244621277 - actor/kl_loss:0.06446310495957733 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04545855335891247 - actor/pg_clipfrac:0.0007577547861728817 - actor/ppo_kl:0.0005853816226590424 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8753244429826736 - perf/mfu/actor:0.08994249204064628 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.51382064819336 - actor/lr:1e-06 - training/global_step:95 - training/epoch:2 - critic/score/mean:0.9046875238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9046875238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.020073188468813896 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.020073188468813896 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:356.8218688964844 - response_length/max:1621.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010229088366031647 - timing_s/generate_sequences:33.5349006652832 - timing_s/reshard:0.6679985523223877 - timing_s/gen:52.1571066621691 - timing_s/reward:0.07552352547645569 - timing_s/old_log_prob:1.2481686491519213 - timing_s/ref:1.355104861781001 - timing_s/adv:0.007579417899250984 - timing_s/update_actor:7.291021540760994 - timing_s/step:62.148407608270645 - timing_s/stop_profile:4.262104630470276e-05 - timing_per_token_ms/update_actor:0.029731603001129536 - timing_per_token_ms/gen:0.4567852190095645 - timing_per_token_ms/ref:0.005525897784025483 - timing_per_token_ms/adv:3.0907636563732465e-05 - perf/total_num_tokens:245228 - perf/time_per_step:62.148407608270645 - perf/throughput:493.23065834949347
[36m(TaskRunner pid=2905377)[0m step:96 - global_seqlen/min:25071 - global_seqlen/max:28769 - global_seqlen/minmax_diff:3698 - global_seqlen/balanced_min:27048 - global_seqlen/balanced_max:27093 - global_seqlen/mean:27054.25 - actor/entropy:0.4974324405193329 - actor/kl_loss:0.09261126518249511 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10729163102805614 - actor/pg_clipfrac:0.000906590634258464 - actor/ppo_kl:0.001686013054131763 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8979065269231796 - perf/mfu/actor:0.08268092397701392 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5474967956543 - actor/lr:1e-06 - training/global_step:96 - training/epoch:2 - critic/score/mean:1.0356249809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0356249809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.011204513721168041 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.011204513721168041 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:266.62188720703125 - response_length/max:888.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.034015238285065e-05 - timing_s/generate_sequences:22.183185577392578 - timing_s/reshard:0.6670346260070801 - timing_s/gen:29.80976076051593 - timing_s/reward:0.06854655779898167 - timing_s/old_log_prob:1.2379019483923912 - timing_s/ref:1.3436365071684122 - timing_s/adv:0.007386431097984314 - timing_s/update_actor:6.964565645903349 - timing_s/step:39.444831408560276 - timing_s/stop_profile:4.418566823005676e-05 - timing_per_token_ms/update_actor:0.03217870411258559 - timing_per_token_ms/gen:0.34939182081969933 - timing_per_token_ms/ref:0.006208065771405658 - timing_per_token_ms/adv:3.4127868532597995e-05 - perf/total_num_tokens:216434 - perf/time_per_step:39.444831408560276 - perf/throughput:685.8756656804652
[36m(TaskRunner pid=2905377)[0m Training Progress:  18%|█▊        | 97/525 [1:34:34<6:08:19, 51.63s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  19%|█▊        | 98/525 [1:35:20<5:55:36, 49.97s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  19%|█▉        | 99/525 [1:36:19<6:13:11, 52.56s/it]
[36m(TaskRunner pid=2905377)[0m step:97 - global_seqlen/min:28363 - global_seqlen/max:33998 - global_seqlen/minmax_diff:5635 - global_seqlen/balanced_min:31611 - global_seqlen/balanced_max:31612 - global_seqlen/mean:31611.375 - actor/entropy:0.3825197219848633 - actor/kl_loss:0.07157931858673691 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.008268287777900696 - actor/pg_clipfrac:0.002008702524472028 - actor/ppo_kl:0.0008144682917190949 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8526875823736191 - perf/mfu/actor:0.09508543706395652 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.50587463378906 - actor/lr:1e-06 - training/global_step:97 - training/epoch:2 - critic/score/mean:0.9668749570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9668749570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0035076059866696596 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0035076059866696596 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:380.65936279296875 - response_length/max:1083.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.298883378505707e-05 - timing_s/generate_sequences:30.961807250976562 - timing_s/reshard:0.6498801708221436 - timing_s/gen:36.45633929036558 - timing_s/reward:0.07733262702822685 - timing_s/old_log_prob:1.138597434386611 - timing_s/ref:1.3672676142305136 - timing_s/adv:0.007474964484572411 - timing_s/update_actor:7.1165614649653435 - timing_s/step:46.176665876060724 - timing_s/stop_profile:4.204362630844116e-05 - timing_per_token_ms/update_actor:0.02814082535545094 - timing_per_token_ms/gen:0.29928610134031886 - timing_per_token_ms/ref:0.005406549122865241 - timing_per_token_ms/adv:2.9558048663544413e-05 - perf/total_num_tokens:252891 - perf/time_per_step:46.176665876060724 - perf/throughput:684.5746525928417
[36m(TaskRunner pid=2905377)[0m step:98 - global_seqlen/min:26146 - global_seqlen/max:29726 - global_seqlen/minmax_diff:3580 - global_seqlen/balanced_min:28454 - global_seqlen/balanced_max:28454 - global_seqlen/mean:28454.0 - actor/entropy:0.4702211916446686 - actor/kl_loss:0.09722598418593406 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10590156381949782 - actor/pg_clipfrac:0.0013010579452384264 - actor/ppo_kl:0.0046681651030667124 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8859441727399826 - perf/mfu/actor:0.08591024071525946 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46794891357422 - actor/lr:1e-06 - training/global_step:98 - training/epoch:2 - critic/score/mean:0.9281250238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9281250238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.02358160726726055 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.02358160726726055 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:301.7250061035156 - response_length/max:1090.0 - response_length/min:50.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.078105747699738e-05 - timing_s/generate_sequences:27.11552619934082 - timing_s/reshard:0.645881712436676 - timing_s/gen:36.37777625955641 - timing_s/reward:0.07199334912002087 - timing_s/old_log_prob:1.1843471080064774 - timing_s/ref:1.3520590011030436 - timing_s/adv:0.0074575524777174 - timing_s/update_actor:7.0631332490593195 - timing_s/step:46.07030255906284 - timing_s/stop_profile:4.301406443119049e-05 - timing_per_token_ms/update_actor:0.031028736069881737 - timing_per_token_ms/gen:0.3767687490632655 - timing_per_token_ms/ref:0.00593967017424195 - timing_per_token_ms/adv:3.276144161505149e-05 - perf/total_num_tokens:227632 - perf/time_per_step:46.07030255906284 - perf/throughput:617.621296572158
[36m(TaskRunner pid=2905377)[0m step:99 - global_seqlen/min:27578 - global_seqlen/max:32817 - global_seqlen/minmax_diff:5239 - global_seqlen/balanced_min:29424 - global_seqlen/balanced_max:29551 - global_seqlen/mean:29440.25 - actor/entropy:0.4393419027328491 - actor/kl_loss:0.08780053965747356 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0981019139289856 - actor/pg_clipfrac:0.0015151710249483585 - actor/ppo_kl:0.0004941477505781222 - actor/pg_clipfrac_lower:0.00019157087663188577 - actor/grad_norm:0.9198362827301025 - perf/mfu/actor:0.08840289478167601 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.42663955688477 - actor/lr:1e-06 - training/global_step:99 - training/epoch:2 - critic/score/mean:1.0703125 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0703125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.018896667286753654 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.018896667286753654 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:326.1625061035156 - response_length/max:1515.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.967837154865265e-05 - timing_s/generate_sequences:34.60491943359375 - timing_s/reshard:0.7786344289779663 - timing_s/gen:48.92279553972185 - timing_s/reward:0.0741033535450697 - timing_s/old_log_prob:1.118973856791854 - timing_s/ref:1.3555484600365162 - timing_s/adv:0.00752967968583107 - timing_s/update_actor:7.112657876685262 - timing_s/step:58.604878755286336 - timing_s/stop_profile:4.149787127971649e-05 - timing_per_token_ms/update_actor:0.0301995477139514 - timing_per_token_ms/gen:0.4687348670114767 - timing_per_token_ms/ref:0.0057555067468708495 - timing_per_token_ms/adv:3.1970175549762105e-05 - perf/total_num_tokens:235522 - perf/time_per_step:58.604878755286336 - perf/throughput:502.35152132866415
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 100}
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <think>
[36m(TaskRunner pid=2905377)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and its foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the semi-major axis. The foci of the hyperbola are located at \((\pm c, 0)\) where \(c = \sqrt{2a^2} = a\sqrt{2}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:38:56,322:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 12:38:59,962:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 12:38:59,964:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:39:01,193:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  19%|█▉        | 100/525 [1:38:06<8:07:51, 68.87s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:38:56,750:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  19%|█▉        | 101/525 [1:38:54<7:23:18, 62.73s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:39:02,027:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:39:02,029:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m The equation of the parabola is \(y^2 = 16x\). The standard form of a parabola that opens to the right is \(y^2 = 4px\), where \(p\) is the distance from the vertex to the focus. By comparing \(y^2 = 16x\) with \(y^2 = 4px\), we get \(4p = 16\), so \(p = 4\). Therefore, the focus of the parabola is at \((4, 0)\) and the directrix is the line \(x = -4\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The hyperbola and the parabola intersect at points \(A\) and \(B\). The distance between the points of intersection is given as \(|AB| = 4\sqrt{3}\). The line segment \(AB\) is perpendicular to the line joining the center of the hyperbola (the origin) to the focus of the parabola \((4, 0)\). This line is the \(x\)-axis, so the points of intersection \(A\) and \(B\) must lie on the \(x\)-axis. Let's denote the coordinates of \(A\) and \(B\) as \((x_1, 0)\) and \((x_2, 0)\) respectively. Since \(A\) and \(B\) are on the \(x\)-axis, the distance \(|AB| = |x_2 - x_1| = 4\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The points \(A\) and \(B\) are also on the hyperbola, so they satisfy the equation \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\). Since \(y = 0\), the equation simplifies to \(\frac{x^2}{a^2} = 1\), so \(x^2 = a^2\) and \(x = \pm a\). Therefore, \(|x_2 - x_1| = |a - (-a)| = 2a = 4\sqrt{3}\), so \(a = 2\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The length of the real axis of the hyperbola is \(2a = 2 \times 2\sqrt{3} = 4\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m </think>
[36m(TaskRunner pid=2905377)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 0.6
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_100
[36m(TaskRunner pid=2905377)[0m step:100 - global_seqlen/min:28481 - global_seqlen/max:32991 - global_seqlen/minmax_diff:4510 - global_seqlen/balanced_min:30642 - global_seqlen/balanced_max:30643 - global_seqlen/mean:30642.5 - actor/entropy:0.4596254229545593 - actor/kl_loss:0.09376364499330521 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.23957477360963822 - actor/pg_clipfrac:0.0013398155919276179 - actor/ppo_kl:6.372257412294857e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8344429582357407 - perf/mfu/actor:0.0893797701785228 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.43966674804688 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.980000023841858 - val-aux/grpo_convert/reward/std@50:0.4282520020765514 - val-aux/grpo_convert/reward/best@2/mean:1.151000023841858 - val-aux/grpo_convert/reward/best@2/std:0.4089128719329979 - val-aux/grpo_convert/reward/worst@2/mean:0.8020000238418579 - val-aux/grpo_convert/reward/worst@2/std:0.3272254191203943 - val-aux/grpo_convert/reward/best@4/mean:1.325000023841858 - val-aux/grpo_convert/reward/best@4/std:0.3292794152587518 - val-aux/grpo_convert/reward/worst@4/mean:0.6625000238418579 - val-aux/grpo_convert/reward/worst@4/std:0.18059425707019522 - val-aux/grpo_convert/reward/best@8/mean:1.466000023841858 - val-aux/grpo_convert/reward/best@8/std:0.23699966052396 - val-aux/grpo_convert/reward/worst@8/mean:0.6085000238418579 - val-aux/grpo_convert/reward/worst@8/std:0.06463551655243424 - val-aux/grpo_convert/reward/best@16/mean:1.567000023841858 - val-aux/grpo_convert/reward/best@16/std:0.12414104881142257 - val-aux/grpo_convert/reward/worst@16/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@16/std:0.0 - val-aux/grpo_convert/reward/best@32/mean:1.596500023841858 - val-aux/grpo_convert/reward/best@32/std:0.04168632869418941 - val-aux/grpo_convert/reward/worst@32/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@32/std:0.0 - val-core/grpo_convert/reward/best@50/mean:1.600000023841858 - val-core/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@50/std:0.0 - training/global_step:100 - training/epoch:2 - critic/score/mean:1.0465624332427979 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0465624332427979 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.009524817578494549 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.009524817578494549 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:357.09375 - response_length/max:1395.0 - response_length/min:97.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.859431207180023e-05 - timing_s/generate_sequences:34.5715446472168 - timing_s/reshard:0.6574074029922485 - timing_s/gen:45.5938467066735 - timing_s/reward:0.07579990476369858 - timing_s/old_log_prob:1.24749737046659 - timing_s/ref:1.3616543281823397 - timing_s/adv:0.007608490064740181 - timing_s/update_actor:7.333098240196705 - timing_s/testing:42.74311683140695 - timing_s/save_checkpoint:8.542304806411266 - timing_s/step:106.9185160882771 - timing_s/stop_profile:5.117245018482208e-05 - timing_per_token_ms/update_actor:0.0299139195569744 - timing_per_token_ms/gen:0.3990010213238252 - timing_per_token_ms/ref:0.005554598711684506 - timing_per_token_ms/adv:3.1037325873950316e-05 - perf/total_num_tokens:245140 - perf/time_per_step:106.9185160882771 - perf/throughput:286.5967572417491
[36m(TaskRunner pid=2905377)[0m step:101 - global_seqlen/min:27152 - global_seqlen/max:32841 - global_seqlen/minmax_diff:5689 - global_seqlen/balanced_min:29927 - global_seqlen/balanced_max:29927 - global_seqlen/mean:29927.0 - actor/entropy:0.3980141282081604 - actor/kl_loss:0.08138877879828214 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07576440684497357 - actor/pg_clipfrac:0.000959352237987332 - actor/ppo_kl:-0.0008538504213902343 - actor/pg_clipfrac_lower:4.205214499961585e-05 - actor/grad_norm:0.8644467890262604 - perf/mfu/actor:0.08914825923891058 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.30390548706055 - actor/lr:1e-06 - training/global_step:101 - training/epoch:2 - critic/score/mean:1.0499999523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0499999523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.010827234946191311 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.010827234946191311 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:338.54998779296875 - response_length/max:1174.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.117035031318665e-05 - timing_s/generate_sequences:33.46917724609375 - timing_s/reshard:0.5989783406257629 - timing_s/gen:38.53842458687723 - timing_s/reward:0.0740391667932272 - timing_s/old_log_prob:1.2041388470679522 - timing_s/ref:1.3641118239611387 - timing_s/adv:0.008160796016454697 - timing_s/update_actor:7.173751927912235 - timing_s/step:48.38414268754423 - timing_s/stop_profile:4.447437822818756e-05 - timing_per_token_ms/update_actor:0.02996354432415643 - timing_per_token_ms/gen:0.3557305474346222 - timing_per_token_ms/ref:0.005697663581219045 - timing_per_token_ms/adv:3.4086259967816255e-05 - perf/total_num_tokens:239416 - perf/time_per_step:48.38414268754423 - perf/throughput:618.529095229877
[36m(TaskRunner pid=2905377)[0m Training Progress:  19%|█▉        | 102/525 [1:40:05<7:39:38, 65.20s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  20%|█▉        | 103/525 [1:40:49<6:53:41, 58.82s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  20%|█▉        | 104/525 [1:41:36<6:27:30, 55.23s/it]
[36m(TaskRunner pid=2905377)[0m step:102 - global_seqlen/min:27035 - global_seqlen/max:34638 - global_seqlen/minmax_diff:7603 - global_seqlen/balanced_min:30339 - global_seqlen/balanced_max:30728 - global_seqlen/mean:30388.25 - actor/entropy:0.38992324471473694 - actor/kl_loss:0.0881308026611805 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06903106514364481 - actor/pg_clipfrac:0.0011573148483876138 - actor/ppo_kl:-0.001290512846389902 - actor/pg_clipfrac_lower:6.119951140135527e-05 - actor/grad_norm:0.9273856580257416 - perf/mfu/actor:0.09036928067145045 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46007919311523 - actor/lr:1e-06 - training/global_step:102 - training/epoch:2 - critic/score/mean:1.0231250524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0231250524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.040989167988300323 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.040989167988300323 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:349.86248779296875 - response_length/max:2048.0 - response_length/min:82.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.795728743076324e-05 - timing_s/generate_sequences:42.037620544433594 - timing_s/reshard:0.675423800945282 - timing_s/gen:61.06128330156207 - timing_s/reward:0.07462247647345066 - timing_s/old_log_prob:1.2238227389752865 - timing_s/ref:1.3617956154048443 - timing_s/adv:0.007687237113714218 - timing_s/update_actor:7.1962746642529964 - timing_s/step:70.94030595757067 - timing_s/stop_profile:4.1054561734199524e-05 - timing_per_token_ms/update_actor:0.02960138649088462 - timing_per_token_ms/gen:0.5454042954514459 - timing_per_token_ms/ref:0.005601653663031124 - timing_per_token_ms/adv:3.162092714171685e-05 - perf/total_num_tokens:243106 - perf/time_per_step:70.94030595757067 - perf/throughput:428.36367266551093
[36m(TaskRunner pid=2905377)[0m step:103 - global_seqlen/min:25173 - global_seqlen/max:34353 - global_seqlen/minmax_diff:9180 - global_seqlen/balanced_min:30369 - global_seqlen/balanced_max:30369 - global_seqlen/mean:30369.0 - actor/entropy:0.4035770893096924 - actor/kl_loss:0.07333768215030431 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02641946580260992 - actor/pg_clipfrac:0.0014013365551363676 - actor/ppo_kl:-0.002214605745393783 - actor/pg_clipfrac_lower:0.00016447368543595075 - actor/grad_norm:0.8182047754526138 - perf/mfu/actor:0.09021219198925337 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.43153762817383 - actor/lr:1e-06 - training/global_step:103 - training/epoch:2 - critic/score/mean:1.014062523841858 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.014062523841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.008008874021470547 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008008874021470547 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:349.4906311035156 - response_length/max:1015.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.141117334365845e-05 - timing_s/generate_sequences:30.04752540588379 - timing_s/reshard:0.666621744632721 - timing_s/gen:34.030885653570294 - timing_s/reward:0.07485806196928024 - timing_s/old_log_prob:1.1493151802569628 - timing_s/ref:1.3591978941112757 - timing_s/adv:0.007592871785163879 - timing_s/update_actor:7.197085790336132 - timing_s/step:43.8320929389447 - timing_s/stop_profile:4.4189393520355225e-05 - timing_per_token_ms/update_actor:0.02962348855056197 - timing_per_token_ms/gen:0.3042900440245205 - timing_per_token_ms/ref:0.005594512060453405 - timing_per_token_ms/adv:3.1252559292221834e-05 - perf/total_num_tokens:242952 - perf/time_per_step:43.8320929389447 - perf/throughput:692.8485035451553
[36m(TaskRunner pid=2905377)[0m step:104 - global_seqlen/min:25375 - global_seqlen/max:35392 - global_seqlen/minmax_diff:10017 - global_seqlen/balanced_min:29439 - global_seqlen/balanced_max:29440 - global_seqlen/mean:29439.875 - actor/entropy:0.43115928769111633 - actor/kl_loss:0.08594300765544176 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1165729135274887 - actor/pg_clipfrac:0.0007937076326925308 - actor/ppo_kl:-0.002142998950512265 - actor/pg_clipfrac_lower:0.0001749388175085187 - actor/grad_norm:0.9195309281349182 - perf/mfu/actor:0.0883122934827705 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49615859985352 - actor/lr:1e-06 - training/global_step:104 - training/epoch:2 - critic/score/mean:1.092187523841858 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.092187523841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.012951641343533993 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.012951641343533993 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:326.80938720703125 - response_length/max:1112.0 - response_length/min:89.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.71121883392334e-05 - timing_s/generate_sequences:28.49421501159668 - timing_s/reshard:0.6541603803634644 - timing_s/gen:37.08634742721915 - timing_s/reward:0.07299766503274441 - timing_s/old_log_prob:1.0907527897506952 - timing_s/ref:1.356743322685361 - timing_s/adv:0.007602360099554062 - timing_s/update_actor:7.1178913451731205 - timing_s/step:46.74623770266771 - timing_s/stop_profile:4.2749568819999695e-05 - timing_per_token_ms/update_actor:0.030222153393879563 - timing_per_token_ms/gen:0.3546251869612365 - timing_per_token_ms/ref:0.005760653376947766 - timing_per_token_ms/adv:3.227917959720474e-05 - perf/total_num_tokens:235519 - perf/time_per_step:46.74623770266771 - perf/throughput:629.7806293472025
[36m(TaskRunner pid=2905377)[0m Training Progress:  20%|██        | 105/525 [1:42:47<6:59:57, 59.99s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  20%|██        | 106/525 [1:43:41<6:47:23, 58.34s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  20%|██        | 107/525 [1:44:30<6:26:22, 55.46s/it]
[36m(TaskRunner pid=2905377)[0m step:105 - global_seqlen/min:28385 - global_seqlen/max:36206 - global_seqlen/minmax_diff:7821 - global_seqlen/balanced_min:30832 - global_seqlen/balanced_max:31214 - global_seqlen/mean:31041.875 - actor/entropy:0.38061827421188354 - actor/kl_loss:0.08045783061534166 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08488468499854207 - actor/pg_clipfrac:0.0008927467919420451 - actor/ppo_kl:-0.000789090936359571 - actor/pg_clipfrac_lower:7.886435487307608e-05 - actor/grad_norm:0.7430195808410645 - perf/mfu/actor:0.09235712710034877 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.54081726074219 - actor/lr:1e-06 - training/global_step:105 - training/epoch:2 - critic/score/mean:0.9074999690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9074999690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.026850225403904915 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.026850225403904915 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:366.640625 - response_length/max:1946.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.858740329742432e-05 - timing_s/generate_sequences:35.471683502197266 - timing_s/reshard:0.6716078519821167 - timing_s/gen:61.13868270628154 - timing_s/reward:0.07657696306705475 - timing_s/old_log_prob:1.1891779191792011 - timing_s/ref:1.4059616047888994 - timing_s/adv:0.0077367667108774185 - timing_s/update_actor:7.195621065795422 - timing_s/step:71.02707318589091 - timing_s/stop_profile:4.382617771625519e-05 - timing_per_token_ms/update_actor:0.02897546083232497 - timing_per_token_ms/gen:0.5211053288410956 - timing_per_token_ms/ref:0.005661552357858938 - timing_per_token_ms/adv:3.115455618771989e-05 - perf/total_num_tokens:248335 - perf/time_per_step:71.02707318589091 - perf/throughput:437.0428571476922
[36m(TaskRunner pid=2905377)[0m step:106 - global_seqlen/min:25259 - global_seqlen/max:33506 - global_seqlen/minmax_diff:8247 - global_seqlen/balanced_min:30560 - global_seqlen/balanced_max:30561 - global_seqlen/mean:30560.5 - actor/entropy:0.40266406536102295 - actor/kl_loss:0.0802891494706273 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0005772568285465241 - actor/pg_clipfrac:0.0009164780873106793 - actor/ppo_kl:0.0008519607232301496 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7604474574327469 - perf/mfu/actor:0.09137496632670025 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.22306060791016 - actor/lr:1e-06 - training/global_step:106 - training/epoch:3 - critic/score/mean:1.040624976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.040624976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0003334705834276974 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0003334705834276974 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:354.71563720703125 - response_length/max:1268.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003452189266681671 - timing_s/generate_sequences:32.9139518737793 - timing_s/reshard:0.6891796588897705 - timing_s/gen:42.6926414873451 - timing_s/reward:0.07706052996218204 - timing_s/old_log_prob:1.1584981083869934 - timing_s/ref:1.3670816477388144 - timing_s/adv:0.009244993329048157 - timing_s/update_actor:7.155825266614556 - timing_s/step:52.49726114422083 - timing_s/stop_profile:4.496239125728607e-05 - timing_per_token_ms/update_actor:0.029269094364516926 - timing_per_token_ms/gen:0.3761167967944841 - timing_per_token_ms/ref:0.00559170190171469 - timing_per_token_ms/adv:3.781430821259533e-05 - perf/total_num_tokens:244484 - perf/time_per_step:52.49726114422083 - perf/throughput:582.1351311270123
[36m(TaskRunner pid=2905377)[0m step:107 - global_seqlen/min:27639 - global_seqlen/max:34015 - global_seqlen/minmax_diff:6376 - global_seqlen/balanced_min:29985 - global_seqlen/balanced_max:29986 - global_seqlen/mean:29985.5 - actor/entropy:0.4087277948856354 - actor/kl_loss:0.05929754413664341 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.047880814969539644 - actor/pg_clipfrac:0.0010856732318643481 - actor/ppo_kl:-4.1506598063278946e-05 - actor/pg_clipfrac_lower:2.8935185400769115e-05 - actor/grad_norm:0.73616923391819 - perf/mfu/actor:0.08984906373735337 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.48816299438477 - actor/lr:1e-06 - training/global_step:107 - training/epoch:3 - critic/score/mean:1.068750023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.068750023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.018309473991394043 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.018309473991394043 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:339.90313720703125 - response_length/max:1176.0 - response_length/min:86.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.957833051681519e-05 - timing_s/generate_sequences:31.73383903503418 - timing_s/reshard:0.6976718306541443 - timing_s/gen:38.40531197935343 - timing_s/reward:0.07710078731179237 - timing_s/old_log_prob:1.2656805776059628 - timing_s/ref:1.3644223921000957 - timing_s/adv:0.007175510749220848 - timing_s/update_actor:7.132251780480146 - timing_s/step:48.265826208516955 - timing_s/stop_profile:4.1171908378601074e-05 - timing_per_token_ms/update_actor:0.029732086260359784 - timing_per_token_ms/gen:0.3530906046700202 - timing_per_token_ms/ref:0.005687842424255456 - timing_per_token_ms/adv:2.9912419124330295e-05 - perf/total_num_tokens:239884 - perf/time_per_step:48.265826208516955 - perf/throughput:621.2573647958973
[36m(TaskRunner pid=2905377)[0m Training Progress:  21%|██        | 108/525 [1:45:10<5:52:07, 50.66s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  21%|██        | 109/525 [1:45:51<5:31:32, 47.82s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:47:50,050:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:47:53,929:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:47:53,932:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:47:54,749:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  21%|██        | 110/525 [1:46:59<6:13:14, 53.96s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 12:47:50,471:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:108 - global_seqlen/min:26844 - global_seqlen/max:32649 - global_seqlen/minmax_diff:5805 - global_seqlen/balanced_min:29172 - global_seqlen/balanced_max:29173 - global_seqlen/mean:29172.875 - actor/entropy:0.46557167172431946 - actor/kl_loss:0.08134537879377604 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13153776787221433 - actor/pg_clipfrac:0.001204355456866324 - actor/ppo_kl:0.0008337507562828251 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9422408193349838 - perf/mfu/actor:0.08872602130009612 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.56026840209961 - actor/lr:1e-06 - training/global_step:108 - training/epoch:3 - critic/score/mean:0.9996874928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9996874928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01500021293759346 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01500021293759346 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:319.9156188964844 - response_length/max:848.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.723458111286163e-05 - timing_s/generate_sequences:24.957298278808594 - timing_s/reshard:0.6572689414024353 - timing_s/gen:29.669373406097293 - timing_s/reward:0.07328778132796288 - timing_s/old_log_prob:1.294322643429041 - timing_s/ref:1.3900205735117197 - timing_s/adv:0.007576324045658112 - timing_s/update_actor:7.015299217775464 - timing_s/step:39.463711900636554 - timing_s/stop_profile:4.5921653509140015e-05 - timing_per_token_ms/update_actor:0.03005916976718726 - timing_per_token_ms/gen:0.289816391100166 - timing_per_token_ms/ref:0.005955963260013453 - timing_per_token_ms/adv:3.246305020356286e-05 - perf/total_num_tokens:233383 - perf/time_per_step:39.463711900636554 - perf/throughput:739.2329204473399
[36m(TaskRunner pid=2905377)[0m step:109 - global_seqlen/min:26423 - global_seqlen/max:32211 - global_seqlen/minmax_diff:5788 - global_seqlen/balanced_min:28707 - global_seqlen/balanced_max:28708 - global_seqlen/mean:28707.25 - actor/entropy:0.41538205742836 - actor/kl_loss:0.07476495932787657 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1763766260817647 - actor/pg_clipfrac:0.0010269458318362013 - actor/ppo_kl:0.00014906290089129471 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9082174301147461 - perf/mfu/actor:0.08526883407578481 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.50693893432617 - actor/lr:1e-06 - training/global_step:109 - training/epoch:3 - critic/score/mean:1.0546875 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0546875 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.0010186481522396207 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0010186481522396207 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:307.5093688964844 - response_length/max:934.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.040294051170349e-05 - timing_s/generate_sequences:27.479785919189453 - timing_s/reshard:0.6717371940612793 - timing_s/gen:31.36389760300517 - timing_s/reward:0.07199317589402199 - timing_s/old_log_prob:1.1500210259109735 - timing_s/ref:1.3723713625222445 - timing_s/adv:0.0075770169496536255 - timing_s/update_actor:7.181308053433895 - timing_s/step:41.16090608201921 - timing_s/stop_profile:4.0881335735321045e-05 - timing_per_token_ms/update_actor:0.0312695749916567 - timing_per_token_ms/gen:0.31872907942852524 - timing_per_token_ms/ref:0.005975717643288039 - timing_per_token_ms/adv:3.299261053241614e-05 - perf/total_num_tokens:229658 - perf/time_per_step:41.16090608201921 - perf/throughput:697.4397002533556
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110
[36m(TaskRunner pid=2905377)[0m step:110 - global_seqlen/min:27019 - global_seqlen/max:33019 - global_seqlen/minmax_diff:6000 - global_seqlen/balanced_min:30572 - global_seqlen/balanced_max:30646 - global_seqlen/mean:30581.75 - actor/entropy:0.38223740458488464 - actor/kl_loss:0.08356316331773997 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.15405569970607758 - actor/pg_clipfrac:0.0012480767327360809 - actor/ppo_kl:0.0013658870917424792 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7588281184434891 - perf/mfu/actor:0.09075772997119833 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.50244522094727 - actor/lr:1e-06 - training/global_step:110 - training/epoch:3 - critic/score/mean:1.0653125047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0653125047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0021372465416789055 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0021372465416789055 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:354.91876220703125 - response_length/max:1607.0 - response_length/min:80.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.7858567237854e-05 - timing_s/generate_sequences:38.47816848754883 - timing_s/reshard:0.6536012291908264 - timing_s/gen:50.232269221916795 - timing_s/reward:0.07495613023638725 - timing_s/old_log_prob:1.1696656234562397 - timing_s/ref:1.3594576995819807 - timing_s/adv:0.007555488497018814 - timing_s/update_actor:7.210256380960345 - timing_s/save_checkpoint:8.22472389601171 - timing_s/step:68.29206147044897 - timing_s/stop_profile:4.937872290611267e-05 - timing_per_token_ms/update_actor:0.029471238487661536 - timing_per_token_ms/gen:0.4422866960916829 - timing_per_token_ms/ref:0.005556654293745374 - timing_per_token_ms/adv:3.08823419891717e-05 - perf/total_num_tokens:244654 - perf/time_per_step:68.29206147044897 - perf/throughput:447.80827143771603
[36m(TaskRunner pid=2905377)[0m Training Progress:  21%|██        | 111/525 [1:47:50<6:06:42, 53.15s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:47:55,451:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:47:55,453:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_110/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  21%|██▏       | 112/525 [1:48:50<6:20:11, 55.23s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  22%|██▏       | 113/525 [1:49:57<6:41:57, 58.54s/it]
[36m(TaskRunner pid=2905377)[0m step:111 - global_seqlen/min:26403 - global_seqlen/max:32360 - global_seqlen/minmax_diff:5957 - global_seqlen/balanced_min:29711 - global_seqlen/balanced_max:29712 - global_seqlen/mean:29711.625 - actor/entropy:0.457565575838089 - actor/kl_loss:0.07577388947829604 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14520438387989998 - actor/pg_clipfrac:0.0012775397510267795 - actor/ppo_kl:-0.0005871286426554434 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9522640109062195 - perf/mfu/actor:0.08754278823780472 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.42337799072266 - actor/lr:1e-06 - training/global_step:111 - training/epoch:3 - critic/score/mean:0.9950000047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9950000047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.012852237559854984 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.012852237559854984 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:333.1656188964844 - response_length/max:1253.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.557550609111786e-05 - timing_s/generate_sequences:32.86988830566406 - timing_s/reshard:0.6764680743217468 - timing_s/gen:41.291431749239564 - timing_s/reward:0.07323465123772621 - timing_s/old_log_prob:1.1339643895626068 - timing_s/ref:1.3755552638322115 - timing_s/adv:0.0075011588633060455 - timing_s/update_actor:7.251939091831446 - timing_s/step:51.14680314436555 - timing_s/stop_profile:4.4757500290870667e-05 - timing_per_token_ms/update_actor:0.030509687251334475 - timing_per_token_ms/gen:0.3873020339849696 - timing_per_token_ms/ref:0.005787108849786117 - timing_per_token_ms/adv:3.155818161791069e-05 - perf/total_num_tokens:237693 - perf/time_per_step:51.14680314436555 - perf/throughput:580.9087405939486
[36m(TaskRunner pid=2905377)[0m step:112 - global_seqlen/min:28803 - global_seqlen/max:34821 - global_seqlen/minmax_diff:6018 - global_seqlen/balanced_min:30844 - global_seqlen/balanced_max:30920 - global_seqlen/mean:30853.875 - actor/entropy:0.4146976172924042 - actor/kl_loss:0.08989567682147026 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013126550987362862 - actor/pg_clipfrac:0.00122847436578013 - actor/ppo_kl:0.0009389908409502823 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.060682237148285 - perf/mfu/actor:0.08996138056727133 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.44137954711914 - actor/lr:1e-06 - training/global_step:112 - training/epoch:3 - critic/score/mean:1.021875023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.021875023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.04051568731665611 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04051568731665611 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:362.26873779296875 - response_length/max:1585.0 - response_length/min:71.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.828138768672943e-05 - timing_s/generate_sequences:36.85773468017578 - timing_s/reshard:0.657570481300354 - timing_s/gen:50.12797915376723 - timing_s/reward:0.075628113001585 - timing_s/old_log_prob:1.1667129695415497 - timing_s/ref:1.3603585213422775 - timing_s/adv:0.007536616176366806 - timing_s/update_actor:7.338644092902541 - timing_s/step:60.089999213814735 - timing_s/stop_profile:4.047900438308716e-05 - timing_per_token_ms/update_actor:0.029731452260463805 - timing_per_token_ms/gen:0.4324136013816334 - timing_per_token_ms/ref:0.005511295264137315 - timing_per_token_ms/adv:3.053350744585083e-05 - perf/total_num_tokens:246831 - perf/time_per_step:60.089999213814735 - perf/throughput:513.46106513023
[36m(TaskRunner pid=2905377)[0m step:113 - global_seqlen/min:26125 - global_seqlen/max:32146 - global_seqlen/minmax_diff:6021 - global_seqlen/balanced_min:28175 - global_seqlen/balanced_max:28695 - global_seqlen/mean:28310.875 - actor/entropy:0.43061867356300354 - actor/kl_loss:0.09390784557908774 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.046586566045880316 - actor/pg_clipfrac:0.001236490096198395 - actor/ppo_kl:0.0018309629034774844 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.986775130033493 - perf/mfu/actor:0.0849100461776507 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.45467758178711 - actor/lr:1e-06 - training/global_step:113 - training/epoch:3 - critic/score/mean:1.078125 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.078125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.030223704874515533 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.030223704874515533 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:299.0218811035156 - response_length/max:1805.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.746554911136627e-05 - timing_s/generate_sequences:32.295654296875 - timing_s/reshard:0.6893599033355713 - timing_s/gen:56.534139946103096 - timing_s/reward:0.07180486060678959 - timing_s/old_log_prob:1.1134309452027082 - timing_s/ref:1.3760047294199467 - timing_s/adv:0.00829930230975151 - timing_s/update_actor:7.120346678420901 - timing_s/step:66.23784433305264 - timing_s/stop_profile:4.3451786041259766e-05 - timing_per_token_ms/update_actor:0.03143821357703048 - timing_per_token_ms/gen:0.5908236222904166 - timing_per_token_ms/ref:0.0060754247679555414 - timing_per_token_ms/adv:3.664361446684141e-05 - perf/total_num_tokens:226487 - perf/time_per_step:66.23784433305264 - perf/throughput:427.4123846429721
[36m(TaskRunner pid=2905377)[0m Training Progress:  22%|██▏       | 114/525 [1:51:10<7:11:47, 63.03s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  22%|██▏       | 115/525 [1:51:49<6:21:35, 55.84s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  22%|██▏       | 116/525 [1:52:31<5:51:25, 51.55s/it]
[36m(TaskRunner pid=2905377)[0m step:114 - global_seqlen/min:26051 - global_seqlen/max:35756 - global_seqlen/minmax_diff:9705 - global_seqlen/balanced_min:28977 - global_seqlen/balanced_max:29531 - global_seqlen/mean:29197.5 - actor/entropy:0.4066546559333801 - actor/kl_loss:0.0968824790790677 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.044030144810676575 - actor/pg_clipfrac:0.0009770866890903562 - actor/ppo_kl:0.0019502480266964995 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8124708831310272 - perf/mfu/actor:0.08723459771367144 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62062072753906 - actor/lr:1e-06 - training/global_step:114 - training/epoch:3 - critic/score/mean:1.0087499618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0087499618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02518521063029766 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02518521063029766 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:320.09375 - response_length/max:2048.0 - response_length/min:72.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010029785335063934 - timing_s/generate_sequences:35.25787353515625 - timing_s/reshard:0.7813258767127991 - timing_s/gen:63.56394632719457 - timing_s/reward:0.07261473685503006 - timing_s/old_log_prob:1.1286190319806337 - timing_s/ref:1.3611323684453964 - timing_s/adv:0.007599854841828346 - timing_s/update_actor:7.155513888224959 - timing_s/step:73.30307767912745 - timing_s/stop_profile:4.411675035953522e-05 - timing_per_token_ms/update_actor:0.030634103468725745 - timing_per_token_ms/gen:0.6205598587054044 - timing_per_token_ms/ref:0.0058272641854841874 - timing_per_token_ms/adv:3.253641083067192e-05 - perf/total_num_tokens:233580 - perf/time_per_step:73.30307767912745 - perf/throughput:398.3120617091605
[36m(TaskRunner pid=2905377)[0m step:115 - global_seqlen/min:28272 - global_seqlen/max:31863 - global_seqlen/minmax_diff:3591 - global_seqlen/balanced_min:29925 - global_seqlen/balanced_max:29926 - global_seqlen/mean:29925.75 - actor/entropy:0.372421532869339 - actor/kl_loss:0.08287444850429893 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04202926382422447 - actor/pg_clipfrac:0.0008051272947341203 - actor/ppo_kl:-0.00011170618672622368 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.6264946609735489 - perf/mfu/actor:0.08909532818557345 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62149047851562 - actor/lr:1e-06 - training/global_step:115 - training/epoch:3 - critic/score/mean:1.0199999809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0199999809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.009355888701975346 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.009355888701975346 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:338.73748779296875 - response_length/max:816.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.307451546192169e-05 - timing_s/generate_sequences:24.192279815673828 - timing_s/reshard:0.6742516160011292 - timing_s/gen:28.836896734312177 - timing_s/reward:0.0740071926265955 - timing_s/old_log_prob:1.2040067128837109 - timing_s/ref:1.3566806465387344 - timing_s/adv:0.0074780043214559555 - timing_s/update_actor:7.171026635915041 - timing_s/step:38.66314848512411 - timing_s/stop_profile:4.174560308456421e-05 - timing_per_token_ms/update_actor:0.029953412345200374 - timing_per_token_ms/gen:0.2660328493146627 - timing_per_token_ms/ref:0.005666861509480692 - timing_per_token_ms/adv:3.123565959690215e-05 - perf/total_num_tokens:239406 - perf/time_per_step:38.66314848512411 - perf/throughput:774.0122357472807
[36m(TaskRunner pid=2905377)[0m step:116 - global_seqlen/min:26504 - global_seqlen/max:30541 - global_seqlen/minmax_diff:4037 - global_seqlen/balanced_min:28666 - global_seqlen/balanced_max:28668 - global_seqlen/mean:28666.625 - actor/entropy:0.4192278981208801 - actor/kl_loss:0.08471719324588775 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04823455363512039 - actor/pg_clipfrac:0.001584398839622736 - actor/ppo_kl:-0.003634889554291476 - actor/pg_clipfrac_lower:0.0002229201141744852 - actor/grad_norm:0.9481456428766251 - perf/mfu/actor:0.0863872969120914 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.61336898803711 - actor/lr:1e-06 - training/global_step:116 - training/epoch:3 - critic/score/mean:0.987500011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.987500011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0024400781840085983 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0024400781840085983 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:306.7124938964844 - response_length/max:961.0 - response_length/min:79.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.002854883670807e-05 - timing_s/generate_sequences:26.11715316772461 - timing_s/reshard:0.6546997427940369 - timing_s/gen:31.93402742780745 - timing_s/reward:0.07138501666486263 - timing_s/old_log_prob:1.0850563328713179 - timing_s/ref:1.3473948538303375 - timing_s/adv:0.007499830797314644 - timing_s/update_actor:7.0759555734694 - timing_s/step:41.53443122655153 - timing_s/stop_profile:4.474818706512451e-05 - timing_per_token_ms/update_actor:0.030854502289114086 - timing_per_token_ms/gen:0.3253660535905719 - timing_per_token_ms/ref:0.005875276797627631 - timing_per_token_ms/adv:3.270279810282272e-05 - perf/total_num_tokens:229333 - perf/time_per_step:41.53443122655153 - perf/throughput:690.1894200413274
[36m(TaskRunner pid=2905377)[0m Training Progress:  22%|██▏       | 117/525 [1:53:43<6:32:02, 57.65s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  22%|██▏       | 118/525 [1:54:35<6:21:17, 56.21s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  23%|██▎       | 119/525 [1:55:32<6:21:22, 56.36s/it]
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:57:27,422:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:57:31,031:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 12:57:31,033:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 12:57:31,905:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:117 - global_seqlen/min:25718 - global_seqlen/max:31879 - global_seqlen/minmax_diff:6161 - global_seqlen/balanced_min:28970 - global_seqlen/balanced_max:29836 - global_seqlen/mean:29085.375 - actor/entropy:0.4338909685611725 - actor/kl_loss:0.09943201830610633 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09088725913316012 - actor/pg_clipfrac:0.0008376910991501063 - actor/ppo_kl:0.0030170415513566693 - actor/pg_clipfrac_lower:0.00021760441595688462 - actor/grad_norm:0.9821840524673462 - perf/mfu/actor:0.08686304637765886 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.83759689331055 - actor/lr:1e-06 - training/global_step:117 - training/epoch:3 - critic/score/mean:0.9743749499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9743749499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.041490089148283005 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.041490089148283005 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:317.8374938964844 - response_length/max:2048.0 - response_length/min:70.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.02110880613327e-05 - timing_s/generate_sequences:38.47704315185547 - timing_s/reshard:0.6504335403442383 - timing_s/gen:62.146090261638165 - timing_s/reward:0.07281885109841824 - timing_s/old_log_prob:1.1292328089475632 - timing_s/ref:1.356422895565629 - timing_s/adv:0.007471978664398193 - timing_s/update_actor:7.150683913379908 - timing_s/step:71.87597232684493 - timing_s/stop_profile:4.179216921329498e-05 - timing_per_token_ms/update_actor:0.030731441116797993 - timing_per_token_ms/gen:0.6110246024072655 - timing_per_token_ms/ref:0.005829488598503668 - timing_per_token_ms/adv:3.2112267180662936e-05 - perf/total_num_tokens:232683 - perf/time_per_step:71.87597232684493 - perf/throughput:404.6606126973661
[36m(TaskRunner pid=2905377)[0m step:118 - global_seqlen/min:26995 - global_seqlen/max:33472 - global_seqlen/minmax_diff:6477 - global_seqlen/balanced_min:29913 - global_seqlen/balanced_max:30110 - global_seqlen/mean:29938.375 - actor/entropy:0.41809049248695374 - actor/kl_loss:0.08770421240478754 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06717311590909958 - actor/pg_clipfrac:0.0014430547249503433 - actor/ppo_kl:0.0009059411793714389 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9191636145114899 - perf/mfu/actor:0.08927354465291795 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.81048583984375 - actor/lr:1e-06 - training/global_step:118 - training/epoch:3 - critic/score/mean:0.9287499189376831 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9287499189376831 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0008880614768713713 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0008880614768713713 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:338.3968811035156 - response_length/max:1342.0 - response_length/min:69.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.65286386013031e-05 - timing_s/generate_sequences:29.493392944335938 - timing_s/reshard:0.6332204341888428 - timing_s/gen:43.055773148313165 - timing_s/reward:0.0740039311349392 - timing_s/old_log_prob:1.1445616018027067 - timing_s/ref:1.3600970264524221 - timing_s/adv:0.008262040093541145 - timing_s/update_actor:7.166552161797881 - timing_s/step:52.82676473632455 - timing_s/stop_profile:4.235655069351196e-05 - timing_per_token_ms/update_actor:0.02992209898582455 - timing_per_token_ms/gen:0.3976079598503344 - timing_per_token_ms/ref:0.005678736013780066 - timing_per_token_ms/adv:3.449602764654538e-05 - perf/total_num_tokens:239507 - perf/time_per_step:52.82676473632455 - perf/throughput:566.7273994429169
[36m(TaskRunner pid=2905377)[0m step:119 - global_seqlen/min:26762 - global_seqlen/max:32314 - global_seqlen/minmax_diff:5552 - global_seqlen/balanced_min:28852 - global_seqlen/balanced_max:29366 - global_seqlen/mean:28922.5 - actor/entropy:0.44653692841529846 - actor/kl_loss:0.09404037203639745 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06500965841114521 - actor/pg_clipfrac:0.001995419996092096 - actor/ppo_kl:0.0004531730031885672 - actor/pg_clipfrac_lower:2.8801843291148545e-05 - actor/grad_norm:0.8900914043188095 - perf/mfu/actor:0.087444826730274 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.86495208740234 - actor/lr:1e-06 - training/global_step:119 - training/epoch:3 - critic/score/mean:1.006250023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.006250023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.003758826991543174 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.003758826991543174 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:313.765625 - response_length/max:1538.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.8448246717453e-05 - timing_s/generate_sequences:29.72844696044922 - timing_s/reshard:0.6565369963645935 - timing_s/gen:46.91219615936279 - timing_s/reward:0.07268472388386726 - timing_s/old_log_prob:1.1773720849305391 - timing_s/ref:1.3503024149686098 - timing_s/adv:0.008235307410359383 - timing_s/update_actor:7.059103015810251 - timing_s/step:56.597139755263925 - timing_s/stop_profile:4.377216100692749e-05 - timing_per_token_ms/update_actor:0.030508700042398872 - timing_per_token_ms/gen:0.46722968138402265 - timing_per_token_ms/ref:0.0058358648758259565 - timing_per_token_ms/adv:3.55921316032474e-05 - perf/total_num_tokens:231380 - perf/time_per_step:56.597139755263925 - perf/throughput:511.024057488877
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120
[36m(TaskRunner pid=2905377)[0m Training Progress:  23%|██▎       | 120/525 [1:56:36<6:35:26, 58.58s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 12:57:27,851:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  23%|██▎       | 121/525 [1:57:32<6:30:23, 57.98s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:57:32,388:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 12:57:32,391:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_120/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  23%|██▎       | 122/525 [1:58:40<6:48:51, 60.87s/it]
[36m(TaskRunner pid=2905377)[0m step:120 - global_seqlen/min:26207 - global_seqlen/max:34617 - global_seqlen/minmax_diff:8410 - global_seqlen/balanced_min:29549 - global_seqlen/balanced_max:29591 - global_seqlen/mean:29564.625 - actor/entropy:0.3900925815105438 - actor/kl_loss:0.09595281351357698 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16918577998876572 - actor/pg_clipfrac:0.0012973161501577124 - actor/ppo_kl:-0.00013967915510875172 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8556574881076813 - perf/mfu/actor:0.08848316237949413 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.90784454345703 - actor/lr:1e-06 - training/global_step:120 - training/epoch:3 - critic/score/mean:1.115625023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.115625023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.002633940428495407 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.002633940428495407 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:329.4906311035156 - response_length/max:1401.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.90195369720459e-05 - timing_s/generate_sequences:32.682456970214844 - timing_s/reshard:0.6529057025909424 - timing_s/gen:46.339854868128896 - timing_s/reward:0.07453801669180393 - timing_s/old_log_prob:1.1319522969424725 - timing_s/ref:1.3556293211877346 - timing_s/adv:0.00828651711344719 - timing_s/update_actor:7.14254686050117 - timing_s/save_checkpoint:7.687586512416601 - timing_s/step:63.75796261616051 - timing_s/stop_profile:4.947185516357422e-05 - timing_per_token_ms/update_actor:0.030198873064097593 - timing_per_token_ms/gen:0.43950278240208746 - timing_per_token_ms/ref:0.005731635870519813 - timing_per_token_ms/adv:3.50356089137237e-05 - perf/total_num_tokens:236517 - perf/time_per_step:63.75796261616051 - perf/throughput:463.700905532172
[36m(TaskRunner pid=2905377)[0m step:121 - global_seqlen/min:26464 - global_seqlen/max:32082 - global_seqlen/minmax_diff:5618 - global_seqlen/balanced_min:29778 - global_seqlen/balanced_max:29886 - global_seqlen/mean:29792.5 - actor/entropy:0.43459904193878174 - actor/kl_loss:0.08659433592110873 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08043994382023811 - actor/pg_clipfrac:0.00044161925907246766 - actor/ppo_kl:8.898898540792289e-05 - actor/pg_clipfrac_lower:4.370629321783781e-05 - actor/grad_norm:0.8417962491512299 - perf/mfu/actor:0.08700473790205952 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.93709945678711 - actor/lr:1e-06 - training/global_step:121 - training/epoch:3 - critic/score/mean:0.9906250238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9906250238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.009841706603765488 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.009841706603765488 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:335.1875 - response_length/max:1424.0 - response_length/min:92.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.860230445861816e-05 - timing_s/generate_sequences:33.61936950683594 - timing_s/reshard:0.6958605051040649 - timing_s/gen:46.65294471755624 - timing_s/reward:0.07307783514261246 - timing_s/old_log_prob:1.118401549756527 - timing_s/ref:1.3716449905186892 - timing_s/adv:0.0076042842119932175 - timing_s/update_actor:7.315531477332115 - timing_s/step:56.553047554567456 - timing_s/stop_profile:4.331953823566437e-05 - timing_per_token_ms/update_actor:0.03069367910267733 - timing_per_token_ms/gen:0.43495193657986425 - timing_per_token_ms/ref:0.0057549928275517715 - timing_per_token_ms/adv:3.190519514975756e-05 - perf/total_num_tokens:238340 - perf/time_per_step:56.553047554567456 - perf/throughput:526.806269304117
[36m(TaskRunner pid=2905377)[0m step:122 - global_seqlen/min:28076 - global_seqlen/max:36245 - global_seqlen/minmax_diff:8169 - global_seqlen/balanced_min:30196 - global_seqlen/balanced_max:30197 - global_seqlen/mean:30196.25 - actor/entropy:0.3875540792942047 - actor/kl_loss:0.08672255147248506 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.023246967839077114 - actor/pg_clipfrac:0.0014367890369612723 - actor/ppo_kl:-0.0007460972682963529 - actor/pg_clipfrac_lower:0.0003774243174120784 - actor/grad_norm:1.025974839925766 - perf/mfu/actor:0.08796138695855636 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.9737319946289 - actor/lr:1e-06 - training/global_step:122 - training/epoch:3 - critic/score/mean:0.9724999666213989 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9724999666213989 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0018048405181616545 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0018048405181616545 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:344.625 - response_length/max:1821.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.813664317131042e-05 - timing_s/generate_sequences:40.40784454345703 - timing_s/reshard:0.7049487233161926 - timing_s/gen:57.450646843761206 - timing_s/reward:0.07434684410691261 - timing_s/old_log_prob:1.1695686802268028 - timing_s/ref:1.3664853516966105 - timing_s/adv:0.00752616859972477 - timing_s/update_actor:7.347272580489516 - timing_s/step:67.42933708429337 - timing_s/stop_profile:5.6546181440353394e-05 - timing_per_token_ms/update_actor:0.030414673098851333 - timing_per_token_ms/gen:0.5209525466427385 - timing_per_token_ms/ref:0.005656684818879043 - timing_per_token_ms/adv:3.1155228711035187e-05 - perf/total_num_tokens:241570 - perf/time_per_step:67.42933708429337 - perf/throughput:447.8206564933553
[36m(TaskRunner pid=2905377)[0m Training Progress:  23%|██▎       | 123/525 [1:59:25<6:16:43, 56.23s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  24%|██▎       | 124/525 [2:00:05<5:42:16, 51.21s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  24%|██▍       | 125/525 [2:00:45<5:19:20, 47.90s/it]
[36m(TaskRunner pid=2905377)[0m step:123 - global_seqlen/min:28197 - global_seqlen/max:32048 - global_seqlen/minmax_diff:3851 - global_seqlen/balanced_min:30047 - global_seqlen/balanced_max:30048 - global_seqlen/mean:30047.875 - actor/entropy:0.42650869488716125 - actor/kl_loss:0.07371810963377357 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.27662110291421416 - actor/pg_clipfrac:0.000827547034714371 - actor/ppo_kl:-0.00031963011497282423 - actor/pg_clipfrac_lower:0.00035956272622570393 - actor/grad_norm:1.0384268909692764 - perf/mfu/actor:0.09070799468361462 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.00324630737305 - actor/lr:1e-06 - training/global_step:123 - training/epoch:3 - critic/score/mean:1.056249976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.056249976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.00023474678164348006 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00023474678164348006 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:342.1187438964844 - response_length/max:1060.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.945539593696594e-05 - timing_s/generate_sequences:29.952756881713867 - timing_s/reshard:0.8308655619621277 - timing_s/gen:35.355540161952376 - timing_s/reward:0.07490739598870277 - timing_s/old_log_prob:1.1137636788189411 - timing_s/ref:1.3604575376957655 - timing_s/adv:0.007518984377384186 - timing_s/update_actor:7.076065147295594 - timing_s/step:45.00212796404958 - timing_s/stop_profile:4.178658127784729e-05 - timing_per_token_ms/update_actor:0.02943662882689539 - timing_per_token_ms/gen:0.3229465295488808 - timing_per_token_ms/ref:0.005659541388932518 - timing_per_token_ms/adv:3.12791852060428e-05 - perf/total_num_tokens:240383 - perf/time_per_step:45.00212796404958 - perf/throughput:667.698981346039
[36m(TaskRunner pid=2905377)[0m step:124 - global_seqlen/min:24485 - global_seqlen/max:33387 - global_seqlen/minmax_diff:8902 - global_seqlen/balanced_min:29370 - global_seqlen/balanced_max:29371 - global_seqlen/mean:29370.125 - actor/entropy:0.475820928812027 - actor/kl_loss:0.06733803432434797 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07973388135433197 - actor/pg_clipfrac:0.0005075852910522372 - actor/ppo_kl:-3.995499414486403e-05 - actor/pg_clipfrac_lower:6.839945563115179e-05 - actor/grad_norm:0.7924033105373383 - perf/mfu/actor:0.08822807040600145 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.02742004394531 - actor/lr:1e-06 - training/global_step:124 - training/epoch:3 - critic/score/mean:0.9606249928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9606249928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.00251968065276742 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00251968065276742 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:324.73748779296875 - response_length/max:856.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.787160575389862e-05 - timing_s/generate_sequences:25.058164596557617 - timing_s/reshard:0.6544418931007385 - timing_s/gen:29.72455178759992 - timing_s/reward:0.07470708899199963 - timing_s/old_log_prob:1.2232654243707657 - timing_s/ref:1.3529390096664429 - timing_s/adv:0.007453247904777527 - timing_s/update_actor:7.104333681985736 - timing_s/step:39.50042078085244 - timing_s/stop_profile:4.319101572036743e-05 - timing_per_token_ms/update_actor:0.030236225084102196 - timing_per_token_ms/gen:0.28604403352322955 - timing_per_token_ms/ref:0.005758142881867386 - timing_per_token_ms/adv:3.172121290247116e-05 - perf/total_num_tokens:234961 - perf/time_per_step:39.50042078085244 - perf/throughput:743.5395476657042
[36m(TaskRunner pid=2905377)[0m step:125 - global_seqlen/min:27115 - global_seqlen/max:30672 - global_seqlen/minmax_diff:3557 - global_seqlen/balanced_min:28771 - global_seqlen/balanced_max:28772 - global_seqlen/mean:28771.375 - actor/entropy:0.45482340455055237 - actor/kl_loss:0.06315982351079583 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.027541989088058473 - actor/pg_clipfrac:0.0007911786437034607 - actor/ppo_kl:-0.00038677475249642156 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7803834676742554 - perf/mfu/actor:0.08648404602310787 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.02651596069336 - actor/lr:1e-06 - training/global_step:125 - training/epoch:3 - critic/score/mean:1.0109374523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0109374523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.004632449243217707 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.004632449243217707 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:309.11248779296875 - response_length/max:895.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.87731260061264e-05 - timing_s/generate_sequences:25.790302276611328 - timing_s/reshard:0.6709285378456116 - timing_s/gen:30.389836076647043 - timing_s/reward:0.0738139171153307 - timing_s/old_log_prob:1.2298524491488934 - timing_s/ref:1.3538006749004126 - timing_s/adv:0.007486704736948013 - timing_s/update_actor:7.094890693202615 - timing_s/step:40.16289657354355 - timing_s/stop_profile:4.201754927635193e-05 - timing_per_token_ms/update_actor:0.03082443354376796 - timing_per_token_ms/gen:0.30722872009227065 - timing_per_token_ms/ref:0.005881716962173395 - timing_per_token_ms/adv:3.252670726089739e-05 - perf/total_num_tokens:230171 - perf/time_per_step:40.16289657354355 - perf/throughput:716.367031628703
[36m(TaskRunner pid=2905377)[0m Training Progress:  24%|██▍       | 126/525 [2:01:25<5:01:44, 45.38s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  24%|██▍       | 127/525 [2:02:23<5:26:14, 49.18s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  24%|██▍       | 128/525 [2:03:13<5:26:51, 49.40s/it]
[36m(TaskRunner pid=2905377)[0m step:126 - global_seqlen/min:27446 - global_seqlen/max:33021 - global_seqlen/minmax_diff:5575 - global_seqlen/balanced_min:30000 - global_seqlen/balanced_max:30001 - global_seqlen/mean:30000.875 - actor/entropy:0.43768686056137085 - actor/kl_loss:0.07058265702798963 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.030834876000881195 - actor/pg_clipfrac:0.0006113316048868 - actor/ppo_kl:0.0002633990663980512 - actor/pg_clipfrac_lower:0.00012791441986337304 - actor/grad_norm:0.8151798099279404 - perf/mfu/actor:0.090509435841162 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.04319763183594 - actor/lr:1e-06 - training/global_step:126 - training/epoch:3 - critic/score/mean:0.9762499928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9762499928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.00227660802192986 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00227660802192986 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:339.9593811035156 - response_length/max:872.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.944181561470032e-05 - timing_s/generate_sequences:27.035715103149414 - timing_s/reshard:0.7039536833763123 - timing_s/gen:29.823399735614657 - timing_s/reward:0.07426343113183975 - timing_s/old_log_prob:1.1090280208736658 - timing_s/ref:1.3651201222091913 - timing_s/adv:0.007532672956585884 - timing_s/update_actor:7.079508306458592 - timing_s/step:39.47217998839915 - timing_s/stop_profile:4.255026578903198e-05 - timing_per_token_ms/update_actor:0.02949709094509157 - timing_per_token_ms/gen:0.27414488620528793 - timing_per_token_ms/ref:0.005687834614028721 - timing_per_token_ms/adv:3.138522191680194e-05 - perf/total_num_tokens:240007 - perf/time_per_step:39.47217998839915 - perf/throughput:760.0511299050937
[36m(TaskRunner pid=2905377)[0m step:127 - global_seqlen/min:28798 - global_seqlen/max:34358 - global_seqlen/minmax_diff:5560 - global_seqlen/balanced_min:30716 - global_seqlen/balanced_max:30717 - global_seqlen/mean:30716.375 - actor/entropy:0.4487067759037018 - actor/kl_loss:0.08007151298224927 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.16143883503973483 - actor/pg_clipfrac:0.0007430397148709744 - actor/ppo_kl:1.3601401587948202e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.87491574883461 - perf/mfu/actor:0.09208891232614365 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.0760612487793 - actor/lr:1e-06 - training/global_step:127 - training/epoch:3 - critic/score/mean:1.0109374523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0109374523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.01117886696010828 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01117886696010828 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:358.17498779296875 - response_length/max:1465.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.806027472019196e-05 - timing_s/generate_sequences:36.81504821777344 - timing_s/reshard:0.8133853673934937 - timing_s/gen:48.19450445100665 - timing_s/reward:0.07475506328046322 - timing_s/old_log_prob:1.1749427989125252 - timing_s/ref:1.3631820380687714 - timing_s/adv:0.00771365687251091 - timing_s/update_actor:7.136027600616217 - timing_s/step:57.96424352377653 - timing_s/stop_profile:4.149600863456726e-05 - timing_per_token_ms/update_actor:0.02903999739803369 - timing_per_token_ms/gen:0.4204867073620319 - timing_per_token_ms/ref:0.005547456519807315 - timing_per_token_ms/adv:3.1390654302920305e-05 - perf/total_num_tokens:245731 - perf/time_per_step:57.96424352377653 - perf/throughput:529.9193629155249
[36m(TaskRunner pid=2905377)[0m step:128 - global_seqlen/min:27051 - global_seqlen/max:33558 - global_seqlen/minmax_diff:6507 - global_seqlen/balanced_min:30211 - global_seqlen/balanced_max:30212 - global_seqlen/mean:30211.25 - actor/entropy:0.44857919216156006 - actor/kl_loss:0.0882026869803667 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09432519566616974 - actor/pg_clipfrac:0.0020578464347636325 - actor/ppo_kl:0.001234610274696024 - actor/pg_clipfrac_lower:6.45994849037379e-05 - actor/grad_norm:1.3299264907836914 - perf/mfu/actor:0.0872341781319522 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.02286911010742 - actor/lr:1e-06 - training/global_step:128 - training/epoch:3 - critic/score/mean:0.9624999761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9624999761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.01057859044522047 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01057859044522047 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:345.65625 - response_length/max:1232.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.682293653488159e-05 - timing_s/generate_sequences:34.71547317504883 - timing_s/reshard:0.6510074734687805 - timing_s/gen:39.90923657082021 - timing_s/reward:0.07379882410168648 - timing_s/old_log_prob:1.1318939365446568 - timing_s/ref:1.3581290524452925 - timing_s/adv:0.007531147450208664 - timing_s/update_actor:7.401749072596431 - timing_s/step:49.89554054662585 - timing_s/stop_profile:4.0123239159584045e-05 - timing_per_token_ms/update_actor:0.030624970303266295 - timing_per_token_ms/gen:0.3608103839690825 - timing_per_token_ms/ref:0.005619301801668635 - timing_per_token_ms/adv:3.1160360172984665e-05 - perf/total_num_tokens:241690 - perf/time_per_step:49.89554054662585 - perf/throughput:605.4899830530649
[36m(TaskRunner pid=2905377)[0m Training Progress:  25%|██▍       | 129/525 [2:04:11<5:44:44, 52.23s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:06:07,757:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:06:11,316:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:06:11,319:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:06:12,535:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  25%|██▍       | 130/525 [2:05:17<6:09:14, 56.09s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 13:06:08,146:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  25%|██▍       | 131/525 [2:06:07<5:56:52, 54.35s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:06:13,033:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:06:13,035:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:129 - global_seqlen/min:26738 - global_seqlen/max:33815 - global_seqlen/minmax_diff:7077 - global_seqlen/balanced_min:29724 - global_seqlen/balanced_max:29725 - global_seqlen/mean:29724.625 - actor/entropy:0.45820266008377075 - actor/kl_loss:0.08455168791115283 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11196408383548259 - actor/pg_clipfrac:0.0016176130040548742 - actor/ppo_kl:-0.0005467063592732302 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8691456913948059 - perf/mfu/actor:0.08922106972051384 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.02374649047852 - actor/lr:1e-06 - training/global_step:129 - training/epoch:3 - critic/score/mean:0.9937499761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9937499761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.001584062585607171 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.001584062585607171 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:333.3812561035156 - response_length/max:1503.0 - response_length/min:46.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.628090679645538e-05 - timing_s/generate_sequences:36.6076774597168 - timing_s/reshard:0.7012432813644409 - timing_s/gen:49.11847770214081 - timing_s/reward:0.07322096638381481 - timing_s/old_log_prob:1.1507399696856737 - timing_s/ref:1.3533542100340128 - timing_s/adv:0.007538706064224243 - timing_s/update_actor:7.120312115177512 - timing_s/step:58.836965849623084 - timing_s/stop_profile:4.186667501926422e-05 - timing_per_token_ms/update_actor:0.02994281725664122 - timing_per_token_ms/gen:0.4604195431482425 - timing_per_token_ms/ref:0.005691216499930667 - timing_per_token_ms/adv:3.1702275740334167e-05 - perf/total_num_tokens:237797 - perf/time_per_step:58.836965849623084 - perf/throughput:505.20322676004236
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_130
[36m(TaskRunner pid=2905377)[0m step:130 - global_seqlen/min:27921 - global_seqlen/max:35781 - global_seqlen/minmax_diff:7860 - global_seqlen/balanced_min:31652 - global_seqlen/balanced_max:31682 - global_seqlen/mean:31664.75 - actor/entropy:0.4292025566101074 - actor/kl_loss:0.07759122010320425 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02674962691962719 - actor/pg_clipfrac:0.0010538470000028611 - actor/ppo_kl:0.0004924809742078651 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8311183452606201 - perf/mfu/actor:0.09477103234672678 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.97007369995117 - actor/lr:1e-06 - training/global_step:130 - training/epoch:3 - critic/score/mean:0.981249988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.981249988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.020931364968419075 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.020931364968419075 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:382.5406188964844 - response_length/max:1449.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.061582386493683e-05 - timing_s/generate_sequences:35.30950164794922 - timing_s/reshard:0.6716678142547607 - timing_s/gen:47.083644825965166 - timing_s/reward:0.07677759230136871 - timing_s/old_log_prob:1.1515845134854317 - timing_s/ref:1.4007952064275742 - timing_s/adv:0.00751541368663311 - timing_s/update_actor:7.154396038502455 - timing_s/save_checkpoint:8.019546026363969 - timing_s/step:64.90728620067239 - timing_s/stop_profile:4.822574555873871e-05 - timing_per_token_ms/update_actor:0.028242746423477426 - timing_per_token_ms/gen:0.38462944969868534 - timing_per_token_ms/ref:0.005529789459997213 - timing_per_token_ms/adv:2.9667902346588518e-05 - perf/total_num_tokens:253318 - perf/time_per_step:64.90728620067239 - perf/throughput:487.84584679912217
[36m(TaskRunner pid=2905377)[0m step:131 - global_seqlen/min:28024 - global_seqlen/max:31858 - global_seqlen/minmax_diff:3834 - global_seqlen/balanced_min:29943 - global_seqlen/balanced_max:29944 - global_seqlen/mean:29943.25 - actor/entropy:0.4295656085014343 - actor/kl_loss:0.06800716500729323 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.20264828577637672 - actor/pg_clipfrac:0.0004191430169157684 - actor/ppo_kl:0.0007974181278314063 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8514235690236092 - perf/mfu/actor:0.09001221036555003 - perf/max_memory_allocated_gb:64.44893646240234 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.86748504638672 - actor/lr:1e-06 - training/global_step:131 - training/epoch:3 - critic/score/mean:1.0187499523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0187499523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.018802892416715622 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.018802892416715622 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:339.28436279296875 - response_length/max:1225.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.931010961532593e-05 - timing_s/generate_sequences:31.873577117919922 - timing_s/reshard:0.6873184442520142 - timing_s/gen:40.19909471645951 - timing_s/reward:0.0738823264837265 - timing_s/old_log_prob:1.1270860023796558 - timing_s/ref:1.385088698938489 - timing_s/adv:0.007529996335506439 - timing_s/update_actor:7.1077847350388765 - timing_s/step:49.913649652153254 - timing_s/stop_profile:4.303455352783203e-05 - timing_per_token_ms/update_actor:0.02967189907173936 - timing_per_token_ms/gen:0.3702562812948164 - timing_per_token_ms/ref:0.005782140795248048 - timing_per_token_ms/adv:3.1434448229177025e-05 - perf/total_num_tokens:239546 - perf/time_per_step:49.913649652153254 - perf/throughput:599.9010332579088
[36m(TaskRunner pid=2905377)[0m Training Progress:  25%|██▌       | 132/525 [2:07:20<6:33:48, 60.12s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  25%|██▌       | 133/525 [2:08:16<6:24:33, 58.86s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  26%|██▌       | 134/525 [2:09:09<6:11:34, 57.02s/it]
[36m(TaskRunner pid=2905377)[0m step:132 - global_seqlen/min:27626 - global_seqlen/max:33871 - global_seqlen/minmax_diff:6245 - global_seqlen/balanced_min:31388 - global_seqlen/balanced_max:31917 - global_seqlen/mean:31455.0 - actor/entropy:0.4430619776248932 - actor/kl_loss:0.07554593784734606 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03054124638438225 - actor/pg_clipfrac:0.0015147874655667692 - actor/ppo_kl:0.0008419509351369925 - actor/pg_clipfrac_lower:6.877579144202173e-05 - actor/grad_norm:0.9660535305738449 - perf/mfu/actor:0.09256739481835692 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.92614364624023 - actor/lr:1e-06 - training/global_step:132 - training/epoch:3 - critic/score/mean:0.9950000047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9950000047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.015393943525850773 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.015393943525850773 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:377.40625 - response_length/max:2048.0 - response_length/min:69.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.647275924682617e-05 - timing_s/generate_sequences:42.29195785522461 - timing_s/reshard:0.6808030009269714 - timing_s/gen:63.67536706849933 - timing_s/reward:0.0770578570663929 - timing_s/old_log_prob:1.185709923505783 - timing_s/ref:1.3621921110898256 - timing_s/adv:0.0073994360864162445 - timing_s/update_actor:7.275599839165807 - timing_s/step:73.59636506438255 - timing_s/stop_profile:4.346109926700592e-05 - timing_per_token_ms/update_actor:0.028912731835820247 - timing_per_token_ms/gen:0.5272449041028345 - timing_per_token_ms/ref:0.005413257475321196 - timing_per_token_ms/adv:2.9404848539247515e-05 - perf/total_num_tokens:251640 - perf/time_per_step:73.59636506438255 - perf/throughput:427.398825641497
[36m(TaskRunner pid=2905377)[0m step:133 - global_seqlen/min:27666 - global_seqlen/max:31276 - global_seqlen/minmax_diff:3610 - global_seqlen/balanced_min:29954 - global_seqlen/balanced_max:30020 - global_seqlen/mean:29962.625 - actor/entropy:0.42824241518974304 - actor/kl_loss:0.07922780979424715 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.014521116018295288 - actor/pg_clipfrac:0.0007348589831963181 - actor/ppo_kl:-0.00023009857977740467 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7827426046133041 - perf/mfu/actor:0.0867146903443423 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.84790420532227 - actor/lr:1e-06 - training/global_step:133 - training/epoch:3 - critic/score/mean:0.9903124570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9903124570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0019102775258943439 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0019102775258943439 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:339.65936279296875 - response_length/max:1457.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.53253698348999e-05 - timing_s/generate_sequences:35.708595275878906 - timing_s/reshard:0.6576055288314819 - timing_s/gen:45.94720211811364 - timing_s/reward:0.07391814142465591 - timing_s/old_log_prob:1.1247544530779123 - timing_s/ref:1.3552902825176716 - timing_s/adv:0.007429305464029312 - timing_s/update_actor:7.384756194427609 - timing_s/step:55.90647139213979 - timing_s/stop_profile:4.4034793972969055e-05 - timing_per_token_ms/update_actor:0.03080819935848248 - timing_per_token_ms/gen:0.4227323524313295 - timing_per_token_ms/ref:0.005654086893745423 - timing_per_token_ms/adv:3.099405285764061e-05 - perf/total_num_tokens:239701 - perf/time_per_step:55.90647139213979 - perf/throughput:535.9419804880158
[36m(TaskRunner pid=2905377)[0m step:134 - global_seqlen/min:27724 - global_seqlen/max:31581 - global_seqlen/minmax_diff:3857 - global_seqlen/balanced_min:29650 - global_seqlen/balanced_max:29803 - global_seqlen/mean:29669.75 - actor/entropy:0.44940659403800964 - actor/kl_loss:0.09110687486827374 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08656596299260855 - actor/pg_clipfrac:0.0011266662972047926 - actor/ppo_kl:-0.0026241766288876535 - actor/pg_clipfrac_lower:0.00023630070500075818 - actor/grad_norm:0.8935958594083786 - perf/mfu/actor:0.08965263204823189 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.84856033325195 - actor/lr:1e-06 - training/global_step:134 - training/epoch:3 - critic/score/mean:0.9362500309944153 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9362500309944153 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.016199057921767235 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.016199057921767235 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:332.4468688964844 - response_length/max:1330.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.564201951026917e-05 - timing_s/generate_sequences:29.151742935180664 - timing_s/reshard:0.6870403289794922 - timing_s/gen:43.07404154166579 - timing_s/reward:0.07382582128047943 - timing_s/old_log_prob:1.1102766338735819 - timing_s/ref:1.360296469181776 - timing_s/adv:0.007533112540841103 - timing_s/update_actor:7.066437343135476 - timing_s/step:52.70567059889436 - timing_s/stop_profile:4.1993334889411926e-05 - timing_per_token_ms/update_actor:0.029771220448164697 - timing_per_token_ms/gen:0.40489590951247656 - timing_per_token_ms/ref:0.005730990609887916 - timing_per_token_ms/adv:3.173734418406417e-05 - perf/total_num_tokens:237358 - perf/time_per_step:52.70567059889436 - perf/throughput:562.9327862232418
[36m(TaskRunner pid=2905377)[0m Training Progress:  26%|██▌       | 135/525 [2:10:23<6:43:38, 62.10s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  26%|██▌       | 136/525 [2:11:06<6:05:00, 56.30s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  26%|██▌       | 137/525 [2:11:54<5:49:07, 53.99s/it]
[36m(TaskRunner pid=2905377)[0m step:135 - global_seqlen/min:25538 - global_seqlen/max:34067 - global_seqlen/minmax_diff:8529 - global_seqlen/balanced_min:30926 - global_seqlen/balanced_max:31308 - global_seqlen/mean:31053.125 - actor/entropy:0.42540910840034485 - actor/kl_loss:0.07904486553743481 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05191804692149162 - actor/pg_clipfrac:0.0016656881402013824 - actor/ppo_kl:5.264403516775928e-05 - actor/pg_clipfrac_lower:0.00012820513220503926 - actor/grad_norm:1.0752305835485458 - perf/mfu/actor:0.09209301566431916 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.79146957397461 - actor/lr:1e-06 - training/global_step:135 - training/epoch:3 - critic/score/mean:0.9821874499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9821874499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0491340272128582 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0491340272128582 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:367.359375 - response_length/max:2048.0 - response_length/min:53.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.974596858024597e-05 - timing_s/generate_sequences:47.94767761230469 - timing_s/reshard:0.6489951014518738 - timing_s/gen:63.902563912793994 - timing_s/reward:0.07579810544848442 - timing_s/old_log_prob:1.2721082158386707 - timing_s/ref:1.362344991415739 - timing_s/adv:0.0074721407145261765 - timing_s/update_actor:7.2269991636276245 - timing_s/step:73.86025461554527 - timing_s/stop_profile:4.281848669052124e-05 - timing_per_token_ms/update_actor:0.02909127166600634 - timing_per_token_ms/gen:0.5435971580349113 - timing_per_token_ms/ref:0.005483928716577394 - timing_per_token_ms/adv:3.0078054602097924e-05 - perf/total_num_tokens:248425 - perf/time_per_step:73.86025461554527 - perf/throughput:420.4307873244765
[36m(TaskRunner pid=2905377)[0m step:136 - global_seqlen/min:26546 - global_seqlen/max:31074 - global_seqlen/minmax_diff:4528 - global_seqlen/balanced_min:29246 - global_seqlen/balanced_max:29246 - global_seqlen/mean:29246.0 - actor/entropy:0.47894763946533203 - actor/kl_loss:0.07561267744749785 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11786259487271308 - actor/pg_clipfrac:0.001666553702671081 - actor/ppo_kl:-0.001850908790493122 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0096618980169296 - perf/mfu/actor:0.08819065635899435 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.82752990722656 - actor/lr:1e-06 - training/global_step:136 - training/epoch:3 - critic/score/mean:1.0187499523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0187499523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.014051022939383984 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.014051022939383984 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:320.7593688964844 - response_length/max:968.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.489509880542755e-05 - timing_s/generate_sequences:27.503780364990234 - timing_s/reshard:0.668459951877594 - timing_s/gen:33.13276534155011 - timing_s/reward:0.07353925332427025 - timing_s/old_log_prob:1.096812978386879 - timing_s/ref:1.3577806390821934 - timing_s/adv:0.007510824128985405 - timing_s/update_actor:7.077467391267419 - timing_s/step:42.7592620998621 - timing_s/stop_profile:4.1896477341651917e-05 - timing_per_token_ms/update_actor:0.030249723856542 - timing_per_token_ms/gen:0.3227961511408485 - timing_per_token_ms/ref:0.005803274973851951 - timing_per_token_ms/adv:3.210192902014551e-05 - perf/total_num_tokens:233968 - perf/time_per_step:42.7592620998621 - perf/throughput:683.968772232258
[36m(TaskRunner pid=2905377)[0m step:137 - global_seqlen/min:26673 - global_seqlen/max:31677 - global_seqlen/minmax_diff:5004 - global_seqlen/balanced_min:30068 - global_seqlen/balanced_max:30153 - global_seqlen/mean:30079.375 - actor/entropy:0.40248507261276245 - actor/kl_loss:0.0821695726364851 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.017122898995876313 - actor/pg_clipfrac:0.00075986412120983 - actor/ppo_kl:0.0018797352535329993 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7416912317276001 - perf/mfu/actor:0.09101356895539808 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.80793762207031 - actor/lr:1e-06 - training/global_step:137 - training/epoch:3 - critic/score/mean:1.0293749570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0293749570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0035802035126835108 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0035802035126835108 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:342.578125 - response_length/max:1217.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.768906652927399e-05 - timing_s/generate_sequences:29.427318572998047 - timing_s/reshard:0.7228348255157471 - timing_s/gen:38.94595008902252 - timing_s/reward:0.07336854562163353 - timing_s/old_log_prob:1.1260579377412796 - timing_s/ref:1.356537375599146 - timing_s/adv:0.0075410883873701096 - timing_s/update_actor:7.061286905780435 - timing_s/step:48.58394738472998 - timing_s/stop_profile:3.937818109989166e-05 - timing_per_token_ms/update_actor:0.02934438841307555 - timing_per_token_ms/gen:0.35526522316098075 - timing_per_token_ms/ref:0.005637323646182583 - timing_per_token_ms/adv:3.1338285733040124e-05 - perf/total_num_tokens:240635 - perf/time_per_step:48.58394738472998 - perf/throughput:619.1216774093165
[36m(TaskRunner pid=2905377)[0m Training Progress:  26%|██▋       | 138/525 [2:13:09<6:27:24, 60.06s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  26%|██▋       | 139/525 [2:14:00<6:09:50, 57.49s/it]
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 13:15:52,748:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:15:56,486:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:15:56,489:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:15:57,111:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  27%|██▋       | 140/525 [2:15:02<6:17:06, 58.77s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:15:53,158:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:138 - global_seqlen/min:27373 - global_seqlen/max:32394 - global_seqlen/minmax_diff:5021 - global_seqlen/balanced_min:30003 - global_seqlen/balanced_max:30296 - global_seqlen/mean:30040.5 - actor/entropy:0.40860140323638916 - actor/kl_loss:0.08406089413911104 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05150229334831238 - actor/pg_clipfrac:0.0004728830244857818 - actor/ppo_kl:0.001114067283924669 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7017756253480911 - perf/mfu/actor:0.08977804981985525 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.89137268066406 - actor/lr:1e-06 - training/global_step:138 - training/epoch:3 - critic/score/mean:1.0043749809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0043749809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.036887284368276596 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.036887284368276596 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:342.04376220703125 - response_length/max:2048.0 - response_length/min:76.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.647330105304718e-05 - timing_s/generate_sequences:40.56565856933594 - timing_s/reshard:0.6711050271987915 - timing_s/gen:64.37531920708716 - timing_s/reward:0.0752085093408823 - timing_s/old_log_prob:1.1270465310662985 - timing_s/ref:1.389929672703147 - timing_s/adv:0.007567152380943298 - timing_s/update_actor:7.161238385364413 - timing_s/step:74.14952855557203 - timing_s/stop_profile:4.252232611179352e-05 - timing_per_token_ms/update_actor:0.029798265613773127 - timing_per_token_ms/gen:0.5881495350292101 - timing_per_token_ms/ref:0.005783565822402868 - timing_per_token_ms/adv:3.148729374071378e-05 - perf/total_num_tokens:240324 - perf/time_per_step:74.14952855557203 - perf/throughput:405.1340660579639
[36m(TaskRunner pid=2905377)[0m step:139 - global_seqlen/min:26251 - global_seqlen/max:37162 - global_seqlen/minmax_diff:10911 - global_seqlen/balanced_min:29942 - global_seqlen/balanced_max:29943 - global_seqlen/mean:29942.75 - actor/entropy:0.4163057506084442 - actor/kl_loss:0.07771844491362571 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.004151677340269088 - actor/pg_clipfrac:0.0009076170215848833 - actor/ppo_kl:-0.0015411930292430042 - actor/pg_clipfrac_lower:0.00016935558523982762 - actor/grad_norm:0.7444781512022018 - perf/mfu/actor:0.0902735729938828 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.88966369628906 - actor/lr:1e-06 - training/global_step:139 - training/epoch:3 - critic/score/mean:1.0078125 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0078125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.00033970942604355514 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00033970942604355514 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:339.0531311035156 - response_length/max:1266.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.126588702201843e-05 - timing_s/generate_sequences:31.434602737426758 - timing_s/reshard:0.642958402633667 - timing_s/gen:41.63228131830692 - timing_s/reward:0.073715103790164 - timing_s/old_log_prob:1.143033243715763 - timing_s/ref:1.351458227261901 - timing_s/adv:0.007483659312129021 - timing_s/update_actor:7.0889551267027855 - timing_s/step:51.31247555650771 - timing_s/stop_profile:4.227086901664734e-05 - timing_per_token_ms/update_actor:0.02959378783972241 - timing_per_token_ms/gen:0.38371827164167605 - timing_per_token_ms/ref:0.005641842462958065 - timing_per_token_ms/adv:3.124153305945939e-05 - perf/total_num_tokens:239542 - perf/time_per_step:51.31247555650771 - perf/throughput:583.5374277942533
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140
[36m(TaskRunner pid=2905377)[0m step:140 - global_seqlen/min:26444 - global_seqlen/max:33408 - global_seqlen/minmax_diff:6964 - global_seqlen/balanced_min:30100 - global_seqlen/balanced_max:30108 - global_seqlen/mean:30101.5 - actor/entropy:0.41191646456718445 - actor/kl_loss:0.08317800164222718 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.047195963887497784 - actor/pg_clipfrac:0.0007877091586124152 - actor/ppo_kl:-0.00046848828096699433 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8428340256214142 - perf/mfu/actor:0.09074462110485354 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.88450241088867 - actor/lr:1e-06 - training/global_step:140 - training/epoch:3 - critic/score/mean:1.103124976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.103124976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.01411811076104641 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01411811076104641 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:342.8031311035156 - response_length/max:1339.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.847510278224945e-05 - timing_s/generate_sequences:33.22651290893555 - timing_s/reshard:0.6694517135620117 - timing_s/gen:43.6776548884809 - timing_s/reward:0.07526416517794132 - timing_s/old_log_prob:1.1661616619676352 - timing_s/ref:1.356970228254795 - timing_s/adv:0.007546786218881607 - timing_s/update_actor:7.089919101446867 - timing_s/save_checkpoint:8.361237498000264 - timing_s/step:61.74795173853636 - timing_s/stop_profile:4.7594308853149414e-05 - timing_per_token_ms/update_actor:0.029441718441966625 - timing_per_token_ms/gen:0.3981663572247272 - timing_per_token_ms/ref:0.005634977610147314 - timing_per_token_ms/adv:3.133891259107356e-05 - perf/total_num_tokens:240812 - perf/time_per_step:61.74795173853636 - perf/throughput:487.4898543592324
[36m(TaskRunner pid=2905377)[0m Training Progress:  27%|██▋       | 141/525 [2:15:50<5:55:43, 55.58s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:15:58,354:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:15:58,356:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_140/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  27%|██▋       | 142/525 [2:16:56<6:14:48, 58.72s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  27%|██▋       | 143/525 [2:17:52<6:08:55, 57.95s/it]
[36m(TaskRunner pid=2905377)[0m step:141 - global_seqlen/min:28154 - global_seqlen/max:35563 - global_seqlen/minmax_diff:7409 - global_seqlen/balanced_min:30818 - global_seqlen/balanced_max:30818 - global_seqlen/mean:30818.0 - actor/entropy:0.4346199035644531 - actor/kl_loss:0.06678044777363538 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04936675056815147 - actor/pg_clipfrac:0.0007359753479249775 - actor/ppo_kl:0.0007658292939595413 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8266280293464661 - perf/mfu/actor:0.09034208358176232 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.97557067871094 - actor/lr:1e-06 - training/global_step:141 - training/epoch:4 - critic/score/mean:1.0437500476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0437500476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.001037347363308072 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.001037347363308072 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:361.26251220703125 - response_length/max:1061.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003465358167886734 - timing_s/generate_sequences:30.2271728515625 - timing_s/reshard:0.6740918755531311 - timing_s/gen:36.160487819463015 - timing_s/reward:0.07832626812160015 - timing_s/old_log_prob:1.149334767833352 - timing_s/ref:1.3807130604982376 - timing_s/adv:0.007623245939612389 - timing_s/update_actor:7.296337945386767 - timing_s/step:46.10211410559714 - timing_s/stop_profile:4.2226165533065796e-05 - timing_per_token_ms/update_actor:0.029594465675038806 - timing_per_token_ms/gen:0.31279616466093746 - timing_per_token_ms/ref:0.00560027037972223 - timing_per_token_ms/adv:3.09204277516889e-05 - perf/total_num_tokens:246544 - perf/time_per_step:46.10211410559714 - perf/throughput:668.472598228602
[36m(TaskRunner pid=2905377)[0m step:142 - global_seqlen/min:26704 - global_seqlen/max:35503 - global_seqlen/minmax_diff:8799 - global_seqlen/balanced_min:30809 - global_seqlen/balanced_max:30962 - global_seqlen/mean:30847.875 - actor/entropy:0.42454567551612854 - actor/kl_loss:0.09126663748174905 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10432235039770603 - actor/pg_clipfrac:0.0016955273051280529 - actor/ppo_kl:-0.0007742189374766895 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8186009079217911 - perf/mfu/actor:0.0915314906209419 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.03217315673828 - actor/lr:1e-06 - training/global_step:142 - training/epoch:4 - critic/score/mean:1.0343749523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0343749523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.006494088564068079 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.006494088564068079 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:362.0093688964844 - response_length/max:1749.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.06022435426712e-05 - timing_s/generate_sequences:40.831703186035156 - timing_s/reshard:0.7033165097236633 - timing_s/gen:56.17400547116995 - timing_s/reward:0.07562196254730225 - timing_s/old_log_prob:1.14974114485085 - timing_s/ref:1.3801301196217537 - timing_s/adv:0.00751534104347229 - timing_s/update_actor:7.214545151218772 - timing_s/step:66.01473591662943 - timing_s/stop_profile:4.028342664241791e-05 - timing_per_token_ms/update_actor:0.02923436845819514 - timing_per_token_ms/gen:0.4849149751920267 - timing_per_token_ms/ref:0.005592484569932912 - timing_per_token_ms/adv:3.045323642014357e-05 - perf/total_num_tokens:246783 - perf/time_per_step:66.01473591662943 - perf/throughput:467.2877134426174
[36m(TaskRunner pid=2905377)[0m step:143 - global_seqlen/min:26496 - global_seqlen/max:34058 - global_seqlen/minmax_diff:7562 - global_seqlen/balanced_min:30033 - global_seqlen/balanced_max:30203 - global_seqlen/mean:30055.5 - actor/entropy:0.39626580476760864 - actor/kl_loss:0.0860871379263699 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08413927108049393 - actor/pg_clipfrac:0.0008121553604723885 - actor/ppo_kl:-0.0002607219146739226 - actor/pg_clipfrac_lower:3.0156815773807467e-05 - actor/grad_norm:0.7773327827453613 - perf/mfu/actor:0.0885476049491838 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.12697219848633 - actor/lr:1e-06 - training/global_step:143 - training/epoch:4 - critic/score/mean:1.021875023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.021875023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.03415290638804436 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03415290638804436 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:341.76251220703125 - response_length/max:1441.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.757971227169037e-05 - timing_s/generate_sequences:29.930801391601562 - timing_s/reshard:0.6633970141410828 - timing_s/gen:45.92046414874494 - timing_s/reward:0.07829563319683075 - timing_s/old_log_prob:1.2484744880348444 - timing_s/ref:1.3627169225364923 - timing_s/adv:0.007552769035100937 - timing_s/update_actor:7.253772342577577 - timing_s/step:55.884590001776814 - timing_s/stop_profile:4.200637340545654e-05 - timing_per_token_ms/update_actor:0.030168240183067893 - timing_per_token_ms/gen:0.41988647222801784 - timing_per_token_ms/ref:0.005667502297984114 - timing_per_token_ms/adv:3.141175922502095e-05 - perf/total_num_tokens:240444 - perf/time_per_step:55.884590001776814 - perf/throughput:537.8137336078587
[36m(TaskRunner pid=2905377)[0m Training Progress:  27%|██▋       | 144/525 [2:19:05<6:35:59, 62.36s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  28%|██▊       | 145/525 [2:19:54<6:10:06, 58.44s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  28%|██▊       | 146/525 [2:21:01<6:24:56, 60.94s/it]
[36m(TaskRunner pid=2905377)[0m step:144 - global_seqlen/min:27064 - global_seqlen/max:33107 - global_seqlen/minmax_diff:6043 - global_seqlen/balanced_min:30206 - global_seqlen/balanced_max:31075 - global_seqlen/mean:30314.625 - actor/entropy:0.37941431999206543 - actor/kl_loss:0.07977895578369498 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.25382210314273834 - actor/pg_clipfrac:0.000731514795916155 - actor/ppo_kl:-0.0004524936382949818 - actor/pg_clipfrac_lower:0.000396558060310781 - actor/grad_norm:0.7726267874240875 - perf/mfu/actor:0.09106057139986776 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.20731353759766 - actor/lr:1e-06 - training/global_step:144 - training/epoch:4 - critic/score/mean:1.0106250047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0106250047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.056803442537784576 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.056803442537784576 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:348.4593811035156 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.697753608226776e-05 - timing_s/generate_sequences:36.75107955932617 - timing_s/reshard:0.7543492913246155 - timing_s/gen:62.93286684900522 - timing_s/reward:0.07518374733626842 - timing_s/old_log_prob:1.1473044343292713 - timing_s/ref:1.3590663634240627 - timing_s/adv:0.007484151050448418 - timing_s/update_actor:7.115829557180405 - timing_s/step:72.6510421987623 - timing_s/stop_profile:4.591792821884155e-05 - timing_per_token_ms/update_actor:0.0293415701051077 - timing_per_token_ms/gen:0.5643848982485873 - timing_per_token_ms/ref:0.005604004516895982 - timing_per_token_ms/adv:3.0860315155013536e-05 - perf/total_num_tokens:242517 - perf/time_per_step:72.6510421987623 - perf/throughput:417.2634566901842
[36m(TaskRunner pid=2905377)[0m step:145 - global_seqlen/min:28316 - global_seqlen/max:34806 - global_seqlen/minmax_diff:6490 - global_seqlen/balanced_min:30986 - global_seqlen/balanced_max:30987 - global_seqlen/mean:30986.875 - actor/entropy:0.3844680190086365 - actor/kl_loss:0.0846820236183703 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06708106696605683 - actor/pg_clipfrac:0.0008135378477163613 - actor/ppo_kl:0.00015038360981947107 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.977205827832222 - perf/mfu/actor:0.09248508207657576 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.17738723754883 - actor/lr:1e-06 - training/global_step:145 - training/epoch:4 - critic/score/mean:0.925000011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.925000011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.008390702307224274 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008390702307224274 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:365.265625 - response_length/max:1176.0 - response_length/min:86.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.147822856903076e-05 - timing_s/generate_sequences:30.862003326416016 - timing_s/reshard:0.7228522896766663 - timing_s/gen:39.32568223029375 - timing_s/reward:0.07633389718830585 - timing_s/old_log_prob:1.131954837590456 - timing_s/ref:1.4078175500035286 - timing_s/adv:0.007730299606919289 - timing_s/update_actor:7.167406622320414 - timing_s/step:49.13013720884919 - timing_s/stop_profile:4.309415817260742e-05 - timing_per_token_ms/update_actor:0.02891307457722186 - timing_per_token_ms/gen:0.3364476385361146 - timing_per_token_ms/ref:0.005679088122001366 - timing_per_token_ms/adv:3.118376573516726e-05 - perf/total_num_tokens:247895 - perf/time_per_step:49.13013720884919 - perf/throughput:630.7101254017814
[36m(TaskRunner pid=2905377)[0m step:146 - global_seqlen/min:28214 - global_seqlen/max:36093 - global_seqlen/minmax_diff:7879 - global_seqlen/balanced_min:30294 - global_seqlen/balanced_max:30533 - global_seqlen/mean:30328.0 - actor/entropy:0.4007357656955719 - actor/kl_loss:0.0873687444254756 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03733235001564026 - actor/pg_clipfrac:0.0008681726118084043 - actor/ppo_kl:0.0018470734838047064 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.6543496996164322 - perf/mfu/actor:0.08773318201698956 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.16071319580078 - actor/lr:1e-06 - training/global_step:146 - training/epoch:4 - critic/score/mean:0.96875 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.96875 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.001490596099756658 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.001490596099756658 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:348.24688720703125 - response_length/max:1802.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.306039333343506e-05 - timing_s/generate_sequences:36.848899841308594 - timing_s/reshard:0.6719966530799866 - timing_s/gen:56.78827113099396 - timing_s/reward:0.07517934963107109 - timing_s/old_log_prob:1.1316892355680466 - timing_s/ref:1.3555419277399778 - timing_s/adv:0.00742834247648716 - timing_s/update_actor:7.391734814271331 - timing_s/step:66.7633361890912 - timing_s/stop_profile:4.15164977312088e-05 - timing_per_token_ms/update_actor:0.030465802287784106 - timing_per_token_ms/gen:0.5095906382056009 - timing_per_token_ms/ref:0.005587006758358521 - timing_per_token_ms/adv:3.061668456742597e-05 - perf/total_num_tokens:242624 - perf/time_per_step:66.7633361890912 - perf/throughput:454.26130165369784
[36m(TaskRunner pid=2905377)[0m Training Progress:  28%|██▊       | 147/525 [2:21:39<5:41:19, 54.18s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  28%|██▊       | 148/525 [2:22:41<5:54:17, 56.39s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  28%|██▊       | 149/525 [2:23:33<5:44:54, 55.04s/it]
[36m(TaskRunner pid=2905377)[0m step:147 - global_seqlen/min:27923 - global_seqlen/max:33794 - global_seqlen/minmax_diff:5871 - global_seqlen/balanced_min:30082 - global_seqlen/balanced_max:30083 - global_seqlen/mean:30082.25 - actor/entropy:0.4102533459663391 - actor/kl_loss:0.08323998246341943 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04019412584602833 - actor/pg_clipfrac:0.0012695593060925603 - actor/ppo_kl:-0.00011894844647031277 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8075451701879501 - perf/mfu/actor:0.08993255112003398 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.18195343017578 - actor/lr:1e-06 - training/global_step:147 - training/epoch:4 - critic/score/mean:0.9887499809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9887499809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.005045504774898291 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.005045504774898291 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:341.8843688964844 - response_length/max:829.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.711164653301239e-05 - timing_s/generate_sequences:25.452577590942383 - timing_s/reshard:0.69969642162323 - timing_s/gen:28.680619433522224 - timing_s/reward:0.0743002649396658 - timing_s/old_log_prob:1.1141925677657127 - timing_s/ref:1.35775638371706 - timing_s/adv:0.007869191467761993 - timing_s/update_actor:7.146491939201951 - timing_s/step:38.39422236941755 - timing_s/stop_profile:4.277750849723816e-05 - timing_per_token_ms/update_actor:0.029695634216198717 - timing_per_token_ms/gen:0.2621556943915818 - timing_per_token_ms/ref:0.005641850192875616 - timing_per_token_ms/adv:3.269864898637067e-05 - perf/total_num_tokens:240658 - perf/time_per_step:38.39422236941755 - perf/throughput:783.5098132879923
[36m(TaskRunner pid=2905377)[0m step:148 - global_seqlen/min:26986 - global_seqlen/max:33737 - global_seqlen/minmax_diff:6751 - global_seqlen/balanced_min:30413 - global_seqlen/balanced_max:30612 - global_seqlen/mean:30439.125 - actor/entropy:0.42044466733932495 - actor/kl_loss:0.0756498983129859 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0439100943505764 - actor/pg_clipfrac:0.0007890301349107176 - actor/ppo_kl:-9.024718856380787e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.734131932258606 - perf/mfu/actor:0.09176911993345262 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.14986801147461 - actor/lr:1e-06 - training/global_step:148 - training/epoch:4 - critic/score/mean:1.021875023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.021875023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.00941251777112484 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00941251777112484 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:351.5718688964844 - response_length/max:1613.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.466226816177368e-05 - timing_s/generate_sequences:34.71535873413086 - timing_s/reshard:0.6535497307777405 - timing_s/gen:51.82505110837519 - timing_s/reward:0.0746184904128313 - timing_s/old_log_prob:1.146131845191121 - timing_s/ref:1.3615164291113615 - timing_s/adv:0.007632747292518616 - timing_s/update_actor:7.093082686886191 - timing_s/step:61.521219961345196 - timing_s/stop_profile:4.3528154492378235e-05 - timing_per_token_ms/update_actor:0.02912814793003327 - timing_per_token_ms/gen:0.46065483683435277 - timing_per_token_ms/ref:0.005591144740163201 - timing_per_token_ms/adv:3.134431136127687e-05 - perf/total_num_tokens:243513 - perf/time_per_step:61.521219961345196 - perf/throughput:494.7744049797031
[36m(TaskRunner pid=2905377)[0m step:149 - global_seqlen/min:26551 - global_seqlen/max:33892 - global_seqlen/minmax_diff:7341 - global_seqlen/balanced_min:28722 - global_seqlen/balanced_max:28880 - global_seqlen/mean:28743.0 - actor/entropy:0.4385438561439514 - actor/kl_loss:0.08900828436017036 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.056003982573747633 - actor/pg_clipfrac:0.0010957873484585435 - actor/ppo_kl:-0.0005468720501085045 - actor/pg_clipfrac_lower:0.0001315789530053735 - actor/grad_norm:0.8570596426725388 - perf/mfu/actor:0.08703194469518785 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.25764846801758 - actor/lr:1e-06 - training/global_step:149 - training/epoch:4 - critic/score/mean:1.125 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.031132211908698082 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.031132211908698082 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:308.95001220703125 - response_length/max:1304.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.592568337917328e-05 - timing_s/generate_sequences:29.955102920532227 - timing_s/reshard:0.7515677809715271 - timing_s/gen:41.99027067236602 - timing_s/reward:0.0713874101638794 - timing_s/old_log_prob:1.1600337829440832 - timing_s/ref:1.3599560502916574 - timing_s/adv:0.007474496960639954 - timing_s/update_actor:7.047205999493599 - timing_s/step:51.64950202405453 - timing_s/stop_profile:4.2984262108802795e-05 - timing_per_token_ms/update_actor:0.03064748808185297 - timing_per_token_ms/gen:0.42472761240053025 - timing_per_token_ms/ref:0.0059142923941988374 - timing_per_token_ms/adv:3.250572731030144e-05 - perf/total_num_tokens:229944 - perf/time_per_step:51.64950202405453 - perf/throughput:556.5010091794037
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 150}
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <think>
[36m(TaskRunner pid=2905377)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and its foci on the \(x\)-axis, the standard form of the equation of such a hyperbola is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the distance from the center to each focus.
[36m(TaskRunner pid=2905377)[0m 
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 13:26:51,579:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 13:26:55,152:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 13:26:55,155:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:26:56,372:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  29%|██▊       | 150/525 [2:26:00<8:37:31, 82.80s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 13:26:51,877:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m The equation of the parabola is \(y^2 = 16x\). The standard form of a parabola that opens to the right is \(y^2 = 4px\), where \(p\) is the distance from the vertex to the focus. By comparing \(y^2 = 16x\) with \(y^2 = 4px\), we get \(4p = 16\), so \(p = 4\). The focus of the parabola is at \((4, 0)\) and the directrix is the line \(x = -4\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The hyperbola intersects the parabola at points \(A\) and \(B\). Since the hyperbola and the parabola intersect at points that are symmetric with respect to the \(x\)-axis, the \(y\)-coordinates of \(A\) and \(B\) will be of opposite signs. Let's denote the coordinates of \(A\) as \((x_1, y_1)\) and the coordinates of \(B\) as \((x_1, -y_1)\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The distance between \(A\) and \(B\) is given as \(|AB| = 4\sqrt{3}\). Since \(A\) and \(B\) are symmetric with respect to the \(x\)-axis, the distance \(|AB|\) is simply \(2|y_1|\). Therefore, we have:
[36m(TaskRunner pid=2905377)[0m \[2|y_1| = 4\sqrt{3} \implies |y_1| = 2\sqrt{3}.\]
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Now, we substitute \(y_1 = 2\sqrt{3}\) into the equation of the parabola to find \(x_1\):
[36m(TaskRunner pid=2905377)[0m \[y_1^2 = 16x_1 \implies (2\sqrt{3})^2 = 16x_1 \implies 12 = 16x_1 \implies x_1 = \frac{12}{16} = \frac{3}{4}.\]
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The point \((x_1, y_1)\) lies on the hyperbola, so it satisfies the equation \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\):
[36m(TaskRunner pid=2905377)[0m \[\frac{\left(\frac{3}{4}\right)^2}{a^2} - \frac{(2\sqrt{3})^2}{a^2} = 1 \implies \frac{\frac{9}{16}}{a^2} - \frac{12}{a^2} = 1 \implies \frac{9 - 192}{16a^2} = 1 \implies \frac{-183}{16a^2} = 1 \implies -183 = 16a^2 \implies a^2 = \frac{183}{16}.\]
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The length of the real axis of the hyperbola is \(2a\). Since \(a^2 = \frac{183}{16}\), we have:
[36m(TaskRunner pid=2905377)[0m \[a = \sqrt{\frac{183}{16}} = \frac{\sqrt{183}}{4}.\]
[36m(TaskRunner pid=2905377)[0m Therefore, the length of the real axis is:
[36m(TaskRunner pid=2905377)[0m \[2a = 2 \cdot \frac{\sqrt{183}}{4} = \frac{\sqrt{183}}{2}.\]
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m However, the options provided are in simplified radical form. The correct option is:
[36m(TaskRunner pid=2905377)[0m \[\boxed{B}\]
[36m(TaskRunner pid=2905377)[0m </think>
[36m(TaskRunner pid=2905377)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 0.6
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150
[36m(TaskRunner pid=2905377)[0m step:150 - global_seqlen/min:26805 - global_seqlen/max:33928 - global_seqlen/minmax_diff:7123 - global_seqlen/balanced_min:30545 - global_seqlen/balanced_max:30895 - global_seqlen/mean:30623.75 - actor/entropy:0.4126627743244171 - actor/kl_loss:0.09541127113625407 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1028991311788559 - actor/pg_clipfrac:0.0015083438338479027 - actor/ppo_kl:0.00033171241393574745 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8167347311973572 - perf/mfu/actor:0.09148000263562395 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.39968872070312 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.880000022649765 - val-aux/grpo_convert/reward/std@50:0.4369415910745874 - val-aux/grpo_convert/reward/best@2/mean:1.0807000237703324 - val-aux/grpo_convert/reward/best@2/std:0.4027535913650525 - val-aux/grpo_convert/reward/worst@2/mean:0.6799000212550164 - val-aux/grpo_convert/reward/worst@2/std:0.3675787077383753 - val-aux/grpo_convert/reward/best@4/mean:1.242500023841858 - val-aux/grpo_convert/reward/best@4/std:0.34853101000302256 - val-aux/grpo_convert/reward/worst@4/mean:0.5254000192284585 - val-aux/grpo_convert/reward/worst@4/std:0.3051672686945933 - val-aux/grpo_convert/reward/best@8/mean:1.3805000238418579 - val-aux/grpo_convert/reward/best@8/std:0.26387403510924967 - val-aux/grpo_convert/reward/worst@8/mean:0.40510001599788664 - val-aux/grpo_convert/reward/worst@8/std:0.26599134598619734 - val-aux/grpo_convert/reward/best@16/mean:1.505000023841858 - val-aux/grpo_convert/reward/best@16/std:0.19615045245933033 - val-aux/grpo_convert/reward/worst@16/mean:0.2979000118374825 - val-aux/grpo_convert/reward/worst@16/std:0.2652665743465218 - val-aux/grpo_convert/reward/best@32/mean:1.583500023841858 - val-aux/grpo_convert/reward/best@32/std:0.08931825121440747 - val-aux/grpo_convert/reward/worst@32/mean:0.17730000704526902 - val-aux/grpo_convert/reward/worst@32/std:0.2248337089960869 - val-core/grpo_convert/reward/best@50/mean:1.5985000238418579 - val-core/grpo_convert/reward/best@50/std:0.027345017827750638 - val-aux/grpo_convert/reward/worst@50/mean:0.11310000449419022 - val-aux/grpo_convert/reward/worst@50/std:0.17301054608625085 - training/global_step:150 - training/epoch:4 - critic/score/mean:1.0137499570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0137499570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02915339358150959 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02915339358150959 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:355.640625 - response_length/max:2048.0 - response_length/min:68.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.685832679271698e-05 - timing_s/generate_sequences:38.3365478515625 - timing_s/reshard:0.6484595537185669 - timing_s/gen:64.09506097249687 - timing_s/reward:0.07532022520899773 - timing_s/old_log_prob:1.2457017786800861 - timing_s/ref:1.3586645480245352 - timing_s/adv:0.007514066994190216 - timing_s/update_actor:7.166087621822953 - timing_s/testing:65.55908435024321 - timing_s/save_checkpoint:8.055076180025935 - timing_s/step:147.57582388818264 - timing_s/stop_profile:5.282461643218994e-05 - timing_per_token_ms/update_actor:0.029250531131160263 - timing_per_token_ms/gen:0.5632007466499439 - timing_per_token_ms/ref:0.005545795942791686 - timing_per_token_ms/adv:3.0670913074779443e-05 - perf/total_num_tokens:244990 - perf/time_per_step:147.57582388818264 - perf/throughput:207.5119704105697
[36m(TaskRunner pid=2905377)[0m Training Progress:  29%|██▉       | 151/525 [2:26:52<7:37:12, 73.35s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:26:56,825:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:26:56,827:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_150/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  29%|██▉       | 152/525 [2:27:36<6:41:45, 64.63s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  29%|██▉       | 153/525 [2:28:22<6:06:40, 59.14s/it]
[36m(TaskRunner pid=2905377)[0m step:151 - global_seqlen/min:27811 - global_seqlen/max:30499 - global_seqlen/minmax_diff:2688 - global_seqlen/balanced_min:29146 - global_seqlen/balanced_max:29289 - global_seqlen/mean:29164.5 - actor/entropy:0.4268021881580353 - actor/kl_loss:0.08602804597467184 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.003506404161453247 - actor/pg_clipfrac:0.0009573932795319707 - actor/ppo_kl:-0.0003902279247995466 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7783953696489334 - perf/mfu/actor:0.08406375746519759 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.24707412719727 - actor/lr:1e-06 - training/global_step:151 - training/epoch:4 - critic/score/mean:1.0109374523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0109374523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.00484493188560009 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00484493188560009 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:319.04998779296875 - response_length/max:1297.0 - response_length/min:78.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.209103882312775e-05 - timing_s/generate_sequences:29.290653228759766 - timing_s/reshard:0.599655270576477 - timing_s/gen:41.0559245031327 - timing_s/reward:0.07329017855226994 - timing_s/old_log_prob:1.104488629847765 - timing_s/ref:1.354084637016058 - timing_s/adv:0.007934831082820892 - timing_s/update_actor:7.406355915591121 - timing_s/step:51.022373208776116 - timing_s/stop_profile:4.560686647891998e-05 - timing_per_token_ms/update_actor:0.031743883469591117 - timing_per_token_ms/gen:0.4021305879087594 - timing_per_token_ms/ref:0.005803651001286058 - timing_per_token_ms/adv:3.400894530516935e-05 - perf/total_num_tokens:233316 - perf/time_per_step:51.022373208776116 - perf/throughput:571.6021848035786
[36m(TaskRunner pid=2905377)[0m step:152 - global_seqlen/min:27210 - global_seqlen/max:32536 - global_seqlen/minmax_diff:5326 - global_seqlen/balanced_min:28895 - global_seqlen/balanced_max:28895 - global_seqlen/mean:28895.0 - actor/entropy:0.4640304446220398 - actor/kl_loss:0.09391220090910793 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05406289454549551 - actor/pg_clipfrac:0.0012165814696345478 - actor/ppo_kl:0.0011674005843815393 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7727441340684891 - perf/mfu/actor:0.08672195471293648 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.28367233276367 - actor/lr:1e-06 - training/global_step:152 - training/epoch:4 - critic/score/mean:1.0125000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0125000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.008002440445125103 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008002440445125103 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:312.3125 - response_length/max:1029.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.139705121517181e-05 - timing_s/generate_sequences:27.37886619567871 - timing_s/reshard:0.735995888710022 - timing_s/gen:34.61147402226925 - timing_s/reward:0.07408993877470493 - timing_s/old_log_prob:1.0954123921692371 - timing_s/ref:1.3490764293819666 - timing_s/adv:0.0074670929461717606 - timing_s/update_actor:7.10756054148078 - timing_s/step:44.25904634036124 - timing_s/stop_profile:4.191882908344269e-05 - timing_per_token_ms/update_actor:0.03074736347759465 - timing_per_token_ms/gen:0.34632253374293825 - timing_per_token_ms/ref:0.0058361153719586716 - timing_per_token_ms/adv:3.2302703522113514e-05 - perf/total_num_tokens:231160 - perf/time_per_step:44.25904634036124 - perf/throughput:652.8608813165893
[36m(TaskRunner pid=2905377)[0m step:153 - global_seqlen/min:26481 - global_seqlen/max:32610 - global_seqlen/minmax_diff:6129 - global_seqlen/balanced_min:29141 - global_seqlen/balanced_max:29142 - global_seqlen/mean:29141.5 - actor/entropy:0.46498361229896545 - actor/kl_loss:0.08716838108375669 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.021050484105944633 - actor/pg_clipfrac:0.0024213101190980525 - actor/ppo_kl:0.00025186238235619385 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0796544253826141 - perf/mfu/actor:0.08868345671047764 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.31119537353516 - actor/lr:1e-06 - training/global_step:153 - training/epoch:4 - critic/score/mean:1.0121874809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0121874809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0061685009859502316 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0061685009859502316 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:319.2406311035156 - response_length/max:1092.0 - response_length/min:71.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.725374937057495e-05 - timing_s/generate_sequences:30.92267417907715 - timing_s/reshard:0.6768574118614197 - timing_s/gen:36.44535855948925 - timing_s/reward:0.07210933044552803 - timing_s/old_log_prob:1.2269199155271053 - timing_s/ref:1.3841606583446264 - timing_s/adv:0.007429946213960648 - timing_s/update_actor:7.014688083902001 - timing_s/step:46.164039647206664 - timing_s/stop_profile:4.62997704744339e-05 - timing_per_token_ms/update_actor:0.030088911363099023 - timing_per_token_ms/gen:0.3567583088725124 - timing_per_token_ms/ref:0.005937240097217998 - timing_per_token_ms/adv:3.187012599712029e-05 - perf/total_num_tokens:233132 - perf/time_per_step:46.164039647206664 - perf/throughput:631.2597472557478
[36m(TaskRunner pid=2905377)[0m Training Progress:  29%|██▉       | 154/525 [2:29:30<6:21:42, 61.73s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  30%|██▉       | 155/525 [2:30:25<6:07:35, 59.61s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  30%|██▉       | 156/525 [2:31:04<5:30:00, 53.66s/it]
[36m(TaskRunner pid=2905377)[0m step:154 - global_seqlen/min:24794 - global_seqlen/max:32962 - global_seqlen/minmax_diff:8168 - global_seqlen/balanced_min:28693 - global_seqlen/balanced_max:29214 - global_seqlen/mean:28842.625 - actor/entropy:0.4209279716014862 - actor/kl_loss:0.10983856841921806 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1678219646215439 - actor/pg_clipfrac:0.00259774963487871 - actor/ppo_kl:0.0012191797417244743 - actor/pg_clipfrac_lower:0.00012722646351903677 - actor/grad_norm:0.9440838843584061 - perf/mfu/actor:0.08799869746938968 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.25907516479492 - actor/lr:1e-06 - training/global_step:154 - training/epoch:4 - critic/score/mean:1.0968749523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0968749523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0010122512467205524 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0010122512467205524 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:312.42498779296875 - response_length/max:1837.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.006952702999115e-05 - timing_s/generate_sequences:34.957786560058594 - timing_s/reshard:0.6405930519104004 - timing_s/gen:58.202760972082615 - timing_s/reward:0.07358427904546261 - timing_s/old_log_prob:1.1186333559453487 - timing_s/ref:1.3473572973161936 - timing_s/adv:0.007511181756854057 - timing_s/update_actor:6.998855510726571 - timing_s/step:67.76457553729415 - timing_s/stop_profile:4.272721707820892e-05 - timing_per_token_ms/update_actor:0.030332084504819563 - timing_per_token_ms/gen:0.5821673298799973 - timing_per_token_ms/ref:0.005839262624831277 - timing_per_token_ms/adv:3.255243652776948e-05 - perf/total_num_tokens:230741 - perf/time_per_step:67.76457553729415 - perf/throughput:425.6298334537121
[36m(TaskRunner pid=2905377)[0m step:155 - global_seqlen/min:25315 - global_seqlen/max:35013 - global_seqlen/minmax_diff:9698 - global_seqlen/balanced_min:30257 - global_seqlen/balanced_max:30258 - global_seqlen/mean:30257.5 - actor/entropy:0.4006747305393219 - actor/kl_loss:0.09183575129136443 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11532903425395488 - actor/pg_clipfrac:0.001520757732214406 - actor/ppo_kl:0.0015477261074920534 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.820284441113472 - perf/mfu/actor:0.09041126810839326 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.2789077758789 - actor/lr:1e-06 - training/global_step:155 - training/epoch:4 - critic/score/mean:1.0625 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.013693924993276596 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.013693924993276596 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:347.140625 - response_length/max:1392.0 - response_length/min:86.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.397681474685669e-05 - timing_s/generate_sequences:34.868934631347656 - timing_s/reshard:0.6479713916778564 - timing_s/gen:44.82745642028749 - timing_s/reward:0.07455732487142086 - timing_s/old_log_prob:1.207261124625802 - timing_s/ref:1.3640695661306381 - timing_s/adv:0.007488986477255821 - timing_s/update_actor:7.156783236190677 - timing_s/step:54.65082090720534 - timing_s/stop_profile:4.349835216999054e-05 - timing_per_token_ms/update_actor:0.029566153995665027 - timing_per_token_ms/gen:0.40354194013851996 - timing_per_token_ms/ref:0.0056352539293176825 - timing_per_token_ms/adv:3.093855439666124e-05 - perf/total_num_tokens:242060 - perf/time_per_step:54.65082090720534 - perf/throughput:553.6513358395089
[36m(TaskRunner pid=2905377)[0m step:156 - global_seqlen/min:26371 - global_seqlen/max:30094 - global_seqlen/minmax_diff:3723 - global_seqlen/balanced_min:28534 - global_seqlen/balanced_max:28535 - global_seqlen/mean:28534.375 - actor/entropy:0.4250604510307312 - actor/kl_loss:0.09078412000089883 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1503029100596905 - actor/pg_clipfrac:0.0013357399991946294 - actor/ppo_kl:0.00011671195825329051 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9012783467769623 - perf/mfu/actor:0.08650500832072358 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.37340545654297 - actor/lr:1e-06 - training/global_step:156 - training/epoch:4 - critic/score/mean:0.9937499761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9937499761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.030292104929685593 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.030292104929685593 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:303.296875 - response_length/max:876.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.113550186157227e-05 - timing_s/generate_sequences:26.416810989379883 - timing_s/reshard:0.6699263453483582 - timing_s/gen:29.750857612118125 - timing_s/reward:0.07096471823751926 - timing_s/old_log_prob:1.1437870375812054 - timing_s/ref:1.3503661043941975 - timing_s/adv:0.007414821535348892 - timing_s/update_actor:7.034975185990334 - timing_s/step:39.37158481776714 - timing_s/stop_profile:4.0860846638679504e-05 - timing_per_token_ms/update_actor:0.03081798351107363 - timing_per_token_ms/gen:0.30653606318188786 - timing_per_token_ms/ref:0.0059155234011354614 - timing_per_token_ms/adv:3.24819692710498e-05 - perf/total_num_tokens:228275 - perf/time_per_step:39.37158481776714 - perf/throughput:724.7454003203687
[36m(TaskRunner pid=2905377)[0m Training Progress:  30%|██▉       | 157/525 [2:32:17<6:03:46, 59.31s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  30%|███       | 158/525 [2:32:57<5:27:55, 53.61s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  30%|███       | 159/525 [2:33:44<5:14:13, 51.51s/it]
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 13:35:27,600:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/model_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 13:35:30,961:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 13:35:30,963:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:35:31,862:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:157 - global_seqlen/min:25582 - global_seqlen/max:33400 - global_seqlen/minmax_diff:7818 - global_seqlen/balanced_min:29676 - global_seqlen/balanced_max:30442 - global_seqlen/mean:29772.75 - actor/entropy:0.40382876992225647 - actor/kl_loss:0.09037876296788454 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06588221602141857 - actor/pg_clipfrac:0.0013501652574632317 - actor/ppo_kl:0.0005264915205771103 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.6825327128171921 - perf/mfu/actor:0.08905122665214144 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.46637344360352 - actor/lr:1e-06 - training/global_step:157 - training/epoch:4 - critic/score/mean:1.0653126239776611 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0653126239776611 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004026359412819147 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.004026359412819147 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:335.1312561035156 - response_length/max:2048.0 - response_length/min:96.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.8519806265831e-05 - timing_s/generate_sequences:38.041194915771484 - timing_s/reshard:0.6391896605491638 - timing_s/gen:62.76318398118019 - timing_s/reward:0.07358172349631786 - timing_s/old_log_prob:1.1276726424694061 - timing_s/ref:1.3564343843609095 - timing_s/adv:0.007422490045428276 - timing_s/update_actor:7.145447578281164 - timing_s/step:72.48683581873775 - timing_s/stop_profile:3.980472683906555e-05 - timing_per_token_ms/update_actor:0.029999947847785157 - timing_per_token_ms/gen:0.5852481675200033 - timing_per_token_ms/ref:0.005694949174836509 - timing_per_token_ms/adv:3.1163102356300125e-05 - perf/total_num_tokens:238182 - perf/time_per_step:72.48683581873775 - perf/throughput:410.73319953502215
[36m(TaskRunner pid=2905377)[0m step:158 - global_seqlen/min:26337 - global_seqlen/max:31950 - global_seqlen/minmax_diff:5613 - global_seqlen/balanced_min:28671 - global_seqlen/balanced_max:28672 - global_seqlen/mean:28671.5 - actor/entropy:0.45698368549346924 - actor/kl_loss:0.09496041610836983 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.004076435789465904 - actor/pg_clipfrac:0.001636345515726134 - actor/ppo_kl:-0.0013642216633343196 - actor/pg_clipfrac_lower:0.00026193532976321877 - actor/grad_norm:0.8887364715337753 - perf/mfu/actor:0.08665428441337197 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.52771377563477 - actor/lr:1e-06 - training/global_step:158 - training/epoch:4 - critic/score/mean:1.0856249332427979 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0856249332427979 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.025670139119029045 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.025670139119029045 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:306.9437561035156 - response_length/max:898.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.468461990356445e-05 - timing_s/generate_sequences:24.943368911743164 - timing_s/reshard:0.7066019773483276 - timing_s/gen:30.704511620104313 - timing_s/reward:0.07387957908213139 - timing_s/old_log_prob:1.090812623500824 - timing_s/ref:1.3539019394665956 - timing_s/adv:0.0074030011892318726 - timing_s/update_actor:7.056443566456437 - timing_s/step:40.30015560425818 - timing_s/stop_profile:4.398636519908905e-05 - timing_per_token_ms/update_actor:0.030764189031165255 - timing_per_token_ms/gen:0.31260320111690165 - timing_per_token_ms/ref:0.005902646964174335 - timing_per_token_ms/adv:3.227508671168178e-05 - perf/total_num_tokens:229372 - perf/time_per_step:40.30015560425818 - perf/throughput:711.4488658939699
[36m(TaskRunner pid=2905377)[0m step:159 - global_seqlen/min:27588 - global_seqlen/max:32824 - global_seqlen/minmax_diff:5236 - global_seqlen/balanced_min:30586 - global_seqlen/balanced_max:30586 - global_seqlen/mean:30586.0 - actor/entropy:0.3661360740661621 - actor/kl_loss:0.09491281546652316 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.037166673596948384 - actor/pg_clipfrac:0.0011403356911614537 - actor/ppo_kl:0.0006091031451433082 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8001443296670914 - perf/mfu/actor:0.08875957451441023 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.63299560546875 - actor/lr:1e-06 - training/global_step:159 - training/epoch:4 - critic/score/mean:1.006250023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.006250023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.025168532505631447 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.025168532505631447 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:355.2437438964844 - response_length/max:1088.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.574314415454865e-05 - timing_s/generate_sequences:31.756282806396484 - timing_s/reshard:0.7036066055297852 - timing_s/gen:36.57632995583117 - timing_s/reward:0.07419857755303383 - timing_s/old_log_prob:1.1213573552668095 - timing_s/ref:1.3610987458378077 - timing_s/adv:0.00745210237801075 - timing_s/update_actor:7.367936508730054 - timing_s/step:46.52145815268159 - timing_s/stop_profile:4.0942803025245667e-05 - timing_per_token_ms/update_actor:0.03011155638498845 - timing_per_token_ms/gen:0.3217538130142259 - timing_per_token_ms/ref:0.00556258887169705 - timing_per_token_ms/adv:3.0455528583382714e-05 - perf/total_num_tokens:244688 - perf/time_per_step:46.52145815268159 - perf/throughput:657.4600456335215
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160
[36m(TaskRunner pid=2905377)[0m Training Progress:  30%|███       | 160/525 [2:34:37<5:15:59, 51.94s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:35:28,259:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  31%|███       | 161/525 [2:35:26<5:09:59, 51.10s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:35:33,322:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:35:33,324:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_160/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  31%|███       | 162/525 [2:36:14<5:02:48, 50.05s/it]
[36m(TaskRunner pid=2905377)[0m step:160 - global_seqlen/min:26159 - global_seqlen/max:32949 - global_seqlen/minmax_diff:6790 - global_seqlen/balanced_min:28993 - global_seqlen/balanced_max:28995 - global_seqlen/mean:28993.5 - actor/entropy:0.4096836447715759 - actor/kl_loss:0.0937452359125018 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0013814613223075867 - actor/pg_clipfrac:0.0010524634475586937 - actor/ppo_kl:0.00014567203943443018 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9417050927877426 - perf/mfu/actor:0.08827583041738461 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.66396713256836 - actor/lr:1e-06 - training/global_step:160 - training/epoch:4 - critic/score/mean:1.0125000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0125000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.03565080091357231 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03565080091357231 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:314.9937438964844 - response_length/max:1081.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.006580173969269e-05 - timing_s/generate_sequences:28.248756408691406 - timing_s/reshard:0.684309184551239 - timing_s/gen:35.131379667669535 - timing_s/reward:0.07208482548594475 - timing_s/old_log_prob:1.0945227574557066 - timing_s/ref:1.3611060064285994 - timing_s/adv:0.007494539022445679 - timing_s/update_actor:7.0073715802282095 - timing_s/save_checkpoint:8.255918005481362 - timing_s/step:52.9429597388953 - timing_s/stop_profile:4.829093813896179e-05 - timing_per_token_ms/update_actor:0.03021095926771608 - timing_per_token_ms/gen:0.34853250726869117 - timing_per_token_ms/ref:0.005868151509944467 - timing_per_token_ms/adv:3.2311289696163274e-05 - perf/total_num_tokens:231948 - perf/time_per_step:52.9429597388953 - perf/throughput:547.6365534339311
[36m(TaskRunner pid=2905377)[0m step:161 - global_seqlen/min:27282 - global_seqlen/max:33575 - global_seqlen/minmax_diff:6293 - global_seqlen/balanced_min:29567 - global_seqlen/balanced_max:29568 - global_seqlen/mean:29567.375 - actor/entropy:0.37394979596138 - actor/kl_loss:0.10989638064056635 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.023076323419809343 - actor/pg_clipfrac:0.0029994032985996453 - actor/ppo_kl:0.0038786688324762507 - actor/pg_clipfrac_lower:9.940357413142919e-05 - actor/grad_norm:0.857734203338623 - perf/mfu/actor:0.08795248814914707 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.53350067138672 - actor/lr:1e-06 - training/global_step:161 - training/epoch:4 - critic/score/mean:1.009374976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.009374976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0009376329835504293 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0009376329835504293 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:329.88751220703125 - response_length/max:1180.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.214319288730621e-05 - timing_s/generate_sequences:28.56583595275879 - timing_s/reshard:0.6597287654876709 - timing_s/gen:39.19510361738503 - timing_s/reward:0.07275940477848053 - timing_s/old_log_prob:1.1026683878153563 - timing_s/ref:1.3794591538608074 - timing_s/adv:0.007459778338670731 - timing_s/update_actor:7.178883032873273 - timing_s/step:48.94966745749116 - timing_s/stop_profile:4.5802444219589233e-05 - timing_per_token_ms/update_actor:0.030349680318565955 - timing_per_token_ms/gen:0.3712923308834928 - timing_per_token_ms/ref:0.0058318465617120535 - timing_per_token_ms/adv:3.1537202485301495e-05 - perf/total_num_tokens:236539 - perf/time_per_step:48.94966745749116 - perf/throughput:604.0362792183804
[36m(TaskRunner pid=2905377)[0m step:162 - global_seqlen/min:27759 - global_seqlen/max:31468 - global_seqlen/minmax_diff:3709 - global_seqlen/balanced_min:29173 - global_seqlen/balanced_max:29220 - global_seqlen/mean:29180.125 - actor/entropy:0.37678343057632446 - actor/kl_loss:0.10032349042594432 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07384596951305866 - actor/pg_clipfrac:0.0025081600353587417 - actor/ppo_kl:-0.002107945320858562 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0578632950782776 - perf/mfu/actor:0.08792070139395614 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.5379867553711 - actor/lr:1e-06 - training/global_step:162 - training/epoch:4 - critic/score/mean:1.045312523841858 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.045312523841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.0038518416695296764 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0038518416695296764 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:320.09686279296875 - response_length/max:1133.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.108653128147125e-05 - timing_s/generate_sequences:28.616548538208008 - timing_s/reshard:0.6751980781555176 - timing_s/gen:37.95696669444442 - timing_s/reward:0.07218725048005581 - timing_s/old_log_prob:1.1045107394456863 - timing_s/ref:1.3623726703226566 - timing_s/adv:0.007534166797995567 - timing_s/update_actor:7.081894006580114 - timing_s/step:47.598575465381145 - timing_s/stop_profile:4.13358211517334e-05 - timing_per_token_ms/update_actor:0.030336975966433123 - timing_per_token_ms/gen:0.37056132122545343 - timing_per_token_ms/ref:0.005836047096793865 - timing_per_token_ms/adv:3.227439394962996e-05 - perf/total_num_tokens:233441 - perf/time_per_step:47.598575465381145 - perf/throughput:613.0461828888757
[36m(TaskRunner pid=2905377)[0m Training Progress:  31%|███       | 163/525 [2:37:17<5:26:23, 54.10s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  31%|███       | 164/525 [2:38:16<5:34:46, 55.64s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  31%|███▏      | 165/525 [2:39:15<5:39:51, 56.64s/it]
[36m(TaskRunner pid=2905377)[0m step:163 - global_seqlen/min:27262 - global_seqlen/max:35793 - global_seqlen/minmax_diff:8531 - global_seqlen/balanced_min:30650 - global_seqlen/balanced_max:30912 - global_seqlen/mean:30683.25 - actor/entropy:0.357940137386322 - actor/kl_loss:0.11910534370690584 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0063322439789772035 - actor/pg_clipfrac:0.002075055101886392 - actor/ppo_kl:-0.0009020713812788017 - actor/pg_clipfrac_lower:7.183908019214869e-05 - actor/grad_norm:0.9087192863225937 - perf/mfu/actor:0.09202946697910433 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.45247268676758 - actor/lr:1e-06 - training/global_step:163 - training/epoch:4 - critic/score/mean:1.046875 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.046875 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0016559978248551488 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0016559978248551488 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:357.56561279296875 - response_length/max:1669.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.796846330165863e-05 - timing_s/generate_sequences:36.36371994018555 - timing_s/reshard:0.8627036809921265 - timing_s/gen:53.80752904526889 - timing_s/reward:0.075708182528615 - timing_s/old_log_prob:1.1374191585928202 - timing_s/ref:1.357568945735693 - timing_s/adv:0.007491998374462128 - timing_s/update_actor:7.131941264495254 - timing_s/step:63.530935391783714 - timing_s/stop_profile:4.035048186779022e-05 - timing_per_token_ms/update_actor:0.029054701117447033 - timing_per_token_ms/gen:0.4702592098064944 - timing_per_token_ms/ref:0.005530578351933437 - timing_per_token_ms/adv:3.052153200224116e-05 - perf/total_num_tokens:245466 - perf/time_per_step:63.530935391783714 - perf/throughput:482.96550036264983
[36m(TaskRunner pid=2905377)[0m step:164 - global_seqlen/min:26250 - global_seqlen/max:36242 - global_seqlen/minmax_diff:9992 - global_seqlen/balanced_min:30066 - global_seqlen/balanced_max:30067 - global_seqlen/mean:30066.25 - actor/entropy:0.33710986375808716 - actor/kl_loss:0.09788860017433762 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13899881038814782 - actor/pg_clipfrac:0.0014730749535374343 - actor/ppo_kl:-0.00018913273015641607 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9412200897932053 - perf/mfu/actor:0.09062566593048003 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.48779296875 - actor/lr:1e-06 - training/global_step:164 - training/epoch:4 - critic/score/mean:1.0625 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0025719681289047003 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0025719681289047003 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:341.59375 - response_length/max:1481.0 - response_length/min:80.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.20519232749939e-05 - timing_s/generate_sequences:35.15604782104492 - timing_s/reshard:0.6559035181999207 - timing_s/gen:49.16324110329151 - timing_s/reward:0.07449318654835224 - timing_s/old_log_prob:1.1454405449330807 - timing_s/ref:1.355178341269493 - timing_s/adv:0.007382595911622047 - timing_s/update_actor:7.094716545194387 - timing_s/step:58.85367528349161 - timing_s/stop_profile:4.443712532520294e-05 - timing_per_token_ms/update_actor:0.029496181537414824 - timing_per_token_ms/gen:0.4497597758969126 - timing_per_token_ms/ref:0.005634134375210964 - timing_per_token_ms/adv:3.06930358442691e-05 - perf/total_num_tokens:240530 - perf/time_per_step:58.85367528349161 - perf/throughput:510.86444228290276
[36m(TaskRunner pid=2905377)[0m step:165 - global_seqlen/min:26411 - global_seqlen/max:35146 - global_seqlen/minmax_diff:8735 - global_seqlen/balanced_min:30444 - global_seqlen/balanced_max:30617 - global_seqlen/mean:30483.625 - actor/entropy:0.35419511795043945 - actor/kl_loss:0.11027995310723782 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06118154339492321 - actor/pg_clipfrac:0.0013087812054436653 - actor/ppo_kl:0.001998226701107342 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9240273535251617 - perf/mfu/actor:0.09083007825698888 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.49400329589844 - actor/lr:1e-06 - training/global_step:165 - training/epoch:4 - critic/score/mean:1.006250023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.006250023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.04006964713335037 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04006964713335037 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:352.13751220703125 - response_length/max:1515.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.084811270236969e-05 - timing_s/generate_sequences:32.52621841430664 - timing_s/reshard:0.6462358236312866 - timing_s/gen:49.199487794190645 - timing_s/reward:0.07936237566173077 - timing_s/old_log_prob:1.1285296604037285 - timing_s/ref:1.3645838797092438 - timing_s/adv:0.007314184680581093 - timing_s/update_actor:7.176043437793851 - timing_s/step:58.96834756992757 - timing_s/stop_profile:4.155188798904419e-05 - timing_per_token_ms/update_actor:0.02942581237383124 - timing_per_token_ms/gen:0.43661467283900685 - timing_per_token_ms/ref:0.005595561058228983 - timing_per_token_ms/adv:2.9992269130480268e-05 - perf/total_num_tokens:243869 - perf/time_per_step:58.96834756992757 - perf/throughput:516.9489439033545
[36m(TaskRunner pid=2905377)[0m Training Progress:  32%|███▏      | 166/525 [2:40:10<5:35:13, 56.03s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  32%|███▏      | 167/525 [2:41:06<5:33:41, 55.93s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  32%|███▏      | 168/525 [2:42:06<5:40:56, 57.30s/it]
[36m(TaskRunner pid=2905377)[0m step:166 - global_seqlen/min:27040 - global_seqlen/max:33450 - global_seqlen/minmax_diff:6410 - global_seqlen/balanced_min:29674 - global_seqlen/balanced_max:29675 - global_seqlen/mean:29674.625 - actor/entropy:0.3354557454586029 - actor/kl_loss:0.12142724525183439 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.051599017530679706 - actor/pg_clipfrac:0.0018956458545289934 - actor/ppo_kl:0.0028538768136058936 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9955768138170242 - perf/mfu/actor:0.08995142539961874 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.4749755859375 - actor/lr:1e-06 - training/global_step:166 - training/epoch:4 - critic/score/mean:1.068750023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.068750023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.006540331989526749 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.006540331989526749 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:332.3500061035156 - response_length/max:1384.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.196942508220673e-05 - timing_s/generate_sequences:34.90045928955078 - timing_s/reshard:0.7543687224388123 - timing_s/gen:44.95335176214576 - timing_s/reward:0.07389315962791443 - timing_s/old_log_prob:1.117568451911211 - timing_s/ref:1.3645993489772081 - timing_s/adv:0.007447578012943268 - timing_s/update_actor:7.049088425934315 - timing_s/step:54.57928058691323 - timing_s/stop_profile:4.535354673862457e-05 - timing_per_token_ms/update_actor:0.029693249813326685 - timing_per_token_ms/gen:0.422684592317453 - timing_per_token_ms/ref:0.005748174361837799 - timing_per_token_ms/adv:3.1371828679146186e-05 - perf/total_num_tokens:237397 - perf/time_per_step:54.57928058691323 - perf/throughput:543.6976207985279
[36m(TaskRunner pid=2905377)[0m step:167 - global_seqlen/min:27147 - global_seqlen/max:32245 - global_seqlen/minmax_diff:5098 - global_seqlen/balanced_min:30310 - global_seqlen/balanced_max:30517 - global_seqlen/mean:30349.5 - actor/entropy:0.3782444894313812 - actor/kl_loss:0.13442356493324042 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1432206426979974 - actor/pg_clipfrac:0.003548370971111581 - actor/ppo_kl:0.0013929057702625868 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0939845591783524 - perf/mfu/actor:0.0907264256532551 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.50983047485352 - actor/lr:1e-06 - training/global_step:167 - training/epoch:4 - critic/score/mean:1.0043749809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0043749809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.006172663066536188 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.006172663066536188 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:349.33123779296875 - response_length/max:1397.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.937902748584747e-05 - timing_s/generate_sequences:30.359878540039062 - timing_s/reshard:0.6758987903594971 - timing_s/gen:45.6968548912555 - timing_s/reward:0.07611020468175411 - timing_s/old_log_prob:1.2929899338632822 - timing_s/ref:1.3533790484070778 - timing_s/adv:0.008191723376512527 - timing_s/update_actor:7.151718160137534 - timing_s/step:55.59683055989444 - timing_s/stop_profile:4.36343252658844e-05 - timing_per_token_ms/update_actor:0.02945566714500047 - timing_per_token_ms/gen:0.4087887113883268 - timing_per_token_ms/ref:0.005574140630023055 - timing_per_token_ms/adv:3.373911998761317e-05 - perf/total_num_tokens:242796 - perf/time_per_step:55.59683055989444 - perf/throughput:545.8854343738983
[36m(TaskRunner pid=2905377)[0m step:168 - global_seqlen/min:27526 - global_seqlen/max:34000 - global_seqlen/minmax_diff:6474 - global_seqlen/balanced_min:30249 - global_seqlen/balanced_max:30523 - global_seqlen/mean:30304.5 - actor/entropy:0.35854706168174744 - actor/kl_loss:0.12707834970206022 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07173269875347614 - actor/pg_clipfrac:0.001514801225857809 - actor/ppo_kl:0.0020540221123155787 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8053643256425858 - perf/mfu/actor:0.08977540709988556 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.51813888549805 - actor/lr:1e-06 - training/global_step:168 - training/epoch:4 - critic/score/mean:1.0812499523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0812499523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.010457358323037624 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.010457358323037624 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:348.97186279296875 - response_length/max:1627.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.884817361831665e-05 - timing_s/generate_sequences:30.59328269958496 - timing_s/reshard:0.771537721157074 - timing_s/gen:50.5966641549021 - timing_s/reward:0.07537481375038624 - timing_s/old_log_prob:1.2229546215385199 - timing_s/ref:1.3523517306894064 - timing_s/adv:0.008296597748994827 - timing_s/update_actor:7.2209306843578815 - timing_s/step:60.49397734180093 - timing_s/stop_profile:4.155561327934265e-05 - timing_per_token_ms/update_actor:0.02978489450559274 - timing_per_token_ms/gen:0.45308687264287145 - timing_per_token_ms/ref:0.005578180347346955 - timing_per_token_ms/adv:3.4221805957014746e-05 - perf/total_num_tokens:242436 - perf/time_per_step:60.49397734180093 - perf/throughput:500.95069512084797
[36m(TaskRunner pid=2905377)[0m Training Progress:  32%|███▏      | 169/525 [2:43:01<5:36:24, 56.70s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:44:57,857:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:45:01,391:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:45:01,393:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:45:02,119:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  32%|███▏      | 170/525 [2:44:06<5:50:07, 59.18s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 13:44:58,266:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  33%|███▎      | 171/525 [2:45:07<5:51:43, 59.61s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:45:02,852:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:45:02,854:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:169 - global_seqlen/min:25422 - global_seqlen/max:33601 - global_seqlen/minmax_diff:8179 - global_seqlen/balanced_min:30039 - global_seqlen/balanced_max:30040 - global_seqlen/mean:30039.625 - actor/entropy:0.34757280349731445 - actor/kl_loss:0.13653574977070093 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.18604698637500405 - actor/pg_clipfrac:0.0020373265084344893 - actor/ppo_kl:0.0020237817130691837 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9119774550199509 - perf/mfu/actor:0.0891931290692814 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.53055572509766 - actor/lr:1e-06 - training/global_step:169 - training/epoch:4 - critic/score/mean:1.09375 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.09375 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.011000479571521282 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.011000479571521282 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:341.5843811035156 - response_length/max:1393.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.823217988014221e-05 - timing_s/generate_sequences:34.94853973388672 - timing_s/reshard:0.6704845428466797 - timing_s/gen:45.39102051593363 - timing_s/reward:0.07399071753025055 - timing_s/old_log_prob:1.1437280476093292 - timing_s/ref:1.3532479330897331 - timing_s/adv:0.008371936157345772 - timing_s/update_actor:7.200725978240371 - timing_s/step:55.18845541961491 - timing_s/stop_profile:4.357285797595978e-05 - timing_per_token_ms/update_actor:0.029963448188186314 - timing_per_token_ms/gen:0.4152617903330403 - timing_per_token_ms/ref:0.005631095316143815 - timing_per_token_ms/adv:3.48370533809334e-05 - perf/total_num_tokens:240317 - perf/time_per_step:55.18845541961491 - perf/throughput:544.309942570406
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_170
[36m(TaskRunner pid=2905377)[0m step:170 - global_seqlen/min:25974 - global_seqlen/max:33335 - global_seqlen/minmax_diff:7361 - global_seqlen/balanced_min:29408 - global_seqlen/balanced_max:29718 - global_seqlen/mean:29447.25 - actor/entropy:0.37493929266929626 - actor/kl_loss:0.13549582194536924 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10298661887645721 - actor/pg_clipfrac:0.0007665136945433915 - actor/ppo_kl:0.0013806429829855914 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9474632143974304 - perf/mfu/actor:0.08802451889519469 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.5011215209961 - actor/lr:1e-06 - training/global_step:170 - training/epoch:4 - critic/score/mean:0.949999988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.949999988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.003772875526919961 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.003772875526919961 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:326.1187438964844 - response_length/max:1511.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.897855877876282e-05 - timing_s/generate_sequences:30.28745460510254 - timing_s/reshard:0.6730381846427917 - timing_s/gen:47.385847598314285 - timing_s/reward:0.073806157335639 - timing_s/old_log_prob:1.2361762337386608 - timing_s/ref:1.3676916640251875 - timing_s/adv:0.007528018206357956 - timing_s/update_actor:7.144207369536161 - timing_s/save_checkpoint:7.713949888944626 - timing_s/step:64.94309077039361 - timing_s/stop_profile:4.7033652663230896e-05 - timing_per_token_ms/update_actor:0.030326292648448334 - timing_per_token_ms/gen:0.4540701009823328 - timing_per_token_ms/ref:0.005805685013138695 - timing_per_token_ms/adv:3.195552303847539e-05 - perf/total_num_tokens:235578 - perf/time_per_step:64.94309077039361 - perf/throughput:453.4316068218988
[36m(TaskRunner pid=2905377)[0m step:171 - global_seqlen/min:26357 - global_seqlen/max:33921 - global_seqlen/minmax_diff:7564 - global_seqlen/balanced_min:30723 - global_seqlen/balanced_max:30990 - global_seqlen/mean:30783.75 - actor/entropy:0.3464677929878235 - actor/kl_loss:0.12207215484231711 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14275873824954033 - actor/pg_clipfrac:0.0006306306342594326 - actor/ppo_kl:6.289397715590894e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7592493966221809 - perf/mfu/actor:0.0922315943337082 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.36869430541992 - actor/lr:1e-06 - training/global_step:171 - training/epoch:4 - critic/score/mean:1.0462501049041748 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0462501049041748 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0046812728978693485 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0046812728978693485 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:359.421875 - response_length/max:1632.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.648952305316925e-05 - timing_s/generate_sequences:36.060386657714844 - timing_s/reshard:0.6647843718528748 - timing_s/gen:50.83058232627809 - timing_s/reward:0.07553175836801529 - timing_s/old_log_prob:1.1926482692360878 - timing_s/ref:1.3574236314743757 - timing_s/adv:0.008294884115457535 - timing_s/update_actor:7.1437431667000055 - timing_s/step:60.625642547383904 - timing_s/stop_profile:4.3196603655815125e-05 - timing_per_token_ms/update_actor:0.029007768573922954 - timing_per_token_ms/gen:0.4419474183913237 - timing_per_token_ms/ref:0.005511932559688048 - timing_per_token_ms/adv:3.368207299085368e-05 - perf/total_num_tokens:246270 - perf/time_per_step:60.625642547383904 - perf/throughput:507.76781418753586
[36m(TaskRunner pid=2905377)[0m Training Progress:  33%|███▎      | 172/525 [2:45:56<5:31:58, 56.43s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  33%|███▎      | 173/525 [2:47:09<6:00:12, 61.40s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  33%|███▎      | 174/525 [2:48:09<5:56:06, 60.87s/it]
[36m(TaskRunner pid=2905377)[0m step:172 - global_seqlen/min:26123 - global_seqlen/max:36745 - global_seqlen/minmax_diff:10622 - global_seqlen/balanced_min:29819 - global_seqlen/balanced_max:29820 - global_seqlen/mean:29819.75 - actor/entropy:0.3527229428291321 - actor/kl_loss:0.13069218061864377 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04871486201882362 - actor/pg_clipfrac:0.0011075027054175735 - actor/ppo_kl:8.687305526109413e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0263040214776993 - perf/mfu/actor:0.09022821495326364 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.52051162719727 - actor/lr:1e-06 - training/global_step:172 - training/epoch:4 - critic/score/mean:0.981249988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.981249988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0077719856053590775 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0077719856053590775 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:336.4156188964844 - response_length/max:1191.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010397844016551971 - timing_s/generate_sequences:27.062705993652344 - timing_s/reshard:0.671357274055481 - timing_s/gen:39.0423384886235 - timing_s/reward:0.07430622354149818 - timing_s/old_log_prob:1.1320532951503992 - timing_s/ref:1.3474301490932703 - timing_s/adv:0.008147941902279854 - timing_s/update_actor:7.062918104231358 - timing_s/step:48.68481573462486 - timing_s/stop_profile:4.283711314201355e-05 - timing_per_token_ms/update_actor:0.029606712431489858 - timing_per_token_ms/gen:0.3626683742080899 - timing_per_token_ms/ref:0.005648228728834373 - timing_per_token_ms/adv:3.415497238524742e-05 - perf/total_num_tokens:238558 - perf/time_per_step:48.68481573462486 - perf/throughput:612.5061695322811
[36m(TaskRunner pid=2905377)[0m step:173 - global_seqlen/min:28229 - global_seqlen/max:39607 - global_seqlen/minmax_diff:11378 - global_seqlen/balanced_min:32145 - global_seqlen/balanced_max:32146 - global_seqlen/mean:32145.125 - actor/entropy:0.304447203874588 - actor/kl_loss:0.13227907605469227 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09326882995665073 - actor/pg_clipfrac:0.0027887927484698594 - actor/ppo_kl:0.0015236022467433941 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1067030429840088 - perf/mfu/actor:0.09459813347079364 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.55905532836914 - actor/lr:1e-06 - training/global_step:173 - training/epoch:4 - critic/score/mean:1.0099999904632568 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0099999904632568 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03227022662758827 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.03227022662758827 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:394.65936279296875 - response_length/max:2048.0 - response_length/min:82.0 - response_length/clip_ratio:0.00937500037252903 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.795224130153656e-05 - timing_s/generate_sequences:53.30292892456055 - timing_s/reshard:0.6394209265708923 - timing_s/gen:62.91225700266659 - timing_s/reward:0.07814010977745056 - timing_s/old_log_prob:1.309991728514433 - timing_s/ref:1.3656167909502983 - timing_s/adv:0.008249634876847267 - timing_s/update_actor:7.297651045024395 - timing_s/step:72.98918958380818 - timing_s/stop_profile:4.4636428356170654e-05 - timing_per_token_ms/update_actor:0.028377751855936145 - timing_per_token_ms/gen:0.4981531304896358 - timing_per_token_ms/ref:0.00531035728959795 - timing_per_token_ms/adv:3.207965001243294e-05 - perf/total_num_tokens:257161 - perf/time_per_step:72.98918958380818 - perf/throughput:440.40939738192446
[36m(TaskRunner pid=2905377)[0m step:174 - global_seqlen/min:27946 - global_seqlen/max:33204 - global_seqlen/minmax_diff:5258 - global_seqlen/balanced_min:30520 - global_seqlen/balanced_max:30606 - global_seqlen/mean:30532.0 - actor/entropy:0.3455650508403778 - actor/kl_loss:0.1429939277470112 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.037069110199809074 - actor/pg_clipfrac:0.0016861529904417694 - actor/ppo_kl:0.0006081838670070283 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9937476813793182 - perf/mfu/actor:0.08783192738907669 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.58325958251953 - actor/lr:1e-06 - training/global_step:174 - training/epoch:4 - critic/score/mean:0.996874988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.996874988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.004888155963271856 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.004888155963271856 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:353.34686279296875 - response_length/max:1557.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.725002408027649e-05 - timing_s/generate_sequences:33.99867248535156 - timing_s/reshard:0.6891493797302246 - timing_s/gen:49.56451288796961 - timing_s/reward:0.07507600449025631 - timing_s/old_log_prob:1.160526055842638 - timing_s/ref:1.3652431070804596 - timing_s/adv:0.008278759196400642 - timing_s/update_actor:7.435987425968051 - timing_s/step:59.626798037439585 - timing_s/stop_profile:4.200264811515808e-05 - timing_per_token_ms/update_actor:0.030443417668217163 - timing_per_token_ms/gen:0.43834858529569576 - timing_per_token_ms/ref:0.00558939435297581 - timing_per_token_ms/adv:3.3893780281346794e-05 - perf/total_num_tokens:244256 - perf/time_per_step:59.626798037439585 - perf/throughput:512.0516446452315
[36m(TaskRunner pid=2905377)[0m Training Progress:  33%|███▎      | 175/525 [2:49:23<6:18:37, 64.91s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  34%|███▎      | 176/525 [2:50:16<5:57:25, 61.45s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  34%|███▎      | 177/525 [2:51:03<5:30:31, 56.99s/it]
[36m(TaskRunner pid=2905377)[0m step:175 - global_seqlen/min:26949 - global_seqlen/max:33863 - global_seqlen/minmax_diff:6914 - global_seqlen/balanced_min:31162 - global_seqlen/balanced_max:31655 - global_seqlen/mean:31268.0 - actor/entropy:0.31546491384506226 - actor/kl_loss:0.15189557075500487 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06585212722420693 - actor/pg_clipfrac:0.0029122684092726557 - actor/ppo_kl:0.0028723527779220604 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.973856985569 - perf/mfu/actor:0.09329043475929356 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.5842056274414 - actor/lr:1e-06 - training/global_step:175 - training/epoch:4 - critic/score/mean:0.9959375262260437 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9959375262260437 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.040215350687503815 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.040215350687503815 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:371.96563720703125 - response_length/max:2048.0 - response_length/min:91.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010075792670249939 - timing_s/generate_sequences:39.161590576171875 - timing_s/reshard:0.7251996994018555 - timing_s/gen:64.38351588696241 - timing_s/reward:0.076327383518219 - timing_s/old_log_prob:1.177935291081667 - timing_s/ref:1.3613287881016731 - timing_s/adv:0.008306063711643219 - timing_s/update_actor:7.181033220142126 - timing_s/step:74.20577876083553 - timing_s/stop_profile:4.2147934436798096e-05 - timing_per_token_ms/update_actor:0.0287075973045211 - timing_per_token_ms/gen:0.5409061311693991 - timing_per_token_ms/ref:0.005442180456463769 - timing_per_token_ms/adv:3.320512869244603e-05 - perf/total_num_tokens:250144 - perf/time_per_step:74.20577876083553 - perf/throughput:421.3688006802873
[36m(TaskRunner pid=2905377)[0m step:176 - global_seqlen/min:27311 - global_seqlen/max:36750 - global_seqlen/minmax_diff:9439 - global_seqlen/balanced_min:30776 - global_seqlen/balanced_max:30777 - global_seqlen/mean:30776.5 - actor/entropy:0.30245721340179443 - actor/kl_loss:0.17718779854476452 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09923997521400452 - actor/pg_clipfrac:0.0037339208472985776 - actor/ppo_kl:0.0013088218256598338 - actor/pg_clipfrac_lower:0.00024601594195701183 - actor/grad_norm:1.5619115233421326 - perf/mfu/actor:0.09192966359290387 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.28092956542969 - actor/lr:1e-06 - training/global_step:176 - training/epoch:5 - critic/score/mean:1.1290624141693115 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.1290624141693115 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01410113275051117 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01410113275051117 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:360.4437561035156 - response_length/max:1301.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00033887848258018494 - timing_s/generate_sequences:35.35835647583008 - timing_s/reshard:0.6891353130340576 - timing_s/gen:41.36441035941243 - timing_s/reward:0.07595068402588367 - timing_s/old_log_prob:1.1506247352808714 - timing_s/ref:1.3502769377082586 - timing_s/adv:0.008739450946450233 - timing_s/update_actor:7.1659631207585335 - timing_s/step:51.14439130946994 - timing_s/stop_profile:4.0842220187187195e-05 - timing_per_token_ms/update_actor:0.02910484915746809 - timing_per_token_ms/gen:0.3586240082486209 - timing_per_token_ms/ref:0.005484204416146486 - timing_per_token_ms/adv:3.549563362650981e-05 - perf/total_num_tokens:246212 - perf/time_per_step:51.14439130946994 - perf/throughput:601.7570883535258
[36m(TaskRunner pid=2905377)[0m step:177 - global_seqlen/min:28995 - global_seqlen/max:34224 - global_seqlen/minmax_diff:5229 - global_seqlen/balanced_min:30764 - global_seqlen/balanced_max:30765 - global_seqlen/mean:30764.875 - actor/entropy:0.29928067326545715 - actor/kl_loss:0.15589460525661708 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05136689022183418 - actor/pg_clipfrac:0.0032571961404755712 - actor/ppo_kl:-0.0020689462282462044 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.760285660624504 - perf/mfu/actor:0.09264508357944178 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.35299682617188 - actor/lr:1e-06 - training/global_step:177 - training/epoch:5 - critic/score/mean:1.0606250762939453 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0606250762939453 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0035352143459022045 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0035352143459022045 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:359.49688720703125 - response_length/max:1098.0 - response_length/min:69.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.438473403453827e-05 - timing_s/generate_sequences:29.148056030273438 - timing_s/reshard:0.6717378497123718 - timing_s/gen:36.78810961917043 - timing_s/reward:0.07620282471179962 - timing_s/old_log_prob:1.2009446155279875 - timing_s/ref:1.3746605571359396 - timing_s/adv:0.008087415248155594 - timing_s/update_actor:7.100933704525232 - timing_s/step:46.56675540842116 - timing_s/stop_profile:4.455633461475372e-05 - timing_per_token_ms/update_actor:0.02885162748314934 - timing_per_token_ms/gen:0.31978815548788175 - timing_per_token_ms/ref:0.0055853491893593735 - timing_per_token_ms/adv:3.285977615769442e-05 - perf/total_num_tokens:246119 - perf/time_per_step:46.56675540842116 - perf/throughput:660.6617688986865
[36m(TaskRunner pid=2905377)[0m Training Progress:  34%|███▍      | 178/525 [2:51:44<5:02:13, 52.26s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  34%|███▍      | 179/525 [2:52:53<5:30:51, 57.37s/it]
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 13:54:55,222:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 13:54:58,811:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 13:54:58,813:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/extra_state_world_size_8_rank_6.pt
[36m(TaskRunner pid=2905377)[0m Training Progress:  34%|███▍      | 180/525 [2:54:04<5:51:48, 61.18s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 13:55:00,013:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:178 - global_seqlen/min:28936 - global_seqlen/max:31711 - global_seqlen/minmax_diff:2775 - global_seqlen/balanced_min:29831 - global_seqlen/balanced_max:29832 - global_seqlen/mean:29831.75 - actor/entropy:0.33969569206237793 - actor/kl_loss:0.18293073307722807 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06201733034104109 - actor/pg_clipfrac:0.004917956469580531 - actor/ppo_kl:0.005708234223129693 - actor/pg_clipfrac_lower:8.818341884762049e-05 - actor/grad_norm:2.168602839112282 - perf/mfu/actor:0.09046296233813178 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.37874221801758 - actor/lr:1e-06 - training/global_step:178 - training/epoch:5 - critic/score/mean:1.0165624618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0165624618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.006038336083292961 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.006038336083292961 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:335.73126220703125 - response_length/max:900.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010573677718639374 - timing_s/generate_sequences:25.60500717163086 - timing_s/reshard:0.6548476815223694 - timing_s/gen:31.257126051932573 - timing_s/reward:0.07377210445702076 - timing_s/old_log_prob:1.1463711243122816 - timing_s/ref:1.3725292030721903 - timing_s/adv:0.007980689406394958 - timing_s/update_actor:7.042530110105872 - timing_s/step:40.91819869726896 - timing_s/stop_profile:4.241056740283966e-05 - timing_per_token_ms/update_actor:0.029509373863860953 - timing_per_token_ms/gen:0.29094258849091137 - timing_per_token_ms/ref:0.005751125910616165 - timing_per_token_ms/adv:3.3440417534987716e-05 - perf/total_num_tokens:238654 - perf/time_per_step:40.91819869726896 - perf/throughput:729.0582418035691
[36m(TaskRunner pid=2905377)[0m step:179 - global_seqlen/min:29527 - global_seqlen/max:36726 - global_seqlen/minmax_diff:7199 - global_seqlen/balanced_min:32136 - global_seqlen/balanced_max:32137 - global_seqlen/mean:32136.625 - actor/entropy:0.3124382495880127 - actor/kl_loss:0.14066488146781922 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:3.5717803984880445e-05 - actor/pg_clipfrac:0.0037155316153075547 - actor/ppo_kl:-0.004874089075929078 - actor/pg_clipfrac_lower:0.000139025563839823 - actor/grad_norm:1.5214967280626297 - perf/mfu/actor:0.09602682586565463 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.34248352050781 - actor/lr:1e-06 - training/global_step:179 - training/epoch:5 - critic/score/mean:1.0821874141693115 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0821874141693115 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.002702113473787904 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.002702113473787904 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:393.7906188964844 - response_length/max:1867.0 - response_length/min:79.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.026005864143372e-05 - timing_s/generate_sequences:42.45244598388672 - timing_s/reshard:0.6689457297325134 - timing_s/gen:59.4437515232712 - timing_s/reward:0.07783082686364651 - timing_s/old_log_prob:1.19512103125453 - timing_s/ref:1.376569215208292 - timing_s/adv:0.008039329200983047 - timing_s/update_actor:7.17841543070972 - timing_s/step:69.29674909822643 - timing_s/stop_profile:4.213489592075348e-05 - timing_per_token_ms/update_actor:0.027921473671821948 - timing_per_token_ms/gen:0.47172713548023776 - timing_per_token_ms/ref:0.005354362877279008 - timing_per_token_ms/adv:3.127012093282605e-05 - perf/total_num_tokens:257093 - perf/time_per_step:69.29674909822643 - perf/throughput:463.75371742831874
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180
[36m(TaskRunner pid=2905377)[0m step:180 - global_seqlen/min:27665 - global_seqlen/max:34091 - global_seqlen/minmax_diff:6426 - global_seqlen/balanced_min:31163 - global_seqlen/balanced_max:31175 - global_seqlen/mean:31166.125 - actor/entropy:0.314781129360199 - actor/kl_loss:0.1701689787209034 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04460203498601913 - actor/pg_clipfrac:0.0036209137411788105 - actor/ppo_kl:0.009605428755457978 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.0915684401988983 - perf/mfu/actor:0.0931888252973653 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.36026382446289 - actor/lr:1e-06 - training/global_step:180 - training/epoch:5 - critic/score/mean:1.1062500476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.1062500476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.02722185291349888 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02722185291349888 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:369.85626220703125 - response_length/max:1676.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.526071906089783e-05 - timing_s/generate_sequences:42.95417022705078 - timing_s/reshard:0.64809250831604 - timing_s/gen:52.76559397019446 - timing_s/reward:0.07628687098622322 - timing_s/old_log_prob:1.151479084044695 - timing_s/ref:1.3690672609955072 - timing_s/adv:0.008122099563479424 - timing_s/update_actor:7.162858685478568 - timing_s/save_checkpoint:7.5098787769675255 - timing_s/step:70.06083265691996 - timing_s/stop_profile:5.087628960609436e-05 - timing_per_token_ms/update_actor:0.028728542149042302 - timing_per_token_ms/gen:0.4458285649001678 - timing_per_token_ms/ref:0.005491006906519126 - timing_per_token_ms/adv:3.257583178643248e-05 - perf/total_num_tokens:249329 - perf/time_per_step:70.06083265691996 - perf/throughput:444.8437710213497
[36m(TaskRunner pid=2905377)[0m Training Progress:  34%|███▍      | 181/525 [2:54:57<5:37:56, 58.94s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 13:54:55,591:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:54:59,923:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 13:54:59,925:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_180/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  35%|███▍      | 182/525 [2:55:42<5:13:16, 54.80s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  35%|███▍      | 183/525 [2:56:28<4:57:05, 52.12s/it]
[36m(TaskRunner pid=2905377)[0m step:181 - global_seqlen/min:27271 - global_seqlen/max:34554 - global_seqlen/minmax_diff:7283 - global_seqlen/balanced_min:30339 - global_seqlen/balanced_max:30340 - global_seqlen/mean:30339.625 - actor/entropy:0.32028016448020935 - actor/kl_loss:0.17430912051349878 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.004137209057807923 - actor/pg_clipfrac:0.003510588448261842 - actor/ppo_kl:-0.0035781582624622387 - actor/pg_clipfrac_lower:0.00012594457948580384 - actor/grad_norm:1.4292631149291992 - perf/mfu/actor:0.09037894481125482 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.16461944580078 - actor/lr:1e-06 - training/global_step:181 - training/epoch:5 - critic/score/mean:1.0087499618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0087499618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02198110707104206 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02198110707104206 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:348.7562561035156 - response_length/max:1359.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.00663435459137e-05 - timing_s/generate_sequences:34.1693000793457 - timing_s/reshard:0.6434453129768372 - timing_s/gen:43.91472124494612 - timing_s/reward:0.07512911781668663 - timing_s/old_log_prob:1.13375055603683 - timing_s/ref:1.36909225769341 - timing_s/adv:0.008038943633437157 - timing_s/update_actor:7.179995073005557 - timing_s/step:53.69779031723738 - timing_s/stop_profile:4.081428050994873e-05 - timing_per_token_ms/update_actor:0.029581756008048705 - timing_per_token_ms/gen:0.3934940345598298 - timing_per_token_ms/ref:0.005640693720231422 - timing_per_token_ms/adv:3.312064516880629e-05 - perf/total_num_tokens:242717 - perf/time_per_step:53.69779031723738 - perf/throughput:565.0069550489634
[36m(TaskRunner pid=2905377)[0m step:182 - global_seqlen/min:27101 - global_seqlen/max:33373 - global_seqlen/minmax_diff:6272 - global_seqlen/balanced_min:29586 - global_seqlen/balanced_max:29587 - global_seqlen/mean:29586.25 - actor/entropy:0.3029153347015381 - actor/kl_loss:0.1589074268937111 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10855777114629746 - actor/pg_clipfrac:0.004367067135171964 - actor/ppo_kl:0.0025629025156376885 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3710551261901855 - perf/mfu/actor:0.08954126354842855 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.20159530639648 - actor/lr:1e-06 - training/global_step:182 - training/epoch:5 - critic/score/mean:1.0125000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0125000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.014078259468078613 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.014078259468078613 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:329.59375 - response_length/max:1038.0 - response_length/min:100.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.78162682056427e-05 - timing_s/generate_sequences:27.469661712646484 - timing_s/reshard:0.6664156913757324 - timing_s/gen:35.519090382382274 - timing_s/reward:0.07214180566370487 - timing_s/old_log_prob:1.1068379580974579 - timing_s/ref:1.3436233941465616 - timing_s/adv:0.00796414539217949 - timing_s/update_actor:7.0559798665344715 - timing_s/step:45.119549851864576 - timing_s/stop_profile:4.241429269313812e-05 - timing_per_token_ms/update_actor:0.0298110603174383 - timing_per_token_ms/gen:0.3367696063561418 - timing_per_token_ms/ref:0.005676722270254601 - timing_per_token_ms/adv:3.3648001149940806e-05 - perf/total_num_tokens:236690 - perf/time_per_step:45.119549851864576 - perf/throughput:655.7301679014278
[36m(TaskRunner pid=2905377)[0m step:183 - global_seqlen/min:26044 - global_seqlen/max:33687 - global_seqlen/minmax_diff:7643 - global_seqlen/balanced_min:29984 - global_seqlen/balanced_max:29985 - global_seqlen/mean:29984.125 - actor/entropy:0.30428338050842285 - actor/kl_loss:0.18851451426744462 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1074623443186283 - actor/pg_clipfrac:0.002304234605981037 - actor/ppo_kl:0.0054048578856964015 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.60490483045578 - perf/mfu/actor:0.09087093978298251 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.32832717895508 - actor/lr:1e-06 - training/global_step:183 - training/epoch:5 - critic/score/mean:1.0343749523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0343749523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.00024008622858673334 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00024008622858673334 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:339.4312438964844 - response_length/max:1023.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.732585072517395e-05 - timing_s/generate_sequences:28.845304489135742 - timing_s/reshard:0.7243160009384155 - timing_s/gen:36.22496164403856 - timing_s/reward:0.07295961864292622 - timing_s/old_log_prob:1.140279257670045 - timing_s/ref:1.3489459566771984 - timing_s/adv:0.007596546784043312 - timing_s/update_actor:7.0518178306519985 - timing_s/step:45.86007786914706 - timing_s/stop_profile:4.260428249835968e-05 - timing_per_token_ms/update_actor:0.02939813080526778 - timing_per_token_ms/gen:0.33350790517261003 - timing_per_token_ms/ref:0.00562358396600367 - timing_per_token_ms/adv:3.1669036465310024e-05 - perf/total_num_tokens:239873 - perf/time_per_step:45.86007786914706 - perf/throughput:653.817577143108
[36m(TaskRunner pid=2905377)[0m Training Progress:  35%|███▌      | 184/525 [2:57:27<5:07:46, 54.15s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  35%|███▌      | 185/525 [2:58:22<5:07:37, 54.29s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  35%|███▌      | 186/525 [2:59:13<5:00:45, 53.23s/it]
[36m(TaskRunner pid=2905377)[0m step:184 - global_seqlen/min:27566 - global_seqlen/max:33270 - global_seqlen/minmax_diff:5704 - global_seqlen/balanced_min:30638 - global_seqlen/balanced_max:30931 - global_seqlen/mean:30678.875 - actor/entropy:0.31007081270217896 - actor/kl_loss:0.1650302518159151 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0707190427929163 - actor/pg_clipfrac:0.003563844715245068 - actor/ppo_kl:-0.0008874782564816996 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5565234571695328 - perf/mfu/actor:0.09237877547021375 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.41123580932617 - actor/lr:1e-06 - training/global_step:184 - training/epoch:5 - critic/score/mean:1.0125000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0125000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.013140890747308731 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.013140890747308731 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:357.23748779296875 - response_length/max:1510.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.610822260379791e-05 - timing_s/generate_sequences:32.84299850463867 - timing_s/reshard:0.837204098701477 - timing_s/gen:48.69697270356119 - timing_s/reward:0.07487250678241253 - timing_s/old_log_prob:1.1754548642784357 - timing_s/ref:1.365252397954464 - timing_s/adv:0.00763319805264473 - timing_s/update_actor:7.102947266772389 - timing_s/step:58.43631229177117 - timing_s/stop_profile:3.8955360651016235e-05 - timing_per_token_ms/update_actor:0.02894070947342589 - timing_per_token_ms/gen:0.42598562496554454 - timing_per_token_ms/ref:0.005562673003632238 - timing_per_token_ms/adv:3.110119769973936e-05 - perf/total_num_tokens:245431 - perf/time_per_step:58.43631229177117 - perf/throughput:524.9967665108825
[36m(TaskRunner pid=2905377)[0m step:185 - global_seqlen/min:26877 - global_seqlen/max:33377 - global_seqlen/minmax_diff:6500 - global_seqlen/balanced_min:30259 - global_seqlen/balanced_max:30260 - global_seqlen/mean:30259.625 - actor/entropy:0.3129981756210327 - actor/kl_loss:0.21496538519859315 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14540775096975267 - actor/pg_clipfrac:0.00478156209574081 - actor/ppo_kl:0.0027682423155056314 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3311245888471603 - perf/mfu/actor:0.0910069692020375 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.416015625 - actor/lr:1e-06 - training/global_step:185 - training/epoch:5 - critic/score/mean:0.994687557220459 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.994687557220459 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0006639691418968141 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0006639691418968141 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:346.5375061035156 - response_length/max:1430.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.490068674087524e-05 - timing_s/generate_sequences:33.52511215209961 - timing_s/reshard:0.6475253105163574 - timing_s/gen:44.90513900667429 - timing_s/reward:0.07404740899801254 - timing_s/old_log_prob:1.130671525374055 - timing_s/ref:1.3440951611846685 - timing_s/adv:0.007816649973392487 - timing_s/update_actor:7.111942844465375 - timing_s/step:54.58721060305834 - timing_s/stop_profile:4.2675063014030457e-05 - timing_per_token_ms/update_actor:0.02937884575761173 - timing_per_token_ms/gen:0.40494480221002677 - timing_per_token_ms/ref:0.005552345580888182 - timing_per_token_ms/adv:3.22899324322116e-05 - perf/total_num_tokens:242077 - perf/time_per_step:54.58721060305834 - perf/throughput:554.3354325253736
[36m(TaskRunner pid=2905377)[0m step:186 - global_seqlen/min:26371 - global_seqlen/max:31272 - global_seqlen/minmax_diff:4901 - global_seqlen/balanced_min:29165 - global_seqlen/balanced_max:29397 - global_seqlen/mean:29231.375 - actor/entropy:0.34387949109077454 - actor/kl_loss:0.2137156542390585 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.027257629111409186 - actor/pg_clipfrac:0.00599320613546297 - actor/ppo_kl:-0.0015727582154795527 - actor/pg_clipfrac_lower:7.849293760955333e-05 - actor/grad_norm:1.6276272535324097 - perf/mfu/actor:0.08832261330006906 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.38794326782227 - actor/lr:1e-06 - training/global_step:186 - training/epoch:5 - critic/score/mean:1.0318750143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0318750143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.013067390769720078 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.013067390769720078 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:321.37811279296875 - response_length/max:1317.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.493848145008087e-05 - timing_s/generate_sequences:32.884830474853516 - timing_s/reshard:0.6608214974403381 - timing_s/gen:40.9218113142997 - timing_s/reward:0.07250543497502804 - timing_s/old_log_prob:1.1007475815713406 - timing_s/ref:1.3361184690147638 - timing_s/adv:0.007886074483394623 - timing_s/update_actor:7.064980197697878 - timing_s/step:50.51722209341824 - timing_s/stop_profile:3.994256258010864e-05 - timing_per_token_ms/update_actor:0.030211460278971987 - timing_per_token_ms/gen:0.3979133936299696 - timing_per_token_ms/ref:0.005713546099930143 - timing_per_token_ms/adv:3.3722645972840065e-05 - perf/total_num_tokens:233851 - perf/time_per_step:50.51722209341824 - perf/throughput:578.6417738082332
[36m(TaskRunner pid=2905377)[0m Training Progress:  36%|███▌      | 187/525 [3:00:19<5:22:09, 57.19s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  36%|███▌      | 188/525 [3:01:21<5:29:22, 58.64s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  36%|███▌      | 189/525 [3:02:35<5:53:24, 63.11s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:04:25,844:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 14:04:29,275:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 14:04:29,276:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:04:29,990:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:187 - global_seqlen/min:28590 - global_seqlen/max:36928 - global_seqlen/minmax_diff:8338 - global_seqlen/balanced_min:31307 - global_seqlen/balanced_max:31319 - global_seqlen/mean:31312.875 - actor/entropy:0.3084728419780731 - actor/kl_loss:0.20658649429678916 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1584123119711876 - actor/pg_clipfrac:0.007850783201865852 - actor/ppo_kl:-0.0015963038167683408 - actor/pg_clipfrac_lower:0.0001142652239650488 - actor/grad_norm:3.2287324517965317 - perf/mfu/actor:0.09327947733376432 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.38677215576172 - actor/lr:1e-06 - training/global_step:187 - training/epoch:5 - critic/score/mean:0.871874988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.871874988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.016397010535001755 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.016397010535001755 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:372.8687438964844 - response_length/max:1824.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.333792746067047e-05 - timing_s/generate_sequences:48.01664733886719 - timing_s/reshard:0.7302737832069397 - timing_s/gen:56.465361097827554 - timing_s/reward:0.07556317187845707 - timing_s/old_log_prob:1.297812508419156 - timing_s/ref:1.3576746452599764 - timing_s/adv:0.0078047942370176315 - timing_s/update_actor:7.193038666620851 - timing_s/step:66.41112389974296 - timing_s/stop_profile:4.30326908826828e-05 - timing_per_token_ms/update_actor:0.02871438133124494 - timing_per_token_ms/gen:0.4732342236529908 - timing_per_token_ms/ref:0.005419793955601236 - timing_per_token_ms/adv:3.1156490090009426e-05 - perf/total_num_tokens:250503 - perf/time_per_step:66.41112389974296 - perf/throughput:471.5004529553097
[36m(TaskRunner pid=2905377)[0m step:188 - global_seqlen/min:27132 - global_seqlen/max:34635 - global_seqlen/minmax_diff:7503 - global_seqlen/balanced_min:30551 - global_seqlen/balanced_max:30904 - global_seqlen/mean:30596.125 - actor/entropy:0.3111170828342438 - actor/kl_loss:0.2252165473997593 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05384126529097557 - actor/pg_clipfrac:0.0023957583238370717 - actor/ppo_kl:0.00554014258668758 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.411143496632576 - perf/mfu/actor:0.09187518054466175 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.4986801147461 - actor/lr:1e-06 - training/global_step:188 - training/epoch:5 - critic/score/mean:0.9781249761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9781249761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0002740093623287976 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0002740093623287976 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:355.27813720703125 - response_length/max:1713.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.441267371177673e-05 - timing_s/generate_sequences:35.716522216796875 - timing_s/reshard:0.683015763759613 - timing_s/gen:52.32553306221962 - timing_s/reward:0.07444019615650177 - timing_s/old_log_prob:1.1269488111138344 - timing_s/ref:1.3476615361869335 - timing_s/adv:0.007818657904863358 - timing_s/update_actor:7.125919405370951 - timing_s/step:62.02149757929146 - timing_s/stop_profile:4.038959741592407e-05 - timing_per_token_ms/update_actor:0.02911283457206979 - timing_per_token_ms/gen:0.46025150245159707 - timing_per_token_ms/ref:0.005505850561905035 - timing_per_token_ms/adv:3.194300710001413e-05 - perf/total_num_tokens:244769 - perf/time_per_step:62.02149757929146 - perf/throughput:493.3148375026634
[36m(TaskRunner pid=2905377)[0m step:189 - global_seqlen/min:28786 - global_seqlen/max:38811 - global_seqlen/minmax_diff:10025 - global_seqlen/balanced_min:32026 - global_seqlen/balanced_max:32064 - global_seqlen/mean:32035.25 - actor/entropy:0.299022376537323 - actor/kl_loss:0.1810635831207037 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09850173816084862 - actor/pg_clipfrac:0.0025716355012264103 - actor/ppo_kl:0.004614970147667918 - actor/pg_clipfrac_lower:0.00030895498784957456 - actor/grad_norm:1.9132082760334015 - perf/mfu/actor:0.09461340678687831 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.47794723510742 - actor/lr:1e-06 - training/global_step:189 - training/epoch:5 - critic/score/mean:0.9909375309944153 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9909375309944153 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03845896199345589 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03845896199345589 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:391.0375061035156 - response_length/max:2048.0 - response_length/min:75.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.373467087745667e-05 - timing_s/generate_sequences:46.278236389160156 - timing_s/reshard:0.6640416383743286 - timing_s/gen:63.45514369010925 - timing_s/reward:0.07709416002035141 - timing_s/old_log_prob:1.351134154945612 - timing_s/ref:1.350224805995822 - timing_s/adv:0.007946468889713287 - timing_s/update_actor:7.265023896470666 - timing_s/step:73.51992229744792 - timing_s/stop_profile:4.0801241993904114e-05 - timing_per_token_ms/update_actor:0.028347772752166232 - timing_per_token_ms/gen:0.5071056459587416 - timing_per_token_ms/ref:0.005268512053112673 - timing_per_token_ms/adv:3.1006738240349644e-05 - perf/total_num_tokens:256282 - perf/time_per_step:73.51992229744792 - perf/throughput:435.7356346269157
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190
[36m(TaskRunner pid=2905377)[0m Training Progress:  36%|███▌      | 190/525 [3:03:35<5:47:13, 62.19s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:04:26,057:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  36%|███▋      | 191/525 [3:04:37<5:47:19, 62.39s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:04:31,015:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:04:31,017:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_190/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  37%|███▋      | 192/525 [3:05:35<5:38:13, 60.94s/it]
[36m(TaskRunner pid=2905377)[0m step:190 - global_seqlen/min:26886 - global_seqlen/max:33550 - global_seqlen/minmax_diff:6664 - global_seqlen/balanced_min:29473 - global_seqlen/balanced_max:29525 - global_seqlen/mean:29480.375 - actor/entropy:0.3244674801826477 - actor/kl_loss:0.14099874906241894 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06940859309397637 - actor/pg_clipfrac:0.0062185987073462455 - actor/ppo_kl:-0.008073766331654042 - actor/pg_clipfrac_lower:0.0005001295066904277 - actor/grad_norm:1.846433013677597 - perf/mfu/actor:0.0847725611994163 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55239486694336 - actor/lr:1e-06 - training/global_step:190 - training/epoch:5 - critic/score/mean:1.0946874618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0946874618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.007085898891091347 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.007085898891091347 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:327.9312438964844 - response_length/max:1318.0 - response_length/min:89.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.229670882225037e-05 - timing_s/generate_sequences:32.30699920654297 - timing_s/reshard:0.6977358460426331 - timing_s/gen:42.149048920720816 - timing_s/reward:0.07395021244883537 - timing_s/old_log_prob:1.1256947424262762 - timing_s/ref:1.3454834017902613 - timing_s/adv:0.007918406277894974 - timing_s/update_actor:7.426385965198278 - timing_s/save_checkpoint:7.884970435872674 - timing_s/step:60.027016922831535 - timing_s/stop_profile:4.6875327825546265e-05 - timing_per_token_ms/update_actor:0.03148868512187463 - timing_per_token_ms/gen:0.4016566822382818 - timing_per_token_ms/ref:0.005704996127891272 - timing_per_token_ms/adv:3.357490482183051e-05 - perf/total_num_tokens:235843 - perf/time_per_step:60.027016922831535 - perf/throughput:491.11844151607363
[36m(TaskRunner pid=2905377)[0m step:191 - global_seqlen/min:25258 - global_seqlen/max:33256 - global_seqlen/minmax_diff:7998 - global_seqlen/balanced_min:30167 - global_seqlen/balanced_max:30550 - global_seqlen/mean:30215.625 - actor/entropy:0.2905600368976593 - actor/kl_loss:0.18268726505339145 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.011880100518465043 - actor/pg_clipfrac:0.0036712850793264805 - actor/ppo_kl:0.006868289507110603 - actor/pg_clipfrac_lower:2.6680895825847983e-05 - actor/grad_norm:1.4043980240821838 - perf/mfu/actor:0.09106902048508385 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46219253540039 - actor/lr:1e-06 - training/global_step:191 - training/epoch:5 - critic/score/mean:1.126562476158142 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.126562476158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.010904180817306042 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.010904180817306042 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:345.875 - response_length/max:1739.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.589533925056458e-05 - timing_s/generate_sequences:35.7149772644043 - timing_s/reshard:0.7836766242980957 - timing_s/gen:53.087133252993226 - timing_s/reward:0.07374627515673637 - timing_s/old_log_prob:1.228410106152296 - timing_s/ref:1.3544471245259047 - timing_s/adv:0.007872449234127998 - timing_s/update_actor:7.093829123303294 - timing_s/step:62.85955194197595 - timing_s/stop_profile:4.462338984012604e-05 - timing_per_token_ms/update_actor:0.029346691998358855 - timing_per_token_ms/gen:0.47964522274117477 - timing_per_token_ms/ref:0.00560325628100488 - timing_per_token_ms/adv:3.2567790812402516e-05 - perf/total_num_tokens:241725 - perf/time_per_step:62.85955194197595 - perf/throughput:480.6847021100512
[36m(TaskRunner pid=2905377)[0m step:192 - global_seqlen/min:26852 - global_seqlen/max:30757 - global_seqlen/minmax_diff:3905 - global_seqlen/balanced_min:28744 - global_seqlen/balanced_max:29260 - global_seqlen/mean:28809.125 - actor/entropy:0.3425357937812805 - actor/kl_loss:0.17466967087239027 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.086279271915555 - actor/pg_clipfrac:0.004971947253216058 - actor/ppo_kl:-0.0028310461406363175 - actor/pg_clipfrac_lower:6.55308016575873e-05 - actor/grad_norm:1.9180302321910858 - perf/mfu/actor:0.08711205771391334 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5073471069336 - actor/lr:1e-06 - training/global_step:192 - training/epoch:5 - critic/score/mean:1.017187476158142 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.017187476158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.013569631613790989 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.013569631613790989 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:310.4937438964844 - response_length/max:1568.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.528493344783783e-05 - timing_s/generate_sequences:31.34821319580078 - timing_s/reshard:0.681747317314148 - timing_s/gen:47.53169294632971 - timing_s/reward:0.07173564285039902 - timing_s/old_log_prob:1.1021113879978657 - timing_s/ref:1.3410551026463509 - timing_s/adv:0.007819831371307373 - timing_s/update_actor:7.056703247129917 - timing_s/step:57.12539619393647 - timing_s/stop_profile:4.222802817821503e-05 - timing_per_token_ms/update_actor:0.030618351161003317 - timing_per_token_ms/gen:0.4783881815890991 - timing_per_token_ms/ref:0.0058187080597135055 - timing_per_token_ms/adv:3.3929490097787474e-05 - perf/total_num_tokens:230473 - perf/time_per_step:57.12539619393647 - perf/throughput:504.3137889529057
[36m(TaskRunner pid=2905377)[0m Training Progress:  37%|███▋      | 193/525 [3:06:28<5:24:16, 58.60s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  37%|███▋      | 194/525 [3:07:39<5:43:59, 62.36s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  37%|███▋      | 195/525 [3:08:47<5:52:16, 64.05s/it]
[36m(TaskRunner pid=2905377)[0m step:193 - global_seqlen/min:26354 - global_seqlen/max:31156 - global_seqlen/minmax_diff:4802 - global_seqlen/balanced_min:29217 - global_seqlen/balanced_max:29384 - global_seqlen/mean:29255.125 - actor/entropy:0.32954755425453186 - actor/kl_loss:0.23905505388975143 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14993295818567276 - actor/pg_clipfrac:0.0029480279597919436 - actor/ppo_kl:0.008922505070950137 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5084247589111328 - perf/mfu/actor:0.08603011668356506 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.605712890625 - actor/lr:1e-06 - training/global_step:193 - training/epoch:5 - critic/score/mean:1.0750000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0750000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.013221905566751957 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.013221905566751957 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:321.97186279296875 - response_length/max:1332.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.615424692630768e-05 - timing_s/generate_sequences:32.21723556518555 - timing_s/reshard:0.6779754757881165 - timing_s/gen:43.26722334511578 - timing_s/reward:0.0723213367164135 - timing_s/old_log_prob:1.162941686809063 - timing_s/ref:1.3480362202972174 - timing_s/adv:0.007718633860349655 - timing_s/update_actor:7.259927490726113 - timing_s/step:53.131832929328084 - timing_s/stop_profile:4.063546657562256e-05 - timing_per_token_ms/update_actor:0.031019896046958068 - timing_per_token_ms/gen:0.4199437387302441 - timing_per_token_ms/ref:0.005759829347410143 - timing_per_token_ms/adv:3.2979836269498315e-05 - perf/total_num_tokens:234041 - perf/time_per_step:53.131832929328084 - perf/throughput:550.6138860090323
[36m(TaskRunner pid=2905377)[0m step:194 - global_seqlen/min:27160 - global_seqlen/max:34763 - global_seqlen/minmax_diff:7603 - global_seqlen/balanced_min:30098 - global_seqlen/balanced_max:30407 - global_seqlen/mean:30138.0 - actor/entropy:0.32731395959854126 - actor/kl_loss:0.19817389771342278 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11136501394212246 - actor/pg_clipfrac:0.0028594360221177338 - actor/ppo_kl:-0.004829355888068676 - actor/pg_clipfrac_lower:0.00020790020935237407 - actor/grad_norm:1.426544040441513 - perf/mfu/actor:0.09049169398783533 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.6284065246582 - actor/lr:1e-06 - training/global_step:194 - training/epoch:5 - critic/score/mean:0.987500011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.987500011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0028897058218717575 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0028897058218717575 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:344.15313720703125 - response_length/max:1912.0 - response_length/min:93.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.419901132583618e-05 - timing_s/generate_sequences:40.39699935913086 - timing_s/reshard:0.830416202545166 - timing_s/gen:61.140648828819394 - timing_s/reward:0.07424586452543736 - timing_s/old_log_prob:1.1553242094814777 - timing_s/ref:1.3430024310946465 - timing_s/adv:0.007535615935921669 - timing_s/update_actor:7.12519621104002 - timing_s/step:70.85958024300635 - timing_s/stop_profile:4.3351203203201294e-05 - timing_per_token_ms/update_actor:0.029552376613577628 - timing_per_token_ms/gen:0.5551730137277138 - timing_per_token_ms/ref:0.005570220448829743 - timing_per_token_ms/adv:3.125462844217296e-05 - perf/total_num_tokens:241104 - perf/time_per_step:70.85958024300635 - perf/throughput:425.3200470090922
[36m(TaskRunner pid=2905377)[0m step:195 - global_seqlen/min:26680 - global_seqlen/max:30028 - global_seqlen/minmax_diff:3348 - global_seqlen/balanced_min:28440 - global_seqlen/balanced_max:29257 - global_seqlen/mean:28558.375 - actor/entropy:0.33166125416755676 - actor/kl_loss:0.182987168058753 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02435460239648819 - actor/pg_clipfrac:0.0018779668258503079 - actor/ppo_kl:0.004272800675244071 - actor/pg_clipfrac_lower:6.527415243908762e-05 - actor/grad_norm:1.5349583625793457 - perf/mfu/actor:0.08689459323335127 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5994644165039 - actor/lr:1e-06 - training/global_step:195 - training/epoch:5 - critic/score/mean:1.0759375095367432 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0759375095367432 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.014131288975477219 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.014131288975477219 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:304.5531311035156 - response_length/max:1979.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.870607078075409e-05 - timing_s/generate_sequences:33.8658332824707 - timing_s/reshard:0.6564170718193054 - timing_s/gen:58.45637286640704 - timing_s/reward:0.07049649581313133 - timing_s/old_log_prob:1.0987120289355516 - timing_s/ref:1.3350024297833443 - timing_s/adv:0.007711397483944893 - timing_s/update_actor:7.013332296162844 - timing_s/step:67.99522628448904 - timing_s/stop_profile:4.1814520955085754e-05 - timing_per_token_ms/update_actor:0.030697353649160902 - timing_per_token_ms/gen:0.5998170769304108 - timing_per_token_ms/ref:0.005843305290406686 - timing_per_token_ms/adv:3.3752784795812495e-05 - perf/total_num_tokens:228467 - perf/time_per_step:67.99522628448904 - perf/throughput:420.00558804691696
[36m(TaskRunner pid=2905377)[0m Training Progress:  37%|███▋      | 196/525 [3:10:00<6:04:56, 66.55s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  38%|███▊      | 197/525 [3:10:48<5:33:50, 61.07s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  38%|███▊      | 198/525 [3:11:38<5:15:02, 57.81s/it]
[36m(TaskRunner pid=2905377)[0m step:196 - global_seqlen/min:27721 - global_seqlen/max:37137 - global_seqlen/minmax_diff:9416 - global_seqlen/balanced_min:30487 - global_seqlen/balanced_max:31110 - global_seqlen/mean:30565.625 - actor/entropy:0.2941846251487732 - actor/kl_loss:0.1584120680578053 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02286839596927166 - actor/pg_clipfrac:0.0018134540179744363 - actor/ppo_kl:-0.000240866549893326 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4191020280122757 - perf/mfu/actor:0.09173360024657899 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55872344970703 - actor/lr:1e-06 - training/global_step:196 - training/epoch:5 - critic/score/mean:1.0293749570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0293749570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.015792502090334892 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.015792502090334892 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:354.1875 - response_length/max:2048.0 - response_length/min:57.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.106790482997894e-05 - timing_s/generate_sequences:38.44232177734375 - timing_s/reshard:0.6769543290138245 - timing_s/gen:62.63867856375873 - timing_s/reward:0.07421995140612125 - timing_s/old_log_prob:1.1778140310198069 - timing_s/ref:1.339381292462349 - timing_s/adv:0.007890941575169563 - timing_s/update_actor:7.128484670072794 - timing_s/step:72.3801150508225 - timing_s/stop_profile:4.016607999801636e-05 - timing_per_token_ms/update_actor:0.02915237570830301 - timing_per_token_ms/gen:0.5526617131088648 - timing_per_token_ms/ref:0.005477482026223695 - timing_per_token_ms/adv:3.227049003238754e-05 - perf/total_num_tokens:244525 - perf/time_per_step:72.3801150508225 - perf/throughput:422.293125377571
[36m(TaskRunner pid=2905377)[0m step:197 - global_seqlen/min:27731 - global_seqlen/max:30932 - global_seqlen/minmax_diff:3201 - global_seqlen/balanced_min:29542 - global_seqlen/balanced_max:29571 - global_seqlen/mean:29552.0 - actor/entropy:0.31474974751472473 - actor/kl_loss:0.207990051433444 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09494510516524315 - actor/pg_clipfrac:0.007376122497953474 - actor/ppo_kl:0.009519422799348832 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9390364289283752 - perf/mfu/actor:0.08986922259912618 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53422164916992 - actor/lr:1e-06 - training/global_step:197 - training/epoch:5 - critic/score/mean:1.0437500476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0437500476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.02230502851307392 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.02230502851307392 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:330.04998779296875 - response_length/max:1142.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.22445547580719e-05 - timing_s/generate_sequences:30.62628936767578 - timing_s/reshard:0.6511837840080261 - timing_s/gen:38.51347825676203 - timing_s/reward:0.07297883741557598 - timing_s/old_log_prob:1.2856498323380947 - timing_s/ref:1.3421685677021742 - timing_s/adv:0.007723379880189896 - timing_s/update_actor:7.023295436054468 - timing_s/step:48.25873497873545 - timing_s/stop_profile:3.911368548870087e-05 - timing_per_token_ms/update_actor:0.029707360906429635 - timing_per_token_ms/gen:0.3646557174742655 - timing_per_token_ms/ref:0.005677147772156598 - timing_per_token_ms/adv:3.266860060313133e-05 - perf/total_num_tokens:236416 - perf/time_per_step:48.25873497873545 - perf/throughput:612.3658237834392
[36m(TaskRunner pid=2905377)[0m step:198 - global_seqlen/min:25197 - global_seqlen/max:33014 - global_seqlen/minmax_diff:7817 - global_seqlen/balanced_min:28138 - global_seqlen/balanced_max:28404 - global_seqlen/mean:28237.625 - actor/entropy:0.276048481464386 - actor/kl_loss:0.2579113133251667 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07841034345328808 - actor/pg_clipfrac:0.006480445282068104 - actor/ppo_kl:-0.007901797571685165 - actor/pg_clipfrac_lower:0.00045645339414477346 - actor/grad_norm:1.599022924900055 - perf/mfu/actor:0.08670658993347492 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46561050415039 - actor/lr:1e-06 - training/global_step:198 - training/epoch:5 - critic/score/mean:1.1124999523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.1124999523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0010031744604930282 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0010031744604930282 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:296.42498779296875 - response_length/max:1197.0 - response_length/min:99.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.605180144309998e-05 - timing_s/generate_sequences:25.348316192626953 - timing_s/reshard:0.6602800488471985 - timing_s/gen:40.69301265478134 - timing_s/reward:0.07009163871407509 - timing_s/old_log_prob:1.1168473716825247 - timing_s/ref:1.3365662451833487 - timing_s/adv:0.007917845621705055 - timing_s/update_actor:6.945575997233391 - timing_s/step:50.183818604797125 - timing_s/stop_profile:4.31649386882782e-05 - timing_per_token_ms/update_actor:0.030746105582681753 - timing_per_token_ms/gen:0.4289977719362122 - timing_per_token_ms/ref:0.005916601720148865 - timing_per_token_ms/adv:3.505006893154548e-05 - perf/total_num_tokens:225901 - perf/time_per_step:50.183818604797125 - perf/throughput:562.6838647408297
[36m(TaskRunner pid=2905377)[0m Training Progress:  38%|███▊      | 199/525 [3:12:20<4:48:14, 53.05s/it]
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:14:49,423:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:14:52,871:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:14:52,873:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:14:53,573:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:199 - global_seqlen/min:27514 - global_seqlen/max:30597 - global_seqlen/minmax_diff:3083 - global_seqlen/balanced_min:28912 - global_seqlen/balanced_max:28913 - global_seqlen/mean:28912.125 - actor/entropy:0.33364179730415344 - actor/kl_loss:0.24226999767124652 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.046527957916259764 - actor/pg_clipfrac:0.009653874841751531 - actor/ppo_kl:0.009107872482854874 - actor/pg_clipfrac_lower:0.00010482179932296276 - actor/grad_norm:1.4537421613931656 - perf/mfu/actor:0.08841074100572414 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.48186492919922 - actor/lr:1e-06 - training/global_step:199 - training/epoch:5 - critic/score/mean:1.046875 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.046875 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.014018874615430832 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.014018874615430832 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:312.7406311035156 - response_length/max:958.0 - response_length/min:85.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.43325799703598e-05 - timing_s/generate_sequences:27.137435913085938 - timing_s/reshard:0.6531566977500916 - timing_s/gen:32.43319595977664 - timing_s/reward:0.07206087745726109 - timing_s/old_log_prob:1.0901846308261156 - timing_s/ref:1.3459736499935389 - timing_s/adv:0.007917957380414009 - timing_s/update_actor:6.977504974231124 - timing_s/step:41.94061813689768 - timing_s/stop_profile:4.341825842857361e-05 - timing_per_token_ms/update_actor:0.030166863272031733 - timing_per_token_ms/gen:0.3240824161373406 - timing_per_token_ms/ref:0.005819243872568771 - timing_per_token_ms/adv:3.423285810198147e-05 - perf/total_num_tokens:231297 - perf/time_per_step:41.94061813689768 - perf/throughput:689.3585808780501
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 200}
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <think>
[36m(TaskRunner pid=2905377)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and its foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the distance from the center to each focus. The equation of the parabola is \(y^2 = 16x\), and its focus is at \((4, 0)\) and its directrix is the line \(x = -4\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Since the hyperbola and the parabola intersect at points \(A\) and \(B\), and the distance \(|AB| = 4\sqrt{3}\), we can use the properties of the hyperbola and the parabola to find the value of \(a\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m For the hyperbola, the distance from any point \((x, y)\) on the hyperbola to the focus \((c, 0)\) is given by \(e(x + c)\), where \(e\) is the eccentricity. For an equilateral hyperbola, \(e = \sqrt{2}\). So, the distance from a point \((x, y)\) on the hyperbola to the focus \((4, 0)\) is \(\sqrt{2}(x + 4)\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m For the parabola, the distance from any point \((x, y)\) on the parabola to the focus \((4, 0)\) is \(x + 4\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Since the points of intersection are equidistant from the focus and the directrix, we can set up the following equation for the distance from a point on the hyperbola to the focus equal to the distance from the same point to the directrix:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{2}(x + 4) = x + 4
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m Solving for \(x\), we get:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \sqrt{2}x + 4\sqrt{2} = x + 4
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m (\sqrt{2} - 1)x = 4 - 4\sqrt{2}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m x = \frac{4(1 - \sqrt{2})}{\sqrt{2} - 1}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m Rationalizing the denominator, we get:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m x = \frac{4(1 - \sqrt{2})(\sqrt{2} + 1)}{(\sqrt{2} - 1)(\sqrt{2} + 1)} = \frac{4(\sqrt{2} + 1 - 2 - \sqrt{2})}{2 - 1} = \frac{4(-1)}{1} = -4
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m So, the \(x\)-coordinate of the points of intersection is \(-4\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Now, substituting \(x = -4\) into the equation of the hyperbola, we get:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \frac{(-4)^2}{a^2} - \frac{y^2}{a^2} = 1
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \frac{16}{a^2} - \frac{y^2}{a^2} = 1
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m \frac{16 - y^2}{a^2} = 1
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m 16 - y^2 = a^2
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m y^2 = 16 - a^2
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m The distance \(|AB|\) is the distance between the points \((-4, y)\) and \((-4, -y)\), which is \(2|y| = 4\sqrt{3}\). So, we have:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m 2|y| = 4\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m |y| = 2\sqrt{3}
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m Substituting \(|y| = 2\sqrt{3}\) into the equation \(y^2 = 16 - a^2\), we get:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m (2\sqrt{3})^2 = 16 - a^2
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m 12 = 16 - a^2
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m a^2 = 4
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m a = 2
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m Therefore, the length of the real axis of the hyperbola is \(2a = 4\).
[36m(TaskRunner pid=2905377)[0m </think>
[36m(TaskRunner pid=2905377)[0m <answer>The answer is \boxed{C}.</answer>
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 1.6
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200
[36m(TaskRunner pid=2905377)[0m Training Progress:  38%|███▊      | 200/525 [3:13:58<6:00:27, 66.55s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:14:49,675:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  38%|███▊      | 201/525 [3:14:42<5:22:27, 59.72s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:14:54,557:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:14:54,559:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_200/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:200 - global_seqlen/min:25267 - global_seqlen/max:33086 - global_seqlen/minmax_diff:7819 - global_seqlen/balanced_min:29664 - global_seqlen/balanced_max:29680 - global_seqlen/mean:29667.125 - actor/entropy:0.2696759104728699 - actor/kl_loss:0.20842617750167847 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05236726328730583 - actor/pg_clipfrac:0.0046221100608818235 - actor/ppo_kl:-0.0019303789238620083 - actor/pg_clipfrac_lower:0.00020104220020584763 - actor/grad_norm:2.269411951303482 - perf/mfu/actor:0.09025040137016696 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.54262161254883 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.9440000236034394 - val-aux/grpo_convert/reward/std@50:0.41673218874300544 - val-aux/grpo_convert/reward/best@2/mean:1.119500023841858 - val-aux/grpo_convert/reward/best@2/std:0.3895109059755314 - val-aux/grpo_convert/reward/worst@2/mean:0.7739000234007836 - val-aux/grpo_convert/reward/worst@2/std:0.3285160482181242 - val-aux/grpo_convert/reward/best@4/mean:1.2740000238418578 - val-aux/grpo_convert/reward/best@4/std:0.319863529568251 - val-aux/grpo_convert/reward/worst@4/mean:0.6306000229716301 - val-aux/grpo_convert/reward/worst@4/std:0.23239267242185935 - val-aux/grpo_convert/reward/best@8/mean:1.4095000238418578 - val-aux/grpo_convert/reward/best@8/std:0.24281628858048215 - val-aux/grpo_convert/reward/worst@8/mean:0.5639000222086906 - val-aux/grpo_convert/reward/worst@8/std:0.15290358090980455 - val-aux/grpo_convert/reward/best@16/mean:1.5265000238418578 - val-aux/grpo_convert/reward/best@16/std:0.17705295817918437 - val-aux/grpo_convert/reward/worst@16/mean:0.5205000206828118 - val-aux/grpo_convert/reward/worst@16/std:0.13239996749674596 - val-aux/grpo_convert/reward/best@32/mean:1.592000023841858 - val-aux/grpo_convert/reward/best@32/std:0.0627375485654325 - val-aux/grpo_convert/reward/worst@32/mean:0.460200018286705 - val-aux/grpo_convert/reward/worst@32/std:0.1496528041162979 - val-core/grpo_convert/reward/best@50/mean:1.599500023841858 - val-core/grpo_convert/reward/best@50/std:0.01580348062927911 - val-aux/grpo_convert/reward/worst@50/mean:0.409500016272068 - val-aux/grpo_convert/reward/worst@50/std:0.14442905406386905 - training/global_step:200 - training/epoch:5 - critic/score/mean:1.0774999856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0774999856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.00903499685227871 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00903499685227871 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:332.4906311035156 - response_length/max:1264.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.727237582206726e-05 - timing_s/generate_sequences:31.164474487304688 - timing_s/reshard:0.7568055391311646 - timing_s/gen:40.791443130001426 - timing_s/reward:0.07246620766818523 - timing_s/old_log_prob:1.1447193901985884 - timing_s/ref:1.342634566128254 - timing_s/adv:0.0075481608510017395 - timing_s/update_actor:7.022655365988612 - timing_s/testing:39.418938882648945 - timing_s/save_checkpoint:7.792712489143014 - timing_s/step:97.6066109854728 - timing_s/stop_profile:5.175545811653137e-05 - timing_per_token_ms/update_actor:0.029589382885890577 - timing_per_token_ms/gen:0.38338903474723374 - timing_per_token_ms/ref:0.005657080716989993 - timing_per_token_ms/adv:3.180355718241041e-05 - perf/total_num_tokens:237337 - perf/time_per_step:97.6066109854728 - perf/throughput:303.94585674545635
[36m(TaskRunner pid=2905377)[0m step:201 - global_seqlen/min:26140 - global_seqlen/max:29620 - global_seqlen/minmax_diff:3480 - global_seqlen/balanced_min:28017 - global_seqlen/balanced_max:28018 - global_seqlen/mean:28017.75 - actor/entropy:0.34350064396858215 - actor/kl_loss:0.27609161250293257 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09335371777415276 - actor/pg_clipfrac:0.0035524672362953424 - actor/ppo_kl:-0.002582554822583916 - actor/pg_clipfrac_lower:0.0002150621556211263 - actor/grad_norm:1.971661776304245 - perf/mfu/actor:0.08591927025784729 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.51205062866211 - actor/lr:1e-06 - training/global_step:201 - training/epoch:5 - critic/score/mean:1.0578124523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0578124523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.0075288377702236176 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.0075288377702236176 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:291.9125061035156 - response_length/max:1008.0 - response_length/min:49.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.53125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.398612797260284e-05 - timing_s/generate_sequences:25.63507843017578 - timing_s/reshard:0.6178438067436218 - timing_s/gen:34.207881543785334 - timing_s/reward:0.07027747482061386 - timing_s/old_log_prob:1.1705837193876505 - timing_s/ref:1.336779048666358 - timing_s/adv:0.007674308493733406 - timing_s/update_actor:6.950178358703852 - timing_s/step:43.76180020906031 - timing_s/stop_profile:4.09148633480072e-05 - timing_per_token_ms/update_actor:0.031007925148806792 - timing_per_token_ms/gen:0.36620435858118155 - timing_per_token_ms/ref:0.005963982870976247 - timing_per_token_ms/adv:3.423860094820875e-05 - perf/total_num_tokens:224142 - perf/time_per_step:43.76180020906031 - perf/throughput:640.2330312316377
[36m(TaskRunner pid=2905377)[0m Training Progress:  38%|███▊      | 202/525 [3:15:49<5:33:40, 61.98s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  39%|███▊      | 203/525 [3:16:31<5:00:49, 56.05s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  39%|███▉      | 204/525 [3:17:24<4:54:26, 55.04s/it]
[36m(TaskRunner pid=2905377)[0m step:202 - global_seqlen/min:27412 - global_seqlen/max:32687 - global_seqlen/minmax_diff:5275 - global_seqlen/balanced_min:29341 - global_seqlen/balanced_max:29969 - global_seqlen/mean:29419.625 - actor/entropy:0.2703772783279419 - actor/kl_loss:0.24759919419884682 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0803182803094387 - actor/pg_clipfrac:0.003924349951557815 - actor/ppo_kl:0.006702746867085807 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.65171879529953 - perf/mfu/actor:0.08950636597366982 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.52013778686523 - actor/lr:1e-06 - training/global_step:202 - training/epoch:5 - critic/score/mean:0.9731249809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9731249809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.020766938105225563 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.020766938105225563 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:325.8656311035156 - response_length/max:1864.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.68719071149826e-05 - timing_s/generate_sequences:36.55368423461914 - timing_s/reshard:0.6516684889793396 - timing_s/gen:57.451563742011786 - timing_s/reward:0.07212301902472973 - timing_s/old_log_prob:1.1444635149091482 - timing_s/ref:1.3410661928355694 - timing_s/adv:0.007476823404431343 - timing_s/update_actor:7.021496327593923 - timing_s/step:67.05181451514363 - timing_s/stop_profile:4.174187779426575e-05 - timing_per_token_ms/update_actor:0.029833386419753492 - timing_per_token_ms/gen:0.5509514441536656 - timing_per_token_ms/ref:0.00569800852677239 - timing_per_token_ms/adv:3.17680094683028e-05 - perf/total_num_tokens:235357 - perf/time_per_step:67.05181451514363 - perf/throughput:438.7595654604632
[36m(TaskRunner pid=2905377)[0m step:203 - global_seqlen/min:25498 - global_seqlen/max:32637 - global_seqlen/minmax_diff:7139 - global_seqlen/balanced_min:27542 - global_seqlen/balanced_max:27542 - global_seqlen/mean:27542.0 - actor/entropy:0.33244332671165466 - actor/kl_loss:0.21522526778280734 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.007556467689573765 - actor/pg_clipfrac:0.0029374590143561364 - actor/ppo_kl:-0.0014385518545168452 - actor/pg_clipfrac_lower:0.00011676096473820508 - actor/grad_norm:2.518665313720703 - perf/mfu/actor:0.08466265535107889 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.54636001586914 - actor/lr:1e-06 - training/global_step:203 - training/epoch:5 - critic/score/mean:1.056249976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.056249976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0019579604268074036 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0019579604268074036 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:278.59686279296875 - response_length/max:984.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.205270230770111e-05 - timing_s/generate_sequences:26.246997833251953 - timing_s/reshard:0.6511856317520142 - timing_s/gen:32.776052847504616 - timing_s/reward:0.0683637335896492 - timing_s/old_log_prob:1.081090658903122 - timing_s/ref:1.3304280955344439 - timing_s/adv:0.007588798180222511 - timing_s/update_actor:6.930895406752825 - timing_s/step:42.20792840607464 - timing_s/stop_profile:3.850087523460388e-05 - timing_per_token_ms/update_actor:0.03145602809687398 - timing_per_token_ms/gen:0.36764649692661455 - timing_per_token_ms/ref:0.006038178488918942 - timing_per_token_ms/adv:3.444193495489848e-05 - perf/total_num_tokens:220336 - perf/time_per_step:42.20792840607464 - perf/throughput:652.5314328394309
[36m(TaskRunner pid=2905377)[0m step:204 - global_seqlen/min:26626 - global_seqlen/max:31331 - global_seqlen/minmax_diff:4705 - global_seqlen/balanced_min:29431 - global_seqlen/balanced_max:29432 - global_seqlen/mean:29431.625 - actor/entropy:0.30362460017204285 - actor/kl_loss:0.25526802577078345 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07631515264511109 - actor/pg_clipfrac:0.007737215346423909 - actor/ppo_kl:0.01056338384441915 - actor/pg_clipfrac_lower:0.00029551927000284197 - actor/grad_norm:1.7786359786987305 - perf/mfu/actor:0.08900724100650867 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.57631301879883 - actor/lr:1e-06 - training/global_step:204 - training/epoch:5 - critic/score/mean:1.0750000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0750000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.000849955715239048 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.000849955715239048 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:326.9312438964844 - response_length/max:1339.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.452443242073059e-05 - timing_s/generate_sequences:33.487274169921875 - timing_s/reshard:0.6562341451644897 - timing_s/gen:42.959190391004086 - timing_s/reward:0.07320023700594902 - timing_s/old_log_prob:1.1866808142513037 - timing_s/ref:1.3433479014784098 - timing_s/adv:0.0075994934886693954 - timing_s/update_actor:7.065024647861719 - timing_s/step:52.648511974141 - timing_s/stop_profile:4.3528154492378235e-05 - timing_per_token_ms/update_actor:0.030006093139020182 - timing_per_token_ms/gen:0.41062905418765494 - timing_per_token_ms/ref:0.005705376026121603 - timing_per_token_ms/adv:3.2276052922109275e-05 - perf/total_num_tokens:235453 - perf/time_per_step:52.648511974141 - perf/throughput:559.0210225591129
[36m(TaskRunner pid=2905377)[0m Training Progress:  39%|███▉      | 205/525 [3:18:36<5:20:35, 60.11s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  39%|███▉      | 206/525 [3:19:27<5:05:50, 57.53s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  39%|███▉      | 207/525 [3:20:08<4:37:10, 52.30s/it]
[36m(TaskRunner pid=2905377)[0m step:205 - global_seqlen/min:27277 - global_seqlen/max:33715 - global_seqlen/minmax_diff:6438 - global_seqlen/balanced_min:30209 - global_seqlen/balanced_max:30427 - global_seqlen/mean:30321.125 - actor/entropy:0.26881223917007446 - actor/kl_loss:0.23016879074275493 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0544735150411725 - actor/pg_clipfrac:0.0037559198099188507 - actor/ppo_kl:-0.005371108091276255 - actor/pg_clipfrac_lower:0.00013585968990810217 - actor/grad_norm:2.703820049762726 - perf/mfu/actor:0.09097018351983142 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5759162902832 - actor/lr:1e-06 - training/global_step:205 - training/epoch:5 - critic/score/mean:1.021875023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.021875023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.008910397067666054 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008910397067666054 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:348.84063720703125 - response_length/max:1941.0 - response_length/min:78.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.348321378231049e-05 - timing_s/generate_sequences:39.178470611572266 - timing_s/reshard:0.651056706905365 - timing_s/gen:62.215221147984266 - timing_s/reward:0.07440433651208878 - timing_s/old_log_prob:1.1462255325168371 - timing_s/ref:1.3473880514502525 - timing_s/adv:0.007784781977534294 - timing_s/update_actor:7.13512465544045 - timing_s/step:71.93955034576356 - timing_s/stop_profile:4.260428249835968e-05 - timing_per_token_ms/update_actor:0.02941482487638754 - timing_per_token_ms/gen:0.5573392321707107 - timing_per_token_ms/ref:0.005554658886544664 - timing_per_token_ms/adv:3.209306208762989e-05 - perf/total_num_tokens:242569 - perf/time_per_step:71.93955034576356 - perf/throughput:421.48060217595696
[36m(TaskRunner pid=2905377)[0m step:206 - global_seqlen/min:27782 - global_seqlen/max:30336 - global_seqlen/minmax_diff:2554 - global_seqlen/balanced_min:29035 - global_seqlen/balanced_max:29139 - global_seqlen/mean:29062.125 - actor/entropy:0.291581392288208 - actor/kl_loss:0.25693117585033176 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06343193650245667 - actor/pg_clipfrac:0.006813245837111026 - actor/ppo_kl:0.014928448526188732 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.6604145467281342 - perf/mfu/actor:0.08834003984218454 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53669738769531 - actor/lr:1e-06 - training/global_step:206 - training/epoch:5 - critic/score/mean:0.996874988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.996874988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0007100901566445827 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0007100901566445827 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:316.9281311035156 - response_length/max:1297.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.122941315174103e-05 - timing_s/generate_sequences:30.971023559570312 - timing_s/reshard:0.6573925018310547 - timing_s/gen:41.86337692476809 - timing_s/reward:0.07148542068898678 - timing_s/old_log_prob:1.1638312991708517 - timing_s/ref:1.3395923227071762 - timing_s/adv:0.007907256484031677 - timing_s/update_actor:7.019626980647445 - timing_s/step:51.479114985093474 - timing_s/stop_profile:3.984570503234863e-05 - timing_per_token_ms/update_actor:0.03019233358128253 - timing_per_token_ms/gen:0.4127846113054822 - timing_per_token_ms/ref:0.0057617617548061965 - timing_per_token_ms/adv:3.401014414823278e-05 - perf/total_num_tokens:232497 - perf/time_per_step:51.479114985093474 - perf/throughput:564.5420479434302
[36m(TaskRunner pid=2905377)[0m step:207 - global_seqlen/min:26172 - global_seqlen/max:28793 - global_seqlen/minmax_diff:2621 - global_seqlen/balanced_min:27954 - global_seqlen/balanced_max:27955 - global_seqlen/mean:27954.125 - actor/entropy:0.31440824270248413 - actor/kl_loss:0.3543821912258863 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21951640471816064 - actor/pg_clipfrac:0.009581066248938442 - actor/ppo_kl:-0.012840862513985484 - actor/pg_clipfrac_lower:0.0011280183622147887 - actor/grad_norm:3.034874975681305 - perf/mfu/actor:0.08534372684105539 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.47811126708984 - actor/lr:1e-06 - training/global_step:207 - training/epoch:5 - critic/score/mean:1.0212500095367432 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0212500095367432 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0063482364639639854 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0063482364639639854 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:289.2281188964844 - response_length/max:877.0 - response_length/min:90.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.69682228565216e-05 - timing_s/generate_sequences:25.323959350585938 - timing_s/reshard:0.6530607342720032 - timing_s/gen:30.564728446304798 - timing_s/reward:0.0692595224827528 - timing_s/old_log_prob:1.110115909948945 - timing_s/ref:1.3467644210904837 - timing_s/adv:0.0076202936470508575 - timing_s/update_actor:6.978489425033331 - timing_s/step:40.091652831062675 - timing_s/stop_profile:4.458986222743988e-05 - timing_per_token_ms/update_actor:0.031205096855264344 - timing_per_token_ms/gen:0.3302402779629488 - timing_per_token_ms/ref:0.006022207908003218 - timing_per_token_ms/adv:3.40749962977327e-05 - perf/total_num_tokens:223633 - perf/time_per_step:40.091652831062675 - perf/throughput:697.2554890114528
[36m(TaskRunner pid=2905377)[0m Training Progress:  40%|███▉      | 208/525 [3:20:54<4:26:20, 50.41s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  40%|███▉      | 209/525 [3:21:54<4:40:58, 53.35s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:23:46,107:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 14:23:49,603:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 14:23:49,604:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:23:50,386:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  40%|████      | 210/525 [3:22:55<4:51:57, 55.61s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:23:46,276:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:208 - global_seqlen/min:27242 - global_seqlen/max:33660 - global_seqlen/minmax_diff:6418 - global_seqlen/balanced_min:29595 - global_seqlen/balanced_max:29595 - global_seqlen/mean:29595.0 - actor/entropy:0.27620819211006165 - actor/kl_loss:0.30538510978221894 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06715029384940863 - actor/pg_clipfrac:0.0025236346409656107 - actor/ppo_kl:0.013520743878325447 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.7141563594341278 - perf/mfu/actor:0.09039910844254345 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.5410270690918 - actor/lr:1e-06 - training/global_step:208 - training/epoch:5 - critic/score/mean:0.9703124761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9703124761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.013670210726559162 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.013670210726559162 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:330.03125 - response_length/max:1068.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.14925879240036e-05 - timing_s/generate_sequences:27.659042358398438 - timing_s/reshard:0.6426674127578735 - timing_s/gen:36.30115324817598 - timing_s/reward:0.0726621001958847 - timing_s/old_log_prob:1.0974275767803192 - timing_s/ref:1.3400100246071815 - timing_s/adv:0.007912842556834221 - timing_s/update_actor:6.9894403498619795 - timing_s/step:45.82196346856654 - timing_s/stop_profile:4.104524850845337e-05 - timing_per_token_ms/update_actor:0.02952120438360356 - timing_per_token_ms/gen:0.34372837087563657 - timing_per_token_ms/ref:0.0056597821617130496 - timing_per_token_ms/adv:3.342136575787388e-05 - perf/total_num_tokens:236760 - perf/time_per_step:45.82196346856654 - perf/throughput:645.8693115650077
[36m(TaskRunner pid=2905377)[0m step:209 - global_seqlen/min:25690 - global_seqlen/max:35746 - global_seqlen/minmax_diff:10056 - global_seqlen/balanced_min:29419 - global_seqlen/balanced_max:29541 - global_seqlen/mean:29449.5 - actor/entropy:0.2657841444015503 - actor/kl_loss:0.2513872042298317 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06100866887718439 - actor/pg_clipfrac:0.014849666168447583 - actor/ppo_kl:-0.025440031033940613 - actor/pg_clipfrac_lower:0.0034819549473468214 - actor/grad_norm:2.7810469269752502 - perf/mfu/actor:0.0897042741269018 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.47472763061523 - actor/lr:1e-06 - training/global_step:209 - training/epoch:5 - critic/score/mean:1.037500023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.037500023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.01689877361059189 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01689877361059189 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:326.94061279296875 - response_length/max:1629.0 - response_length/min:89.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.3188915848732e-05 - timing_s/generate_sequences:38.422115325927734 - timing_s/reshard:0.6490435004234314 - timing_s/gen:50.59182883426547 - timing_s/reward:0.07231488078832626 - timing_s/old_log_prob:1.1460163369774818 - timing_s/ref:1.3374959006905556 - timing_s/adv:0.00762188620865345 - timing_s/update_actor:7.018054882064462 - timing_s/step:60.186633395031095 - timing_s/stop_profile:4.2572617530822754e-05 - timing_per_token_ms/update_actor:0.02978851458456197 - timing_per_token_ms/gen:0.4835724073968464 - timing_per_token_ms/ref:0.005677073892131256 - timing_per_token_ms/adv:3.2351509400216686e-05 - perf/total_num_tokens:235596 - perf/time_per_step:60.186633395031095 - perf/throughput:489.3029953463272
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210
[36m(TaskRunner pid=2905377)[0m step:210 - global_seqlen/min:27135 - global_seqlen/max:33023 - global_seqlen/minmax_diff:5888 - global_seqlen/balanced_min:29375 - global_seqlen/balanced_max:29534 - global_seqlen/mean:29395.25 - actor/entropy:0.30315542221069336 - actor/kl_loss:0.3106667634099722 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2594927608966827 - actor/pg_clipfrac:0.014951492345426231 - actor/ppo_kl:0.026523340423591436 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.663086175918579 - perf/mfu/actor:0.08965997364184383 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.51450729370117 - actor/lr:1e-06 - training/global_step:210 - training/epoch:5 - critic/score/mean:1.0309374332427979 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0309374332427979 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0296635739505291 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0296635739505291 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:325.0375061035156 - response_length/max:1319.0 - response_length/min:86.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.274242281913757e-05 - timing_s/generate_sequences:29.751256942749023 - timing_s/reshard:0.6325868368148804 - timing_s/gen:43.411163149401546 - timing_s/reward:0.07206596434116364 - timing_s/old_log_prob:1.2512861173599958 - timing_s/ref:1.3412017654627562 - timing_s/adv:0.007791036739945412 - timing_s/update_actor:7.000165278092027 - timing_s/save_checkpoint:7.7012637704610825 - timing_s/step:60.79860560595989 - timing_s/stop_profile:4.902668297290802e-05 - timing_per_token_ms/update_actor:0.029767416836444776 - timing_per_token_ms/gen:0.4173668725666418 - timing_per_token_ms/ref:0.005703309911732151 - timing_per_token_ms/adv:3.3130508925529685e-05 - perf/total_num_tokens:235162 - perf/time_per_step:60.79860560595989 - perf/throughput:483.4855948919736
[36m(TaskRunner pid=2905377)[0m Training Progress:  40%|████      | 211/525 [3:23:49<4:48:28, 55.12s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:23:51,144:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:23:51,146:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_210/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  40%|████      | 212/525 [3:24:55<5:05:26, 58.55s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  41%|████      | 213/525 [3:25:44<4:49:42, 55.71s/it]
[36m(TaskRunner pid=2905377)[0m step:211 - global_seqlen/min:24601 - global_seqlen/max:30464 - global_seqlen/minmax_diff:5863 - global_seqlen/balanced_min:28285 - global_seqlen/balanced_max:28420 - global_seqlen/mean:28302.625 - actor/entropy:0.31591901183128357 - actor/kl_loss:0.16827254593372346 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.16152439638972282 - actor/pg_clipfrac:0.006438284635078162 - actor/ppo_kl:-0.007084462543207337 - actor/pg_clipfrac_lower:0.00010655862570274621 - actor/grad_norm:2.5751951932907104 - perf/mfu/actor:0.08619642660465189 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.3427505493164 - actor/lr:1e-06 - training/global_step:211 - training/epoch:6 - critic/score/mean:1.0387500524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0387500524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.016426339745521545 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.016426339745521545 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:298.59686279296875 - response_length/max:1304.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00032967887818813324 - timing_s/generate_sequences:28.655208587646484 - timing_s/reshard:0.7107090353965759 - timing_s/gen:42.14700877480209 - timing_s/reward:0.07102894969284534 - timing_s/old_log_prob:1.141909060999751 - timing_s/ref:1.3363171331584454 - timing_s/adv:0.008946038782596588 - timing_s/update_actor:7.00161350145936 - timing_s/step:51.73255396075547 - timing_s/stop_profile:4.0629878640174866e-05 - timing_per_token_ms/update_actor:0.030922986390217164 - timing_per_token_ms/gen:0.44109437656123 - timing_per_token_ms/ref:0.0059019133965420405 - timing_per_token_ms/adv:3.951064072058947e-05 - perf/total_num_tokens:226421 - perf/time_per_step:51.73255396075547 - perf/throughput:547.0950655455845
[36m(TaskRunner pid=2905377)[0m step:212 - global_seqlen/min:25977 - global_seqlen/max:33635 - global_seqlen/minmax_diff:7658 - global_seqlen/balanced_min:28379 - global_seqlen/balanced_max:29054 - global_seqlen/mean:28610.625 - actor/entropy:0.31756165623664856 - actor/kl_loss:0.24649363867938517 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10120543166995048 - actor/pg_clipfrac:0.003940103435888886 - actor/ppo_kl:0.013888602613587864 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5337442457675934 - perf/mfu/actor:0.08624066577618601 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.41743469238281 - actor/lr:1e-06 - training/global_step:212 - training/epoch:6 - critic/score/mean:1.020937442779541 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.020937442779541 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.011428404599428177 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.011428404599428177 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:305.53125 - response_length/max:1881.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.136352360248566e-05 - timing_s/generate_sequences:31.7001953125 - timing_s/reshard:0.6394630670547485 - timing_s/gen:56.91366019286215 - timing_s/reward:0.07156120426952839 - timing_s/old_log_prob:1.1052720453590155 - timing_s/ref:1.3468284327536821 - timing_s/adv:0.007375223562121391 - timing_s/update_actor:7.081359263509512 - timing_s/step:66.53958525322378 - timing_s/stop_profile:3.889948129653931e-05 - timing_per_token_ms/update_actor:0.03093850301902489 - timing_per_token_ms/gen:0.5821178295270754 - timing_per_token_ms/ref:0.005884301866674016 - timing_per_token_ms/adv:3.222239798204946e-05 - perf/total_num_tokens:228885 - perf/time_per_step:66.53958525322378 - perf/throughput:429.9790101053244
[36m(TaskRunner pid=2905377)[0m step:213 - global_seqlen/min:26159 - global_seqlen/max:32502 - global_seqlen/minmax_diff:6343 - global_seqlen/balanced_min:29547 - global_seqlen/balanced_max:29548 - global_seqlen/mean:29547.5 - actor/entropy:0.2913314402103424 - actor/kl_loss:0.22740513198077678 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0789050929248333 - actor/pg_clipfrac:0.0032996589376125484 - actor/ppo_kl:0.002167103524971026 - actor/pg_clipfrac_lower:0.0001612903201021254 - actor/grad_norm:1.8685874044895172 - perf/mfu/actor:0.08929145883329864 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.42521286010742 - actor/lr:1e-06 - training/global_step:213 - training/epoch:6 - critic/score/mean:1.0168750286102295 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0168750286102295 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.019194159656763077 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.019194159656763077 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:328.953125 - response_length/max:1251.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.046014070510864e-05 - timing_s/generate_sequences:34.2309455871582 - timing_s/reshard:0.733197033405304 - timing_s/gen:39.44575179554522 - timing_s/reward:0.07371634431183338 - timing_s/old_log_prob:1.1310238428413868 - timing_s/ref:1.3417747616767883 - timing_s/adv:0.007546350359916687 - timing_s/update_actor:7.067403219640255 - timing_s/step:49.08083995617926 - timing_s/stop_profile:4.5262277126312256e-05 - timing_per_token_ms/update_actor:0.029898482188172665 - timing_per_token_ms/gen:0.3747280843162041 - timing_per_token_ms/ref:0.005676346398497285 - timing_per_token_ms/adv:3.1924656738796376e-05 - perf/total_num_tokens:236380 - perf/time_per_step:49.08083995617926 - perf/throughput:602.016999431567
[36m(TaskRunner pid=2905377)[0m Training Progress:  41%|████      | 214/525 [3:26:38<4:45:46, 55.13s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  41%|████      | 215/525 [3:27:20<4:23:46, 51.05s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  41%|████      | 216/525 [3:28:06<4:14:59, 49.51s/it]
[36m(TaskRunner pid=2905377)[0m step:214 - global_seqlen/min:25431 - global_seqlen/max:30429 - global_seqlen/minmax_diff:4998 - global_seqlen/balanced_min:28545 - global_seqlen/balanced_max:28681 - global_seqlen/mean:28563.75 - actor/entropy:0.31429189443588257 - actor/kl_loss:0.25446758680045606 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1014148823916912 - actor/pg_clipfrac:0.008995282789692282 - actor/ppo_kl:0.010105474450392648 - actor/pg_clipfrac_lower:0.000388688943348825 - actor/grad_norm:2.8494778871536255 - perf/mfu/actor:0.08684988009312401 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.40995025634766 - actor/lr:1e-06 - training/global_step:214 - training/epoch:6 - critic/score/mean:1.0209375619888306 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0209375619888306 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.002933155745267868 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.002933155745267868 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:304.359375 - response_length/max:1388.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.000938057899475e-05 - timing_s/generate_sequences:29.339515686035156 - timing_s/reshard:0.6773565411567688 - timing_s/gen:44.18601053394377 - timing_s/reward:0.07067097909748554 - timing_s/old_log_prob:1.1219805721193552 - timing_s/ref:1.3547146432101727 - timing_s/adv:0.007621871307492256 - timing_s/update_actor:7.016517911106348 - timing_s/step:53.77109116688371 - timing_s/stop_profile:3.951042890548706e-05 - timing_per_token_ms/update_actor:0.030705517969044454 - timing_per_token_ms/gen:0.4536784283992379 - timing_per_token_ms/ref:0.00592846984031409 - timing_per_token_ms/adv:3.335465103274367e-05 - perf/total_num_tokens:228510 - perf/time_per_step:53.77109116688371 - perf/throughput:531.2101610761381
[36m(TaskRunner pid=2905377)[0m step:215 - global_seqlen/min:25211 - global_seqlen/max:31379 - global_seqlen/minmax_diff:6168 - global_seqlen/balanced_min:27963 - global_seqlen/balanced_max:27964 - global_seqlen/mean:27963.625 - actor/entropy:0.3193168044090271 - actor/kl_loss:0.28458021841943265 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09598637800663709 - actor/pg_clipfrac:0.008224415278527885 - actor/ppo_kl:-0.003499741680570878 - actor/pg_clipfrac_lower:0.00010080644860863686 - actor/grad_norm:2.2547419369220734 - perf/mfu/actor:0.0854502708570874 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53555297851562 - actor/lr:1e-06 - training/global_step:215 - training/epoch:6 - critic/score/mean:1.0268750190734863 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0268750190734863 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0019451724365353584 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0019451724365353584 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:289.02813720703125 - response_length/max:948.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.79423862695694e-05 - timing_s/generate_sequences:24.574996948242188 - timing_s/reshard:0.7105792760848999 - timing_s/gen:31.815611366182566 - timing_s/reward:0.06970315799117088 - timing_s/old_log_prob:1.2127046510577202 - timing_s/ref:1.3404614981263876 - timing_s/adv:0.007845830172300339 - timing_s/update_actor:6.973686408251524 - timing_s/step:41.43364894203842 - timing_s/stop_profile:4.3502077460289e-05 - timing_per_token_ms/update_actor:0.03117302570862828 - timing_per_token_ms/gen:0.3439934626407742 - timing_per_token_ms/ref:0.005991987350202216 - timing_per_token_ms/adv:3.507158930709242e-05 - perf/total_num_tokens:223709 - perf/time_per_step:41.43364894203842 - perf/throughput:674.9013353643641
[36m(TaskRunner pid=2905377)[0m step:216 - global_seqlen/min:25292 - global_seqlen/max:29674 - global_seqlen/minmax_diff:4382 - global_seqlen/balanced_min:26858 - global_seqlen/balanced_max:27000 - global_seqlen/mean:26876.625 - actor/entropy:0.3296562135219574 - actor/kl_loss:0.3411431260406971 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2124990526586771 - actor/pg_clipfrac:0.011866397329140455 - actor/ppo_kl:0.02105219374752778 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.9540411829948425 - perf/mfu/actor:0.07984149363968387 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.51303482055664 - actor/lr:1e-06 - training/global_step:216 - training/epoch:6 - critic/score/mean:1.0581250190734863 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0581250190734863 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0063798497430980206 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0063798497430980206 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:262.9468688964844 - response_length/max:1116.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.974861025810242e-05 - timing_s/generate_sequences:24.258638381958008 - timing_s/reshard:0.6580312252044678 - timing_s/gen:36.22123132459819 - timing_s/reward:0.06760666891932487 - timing_s/old_log_prob:1.0647251103073359 - timing_s/ref:1.3645075745880604 - timing_s/adv:0.007646769285202026 - timing_s/update_actor:7.16314453817904 - timing_s/step:45.90225584618747 - timing_s/stop_profile:4.131346940994263e-05 - timing_per_token_ms/update_actor:0.033314936948831184 - timing_per_token_ms/gen:0.4304723069607477 - timing_per_token_ms/ref:0.00634616313705711 - timing_per_token_ms/adv:3.556421837378217e-05 - perf/total_num_tokens:215013 - perf/time_per_step:45.90225584618747 - perf/throughput:585.5186091520229
[36m(TaskRunner pid=2905377)[0m Training Progress:  41%|████▏     | 217/525 [3:28:44<3:56:31, 46.08s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  42%|████▏     | 218/525 [3:29:22<3:43:23, 43.66s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  42%|████▏     | 219/525 [3:30:03<3:38:36, 42.86s/it]
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:31:48,839:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:31:52,273:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:31:52,274:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:31:53,211:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:217 - global_seqlen/min:24825 - global_seqlen/max:29450 - global_seqlen/minmax_diff:4625 - global_seqlen/balanced_min:26800 - global_seqlen/balanced_max:26800 - global_seqlen/mean:26800.0 - actor/entropy:0.32924750447273254 - actor/kl_loss:0.1948194529861212 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0414381418377161 - actor/pg_clipfrac:0.004032337770331651 - actor/ppo_kl:-0.010326709307264537 - actor/pg_clipfrac_lower:0.0004217906389385462 - actor/grad_norm:1.9614379405975342 - perf/mfu/actor:0.08240140290652262 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49499893188477 - actor/lr:1e-06 - training/global_step:217 - training/epoch:6 - critic/score/mean:0.9818750619888306 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9818750619888306 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.00862173456698656 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00862173456698656 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:260.15625 - response_length/max:856.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.056685328483582e-05 - timing_s/generate_sequences:23.357084274291992 - timing_s/reshard:0.6500409245491028 - timing_s/gen:28.507657807320356 - timing_s/reward:0.06694059073925018 - timing_s/old_log_prob:1.1095574628561735 - timing_s/ref:1.3316786792129278 - timing_s/adv:0.007573200389742851 - timing_s/update_actor:6.9221110343933105 - timing_s/step:37.958979427814484 - timing_s/stop_profile:4.21721488237381e-05 - timing_per_token_ms/update_actor:0.03228596564549119 - timing_per_token_ms/gen:0.34243432801586016 - timing_per_token_ms/ref:0.006211187869463283 - timing_per_token_ms/adv:3.532276301186032e-05 - perf/total_num_tokens:214400 - perf/time_per_step:37.958979427814484 - perf/throughput:706.0253042620601
[36m(TaskRunner pid=2905377)[0m step:218 - global_seqlen/min:25182 - global_seqlen/max:28551 - global_seqlen/minmax_diff:3369 - global_seqlen/balanced_min:26989 - global_seqlen/balanced_max:26990 - global_seqlen/mean:26989.875 - actor/entropy:0.3401923179626465 - actor/kl_loss:0.35293464213609693 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0923160620033741 - actor/pg_clipfrac:0.009804949525278061 - actor/ppo_kl:0.018022699613356962 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.226673424243927 - perf/mfu/actor:0.0809004413532772 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.4869270324707 - actor/lr:1e-06 - training/global_step:218 - training/epoch:6 - critic/score/mean:0.9437500238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9437500238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.004923291504383087 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.004923291504383087 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:264.35626220703125 - response_length/max:821.0 - response_length/min:81.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.28406012058258e-05 - timing_s/generate_sequences:23.371936798095703 - timing_s/reshard:0.8181897401809692 - timing_s/gen:28.425563959404826 - timing_s/reward:0.06769119203090668 - timing_s/old_log_prob:1.0604994054883718 - timing_s/ref:1.3322541359812021 - timing_s/adv:0.007619313895702362 - timing_s/update_actor:7.1005546040833 - timing_s/step:38.007918467745185 - timing_s/stop_profile:4.215165972709656e-05 - timing_per_token_ms/update_actor:0.03288526995810142 - timing_per_token_ms/gen:0.33602340543543074 - timing_per_token_ms/ref:0.006170157031021828 - timing_per_token_ms/adv:3.528783430685749e-05 - perf/total_num_tokens:215919 - perf/time_per_step:38.007918467745185 - perf/throughput:710.1118947859386
[36m(TaskRunner pid=2905377)[0m step:219 - global_seqlen/min:25456 - global_seqlen/max:31683 - global_seqlen/minmax_diff:6227 - global_seqlen/balanced_min:28183 - global_seqlen/balanced_max:28184 - global_seqlen/mean:28183.75 - actor/entropy:0.3432246446609497 - actor/kl_loss:0.23486213572323322 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02319842204451561 - actor/pg_clipfrac:0.005005972553044557 - actor/ppo_kl:0.015229759868816473 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.468185842037201 - perf/mfu/actor:0.08314497684423419 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.4824104309082 - actor/lr:1e-06 - training/global_step:219 - training/epoch:6 - critic/score/mean:1.006250023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.006250023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.009458167478442192 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.009458167478442192 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:295.296875 - response_length/max:921.0 - response_length/min:86.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.1697478890419e-05 - timing_s/generate_sequences:22.726558685302734 - timing_s/reshard:0.6884990334510803 - timing_s/gen:30.75937696173787 - timing_s/reward:0.07056994922459126 - timing_s/old_log_prob:1.0774401314556599 - timing_s/ref:1.3388010151684284 - timing_s/adv:0.007512165233492851 - timing_s/update_actor:7.224932469427586 - timing_s/step:40.492054019123316 - timing_s/stop_profile:3.9361417293548584e-05 - timing_per_token_ms/update_actor:0.03204387488103777 - timing_per_token_ms/gen:0.3255132754297886 - timing_per_token_ms/ref:0.005937823281006025 - timing_per_token_ms/adv:3.331780384748681e-05 - perf/total_num_tokens:225470 - perf/time_per_step:40.492054019123316 - perf/throughput:696.0316210852027
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220
[36m(TaskRunner pid=2905377)[0m Training Progress:  42%|████▏     | 220/525 [3:30:58<3:56:18, 46.49s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:31:49,255:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  42%|████▏     | 221/525 [3:32:06<4:29:12, 53.13s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:31:54,022:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:31:54,024:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_220/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  42%|████▏     | 222/525 [3:32:51<4:15:07, 50.52s/it]
[36m(TaskRunner pid=2905377)[0m step:220 - global_seqlen/min:26782 - global_seqlen/max:31124 - global_seqlen/minmax_diff:4342 - global_seqlen/balanced_min:28112 - global_seqlen/balanced_max:28210 - global_seqlen/mean:28149.0 - actor/entropy:0.3476376533508301 - actor/kl_loss:0.235671142116189 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0279257133603096 - actor/pg_clipfrac:0.004713131871540099 - actor/ppo_kl:-0.0017887025349409668 - actor/pg_clipfrac_lower:0.0006195948459208012 - actor/grad_norm:2.38457328081131 - perf/mfu/actor:0.08537849283186467 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53371810913086 - actor/lr:1e-06 - training/global_step:220 - training/epoch:6 - critic/score/mean:1.0343749523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0343749523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.012694930657744408 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.012694930657744408 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:293.0062561035156 - response_length/max:1126.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.71875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.333792746067047e-05 - timing_s/generate_sequences:28.53364372253418 - timing_s/reshard:0.7341536283493042 - timing_s/gen:37.51833580061793 - timing_s/reward:0.07210162468254566 - timing_s/old_log_prob:1.076755614951253 - timing_s/ref:1.3338296096771955 - timing_s/adv:0.0074422769248485565 - timing_s/update_actor:7.026612035930157 - timing_s/save_checkpoint:7.880059769377112 - timing_s/step:54.92828462459147 - timing_s/stop_profile:4.862062633037567e-05 - timing_per_token_ms/update_actor:0.031202760470754543 - timing_per_token_ms/gen:0.4001443633947434 - timing_per_token_ms/ref:0.005923077239321093 - timing_per_token_ms/adv:3.304858487356814e-05 - perf/total_num_tokens:225192 - perf/time_per_step:54.92828462459147 - perf/throughput:512.468215462852
[36m(TaskRunner pid=2905377)[0m step:221 - global_seqlen/min:25845 - global_seqlen/max:32764 - global_seqlen/minmax_diff:6919 - global_seqlen/balanced_min:27689 - global_seqlen/balanced_max:28374 - global_seqlen/mean:27775.5 - actor/entropy:0.3159424662590027 - actor/kl_loss:0.3075561014935374 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09428439438343048 - actor/pg_clipfrac:0.006134803278837353 - actor/ppo_kl:0.002552006376936333 - actor/pg_clipfrac_lower:0.00021626672823913396 - actor/grad_norm:2.8216906785964966 - perf/mfu/actor:0.08304709259273954 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.46255874633789 - actor/lr:1e-06 - training/global_step:221 - training/epoch:6 - critic/score/mean:1.087499976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.087499976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.006970932241529226 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.006970932241529226 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:285.52813720703125 - response_length/max:1990.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.831251084804535e-05 - timing_s/generate_sequences:37.56765365600586 - timing_s/reshard:0.7070491909980774 - timing_s/gen:58.963615810498595 - timing_s/reward:0.06937302649021149 - timing_s/old_log_prob:1.108593937009573 - timing_s/ref:1.335774401202798 - timing_s/adv:0.0075868722051382065 - timing_s/update_actor:7.13193534873426 - timing_s/step:68.63025286048651 - timing_s/stop_profile:4.217028617858887e-05 - timing_per_token_ms/update_actor:0.03209634096926365 - timing_per_token_ms/gen:0.6453350240289222 - timing_per_token_ms/ref:0.006011477746587811 - timing_per_token_ms/adv:3.414372470854803e-05 - perf/total_num_tokens:222204 - perf/time_per_step:68.63025286048651 - perf/throughput:404.7121909409661
[36m(TaskRunner pid=2905377)[0m step:222 - global_seqlen/min:26921 - global_seqlen/max:31762 - global_seqlen/minmax_diff:4841 - global_seqlen/balanced_min:29024 - global_seqlen/balanced_max:29024 - global_seqlen/mean:29024.0 - actor/entropy:0.2717689573764801 - actor/kl_loss:0.35667764097452165 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11356652155518532 - actor/pg_clipfrac:0.007670660596340894 - actor/ppo_kl:0.0048570264218142254 - actor/pg_clipfrac_lower:0.0005157972453162074 - actor/grad_norm:2.6189911365509033 - perf/mfu/actor:0.08723757629768257 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49509811401367 - actor/lr:1e-06 - training/global_step:222 - training/epoch:6 - critic/score/mean:1.046875 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.046875 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0031857998110353947 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0031857998110353947 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:315.9750061035156 - response_length/max:1061.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.047876715660095e-05 - timing_s/generate_sequences:29.152172088623047 - timing_s/reshard:0.6624722480773926 - timing_s/gen:34.69847586750984 - timing_s/reward:0.07069677859544754 - timing_s/old_log_prob:1.185841539874673 - timing_s/ref:1.333886144682765 - timing_s/adv:0.007459692656993866 - timing_s/update_actor:7.100818436592817 - timing_s/step:44.41065106168389 - timing_s/stop_profile:4.137493669986725e-05 - timing_per_token_ms/update_actor:0.03058166705395887 - timing_per_token_ms/gen:0.34316872248110847 - timing_per_token_ms/ref:0.005744754964351765 - timing_per_token_ms/adv:3.212725958256041e-05 - perf/total_num_tokens:232192 - perf/time_per_step:44.41065106168389 - perf/throughput:653.5369175220444
[36m(TaskRunner pid=2905377)[0m Training Progress:  42%|████▏     | 223/525 [3:33:54<4:34:12, 54.48s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  43%|████▎     | 224/525 [3:34:58<4:47:02, 57.22s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  43%|████▎     | 225/525 [3:35:36<4:16:46, 51.36s/it]
[36m(TaskRunner pid=2905377)[0m step:223 - global_seqlen/min:25922 - global_seqlen/max:35585 - global_seqlen/minmax_diff:9663 - global_seqlen/balanced_min:29331 - global_seqlen/balanced_max:29332 - global_seqlen/mean:29331.375 - actor/entropy:0.27312377095222473 - actor/kl_loss:0.32367279306054114 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16485350728034973 - actor/pg_clipfrac:0.008529742003884167 - actor/ppo_kl:-0.0057497101050103085 - actor/pg_clipfrac_lower:0.00213898565270938 - actor/grad_norm:4.0063117146492 - perf/mfu/actor:0.08821962790239911 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53322982788086 - actor/lr:1e-06 - training/global_step:223 - training/epoch:6 - critic/score/mean:1.0031249523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0031249523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.016935965046286583 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.016935965046286583 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:323.33123779296875 - response_length/max:1642.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.829815149307251e-05 - timing_s/generate_sequences:29.504756927490234 - timing_s/reshard:0.6789413690567017 - timing_s/gen:53.94809144921601 - timing_s/reward:0.07194402813911438 - timing_s/old_log_prob:1.1331053208559752 - timing_s/ref:1.340112928301096 - timing_s/adv:0.0076515767723321915 - timing_s/update_actor:7.105713902041316 - timing_s/step:63.62023057974875 - timing_s/stop_profile:4.160776734352112e-05 - timing_per_token_ms/update_actor:0.03028205250368128 - timing_per_token_ms/gen:0.5214088826205324 - timing_per_token_ms/ref:0.005711089781424737 - timing_per_token_ms/adv:3.2608327994903885e-05 - perf/total_num_tokens:234651 - perf/time_per_step:63.62023057974875 - perf/throughput:461.03848937222506
[36m(TaskRunner pid=2905377)[0m step:224 - global_seqlen/min:23884 - global_seqlen/max:31249 - global_seqlen/minmax_diff:7365 - global_seqlen/balanced_min:26458 - global_seqlen/balanced_max:27279 - global_seqlen/mean:26797.25 - actor/entropy:0.3286192715167999 - actor/kl_loss:0.4758382223546505 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.016734706610441206 - actor/pg_clipfrac:0.017914254567585886 - actor/ppo_kl:0.08540642628213391 - actor/pg_clipfrac_lower:7.042253273539245e-05 - actor/grad_norm:3.5985748171806335 - perf/mfu/actor:0.08246206483655394 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.59040832519531 - actor/lr:1e-06 - training/global_step:224 - training/epoch:6 - critic/score/mean:1.037500023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.037500023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0014925659634172916 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0014925659634172916 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:260.5249938964844 - response_length/max:1741.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.223151624202728e-05 - timing_s/generate_sequences:27.693031311035156 - timing_s/reshard:0.6769363284111023 - timing_s/gen:54.162918573245406 - timing_s/reward:0.06759022176265717 - timing_s/old_log_prob:1.0840441454201937 - timing_s/ref:1.3392137419432402 - timing_s/adv:0.007559405639767647 - timing_s/update_actor:6.921935014426708 - timing_s/step:63.59636756405234 - timing_s/stop_profile:4.1253864765167236e-05 - timing_per_token_ms/update_actor:0.03228845783814901 - timing_per_token_ms/gen:0.649684754021272 - timing_per_token_ms/ref:0.006246973765700026 - timing_per_token_ms/adv:3.526204013363147e-05 - perf/total_num_tokens:214378 - perf/time_per_step:63.59636756405234 - perf/throughput:421.36447451987914
[36m(TaskRunner pid=2905377)[0m step:225 - global_seqlen/min:25476 - global_seqlen/max:32436 - global_seqlen/minmax_diff:6960 - global_seqlen/balanced_min:27551 - global_seqlen/balanced_max:27551 - global_seqlen/mean:27551.0 - actor/entropy:0.31459686160087585 - actor/kl_loss:0.39432477205991745 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.025510960817337038 - actor/pg_clipfrac:0.008222075749654324 - actor/ppo_kl:-0.04900261862203479 - actor/pg_clipfrac_lower:0.0007680695911403745 - actor/grad_norm:2.9147087931632996 - perf/mfu/actor:0.08365760664548698 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.54516220092773 - actor/lr:1e-06 - training/global_step:225 - training/epoch:6 - critic/score/mean:0.984375 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.984375 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.032795537263154984 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.032795537263154984 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:278.7124938964844 - response_length/max:849.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001309029757976532 - timing_s/generate_sequences:24.92450523376465 - timing_s/reshard:0.6743826270103455 - timing_s/gen:28.06606012955308 - timing_s/reward:0.06829574890434742 - timing_s/old_log_prob:1.061321785673499 - timing_s/ref:1.332660837098956 - timing_s/adv:0.011199671775102615 - timing_s/update_actor:7.015965573489666 - timing_s/step:37.56865731999278 - timing_s/stop_profile:3.9322301745414734e-05 - timing_per_token_ms/update_actor:0.0318317192365507 - timing_per_token_ms/gen:0.31468426390941695 - timing_per_token_ms/ref:0.006046336054494193 - timing_per_token_ms/adv:5.0813363285827266e-05 - perf/total_num_tokens:220408 - perf/time_per_step:37.56865731999278 - perf/throughput:733.3506695576868
[36m(TaskRunner pid=2905377)[0m Training Progress:  43%|████▎     | 226/525 [3:36:22<4:07:46, 49.72s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  43%|████▎     | 227/525 [3:36:59<3:47:58, 45.90s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  43%|████▎     | 228/525 [3:37:46<3:50:14, 46.51s/it]
[36m(TaskRunner pid=2905377)[0m step:226 - global_seqlen/min:25206 - global_seqlen/max:32622 - global_seqlen/minmax_diff:7416 - global_seqlen/balanced_min:28783 - global_seqlen/balanced_max:28784 - global_seqlen/mean:28783.625 - actor/entropy:0.2680545449256897 - actor/kl_loss:0.298647528514266 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.022826738841831683 - actor/pg_clipfrac:0.005472584732342511 - actor/ppo_kl:0.007683253582945327 - actor/pg_clipfrac_lower:0.0001976292347535491 - actor/grad_norm:2.9226135313510895 - perf/mfu/actor:0.08807186948978037 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55405044555664 - actor/lr:1e-06 - training/global_step:226 - training/epoch:6 - critic/score/mean:1.068750023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.068750023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.03304523974657059 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03304523974657059 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:309.74688720703125 - response_length/max:1138.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.299892604351044e-05 - timing_s/generate_sequences:30.741374969482422 - timing_s/reshard:0.6799440383911133 - timing_s/gen:36.31347091309726 - timing_s/reward:0.07071778923273087 - timing_s/old_log_prob:1.1701752487570047 - timing_s/ref:1.3409914132207632 - timing_s/adv:0.007556114345788956 - timing_s/update_actor:6.97224435582757 - timing_s/step:45.88886678777635 - timing_s/stop_profile:4.1795894503593445e-05 - timing_per_token_ms/update_actor:0.03027869298875476 - timing_per_token_ms/gen:0.36636236153610574 - timing_per_token_ms/ref:0.005823586384709897 - timing_per_token_ms/adv:3.281429261337373e-05 - perf/total_num_tokens:230269 - perf/time_per_step:45.88886678777635 - perf/throughput:627.2463674711453
[36m(TaskRunner pid=2905377)[0m step:227 - global_seqlen/min:23802 - global_seqlen/max:30895 - global_seqlen/minmax_diff:7093 - global_seqlen/balanced_min:27347 - global_seqlen/balanced_max:27348 - global_seqlen/mean:27347.75 - actor/entropy:0.30556467175483704 - actor/kl_loss:0.36939262226223946 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0048943858593702315 - actor/pg_clipfrac:0.005223176185972988 - actor/ppo_kl:0.0039761767475283705 - actor/pg_clipfrac_lower:0.00026054339250549676 - actor/grad_norm:4.024727642536163 - perf/mfu/actor:0.08387114518561613 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.64555358886719 - actor/lr:1e-06 - training/global_step:227 - training/epoch:6 - critic/score/mean:1.074375033378601 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.074375033378601 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008486210368573666 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008486210368573666 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:274.2875061035156 - response_length/max:778.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.301118552684784e-05 - timing_s/generate_sequences:23.347562789916992 - timing_s/reshard:0.7238679528236389 - timing_s/gen:27.0777102522552 - timing_s/reward:0.06874234601855278 - timing_s/old_log_prob:1.0732489470392466 - timing_s/ref:1.3363666757941246 - timing_s/adv:0.007499042898416519 - timing_s/update_actor:6.943409603089094 - timing_s/step:36.5205863378942 - timing_s/stop_profile:4.081614315509796e-05 - timing_per_token_ms/update_actor:0.03173665842294656 - timing_per_token_ms/gen:0.30850054974542224 - timing_per_token_ms/ref:0.006108211259583168 - timing_per_token_ms/adv:3.427632482752932e-05 - perf/total_num_tokens:218782 - perf/time_per_step:36.5205863378942 - perf/throughput:748.8310769978971
[36m(TaskRunner pid=2905377)[0m step:228 - global_seqlen/min:24911 - global_seqlen/max:29560 - global_seqlen/minmax_diff:4649 - global_seqlen/balanced_min:27503 - global_seqlen/balanced_max:27504 - global_seqlen/mean:27503.375 - actor/entropy:0.2666863203048706 - actor/kl_loss:0.37065480276942253 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.021333276480436324 - actor/pg_clipfrac:0.00498474151827395 - actor/ppo_kl:0.005797210213495418 - actor/pg_clipfrac_lower:0.001762751571368426 - actor/grad_norm:3.4878258109092712 - perf/mfu/actor:0.08326932234328772 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62778091430664 - actor/lr:1e-06 - training/global_step:228 - training/epoch:6 - critic/score/mean:0.981249988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.981249988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.022873101755976677 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.022873101755976677 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:278.8343811035156 - response_length/max:1159.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.262453436851501e-05 - timing_s/generate_sequences:31.95745086669922 - timing_s/reshard:0.8572742342948914 - timing_s/gen:38.38104382157326 - timing_s/reward:0.06840384006500244 - timing_s/old_log_prob:1.0845482293516397 - timing_s/ref:1.3349784184247255 - timing_s/adv:0.0074545834213495255 - timing_s/update_actor:7.041387375444174 - timing_s/step:47.930989135056734 - timing_s/stop_profile:4.327856004238129e-05 - timing_per_token_ms/update_actor:0.03200237868736189 - timing_per_token_ms/gen:0.4301505578084353 - timing_per_token_ms/ref:0.0060673390921329 - timing_per_token_ms/adv:3.388031205874518e-05 - perf/total_num_tokens:220027 - perf/time_per_step:47.930989135056734 - perf/throughput:573.811963748606
[36m(TaskRunner pid=2905377)[0m Training Progress:  44%|████▎     | 229/525 [3:38:24<3:36:02, 43.79s/it]
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 14:40:35,496:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/model_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 14:40:38,927:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 14:40:38,930:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:40:39,817:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  44%|████▍     | 230/525 [3:39:44<4:28:53, 54.69s/it]
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 14:40:35,737:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  44%|████▍     | 231/525 [3:40:20<4:00:10, 49.02s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:40:40,482:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:40:40,484:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:229 - global_seqlen/min:25995 - global_seqlen/max:28800 - global_seqlen/minmax_diff:2805 - global_seqlen/balanced_min:27268 - global_seqlen/balanced_max:27269 - global_seqlen/mean:27268.25 - actor/entropy:0.2576351761817932 - actor/kl_loss:0.4947055418044329 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09069488644599914 - actor/pg_clipfrac:0.007684531534323469 - actor/ppo_kl:0.019885435048490763 - actor/pg_clipfrac_lower:0.00019685039296746254 - actor/grad_norm:3.5767796635627747 - perf/mfu/actor:0.08146964967961766 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.6094856262207 - actor/lr:1e-06 - training/global_step:229 - training/epoch:6 - critic/score/mean:0.9731249809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9731249809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01380866952240467 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01380866952240467 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:272.62811279296875 - response_length/max:829.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.138773798942566e-05 - timing_s/generate_sequences:24.576576232910156 - timing_s/reshard:0.6594194769859314 - timing_s/gen:27.80925379693508 - timing_s/reward:0.0678620133548975 - timing_s/old_log_prob:1.0695396326482296 - timing_s/ref:1.3324452117085457 - timing_s/adv:0.007482457906007767 - timing_s/update_actor:7.125656524673104 - timing_s/step:37.42543241195381 - timing_s/stop_profile:4.310533404350281e-05 - timing_per_token_ms/update_actor:0.03266462151345018 - timing_per_token_ms/gen:0.31876358360100276 - timing_per_token_ms/ref:0.006108043290771069 - timing_per_token_ms/adv:3.4300229690243076e-05 - perf/total_num_tokens:218146 - perf/time_per_step:37.42543241195381 - perf/throughput:728.6021361049239
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_230
[36m(TaskRunner pid=2905377)[0m step:230 - global_seqlen/min:25462 - global_seqlen/max:31839 - global_seqlen/minmax_diff:6377 - global_seqlen/balanced_min:27792 - global_seqlen/balanced_max:28364 - global_seqlen/mean:27871.0 - actor/entropy:0.25895169377326965 - actor/kl_loss:0.3847193669527769 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15033444836735727 - actor/pg_clipfrac:0.005131763080134988 - actor/ppo_kl:0.0028945103695150465 - actor/pg_clipfrac_lower:0.0005536784301511943 - actor/grad_norm:5.088169306516647 - perf/mfu/actor:0.08448577873493862 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.58864974975586 - actor/lr:1e-06 - training/global_step:230 - training/epoch:6 - critic/score/mean:1.0446875095367432 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0446875095367432 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.017254745587706566 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.017254745587706566 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:287.2593688964844 - response_length/max:2048.0 - response_length/min:68.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.066689431667328e-05 - timing_s/generate_sequences:33.02418518066406 - timing_s/reshard:0.7830978631973267 - timing_s/gen:62.93923971615732 - timing_s/reward:0.06938827037811279 - timing_s/old_log_prob:1.109299674630165 - timing_s/ref:1.3304323703050613 - timing_s/adv:0.00751720555126667 - timing_s/update_actor:7.03810653463006 - timing_s/save_checkpoint:7.597879908978939 - timing_s/step:80.10563113354146 - timing_s/stop_profile:4.834495484828949e-05 - timing_per_token_ms/update_actor:0.031565545435354225 - timing_per_token_ms/gen:0.6846952309667582 - timing_per_token_ms/ref:0.005966920680568787 - timing_per_token_ms/adv:3.371427985749825e-05 - perf/total_num_tokens:222968 - perf/time_per_step:80.10563113354146 - perf/throughput:347.92809950572854
[36m(TaskRunner pid=2905377)[0m step:231 - global_seqlen/min:25260 - global_seqlen/max:29761 - global_seqlen/minmax_diff:4501 - global_seqlen/balanced_min:27003 - global_seqlen/balanced_max:27004 - global_seqlen/mean:27003.5 - actor/entropy:0.29803335666656494 - actor/kl_loss:0.5104854457080364 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.010140596702694894 - actor/pg_clipfrac:0.005735492194071412 - actor/ppo_kl:0.07729469303740188 - actor/pg_clipfrac_lower:0.0003227680514100939 - actor/grad_norm:3.8463871479034424 - perf/mfu/actor:0.08269161133942024 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.52556991577148 - actor/lr:1e-06 - training/global_step:231 - training/epoch:6 - critic/score/mean:0.9746874570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9746874570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.011038278229534626 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.011038278229534626 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:265.6812438964844 - response_length/max:749.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.336640894412994e-05 - timing_s/generate_sequences:22.098522186279297 - timing_s/reshard:0.7094715237617493 - timing_s/gen:26.248202305287123 - timing_s/reward:0.06722898967564106 - timing_s/old_log_prob:1.0653920583426952 - timing_s/ref:1.3309452962130308 - timing_s/adv:0.007584184408187866 - timing_s/update_actor:6.949524667114019 - timing_s/step:35.68226010724902 - timing_s/stop_profile:4.1214749217033386e-05 - timing_per_token_ms/update_actor:0.032169555183189306 - timing_per_token_ms/gen:0.30873700046210356 - timing_per_token_ms/ref:0.0061609851325431465 - timing_per_token_ms/adv:3.510741389166157e-05 - perf/total_num_tokens:216028 - perf/time_per_step:35.68226010724902 - perf/throughput:756.776614453133
[36m(TaskRunner pid=2905377)[0m Training Progress:  44%|████▍     | 232/525 [3:41:04<3:51:39, 47.44s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  44%|████▍     | 233/525 [3:41:43<3:38:54, 44.98s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  45%|████▍     | 234/525 [3:42:12<3:15:39, 40.34s/it]
[36m(TaskRunner pid=2905377)[0m step:232 - global_seqlen/min:24465 - global_seqlen/max:33066 - global_seqlen/minmax_diff:8601 - global_seqlen/balanced_min:27375 - global_seqlen/balanced_max:27383 - global_seqlen/mean:27376.625 - actor/entropy:0.2745373547077179 - actor/kl_loss:0.46828185506165027 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.017164902947843074 - actor/pg_clipfrac:0.013502376712858677 - actor/ppo_kl:0.01656372056336295 - actor/pg_clipfrac_lower:0.0002896871417760849 - actor/grad_norm:3.993879109621048 - perf/mfu/actor:0.08432000397844847 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.59651947021484 - actor/lr:1e-06 - training/global_step:232 - training/epoch:6 - critic/score/mean:1.0975000858306885 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0975000858306885 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.015351971611380577 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.015351971611380577 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:274.7906188964844 - response_length/max:1039.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.800703704357147e-05 - timing_s/generate_sequences:22.94463539123535 - timing_s/reshard:0.7339800596237183 - timing_s/gen:34.2129744309932 - timing_s/reward:0.06913384422659874 - timing_s/old_log_prob:1.1963245533406734 - timing_s/ref:1.3289256561547518 - timing_s/adv:0.007650474086403847 - timing_s/update_actor:6.914282133802772 - timing_s/step:43.74285037256777 - timing_s/stop_profile:3.900192677974701e-05 - timing_per_token_ms/update_actor:0.03157019050833865 - timing_per_token_ms/gen:0.3890800317399975 - timing_per_token_ms/ref:0.006067793492417125 - timing_per_token_ms/adv:3.4931598062233046e-05 - perf/total_num_tokens:219013 - perf/time_per_step:43.74285037256777 - perf/throughput:625.8537056187944
[36m(TaskRunner pid=2905377)[0m step:233 - global_seqlen/min:24216 - global_seqlen/max:30385 - global_seqlen/minmax_diff:6169 - global_seqlen/balanced_min:26696 - global_seqlen/balanced_max:26697 - global_seqlen/mean:26696.875 - actor/entropy:0.2779093384742737 - actor/kl_loss:0.43971480503678323 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02818601094186306 - actor/pg_clipfrac:0.0029282600968144833 - actor/ppo_kl:0.007477939024101943 - actor/pg_clipfrac_lower:0.0003867603256367147 - actor/grad_norm:4.38809859752655 - perf/mfu/actor:0.0821044413594741 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.63249588012695 - actor/lr:1e-06 - training/global_step:233 - training/epoch:6 - critic/score/mean:1.0856249332427979 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0856249332427979 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.03291729837656021 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.03291729837656021 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:258.234375 - response_length/max:861.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010318867862224579 - timing_s/generate_sequences:21.701208114624023 - timing_s/reshard:0.6682093143463135 - timing_s/gen:29.73280055820942 - timing_s/reward:0.06621797196567059 - timing_s/old_log_prob:1.0620092581957579 - timing_s/ref:1.342204263433814 - timing_s/adv:0.007558222860097885 - timing_s/update_actor:6.9185131173580885 - timing_s/step:39.142700942233205 - timing_s/stop_profile:4.229508340358734e-05 - timing_per_token_ms/update_actor:0.03239383409742755 - timing_per_token_ms/gen:0.3598088044800559 - timing_per_token_ms/ref:0.006284463366188992 - timing_per_token_ms/adv:3.538908046399572e-05 - perf/total_num_tokens:213575 - perf/time_per_step:39.142700942233205 - perf/throughput:682.039674252404
[36m(TaskRunner pid=2905377)[0m step:234 - global_seqlen/min:23386 - global_seqlen/max:28842 - global_seqlen/minmax_diff:5456 - global_seqlen/balanced_min:26131 - global_seqlen/balanced_max:26132 - global_seqlen/mean:26131.5 - actor/entropy:0.31638267636299133 - actor/kl_loss:0.5767086826264858 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0037178520113229753 - actor/pg_clipfrac:0.00670891567133367 - actor/ppo_kl:0.025861238423385658 - actor/pg_clipfrac_lower:0.00021645021624863147 - actor/grad_norm:4.16245311498642 - perf/mfu/actor:0.08092415880647165 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.66604995727539 - actor/lr:1e-06 - training/global_step:234 - training/epoch:6 - critic/score/mean:1.0265624523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0265624523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.0035149261821061373 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888514995574951 - critic/returns/mean:-0.0035149261821061373 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888514995574951 - response_length/mean:243.77188110351562 - response_length/max:554.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.325038313865662e-05 - timing_s/generate_sequences:17.378143310546875 - timing_s/reshard:0.7021487951278687 - timing_s/gen:20.123385133221745 - timing_s/reward:0.06584103405475616 - timing_s/old_log_prob:1.1048933006823063 - timing_s/ref:1.3261363413184881 - timing_s/adv:0.00754033587872982 - timing_s/update_actor:6.864209858700633 - timing_s/step:29.50552923604846 - timing_s/stop_profile:3.94769012928009e-05 - timing_per_token_ms/update_actor:0.03283493991303902 - timing_per_token_ms/gen:0.25796896603153235 - timing_per_token_ms/ref:0.006343571653552648 - timing_per_token_ms/adv:3.606918794716061e-05 - perf/total_num_tokens:209052 - perf/time_per_step:29.50552923604846 - perf/throughput:885.6475608671262
[36m(TaskRunner pid=2905377)[0m Training Progress:  45%|████▍     | 235/525 [3:43:09<3:39:23, 45.39s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  45%|████▍     | 236/525 [3:43:42<3:20:00, 41.52s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  45%|████▌     | 237/525 [3:44:33<3:32:58, 44.37s/it]
[36m(TaskRunner pid=2905377)[0m step:235 - global_seqlen/min:24798 - global_seqlen/max:32923 - global_seqlen/minmax_diff:8125 - global_seqlen/balanced_min:27229 - global_seqlen/balanced_max:27361 - global_seqlen/mean:27310.0 - actor/entropy:0.2533784508705139 - actor/kl_loss:0.6115460224449635 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08120902851223946 - actor/pg_clipfrac:0.0042593814199790355 - actor/ppo_kl:0.08629480653908103 - actor/pg_clipfrac_lower:0.000423296564258635 - actor/grad_norm:3.1949502825737 - perf/mfu/actor:0.08387744118504273 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.65652847290039 - actor/lr:1e-06 - training/global_step:235 - training/epoch:6 - critic/score/mean:1.0306249856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0306249856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.006677321624010801 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.006677321624010801 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:273.34375 - response_length/max:1480.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.480437099933624e-05 - timing_s/generate_sequences:31.321529388427734 - timing_s/reshard:0.6428516507148743 - timing_s/gen:47.2353985439986 - timing_s/reward:0.06830664910376072 - timing_s/old_log_prob:1.096691220998764 - timing_s/ref:1.3361000400036573 - timing_s/adv:0.007406940683722496 - timing_s/update_actor:6.944064185023308 - timing_s/step:56.701337011530995 - timing_s/stop_profile:4.338659346103668e-05 - timing_per_token_ms/update_actor:0.03178352336608984 - timing_per_token_ms/gen:0.5400182753401006 - timing_per_token_ms/ref:0.006115434090093635 - timing_per_token_ms/adv:3.390214520195211e-05 - perf/total_num_tokens:218480 - perf/time_per_step:56.701337011530995 - perf/throughput:481.64649088338314
[36m(TaskRunner pid=2905377)[0m step:236 - global_seqlen/min:24079 - global_seqlen/max:27790 - global_seqlen/minmax_diff:3711 - global_seqlen/balanced_min:25492 - global_seqlen/balanced_max:25493 - global_seqlen/mean:25492.125 - actor/entropy:0.3192797601222992 - actor/kl_loss:0.61918939165771 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16979918740689753 - actor/pg_clipfrac:0.007195385871455073 - actor/ppo_kl:-0.050189952983055265 - actor/pg_clipfrac_lower:0.0014538276882376522 - actor/grad_norm:7.919978559017181 - perf/mfu/actor:0.07922721060724008 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.61640548706055 - actor/lr:1e-06 - training/global_step:236 - training/epoch:6 - critic/score/mean:1.0343749523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0343749523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.004021512810140848 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.004021512810140848 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:228.00625610351562 - response_length/max:673.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.123872637748718e-05 - timing_s/generate_sequences:20.323394775390625 - timing_s/reshard:0.6355664730072021 - timing_s/gen:23.212310906499624 - timing_s/reward:0.06439018808305264 - timing_s/old_log_prob:1.0412793718278408 - timing_s/ref:1.3185501880943775 - timing_s/adv:0.007489064708352089 - timing_s/update_actor:6.836002290248871 - timing_s/step:32.49343355000019 - timing_s/stop_profile:4.2635947465896606e-05 - timing_per_token_ms/update_actor:0.033520166964547245 - timing_per_token_ms/gen:0.31814247014198654 - timing_per_token_ms/ref:0.006465478005925249 - timing_per_token_ms/adv:3.672244226575898e-05 - perf/total_num_tokens:203937 - perf/time_per_step:32.49343355000019 - perf/throughput:784.5315873058867
[36m(TaskRunner pid=2905377)[0m step:237 - global_seqlen/min:23711 - global_seqlen/max:29813 - global_seqlen/minmax_diff:6102 - global_seqlen/balanced_min:26495 - global_seqlen/balanced_max:26843 - global_seqlen/mean:26540.25 - actor/entropy:0.2823503315448761 - actor/kl_loss:0.6311353567987681 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04145786128938198 - actor/pg_clipfrac:0.021923021110706032 - actor/ppo_kl:0.009487132262438535 - actor/pg_clipfrac_lower:0.0016440832754597069 - actor/grad_norm:4.737916886806488 - perf/mfu/actor:0.08020596930412771 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.63531494140625 - actor/lr:1e-06 - training/global_step:237 - training/epoch:6 - critic/score/mean:1.1590625047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.1590625047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.011232161894440651 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.011232161894440651 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:253.77188110351562 - response_length/max:1333.0 - response_length/min:71.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.231533527374268e-05 - timing_s/generate_sequences:25.112865447998047 - timing_s/reshard:0.6410413980484009 - timing_s/gen:41.46780570782721 - timing_s/reward:0.06668292544782162 - timing_s/old_log_prob:1.0598042905330658 - timing_s/ref:1.3361241295933723 - timing_s/adv:0.0074929483234882355 - timing_s/update_actor:7.040303831920028 - timing_s/step:50.991610599681735 - timing_s/stop_profile:4.027225077152252e-05 - timing_per_token_ms/update_actor:0.033158616779796854 - timing_per_token_ms/gen:0.5106432414425752 - timing_per_token_ms/ref:0.006292914203866638 - timing_per_token_ms/adv:3.529049426572958e-05 - perf/total_num_tokens:212322 - perf/time_per_step:50.991610599681735 - perf/throughput:520.4826772066237
[36m(TaskRunner pid=2905377)[0m Training Progress:  45%|████▌     | 238/525 [3:45:20<3:36:32, 45.27s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  46%|████▌     | 239/525 [3:45:52<3:16:05, 41.14s/it]
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:47:29,828:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:47:33,224:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:47:33,226:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:47:33,963:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  46%|████▌     | 240/525 [3:46:38<3:23:07, 42.76s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:47:30,056:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:238 - global_seqlen/min:22998 - global_seqlen/max:32383 - global_seqlen/minmax_diff:9385 - global_seqlen/balanced_min:26734 - global_seqlen/balanced_max:26735 - global_seqlen/mean:26734.125 - actor/entropy:0.26948976516723633 - actor/kl_loss:0.6277323715388775 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.15858640074729918 - actor/pg_clipfrac:0.007672545191599056 - actor/ppo_kl:0.15126209631562232 - actor/pg_clipfrac_lower:0.00014660494052805008 - actor/grad_norm:5.0508400201797485 - perf/mfu/actor:0.07908269801195811 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62139892578125 - actor/lr:1e-06 - training/global_step:238 - training/epoch:6 - critic/score/mean:1.0712499618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0712499618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0034198134671896696 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0034198134671896696 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:259.1656188964844 - response_length/max:1157.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.078610360622406e-05 - timing_s/generate_sequences:24.775287628173828 - timing_s/reshard:0.7225999236106873 - timing_s/gen:37.68388734199107 - timing_s/reward:0.0664270855486393 - timing_s/old_log_prob:1.0671524126082659 - timing_s/ref:1.3285496961325407 - timing_s/adv:0.007519163191318512 - timing_s/update_actor:7.19700463861227 - timing_s/step:47.36422610655427 - timing_s/stop_profile:3.962218761444092e-05 - timing_per_token_ms/update_actor:0.03365083315150706 - timing_per_token_ms/gen:0.45438953543210864 - timing_per_token_ms/ref:0.006211862629376035 - timing_per_token_ms/adv:3.5157140879486945e-05 - perf/total_num_tokens:213873 - perf/time_per_step:47.36422610655427 - perf/throughput:564.4370698648559
[36m(TaskRunner pid=2905377)[0m step:239 - global_seqlen/min:23959 - global_seqlen/max:29613 - global_seqlen/minmax_diff:5654 - global_seqlen/balanced_min:26278 - global_seqlen/balanced_max:26279 - global_seqlen/mean:26278.25 - actor/entropy:0.24762839078903198 - actor/kl_loss:0.6945082362741232 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.005035332404077053 - actor/pg_clipfrac:0.017504215054214 - actor/ppo_kl:-0.04747028221245273 - actor/pg_clipfrac_lower:0.003030502959154546 - actor/grad_norm:3.861777901649475 - perf/mfu/actor:0.08122170419985189 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.65380859375 - actor/lr:1e-06 - training/global_step:239 - training/epoch:6 - critic/score/mean:1.0499999523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0499999523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.020144639536738396 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.020144639536738396 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:247.7687530517578 - response_length/max:624.0 - response_length/min:78.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.894448935985565e-05 - timing_s/generate_sequences:18.891178131103516 - timing_s/reshard:0.7861456274986267 - timing_s/gen:21.961093217134476 - timing_s/reward:0.06570008769631386 - timing_s/old_log_prob:1.148764604702592 - timing_s/ref:1.327948709949851 - timing_s/adv:0.0076059699058532715 - timing_s/update_actor:6.878867667168379 - timing_s/step:31.403290957212448 - timing_s/stop_profile:4.092417657375336e-05 - timing_per_token_ms/update_actor:0.03272129835114771 - timing_per_token_ms/gen:0.2769857631502973 - timing_per_token_ms/ref:0.006316767240730695 - timing_per_token_ms/adv:3.61799677768367e-05 - perf/total_num_tokens:210226 - perf/time_per_step:31.403290957212448 - perf/throughput:836.7992397931985
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240
[36m(TaskRunner pid=2905377)[0m step:240 - global_seqlen/min:22794 - global_seqlen/max:31321 - global_seqlen/minmax_diff:8527 - global_seqlen/balanced_min:26488 - global_seqlen/balanced_max:26489 - global_seqlen/mean:26488.5 - actor/entropy:0.2649032175540924 - actor/kl_loss:0.6825912723317742 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12453977316617966 - actor/pg_clipfrac:0.008940612943843008 - actor/ppo_kl:0.020805745941470378 - actor/pg_clipfrac_lower:0.0005113636143505573 - actor/grad_norm:5.255001783370972 - perf/mfu/actor:0.08195284163807097 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.68999862670898 - actor/lr:1e-06 - training/global_step:240 - training/epoch:6 - critic/score/mean:0.9962499737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9962499737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0007042939541861415 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0007042939541861415 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:252.58749389648438 - response_length/max:892.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.0204958319664e-05 - timing_s/generate_sequences:25.061914443969727 - timing_s/reshard:0.6598243713378906 - timing_s/gen:29.394266666844487 - timing_s/reward:0.06686384044587612 - timing_s/old_log_prob:1.1841618698090315 - timing_s/ref:1.324833346530795 - timing_s/adv:0.0075668878853321075 - timing_s/update_actor:6.877293389290571 - timing_s/save_checkpoint:7.677184531465173 - timing_s/step:46.54631222598255 - timing_s/stop_profile:4.889070987701416e-05 - timing_per_token_ms/update_actor:0.03245414703215816 - timing_per_token_ms/gen:0.3636644067259426 - timing_per_token_ms/ref:0.0062519269991260125 - timing_per_token_ms/adv:3.570836346590081e-05 - perf/total_num_tokens:211908 - perf/time_per_step:46.54631222598255 - perf/throughput:569.0783809337723
[36m(TaskRunner pid=2905377)[0m Training Progress:  46%|████▌     | 241/525 [3:47:11<3:08:35, 39.84s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:47:34,893:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:47:34,896:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_240/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  46%|████▌     | 242/525 [3:47:50<3:06:12, 39.48s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  46%|████▋     | 243/525 [3:48:26<3:00:37, 38.43s/it]
[36m(TaskRunner pid=2905377)[0m step:241 - global_seqlen/min:24394 - global_seqlen/max:29809 - global_seqlen/minmax_diff:5415 - global_seqlen/balanced_min:26161 - global_seqlen/balanced_max:26162 - global_seqlen/mean:26161.125 - actor/entropy:0.30212241411209106 - actor/kl_loss:0.5746798023581505 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013028962537646294 - actor/pg_clipfrac:0.011528642009943723 - actor/ppo_kl:-0.009435874747578055 - actor/pg_clipfrac_lower:0.0010650702461134642 - actor/grad_norm:6.558029770851135 - perf/mfu/actor:0.07990979003411441 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.58425521850586 - actor/lr:1e-06 - training/global_step:241 - training/epoch:6 - critic/score/mean:0.9546874761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:0.9546874761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.016924045979976654 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.016924045979976654 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:243.9656219482422 - response_length/max:679.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.976405322551727e-05 - timing_s/generate_sequences:19.6757869720459 - timing_s/reshard:0.6723770499229431 - timing_s/gen:23.458484830334783 - timing_s/reward:0.0660745408385992 - timing_s/old_log_prob:1.0934643596410751 - timing_s/ref:1.3313470408320427 - timing_s/adv:0.007611887529492378 - timing_s/update_actor:6.961914015933871 - timing_s/step:32.93243050202727 - timing_s/stop_profile:4.286319017410278e-05 - timing_per_token_ms/update_actor:0.03326459592206887 - timing_per_token_ms/gen:0.3004839927542915 - timing_per_token_ms/ref:0.0063612853080288155 - timing_per_token_ms/adv:3.637022265619492e-05 - perf/total_num_tokens:209289 - perf/time_per_step:32.93243050202727 - perf/throughput:794.3879210005334
[36m(TaskRunner pid=2905377)[0m step:242 - global_seqlen/min:24699 - global_seqlen/max:28133 - global_seqlen/minmax_diff:3434 - global_seqlen/balanced_min:26040 - global_seqlen/balanced_max:26041 - global_seqlen/mean:26040.25 - actor/entropy:0.2740159332752228 - actor/kl_loss:0.7490157127380371 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0635478500276804 - actor/pg_clipfrac:0.007728100707754493 - actor/ppo_kl:0.05130721174646169 - actor/pg_clipfrac_lower:0.0001528634165879339 - actor/grad_norm:6.108521640300751 - perf/mfu/actor:0.08043401930093938 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62992477416992 - actor/lr:1e-06 - training/global_step:242 - training/epoch:6 - critic/score/mean:0.949999988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.949999988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0053865909576416016 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0053865909576416016 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:241.60000610351562 - response_length/max:876.0 - response_length/min:20.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.010065019130707e-05 - timing_s/generate_sequences:22.69232177734375 - timing_s/reshard:0.7389223575592041 - timing_s/gen:29.273501623421907 - timing_s/reward:0.06528797000646591 - timing_s/old_log_prob:1.0474679507315159 - timing_s/ref:1.325979333370924 - timing_s/adv:0.007559981197118759 - timing_s/update_actor:6.883684530854225 - timing_s/step:38.61684328503907 - timing_s/stop_profile:4.151463508605957e-05 - timing_per_token_ms/update_actor:0.03304348331359254 - timing_per_token_ms/gen:0.37864111164401265 - timing_per_token_ms/ref:0.0063650470587404305 - timing_per_token_ms/adv:3.6289883915855065e-05 - perf/total_num_tokens:208322 - perf/time_per_step:38.61684328503907 - perf/throughput:674.3236314732259
[36m(TaskRunner pid=2905377)[0m step:243 - global_seqlen/min:23009 - global_seqlen/max:27121 - global_seqlen/minmax_diff:4112 - global_seqlen/balanced_min:24898 - global_seqlen/balanced_max:24899 - global_seqlen/mean:24898.75 - actor/entropy:0.2803945243358612 - actor/kl_loss:0.7461886025965214 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04675357639789581 - actor/pg_clipfrac:0.011263463413342834 - actor/ppo_kl:-0.07486108867451549 - actor/pg_clipfrac_lower:0.004924495425075293 - actor/grad_norm:6.011970400810242 - perf/mfu/actor:0.07514262151444989 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.65398025512695 - actor/lr:1e-06 - training/global_step:243 - training/epoch:6 - critic/score/mean:1.0906250476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0906250476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0038103044498711824 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0038103044498711824 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:213.28125 - response_length/max:757.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.648447692394257e-05 - timing_s/generate_sequences:19.578561782836914 - timing_s/reshard:0.6592375636100769 - timing_s/gen:26.179164787754416 - timing_s/reward:0.06274895742535591 - timing_s/old_log_prob:1.1153599303215742 - timing_s/ref:1.3274564296007156 - timing_s/adv:0.00829063355922699 - timing_s/update_actor:7.037171212956309 - timing_s/step:35.74362505041063 - timing_s/stop_profile:4.253163933753967e-05 - timing_per_token_ms/update_actor:0.0353289382647538 - timing_per_token_ms/gen:0.38357750604768376 - timing_per_token_ms/ref:0.006664272451431878 - timing_per_token_ms/adv:4.1621735826231184e-05 - perf/total_num_tokens:199190 - perf/time_per_step:35.74362505041063 - perf/throughput:696.5927480742181
[36m(TaskRunner pid=2905377)[0m Training Progress:  46%|████▋     | 244/525 [3:49:01<2:54:51, 37.34s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  47%|████▋     | 245/525 [3:49:35<2:49:38, 36.35s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  47%|████▋     | 246/525 [3:50:14<2:52:30, 37.10s/it]
[36m(TaskRunner pid=2905377)[0m step:244 - global_seqlen/min:23124 - global_seqlen/max:27410 - global_seqlen/minmax_diff:4286 - global_seqlen/balanced_min:25169 - global_seqlen/balanced_max:25170 - global_seqlen/mean:25169.875 - actor/entropy:0.30213674902915955 - actor/kl_loss:0.5422195099294186 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07708606608211994 - actor/pg_clipfrac:0.007705397822428494 - actor/ppo_kl:0.05679197729332373 - actor/pg_clipfrac_lower:0.00021645021624863147 - actor/grad_norm:5.607965469360352 - perf/mfu/actor:0.07626264219644925 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.70302200317383 - actor/lr:1e-06 - training/global_step:244 - training/epoch:6 - critic/score/mean:1.118749976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.118749976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.007147627416998148 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.007147627416998148 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:219.4031219482422 - response_length/max:744.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.531233131885529e-05 - timing_s/generate_sequences:20.112722396850586 - timing_s/reshard:0.7431830167770386 - timing_s/gen:25.31538237631321 - timing_s/reward:0.06318517401814461 - timing_s/old_log_prob:1.0368786435574293 - timing_s/ref:1.325748011469841 - timing_s/adv:0.007500361651182175 - timing_s/update_actor:7.008792957291007 - timing_s/step:34.77108442224562 - timing_s/stop_profile:4.498101770877838e-05 - timing_per_token_ms/update_actor:0.034807448176098446 - timing_per_token_ms/gen:0.3605717554204334 - timing_per_token_ms/ref:0.006584001765353627 - timing_per_token_ms/adv:3.7248703316872725e-05 - perf/total_num_tokens:201359 - perf/time_per_step:34.77108442224562 - perf/throughput:723.8737421688517
[36m(TaskRunner pid=2905377)[0m step:245 - global_seqlen/min:24368 - global_seqlen/max:27573 - global_seqlen/minmax_diff:3205 - global_seqlen/balanced_min:26218 - global_seqlen/balanced_max:26219 - global_seqlen/mean:26218.5 - actor/entropy:0.27520209550857544 - actor/kl_loss:0.5094103310257196 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06578199341893196 - actor/pg_clipfrac:0.010221493046265096 - actor/ppo_kl:-0.10634966090437956 - actor/pg_clipfrac_lower:0.007902705110609531 - actor/grad_norm:4.873110294342041 - perf/mfu/actor:0.08051472532282701 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.71647262573242 - actor/lr:1e-06 - training/global_step:245 - training/epoch:6 - critic/score/mean:1.015625 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.015625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.006475389003753662 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.006475389003753662 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:245.72811889648438 - response_length/max:708.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.357262074947357e-05 - timing_s/generate_sequences:21.857473373413086 - timing_s/reshard:0.6761760711669922 - timing_s/gen:24.6442232709378 - timing_s/reward:0.06571694277226925 - timing_s/old_log_prob:1.0608353335410357 - timing_s/ref:1.325583077967167 - timing_s/adv:0.007771063596010208 - timing_s/update_actor:6.9250607173889875 - timing_s/step:34.04245854727924 - timing_s/stop_profile:4.106760025024414e-05 - timing_per_token_ms/update_actor:0.033016098925324616 - timing_per_token_ms/gen:0.31340815269591393 - timing_per_token_ms/ref:0.006319884232351044 - timing_per_token_ms/adv:3.704952417191205e-05 - perf/total_num_tokens:209748 - perf/time_per_step:34.04245854727924 - perf/throughput:770.1705787079661
[36m(TaskRunner pid=2905377)[0m step:246 - global_seqlen/min:23897 - global_seqlen/max:27949 - global_seqlen/minmax_diff:4052 - global_seqlen/balanced_min:26282 - global_seqlen/balanced_max:26283 - global_seqlen/mean:26282.125 - actor/entropy:0.2509081959724426 - actor/kl_loss:0.7163372609764338 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14471205305308105 - actor/pg_clipfrac:0.010363150830380618 - actor/ppo_kl:-0.051987076814111785 - actor/pg_clipfrac_lower:0.0011945392936468125 - actor/grad_norm:8.676415383815765 - perf/mfu/actor:0.08075479293114678 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.52193832397461 - actor/lr:1e-06 - training/global_step:246 - training/epoch:7 - critic/score/mean:0.9781249761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.9781249761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.016657965257763863 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.016657965257763863 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:247.86563110351562 - response_length/max:814.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00030885636806488037 - timing_s/generate_sequences:23.02056312561035 - timing_s/reshard:0.6893938779830933 - timing_s/gen:27.541589679196477 - timing_s/reward:0.0668803732842207 - timing_s/old_log_prob:1.0808236505836248 - timing_s/ref:1.3373543005436659 - timing_s/adv:0.00810074433684349 - timing_s/update_actor:6.923655178397894 - timing_s/step:36.983966974541545 - timing_s/stop_profile:3.931298851966858e-05 - timing_per_token_ms/update_actor:0.03292948714381873 - timing_per_token_ms/gen:0.3472343845480348 - timing_per_token_ms/ref:0.006360569686353681 - timing_per_token_ms/adv:3.852782231670523e-05 - perf/total_num_tokens:210257 - perf/time_per_step:36.983966974541545 - perf/throughput:710.6356388997342
[36m(TaskRunner pid=2905377)[0m Training Progress:  47%|████▋     | 247/525 [3:50:46<2:44:51, 35.58s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  47%|████▋     | 248/525 [3:51:24<2:47:40, 36.32s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  47%|████▋     | 249/525 [3:52:00<2:46:16, 36.15s/it]
[36m(TaskRunner pid=2905377)[0m step:247 - global_seqlen/min:23814 - global_seqlen/max:26644 - global_seqlen/minmax_diff:2830 - global_seqlen/balanced_min:25224 - global_seqlen/balanced_max:25225 - global_seqlen/mean:25224.75 - actor/entropy:0.2726411521434784 - actor/kl_loss:0.5927789151668549 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.015053682774305344 - actor/pg_clipfrac:0.012807050556875765 - actor/ppo_kl:0.03501151083328295 - actor/pg_clipfrac_lower:0.00076768888393417 - actor/grad_norm:5.050981402397156 - perf/mfu/actor:0.07802871348528498 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.53342819213867 - actor/lr:1e-06 - training/global_step:247 - training/epoch:7 - critic/score/mean:1.0343749523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0343749523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.000699297059327364 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.000699297059327364 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:220.88436889648438 - response_length/max:651.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.056444883346558e-05 - timing_s/generate_sequences:17.492340087890625 - timing_s/reshard:0.7824127674102783 - timing_s/gen:22.51389292627573 - timing_s/reward:0.06415805220603943 - timing_s/old_log_prob:1.238469198346138 - timing_s/ref:1.326224748045206 - timing_s/adv:0.007551258429884911 - timing_s/update_actor:6.864552292972803 - timing_s/step:32.02828944288194 - timing_s/stop_profile:4.120171070098877e-05 - timing_per_token_ms/update_actor:0.03401694909252224 - timing_per_token_ms/gen:0.31851920442363413 - timing_per_token_ms/ref:0.006572041090819563 - timing_per_token_ms/adv:3.7419887362039813e-05 - perf/total_num_tokens:201798 - perf/time_per_step:32.02828944288194 - perf/throughput:787.5771837576552
[36m(TaskRunner pid=2905377)[0m step:248 - global_seqlen/min:24650 - global_seqlen/max:28414 - global_seqlen/minmax_diff:3764 - global_seqlen/balanced_min:26046 - global_seqlen/balanced_max:26133 - global_seqlen/mean:26056.875 - actor/entropy:0.25625813007354736 - actor/kl_loss:0.6606778152287006 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07452784888446332 - actor/pg_clipfrac:0.011548953014425933 - actor/ppo_kl:-0.032416420470690356 - actor/pg_clipfrac_lower:0.001734816888347268 - actor/grad_norm:5.265045881271362 - perf/mfu/actor:0.07915318501441379 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.58862686157227 - actor/lr:1e-06 - training/global_step:248 - training/epoch:7 - critic/score/mean:0.98499995470047 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.98499995470047 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.00573723204433918 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.00573723204433918 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:241.46875 - response_length/max:868.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.96932727098465e-05 - timing_s/generate_sequences:20.459714889526367 - timing_s/reshard:0.697219729423523 - timing_s/gen:28.38439748249948 - timing_s/reward:0.065624188631773 - timing_s/old_log_prob:1.0496097560971975 - timing_s/ref:1.3311262838542461 - timing_s/adv:0.007812352851033211 - timing_s/update_actor:6.998553464189172 - timing_s/step:37.850326327607036 - timing_s/stop_profile:4.01567667722702e-05 - timing_per_token_ms/update_actor:0.033573449733463684 - timing_per_token_ms/gen:0.36734046178982116 - timing_per_token_ms/ref:0.006385676927174911 - timing_per_token_ms/adv:3.747740687934188e-05 - perf/total_num_tokens:208455 - perf/time_per_step:37.850326327607036 - perf/throughput:688.418767502007
[36m(TaskRunner pid=2905377)[0m step:249 - global_seqlen/min:23758 - global_seqlen/max:26660 - global_seqlen/minmax_diff:2902 - global_seqlen/balanced_min:25783 - global_seqlen/balanced_max:25783 - global_seqlen/mean:25783.0 - actor/entropy:0.2428910881280899 - actor/kl_loss:0.6490886867046356 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06065867319703102 - actor/pg_clipfrac:0.008515325735788792 - actor/ppo_kl:0.02669797311536968 - actor/pg_clipfrac_lower:9.900990407913923e-05 - actor/grad_norm:4.307911217212677 - perf/mfu/actor:0.07961766657170567 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.72144317626953 - actor/lr:1e-06 - training/global_step:249 - training/epoch:7 - critic/score/mean:1.040624976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.040624976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.004287606105208397 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.004287606105208397 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:234.7312469482422 - response_length/max:788.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.873028516769409e-05 - timing_s/generate_sequences:21.98311996459961 - timing_s/reshard:0.7620917558670044 - timing_s/gen:26.071596747264266 - timing_s/reward:0.06539548560976982 - timing_s/old_log_prob:1.0572382342070341 - timing_s/ref:1.3541233576834202 - timing_s/adv:0.007440546527504921 - timing_s/update_actor:6.882786387577653 - timing_s/step:35.45187527500093 - timing_s/stop_profile:4.12575900554657e-05 - timing_per_token_ms/update_actor:0.033368820480440854 - timing_per_token_ms/gen:0.3470937075280809 - timing_per_token_ms/ref:0.006565000958400013 - timing_per_token_ms/adv:3.607292851639123e-05 - perf/total_num_tokens:206264 - perf/time_per_step:35.45187527500093 - perf/throughput:727.2675930398811
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 250}
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <think>
[36m(TaskRunner pid=2905377)[0m Given that the hyperbola is centered at the origin and has foci on the x-axis, it can be represented as \(\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1\). Since it is an equilateral hyperbola, \(a = b\). The equation of the hyperbola becomes \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\) or \(x^2 - y^2 = a^2\).
[36m(TaskRunner pid=2905377)[0m 
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 14:54:00,205:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:54:03,763:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 14:54:03,765:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 14:54:04,427:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  48%|████▊     | 250/525 [3:53:09<3:31:13, 46.08s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:54:00,459:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  48%|████▊     | 251/525 [3:54:07<3:46:25, 49.58s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:54:05,316:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 14:54:05,319:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m The equation of the parabola is \(y^2 = 16x\). The准线 (directrix) of this parabola is the line \(x = -4\). The hyperbola intersects the parabola at points \(A\) and \(B\) such that the distance \(|AB| = 4\sqrt{3}\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Substituting \(x = -4\) into the hyperbola's equation \(x^2 - y^2 = a^2\), we get:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m (-4)^2 - y^2 = a^2 \implies 16 - y^2 = a^2 \implies y^2 = 16 - a^2.
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m The points of intersection are \((-4, \sqrt{16 - a^2})\) and \((-4, -\sqrt{16 - a^2})\). The distance between these points is:
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m |\sqrt{16 - a^2} - (-\sqrt{16 - a^2})| = |2\sqrt{16 - a^2}| = 4\sqrt{3}.
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m Solving for \(a\):
[36m(TaskRunner pid=2905377)[0m \[
[36m(TaskRunner pid=2905377)[0m 2\sqrt{16 - a^2} = 4\sqrt{3} \implies \sqrt{16 - a^2} = 2\sqrt{3} \implies 16 - a^2 = 12 \implies a^2 = 4 \implies a = 2.
[36m(TaskRunner pid=2905377)[0m \]
[36m(TaskRunner pid=2905377)[0m </think>
[36m(TaskRunner pid=2905377)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 0.6
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_250
[36m(TaskRunner pid=2905377)[0m step:250 - global_seqlen/min:23860 - global_seqlen/max:28707 - global_seqlen/minmax_diff:4847 - global_seqlen/balanced_min:25938 - global_seqlen/balanced_max:25939 - global_seqlen/mean:25938.5 - actor/entropy:0.22883477807044983 - actor/kl_loss:0.678177747130394 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0045711413957178594 - actor/pg_clipfrac:0.005408859672024846 - actor/ppo_kl:-0.011165923828957602 - actor/pg_clipfrac_lower:0.0005763417575508356 - actor/grad_norm:4.607924282550812 - perf/mfu/actor:0.08020993595026564 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.69437789916992 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.8950000236183404 - val-aux/grpo_convert/reward/std@50:0.43693933418645875 - val-aux/grpo_convert/reward/best@2/mean:1.0812500238306821 - val-aux/grpo_convert/reward/best@2/std:0.4565589360731086 - val-aux/grpo_convert/reward/worst@2/mean:0.6925000232383609 - val-aux/grpo_convert/reward/worst@2/std:0.2971947451839957 - val-aux/grpo_convert/reward/best@4/mean:1.2820000238418578 - val-aux/grpo_convert/reward/best@4/std:0.40413576969135445 - val-aux/grpo_convert/reward/worst@4/mean:0.5922500228248537 - val-aux/grpo_convert/reward/worst@4/std:0.15767609900226098 - val-aux/grpo_convert/reward/best@8/mean:1.4650000238418581 - val-aux/grpo_convert/reward/best@8/std:0.26681018750291774 - val-aux/grpo_convert/reward/worst@8/mean:0.5572500219084322 - val-aux/grpo_convert/reward/worst@8/std:0.1103653032612035 - val-aux/grpo_convert/reward/best@16/mean:1.5660000238418579 - val-aux/grpo_convert/reward/best@16/std:0.12587295182047648 - val-aux/grpo_convert/reward/worst@16/mean:0.5230000203996896 - val-aux/grpo_convert/reward/worst@16/std:0.11541664174195262 - val-aux/grpo_convert/reward/best@32/mean:1.599500023841858 - val-aux/grpo_convert/reward/best@32/std:0.01580348062927911 - val-aux/grpo_convert/reward/worst@32/mean:0.481750018555671 - val-aux/grpo_convert/reward/worst@32/std:0.1248176225254683 - val-core/grpo_convert/reward/best@50/mean:1.600000023841858 - val-core/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:0.4377500165887177 - val-aux/grpo_convert/reward/worst@50/std:0.11932073907299659 - training/global_step:250 - training/epoch:7 - critic/score/mean:1.0593750476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0593750476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.002642433624714613 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.002642433624714613 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:238.72811889648438 - response_length/max:709.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.304176688194275e-05 - timing_s/generate_sequences:19.870996475219727 - timing_s/reshard:0.7285621166229248 - timing_s/gen:24.23870204947889 - timing_s/reward:0.06529245711863041 - timing_s/old_log_prob:1.0515874903649092 - timing_s/ref:1.344829386100173 - timing_s/adv:0.007456418126821518 - timing_s/update_actor:6.874427014961839 - timing_s/testing:27.953065391629934 - timing_s/save_checkpoint:7.710438495501876 - timing_s/step:69.25931214541197 - timing_s/stop_profile:5.185417830944061e-05 - timing_per_token_ms/update_actor:0.033128491503758115 - timing_per_token_ms/gen:0.31728956906364314 - timing_per_token_ms/ref:0.006480855610868848 - timing_per_token_ms/adv:3.5933159814665065e-05 - perf/total_num_tokens:207508 - perf/time_per_step:69.25931214541197 - perf/throughput:374.512815627469
[36m(TaskRunner pid=2905377)[0m step:251 - global_seqlen/min:25086 - global_seqlen/max:28419 - global_seqlen/minmax_diff:3333 - global_seqlen/balanced_min:27036 - global_seqlen/balanced_max:27327 - global_seqlen/mean:27090.75 - actor/entropy:0.19510872662067413 - actor/kl_loss:0.7076293669641018 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0955814354121685 - actor/pg_clipfrac:0.004763316316530109 - actor/ppo_kl:-0.0013617732736747711 - actor/pg_clipfrac_lower:0.0007105158292688429 - actor/grad_norm:5.394342362880707 - perf/mfu/actor:0.07970342520549811 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.49627685546875 - actor/lr:1e-06 - training/global_step:251 - training/epoch:7 - critic/score/mean:0.9618749618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9618749618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.005798576399683952 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.005798576399683952 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:267.86248779296875 - response_length/max:1509.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.875582039356232e-05 - timing_s/generate_sequences:31.065282821655273 - timing_s/reshard:0.6033851504325867 - timing_s/gen:47.96087861806154 - timing_s/reward:0.06747237220406532 - timing_s/old_log_prob:1.0802222564816475 - timing_s/ref:1.3446250166743994 - timing_s/adv:0.008855607360601425 - timing_s/update_actor:7.243463471531868 - timing_s/step:57.72402475774288 - timing_s/stop_profile:4.640407860279083e-05 - timing_per_token_ms/update_actor:0.033422217322941726 - timing_per_token_ms/gen:0.5595323932295201 - timing_per_token_ms/ref:0.006204262601969304 - timing_per_token_ms/adv:4.086084438692831e-05 - perf/total_num_tokens:216726 - perf/time_per_step:57.72402475774288 - perf/throughput:469.3149882340134
[36m(TaskRunner pid=2905377)[0m Training Progress:  48%|████▊     | 252/525 [3:54:49<3:35:11, 47.30s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  48%|████▊     | 253/525 [3:55:21<3:14:52, 42.99s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  48%|████▊     | 254/525 [3:56:00<3:08:25, 41.72s/it]
[36m(TaskRunner pid=2905377)[0m step:252 - global_seqlen/min:21687 - global_seqlen/max:30810 - global_seqlen/minmax_diff:9123 - global_seqlen/balanced_min:25220 - global_seqlen/balanced_max:25261 - global_seqlen/mean:25227.625 - actor/entropy:0.22783763706684113 - actor/kl_loss:0.7272267274558544 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0068976256996393205 - actor/pg_clipfrac:0.007679531164467335 - actor/ppo_kl:-0.007257614633999765 - actor/pg_clipfrac_lower:0.000822022242937237 - actor/grad_norm:7.3787602186203 - perf/mfu/actor:0.0771203309726013 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.4621696472168 - actor/lr:1e-06 - training/global_step:252 - training/epoch:7 - critic/score/mean:1.0512499809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0512499809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.013341049663722515 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.013341049663722515 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:221.6125030517578 - response_length/max:939.0 - response_length/min:48.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.477883577346802e-05 - timing_s/generate_sequences:23.54499053955078 - timing_s/reshard:0.635253369808197 - timing_s/gen:32.461472073569894 - timing_s/reward:0.06527924351394176 - timing_s/old_log_prob:1.0737961195409298 - timing_s/ref:1.3673072960227728 - timing_s/adv:0.008276944980025291 - timing_s/update_actor:6.953768707811832 - timing_s/step:41.94757896102965 - timing_s/stop_profile:4.2226165533065796e-05 - timing_per_token_ms/update_actor:0.03445512958419507 - timing_per_token_ms/gen:0.45774538994824715 - timing_per_token_ms/ref:0.006774851457592484 - timing_per_token_ms/adv:4.101131686011511e-05 - perf/total_num_tokens:201821 - perf/time_per_step:41.94757896102965 - perf/throughput:601.4083678926285
[36m(TaskRunner pid=2905377)[0m step:253 - global_seqlen/min:24077 - global_seqlen/max:27749 - global_seqlen/minmax_diff:3672 - global_seqlen/balanced_min:25753 - global_seqlen/balanced_max:25754 - global_seqlen/mean:25753.5 - actor/entropy:0.2035377323627472 - actor/kl_loss:0.6293689027428627 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.007482054457068443 - actor/pg_clipfrac:0.018661590642295778 - actor/ppo_kl:-0.015478844776225742 - actor/pg_clipfrac_lower:0.0017491785518359392 - actor/grad_norm:7.188328385353088 - perf/mfu/actor:0.07828417578546319 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.54704666137695 - actor/lr:1e-06 - training/global_step:253 - training/epoch:7 - critic/score/mean:1.0625 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.010974817909300327 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.010974817909300327 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:234.75936889648438 - response_length/max:633.0 - response_length/min:69.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010243989527225494 - timing_s/generate_sequences:19.04547882080078 - timing_s/reshard:0.6240652799606323 - timing_s/gen:23.244647992774844 - timing_s/reward:0.06598669849336147 - timing_s/old_log_prob:1.1004440411925316 - timing_s/ref:1.35388757660985 - timing_s/adv:0.008438590914011002 - timing_s/update_actor:6.995204037055373 - timing_s/step:32.78729025274515 - timing_s/stop_profile:4.474632441997528e-05 - timing_per_token_ms/update_actor:0.03395268622252982 - timing_per_token_ms/gen:0.3094211891534529 - timing_per_token_ms/ref:0.006571376592549799 - timing_per_token_ms/adv:4.0958466392970864e-05 - perf/total_num_tokens:206028 - perf/time_per_step:32.78729025274515 - perf/throughput:785.4720472925865
[36m(TaskRunner pid=2905377)[0m step:254 - global_seqlen/min:22912 - global_seqlen/max:28719 - global_seqlen/minmax_diff:5807 - global_seqlen/balanced_min:25419 - global_seqlen/balanced_max:25420 - global_seqlen/mean:25419.75 - actor/entropy:0.21775546669960022 - actor/kl_loss:0.7352600425481797 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.026026345789432526 - actor/pg_clipfrac:0.011340347467921674 - actor/ppo_kl:0.039198264876904435 - actor/pg_clipfrac_lower:0.00013736264081671835 - actor/grad_norm:5.035022497177124 - perf/mfu/actor:0.07787962361668953 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55330276489258 - actor/lr:1e-06 - training/global_step:254 - training/epoch:7 - critic/score/mean:1.181249976158142 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.181249976158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.009859755635261536 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.009859755635261536 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:225.86874389648438 - response_length/max:843.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010917522013187408 - timing_s/generate_sequences:21.794275283813477 - timing_s/reshard:0.6572126150131226 - timing_s/gen:29.04607737995684 - timing_s/reward:0.06663036346435547 - timing_s/old_log_prob:1.099073076620698 - timing_s/ref:1.3466503340750933 - timing_s/adv:0.0083981454372406 - timing_s/update_actor:6.938721716403961 - timing_s/step:38.523299833759665 - timing_s/stop_profile:4.280172288417816e-05 - timing_per_token_ms/update_actor:0.03412072166526009 - timing_per_token_ms/gen:0.40186609175623067 - timing_per_token_ms/ref:0.0066220671627135064 - timing_per_token_ms/adv:4.129734476755574e-05 - perf/total_num_tokens:203358 - perf/time_per_step:38.523299833759665 - perf/throughput:659.8539094442671
[36m(TaskRunner pid=2905377)[0m Training Progress:  49%|████▊     | 255/525 [3:56:49<3:16:49, 43.74s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  49%|████▉     | 256/525 [3:57:27<3:08:38, 42.08s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  49%|████▉     | 257/525 [3:58:08<3:06:14, 41.69s/it]
[36m(TaskRunner pid=2905377)[0m step:255 - global_seqlen/min:23560 - global_seqlen/max:28404 - global_seqlen/minmax_diff:4844 - global_seqlen/balanced_min:25662 - global_seqlen/balanced_max:25711 - global_seqlen/mean:25668.75 - actor/entropy:0.21433322131633759 - actor/kl_loss:0.7028945215046406 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.01580453459173441 - actor/pg_clipfrac:0.017794312408659606 - actor/ppo_kl:0.041974341263994575 - actor/pg_clipfrac_lower:0.0003348234575241804 - actor/grad_norm:5.414667427539825 - perf/mfu/actor:0.07774994548647235 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55704498291016 - actor/lr:1e-06 - training/global_step:255 - training/epoch:7 - critic/score/mean:1.053125023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.053125023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.0009551859693601727 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0009551859693601727 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:231.65625 - response_length/max:1226.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.819865226745605e-05 - timing_s/generate_sequences:27.85411834716797 - timing_s/reshard:0.6458413600921631 - timing_s/gen:38.86548549309373 - timing_s/reward:0.06553761288523674 - timing_s/old_log_prob:1.0877898428589106 - timing_s/ref:1.3656173646450043 - timing_s/adv:0.008433397859334946 - timing_s/update_actor:7.0246636010706425 - timing_s/step:48.43537424504757 - timing_s/stop_profile:4.0942803025245667e-05 - timing_per_token_ms/update_actor:0.0342082473877314 - timing_per_token_ms/gen:0.5242882165532676 - timing_per_token_ms/ref:0.006650194130241073 - timing_per_token_ms/adv:4.106840934665179e-05 - perf/total_num_tokens:205350 - perf/time_per_step:48.43537424504757 - perf/throughput:529.9587419338374
[36m(TaskRunner pid=2905377)[0m step:256 - global_seqlen/min:23037 - global_seqlen/max:28545 - global_seqlen/minmax_diff:5508 - global_seqlen/balanced_min:25906 - global_seqlen/balanced_max:25910 - global_seqlen/mean:25907.5 - actor/entropy:0.2230096161365509 - actor/kl_loss:0.7777061738073826 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.018474236223846675 - actor/pg_clipfrac:0.012941100948955864 - actor/ppo_kl:-0.0028943717159563677 - actor/pg_clipfrac_lower:0.000659674993949011 - actor/grad_norm:5.079910039901733 - perf/mfu/actor:0.078599124458411 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.61811065673828 - actor/lr:1e-06 - training/global_step:256 - training/epoch:7 - critic/score/mean:0.9993749856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9993749856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0034447063226252794 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0034447063226252794 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:238.0625 - response_length/max:833.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010969489812850952 - timing_s/generate_sequences:23.633874893188477 - timing_s/reshard:0.6372414231300354 - timing_s/gen:28.299086207523942 - timing_s/reward:0.06639745458960533 - timing_s/old_log_prob:1.2272987328469753 - timing_s/ref:1.3533203471451998 - timing_s/adv:0.008267134428024292 - timing_s/update_actor:7.009154902771115 - timing_s/step:37.982303565368056 - timing_s/stop_profile:4.186108708381653e-05 - timing_per_token_ms/update_actor:0.03381817476971492 - timing_per_token_ms/gen:0.3714765845041211 - timing_per_token_ms/ref:0.006529578052423043 - timing_per_token_ms/adv:3.988774692668287e-05 - perf/total_num_tokens:207260 - perf/time_per_step:37.982303565368056 - perf/throughput:682.093963980169
[36m(TaskRunner pid=2905377)[0m step:257 - global_seqlen/min:23877 - global_seqlen/max:26806 - global_seqlen/minmax_diff:2929 - global_seqlen/balanced_min:25271 - global_seqlen/balanced_max:25272 - global_seqlen/mean:25271.5 - actor/entropy:0.23339660465717316 - actor/kl_loss:0.770167687162757 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05935535244643688 - actor/pg_clipfrac:0.015130821662023664 - actor/ppo_kl:-0.02046621390618384 - actor/pg_clipfrac_lower:0.0009375465626362712 - actor/grad_norm:10.169955134391785 - perf/mfu/actor:0.0766046590828895 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.70354080200195 - actor/lr:1e-06 - training/global_step:257 - training/epoch:7 - critic/score/mean:1.084375023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.084375023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0017215210245922208 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0017215210245922208 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:223.03750610351562 - response_length/max:901.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001071002334356308 - timing_s/generate_sequences:21.828384399414062 - timing_s/reshard:0.64825439453125 - timing_s/gen:30.84870783984661 - timing_s/reward:0.06553481332957745 - timing_s/old_log_prob:1.2080667652189732 - timing_s/ref:1.3520855400711298 - timing_s/adv:0.008219916373491287 - timing_s/update_actor:7.012248331680894 - timing_s/step:40.51200936362147 - timing_s/stop_profile:4.3530017137527466e-05 - timing_per_token_ms/update_actor:0.034684567257982774 - timing_per_token_ms/gen:0.432224231349081 - timing_per_token_ms/ref:0.0066877982117757645 - timing_per_token_ms/adv:4.065803560083141e-05 - perf/total_num_tokens:202172 - perf/time_per_step:40.51200936362147 - perf/throughput:623.8026796738703
[36m(TaskRunner pid=2905377)[0m Training Progress:  49%|████▉     | 258/525 [3:58:47<3:02:23, 40.99s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  49%|████▉     | 259/525 [3:59:33<3:08:22, 42.49s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:01:19,133:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 15:01:22,898:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 15:01:22,902:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:01:23,647:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  50%|████▉     | 260/525 [4:00:28<3:23:58, 46.18s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:01:19,400:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:258 - global_seqlen/min:23915 - global_seqlen/max:27742 - global_seqlen/minmax_diff:3827 - global_seqlen/balanced_min:25570 - global_seqlen/balanced_max:25571 - global_seqlen/mean:25570.25 - actor/entropy:0.2405869960784912 - actor/kl_loss:0.7485251858830452 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08529970541130752 - actor/pg_clipfrac:0.018382616550661625 - actor/ppo_kl:0.043155345102422873 - actor/pg_clipfrac_lower:0.00043380082352086904 - actor/grad_norm:4.42170649766922 - perf/mfu/actor:0.07774224427929824 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.77120971679688 - actor/lr:1e-06 - training/global_step:258 - training/epoch:7 - critic/score/mean:1.0825001001358032 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0825001001358032 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01455447357147932 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01455447357147932 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:229.41250610351562 - response_length/max:871.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.397044777870178e-05 - timing_s/generate_sequences:24.29334259033203 - timing_s/reshard:0.6391787528991699 - timing_s/gen:29.71342008933425 - timing_s/reward:0.06623722426593304 - timing_s/old_log_prob:1.1670425944030285 - timing_s/ref:1.3528890274465084 - timing_s/adv:0.00824776105582714 - timing_s/update_actor:6.993491970002651 - timing_s/step:39.318932607769966 - timing_s/stop_profile:5.5886805057525635e-05 - timing_per_token_ms/update_actor:0.034187639786483565 - timing_per_token_ms/gen:0.40474881612453345 - timing_per_token_ms/ref:0.006613589168303538 - timing_per_token_ms/adv:4.0319126014739494e-05 - perf/total_num_tokens:204562 - perf/time_per_step:39.318932607769966 - perf/throughput:650.3292003137177
[36m(TaskRunner pid=2905377)[0m step:259 - global_seqlen/min:21772 - global_seqlen/max:27020 - global_seqlen/minmax_diff:5248 - global_seqlen/balanced_min:24876 - global_seqlen/balanced_max:25117 - global_seqlen/mean:24906.5 - actor/entropy:0.2619394361972809 - actor/kl_loss:0.7335860081017017 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.007388026267290115 - actor/pg_clipfrac:0.011374853481538594 - actor/ppo_kl:-0.0353010855964385 - actor/pg_clipfrac_lower:0.002874225564301014 - actor/grad_norm:6.542884290218353 - perf/mfu/actor:0.07516365635139463 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.81427383422852 - actor/lr:1e-06 - training/global_step:259 - training/epoch:7 - critic/score/mean:1.0187499523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0187499523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.014397292397916317 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.014397292397916317 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:212.92813110351562 - response_length/max:1123.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.243004024028778e-05 - timing_s/generate_sequences:24.37229347229004 - timing_s/reshard:0.6522231698036194 - timing_s/gen:36.42633845284581 - timing_s/reward:0.06496156752109528 - timing_s/old_log_prob:1.0738778077065945 - timing_s/ref:1.3516641296446323 - timing_s/adv:0.008263269439339638 - timing_s/update_actor:7.040465978905559 - timing_s/step:45.98294729553163 - timing_s/stop_profile:4.2321160435676575e-05 - timing_per_token_ms/update_actor:0.0353344808529177 - timing_per_token_ms/gen:0.5346043772523859 - timing_per_token_ms/ref:0.00678369165501291 - timing_per_token_ms/adv:4.1471450421273755e-05 - perf/total_num_tokens:199252 - perf/time_per_step:45.98294729553163 - perf/throughput:541.6464464516888
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260
[36m(TaskRunner pid=2905377)[0m step:260 - global_seqlen/min:24783 - global_seqlen/max:28300 - global_seqlen/minmax_diff:3517 - global_seqlen/balanced_min:26172 - global_seqlen/balanced_max:26276 - global_seqlen/mean:26192.625 - actor/entropy:0.2103588730096817 - actor/kl_loss:0.7001343965530396 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10084851835854351 - actor/pg_clipfrac:0.01791184808826074 - actor/ppo_kl:0.05538847378920764 - actor/pg_clipfrac_lower:0.001318001956678927 - actor/grad_norm:4.713222324848175 - perf/mfu/actor:0.07628859301719511 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.80414962768555 - actor/lr:1e-06 - training/global_step:260 - training/epoch:7 - critic/score/mean:1.0368750095367432 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0368750095367432 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.010552302934229374 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.010552302934229374 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:244.7531280517578 - response_length/max:1126.0 - response_length/min:7.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.584613144397736e-05 - timing_s/generate_sequences:25.712116241455078 - timing_s/reshard:0.668887734413147 - timing_s/gen:37.00211085006595 - timing_s/reward:0.06722908467054367 - timing_s/old_log_prob:1.145253099501133 - timing_s/ref:1.3646425269544125 - timing_s/adv:0.008395535871386528 - timing_s/update_actor:7.305695299059153 - timing_s/save_checkpoint:7.877789489924908 - timing_s/step:54.788776226341724 - timing_s/stop_profile:4.635564982891083e-05 - timing_per_token_ms/update_actor:0.034865230666357196 - timing_per_token_ms/gen:0.4724417570008803 - timing_per_token_ms/ref:0.006512532282247448 - timing_per_token_ms/adv:4.0066315763437837e-05 - perf/total_num_tokens:209541 - perf/time_per_step:54.788776226341724 - perf/throughput:478.06552370861186
[36m(TaskRunner pid=2905377)[0m Training Progress:  50%|████▉     | 261/525 [4:01:01<3:05:37, 42.19s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:01:24,299:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:01:24,303:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_260/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  50%|████▉     | 262/525 [4:01:35<2:54:56, 39.91s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  50%|█████     | 263/525 [4:02:11<2:49:19, 38.78s/it]
[36m(TaskRunner pid=2905377)[0m step:261 - global_seqlen/min:23378 - global_seqlen/max:27174 - global_seqlen/minmax_diff:3796 - global_seqlen/balanced_min:24960 - global_seqlen/balanced_max:24961 - global_seqlen/mean:24960.75 - actor/entropy:0.21622434258460999 - actor/kl_loss:0.822264912724495 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04478765875101089 - actor/pg_clipfrac:0.01272614668123424 - actor/ppo_kl:0.02658075967920013 - actor/pg_clipfrac_lower:0.0021032685763202608 - actor/grad_norm:8.313491106033325 - perf/mfu/actor:0.07515704533730555 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.56829833984375 - actor/lr:1e-06 - training/global_step:261 - training/epoch:7 - critic/score/mean:1.0656249523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0656249523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0024794007185846567 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0024794007185846567 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:214.6125030517578 - response_length/max:653.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001072511076927185 - timing_s/generate_sequences:19.061981201171875 - timing_s/reshard:0.7077841758728027 - timing_s/gen:23.084434375166893 - timing_s/reward:0.08693163469433784 - timing_s/old_log_prob:1.1324134934693575 - timing_s/ref:1.3542192671447992 - timing_s/adv:0.008409231901168823 - timing_s/update_actor:7.055416082963347 - timing_s/step:32.74170523136854 - timing_s/stop_profile:4.347413778305054e-05 - timing_per_token_ms/update_actor:0.03533255252227671 - timing_per_token_ms/gen:0.3361353948274054 - timing_per_token_ms/ref:0.006781743673291063 - timing_per_token_ms/adv:4.2112275778816856e-05 - perf/total_num_tokens:199686 - perf/time_per_step:32.74170523136854 - perf/throughput:762.3533906867528
[36m(TaskRunner pid=2905377)[0m step:262 - global_seqlen/min:22519 - global_seqlen/max:26772 - global_seqlen/minmax_diff:4253 - global_seqlen/balanced_min:25003 - global_seqlen/balanced_max:25004 - global_seqlen/mean:25003.875 - actor/entropy:0.2242124229669571 - actor/kl_loss:1.0228461869060994 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.169316466152668 - actor/pg_clipfrac:0.03802681034430862 - actor/ppo_kl:0.15865808617963922 - actor/pg_clipfrac_lower:0.0024781481013633313 - actor/grad_norm:7.495734930038452 - perf/mfu/actor:0.07590256271690443 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.61812591552734 - actor/lr:1e-06 - training/global_step:262 - training/epoch:7 - critic/score/mean:1.064062476158142 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.064062476158142 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.01188419945538044 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.01188419945538044 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:215.9093780517578 - response_length/max:720.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010619498789310455 - timing_s/generate_sequences:19.503725051879883 - timing_s/reshard:0.6677411198616028 - timing_s/gen:24.90639978274703 - timing_s/reward:0.06418754905462265 - timing_s/old_log_prob:1.0577215570956469 - timing_s/ref:1.3526280540972948 - timing_s/adv:0.008216449990868568 - timing_s/update_actor:6.998690586537123 - timing_s/step:34.40587093681097 - timing_s/stop_profile:4.192441701889038e-05 - timing_per_token_ms/update_actor:0.03498802978806846 - timing_per_token_ms/gen:0.36048689095174524 - timing_per_token_ms/ref:0.006762092146203813 - timing_per_token_ms/adv:4.107588319244801e-05 - perf/total_num_tokens:200031 - perf/time_per_step:34.40587093681097 - perf/throughput:726.7328022569619
[36m(TaskRunner pid=2905377)[0m step:263 - global_seqlen/min:23147 - global_seqlen/max:27933 - global_seqlen/minmax_diff:4786 - global_seqlen/balanced_min:24987 - global_seqlen/balanced_max:24998 - global_seqlen/mean:24988.625 - actor/entropy:0.19012244045734406 - actor/kl_loss:0.9085514709353447 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1786812987178564 - actor/pg_clipfrac:0.008937436039559543 - actor/ppo_kl:0.03829918751725927 - actor/pg_clipfrac_lower:0.0002702702768146992 - actor/grad_norm:7.19825953245163 - perf/mfu/actor:0.0756067359241069 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.6728744506836 - actor/lr:1e-06 - training/global_step:263 - training/epoch:7 - critic/score/mean:1.0309375524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0309375524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.03020576946437359 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.03020576946437359 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:215.5281219482422 - response_length/max:768.0 - response_length/min:49.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.567290544509888e-05 - timing_s/generate_sequences:18.666141510009766 - timing_s/reshard:0.661872923374176 - timing_s/gen:26.555512327700853 - timing_s/reward:0.06532244198024273 - timing_s/old_log_prob:1.0908122844994068 - timing_s/ref:1.3500893451273441 - timing_s/adv:0.00849120132625103 - timing_s/update_actor:7.0212933123111725 - timing_s/step:36.10874515585601 - timing_s/stop_profile:4.1682273149490356e-05 - timing_per_token_ms/update_actor:0.03512244727506602 - timing_per_token_ms/gen:0.38503548445969715 - timing_per_token_ms/ref:0.006753519577044276 - timing_per_token_ms/adv:4.247533290772817e-05 - perf/total_num_tokens:199909 - perf/time_per_step:36.10874515585601 - perf/throughput:692.0380337821686
[36m(TaskRunner pid=2905377)[0m Training Progress:  50%|█████     | 264/525 [4:02:42<2:37:54, 36.30s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  50%|█████     | 265/525 [4:03:16<2:33:46, 35.49s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  51%|█████     | 266/525 [4:03:49<2:30:49, 34.94s/it]
[36m(TaskRunner pid=2905377)[0m step:264 - global_seqlen/min:22523 - global_seqlen/max:25160 - global_seqlen/minmax_diff:2637 - global_seqlen/balanced_min:23820 - global_seqlen/balanced_max:23821 - global_seqlen/mean:23820.875 - actor/entropy:0.20500291883945465 - actor/kl_loss:0.930340451747179 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05680260136723518 - actor/pg_clipfrac:0.015385619923472404 - actor/ppo_kl:-0.03820300152874552 - actor/pg_clipfrac_lower:0.0021350725553929807 - actor/grad_norm:9.497751832008362 - perf/mfu/actor:0.07148971569225049 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.64524459838867 - actor/lr:1e-06 - training/global_step:264 - training/epoch:7 - critic/score/mean:1.0387500524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0387500524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.011418547481298447 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.011418547481298447 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:186.00625610351562 - response_length/max:565.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010582245886325836 - timing_s/generate_sequences:16.781543731689453 - timing_s/reshard:0.6246848106384277 - timing_s/gen:20.662028005346656 - timing_s/reward:0.06248100474476814 - timing_s/old_log_prob:1.1532364506274462 - timing_s/ref:1.3426674362272024 - timing_s/adv:0.008262939751148224 - timing_s/update_actor:7.070538120344281 - timing_s/step:30.316849602386355 - timing_s/stop_profile:4.3878331780433655e-05 - timing_per_token_ms/update_actor:0.037102636449879996 - timing_per_token_ms/gen:0.3471326233215728 - timing_per_token_ms/ref:0.0070456450289252725 - timing_per_token_ms/adv:4.335976192702947e-05 - perf/total_num_tokens:190567 - perf/time_per_step:30.316849602386355 - perf/throughput:785.7305528911212
[36m(TaskRunner pid=2905377)[0m step:265 - global_seqlen/min:23751 - global_seqlen/max:28650 - global_seqlen/minmax_diff:4899 - global_seqlen/balanced_min:25740 - global_seqlen/balanced_max:25741 - global_seqlen/mean:25740.25 - actor/entropy:0.17710071802139282 - actor/kl_loss:0.8646164618432521 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.028515001758933067 - actor/pg_clipfrac:0.014286477374844253 - actor/ppo_kl:0.02587204691080842 - actor/pg_clipfrac_lower:0.0006489850813522935 - actor/grad_norm:6.970282554626465 - perf/mfu/actor:0.07451360954476795 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.68093872070312 - actor/lr:1e-06 - training/global_step:265 - training/epoch:7 - critic/score/mean:1.03125 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.03125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.008036422543227673 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.008036422543227673 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:234.42813110351562 - response_length/max:632.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010864995419979095 - timing_s/generate_sequences:18.901737213134766 - timing_s/reshard:0.6577627062797546 - timing_s/gen:23.43791565671563 - timing_s/reward:0.06827224791049957 - timing_s/old_log_prob:1.0749524310231209 - timing_s/ref:1.3495765551924706 - timing_s/adv:0.008196910843253136 - timing_s/update_actor:7.346205731853843 - timing_s/step:33.30435091815889 - timing_s/stop_profile:4.477985203266144e-05 - timing_per_token_ms/update_actor:0.03567470076948477 - timing_per_token_ms/gen:0.31243472355220325 - timing_per_token_ms/ref:0.006553824045961435 - timing_per_token_ms/adv:3.980590147363145e-05 - perf/total_num_tokens:205922 - perf/time_per_step:33.30435091815889 - perf/throughput:772.8794974342336
[36m(TaskRunner pid=2905377)[0m step:266 - global_seqlen/min:22933 - global_seqlen/max:28483 - global_seqlen/minmax_diff:5550 - global_seqlen/balanced_min:25643 - global_seqlen/balanced_max:25644 - global_seqlen/mean:25643.125 - actor/entropy:0.20738817751407623 - actor/kl_loss:0.8244736067950725 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05704476162791252 - actor/pg_clipfrac:0.014659159677103161 - actor/ppo_kl:0.07762267687649001 - actor/pg_clipfrac_lower:0.0011577293975278736 - actor/grad_norm:8.918740689754486 - perf/mfu/actor:0.07754239010402897 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.6785659790039 - actor/lr:1e-06 - training/global_step:266 - training/epoch:7 - critic/score/mean:1.0449999570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0449999570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.002480186987668276 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.002480186987668276 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:231.453125 - response_length/max:671.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.718909859657288e-05 - timing_s/generate_sequences:18.817703247070312 - timing_s/reshard:0.6914944052696228 - timing_s/gen:24.1119046472013 - timing_s/reward:0.06613168492913246 - timing_s/old_log_prob:1.0695176217705011 - timing_s/ref:1.350030967965722 - timing_s/adv:0.008241605013608932 - timing_s/update_actor:7.030413771048188 - timing_s/step:33.65362940914929 - timing_s/stop_profile:4.4871121644973755e-05 - timing_per_token_ms/update_actor:0.0342704612398459 - timing_per_token_ms/gen:0.32555059268482145 - timing_per_token_ms/ref:0.006580862160743484 - timing_per_token_ms/adv:4.017453515127803e-05 - perf/total_num_tokens:205145 - perf/time_per_step:33.65362940914929 - perf/throughput:761.9720502724886
[36m(TaskRunner pid=2905377)[0m Training Progress:  51%|█████     | 267/525 [4:04:25<2:31:54, 35.33s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  51%|█████     | 268/525 [4:05:01<2:31:27, 35.36s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  51%|█████     | 269/525 [4:05:35<2:29:33, 35.05s/it]
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 15:07:09,680:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 15:07:13,944:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 15:07:13,947:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 15:07:10,135:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:07:15,181:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:267 - global_seqlen/min:24372 - global_seqlen/max:27232 - global_seqlen/minmax_diff:2860 - global_seqlen/balanced_min:25796 - global_seqlen/balanced_max:25797 - global_seqlen/mean:25796.625 - actor/entropy:0.1929992288351059 - actor/kl_loss:0.7938293680548668 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03113892152905464 - actor/pg_clipfrac:0.011217394541017712 - actor/ppo_kl:0.047322196571622045 - actor/pg_clipfrac_lower:0.00015873016091063618 - actor/grad_norm:3.961503267288208 - perf/mfu/actor:0.07857246723090835 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.66658020019531 - actor/lr:1e-06 - training/global_step:267 - training/epoch:7 - critic/score/mean:0.9571874737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9571874737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008082571439445019 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008082571439445019 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:235.18124389648438 - response_length/max:741.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.203702211380005e-05 - timing_s/generate_sequences:19.777591705322266 - timing_s/reshard:0.6350304484367371 - timing_s/gen:26.56327361240983 - timing_s/reward:0.06579484604299068 - timing_s/old_log_prob:1.2287693731486797 - timing_s/ref:1.3508211970329285 - timing_s/adv:0.00835101306438446 - timing_s/update_actor:6.983962316066027 - timing_s/step:36.21934420801699 - timing_s/stop_profile:4.545971751213074e-05 - timing_per_token_ms/update_actor:0.03384145365947109 - timing_per_token_ms/gen:0.3529627895029077 - timing_per_token_ms/ref:0.006545532589209482 - timing_per_token_ms/adv:4.046562808305573e-05 - perf/total_num_tokens:206373 - perf/time_per_step:36.21934420801699 - perf/throughput:712.2333538631556
[36m(TaskRunner pid=2905377)[0m step:268 - global_seqlen/min:22606 - global_seqlen/max:27849 - global_seqlen/minmax_diff:5243 - global_seqlen/balanced_min:25116 - global_seqlen/balanced_max:25161 - global_seqlen/mean:25138.75 - actor/entropy:0.21659596264362335 - actor/kl_loss:1.0379599004983902 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07695446275174618 - actor/pg_clipfrac:0.01640813092235476 - actor/ppo_kl:0.10284782809903845 - actor/pg_clipfrac_lower:0.00048569628270342944 - actor/grad_norm:7.167171657085419 - perf/mfu/actor:0.07660229188101927 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.72900009155273 - actor/lr:1e-06 - training/global_step:268 - training/epoch:7 - critic/score/mean:0.909375011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.909375011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.003775989869609475 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.003775989869609475 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:218.734375 - response_length/max:723.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.295716881752014e-05 - timing_s/generate_sequences:19.67877197265625 - timing_s/reshard:0.6347199082374573 - timing_s/gen:25.94018704071641 - timing_s/reward:0.06487069837749004 - timing_s/old_log_prob:1.0732913613319397 - timing_s/ref:1.3475589957088232 - timing_s/adv:0.00838276743888855 - timing_s/update_actor:6.973056174814701 - timing_s/step:35.42481769435108 - timing_s/stop_profile:4.179961979389191e-05 - timing_per_token_ms/update_actor:0.03467284657557904 - timing_per_token_ms/gen:0.3706005720510952 - timing_per_token_ms/ref:0.006700606611848358 - timing_per_token_ms/adv:4.1682499323199e-05 - perf/total_num_tokens:201110 - perf/time_per_step:35.42481769435108 - perf/throughput:709.6366794855428
[36m(TaskRunner pid=2905377)[0m step:269 - global_seqlen/min:23792 - global_seqlen/max:27707 - global_seqlen/minmax_diff:3915 - global_seqlen/balanced_min:25126 - global_seqlen/balanced_max:25127 - global_seqlen/mean:25126.125 - actor/entropy:0.19639433920383453 - actor/kl_loss:0.7996158093214035 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.20349933239631354 - actor/pg_clipfrac:0.014032566547393798 - actor/ppo_kl:0.01608710812361096 - actor/pg_clipfrac_lower:0.0012483426835387945 - actor/grad_norm:10.58068335056305 - perf/mfu/actor:0.07655131860005941 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.76462173461914 - actor/lr:1e-06 - training/global_step:269 - training/epoch:7 - critic/score/mean:0.9075000882148743 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9075000882148743 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.015743348747491837 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.015743348747491837 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:218.4187469482422 - response_length/max:724.0 - response_length/min:7.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011203065514564514 - timing_s/generate_sequences:20.541074752807617 - timing_s/reshard:0.636864185333252 - timing_s/gen:24.731642799451947 - timing_s/reward:0.06543813459575176 - timing_s/old_log_prob:1.0773981679230928 - timing_s/ref:1.3454495817422867 - timing_s/adv:0.0084056556224823 - timing_s/update_actor:6.976491576060653 - timing_s/step:34.22231074422598 - timing_s/stop_profile:4.476308822631836e-05 - timing_per_token_ms/update_actor:0.03470735925287252 - timing_per_token_ms/gen:0.3538450052858893 - timing_per_token_ms/ref:0.006693479305614608 - timing_per_token_ms/adv:4.181730978454845e-05 - perf/total_num_tokens:201009 - perf/time_per_step:34.22231074422598 - perf/throughput:734.2030521489348
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270
[36m(TaskRunner pid=2905377)[0m Training Progress:  51%|█████▏    | 270/525 [4:06:20<2:41:11, 37.93s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  52%|█████▏    | 271/525 [4:06:52<2:33:15, 36.20s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:07:16,312:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:07:16,314:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_270/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  52%|█████▏    | 272/525 [4:07:33<2:38:45, 37.65s/it]
[36m(TaskRunner pid=2905377)[0m step:270 - global_seqlen/min:22863 - global_seqlen/max:26790 - global_seqlen/minmax_diff:3927 - global_seqlen/balanced_min:25028 - global_seqlen/balanced_max:25029 - global_seqlen/mean:25028.375 - actor/entropy:0.22286924719810486 - actor/kl_loss:0.8477386087179184 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0088102288544178 - actor/pg_clipfrac:0.016304099874105304 - actor/ppo_kl:0.02045585275045596 - actor/pg_clipfrac_lower:0.0005371486186049879 - actor/grad_norm:8.466306686401367 - perf/mfu/actor:0.07373101468800157 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.8036880493164 - actor/lr:1e-06 - training/global_step:270 - training/epoch:7 - critic/score/mean:0.9981250762939453 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9981250762939453 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.01971852220594883 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.01971852220594883 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:215.97500610351562 - response_length/max:708.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011055916547775269 - timing_s/generate_sequences:18.302818298339844 - timing_s/reshard:0.7289668917655945 - timing_s/gen:25.38755314797163 - timing_s/reward:0.0645414236932993 - timing_s/old_log_prob:1.0697247870266438 - timing_s/ref:1.3511818405240774 - timing_s/adv:0.008672365918755531 - timing_s/update_actor:7.211905585601926 - timing_s/save_checkpoint:9.310267986729741 - timing_s/step:44.421638902276754 - timing_s/stop_profile:4.985928535461426e-05 - timing_per_token_ms/update_actor:0.036018646763932564 - timing_per_token_ms/gen:0.3673392919894031 - timing_per_token_ms/ref:0.00674824993893969 - timing_per_token_ms/adv:4.331266971365266e-05 - perf/total_num_tokens:200227 - perf/time_per_step:44.421638902276754 - perf/throughput:563.4275460898677
[36m(TaskRunner pid=2905377)[0m step:271 - global_seqlen/min:21929 - global_seqlen/max:26234 - global_seqlen/minmax_diff:4305 - global_seqlen/balanced_min:24322 - global_seqlen/balanced_max:24323 - global_seqlen/mean:24322.25 - actor/entropy:0.2510879337787628 - actor/kl_loss:1.101006242632866 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09928867481648922 - actor/pg_clipfrac:0.01769071912858635 - actor/ppo_kl:-0.04784488995137508 - actor/pg_clipfrac_lower:0.002393775311065838 - actor/grad_norm:8.224144101142883 - perf/mfu/actor:0.073887091811922 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.75955963134766 - actor/lr:1e-06 - training/global_step:271 - training/epoch:7 - critic/score/mean:0.8843749761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.8843749761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.009337205439805984 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.009337205439805984 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:198.10311889648438 - response_length/max:627.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.087100625038147e-05 - timing_s/generate_sequences:18.833433151245117 - timing_s/reshard:0.640576183795929 - timing_s/gen:22.65159741230309 - timing_s/reward:0.06315000168979168 - timing_s/old_log_prob:1.0675787329673767 - timing_s/ref:1.3622660506516695 - timing_s/adv:0.008412960916757584 - timing_s/update_actor:6.9879023265093565 - timing_s/step:32.158235060051084 - timing_s/stop_profile:4.1935592889785767e-05 - timing_per_token_ms/update_actor:0.035913116213083476 - timing_per_token_ms/gen:0.35732016803595174 - timing_per_token_ms/ref:0.007001130912290544 - timing_per_token_ms/adv:4.3236958529523295e-05 - perf/total_num_tokens:194578 - perf/time_per_step:32.158235060051084 - perf/throughput:756.3303755501986
[36m(TaskRunner pid=2905377)[0m step:272 - global_seqlen/min:22856 - global_seqlen/max:27376 - global_seqlen/minmax_diff:4520 - global_seqlen/balanced_min:24892 - global_seqlen/balanced_max:24903 - global_seqlen/mean:24894.0 - actor/entropy:0.17741499841213226 - actor/kl_loss:1.057316805422306 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.010310964658856392 - actor/pg_clipfrac:0.012868885893840342 - actor/ppo_kl:0.06273518247471657 - actor/pg_clipfrac_lower:0.0007301729754544794 - actor/grad_norm:8.058550000190735 - perf/mfu/actor:0.0741953744866118 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.78480911254883 - actor/lr:1e-06 - training/global_step:272 - training/epoch:7 - critic/score/mean:1.0812499523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0812499523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.006551574449986219 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.006551574449986219 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:213.49063110351562 - response_length/max:925.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011019967496395111 - timing_s/generate_sequences:24.774154663085938 - timing_s/reshard:0.8147980570793152 - timing_s/gen:31.174344655126333 - timing_s/reward:0.0640318151563406 - timing_s/old_log_prob:1.0888606738299131 - timing_s/ref:1.3484256900846958 - timing_s/adv:0.008337525650858879 - timing_s/update_actor:7.1293053068220615 - timing_s/step:40.830836879089475 - timing_s/stop_profile:4.338100552558899e-05 - timing_per_token_ms/update_actor:0.0357983113743375 - timing_per_token_ms/gen:0.4563189931514313 - timing_per_token_ms/ref:0.006770836798448902 - timing_per_token_ms/adv:4.186513643276934e-05 - perf/total_num_tokens:199152 - perf/time_per_step:40.830836879089475 - perf/throughput:609.6862543796858
[36m(TaskRunner pid=2905377)[0m Training Progress:  52%|█████▏    | 273/525 [4:08:04<2:29:33, 35.61s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  52%|█████▏    | 274/525 [4:08:37<2:25:44, 34.84s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  52%|█████▏    | 275/525 [4:09:14<2:28:30, 35.64s/it]
[36m(TaskRunner pid=2905377)[0m step:273 - global_seqlen/min:22875 - global_seqlen/max:26013 - global_seqlen/minmax_diff:3138 - global_seqlen/balanced_min:25111 - global_seqlen/balanced_max:25111 - global_seqlen/mean:25111.0 - actor/entropy:0.2223781794309616 - actor/kl_loss:0.9733382888138294 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05825099088251591 - actor/pg_clipfrac:0.011672543245367706 - actor/ppo_kl:0.01421823218697682 - actor/pg_clipfrac_lower:0.0012597122578881681 - actor/grad_norm:7.936563849449158 - perf/mfu/actor:0.07598946175258238 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.81273651123047 - actor/lr:1e-06 - training/global_step:273 - training/epoch:7 - critic/score/mean:1.0356249809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0356249809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0012941736495122313 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0012941736495122313 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:217.93124389648438 - response_length/max:577.0 - response_length/min:44.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011112727224826813 - timing_s/generate_sequences:17.691143035888672 - timing_s/reshard:0.6502338647842407 - timing_s/gen:21.028491832315922 - timing_s/reward:0.06628137268126011 - timing_s/old_log_prob:1.0720652304589748 - timing_s/ref:1.3473097886890173 - timing_s/adv:0.008226647973060608 - timing_s/update_actor:7.021298613399267 - timing_s/step:30.561250910162926 - timing_s/stop_profile:4.3138861656188965e-05 - timing_per_token_ms/update_actor:0.03495130925390898 - timing_per_token_ms/gen:0.30153563096612923 - timing_per_token_ms/ref:0.006706770880734625 - timing_per_token_ms/adv:4.095141558012727e-05 - perf/total_num_tokens:200888 - perf/time_per_step:30.561250910162926 - perf/throughput:821.6613931745025
[36m(TaskRunner pid=2905377)[0m step:274 - global_seqlen/min:21686 - global_seqlen/max:26390 - global_seqlen/minmax_diff:4704 - global_seqlen/balanced_min:23829 - global_seqlen/balanced_max:23830 - global_seqlen/mean:23829.625 - actor/entropy:0.20110709965229034 - actor/kl_loss:1.1781732019037008 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06955010220408439 - actor/pg_clipfrac:0.008305491786450148 - actor/ppo_kl:-0.01122877958259778 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.088691711425781 - perf/mfu/actor:0.07294176489325972 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.82364273071289 - actor/lr:1e-06 - training/global_step:274 - training/epoch:7 - critic/score/mean:1.1062500476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.1062500476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.007781990338116884 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.007781990338116884 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:187.31875610351562 - response_length/max:669.0 - response_length/min:19.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.421875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.779632091522217e-05 - timing_s/generate_sequences:18.860069274902344 - timing_s/reshard:0.6345974206924438 - timing_s/gen:23.58565403148532 - timing_s/reward:0.061885641887784004 - timing_s/old_log_prob:1.0633275546133518 - timing_s/ref:1.3559900969266891 - timing_s/adv:0.008308662101626396 - timing_s/update_actor:6.932259326800704 - timing_s/step:33.0251535680145 - timing_s/stop_profile:4.620850086212158e-05 - timing_per_token_ms/update_actor:0.036363661444529155 - timing_per_token_ms/gen:0.39347459263096524 - timing_per_token_ms/ref:0.007112942906816039 - timing_per_token_ms/adv:4.3583680511266945e-05 - perf/total_num_tokens:190637 - perf/time_per_step:33.0251535680145 - perf/throughput:721.5598543977537
[36m(TaskRunner pid=2905377)[0m step:275 - global_seqlen/min:22802 - global_seqlen/max:27064 - global_seqlen/minmax_diff:4262 - global_seqlen/balanced_min:25085 - global_seqlen/balanced_max:25087 - global_seqlen/mean:25085.5 - actor/entropy:0.2013355791568756 - actor/kl_loss:0.9181661881506443 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.046208354830741885 - actor/pg_clipfrac:0.016606880200561135 - actor/ppo_kl:0.051420182891888544 - actor/pg_clipfrac_lower:0.00048240782925859096 - actor/grad_norm:6.564658045768738 - perf/mfu/actor:0.07503144029253707 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.8361930847168 - actor/lr:1e-06 - training/global_step:275 - training/epoch:7 - critic/score/mean:0.9824999570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9824999570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.021377423778176308 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.021377423778176308 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:217.4031219482422 - response_length/max:799.0 - response_length/min:19.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.666010737419128e-05 - timing_s/generate_sequences:19.97252655029297 - timing_s/reshard:0.627315104007721 - timing_s/gen:27.859255673363805 - timing_s/reward:0.06424612738192081 - timing_s/old_log_prob:1.0794183742254972 - timing_s/ref:1.3615886699408293 - timing_s/adv:0.008252890780568123 - timing_s/update_actor:7.10381805896759 - timing_s/step:37.494012866169214 - timing_s/stop_profile:4.412420094013214e-05 - timing_per_token_ms/update_actor:0.03539802903553642 - timing_per_token_ms/gen:0.4004550255625897 - timing_per_token_ms/ref:0.0067847395404757194 - timing_per_token_ms/adv:4.112381047102969e-05 - perf/total_num_tokens:200684 - perf/time_per_step:37.494012866169214 - perf/throughput:669.0534856735649
[36m(TaskRunner pid=2905377)[0m Training Progress:  53%|█████▎    | 276/525 [4:09:43<2:19:09, 33.53s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  53%|█████▎    | 277/525 [4:10:19<2:21:28, 34.23s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  53%|█████▎    | 278/525 [4:10:57<2:25:06, 35.25s/it]
[36m(TaskRunner pid=2905377)[0m step:276 - global_seqlen/min:22585 - global_seqlen/max:26620 - global_seqlen/minmax_diff:4035 - global_seqlen/balanced_min:24350 - global_seqlen/balanced_max:24351 - global_seqlen/mean:24350.875 - actor/entropy:0.22213973104953766 - actor/kl_loss:1.3711607865989208 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.008503606915473938 - actor/pg_clipfrac:0.024712186912074684 - actor/ppo_kl:0.08734011866617948 - actor/pg_clipfrac_lower:0.0008997334400191904 - actor/grad_norm:7.648151516914368 - perf/mfu/actor:0.07323513008334484 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.82946014404297 - actor/lr:1e-06 - training/global_step:276 - training/epoch:7 - critic/score/mean:1.0700000524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0700000524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.004336060956120491 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.004336060956120491 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:198.70938110351562 - response_length/max:493.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.208172559738159e-05 - timing_s/generate_sequences:16.226402282714844 - timing_s/reshard:0.6878274083137512 - timing_s/gen:19.004179442301393 - timing_s/reward:0.06273871660232544 - timing_s/old_log_prob:1.0989943537861109 - timing_s/ref:1.3455557879060507 - timing_s/adv:0.008444664999842644 - timing_s/update_actor:7.058124167844653 - timing_s/step:28.595468362793326 - timing_s/stop_profile:4.731304943561554e-05 - timing_per_token_ms/update_actor:0.036231368317589475 - timing_per_token_ms/gen:0.29886894243007833 - timing_per_token_ms/ref:0.00690712237191708 - timing_per_token_ms/adv:4.3348878632916904e-05 - perf/total_num_tokens:194807 - perf/time_per_step:28.595468362793326 - perf/throughput:851.5641251634077
[36m(TaskRunner pid=2905377)[0m step:277 - global_seqlen/min:23942 - global_seqlen/max:27722 - global_seqlen/minmax_diff:3780 - global_seqlen/balanced_min:25793 - global_seqlen/balanced_max:25794 - global_seqlen/mean:25793.75 - actor/entropy:0.19679704308509827 - actor/kl_loss:0.9823540046811103 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.051848454028368 - actor/pg_clipfrac:0.013330815476365387 - actor/ppo_kl:0.03538397047086619 - actor/pg_clipfrac_lower:0.00073795533971861 - actor/grad_norm:5.723891496658325 - perf/mfu/actor:0.07892478686467945 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.82466125488281 - actor/lr:1e-06 - training/global_step:277 - training/epoch:7 - critic/score/mean:1.0906250476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0906250476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.021992210298776627 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.021992210298776627 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:234.890625 - response_length/max:762.0 - response_length/min:39.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001073293387889862 - timing_s/generate_sequences:22.636987686157227 - timing_s/reshard:0.6151412129402161 - timing_s/gen:26.32265637628734 - timing_s/reward:0.0645111296325922 - timing_s/old_log_prob:1.0534555688500404 - timing_s/ref:1.331975169479847 - timing_s/adv:0.007444377988576889 - timing_s/update_actor:6.94679157435894 - timing_s/step:35.74050056561828 - timing_s/stop_profile:4.3900683522224426e-05 - timing_per_token_ms/update_actor:0.03366509122538861 - timing_per_token_ms/gen:0.35019831538997326 - timing_per_token_ms/ref:0.006454931763895551 - timing_per_token_ms/adv:3.607646226594082e-05 - perf/total_num_tokens:206350 - perf/time_per_step:35.74050056561828 - perf/throughput:721.6952642463303
[36m(TaskRunner pid=2905377)[0m step:278 - global_seqlen/min:24331 - global_seqlen/max:27311 - global_seqlen/minmax_diff:2980 - global_seqlen/balanced_min:25630 - global_seqlen/balanced_max:25631 - global_seqlen/mean:25630.25 - actor/entropy:0.1984647512435913 - actor/kl_loss:1.1191783487796783 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13721168786287308 - actor/pg_clipfrac:0.015608220011927187 - actor/ppo_kl:-0.12903280328027905 - actor/pg_clipfrac_lower:0.007473648525774479 - actor/grad_norm:11.857719123363495 - perf/mfu/actor:0.07886962623211888 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.85199356079102 - actor/lr:1e-06 - training/global_step:278 - training/epoch:7 - critic/score/mean:1.0593750476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0593750476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.007691824343055487 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.007691824343055487 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:231.02188110351562 - response_length/max:820.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.165277540683746e-05 - timing_s/generate_sequences:21.9739933013916 - timing_s/reshard:0.6477041840553284 - timing_s/gen:28.026940947398543 - timing_s/reward:0.06486368365585804 - timing_s/old_log_prob:1.0659828670322895 - timing_s/ref:1.3662122264504433 - timing_s/adv:0.007443048059940338 - timing_s/update_actor:6.907124925404787 - timing_s/step:37.4516504406929 - timing_s/stop_profile:4.183873534202576e-05 - timing_per_token_ms/update_actor:0.033686390717047175 - timing_per_token_ms/gen:0.37911643847847937 - timing_per_token_ms/ref:0.006663084765318536 - timing_per_token_ms/adv:3.630011441529218e-05 - perf/total_num_tokens:205042 - perf/time_per_step:37.4516504406929 - perf/throughput:684.3556878911692
[36m(TaskRunner pid=2905377)[0m Training Progress:  53%|█████▎    | 279/525 [4:11:36<2:29:13, 36.40s/it]
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 15:13:13,080:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/model_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 15:13:18,115:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 15:13:18,118:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:13:13,373:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:13:18,961:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  53%|█████▎    | 280/525 [4:12:24<2:43:22, 40.01s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  54%|█████▎    | 281/525 [4:12:59<2:36:54, 38.59s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:13:20,525:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:13:20,527:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:279 - global_seqlen/min:23562 - global_seqlen/max:25764 - global_seqlen/minmax_diff:2202 - global_seqlen/balanced_min:24761 - global_seqlen/balanced_max:24872 - global_seqlen/mean:24816.0 - actor/entropy:0.20232287049293518 - actor/kl_loss:0.9602632597088814 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16141653060913086 - actor/pg_clipfrac:0.028416980092879386 - actor/ppo_kl:-0.007220609567593783 - actor/pg_clipfrac_lower:0.003876884514465928 - actor/grad_norm:9.288063406944275 - perf/mfu/actor:0.07450299005576126 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.82608413696289 - actor/lr:1e-06 - training/global_step:279 - training/epoch:7 - critic/score/mean:1.0278124809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0278124809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.01112077385187149 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.01112077385187149 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:210.44686889648438 - response_length/max:893.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.15889036655426e-05 - timing_s/generate_sequences:22.147960662841797 - timing_s/reshard:0.6385431885719299 - timing_s/gen:29.530457969754934 - timing_s/reward:0.06321673467755318 - timing_s/old_log_prob:1.0483121760189533 - timing_s/ref:1.3305585123598576 - timing_s/adv:0.0074977148324251175 - timing_s/update_actor:7.071790246292949 - timing_s/step:39.06496671028435 - timing_s/stop_profile:3.947317600250244e-05 - timing_per_token_ms/update_actor:0.035621122694496236 - timing_per_token_ms/gen:0.43850820381858446 - timing_per_token_ms/ref:0.0067021201662226864 - timing_per_token_ms/adv:3.7766535866100087e-05 - perf/total_num_tokens:198528 - perf/time_per_step:39.06496671028435 - perf/throughput:635.2494854031675
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_280
[36m(TaskRunner pid=2905377)[0m step:280 - global_seqlen/min:23541 - global_seqlen/max:26752 - global_seqlen/minmax_diff:3211 - global_seqlen/balanced_min:25151 - global_seqlen/balanced_max:25152 - global_seqlen/mean:25151.125 - actor/entropy:0.17877282202243805 - actor/kl_loss:0.9765422277152538 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06430541016161442 - actor/pg_clipfrac:0.021074956608936192 - actor/ppo_kl:-0.08589902603998781 - actor/pg_clipfrac_lower:0.002647994749713689 - actor/grad_norm:10.682892203330994 - perf/mfu/actor:0.07724772491106108 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.83494567871094 - actor/lr:1e-06 - training/global_step:280 - training/epoch:7 - critic/score/mean:1.0231249332427979 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0231249332427979 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.015050312504172325 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.015050312504172325 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:219.5906219482422 - response_length/max:821.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.993541657924652e-05 - timing_s/generate_sequences:21.932214736938477 - timing_s/reshard:0.6908116340637207 - timing_s/gen:27.848767844960093 - timing_s/reward:0.06385323405265808 - timing_s/old_log_prob:1.1409911438822746 - timing_s/ref:1.3314313106238842 - timing_s/adv:0.007751336321234703 - timing_s/update_actor:6.918734394013882 - timing_s/save_checkpoint:11.016409235075116 - timing_s/step:48.34104511514306 - timing_s/stop_profile:4.7169625759124756e-05 - timing_per_token_ms/update_actor:0.03438580975012987 - timing_per_token_ms/gen:0.3963165527467318 - timing_per_token_ms/ref:0.006617155846030168 - timing_per_token_ms/adv:3.852380520371705e-05 - perf/total_num_tokens:201209 - perf/time_per_step:48.34104511514306 - perf/throughput:520.2850898256912
[36m(TaskRunner pid=2905377)[0m step:281 - global_seqlen/min:24799 - global_seqlen/max:27296 - global_seqlen/minmax_diff:2497 - global_seqlen/balanced_min:25538 - global_seqlen/balanced_max:25538 - global_seqlen/mean:25538.0 - actor/entropy:0.18457844853401184 - actor/kl_loss:1.0149684868752957 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08102180883288383 - actor/pg_clipfrac:0.007167955674231052 - actor/ppo_kl:0.04785001818090677 - actor/pg_clipfrac_lower:0.00010775862028822303 - actor/grad_norm:4.813720405101776 - perf/mfu/actor:0.07865088323413177 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.77528381347656 - actor/lr:1e-06 - training/global_step:281 - training/epoch:8 - critic/score/mean:0.9993749856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9993749856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008439750410616398 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.008439750410616398 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:228.6062469482422 - response_length/max:677.0 - response_length/min:41.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00029772892594337463 - timing_s/generate_sequences:19.432531356811523 - timing_s/reshard:0.6518301963806152 - timing_s/gen:23.33705654926598 - timing_s/reward:0.06580146215856075 - timing_s/old_log_prob:1.1169284377247095 - timing_s/ref:1.329850234091282 - timing_s/adv:0.007523778825998306 - timing_s/update_actor:6.904014823958278 - timing_s/step:32.7919998485595 - timing_s/stop_profile:4.1292980313301086e-05 - timing_per_token_ms/update_actor:0.03379285194591529 - timing_per_token_ms/gen:0.31901272041537004 - timing_per_token_ms/ref:0.006509173751327834 - timing_per_token_ms/adv:3.6826390212616033e-05 - perf/total_num_tokens:204304 - perf/time_per_step:32.7919998485595 - perf/throughput:778.7875127451808
[36m(TaskRunner pid=2905377)[0m Training Progress:  54%|█████▎    | 282/525 [4:13:34<2:31:50, 37.49s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  54%|█████▍    | 283/525 [4:14:10<2:29:05, 36.96s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  54%|█████▍    | 284/525 [4:15:00<2:44:13, 40.88s/it]
[36m(TaskRunner pid=2905377)[0m step:282 - global_seqlen/min:22730 - global_seqlen/max:26744 - global_seqlen/minmax_diff:4014 - global_seqlen/balanced_min:24731 - global_seqlen/balanced_max:24732 - global_seqlen/mean:24731.5 - actor/entropy:0.1905536651611328 - actor/kl_loss:0.9517912276089191 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15742115452885627 - actor/pg_clipfrac:0.012439786549657583 - actor/ppo_kl:-0.05271363530773669 - actor/pg_clipfrac_lower:0.0053580970037728545 - actor/grad_norm:10.310810148715973 - perf/mfu/actor:0.07672254020545116 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.78342819213867 - actor/lr:1e-06 - training/global_step:282 - training/epoch:8 - critic/score/mean:0.9462499618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9462499618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.00024315518385265023 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00024315518385265023 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:208.55313110351562 - response_length/max:748.0 - response_length/min:24.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.256120443344116e-05 - timing_s/generate_sequences:17.66895294189453 - timing_s/reshard:0.6596890091896057 - timing_s/gen:25.59545904956758 - timing_s/reward:0.06322263926267624 - timing_s/old_log_prob:1.0756832659244537 - timing_s/ref:1.3251064848154783 - timing_s/adv:0.00741015188395977 - timing_s/update_actor:6.846284918487072 - timing_s/step:34.926634239032865 - timing_s/stop_profile:3.91155481338501e-05 - timing_per_token_ms/update_actor:0.03460306147265164 - timing_per_token_ms/gen:0.3835272644794878 - timing_per_token_ms/ref:0.0066974631786157245 - timing_per_token_ms/adv:3.745300469017129e-05 - perf/total_num_tokens:197852 - perf/time_per_step:34.926634239032865 - perf/throughput:708.098576883795
[36m(TaskRunner pid=2905377)[0m step:283 - global_seqlen/min:22936 - global_seqlen/max:27608 - global_seqlen/minmax_diff:4672 - global_seqlen/balanced_min:25260 - global_seqlen/balanced_max:25261 - global_seqlen/mean:25260.125 - actor/entropy:0.1564934253692627 - actor/kl_loss:1.0861914068460465 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05054466463625431 - actor/pg_clipfrac:0.007477783295325935 - actor/ppo_kl:0.007297209301032126 - actor/pg_clipfrac_lower:0.0006593406666070223 - actor/grad_norm:7.647305607795715 - perf/mfu/actor:0.07808583994523242 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.78665161132812 - actor/lr:1e-06 - training/global_step:283 - training/epoch:8 - critic/score/mean:0.9918749928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9918749928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.02188531495630741 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.02188531495630741 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:222.0968780517578 - response_length/max:754.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.449276745319366e-05 - timing_s/generate_sequences:20.38481330871582 - timing_s/reshard:0.6639218926429749 - timing_s/gen:26.318085066974163 - timing_s/reward:0.06408310681581497 - timing_s/old_log_prob:1.1254025865346193 - timing_s/ref:1.3199712932109833 - timing_s/adv:0.007329544052481651 - timing_s/update_actor:6.873514203354716 - timing_s/step:35.7253423910588 - timing_s/stop_profile:4.3198466300964355e-05 - timing_per_token_ms/update_actor:0.034013658895961106 - timing_per_token_ms/gen:0.3703069475169079 - timing_per_token_ms/ref:0.0065318921284583074 - timing_per_token_ms/adv:3.627032750472163e-05 - perf/total_num_tokens:202081 - perf/time_per_step:35.7253423910588 - perf/throughput:707.0646020266556
[36m(TaskRunner pid=2905377)[0m step:284 - global_seqlen/min:24423 - global_seqlen/max:29523 - global_seqlen/minmax_diff:5100 - global_seqlen/balanced_min:26220 - global_seqlen/balanced_max:26522 - global_seqlen/mean:26258.75 - actor/entropy:0.15170837938785553 - actor/kl_loss:1.0752606764435768 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11898804781958461 - actor/pg_clipfrac:0.012511937820818275 - actor/ppo_kl:0.025632351118838416 - actor/pg_clipfrac_lower:0.0004310090735089034 - actor/grad_norm:6.893533945083618 - perf/mfu/actor:0.07972853283596992 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.74927520751953 - actor/lr:1e-06 - training/global_step:284 - training/epoch:8 - critic/score/mean:1.0496875047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0496875047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.002939831465482712 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.002939831465482712 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:246.84375 - response_length/max:1291.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.323548197746277e-05 - timing_s/generate_sequences:24.17826271057129 - timing_s/reshard:0.6451187133789062 - timing_s/gen:40.45480377227068 - timing_s/reward:0.06581519544124603 - timing_s/old_log_prob:1.1398206539452076 - timing_s/ref:1.3321756590157747 - timing_s/adv:0.007443048059940338 - timing_s/update_actor:7.005156377330422 - timing_s/step:50.0188553892076 - timing_s/stop_profile:4.129856824874878e-05 - timing_per_token_ms/update_actor:0.0333467719204571 - timing_per_token_ms/gen:0.5121509529341775 - timing_per_token_ms/ref:0.0063415797544426845 - timing_per_token_ms/adv:3.543127557452439e-05 - perf/total_num_tokens:210070 - perf/time_per_step:50.0188553892076 - perf/throughput:524.9770270765885
[36m(TaskRunner pid=2905377)[0m Training Progress:  54%|█████▍    | 285/525 [4:15:33<2:34:34, 38.64s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  54%|█████▍    | 286/525 [4:16:08<2:29:15, 37.47s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  55%|█████▍    | 287/525 [4:16:51<2:34:52, 39.04s/it]
[36m(TaskRunner pid=2905377)[0m step:285 - global_seqlen/min:24372 - global_seqlen/max:27386 - global_seqlen/minmax_diff:3014 - global_seqlen/balanced_min:25595 - global_seqlen/balanced_max:25596 - global_seqlen/mean:25595.5 - actor/entropy:0.13834071159362793 - actor/kl_loss:1.159188559651375 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08027193546295167 - actor/pg_clipfrac:0.007268257229588926 - actor/ppo_kl:-0.017364246399665717 - actor/pg_clipfrac_lower:0.0006862904992885888 - actor/grad_norm:7.982128202915192 - perf/mfu/actor:0.07551995595009825 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.69840240478516 - actor/lr:1e-06 - training/global_step:285 - training/epoch:8 - critic/score/mean:1.0556249618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0556249618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.01290719024837017 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.01290719024837017 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:231.0281219482422 - response_length/max:688.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.11735337972641e-05 - timing_s/generate_sequences:18.455904006958008 - timing_s/reshard:0.6771446466445923 - timing_s/gen:23.74854584224522 - timing_s/reward:0.06466198898851871 - timing_s/old_log_prob:1.0366121865808964 - timing_s/ref:1.3338947296142578 - timing_s/adv:0.007609814405441284 - timing_s/update_actor:7.200138445943594 - timing_s/step:33.40467981994152 - timing_s/stop_profile:3.962777554988861e-05 - timing_per_token_ms/update_actor:0.0351631070204899 - timing_per_token_ms/gen:0.3212345066515876 - timing_per_token_ms/ref:0.006514302951760358 - timing_per_token_ms/adv:3.71638296059917e-05 - perf/total_num_tokens:204764 - perf/time_per_step:33.40467981994152 - perf/throughput:766.2249761999009
[36m(TaskRunner pid=2905377)[0m step:286 - global_seqlen/min:24548 - global_seqlen/max:27183 - global_seqlen/minmax_diff:2635 - global_seqlen/balanced_min:25631 - global_seqlen/balanced_max:25632 - global_seqlen/mean:25631.75 - actor/entropy:0.1512054204940796 - actor/kl_loss:1.1575741812586784 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11575297731906176 - actor/pg_clipfrac:0.024179817992262542 - actor/ppo_kl:-0.13725724630057812 - actor/pg_clipfrac_lower:0.004622450983151794 - actor/grad_norm:8.467857241630554 - perf/mfu/actor:0.07890636712757951 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.70744323730469 - actor/lr:1e-06 - training/global_step:286 - training/epoch:8 - critic/score/mean:1.0706249475479126 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0706249475479126 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.013055435381829739 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.013055435381829739 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:231.7156219482422 - response_length/max:721.0 - response_length/min:47.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.12275505065918e-05 - timing_s/generate_sequences:20.392990112304688 - timing_s/reshard:0.6654649972915649 - timing_s/gen:25.334795530885458 - timing_s/reward:0.0641475711017847 - timing_s/old_log_prob:1.0613880772143602 - timing_s/ref:1.3287126310169697 - timing_s/adv:0.007521649822592735 - timing_s/update_actor:6.904481777921319 - timing_s/step:34.71424010582268 - timing_s/stop_profile:4.013068974018097e-05 - timing_per_token_ms/update_actor:0.0336715293431063 - timing_per_token_ms/gen:0.3416741362781084 - timing_per_token_ms/ref:0.006479818150423643 - timing_per_token_ms/adv:3.6681312349882155e-05 - perf/total_num_tokens:205054 - perf/time_per_step:34.71424010582268 - perf/throughput:738.3641388048342
[36m(TaskRunner pid=2905377)[0m step:287 - global_seqlen/min:25017 - global_seqlen/max:28444 - global_seqlen/minmax_diff:3427 - global_seqlen/balanced_min:26983 - global_seqlen/balanced_max:26984 - global_seqlen/mean:26983.125 - actor/entropy:0.15253688395023346 - actor/kl_loss:0.8066090576350688 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.13095552921295167 - actor/pg_clipfrac:0.011939221317879856 - actor/ppo_kl:0.022851571917999535 - actor/pg_clipfrac_lower:0.0005747377523221076 - actor/grad_norm:6.458715796470642 - perf/mfu/actor:0.08261745181258406 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.70902252197266 - actor/lr:1e-06 - training/global_step:287 - training/epoch:8 - critic/score/mean:0.9787500500679016 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9787500500679016 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.015907365828752518 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.015907365828752518 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:264.078125 - response_length/max:999.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.5 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.041916251182556e-05 - timing_s/generate_sequences:25.999759674072266 - timing_s/reshard:0.6756316423416138 - timing_s/gen:33.28468136675656 - timing_s/reward:0.06643476895987988 - timing_s/old_log_prob:1.045167112722993 - timing_s/ref:1.3372370898723602 - timing_s/adv:0.007532797753810883 - timing_s/update_actor:6.951393673196435 - timing_s/step:42.705711625516415 - timing_s/stop_profile:4.275329411029816e-05 - timing_per_token_ms/update_actor:0.03220250468207646 - timing_per_token_ms/gen:0.3938782482309515 - timing_per_token_ms/ref:0.00619478419323355 - timing_per_token_ms/adv:3.4895873596047915e-05 - perf/total_num_tokens:215865 - perf/time_per_step:42.705711625516415 - perf/throughput:631.8387862638434
[36m(TaskRunner pid=2905377)[0m Training Progress:  55%|█████▍    | 288/525 [4:17:26<2:29:49, 37.93s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  55%|█████▌    | 289/525 [4:18:10<2:35:49, 39.62s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:19:44,272:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:19:49,206:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:19:49,208:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906985)[0m INFO:2025-08-04 15:19:44,606:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:19:49,852:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  55%|█████▌    | 290/525 [4:18:55<2:41:39, 41.28s/it]
[36m(TaskRunner pid=2905377)[0m step:288 - global_seqlen/min:22956 - global_seqlen/max:30156 - global_seqlen/minmax_diff:7200 - global_seqlen/balanced_min:25668 - global_seqlen/balanced_max:25669 - global_seqlen/mean:25668.5 - actor/entropy:0.14591291546821594 - actor/kl_loss:1.1274080887436866 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.17072856351733207 - actor/pg_clipfrac:0.01948607279919088 - actor/ppo_kl:-0.03121669094543904 - actor/pg_clipfrac_lower:0.002808532165363431 - actor/grad_norm:9.967838048934937 - perf/mfu/actor:0.07817756383318782 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.72029113769531 - actor/lr:1e-06 - training/global_step:288 - training/epoch:8 - critic/score/mean:1.058750033378601 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.058750033378601 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.016432950273156166 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.016432950273156166 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:232.63436889648438 - response_length/max:761.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.011927664279938e-05 - timing_s/generate_sequences:21.047283172607422 - timing_s/reshard:0.7008878588676453 - timing_s/gen:25.803210739046335 - timing_s/reward:0.0643461961299181 - timing_s/old_log_prob:1.0977348294109106 - timing_s/ref:1.3584172036498785 - timing_s/adv:0.00775676965713501 - timing_s/update_actor:6.978330014273524 - timing_s/step:35.32308401726186 - timing_s/stop_profile:4.271417856216431e-05 - timing_per_token_ms/update_actor:0.03398294609284495 - timing_per_token_ms/gen:0.34661701891442226 - timing_per_token_ms/ref:0.0066151956856160205 - timing_per_token_ms/adv:3.777377747596767e-05 - perf/total_num_tokens:205348 - perf/time_per_step:35.32308401726186 - perf/throughput:726.677772174598
[36m(TaskRunner pid=2905377)[0m step:289 - global_seqlen/min:23312 - global_seqlen/max:27423 - global_seqlen/minmax_diff:4111 - global_seqlen/balanced_min:26319 - global_seqlen/balanced_max:26408 - global_seqlen/mean:26330.625 - actor/entropy:0.15648411214351654 - actor/kl_loss:1.0268725916743278 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15239274650812148 - actor/pg_clipfrac:0.023849623184651135 - actor/ppo_kl:0.12226187574560754 - actor/pg_clipfrac_lower:0.0010687839181628077 - actor/grad_norm:7.248707294464111 - perf/mfu/actor:0.08096621382085503 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.7067642211914 - actor/lr:1e-06 - training/global_step:289 - training/epoch:8 - critic/score/mean:1.0512501001358032 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0512501001358032 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0034890640527009964 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0034890640527009964 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:248.09375 - response_length/max:1031.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.244626224040985e-05 - timing_s/generate_sequences:22.08086395263672 - timing_s/reshard:0.6844086647033691 - timing_s/gen:33.50834867730737 - timing_s/reward:0.06576927565038204 - timing_s/old_log_prob:1.0510085467249155 - timing_s/ref:1.340381558984518 - timing_s/adv:0.00745391845703125 - timing_s/update_actor:6.917721327394247 - timing_s/step:42.904002541676164 - timing_s/stop_profile:4.201382398605347e-05 - timing_per_token_ms/update_actor:0.03284066238170499 - timing_per_token_ms/gen:0.42207266251804215 - timing_per_token_ms/ref:0.006363225137005474 - timing_per_token_ms/adv:3.5386163721100665e-05 - perf/total_num_tokens:210645 - perf/time_per_step:42.904002541676164 - perf/throughput:613.7102237587953
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290
[36m(TaskRunner pid=2905377)[0m step:290 - global_seqlen/min:24670 - global_seqlen/max:28170 - global_seqlen/minmax_diff:3500 - global_seqlen/balanced_min:25793 - global_seqlen/balanced_max:25793 - global_seqlen/mean:25793.0 - actor/entropy:0.15656696259975433 - actor/kl_loss:1.0975975900888444 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04873706179205328 - actor/pg_clipfrac:0.02409372213296592 - actor/ppo_kl:-0.040134893148206174 - actor/pg_clipfrac_lower:0.004329741030232981 - actor/grad_norm:11.826195478439331 - perf/mfu/actor:0.07952751402143528 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.70052337646484 - actor/lr:1e-06 - training/global_step:290 - training/epoch:8 - critic/score/mean:1.0265624523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0265624523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:0.016716018319129944 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.016716018319129944 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:235.6374969482422 - response_length/max:738.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.735379040241241e-05 - timing_s/generate_sequences:21.989797592163086 - timing_s/reshard:0.6614845395088196 - timing_s/gen:24.905406914651394 - timing_s/reward:0.06551030091941357 - timing_s/old_log_prob:1.1528389025479555 - timing_s/ref:1.3247941099107265 - timing_s/adv:0.0073277950286865234 - timing_s/update_actor:6.894870493561029 - timing_s/save_checkpoint:10.659944729879498 - timing_s/step:45.02403672225773 - timing_s/stop_profile:4.7849491238594055e-05 - timing_per_token_ms/update_actor:0.033414446233285336 - timing_per_token_ms/gen:0.33029291436331487 - timing_per_token_ms/ref:0.006420318060669205 - timing_per_token_ms/adv:3.551251807024446e-05 - perf/total_num_tokens:206344 - perf/time_per_step:45.02403672225773 - perf/throughput:572.8717786703735
[36m(TaskRunner pid=2905377)[0m Training Progress:  55%|█████▌    | 291/525 [4:19:34<2:38:25, 40.62s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:19:51,386:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:19:51,388:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_290/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  56%|█████▌    | 292/525 [4:20:23<2:47:41, 43.18s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  56%|█████▌    | 293/525 [4:21:00<2:39:26, 41.23s/it]
[36m(TaskRunner pid=2905377)[0m step:291 - global_seqlen/min:23926 - global_seqlen/max:28302 - global_seqlen/minmax_diff:4376 - global_seqlen/balanced_min:25577 - global_seqlen/balanced_max:25625 - global_seqlen/mean:25583.875 - actor/entropy:0.16451935470104218 - actor/kl_loss:1.2454677000641823 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08152832835912704 - actor/pg_clipfrac:0.02042238670401275 - actor/ppo_kl:0.03006734561640769 - actor/pg_clipfrac_lower:0.0014394179685041308 - actor/grad_norm:6.723955512046814 - perf/mfu/actor:0.07912117425172796 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.48290252685547 - actor/lr:1e-06 - training/global_step:291 - training/epoch:8 - critic/score/mean:0.9806249737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9806249737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.006093531381338835 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.006093531381338835 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:229.5343780517578 - response_length/max:898.0 - response_length/min:48.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.077865302562714e-05 - timing_s/generate_sequences:18.89417839050293 - timing_s/reshard:0.7838379144668579 - timing_s/gen:29.75538898818195 - timing_s/reward:0.0649430938065052 - timing_s/old_log_prob:1.0429869685322046 - timing_s/ref:1.3298178687691689 - timing_s/adv:0.00750378891825676 - timing_s/update_actor:6.870575983077288 - timing_s/step:39.08433145098388 - timing_s/stop_profile:3.989227116107941e-05 - timing_per_token_ms/update_actor:0.03356887875213043 - timing_per_token_ms/gen:0.4051052945253563 - timing_per_token_ms/ref:0.00649734387758485 - timing_per_token_ms/adv:3.666268752415711e-05 - perf/total_num_tokens:204671 - perf/time_per_step:39.08433145098388 - perf/throughput:654.5813641992326
[36m(TaskRunner pid=2905377)[0m step:292 - global_seqlen/min:24780 - global_seqlen/max:26821 - global_seqlen/minmax_diff:2041 - global_seqlen/balanced_min:26010 - global_seqlen/balanced_max:26374 - global_seqlen/mean:26056.75 - actor/entropy:0.16166944801807404 - actor/kl_loss:1.21957868039608 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05187852568924427 - actor/pg_clipfrac:0.016760354302823542 - actor/ppo_kl:-0.009062085533514619 - actor/pg_clipfrac_lower:0.0025281412876211108 - actor/grad_norm:11.372805118560791 - perf/mfu/actor:0.07623999961813778 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.55558013916016 - actor/lr:1e-06 - training/global_step:292 - training/epoch:8 - critic/score/mean:0.9887501001358032 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9887501001358032 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.005209859926253557 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.005209859926253557 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:242.0124969482422 - response_length/max:1229.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.090531289577484e-05 - timing_s/generate_sequences:25.47102928161621 - timing_s/reshard:0.711154043674469 - timing_s/gen:39.29465367086232 - timing_s/reward:0.06550132296979427 - timing_s/old_log_prob:1.1643395628780127 - timing_s/ref:1.3357290402054787 - timing_s/adv:0.007343808189034462 - timing_s/update_actor:7.266370860859752 - timing_s/step:49.14687781594694 - timing_s/stop_profile:4.026852548122406e-05 - timing_per_token_ms/update_actor:0.03485839015255045 - timing_per_token_ms/gen:0.5073944226907484 - timing_per_token_ms/ref:0.006407788002175438 - timing_per_token_ms/adv:3.522987416424948e-05 - perf/total_num_tokens:208454 - perf/time_per_step:49.14687781594694 - perf/throughput:530.1811866377651
[36m(TaskRunner pid=2905377)[0m step:293 - global_seqlen/min:23780 - global_seqlen/max:27665 - global_seqlen/minmax_diff:3885 - global_seqlen/balanced_min:25662 - global_seqlen/balanced_max:25663 - global_seqlen/mean:25662.375 - actor/entropy:0.15674929320812225 - actor/kl_loss:1.2380499698221683 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0786337286233902 - actor/pg_clipfrac:0.028029582742601634 - actor/ppo_kl:0.0064097951166331765 - actor/pg_clipfrac_lower:0.001588100881781429 - actor/grad_norm:9.494103193283081 - perf/mfu/actor:0.07894022819825879 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.51029586791992 - actor/lr:1e-06 - training/global_step:293 - training/epoch:8 - critic/score/mean:1.006250023841858 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.006250023841858 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.0066210366785526276 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0066210366785526276 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:232.3718719482422 - response_length/max:774.0 - response_length/min:39.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.099844515323639e-05 - timing_s/generate_sequences:21.660533905029297 - timing_s/reshard:0.6782508492469788 - timing_s/gen:27.19844612851739 - timing_s/reward:0.06442088261246681 - timing_s/old_log_prob:1.1323747243732214 - timing_s/ref:1.3493389338254929 - timing_s/adv:0.0075978729873895645 - timing_s/update_actor:6.911361947655678 - timing_s/step:36.676935002207756 - timing_s/stop_profile:3.9597973227500916e-05 - timing_per_token_ms/update_actor:0.03366485929135397 - timing_per_token_ms/gen:0.36577208042761994 - timing_per_token_ms/ref:0.006572554828934836 - timing_per_token_ms/adv:3.700881634781253e-05 - perf/total_num_tokens:205299 - perf/time_per_step:36.676935002207756 - perf/throughput:699.6870103364761
[36m(TaskRunner pid=2905377)[0m Training Progress:  56%|█████▌    | 294/525 [4:21:34<2:30:45, 39.16s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  56%|█████▌    | 295/525 [4:22:11<2:27:55, 38.59s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  56%|█████▋    | 296/525 [4:22:57<2:34:57, 40.60s/it]
[36m(TaskRunner pid=2905377)[0m step:294 - global_seqlen/min:23612 - global_seqlen/max:25827 - global_seqlen/minmax_diff:2215 - global_seqlen/balanced_min:24810 - global_seqlen/balanced_max:24811 - global_seqlen/mean:24810.5 - actor/entropy:0.1656349152326584 - actor/kl_loss:1.2297461569309234 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10265534333884715 - actor/pg_clipfrac:0.026018130639567972 - actor/ppo_kl:0.028799328378227074 - actor/pg_clipfrac_lower:0.0012157612829469145 - actor/grad_norm:10.14405870437622 - perf/mfu/actor:0.0763999845715252 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.56062698364258 - actor/lr:1e-06 - training/global_step:294 - training/epoch:8 - critic/score/mean:1.015625 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.015625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.008821499533951283 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.008821499533951283 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:210.8562469482422 - response_length/max:720.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.029622793197632e-05 - timing_s/generate_sequences:20.973878860473633 - timing_s/reshard:0.725389838218689 - timing_s/gen:24.728662883862853 - timing_s/reward:0.06290837749838829 - timing_s/old_log_prob:1.2471856195479631 - timing_s/ref:1.3418555092066526 - timing_s/adv:0.0075230225920677185 - timing_s/update_actor:6.896216148510575 - timing_s/step:34.29772375151515 - timing_s/stop_profile:4.118494689464569e-05 - timing_per_token_ms/update_actor:0.03474444362523214 - timing_per_token_ms/gen:0.36649172842669553 - timing_per_token_ms/ref:0.006760522305105966 - timing_per_token_ms/adv:3.7902413252794774e-05 - perf/total_num_tokens:198484 - perf/time_per_step:34.29772375151515 - perf/throughput:723.3861984471772
[36m(TaskRunner pid=2905377)[0m step:295 - global_seqlen/min:22844 - global_seqlen/max:26262 - global_seqlen/minmax_diff:3418 - global_seqlen/balanced_min:24462 - global_seqlen/balanced_max:24463 - global_seqlen/mean:24462.25 - actor/entropy:0.1503394991159439 - actor/kl_loss:1.4190674625337123 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08610554970800877 - actor/pg_clipfrac:0.010268242622260004 - actor/ppo_kl:-0.05973572200164199 - actor/pg_clipfrac_lower:0.0027316886465996505 - actor/grad_norm:11.586440920829773 - perf/mfu/actor:0.07496279035694903 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.54682540893555 - actor/lr:1e-06 - training/global_step:295 - training/epoch:8 - critic/score/mean:0.971875011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.971875011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.007213723845779896 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.007213723845779896 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:203.13436889648438 - response_length/max:821.0 - response_length/min:31.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.421875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.263757288455963e-05 - timing_s/generate_sequences:20.40058135986328 - timing_s/reshard:0.7506234645843506 - timing_s/gen:27.78301033191383 - timing_s/reward:0.06199296936392784 - timing_s/old_log_prob:1.1405900232493877 - timing_s/ref:1.3197637256234884 - timing_s/adv:0.007456766441464424 - timing_s/update_actor:6.9264258202165365 - timing_s/step:37.25236050225794 - timing_s/stop_profile:4.390254616737366e-05 - timing_per_token_ms/update_actor:0.035393442039349084 - timing_per_token_ms/gen:0.42741120151245066 - timing_per_token_ms/ref:0.006743879475638425 - timing_per_token_ms/adv:3.8103437140207995e-05 - perf/total_num_tokens:195698 - perf/time_per_step:37.25236050225794 - perf/throughput:656.6630857799546
[36m(TaskRunner pid=2905377)[0m step:296 - global_seqlen/min:23328 - global_seqlen/max:29409 - global_seqlen/minmax_diff:6081 - global_seqlen/balanced_min:25433 - global_seqlen/balanced_max:25623 - global_seqlen/mean:25481.0 - actor/entropy:0.17508000135421753 - actor/kl_loss:1.2068905383348465 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0043311651796102526 - actor/pg_clipfrac:0.016144267574418336 - actor/ppo_kl:0.07864401878323406 - actor/pg_clipfrac_lower:0.001394776743836701 - actor/grad_norm:7.3340864181518555 - perf/mfu/actor:0.07837857836107942 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.58585357666016 - actor/lr:1e-06 - training/global_step:296 - training/epoch:8 - critic/score/mean:1.0871875286102295 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0871875286102295 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.010114617645740509 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.010114617645740509 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:227.07186889648438 - response_length/max:1076.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.18291848897934e-05 - timing_s/generate_sequences:21.985828399658203 - timing_s/reshard:0.6589765548706055 - timing_s/gen:35.91648957319558 - timing_s/reward:0.06419313326478004 - timing_s/old_log_prob:1.0531003382056952 - timing_s/ref:1.3228566963225603 - timing_s/adv:0.007426586002111435 - timing_s/update_actor:6.911172429099679 - timing_s/step:45.288492729887366 - timing_s/stop_profile:4.201754927635193e-05 - timing_per_token_ms/update_actor:0.033903557695438166 - timing_per_token_ms/gen:0.4942885591455841 - timing_per_token_ms/ref:0.0064894269079047145 - timing_per_token_ms/adv:3.643197873960713e-05 - perf/total_num_tokens:203848 - perf/time_per_step:45.288492729887366 - perf/throughput:562.6374044279961
[36m(TaskRunner pid=2905377)[0m Training Progress:  57%|█████▋    | 297/525 [4:23:35<2:31:44, 39.93s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  57%|█████▋    | 298/525 [4:24:14<2:30:04, 39.67s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  57%|█████▋    | 299/525 [4:24:47<2:21:16, 37.51s/it]
[36m(TaskRunner pid=2905377)[0m step:297 - global_seqlen/min:24071 - global_seqlen/max:27446 - global_seqlen/minmax_diff:3375 - global_seqlen/balanced_min:25520 - global_seqlen/balanced_max:25521 - global_seqlen/mean:25520.625 - actor/entropy:0.1535390019416809 - actor/kl_loss:1.1803767159581184 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04865400642156601 - actor/pg_clipfrac:0.024797723453957587 - actor/ppo_kl:0.002803414937807247 - actor/pg_clipfrac_lower:0.002907916158437729 - actor/grad_norm:8.117398381233215 - perf/mfu/actor:0.07663491660670667 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.65792465209961 - actor/lr:1e-06 - training/global_step:297 - training/epoch:8 - critic/score/mean:1.0750000476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.10000000149011612 - critic/rewards/mean:1.0750000476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.10000000149011612 - critic/advantages/mean:-0.0012336036888882518 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0012336036888882518 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:227.734375 - response_length/max:817.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001231059432029724 - timing_s/generate_sequences:19.732192993164062 - timing_s/reshard:0.6323011517524719 - timing_s/gen:28.18976054340601 - timing_s/reward:0.06434245780110359 - timing_s/old_log_prob:1.0507932547479868 - timing_s/ref:1.3388523031026125 - timing_s/adv:0.008288120850920677 - timing_s/update_actor:7.079707091674209 - timing_s/step:37.745100013911724 - timing_s/stop_profile:3.967806696891785e-05 - timing_per_token_ms/update_actor:0.03467639944003237 - timing_per_token_ms/gen:0.386823472293736 - timing_per_token_ms/ref:0.0065576974657880266 - timing_per_token_ms/adv:4.0595209026623945e-05 - perf/total_num_tokens:204165 - perf/time_per_step:37.745100013911724 - perf/throughput:676.130808782964
[36m(TaskRunner pid=2905377)[0m step:298 - global_seqlen/min:23153 - global_seqlen/max:31324 - global_seqlen/minmax_diff:8171 - global_seqlen/balanced_min:25263 - global_seqlen/balanced_max:25309 - global_seqlen/mean:25269.125 - actor/entropy:0.14164848625659943 - actor/kl_loss:1.611318862438202 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.008727476745843888 - actor/pg_clipfrac:0.025905280327424406 - actor/ppo_kl:0.050250241067260504 - actor/pg_clipfrac_lower:0.0013719839276745915 - actor/grad_norm:10.61590051651001 - perf/mfu/actor:0.07786219040682661 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.69673919677734 - actor/lr:1e-06 - training/global_step:298 - training/epoch:8 - critic/score/mean:1.0149999856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0149999856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.00287958444096148 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00287958444096148 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:222.54061889648438 - response_length/max:910.0 - response_length/min:57.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.20942223072052e-05 - timing_s/generate_sequences:17.91460418701172 - timing_s/reshard:0.7632714509963989 - timing_s/gen:29.54356380738318 - timing_s/reward:0.063907066360116 - timing_s/old_log_prob:1.0581860840320587 - timing_s/ref:1.3283304534852505 - timing_s/adv:0.007434714585542679 - timing_s/update_actor:6.897389646619558 - timing_s/step:38.911951111629605 - timing_s/stop_profile:4.047714173793793e-05 - timing_per_token_ms/update_actor:0.03411965019870869 - timing_per_token_ms/gen:0.4148619466583795 - timing_per_token_ms/ref:0.006570916352887419 - timing_per_token_ms/adv:3.677766140271319e-05 - perf/total_num_tokens:202153 - perf/time_per_step:38.911951111629605 - perf/throughput:649.3923917489664
[36m(TaskRunner pid=2905377)[0m step:299 - global_seqlen/min:23276 - global_seqlen/max:27313 - global_seqlen/minmax_diff:4037 - global_seqlen/balanced_min:24976 - global_seqlen/balanced_max:24977 - global_seqlen/mean:24976.75 - actor/entropy:0.16402770578861237 - actor/kl_loss:1.4184192582964896 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.038708069175481793 - actor/pg_clipfrac:0.014629912248346954 - actor/ppo_kl:0.008474809909239411 - actor/pg_clipfrac_lower:0.001005946536315605 - actor/grad_norm:9.53787636756897 - perf/mfu/actor:0.07712484992928823 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.69511795043945 - actor/lr:1e-06 - training/global_step:299 - training/epoch:8 - critic/score/mean:0.9496874809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9496874809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.012367816641926765 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.012367816641926765 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:214.6843719482422 - response_length/max:680.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.805360317230225e-05 - timing_s/generate_sequences:17.80685043334961 - timing_s/reshard:0.7010493874549866 - timing_s/gen:23.09818660840392 - timing_s/reward:0.06358977034687996 - timing_s/old_log_prob:1.084640396758914 - timing_s/ref:1.3189154341816902 - timing_s/adv:0.007346862927079201 - timing_s/update_actor:6.8759681936353445 - timing_s/step:32.46191096119583 - timing_s/stop_profile:4.350580275058746e-05 - timing_per_token_ms/update_actor:0.03441184398308099 - timing_per_token_ms/gen:0.3362230397590055 - timing_per_token_ms/ref:0.006600715836636523 - timing_per_token_ms/adv:3.676850934909066e-05 - perf/total_num_tokens:199814 - perf/time_per_step:32.46191096119583 - perf/throughput:769.4171187228194
[36m(TaskRunner pid=2905377)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 300}
[36m(TaskRunner pid=2905377)[0m validation generation end
[36m(TaskRunner pid=2905377)[0m [prompt] system
[36m(TaskRunner pid=2905377)[0m You are a helpful assistant.
[36m(TaskRunner pid=2905377)[0m user
[36m(TaskRunner pid=2905377)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m Solve the problem in the image.
[36m(TaskRunner pid=2905377)[0m assistant
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m [response] <think>
[36m(TaskRunner pid=2905377)[0m The given problem involves an equal-axes hyperbola with its center at the origin and foci on the x-axis. The hyperbola intersects the parabola \(y^2 = 16x\) at points A and B, and the distance between A and B is \(4\sqrt{3}\). We need to find the length of the real axis of the hyperbola.
[36m(TaskRunner pid=2905377)[0m 
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 15:26:49,888:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/model_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 15:26:54,853:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906984)[0m INFO:2025-08-04 15:26:54,855:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:26:50,517:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:26:55,461:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  57%|█████▋    | 300/525 [4:26:01<3:02:11, 48.58s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  57%|█████▋    | 301/525 [4:26:38<2:48:43, 45.20s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:26:57,511:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:26:57,515:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m For a hyperbola with its center at the origin and foci on the x-axis, the standard form is \(\frac{x^2}{a^2} - \frac{y^2}{b^2} = 1\). Since it is an equal-axes hyperbola, \(a = b\). The equation of the hyperbola can be written as \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\) or \(x^2 - y^2 = a^2\).
[36m(TaskRunner pid=2905377)[0m 
[36m(TaskRunner pid=2905377)[0m The parabola \(y^2 = 16x\) has its focus at \((4,0)\) and its directrix at \(x = -4\). The hyperbola intersects the parabola at points A and B, and the distance between A and B is given as \(4\sqrt{3}\). The points of intersection satisfy both the hyperbola and the parabola equations. Substituting \(y^2 = 16x\) into the hyperbola's equation \(x^2 - y^2 = a^2\), we get:
[36m(TaskRunner pid=2905377)[0m \[x^2 - 16x = a^2.\]
[36m(TaskRunner pid=2905377)[0m This is a quadratic equation in \(x\):
[36m(TaskRunner pid=2905377)[0m \[x^2 - 16x - a^2 = 0.\]
[36m(TaskRunner pid=2905377)[0m The solutions to this quadratic equation are the x-coordinates of the points of intersection. The distance between the points of intersection is given by the distance formula for the roots of a quadratic equation \(x_1\) and \(x_2\):
[36m(TaskRunner pid=2905377)[0m \[x_1 - x_2 = \frac{\sqrt{b^2 - 4ac}}{a} = \frac{\sqrt{16^2 - 4 \cdot 1 \cdot (-a^2)}}{1} = \sqrt{256 + 4a^2} = 4\sqrt{3}.]\]
[36m(TaskRunner pid=2905377)[0m Solving for \(a\):
[36m(TaskRunner pid=2905377)[0m \[\sqrt{256 + 4a^2} = 4\sqrt{3}.\]
[36m(TaskRunner pid=2905377)[0m \[256 + 4a^2 = 48.\]
[36m(TaskRunner pid=2905377)[0m \[4a^2 = 48 - 256.\]
[36m(TaskRunner pid=2905377)[0m \[4a^2 = -208.\]
[36m(TaskRunner pid=2905377)[0m \[a^2 = -64.\</think>
[36m(TaskRunner pid=2905377)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2905377)[0m [ground_truth] C
[36m(TaskRunner pid=2905377)[0m [score] 0.6
[36m(TaskRunner pid=2905377)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_300
[36m(TaskRunner pid=2905377)[0m step:300 - global_seqlen/min:22389 - global_seqlen/max:31396 - global_seqlen/minmax_diff:9007 - global_seqlen/balanced_min:25871 - global_seqlen/balanced_max:25872 - global_seqlen/mean:25871.375 - actor/entropy:0.1478758305311203 - actor/kl_loss:1.0772639632225036 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.012033205479383469 - actor/pg_clipfrac:0.006598735228180885 - actor/ppo_kl:0.04838310648920015 - actor/pg_clipfrac_lower:9.433962404727935e-05 - actor/grad_norm:8.07202035188675 - perf/mfu/actor:0.0794954911042784 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.71100997924805 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.8500000238418579 - val-aux/grpo_convert/reward/std@50:0.40517399008295113 - val-aux/grpo_convert/reward/best@2/mean:1.019000023841858 - val-aux/grpo_convert/reward/best@2/std:0.4482009463163652 - val-aux/grpo_convert/reward/worst@2/mean:0.674000023841858 - val-aux/grpo_convert/reward/worst@2/std:0.2290713702801589 - val-aux/grpo_convert/reward/best@4/mean:1.2255000238418579 - val-aux/grpo_convert/reward/best@4/std:0.41684823179513597 - val-aux/grpo_convert/reward/worst@4/mean:0.6085000238418579 - val-aux/grpo_convert/reward/worst@4/std:0.06463551655243424 - val-aux/grpo_convert/reward/best@8/mean:1.415500023841858 - val-aux/grpo_convert/reward/best@8/std:0.3113495442141112 - val-aux/grpo_convert/reward/worst@8/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@8/std:0.0 - val-aux/grpo_convert/reward/best@16/mean:1.5420000238418579 - val-aux/grpo_convert/reward/best@16/std:0.16011246047700348 - val-aux/grpo_convert/reward/worst@16/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@16/std:0.0 - val-aux/grpo_convert/reward/best@32/mean:1.594000023841858 - val-aux/grpo_convert/reward/best@32/std:0.0544426303552648 - val-aux/grpo_convert/reward/worst@32/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@32/std:0.0 - val-core/grpo_convert/reward/best@50/mean:1.599000023841858 - val-core/grpo_convert/reward/best@50/std:0.022338307903688678 - val-aux/grpo_convert/reward/worst@50/mean:0.6000000238418579 - val-aux/grpo_convert/reward/worst@50/std:0.0 - training/global_step:300 - training/epoch:8 - critic/score/mean:1.0031249523162842 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0031249523162842 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:-0.00034093557042069733 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00034093557042069733 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:236.8312530517578 - response_length/max:787.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.352977991104126e-05 - timing_s/generate_sequences:18.913105010986328 - timing_s/reshard:0.7486510872840881 - timing_s/gen:26.48213087581098 - timing_s/reward:0.0647814441472292 - timing_s/old_log_prob:1.0755073446780443 - timing_s/ref:1.3264706786721945 - timing_s/adv:0.007591173052787781 - timing_s/update_actor:6.918904695659876 - timing_s/testing:27.25582794100046 - timing_s/save_checkpoint:11.267755772918463 - timing_s/step:74.41228610090911 - timing_s/stop_profile:4.8959627747535706e-05 - timing_per_token_ms/update_actor:0.03342934370351342 - timing_per_token_ms/gen:0.3494330202914916 - timing_per_token_ms/ref:0.006408968786313998 - timing_per_token_ms/adv:3.66774719781408e-05 - perf/total_num_tokens:206971 - perf/time_per_step:74.41228610090911 - perf/throughput:347.6761211840248
[36m(TaskRunner pid=2905377)[0m step:301 - global_seqlen/min:22043 - global_seqlen/max:27301 - global_seqlen/minmax_diff:5258 - global_seqlen/balanced_min:24661 - global_seqlen/balanced_max:24682 - global_seqlen/mean:24664.625 - actor/entropy:0.11830179393291473 - actor/kl_loss:1.5048447892069816 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.022871943563222884 - actor/pg_clipfrac:0.014584680227562785 - actor/ppo_kl:0.020689118746668102 - actor/pg_clipfrac_lower:0.0008099233731627464 - actor/grad_norm:13.77798843383789 - perf/mfu/actor:0.07638355707061811 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.71095657348633 - actor/lr:1e-06 - training/global_step:301 - training/epoch:8 - critic/score/mean:1.1449999809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.1449999809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.01777607388794422 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.01777607388794422 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:207.75625610351562 - response_length/max:820.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.191114127635956e-05 - timing_s/generate_sequences:21.963642120361328 - timing_s/reshard:0.6013891100883484 - timing_s/gen:27.95320555754006 - timing_s/reward:0.06263847835361958 - timing_s/old_log_prob:1.0481418576091528 - timing_s/ref:1.3310014065355062 - timing_s/adv:0.007816560566425323 - timing_s/update_actor:6.854933610185981 - timing_s/step:37.27787671983242 - timing_s/stop_profile:4.229135811328888e-05 - timing_per_token_ms/update_actor:0.03474071473915568 - timing_per_token_ms/gen:0.42046276522276793 - timing_per_token_ms/ref:0.0067454978868293465 - timing_per_token_ms/adv:3.961422769667755e-05 - perf/total_num_tokens:197317 - perf/time_per_step:37.27787671983242 - perf/throughput:661.6424316591516
[36m(TaskRunner pid=2905377)[0m Training Progress:  58%|█████▊    | 302/525 [4:27:19<2:42:57, 43.84s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  58%|█████▊    | 303/525 [4:28:06<2:45:10, 44.64s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  58%|█████▊    | 304/525 [4:28:46<2:40:20, 43.53s/it]
[36m(TaskRunner pid=2905377)[0m step:302 - global_seqlen/min:23670 - global_seqlen/max:26782 - global_seqlen/minmax_diff:3112 - global_seqlen/balanced_min:25022 - global_seqlen/balanced_max:25186 - global_seqlen/mean:25044.75 - actor/entropy:0.11558838933706284 - actor/kl_loss:1.4873824000358582 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07488424777984619 - actor/pg_clipfrac:0.02375860633328557 - actor/ppo_kl:-0.05041691799415275 - actor/pg_clipfrac_lower:0.007976654614321888 - actor/grad_norm:10.859359383583069 - perf/mfu/actor:0.07592745163163989 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.74614715576172 - actor/lr:1e-06 - training/global_step:302 - training/epoch:8 - critic/score/mean:0.971875011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:0.971875011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.001044949982315302 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.001044949982315302 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:217.14999389648438 - response_length/max:989.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.092580199241638e-05 - timing_s/generate_sequences:23.533428192138672 - timing_s/reshard:0.7234262228012085 - timing_s/gen:31.213430412113667 - timing_s/reward:0.06345757097005844 - timing_s/old_log_prob:1.04407312348485 - timing_s/ref:1.331240277737379 - timing_s/adv:0.007522951811552048 - timing_s/update_actor:7.005269728600979 - timing_s/step:40.67946229316294 - timing_s/stop_profile:4.02349978685379e-05 - timing_per_token_ms/update_actor:0.034963763506328564 - timing_per_token_ms/gen:0.4491916649221976 - timing_per_token_ms/ref:0.0066443080772286564 - timing_per_token_ms/adv:3.754754894514842e-05 - perf/total_num_tokens:200358 - perf/time_per_step:40.67946229316294 - perf/throughput:615.6607926503814
[36m(TaskRunner pid=2905377)[0m step:303 - global_seqlen/min:24298 - global_seqlen/max:30244 - global_seqlen/minmax_diff:5946 - global_seqlen/balanced_min:26188 - global_seqlen/balanced_max:26261 - global_seqlen/mean:26203.375 - actor/entropy:0.12722522020339966 - actor/kl_loss:1.2618951708078385 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09945528581738472 - actor/pg_clipfrac:0.022038480127230288 - actor/ppo_kl:0.039220454776659606 - actor/pg_clipfrac_lower:0.0016043705865740776 - actor/grad_norm:8.143799662590027 - perf/mfu/actor:0.07873204437685265 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.73029708862305 - actor/lr:1e-06 - training/global_step:303 - training/epoch:8 - critic/score/mean:1.0437500476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.6000000238418579 - critic/rewards/mean:1.0437500476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.6000000238418579 - critic/advantages/mean:0.017217887565493584 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.017217887565493584 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:244.91250610351562 - response_length/max:1121.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.414817810058594e-05 - timing_s/generate_sequences:24.97563362121582 - timing_s/reshard:0.6576824188232422 - timing_s/gen:36.84869236126542 - timing_s/reward:0.06572635471820831 - timing_s/old_log_prob:1.1527425087988377 - timing_s/ref:1.3238964956253767 - timing_s/adv:0.0075428541749715805 - timing_s/update_actor:7.080358747392893 - timing_s/step:46.492028599604964 - timing_s/stop_profile:4.4072046875953674e-05 - timing_per_token_ms/update_actor:0.03377598662096434 - timing_per_token_ms/gen:0.4701767514069492 - timing_per_token_ms/ref:0.006315486533821391 - timing_per_token_ms/adv:3.598226456979101e-05 - perf/total_num_tokens:209627 - perf/time_per_step:46.492028599604964 - perf/throughput:563.6100593860223
[36m(TaskRunner pid=2905377)[0m step:304 - global_seqlen/min:23534 - global_seqlen/max:28501 - global_seqlen/minmax_diff:4967 - global_seqlen/balanced_min:25926 - global_seqlen/balanced_max:26136 - global_seqlen/mean:25952.875 - actor/entropy:0.11589747667312622 - actor/kl_loss:1.6034143447875977 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06723433434963226 - actor/pg_clipfrac:0.014007100043818355 - actor/ppo_kl:0.06901065700221806 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:10.928282856941223 - perf/mfu/actor:0.07990044549031543 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.65377807617188 - actor/lr:1e-06 - training/global_step:304 - training/epoch:8 - critic/score/mean:1.0371874570846558 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0371874570846558 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.01817316934466362 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.01817316934466362 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:239.52499389648438 - response_length/max:993.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.1672722697258e-05 - timing_s/generate_sequences:20.609174728393555 - timing_s/reshard:0.6402719020843506 - timing_s/gen:31.548068422824144 - timing_s/reward:0.06553201004862785 - timing_s/old_log_prob:1.0633304920047522 - timing_s/ref:1.325350571423769 - timing_s/adv:0.007527930662035942 - timing_s/update_actor:6.904545076191425 - timing_s/step:40.9278642013669 - timing_s/stop_profile:4.2222440242767334e-05 - timing_per_token_ms/update_actor:0.033255203306914095 - timing_per_token_ms/gen:0.41159675950871705 - timing_per_token_ms/ref:0.006383447746269773 - timing_per_token_ms/adv:3.625769140237807e-05 - perf/total_num_tokens:207623 - perf/time_per_step:40.9278642013669 - perf/throughput:634.1126151198779
[36m(TaskRunner pid=2905377)[0m Training Progress:  58%|█████▊    | 305/525 [4:29:49<3:00:33, 49.25s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  58%|█████▊    | 306/525 [4:30:22<2:41:47, 44.33s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  58%|█████▊    | 307/525 [4:30:58<2:31:37, 41.73s/it]
[36m(TaskRunner pid=2905377)[0m step:305 - global_seqlen/min:23557 - global_seqlen/max:29622 - global_seqlen/minmax_diff:6065 - global_seqlen/balanced_min:26510 - global_seqlen/balanced_max:27281 - global_seqlen/mean:26624.625 - actor/entropy:0.12706027925014496 - actor/kl_loss:1.5974403649568558 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10422919243574143 - actor/pg_clipfrac:0.037822229135781524 - actor/ppo_kl:0.16154757416807114 - actor/pg_clipfrac_lower:0.0007287603220902383 - actor/grad_norm:8.540950655937195 - perf/mfu/actor:0.08153400202771996 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.66997909545898 - actor/lr:1e-06 - training/global_step:305 - training/epoch:8 - critic/score/mean:0.9987500309944153 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9987500309944153 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.008514165878295898 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.008514165878295898 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:255.66250610351562 - response_length/max:1778.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010919012129306793 - timing_s/generate_sequences:32.10411071777344 - timing_s/reshard:0.7166562676429749 - timing_s/gen:52.48687260039151 - timing_s/reward:0.06637212075293064 - timing_s/old_log_prob:1.08539280295372 - timing_s/ref:1.3203991502523422 - timing_s/adv:0.00738508440554142 - timing_s/update_actor:6.952279446646571 - timing_s/step:61.93192432075739 - timing_s/stop_profile:4.287250339984894e-05 - timing_per_token_ms/update_actor:0.032640269330772596 - timing_per_token_ms/gen:0.641554693692753 - timing_per_token_ms/ref:0.006199144355330555 - timing_per_token_ms/adv:3.4672246113989495e-05 - perf/total_num_tokens:212997 - perf/time_per_step:61.93192432075739 - perf/throughput:429.9014650684182
[36m(TaskRunner pid=2905377)[0m step:306 - global_seqlen/min:22976 - global_seqlen/max:28437 - global_seqlen/minmax_diff:5461 - global_seqlen/balanced_min:25785 - global_seqlen/balanced_max:25786 - global_seqlen/mean:25785.625 - actor/entropy:0.11581007391214371 - actor/kl_loss:1.3454164147377015 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08227602541446685 - actor/pg_clipfrac:0.022556439880281685 - actor/ppo_kl:-0.008969186519971117 - actor/pg_clipfrac_lower:0.002734436024911702 - actor/grad_norm:14.654595136642456 - perf/mfu/actor:0.0793559417808777 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.66119384765625 - actor/lr:1e-06 - training/global_step:306 - training/epoch:8 - critic/score/mean:0.9778125882148743 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9778125882148743 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.01068765576928854 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01068765576928854 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:234.796875 - response_length/max:696.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.87787139415741e-05 - timing_s/generate_sequences:20.029592514038086 - timing_s/reshard:0.6515666246414185 - timing_s/gen:23.3608431648463 - timing_s/reward:0.06468748487532139 - timing_s/old_log_prob:1.0636135302484035 - timing_s/ref:1.3280279599130154 - timing_s/adv:0.007046082988381386 - timing_s/update_actor:6.908820690587163 - timing_s/step:32.74666149914265 - timing_s/stop_profile:4.3258070945739746e-05 - timing_per_token_ms/update_actor:0.03349162901125706 - timing_per_token_ms/gen:0.3109182560038105 - timing_per_token_ms/ref:0.006437830961596894 - timing_per_token_ms/adv:3.4157030265804035e-05 - perf/total_num_tokens:206285 - perf/time_per_step:32.74666149914265 - perf/throughput:787.4275977926819
[36m(TaskRunner pid=2905377)[0m step:307 - global_seqlen/min:24031 - global_seqlen/max:26272 - global_seqlen/minmax_diff:2241 - global_seqlen/balanced_min:25167 - global_seqlen/balanced_max:25189 - global_seqlen/mean:25169.875 - actor/entropy:0.13740180432796478 - actor/kl_loss:1.5342793405055999 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07794172056019306 - actor/pg_clipfrac:0.031570992828346786 - actor/ppo_kl:0.1416126113384962 - actor/pg_clipfrac_lower:0.0019185804296284914 - actor/grad_norm:10.979008436203003 - perf/mfu/actor:0.07817687951116001 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.63723754882812 - actor/lr:1e-06 - training/global_step:307 - training/epoch:8 - critic/score/mean:0.9371875524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9371875524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.0016493923030793667 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0016493923030793667 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:219.7312469482422 - response_length/max:769.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.194094359874725e-05 - timing_s/generate_sequences:20.15070343017578 - timing_s/reshard:0.6682157516479492 - timing_s/gen:26.37056304141879 - timing_s/reward:0.0637201089411974 - timing_s/old_log_prob:1.0474278032779694 - timing_s/ref:1.3180581331253052 - timing_s/adv:0.007502250373363495 - timing_s/update_actor:6.838546758517623 - timing_s/step:35.659044900909066 - timing_s/stop_profile:4.1937455534935e-05 - timing_per_token_ms/update_actor:0.03396196225903795 - timing_per_token_ms/gen:0.37504000684669897 - timing_per_token_ms/ref:0.006545811873943082 - timing_per_token_ms/adv:3.7258083191531024e-05 - perf/total_num_tokens:201359 - perf/time_per_step:35.659044900909066 - perf/throughput:705.848265704905
[36m(TaskRunner pid=2905377)[0m Training Progress:  59%|█████▊    | 308/525 [4:31:30<2:20:47, 38.93s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  59%|█████▉    | 309/525 [4:32:00<2:10:12, 36.17s/it]
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 15:33:32,880:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:33:37,484:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:33:37,487:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:33:33,317:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:33:38,429:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  59%|█████▉    | 310/525 [4:32:43<2:17:41, 38.42s/it]
[36m(TaskRunner pid=2905377)[0m step:308 - global_seqlen/min:23190 - global_seqlen/max:28332 - global_seqlen/minmax_diff:5142 - global_seqlen/balanced_min:25608 - global_seqlen/balanced_max:25609 - global_seqlen/mean:25608.875 - actor/entropy:0.12510687112808228 - actor/kl_loss:1.3876096412539483 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0388191532343626 - actor/pg_clipfrac:0.03331359000876546 - actor/ppo_kl:0.015349068818613887 - actor/pg_clipfrac_lower:0.004791865916922688 - actor/grad_norm:17.65037775039673 - perf/mfu/actor:0.07899689538436679 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.62065887451172 - actor/lr:1e-06 - training/global_step:308 - training/epoch:8 - critic/score/mean:1.0590626001358032 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0590626001358032 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.024991240352392197 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.024991240352392197 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:230.3781280517578 - response_length/max:635.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.946735084056854e-05 - timing_s/generate_sequences:19.490388870239258 - timing_s/reshard:0.6504870653152466 - timing_s/gen:22.86449638940394 - timing_s/reward:0.06490047089755535 - timing_s/old_log_prob:1.2109854705631733 - timing_s/ref:1.3238159604370594 - timing_s/adv:0.007425963878631592 - timing_s/update_actor:6.889322277158499 - timing_s/step:32.37425873428583 - timing_s/stop_profile:4.1639432311058044e-05 - timing_per_token_ms/update_actor:0.03362761092179224 - timing_per_token_ms/gen:0.31014902659220495 - timing_per_token_ms/ref:0.006461704977459276 - timing_per_token_ms/adv:3.6247023144474286e-05 - perf/total_num_tokens:204871 - perf/time_per_step:32.37425873428583 - perf/throughput:791.0258335236884
[36m(TaskRunner pid=2905377)[0m step:309 - global_seqlen/min:22744 - global_seqlen/max:26040 - global_seqlen/minmax_diff:3296 - global_seqlen/balanced_min:24289 - global_seqlen/balanced_max:24289 - global_seqlen/mean:24289.0 - actor/entropy:0.12886537611484528 - actor/kl_loss:2.003496190905571 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.039104750379920006 - actor/pg_clipfrac:0.03190882026683539 - actor/ppo_kl:0.02279471947113052 - actor/pg_clipfrac_lower:0.002926106611266732 - actor/grad_norm:19.56441903114319 - perf/mfu/actor:0.07436485746208955 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.650390625 - actor/lr:1e-06 - training/global_step:309 - training/epoch:8 - critic/score/mean:1.0787498950958252 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0787498950958252 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.004831228405237198 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.004831228405237198 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:198.03750610351562 - response_length/max:584.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.156841456890106e-05 - timing_s/generate_sequences:17.967792510986328 - timing_s/reshard:0.6575044393539429 - timing_s/gen:20.328045666217804 - timing_s/reward:0.06232487037777901 - timing_s/old_log_prob:1.0675106067210436 - timing_s/ref:1.316352816298604 - timing_s/adv:0.007471140474081039 - timing_s/update_actor:6.930585587397218 - timing_s/step:29.725618567317724 - timing_s/stop_profile:4.515983164310455e-05 - timing_per_token_ms/update_actor:0.035667306123127844 - timing_per_token_ms/gen:0.3207733015561731 - timing_per_token_ms/ref:0.00677442883763537 - timing_per_token_ms/adv:3.844919754868994e-05 - perf/total_num_tokens:194312 - perf/time_per_step:29.725618567317724 - perf/throughput:817.1066295893638
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310
[36m(TaskRunner pid=2905377)[0m step:310 - global_seqlen/min:23805 - global_seqlen/max:26396 - global_seqlen/minmax_diff:2591 - global_seqlen/balanced_min:24844 - global_seqlen/balanced_max:24845 - global_seqlen/mean:24844.625 - actor/entropy:0.131209596991539 - actor/kl_loss:1.7033183783292771 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04415792413055897 - actor/pg_clipfrac:0.015001794975250959 - actor/ppo_kl:0.054761011130176486 - actor/pg_clipfrac_lower:0.0011645411839708685 - actor/grad_norm:12.610119462013245 - perf/mfu/actor:0.07676363994127428 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.69009017944336 - actor/lr:1e-06 - training/global_step:310 - training/epoch:8 - critic/score/mean:0.8806249499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8806249499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0027423182036727667 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0027423182036727667 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:211.38125610351562 - response_length/max:683.0 - response_length/min:19.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.547383964061737e-05 - timing_s/generate_sequences:19.981523513793945 - timing_s/reshard:0.6402493715286255 - timing_s/gen:23.999915638938546 - timing_s/reward:0.06329011544585228 - timing_s/old_log_prob:1.0448029767721891 - timing_s/ref:1.3168142326176167 - timing_s/adv:0.007717704400420189 - timing_s/update_actor:6.873230319470167 - timing_s/save_checkpoint:10.351803993806243 - timing_s/step:43.67095708101988 - timing_s/stop_profile:4.713982343673706e-05 - timing_per_token_ms/update_actor:0.034581072965833494 - timing_per_token_ms/gen:0.3548078950790714 - timing_per_token_ms/ref:0.006625247073650823 - timing_per_token_ms/adv:3.8829849516848154e-05 - perf/total_num_tokens:198757 - perf/time_per_step:43.67095708101988 - perf/throughput:568.9049808069786
[36m(TaskRunner pid=2905377)[0m Training Progress:  59%|█████▉    | 311/525 [4:33:20<2:14:36, 37.74s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:33:39,850:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:33:39,852:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_310/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  59%|█████▉    | 312/525 [4:33:57<2:13:15, 37.54s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  60%|█████▉    | 313/525 [4:34:26<2:04:00, 35.10s/it]
[36m(TaskRunner pid=2905377)[0m step:311 - global_seqlen/min:22777 - global_seqlen/max:27942 - global_seqlen/minmax_diff:5165 - global_seqlen/balanced_min:24481 - global_seqlen/balanced_max:24519 - global_seqlen/mean:24486.25 - actor/entropy:0.13010205328464508 - actor/kl_loss:1.6093862444162368 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04130302853882313 - actor/pg_clipfrac:0.018714809441007674 - actor/ppo_kl:-0.05279051852412522 - actor/pg_clipfrac_lower:0.002654604148119688 - actor/grad_norm:12.478182196617126 - perf/mfu/actor:0.07614257434866983 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.7553482055664 - actor/lr:1e-06 - training/global_step:311 - training/epoch:8 - critic/score/mean:1.0149999856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0149999856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.003544647479429841 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.003544647479429841 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:202.75 - response_length/max:784.0 - response_length/min:19.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.492303848266602e-05 - timing_s/generate_sequences:18.716064453125 - timing_s/reshard:0.8110902309417725 - timing_s/gen:26.85980143211782 - timing_s/reward:0.06254102289676666 - timing_s/old_log_prob:1.0493884794414043 - timing_s/ref:1.3162066210061312 - timing_s/adv:0.0074791330844163895 - timing_s/update_actor:6.826756667345762 - timing_s/step:36.13532352820039 - timing_s/stop_profile:4.042871296405792e-05 - timing_per_token_ms/update_actor:0.03484994980522621 - timing_per_token_ms/gen:0.41399200727678515 - timing_per_token_ms/ref:0.006719110832641437 - timing_per_token_ms/adv:3.818026996996472e-05 - perf/total_num_tokens:195890 - perf/time_per_step:36.13532352820039 - perf/throughput:677.6264222704599
[36m(TaskRunner pid=2905377)[0m step:312 - global_seqlen/min:22868 - global_seqlen/max:27657 - global_seqlen/minmax_diff:4789 - global_seqlen/balanced_min:25041 - global_seqlen/balanced_max:25093 - global_seqlen/mean:25048.375 - actor/entropy:0.13365581631660461 - actor/kl_loss:1.5287488996982574 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09326430968940258 - actor/pg_clipfrac:0.03434282750822604 - actor/ppo_kl:0.048037472064606845 - actor/pg_clipfrac_lower:0.001502094103489071 - actor/grad_norm:12.733933210372925 - perf/mfu/actor:0.07756755364659791 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.7855110168457 - actor/lr:1e-06 - training/global_step:312 - training/epoch:8 - critic/score/mean:0.9774999618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9774999618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.006841100286692381 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.006841100286692381 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:215.60000610351562 - response_length/max:846.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.609375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.475167512893677e-05 - timing_s/generate_sequences:20.278230667114258 - timing_s/reshard:0.6332539916038513 - timing_s/gen:27.63817667774856 - timing_s/reward:0.0635890644043684 - timing_s/old_log_prob:1.1544915325939655 - timing_s/ref:1.3163964170962572 - timing_s/adv:0.007545635104179382 - timing_s/update_actor:6.85939240641892 - timing_s/step:37.05293099209666 - timing_s/stop_profile:4.266016185283661e-05 - timing_per_token_ms/update_actor:0.03423072557810097 - timing_per_token_ms/gen:0.4005997315304464 - timing_per_token_ms/ref:0.0065692705469728935 - timing_per_token_ms/adv:3.765531249122639e-05 - perf/total_num_tokens:200387 - perf/time_per_step:37.05293099209666 - perf/throughput:676.0160216567695
[36m(TaskRunner pid=2905377)[0m step:313 - global_seqlen/min:22601 - global_seqlen/max:25199 - global_seqlen/minmax_diff:2598 - global_seqlen/balanced_min:23854 - global_seqlen/balanced_max:23855 - global_seqlen/mean:23854.375 - actor/entropy:0.12375511974096298 - actor/kl_loss:1.8074595630168915 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.057733367383480075 - actor/pg_clipfrac:0.028111165389418602 - actor/ppo_kl:0.06329730032011867 - actor/pg_clipfrac_lower:0.0025841142400167883 - actor/grad_norm:11.580855131149292 - perf/mfu/actor:0.07285022112916174 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.84827041625977 - actor/lr:1e-06 - training/global_step:313 - training/epoch:8 - critic/score/mean:0.9243749380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9243749380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.002366918371990323 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.002366918371990323 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:187.171875 - response_length/max:537.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.064135909080505e-05 - timing_s/generate_sequences:16.550840377807617 - timing_s/reshard:0.6622371673583984 - timing_s/gen:19.776899183169007 - timing_s/reward:0.06241757236421108 - timing_s/old_log_prob:1.1086528412997723 - timing_s/ref:1.3139412216842175 - timing_s/adv:0.007490525022149086 - timing_s/update_actor:6.943887632340193 - timing_s/step:29.226599426940084 - timing_s/stop_profile:4.301220178604126e-05 - timing_per_token_ms/update_actor:0.03638686631037385 - timing_per_token_ms/gen:0.33019282382784887 - timing_per_token_ms/ref:0.0068852213780712 - timing_per_token_ms/adv:3.925131669845199e-05 - perf/total_num_tokens:190835 - perf/time_per_step:29.226599426940084 - perf/throughput:816.1871537477552
[36m(TaskRunner pid=2905377)[0m Training Progress:  60%|█████▉    | 314/525 [4:35:04<2:06:05, 35.86s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  60%|██████    | 315/525 [4:35:34<1:59:37, 34.18s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  60%|██████    | 316/525 [4:36:07<1:58:18, 33.96s/it]
[36m(TaskRunner pid=2905377)[0m step:314 - global_seqlen/min:22468 - global_seqlen/max:27684 - global_seqlen/minmax_diff:5216 - global_seqlen/balanced_min:24393 - global_seqlen/balanced_max:24403 - global_seqlen/mean:24394.375 - actor/entropy:0.12950223684310913 - actor/kl_loss:2.0510305643081663 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0440170157700777 - actor/pg_clipfrac:0.023941415548324584 - actor/ppo_kl:0.052093320479616526 - actor/pg_clipfrac_lower:0.0011864963220432402 - actor/grad_norm:15.233621835708618 - perf/mfu/actor:0.07531988278241712 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.87135314941406 - actor/lr:1e-06 - training/global_step:314 - training/epoch:8 - critic/score/mean:1.0281250476837158 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0281250476837158 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.027279049158096313 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.027279049158096313 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:200.5625 - response_length/max:887.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.310377597808838e-05 - timing_s/generate_sequences:21.651681900024414 - timing_s/reshard:0.6722196340560913 - timing_s/gen:28.118856206536293 - timing_s/reward:0.06215751729905605 - timing_s/old_log_prob:1.1510141845792532 - timing_s/ref:1.317074254155159 - timing_s/adv:0.0074858516454696655 - timing_s/update_actor:6.875306513160467 - timing_s/step:37.54561684653163 - timing_s/stop_profile:4.161149263381958e-05 - timing_per_token_ms/update_actor:0.03522997880228776 - timing_per_token_ms/gen:0.43812490194042214 - timing_per_token_ms/ref:0.006748862463965356 - timing_per_token_ms/adv:3.8358492713328715e-05 - perf/total_num_tokens:195155 - perf/time_per_step:37.54561684653163 - perf/throughput:649.7263075930391
[36m(TaskRunner pid=2905377)[0m step:315 - global_seqlen/min:20611 - global_seqlen/max:26136 - global_seqlen/minmax_diff:5525 - global_seqlen/balanced_min:24087 - global_seqlen/balanced_max:24088 - global_seqlen/mean:24087.75 - actor/entropy:0.13631783425807953 - actor/kl_loss:1.8543323576450348 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1058801082894206 - actor/pg_clipfrac:0.03564849947579205 - actor/ppo_kl:0.014110705477651208 - actor/pg_clipfrac_lower:0.003861159202642739 - actor/grad_norm:11.111505150794983 - perf/mfu/actor:0.07403421240718126 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.79748916625977 - actor/lr:1e-06 - training/global_step:315 - training/epoch:8 - critic/score/mean:1.0024999380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0024999380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.005591798108071089 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.005591798108071089 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:192.35000610351562 - response_length/max:627.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.385574281215668e-05 - timing_s/generate_sequences:17.340219497680664 - timing_s/reshard:0.6377164125442505 - timing_s/gen:20.903437549248338 - timing_s/reward:0.06185281649231911 - timing_s/old_log_prob:1.0497209634631872 - timing_s/ref:1.3158600851893425 - timing_s/adv:0.007581692188978195 - timing_s/update_actor:6.902513368055224 - timing_s/step:30.254334719851613 - timing_s/stop_profile:4.166737198829651e-05 - timing_per_token_ms/update_actor:0.035819624954879684 - timing_per_token_ms/gen:0.33960614682298446 - timing_per_token_ms/ref:0.0068284713453381 - timing_per_token_ms/adv:3.934412818226171e-05 - perf/total_num_tokens:192702 - perf/time_per_step:30.254334719851613 - perf/throughput:796.1751670643955
[36m(TaskRunner pid=2905377)[0m step:316 - global_seqlen/min:21743 - global_seqlen/max:26108 - global_seqlen/minmax_diff:4365 - global_seqlen/balanced_min:24417 - global_seqlen/balanced_max:24418 - global_seqlen/mean:24417.875 - actor/entropy:0.11788304150104523 - actor/kl_loss:1.6393030375242232 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.036810753867030144 - actor/pg_clipfrac:0.027934817224740983 - actor/ppo_kl:0.04636546302353963 - actor/pg_clipfrac_lower:0.004019492724910379 - actor/grad_norm:16.825880765914917 - perf/mfu/actor:0.07542663184132117 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.73805236816406 - actor/lr:1e-06 - training/global_step:316 - training/epoch:9 - critic/score/mean:0.971875011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.971875011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0010883669601753354 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0010883669601753354 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:201.14999389648438 - response_length/max:645.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00031662918627262115 - timing_s/generate_sequences:18.468341827392578 - timing_s/reshard:0.7611284852027893 - timing_s/gen:22.08809496462345 - timing_s/reward:0.06352482736110687 - timing_s/old_log_prob:1.0433489549905062 - timing_s/ref:1.3268992397934198 - timing_s/adv:0.008807873353362083 - timing_s/update_actor:6.871044652536511 - timing_s/step:31.435743303969502 - timing_s/stop_profile:4.149600863456726e-05 - timing_per_token_ms/update_actor:0.03517425580919977 - timing_per_token_ms/gen:0.3431533520479656 - timing_per_token_ms/ref:0.006792663365431164 - timing_per_token_ms/adv:4.508927042874372e-05 - perf/total_num_tokens:195343 - perf/time_per_step:31.435743303969502 - perf/throughput:776.755133921604
[36m(TaskRunner pid=2905377)[0m Training Progress:  60%|██████    | 317/525 [4:36:42<1:58:26, 34.17s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  61%|██████    | 318/525 [4:37:52<2:34:47, 44.87s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  61%|██████    | 319/525 [4:38:23<2:19:25, 40.61s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:39:50,926:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:39:55,800:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:39:55,802:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 15:39:51,398:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:39:56,610:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/huggingface
[36m(TaskRunner pid=2905377)[0m step:317 - global_seqlen/min:21658 - global_seqlen/max:25458 - global_seqlen/minmax_diff:3800 - global_seqlen/balanced_min:24197 - global_seqlen/balanced_max:24246 - global_seqlen/mean:24203.875 - actor/entropy:0.10640600323677063 - actor/kl_loss:1.7760707587003708 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07864043787121773 - actor/pg_clipfrac:0.01874072588980198 - actor/ppo_kl:0.14907929240725934 - actor/pg_clipfrac_lower:0.002324743231292814 - actor/grad_norm:10.12096917629242 - perf/mfu/actor:0.07232268880107105 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.79579544067383 - actor/lr:1e-06 - training/global_step:317 - training/epoch:9 - critic/score/mean:1.0137500762939453 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0137500762939453 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.015946779400110245 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.015946779400110245 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:196.1281280517578 - response_length/max:769.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.393583655357361e-05 - timing_s/generate_sequences:20.024890899658203 - timing_s/reshard:0.662120521068573 - timing_s/gen:25.014415567740798 - timing_s/reward:0.062233539298176765 - timing_s/old_log_prob:1.1069580987095833 - timing_s/ref:1.3231342565268278 - timing_s/adv:0.007670564576983452 - timing_s/update_actor:7.100304204970598 - timing_s/step:34.62786101549864 - timing_s/stop_profile:4.135258495807648e-05 - timing_per_token_ms/update_actor:0.036669253399355464 - timing_per_token_ms/gen:0.398566236480311 - timing_per_token_ms/ref:0.006833276988327426 - timing_per_token_ms/adv:3.961434159294458e-05 - perf/total_num_tokens:193631 - perf/time_per_step:34.62786101549864 - perf/throughput:698.9711258563415
[36m(TaskRunner pid=2905377)[0m step:318 - global_seqlen/min:21569 - global_seqlen/max:24611 - global_seqlen/minmax_diff:3042 - global_seqlen/balanced_min:23177 - global_seqlen/balanced_max:24423 - global_seqlen/mean:23333.0 - actor/entropy:0.11955685913562775 - actor/kl_loss:1.8728837430477143 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03919754922389984 - actor/pg_clipfrac:0.03269278621301055 - actor/ppo_kl:-0.01785548559273593 - actor/pg_clipfrac_lower:0.0059074948192574086 - actor/grad_norm:17.896974086761475 - perf/mfu/actor:0.07101645047097442 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.93326187133789 - actor/lr:1e-06 - training/global_step:318 - training/epoch:9 - critic/score/mean:1.1243749856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.1243749856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.03641694411635399 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03641694411635399 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:174.1374969482422 - response_length/max:2048.0 - response_length/min:45.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.524581789970398e-05 - timing_s/generate_sequences:28.80736541748047 - timing_s/reshard:0.667481541633606 - timing_s/gen:60.10862045735121 - timing_s/reward:0.06092174910008907 - timing_s/old_log_prob:1.0437943562865257 - timing_s/ref:1.3259638454765081 - timing_s/adv:0.007413256913423538 - timing_s/update_actor:6.969048650935292 - timing_s/step:69.5288751218468 - timing_s/stop_profile:4.2708590626716614e-05 - timing_per_token_ms/update_actor:0.037334722554618414 - timing_per_token_ms/gen:1.0786845965356258 - timing_per_token_ms/ref:0.00710347922189875 - timing_per_token_ms/adv:3.9714443671107116e-05 - perf/total_num_tokens:186664 - perf/time_per_step:69.5288751218468 - perf/throughput:335.5871925025362
[36m(TaskRunner pid=2905377)[0m step:319 - global_seqlen/min:22269 - global_seqlen/max:25502 - global_seqlen/minmax_diff:3233 - global_seqlen/balanced_min:23669 - global_seqlen/balanced_max:23670 - global_seqlen/mean:23669.25 - actor/entropy:0.10274355113506317 - actor/kl_loss:2.2162355184555054 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04534376785159111 - actor/pg_clipfrac:0.03325563503894955 - actor/ppo_kl:0.07304501887410879 - actor/pg_clipfrac_lower:0.004428500728681684 - actor/grad_norm:13.885956287384033 - perf/mfu/actor:0.07359604048676112 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.92703247070312 - actor/lr:1e-06 - training/global_step:319 - training/epoch:9 - critic/score/mean:0.9618749618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9618749618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.04251990467309952 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.04251990467309952 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:182.3249969482422 - response_length/max:592.0 - response_length/min:44.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.02831894159317e-05 - timing_s/generate_sequences:17.817569732666016 - timing_s/reshard:0.845822274684906 - timing_s/gen:21.395382860675454 - timing_s/reward:0.06072329729795456 - timing_s/old_log_prob:1.0489430334419012 - timing_s/ref:1.3155131712555885 - timing_s/adv:0.007419403642416 - timing_s/update_actor:6.820206040516496 - timing_s/step:30.66108407638967 - timing_s/stop_profile:3.9713457226753235e-05 - timing_per_token_ms/update_actor:0.03601828342953672 - timing_per_token_ms/gen:0.36671093618324857 - timing_per_token_ms/ref:0.006947374606586544 - timing_per_token_ms/adv:3.918271408270224e-05 - perf/total_num_tokens:189354 - perf/time_per_step:30.66108407638967 - perf/throughput:771.9638986354798
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320
[36m(TaskRunner pid=2905377)[0m Training Progress:  61%|██████    | 320/525 [4:39:02<2:17:12, 40.16s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  61%|██████    | 321/525 [4:40:14<2:49:01, 49.71s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:39:58,068:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:39:58,071:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_320/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m Training Progress:  61%|██████▏   | 322/525 [4:40:47<2:31:41, 44.83s/it]
[36m(TaskRunner pid=2905377)[0m step:320 - global_seqlen/min:22145 - global_seqlen/max:25397 - global_seqlen/minmax_diff:3252 - global_seqlen/balanced_min:23254 - global_seqlen/balanced_max:23255 - global_seqlen/mean:23254.625 - actor/entropy:0.1147770807147026 - actor/kl_loss:1.9317245364189148 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12273970367386937 - actor/pg_clipfrac:0.03436592323705554 - actor/ppo_kl:-0.026692201383411884 - actor/pg_clipfrac_lower:0.002882414124906063 - actor/grad_norm:18.233925342559814 - perf/mfu/actor:0.0721643204227438 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.91205978393555 - actor/lr:1e-06 - training/global_step:320 - training/epoch:9 - critic/score/mean:0.8912500143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8912500143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.016524946317076683 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.016524946317076683 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:171.85000610351562 - response_length/max:531.0 - response_length/min:48.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.884763181209564e-05 - timing_s/generate_sequences:15.662843704223633 - timing_s/reshard:0.6508498191833496 - timing_s/gen:19.105804724618793 - timing_s/reward:0.05965385586023331 - timing_s/old_log_prob:1.0181800443679094 - timing_s/ref:1.3194392770528793 - timing_s/adv:0.0074232593178749084 - timing_s/update_actor:6.829058995470405 - timing_s/save_checkpoint:10.65274897031486 - timing_s/step:39.005458204075694 - timing_s/stop_profile:0.00012870319187641144 - timing_per_token_ms/update_actor:0.03670806880067086 - timing_per_token_ms/gen:0.3474288028189335 - timing_per_token_ms/ref:0.00709234871048705 - timing_per_token_ms/adv:3.990205882633513e-05 - perf/total_num_tokens:186037 - perf/time_per_step:39.005458204075694 - perf/throughput:596.1889968919816
[36m(TaskRunner pid=2905377)[0m step:321 - global_seqlen/min:21674 - global_seqlen/max:30061 - global_seqlen/minmax_diff:8387 - global_seqlen/balanced_min:23972 - global_seqlen/balanced_max:25084 - global_seqlen/mean:24519.375 - actor/entropy:0.13515497744083405 - actor/kl_loss:2.3714584410190582 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03833614438772202 - actor/pg_clipfrac:0.04111518645659089 - actor/ppo_kl:0.022505034078494645 - actor/pg_clipfrac_lower:0.00550977026578039 - actor/grad_norm:26.2822163105011 - perf/mfu/actor:0.07516205495154607 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.8470458984375 - actor/lr:1e-06 - training/global_step:321 - training/epoch:9 - critic/score/mean:0.90625 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.90625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.015609735623002052 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.015609735623002052 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:203.90625 - response_length/max:2048.0 - response_length/min:61.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.808899343013763e-05 - timing_s/generate_sequences:37.09269714355469 - timing_s/reshard:0.6584028005599976 - timing_s/gen:62.51861551962793 - timing_s/reward:0.06265941075980663 - timing_s/old_log_prob:1.144923685118556 - timing_s/ref:1.3164687510579824 - timing_s/adv:0.007420338690280914 - timing_s/update_actor:6.9387107733637094 - timing_s/step:72.00169554539025 - timing_s/stop_profile:4.347413778305054e-05 - timing_per_token_ms/update_actor:0.035373611548845094 - timing_per_token_ms/gen:0.9581397014502364 - timing_per_token_ms/ref:0.0067113698404730054 - timing_per_token_ms/adv:3.782895511346086e-05 - perf/total_num_tokens:196155 - perf/time_per_step:72.00169554539025 - perf/throughput:340.53885556823946
[36m(TaskRunner pid=2905377)[0m step:322 - global_seqlen/min:21445 - global_seqlen/max:26609 - global_seqlen/minmax_diff:5164 - global_seqlen/balanced_min:23945 - global_seqlen/balanced_max:23946 - global_seqlen/mean:23945.875 - actor/entropy:0.11304367333650589 - actor/kl_loss:1.9891992598772048 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.054807206988334654 - actor/pg_clipfrac:0.018790720123797656 - actor/ppo_kl:0.10397116946987808 - actor/pg_clipfrac_lower:0.0007143128546886146 - actor/grad_norm:13.633279085159302 - perf/mfu/actor:0.07370397620085756 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.86740112304688 - actor/lr:1e-06 - training/global_step:322 - training/epoch:9 - critic/score/mean:1.0028125047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0028125047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.009501369670033455 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.009501369670033455 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:189.02188110351562 - response_length/max:670.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.239302456378937e-05 - timing_s/generate_sequences:17.352048873901367 - timing_s/reshard:0.8397044539451599 - timing_s/gen:24.09251582622528 - timing_s/reward:0.07045364379882812 - timing_s/old_log_prob:1.0396199524402618 - timing_s/ref:1.3197318147867918 - timing_s/adv:0.007396843284368515 - timing_s/update_actor:6.8909522872418165 - timing_s/step:33.433774245902896 - timing_s/stop_profile:4.176422953605652e-05 - timing_per_token_ms/update_actor:0.03597149972198665 - timing_per_token_ms/gen:0.3983089891418864 - timing_per_token_ms/ref:0.006889139647156305 - timing_per_token_ms/adv:3.861230422968734e-05 - perf/total_num_tokens:191567 - perf/time_per_step:33.433774245902896 - perf/throughput:716.2181219469836
[36m(TaskRunner pid=2905377)[0m Training Progress:  62%|██████▏   | 323/525 [4:41:22<2:20:58, 41.87s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  62%|██████▏   | 324/525 [4:41:50<2:06:08, 37.66s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  62%|██████▏   | 325/525 [4:42:20<1:58:19, 35.50s/it]
[36m(TaskRunner pid=2905377)[0m step:323 - global_seqlen/min:22203 - global_seqlen/max:26157 - global_seqlen/minmax_diff:3954 - global_seqlen/balanced_min:24203 - global_seqlen/balanced_max:24204 - global_seqlen/mean:24203.375 - actor/entropy:0.1188560500741005 - actor/kl_loss:2.1786580622196197 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03440521396696568 - actor/pg_clipfrac:0.029249832686036824 - actor/ppo_kl:0.08188062072731554 - actor/pg_clipfrac_lower:0.0025445411331020294 - actor/grad_norm:35.023110151290894 - perf/mfu/actor:0.07497878665756331 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.83972549438477 - actor/lr:1e-06 - training/global_step:323 - training/epoch:9 - critic/score/mean:0.8225000500679016 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8225000500679016 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02152111381292343 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02152111381292343 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:195.24063110351562 - response_length/max:736.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.682852447032928e-05 - timing_s/generate_sequences:19.943103790283203 - timing_s/reshard:0.6593480706214905 - timing_s/gen:25.55291968397796 - timing_s/reward:0.06228011101484299 - timing_s/old_log_prob:1.0618635211139917 - timing_s/ref:1.3224763106554747 - timing_s/adv:0.007462680339813232 - timing_s/update_actor:6.849533244967461 - timing_s/step:34.86955973319709 - timing_s/stop_profile:4.3161213397979736e-05 - timing_per_token_ms/update_actor:0.035374886999062424 - timing_per_token_ms/gen:0.408997225922787 - timing_per_token_ms/ref:0.006830020145204309 - timing_per_token_ms/adv:3.8541527471960176e-05 - perf/total_num_tokens:193627 - perf/time_per_step:34.86955973319709 - perf/throughput:694.1118610384261
[36m(TaskRunner pid=2905377)[0m step:324 - global_seqlen/min:21950 - global_seqlen/max:24822 - global_seqlen/minmax_diff:2872 - global_seqlen/balanced_min:23401 - global_seqlen/balanced_max:23402 - global_seqlen/mean:23401.5 - actor/entropy:0.1251087188720703 - actor/kl_loss:2.2341125518083573 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14304755106568337 - actor/pg_clipfrac:0.05490646936232224 - actor/ppo_kl:0.12351916660554707 - actor/pg_clipfrac_lower:0.004049636400304734 - actor/grad_norm:35.53784680366516 - perf/mfu/actor:0.07269138978164716 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.82880020141602 - actor/lr:1e-06 - training/global_step:324 - training/epoch:9 - critic/score/mean:0.8425000309944153 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8425000309944153 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02304990217089653 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02304990217089653 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:175.95938110351562 - response_length/max:512.0 - response_length/min:36.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.580965757369995e-05 - timing_s/generate_sequences:16.27570152282715 - timing_s/reshard:0.6424516439437866 - timing_s/gen:18.461164930835366 - timing_s/reward:0.060491275042295456 - timing_s/old_log_prob:1.0308824088424444 - timing_s/ref:1.3177357129752636 - timing_s/adv:0.00742766261100769 - timing_s/update_actor:6.822677675634623 - timing_s/step:27.713405944406986 - timing_s/stop_profile:3.9324164390563965e-05 - timing_per_token_ms/update_actor:0.03644359162679007 - timing_per_token_ms/gen:0.32786624985943785 - timing_per_token_ms/ref:0.007038735299955471 - timing_per_token_ms/adv:3.967514160955329e-05 - perf/total_num_tokens:187212 - perf/time_per_step:27.713405944406986 - perf/throughput:844.410825827159
[36m(TaskRunner pid=2905377)[0m step:325 - global_seqlen/min:22271 - global_seqlen/max:25915 - global_seqlen/minmax_diff:3644 - global_seqlen/balanced_min:23640 - global_seqlen/balanced_max:23641 - global_seqlen/mean:23640.625 - actor/entropy:0.11201781779527664 - actor/kl_loss:2.109210395812988 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14499414553865791 - actor/pg_clipfrac:0.04262512931600213 - actor/ppo_kl:-0.006649515317985788 - actor/pg_clipfrac_lower:0.006757205561734736 - actor/grad_norm:19.53957509994507 - perf/mfu/actor:0.0731516207495109 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.88232040405273 - actor/lr:1e-06 - training/global_step:325 - training/epoch:9 - critic/score/mean:0.9231250882148743 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9231250882148743 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.016253292560577393 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.016253292560577393 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:181.28125 - response_length/max:607.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.700547575950623e-05 - timing_s/generate_sequences:17.816261291503906 - timing_s/reshard:0.652097761631012 - timing_s/gen:20.95293272100389 - timing_s/reward:0.061217620968818665 - timing_s/old_log_prob:1.0777116622775793 - timing_s/ref:1.3171496521681547 - timing_s/adv:0.007403852418065071 - timing_s/update_actor:6.851937253028154 - timing_s/step:30.281615478917956 - timing_s/stop_profile:4.225224256515503e-05 - timing_per_token_ms/update_actor:0.036229674834253295 - timing_per_token_ms/gen:0.3611951856749507 - timing_per_token_ms/ref:0.006964439667776099 - timing_per_token_ms/adv:3.9147930829160986e-05 - perf/total_num_tokens:189125 - perf/time_per_step:30.281615478917956 - perf/throughput:780.6923318360803
[36m(TaskRunner pid=2905377)[0m Training Progress:  62%|██████▏   | 326/525 [4:42:55<1:56:48, 35.22s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  62%|██████▏   | 327/525 [4:43:29<1:54:54, 34.82s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  62%|██████▏   | 328/525 [4:44:04<1:54:33, 34.89s/it]
[36m(TaskRunner pid=2905377)[0m step:326 - global_seqlen/min:22411 - global_seqlen/max:25384 - global_seqlen/minmax_diff:2973 - global_seqlen/balanced_min:23759 - global_seqlen/balanced_max:23840 - global_seqlen/mean:23769.125 - actor/entropy:0.10497507452964783 - actor/kl_loss:2.1912849247455597 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1324664896354079 - actor/pg_clipfrac:0.055364290811121465 - actor/ppo_kl:0.22228180021047592 - actor/pg_clipfrac_lower:0.003800472058355808 - actor/grad_norm:22.159311294555664 - perf/mfu/actor:0.07391521834830118 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.93882369995117 - actor/lr:1e-06 - training/global_step:326 - training/epoch:9 - critic/score/mean:0.7434374094009399 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7434374094009399 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.04387923702597618 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04387923702597618 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:184.16561889648438 - response_length/max:766.0 - response_length/min:50.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.577108383178711e-05 - timing_s/generate_sequences:18.671401977539062 - timing_s/reshard:0.7815629839897156 - timing_s/gen:24.77680012024939 - timing_s/reward:0.1280990820378065 - timing_s/old_log_prob:1.2216917350888252 - timing_s/ref:1.3369238432496786 - timing_s/adv:0.0073730312287807465 - timing_s/update_actor:6.8185740280896425 - timing_s/step:34.302457213401794 - timing_s/stop_profile:4.046782851219177e-05 - timing_per_token_ms/update_actor:0.035858356313545635 - timing_per_token_ms/gen:0.42042319447931364 - timing_per_token_ms/ref:0.0070307796524360835 - timing_per_token_ms/adv:3.877420408187484e-05 - perf/total_num_tokens:190153 - perf/time_per_step:34.302457213401794 - perf/throughput:692.9277646825116
[36m(TaskRunner pid=2905377)[0m step:327 - global_seqlen/min:21837 - global_seqlen/max:26009 - global_seqlen/minmax_diff:4172 - global_seqlen/balanced_min:23833 - global_seqlen/balanced_max:23834 - global_seqlen/mean:23833.625 - actor/entropy:0.12125849723815918 - actor/kl_loss:2.393969988822937 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08963122889399529 - actor/pg_clipfrac:0.055713529232889414 - actor/ppo_kl:0.18024349212646484 - actor/pg_clipfrac_lower:0.00407672090223059 - actor/grad_norm:15.281491994857788 - perf/mfu/actor:0.0741668204183794 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.93452835083008 - actor/lr:1e-06 - training/global_step:327 - training/epoch:9 - critic/score/mean:0.5240625143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.5240625143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:0.0016681221313774586 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0016681221313774586 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:186.3249969482422 - response_length/max:704.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.217509508132935e-05 - timing_s/generate_sequences:17.558713912963867 - timing_s/reshard:0.6554017066955566 - timing_s/gen:24.61577721685171 - timing_s/reward:0.060192059725522995 - timing_s/old_log_prob:1.0333337504416704 - timing_s/ref:1.3250258099287748 - timing_s/adv:0.00732516311109066 - timing_s/update_actor:6.814727336168289 - timing_s/step:33.869449159130454 - timing_s/stop_profile:3.981590270996094e-05 - timing_per_token_ms/update_actor:0.0357411395463777 - timing_per_token_ms/gen:0.4128501478742069 - timing_per_token_ms/ref:0.006949351021554499 - timing_per_token_ms/adv:3.841821749256911e-05 - perf/total_num_tokens:190669 - perf/time_per_step:33.869449159130454 - perf/throughput:703.6909542880766
[36m(TaskRunner pid=2905377)[0m step:328 - global_seqlen/min:23798 - global_seqlen/max:24552 - global_seqlen/minmax_diff:754 - global_seqlen/balanced_min:24163 - global_seqlen/balanced_max:24360 - global_seqlen/mean:24187.625 - actor/entropy:0.0966273844242096 - actor/kl_loss:2.4202349901199343 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1455876839812845 - actor/pg_clipfrac:0.06294240243732929 - actor/ppo_kl:0.1568644665181637 - actor/pg_clipfrac_lower:0.005251675983890891 - actor/grad_norm:18.75383472442627 - perf/mfu/actor:0.07525070754927234 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.90442276000977 - actor/lr:1e-06 - training/global_step:328 - training/epoch:9 - critic/score/mean:0.413750022649765 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.413750022649765 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.009917613118886948 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888476848602295 - critic/returns/mean:-0.009917613118886948 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888476848602295 - response_length/mean:194.7375030517578 - response_length/max:802.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010098330676555634 - timing_s/generate_sequences:17.96141815185547 - timing_s/reshard:0.7728113532066345 - timing_s/gen:25.643284264951944 - timing_s/reward:0.061115898191928864 - timing_s/old_log_prob:1.0915814824402332 - timing_s/ref:1.3307640459388494 - timing_s/adv:0.0073810722678899765 - timing_s/update_actor:6.817216558381915 - timing_s/step:34.96466104313731 - timing_s/stop_profile:4.256516695022583e-05 - timing_per_token_ms/update_actor:0.035230911253078354 - timing_per_token_ms/gen:0.4115040160625192 - timing_per_token_ms/ref:0.006877298029151526 - timing_per_token_ms/adv:3.814487918868624e-05 - perf/total_num_tokens:193501 - perf/time_per_step:34.96466104313731 - perf/throughput:691.7734729405428
[36m(TaskRunner pid=2905377)[0m Training Progress:  63%|██████▎   | 329/525 [4:44:36<1:51:06, 34.01s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:46:04,113:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 15:46:08,568:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906989)[0m INFO:2025-08-04 15:46:08,570:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 15:46:04,372:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:46:09,540:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  63%|██████▎   | 330/525 [4:45:14<1:54:58, 35.38s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  63%|██████▎   | 331/525 [4:45:43<1:47:34, 33.27s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:46:10,813:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:46:10,816:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2905377)[0m step:329 - global_seqlen/min:23217 - global_seqlen/max:25865 - global_seqlen/minmax_diff:2648 - global_seqlen/balanced_min:24357 - global_seqlen/balanced_max:24358 - global_seqlen/mean:24357.625 - actor/entropy:0.08506421744823456 - actor/kl_loss:2.17239630818367 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11943885968066752 - actor/pg_clipfrac:0.05193827375769615 - actor/ppo_kl:0.18067831508815288 - actor/pg_clipfrac_lower:0.004251229763031006 - actor/grad_norm:18.5832302570343 - perf/mfu/actor:0.07329772015077204 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.91072082519531 - actor/lr:1e-06 - training/global_step:329 - training/epoch:9 - critic/score/mean:0.3921875059604645 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.3921875059604645 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.00532913813367486 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.00532913813367486 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:199.2062530517578 - response_length/max:659.0 - response_length/min:31.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:6.07464462518692e-05 - timing_s/generate_sequences:17.718774795532227 - timing_s/reshard:0.6476931571960449 - timing_s/gen:22.419522557407618 - timing_s/reward:0.10905315168201923 - timing_s/old_log_prob:1.034969873726368 - timing_s/ref:1.323298167437315 - timing_s/adv:0.007395902648568153 - timing_s/update_actor:7.048526851460338 - timing_s/step:31.955777497962117 - timing_s/stop_profile:4.301778972148895e-05 - timing_per_token_ms/update_actor:0.036172075743531734 - timing_per_token_ms/gen:0.3517008527187214 - timing_per_token_ms/ref:0.006790985201950698 - timing_per_token_ms/adv:3.795476082216633e-05 - perf/total_num_tokens:194861 - perf/time_per_step:31.955777497962117 - perf/throughput:762.2291462491668
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_330
[36m(TaskRunner pid=2905377)[0m step:330 - global_seqlen/min:24225 - global_seqlen/max:26125 - global_seqlen/minmax_diff:1900 - global_seqlen/balanced_min:25217 - global_seqlen/balanced_max:25218 - global_seqlen/mean:25217.75 - actor/entropy:0.08096475899219513 - actor/kl_loss:1.9585308611392975 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02598663903772831 - actor/pg_clipfrac:0.020001249201595784 - actor/ppo_kl:-9.301693644374609e-05 - actor/pg_clipfrac_lower:0.0019385165069252253 - actor/grad_norm:14.345455408096313 - perf/mfu/actor:0.07788919919616592 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.85416793823242 - actor/lr:1e-06 - training/global_step:330 - training/epoch:9 - critic/score/mean:0.3140625059604645 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.3140625059604645 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.007907235063612461 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.007907235063612461 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:220.81875610351562 - response_length/max:533.0 - response_length/min:80.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:5.830638110637665e-05 - timing_s/generate_sequences:14.900667190551758 - timing_s/reshard:0.7060219645500183 - timing_s/gen:19.062870459631085 - timing_s/reward:0.06269638054072857 - timing_s/old_log_prob:1.0321281123906374 - timing_s/ref:1.3373566810041666 - timing_s/adv:0.007470373064279556 - timing_s/update_actor:6.873989274725318 - timing_s/save_checkpoint:10.149387925863266 - timing_s/step:38.539002668112516 - timing_s/stop_profile:4.600919783115387e-05 - timing_per_token_ms/update_actor:0.034073169071018025 - timing_per_token_ms/gen:0.2697754162015098 - timing_per_token_ms/ref:0.006629044428052496 - timing_per_token_ms/adv:3.7029339771983803e-05 - perf/total_num_tokens:201742 - perf/time_per_step:38.539002668112516 - perf/throughput:654.3436065839185
[36m(TaskRunner pid=2905377)[0m step:331 - global_seqlen/min:24138 - global_seqlen/max:25588 - global_seqlen/minmax_diff:1450 - global_seqlen/balanced_min:24910 - global_seqlen/balanced_max:24911 - global_seqlen/mean:24910.625 - actor/entropy:0.06716682016849518 - actor/kl_loss:1.7798860728740693 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.034939119778573516 - actor/pg_clipfrac:0.008020482584834098 - actor/ppo_kl:0.02113051190972328 - actor/pg_clipfrac_lower:0.00015337422955781222 - actor/grad_norm:9.902984857559204 - perf/mfu/actor:0.0762579601797779 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.95053100585938 - actor/lr:1e-06 - training/global_step:331 - training/epoch:9 - critic/score/mean:0.19812503457069397 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.19812503457069397 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.002706571714952588 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.002706571714952588 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:213.25 - response_length/max:512.0 - response_length/min:108.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.634609937667847e-05 - timing_s/generate_sequences:15.684161186218262 - timing_s/reshard:0.6604232788085938 - timing_s/gen:18.83345534838736 - timing_s/reward:0.06250305660068989 - timing_s/old_log_prob:1.0510574243962765 - timing_s/ref:1.3464916124939919 - timing_s/adv:0.011107144877314568 - timing_s/update_actor:6.935404038056731 - timing_s/step:28.258642300963402 - timing_s/stop_profile:4.3954700231552124e-05 - timing_per_token_ms/update_actor:0.03480143532155823 - timing_per_token_ms/gen:0.27598850158832594 - timing_per_token_ms/ref:0.006756612953779721 - timing_per_token_ms/adv:5.573497692909435e-05 - perf/total_num_tokens:199285 - perf/time_per_step:28.258642300963402 - perf/throughput:881.5223581760947
[36m(TaskRunner pid=2905377)[0m Training Progress:  63%|██████▎   | 332/525 [4:46:18<1:48:38, 33.77s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  63%|██████▎   | 333/525 [4:47:17<2:13:03, 41.58s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  64%|██████▎   | 334/525 [4:48:38<2:49:39, 53.30s/it]
[36m(TaskRunner pid=2905377)[0m step:332 - global_seqlen/min:24491 - global_seqlen/max:28318 - global_seqlen/minmax_diff:3827 - global_seqlen/balanced_min:25376 - global_seqlen/balanced_max:25376 - global_seqlen/mean:25376.0 - actor/entropy:0.07478196173906326 - actor/kl_loss:1.6695184409618378 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.01662175953388214 - actor/pg_clipfrac:0.020187355391681195 - actor/ppo_kl:-0.1827451393706724 - actor/pg_clipfrac_lower:0.005141700617969036 - actor/grad_norm:13.064933359622955 - perf/mfu/actor:0.07433092643654306 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.97251510620117 - actor/lr:1e-06 - training/global_step:332 - training/epoch:9 - critic/score/mean:0.1640625 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.1640625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.006420118268579245 - critic/advantages/max:1.7888476848602295 - critic/advantages/min:-1.7888476848602295 - critic/returns/mean:-0.006420118268579245 - critic/returns/max:1.7888476848602295 - critic/returns/min:-1.7888476848602295 - response_length/mean:224.88436889648438 - response_length/max:699.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001046154648065567 - timing_s/generate_sequences:17.035093307495117 - timing_s/reshard:0.6457271575927734 - timing_s/gen:25.070673871785402 - timing_s/reward:0.07467159070074558 - timing_s/old_log_prob:1.0587554406374693 - timing_s/ref:1.347403097897768 - timing_s/adv:0.01023087464272976 - timing_s/update_actor:7.251455318182707 - timing_s/step:34.831083895638585 - timing_s/stop_profile:5.9565529227256775e-05 - timing_per_token_ms/update_actor:0.0357200470827884 - timing_per_token_ms/gen:0.3483828338421884 - timing_per_token_ms/ref:0.00663719212000398 - timing_per_token_ms/adv:5.039641118936081e-05 - perf/total_num_tokens:203008 - perf/time_per_step:34.831083895638585 - perf/throughput:728.5446549993089
[36m(TaskRunner pid=2905377)[0m step:333 - global_seqlen/min:27202 - global_seqlen/max:29561 - global_seqlen/minmax_diff:2359 - global_seqlen/balanced_min:28412 - global_seqlen/balanced_max:29204 - global_seqlen/mean:28511.0 - actor/entropy:0.05470864474773407 - actor/kl_loss:1.4571590557694436 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16856836080551146 - actor/pg_clipfrac:0.02206554147414863 - actor/ppo_kl:-0.5661659060046077 - actor/pg_clipfrac_lower:0.025898147525731476 - actor/grad_norm:10.354851722717285 - perf/mfu/actor:0.08641438874352465 - perf/max_memory_allocated_gb:64.7486891746521 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:92.97899627685547 - actor/lr:1e-06 - training/global_step:333 - training/epoch:9 - critic/score/mean:0.18000000715255737 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.18000000715255737 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.031930144876241684 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.031930144876241684 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:303.0406188964844 - response_length/max:1633.0 - response_length/min:6.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011277571320533752 - timing_s/generate_sequences:28.35036849975586 - timing_s/reshard:0.7083194851875305 - timing_s/gen:49.86618438921869 - timing_s/reward:0.06656510196626186 - timing_s/old_log_prob:1.1820803713053465 - timing_s/ref:1.3910059332847595 - timing_s/adv:0.008450141176581383 - timing_s/update_actor:7.036233503371477 - timing_s/step:59.5682761631906 - timing_s/stop_profile:4.380568861961365e-05 - timing_per_token_ms/update_actor:0.030848766718860603 - timing_per_token_ms/gen:0.5142275106392366 - timing_per_token_ms/ref:0.0060985493900808435 - timing_per_token_ms/adv:3.704772358292143e-05 - perf/total_num_tokens:228088 - perf/time_per_step:59.5682761631906 - perf/throughput:478.62724652116054
[36m(TaskRunner pid=2905377)[0m step:334 - global_seqlen/min:50276 - global_seqlen/max:65791 - global_seqlen/minmax_diff:15515 - global_seqlen/balanced_min:57290 - global_seqlen/balanced_max:57291 - global_seqlen/mean:57290.75 - actor/entropy:0.01166932936757803 - actor/kl_loss:0.4627997200936079 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.024819642957299947 - actor/pg_clipfrac:0.007847883040085435 - actor/ppo_kl:-0.012234513859584694 - actor/pg_clipfrac_lower:0.0009417318389751018 - actor/grad_norm:7.60942006111145 - perf/mfu/actor:0.14937357512997917 - perf/max_memory_allocated_gb:69.08892440795898 - perf/max_memory_reserved_gb:92.798828125 - perf/cpu_memory_used_gb:93.03392791748047 - actor/lr:1e-06 - training/global_step:334 - training/epoch:9 - critic/score/mean:0.1393750011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.1393750011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.02475995197892189 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02475995197892189 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:1023.0812377929688 - response_length/max:2048.0 - response_length/min:45.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010982528328895569 - timing_s/generate_sequences:62.94887924194336 - timing_s/reshard:0.6596707701683044 - timing_s/gen:68.26700306497514 - timing_s/reward:0.10601263120770454 - timing_s/old_log_prob:1.826517902314663 - timing_s/ref:1.5976476110517979 - timing_s/adv:0.008817119523882866 - timing_s/update_actor:8.502931958064437 - timing_s/step:80.32632218487561 - timing_s/stop_profile:4.5688822865486145e-05 - timing_per_token_ms/update_actor:0.01855214837924193 - timing_per_token_ms/gen:0.2085214488859485 - timing_per_token_ms/ref:0.0034858323792492634 - timing_per_token_ms/adv:1.9237659491023565e-05 - perf/total_num_tokens:458326 - perf/time_per_step:80.32632218487561 - perf/throughput:713.2251102962498
[36m(TaskRunner pid=2905377)[0m Training Progress:  64%|██████▍   | 335/525 [4:50:04<3:19:49, 63.10s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  64%|██████▍   | 336/525 [4:51:29<3:39:13, 69.59s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  64%|██████▍   | 337/525 [4:52:51<3:49:46, 73.33s/it]
[36m(TaskRunner pid=2905377)[0m step:335 - global_seqlen/min:72196 - global_seqlen/max:93735 - global_seqlen/minmax_diff:21539 - global_seqlen/balanced_min:83185 - global_seqlen/balanced_max:83188 - global_seqlen/mean:83186.5 - actor/entropy:0.002762242453172803 - actor/kl_loss:0.09505397602915763 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07351157441735268 - actor/pg_clipfrac:0.001607999426778406 - actor/ppo_kl:0.00375797301530838 - actor/pg_clipfrac_lower:0.00012204878148622811 - actor/grad_norm:1.5482196360826492 - perf/mfu/actor:0.20026498077630658 - perf/max_memory_allocated_gb:74.23688650131226 - perf/max_memory_reserved_gb:95.275390625 - perf/cpu_memory_used_gb:93.19692611694336 - actor/lr:1e-06 - training/global_step:335 - training/epoch:9 - critic/score/mean:0.10187500715255737 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.10187500715255737 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.05127152055501938 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.4536292552947998 - critic/returns/mean:-0.05127152055501938 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.4536292552947998 - response_length/mean:1670.2562255859375 - response_length/max:2048.0 - response_length/min:69.0 - response_length/clip_ratio:0.612500011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.790327072143555e-05 - timing_s/generate_sequences:69.64248657226562 - timing_s/reshard:0.7664960026741028 - timing_s/gen:72.11416131258011 - timing_s/reward:0.13915094919502735 - timing_s/old_log_prob:2.2941666655242443 - timing_s/ref:1.9745371229946613 - timing_s/adv:0.008258886635303497 - timing_s/update_actor:9.423297557979822 - timing_s/step:85.97107278555632 - timing_s/stop_profile:4.61433082818985e-05 - timing_per_token_ms/update_actor:0.01415989607385186 - timing_per_token_ms/gen:0.13492346105683653 - timing_per_token_ms/ref:0.0029670335976911236 - timing_per_token_ms/adv:1.2410196719575137e-05 - perf/total_num_tokens:665492 - perf/time_per_step:85.97107278555632 - perf/throughput:967.6103520017475
[36m(TaskRunner pid=2905377)[0m step:336 - global_seqlen/min:62980 - global_seqlen/max:81272 - global_seqlen/minmax_diff:18292 - global_seqlen/balanced_min:72562 - global_seqlen/balanced_max:73258 - global_seqlen/mean:72673.5 - actor/entropy:0.008524925448000431 - actor/kl_loss:0.4603887924924493 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1379316333681345 - actor/pg_clipfrac:0.01079521601786837 - actor/ppo_kl:-0.08580705389613286 - actor/pg_clipfrac_lower:0.005739465658552945 - actor/grad_norm:9.029063194990158 - perf/mfu/actor:0.1794598368602039 - perf/max_memory_allocated_gb:74.237069606781 - perf/max_memory_reserved_gb:119.451171875 - perf/cpu_memory_used_gb:93.15705871582031 - actor/lr:1e-06 - training/global_step:336 - training/epoch:9 - critic/score/mean:0.24687497317790985 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.24687497317790985 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08715897053480148 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.08715897053480148 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:1406.9937744140625 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.6312500238418579 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010607205331325531 - timing_s/generate_sequences:68.96843719482422 - timing_s/reshard:0.8983325362205505 - timing_s/gen:71.05279163271189 - timing_s/reward:0.13267166167497635 - timing_s/old_log_prob:2.3002656493335962 - timing_s/ref:1.9478932991623878 - timing_s/adv:0.008385445922613144 - timing_s/update_actor:9.172069231048226 - timing_s/step:84.63179622963071 - timing_s/stop_profile:4.2945146560668945e-05 - timing_per_token_ms/update_actor:0.015776158488046237 - timing_per_token_ms/gen:0.15781162770070914 - timing_per_token_ms/ref:0.003350418823853241 - timing_per_token_ms/adv:1.4423149295501702e-05 - perf/total_num_tokens:581388 - perf/time_per_step:84.63179622963071 - perf/throughput:858.7020864216994
[36m(TaskRunner pid=2905377)[0m step:337 - global_seqlen/min:40738 - global_seqlen/max:68208 - global_seqlen/minmax_diff:27470 - global_seqlen/balanced_min:52533 - global_seqlen/balanced_max:52613 - global_seqlen/mean:52543.875 - actor/entropy:0.01885928027331829 - actor/kl_loss:1.0253916263580323 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08288756785914302 - actor/pg_clipfrac:0.018944183737039565 - actor/ppo_kl:-0.06019327314570546 - actor/pg_clipfrac_lower:0.0020768835427588785 - actor/grad_norm:12.69212782382965 - perf/mfu/actor:0.12726941358879806 - perf/max_memory_allocated_gb:74.237069606781 - perf/max_memory_reserved_gb:119.451171875 - perf/cpu_memory_used_gb:93.13113021850586 - actor/lr:1e-06 - training/global_step:337 - training/epoch:9 - critic/score/mean:0.41749995946884155 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.41749995946884155 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.35515347123146057 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.35515347123146057 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:903.6437377929688 - response_length/max:2048.0 - response_length/min:51.0 - response_length/clip_ratio:0.37187498807907104 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.19917768239975e-05 - timing_s/generate_sequences:66.63021087646484 - timing_s/reshard:1.0217573642730713 - timing_s/gen:69.14520618133247 - timing_s/reward:0.11418374627828598 - timing_s/old_log_prob:1.8899110686033964 - timing_s/ref:1.633757719770074 - timing_s/adv:0.008408084511756897 - timing_s/update_actor:9.234347769990563 - timing_s/step:82.04336806759238 - timing_s/stop_profile:4.090555012226105e-05 - timing_per_token_ms/update_actor:0.021968183184982462 - timing_per_token_ms/gen:0.23911941992257896 - timing_per_token_ms/ref:0.003886651202852078 - timing_per_token_ms/adv:2.0002532435409685e-05 - perf/total_num_tokens:420351 - perf/time_per_step:82.04336806759238 - perf/throughput:640.4402480979464
[36m(TaskRunner pid=2905377)[0m Training Progress:  64%|██████▍   | 338/525 [4:54:08<3:52:29, 74.60s/it]
[36m(TaskRunner pid=2905377)[0m Training Progress:  65%|██████▍   | 339/525 [4:55:25<3:52:48, 75.10s/it]
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:57:40,003:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2906987)[0m INFO:2025-08-04 15:57:44,816:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2906988)[0m INFO:2025-08-04 15:57:44,745:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2906983)[0m INFO:2025-08-04 15:57:40,490:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906719)[0m INFO:2025-08-04 15:57:45,560:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/huggingface
[36m(TaskRunner pid=2905377)[0m Training Progress:  65%|██████▍   | 340/525 [4:56:51<4:01:36, 78.36s/it]
[36m(TaskRunner pid=2905377)[0m step:338 - global_seqlen/min:28934 - global_seqlen/max:44773 - global_seqlen/minmax_diff:15839 - global_seqlen/balanced_min:36564 - global_seqlen/balanced_max:37986 - global_seqlen/mean:37108.0 - actor/entropy:0.029781173914670944 - actor/kl_loss:1.477761708945036 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.3349996358156204 - actor/pg_clipfrac:0.0468319462495856 - actor/ppo_kl:0.0063324408838525414 - actor/pg_clipfrac_lower:0.007239856320666149 - actor/grad_norm:18.959057569503784 - perf/mfu/actor:0.10522969933265344 - perf/max_memory_allocated_gb:74.237069606781 - perf/max_memory_reserved_gb:119.451171875 - perf/cpu_memory_used_gb:93.13004302978516 - actor/lr:1e-06 - training/global_step:338 - training/epoch:9 - critic/score/mean:0.7725000381469727 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7725000381469727 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.45977625250816345 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.45977625250816345 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:517.9656372070312 - response_length/max:2048.0 - response_length/min:56.0 - response_length/clip_ratio:0.18437500298023224 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.9374760389328e-05 - timing_s/generate_sequences:63.988121032714844 - timing_s/reshard:0.7375744581222534 - timing_s/gen:66.81726459227502 - timing_s/reward:0.09037477895617485 - timing_s/old_log_prob:1.4376709796488285 - timing_s/ref:1.3983262944966555 - timing_s/adv:0.010129457339644432 - timing_s/update_actor:7.761196330189705 - timing_s/step:77.53245371766388 - timing_s/stop_profile:4.421360790729523e-05 - timing_per_token_ms/update_actor:0.02614394581421023 - timing_per_token_ms/gen:0.4031231838036732 - timing_per_token_ms/ref:0.004710326258814324 - timing_per_token_ms/adv:3.412154164750334e-05 - perf/total_num_tokens:296864 - perf/time_per_step:77.53245371766388 - perf/throughput:478.6124805894779
[36m(TaskRunner pid=2905377)[0m step:339 - global_seqlen/min:23532 - global_seqlen/max:37676 - global_seqlen/minmax_diff:14144 - global_seqlen/balanced_min:29135 - global_seqlen/balanced_max:30442 - global_seqlen/mean:29713.625 - actor/entropy:0.04734672233462334 - actor/kl_loss:1.7507202208042145 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09107768200337887 - actor/pg_clipfrac:0.03427201046142727 - actor/ppo_kl:-0.05560060556745157 - actor/pg_clipfrac_lower:0.0019285824469989165 - actor/grad_norm:13.207777500152588 - perf/mfu/actor:0.08186819737353196 - perf/max_memory_allocated_gb:74.237069606781 - perf/max_memory_reserved_gb:119.451171875 - perf/cpu_memory_used_gb:93.13164901733398 - actor/lr:1e-06 - training/global_step:339 - training/epoch:9 - critic/score/mean:0.8103124499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8103124499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.41761815547943115 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.41761815547943115 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:332.45001220703125 - response_length/max:2048.0 - response_length/min:50.0 - response_length/clip_ratio:0.08437500149011612 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0001162942498922348 - timing_s/generate_sequences:63.756004333496094 - timing_s/reshard:0.6763293147087097 - timing_s/gen:65.49368609115481 - timing_s/reward:0.07510676048696041 - timing_s/old_log_prob:1.3338386174291372 - timing_s/ref:1.36506362631917 - timing_s/adv:0.0075028445571660995 - timing_s/update_actor:7.860804678872228 - timing_s/step:76.15014149993658 - timing_s/stop_profile:4.3410807847976685e-05 - timing_per_token_ms/update_actor:0.033069024222356865 - timing_per_token_ms/gen:0.6156347391633593 - timing_per_token_ms/ref:0.005742582848437249 - timing_per_token_ms/adv:3.15631488802111e-05 - perf/total_num_tokens:237709 - perf/time_per_step:76.15014149993658 - perf/throughput:390.19789608696584
[36m(TaskRunner pid=2905377)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340
[36m(TaskRunner pid=2905377)[0m step:340 - global_seqlen/min:23300 - global_seqlen/max:33125 - global_seqlen/minmax_diff:9825 - global_seqlen/balanced_min:27269 - global_seqlen/balanced_max:28365 - global_seqlen/mean:27997.625 - actor/entropy:0.05305635556578636 - actor/kl_loss:2.3921047158539297 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06115144020877779 - actor/pg_clipfrac:0.04119018520577811 - actor/ppo_kl:-0.06257259049452842 - actor/pg_clipfrac_lower:0.007381121779326349 - actor/grad_norm:16.37648582458496 - perf/mfu/actor:0.07968008154849673 - perf/max_memory_allocated_gb:74.237069606781 - perf/max_memory_reserved_gb:119.451171875 - perf/cpu_memory_used_gb:93.06725311279297 - actor/lr:1e-06 - training/global_step:340 - training/epoch:9 - critic/score/mean:0.8634374737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8634374737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.44534745812416077 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.44534745812416077 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:290.97186279296875 - response_length/max:2048.0 - response_length/min:65.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.178688585758209e-05 - timing_s/generate_sequences:61.82358169555664 - timing_s/reshard:0.7467295527458191 - timing_s/gen:65.07424408383667 - timing_s/reward:0.07019435800611973 - timing_s/old_log_prob:1.253447251394391 - timing_s/ref:1.341440200805664 - timing_s/adv:0.007624249905347824 - timing_s/update_actor:7.5796227902174 - timing_s/save_checkpoint:10.527604600414634 - timing_s/step:85.86722098663449 - timing_s/stop_profile:4.8432499170303345e-05 - timing_per_token_ms/update_actor:0.033840472139232344 - timing_per_token_ms/gen:0.6988888969491969 - timing_per_token_ms/ref:0.005989080327374483 - timing_per_token_ms/adv:3.403971723203229e-05 - perf/total_num_tokens:223981 - perf/time_per_step:85.86722098663449 - perf/throughput:326.05719246879926
[36m(TaskRunner pid=2905377)[0m Training Progress:  65%|██████▍   | 341/525 [4:58:07<3:58:21, 77.73s/it]
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:57:47,111:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2906986)[0m INFO:2025-08-04 15:57:47,114:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
