nohup: ignoring input
+ ENGINE=vllm
+ project_name=MATH
+ exp_name=grpo_0805
+ export USE_OPTIMIZED_MODEL=0
+ export WANDB_API_KEY=09395dec0812221d976e6fc6c165ba95070ed686
+ CKPTS_DIR=/gemini/platform/public/NLP/model/project_model/math/grpo_0805
+ MODEL_PATH=/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct
+ TRAIN_FILE=/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/train.parquet
+ TEST_FILE=/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/test.parquet
+ tee log/grpo_0805.log
+ python3 -m verl.trainer.main_ppo algorithm.adv_estimator=grpo data.train_files=/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/train.parquet data.val_files=/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/test.parquet data.train_batch_size=64 data.max_prompt_length=1024 data.max_response_length=2048 data.filter_overlong_prompts=True data.truncation=error data.image_key=images data.return_multi_modal_inputs=False actor_rollout_ref.model.path=/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.ppo_mini_batch_size=16 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=2 actor_rollout_ref.actor.use_kl_loss=True actor_rollout_ref.actor.kl_loss_coef=0.01 actor_rollout_ref.actor.kl_loss_type=low_var_kl actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.actor.use_torch_compile=False actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=4 actor_rollout_ref.rollout.tensor_model_parallel_size=2 actor_rollout_ref.rollout.name=vllm actor_rollout_ref.rollout.engine_kwargs.vllm.disable_mm_preprocessor_cache=True actor_rollout_ref.rollout.gpu_memory_utilization=0.8 actor_rollout_ref.rollout.enable_chunked_prefill=False actor_rollout_ref.rollout.enforce_eager=True actor_rollout_ref.rollout.free_cache_engine=True actor_rollout_ref.rollout.n=5 actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=4 actor_rollout_ref.ref.fsdp_config.param_offload=False algorithm.use_kl_in_reward=False trainer.critic_warmup=0 trainer.logger=["console","wandb"] trainer.project_name=grpo_math_0803 trainer.experiment_name=qwen2_5_vl_3b_function_rm trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.save_freq=10 trainer.test_freq=50 trainer.total_epochs=15 trainer.default_local_dir=/gemini/platform/public/NLP/model/project_model/math/grpo_0805 trainer.resume_mode=auto
2025-08-05 23:35:54,066	INFO worker.py:1879 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=2949575)[0m TaskRunner hostname: c9b4e48bcef9567f98037c541e0f5862-taskrole1-0, PID: 2949575
[36m(TaskRunner pid=2949575)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2949575)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2949575)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2949575)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2949575)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2949575)[0m                                                                   'extra'],
[36m(TaskRunner pid=2949575)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2949575)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2949575)[0m                                                                   'extra']},
[36m(TaskRunner pid=2949575)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2949575)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2949575)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2949575)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2949575)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2949575)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2949575)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2949575)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2949575)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=2949575)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=2949575)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=2949575)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2949575)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2949575)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=2949575)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2949575)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2949575)[0m                                  'kl_loss_coef': 0.01,
[36m(TaskRunner pid=2949575)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2949575)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2949575)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2949575)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2949575)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2949575)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2949575)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2949575)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=2949575)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2949575)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2949575)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2949575)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2949575)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2949575)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2949575)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2949575)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2949575)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=2949575)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2949575)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2949575)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2949575)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2949575)[0m                                  'ppo_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=2949575)[0m                                  'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=2949575)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2949575)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2949575)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2949575)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2949575)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2949575)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=2949575)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2949575)[0m                                  'use_torch_compile': False},
[36m(TaskRunner pid=2949575)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2949575)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=2949575)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=2949575)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2949575)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2949575)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2949575)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2949575)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2949575)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2949575)[0m                                  'override_config': {},
[36m(TaskRunner pid=2949575)[0m                                  'path': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2949575)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2949575)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2949575)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2949575)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2949575)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2949575)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2949575)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2949575)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=2949575)[0m                                     'discrete': False,
[36m(TaskRunner pid=2949575)[0m                                     'ranks': []},
[36m(TaskRunner pid=2949575)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=2949575)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2949575)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2949575)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=2949575)[0m                                                'param_offload': False,
[36m(TaskRunner pid=2949575)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=2949575)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2949575)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2949575)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2949575)[0m                                'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2949575)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2949575)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2949575)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2949575)[0m                                'use_torch_compile': False},
[36m(TaskRunner pid=2949575)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=2949575)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=2949575)[0m                                                                      'path': None},
[36m(TaskRunner pid=2949575)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2949575)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2949575)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2949575)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2949575)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2949575)[0m                                    'enable_chunked_prefill': False,
[36m(TaskRunner pid=2949575)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2949575)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=2949575)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': True,
[36m(TaskRunner pid=2949575)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=2949575)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2949575)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=2949575)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2949575)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=2949575)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2949575)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2949575)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2949575)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2949575)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2949575)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2949575)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2949575)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2949575)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=2949575)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2949575)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=2949575)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2949575)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=2949575)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2949575)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2949575)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2949575)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=2949575)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2949575)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2949575)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2949575)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2949575)[0m                                    'n': 5,
[36m(TaskRunner pid=2949575)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2949575)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2949575)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=2949575)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2949575)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=2949575)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2949575)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2949575)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=2949575)[0m                                              'token2text': False},
[36m(TaskRunner pid=2949575)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2949575)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2949575)[0m                                                   'n': 1,
[36m(TaskRunner pid=2949575)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2949575)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2949575)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2949575)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2949575)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=2949575)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2949575)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2949575)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2949575)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2949575)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2949575)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2949575)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2949575)[0m                'lam': 1.0,
[36m(TaskRunner pid=2949575)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2949575)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2949575)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2949575)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2949575)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=2949575)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2949575)[0m                            'async_save': False,
[36m(TaskRunner pid=2949575)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2949575)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2949575)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2949575)[0m             'enable': None,
[36m(TaskRunner pid=2949575)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2949575)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2949575)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2949575)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2949575)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2949575)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=2949575)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=2949575)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2949575)[0m                       'external_lib': None,
[36m(TaskRunner pid=2949575)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2949575)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=2949575)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=2949575)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=2949575)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2949575)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2949575)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=2949575)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2949575)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=2949575)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=2949575)[0m                       'override_config': {},
[36m(TaskRunner pid=2949575)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2949575)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=2949575)[0m                       'tokenizer_path': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2949575)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=2949575)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=2949575)[0m                       'use_shm': False},
[36m(TaskRunner pid=2949575)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2949575)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2949575)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2949575)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2949575)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2949575)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2949575)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2949575)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2949575)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2949575)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2949575)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2949575)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2949575)[0m             'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=2949575)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2949575)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2949575)[0m                          'discrete': False,
[36m(TaskRunner pid=2949575)[0m                          'ranks': []},
[36m(TaskRunner pid=2949575)[0m             'rollout_n': 5,
[36m(TaskRunner pid=2949575)[0m             'shuffle': False,
[36m(TaskRunner pid=2949575)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2949575)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2949575)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2949575)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2949575)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2949575)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2949575)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2949575)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=2949575)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2949575)[0m           'image_key': 'images',
[36m(TaskRunner pid=2949575)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2949575)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=2949575)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2949575)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2949575)[0m           'return_multi_modal_inputs': False,
[36m(TaskRunner pid=2949575)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2949575)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2949575)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2949575)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2949575)[0m           'shuffle': True,
[36m(TaskRunner pid=2949575)[0m           'tokenizer': None,
[36m(TaskRunner pid=2949575)[0m           'train_batch_size': 64,
[36m(TaskRunner pid=2949575)[0m           'train_files': '/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/train.parquet',
[36m(TaskRunner pid=2949575)[0m           'truncation': 'error',
[36m(TaskRunner pid=2949575)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2949575)[0m           'use_shm': False,
[36m(TaskRunner pid=2949575)[0m           'val_batch_size': None,
[36m(TaskRunner pid=2949575)[0m           'val_files': '/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/test.parquet',
[36m(TaskRunner pid=2949575)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2949575)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2949575)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=2949575)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2949575)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2949575)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2949575)[0m                   'max_length': None,
[36m(TaskRunner pid=2949575)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2949575)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2949575)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2949575)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2949575)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=2949575)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=2949575)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2949575)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=2949575)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2949575)[0m Filtering prompts longer than 1024 tokens:   0%|          | 0/2255 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2949575)[0m Filtering prompts longer than 1024 tokens:  44%|████▍     | 1000/2255 [00:14<00:18, 67.43 examples/s]
[36m(TaskRunner pid=2949575)[0m Filtering prompts longer than 1024 tokens:  89%|████████▊ | 2000/2255 [00:29<00:03, 68.41 examples/s]
[36m(TaskRunner pid=2949575)[0m Filtering prompts longer than 1024 tokens: 100%|██████████| 2255/2255 [00:33<00:00, 68.35 examples/s]Filtering prompts longer than 1024 tokens: 100%|██████████| 2255/2255 [00:33<00:00, 68.24 examples/s]
[36m(TaskRunner pid=2949575)[0m Filtering prompts longer than 1024 tokens:   0%|          | 0/100 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2949575)[0m Filtering prompts longer than 1024 tokens: 100%|██████████| 100/100 [00:01<00:00, 69.87 examples/s]Filtering prompts longer than 1024 tokens: 100%|██████████| 100/100 [00:01<00:00, 69.81 examples/s]
[36m(TaskRunner pid=2949575)[0m /gemini/user/private/table_reasoning/zhaiyanbo/verl/verl/trainer/main_ppo.py:227: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2949575)[0m   trainer = RayPPOTrainer(
[36m(TaskRunner pid=2949575)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2949575)[0m WARNING:2025-08-05 23:36:46,438:Waiting for register center actor DFbN3Z_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2951182)[0m Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
[36m(WorkerDict pid=2951185)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VLForConditionalGeneration is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2951185)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2951185)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VisionTransformerPretrainedModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2951185)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(TaskRunner pid=2949575)[0m                             'input_tokenizer': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2949575)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2949575)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=2949575)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=2949575)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=2949575)[0m                             'use_shm': False},
[36m(TaskRunner pid=2949575)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2949575)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2949575)[0m                                'discrete': False,
[36m(TaskRunner pid=2949575)[0m                                'ranks': []},
[36m(TaskRunner pid=2949575)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2949575)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2949575)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2949575)[0m                                      'url': None},
[36m(TaskRunner pid=2949575)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2949575)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2949575)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2949575)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2949575)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2949575)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2949575)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2949575)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2949575)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2949575)[0m              'default_local_dir': '/gemini/platform/public/NLP/model/project_model/math/grpo_0805',
[36m(TaskRunner pid=2949575)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2949575)[0m              'device': 'cuda',
[36m(TaskRunner pid=2949575)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2949575)[0m              'experiment_name': 'qwen2_5_vl_3b_function_rm',
[36m(TaskRunner pid=2949575)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2949575)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2949575)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2949575)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2949575)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=2949575)[0m              'nnodes': 1,
[36m(TaskRunner pid=2949575)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=2949575)[0m                                          'level': 'level1',
[36m(TaskRunner pid=2949575)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=2949575)[0m                                          'roles': ['all'],
[36m(TaskRunner pid=2949575)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=2949575)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=2949575)[0m                                          'with_memory': False,
[36m(TaskRunner pid=2949575)[0m                                          'with_module': False,
[36m(TaskRunner pid=2949575)[0m                                          'with_npu': True,
[36m(TaskRunner pid=2949575)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=2949575)[0m              'profile_continuous_steps': False,
[36m(TaskRunner pid=2949575)[0m              'profile_steps': None,
[36m(TaskRunner pid=2949575)[0m              'project_name': 'grpo_math_0803',
[36m(TaskRunner pid=2949575)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2949575)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2949575)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2949575)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2949575)[0m              'save_freq': 10,
[36m(TaskRunner pid=2949575)[0m              'test_freq': 50,
[36m(TaskRunner pid=2949575)[0m              'total_epochs': 15,
[36m(TaskRunner pid=2949575)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2949575)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=2949575)[0m              'val_before_train': True,
[36m(TaskRunner pid=2949575)[0m              'val_only': False,
[36m(TaskRunner pid=2949575)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=2949575)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2949575)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=2949575)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2949575)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2949575)[0m                                        'kill': 'none',
[36m(TaskRunner pid=2949575)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=2949575)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2949575)[0m dataset len: 2255
[36m(TaskRunner pid=2949575)[0m filter dataset len: 2255
[36m(TaskRunner pid=2949575)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2949575)[0m dataset len: 100
[36m(TaskRunner pid=2949575)[0m filter dataset len: 100
[36m(TaskRunner pid=2949575)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2949575)[0m Size of train dataloader: 35, Size of val dataloader: 1
[36m(TaskRunner pid=2949575)[0m Total training steps: 525
[36m(TaskRunner pid=2949575)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=2950917)[0m Model config after override: Qwen2_5_VLConfig {
[36m(WorkerDict pid=2950917)[0m   "architectures": [
[36m(WorkerDict pid=2950917)[0m     "Qwen2_5_VLForConditionalGeneration"
[36m(WorkerDict pid=2950917)[0m   ],
[36m(WorkerDict pid=2950917)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2950917)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2950917)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2950917)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=2950917)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2950917)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2950917)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=2950917)[0m   "max_position_embeddings": 128000,
[36m(WorkerDict pid=2950917)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=2950917)[0m   "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2950917)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=2950917)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=2950917)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2950917)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2950917)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2950917)[0m   "rope_scaling": {
[36m(WorkerDict pid=2950917)[0m     "mrope_section": [
[36m(WorkerDict pid=2950917)[0m       16,
[36m(WorkerDict pid=2950917)[0m       24,
[36m(WorkerDict pid=2950917)[0m       24
[36m(WorkerDict pid=2950917)[0m     ],
[36m(WorkerDict pid=2950917)[0m     "rope_type": "default",
[36m(WorkerDict pid=2950917)[0m     "type": "default"
[36m(WorkerDict pid=2950917)[0m   },
[36m(WorkerDict pid=2950917)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2950917)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=2951181)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.39s/it]
[36m(WorkerDict pid=2950917)[0m Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2951187)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VisionTransformerPretrainedModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=2951187)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951187)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.64s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:11<00:00,  5.78s/it]
[36m(WorkerDict pid=2951185)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.76s/it][32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=2951187)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.77s/it][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2951186)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:12<00:12, 12.70s/it][32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=2950917)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2951186)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.14s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.82s/it]
[36m(WorkerDict pid=2951187)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:05<00:05,  5.85s/it]
[36m(WorkerDict pid=2951185)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2950917)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2950917)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=2950917)[0m   "use_cache": true,
[36m(WorkerDict pid=2950917)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2950917)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2950917)[0m   "vision_config": {
[36m(WorkerDict pid=2950917)[0m     "depth": 32,
[36m(WorkerDict pid=2950917)[0m     "fullatt_block_indexes": [
[36m(WorkerDict pid=2950917)[0m       7,
[36m(WorkerDict pid=2950917)[0m       15,
[36m(WorkerDict pid=2950917)[0m       23,
[36m(WorkerDict pid=2950917)[0m       31
[36m(WorkerDict pid=2950917)[0m     ],
[36m(WorkerDict pid=2950917)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2950917)[0m     "hidden_size": 1280,
[36m(WorkerDict pid=2950917)[0m     "in_channels": 3,
[36m(WorkerDict pid=2950917)[0m     "in_chans": 3,
[36m(WorkerDict pid=2950917)[0m     "intermediate_size": 3420,
[36m(WorkerDict pid=2950917)[0m     "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2950917)[0m     "num_heads": 16,
[36m(WorkerDict pid=2950917)[0m     "out_hidden_size": 2048,
[36m(WorkerDict pid=2950917)[0m     "patch_size": 14,
[36m(WorkerDict pid=2950917)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2950917)[0m     "spatial_patch_size": 14,
[36m(WorkerDict pid=2950917)[0m     "temporal_patch_size": 2,
[36m(WorkerDict pid=2950917)[0m     "tokens_per_second": 2,
[36m(WorkerDict pid=2950917)[0m     "window_size": 112
[36m(WorkerDict pid=2950917)[0m   },
[36m(WorkerDict pid=2950917)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2950917)[0m   "vision_start_token_id": 151652,
[36m(WorkerDict pid=2950917)[0m   "vision_token_id": 151654,
[36m(WorkerDict pid=2950917)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2950917)[0m }
[36m(WorkerDict pid=2950917)[0m 
[36m(WorkerDict pid=2950917)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2950917)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2950917)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2950917)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2951187)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2951187)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2951187)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2951187)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2950917)[0m Qwen2_5_VLForConditionalGeneration contains 3.75B parameters
[36m(WorkerDict pid=2950917)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f2753c7d360>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f2753c7d240>, transformer_layer_cls={<class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLDecoderLayer'>, <class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLVisionBlock'>})])
[36m(WorkerDict pid=2950917)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2950917)[0m Ref use_remove_padding=True
[36m(WorkerDict pid=2950917)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=2951186)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2951186)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2951186)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2951186)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2950917)[0m Model config after override: Qwen2_5_VLConfig {
[36m(WorkerDict pid=2950917)[0m   "architectures": [
[36m(WorkerDict pid=2950917)[0m     "Qwen2_5_VLForConditionalGeneration"
[36m(WorkerDict pid=2950917)[0m   ],
[36m(WorkerDict pid=2950917)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2950917)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2950917)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2950917)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=2950917)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2950917)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2950917)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=2950917)[0m   "max_position_embeddings": 128000,
[36m(WorkerDict pid=2950917)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=2950917)[0m   "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2950917)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=2950917)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=2950917)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2950917)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2950917)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2950917)[0m   "rope_scaling": {
[36m(WorkerDict pid=2950917)[0m     "mrope_section": [
[36m(WorkerDict pid=2950917)[0m       16,
[36m(WorkerDict pid=2950917)[0m       24,
[36m(WorkerDict pid=2950917)[0m       24
[36m(WorkerDict pid=2950917)[0m     ],
[36m(WorkerDict pid=2950917)[0m     "rope_type": "default",
[36m(WorkerDict pid=2950917)[0m     "type": "default"
[36m(WorkerDict pid=2950917)[0m   },
[36m(WorkerDict pid=2950917)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2950917)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=2950917)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2950917)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2950917)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=2950917)[0m   "use_cache": true,
[36m(WorkerDict pid=2950917)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2950917)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2950917)[0m   "vision_config": {
[36m(WorkerDict pid=2950917)[0m     "depth": 32,
[36m(WorkerDict pid=2950917)[0m     "fullatt_block_indexes": [
[36m(WorkerDict pid=2950917)[0m       7,
[36m(WorkerDict pid=2950917)[0m       15,
[36m(WorkerDict pid=2950917)[0m       23,
[36m(WorkerDict pid=2950917)[0m       31
[36m(WorkerDict pid=2950917)[0m     ],
[36m(WorkerDict pid=2950917)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2950917)[0m     "hidden_size": 1280,
[36m(WorkerDict pid=2950917)[0m     "in_channels": 3,
[36m(WorkerDict pid=2950917)[0m     "in_chans": 3,
[36m(WorkerDict pid=2950917)[0m     "intermediate_size": 3420,
[36m(WorkerDict pid=2950917)[0m     "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2950917)[0m     "num_heads": 16,
[36m(WorkerDict pid=2950917)[0m     "out_hidden_size": 2048,
[36m(WorkerDict pid=2950917)[0m     "patch_size": 14,
[36m(WorkerDict pid=2950917)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2950917)[0m     "spatial_patch_size": 14,
[36m(WorkerDict pid=2950917)[0m     "temporal_patch_size": 2,
[36m(WorkerDict pid=2950917)[0m     "tokens_per_second": 2,
[36m(WorkerDict pid=2950917)[0m     "window_size": 112
[36m(WorkerDict pid=2950917)[0m   },
[36m(WorkerDict pid=2950917)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2950917)[0m   "vision_start_token_id": 151652,
[36m(WorkerDict pid=2950917)[0m   "vision_token_id": 151654,
[36m(WorkerDict pid=2950917)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2950917)[0m }
[36m(WorkerDict pid=2950917)[0m 
[36m(WorkerDict pid=2951187)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2951187)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2951187)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.22s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.32s/it]
[36m(WorkerDict pid=2951185)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.69s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951182)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2951182)[0m   warnings.warn(
[36m(WorkerDict pid=2951185)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.48s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m wandb: Tracking run with wandb version 0.20.1
[36m(TaskRunner pid=2949575)[0m wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
[36m(WorkerDict pid=2951187)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2951187)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2950917)[0m Qwen2_5_VLForConditionalGeneration contains 3.75B parameters
[36m(WorkerDict pid=2950917)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f2753c7d360>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f2753c7d240>, transformer_layer_cls={<class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLDecoderLayer'>, <class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLVisionBlock'>})])
[36m(WorkerDict pid=2950917)[0m Total steps: 525, num_warmup_steps: 0
[36m(WorkerDict pid=2950917)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2950917)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=2951184)[0m WARNING 08-05 23:38:07 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2951185)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951185)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951185)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951185)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951184)[0m WARNING 08-05 23:38:08 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f99bc8fecb0>
[36m(WorkerDict pid=2951182)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2951182)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2951187)[0m WARNING 08-05 23:38:09 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951187)[0m WARNING 08-05 23:38:10 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fa6b75fad40>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951186)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Checkpoint tracker file does not exist: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2949575)[0m Training from scratch
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 0}
[36m(WorkerDict pid=2951185)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <answer>The answer is \boxed{D}.</answer>
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m <think>
[36m(TaskRunner pid=2949575)[0m To solve this problem, we need to understand the properties of the given geometric figures and use the given information to find the required length.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m 1. **Identify the properties of the parabola and the hyperbola:**
[36m(TaskRunner pid=2949575)[0m    - The parabola \( y^2 = 16x \) has its focus at \( (4, 0) \) and its directrix at \( x = -4 \).
[36m(TaskRunner pid=2949575)[0m    - The hyperbola \( C \) is centered at the origin and has its foci on the x-axis. Since it is an equilateral hyperbola, its standard form is \( \frac{x^2}{a^2} - \frac{y^2}{a^2} = 1 \), which simplifies to \( x^2 - y^2 = a^2 \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m 2. **Determine the coordinates of points A and B:**
[36m(TaskRunner pid=2949575)[0m    - The points A and B are the intersections of the hyperbola and the parabola. Since the hyperbola is symmetric about the x-axis, the y-coordinates of A and B will be of opposite signs.
[36m(TaskRunner pid=2949575)[0m    - Let the coordinates of A be \( (x_1, y_1) \) and the coordinates of B be \( (x_2, y_2) \). Since A and B are on the parabola, we have \( y_1^2 = 16x_1 \) and \( y_2^2 = 16x_2 \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m 3. **Use the distance formula:**
[36m(TaskRunner pid=2949575)[0m    - The distance between A and B is given as \( |AB| = 4\sqrt{3} \). Using the distance formula, we get:
[36m(TaskRunner pid=2949575)[0m      \[
[36m(TaskRunner pid=2949575)[0m      |AB| = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2} = 4\sqrt{3}
[36m(TaskRunner pid=2949575)[0m      \]
[36m(TaskRunner pid=2949575)[0m    - Since A and B are symmetric with respect to the x-axis, \( y_1 = -y_2 \). Therefore, \( y_1^2 = y_2^2 \) and \( y_1^2 = 16x_1 \), so \( y_1 = 4\sqrt{x_1} \) and \( y_2 = -4\sqrt{x_2} \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m 4. **Substitute and solve for \( x_1 \) and \( x_2 \):**
[36m(TaskRunner pid=2949575)[0m    - Substitute \( y_1 = 4\sqrt{x_1} \) and \( y_2 = -4\sqrt{x_2} \) into the distance formula:
[36m(TaskRunner pid=2949575)[0m      \[
[36m(TaskRunner pid=2949575)[0m      \sqrt{(x_1 - x_2)^2 + (4\sqrt{x_1} + 4\sqrt{x_2})^2} = 4\sqrt{3}
[36m(TaskRunner pid=2949575)[0m      \]
[36m(TaskRunner pid=2949575)[0m    - Simplify the equation:
[36m(TaskRunner pid=2949575)[0m      \[
[36m(TaskRunner pid=2949575)[0m      \sqrt{(x_1 - x_2)^2 + 16(x_1 + x_2) + 32\sqrt{x_1 x_2}} = 4\sqrt{3}
[36m(TaskRunner pid=2949575)[0m      \]
[36m(TaskRunner pid=2949575)[0m    - Since the hyperbola is symmetric and the points are symmetric with respect to the x-axis, we can assume \( x_1 = x_2 \). However, this is not the case here, so we need to solve the equation directly. By trial and error or solving the quadratic equation, we find that \( x_1 = 1 \) and \( x_2 = 3 \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m 5. **Determine the length of the real axis:**
[36m(TaskRunner pid=2949575)[0m    - The length of the real axis of the hyperbola is \( 2a \). From the coordinates of A and B, we can see that the distance between the points on the hyperbola is related to the real axis length. By solving the quadratic equation or using the properties of the hyperbola, we find that \( 2a = 8 \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Therefore, the length of the real axis of the hyperbola is \( 8 \). The answer is \(\boxed{D}\).
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] -0.5
[36m(TaskRunner pid=2949575)[0m [structure] -0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.0
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m ("Initial validation metrics: {'val-aux/grpo_convert/reward/mean@50': -0.435, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/std@50': 0.2760947210168959, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@2/mean': -0.37575000000000003, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@2/std': 0.3723139800560939, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@2/mean': -0.49724999999999997, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@2/std': 0.05682100737090506, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@4/mean': -0.2815, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@4/std': 0.4727628092345868, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@4/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@8/mean': -0.0795, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@8/std': 0.5877320106763376, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@8/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@16/mean': 0.19574999999999998, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@16/std': 0.6161320574250476, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@16/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@32/mean': 0.5095000000000001, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@32/std': 0.4883021150191815, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@32/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@50/mean': 0.657, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@50/std': 0.3178239550546094, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@50/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/mean@50': -0.435, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/std@50': 0.2760947210168959, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@2/mean': -0.37575000000000003, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@2/std': 0.3723139800560939, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@2/mean': -0.49724999999999997, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@2/std': 0.05682100737090506, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@4/mean': -0.2815, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@4/std': 0.4727628092345868, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@4/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@8/mean': -0.0795, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@8/std': 0.5877320106763376, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@8/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@16/mean': 0.19574999999999998, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@16/std': 0.6161320574250476, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@16/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@32/mean': 0.5095000000000001, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@32/std': 0.4883021150191815, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@32/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@50/mean': 0.657, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@50/std': 0.3178239550546094, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@50/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/mean@50': -0.45, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/std@50': 0.2167230105817063, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@2/mean': -0.404, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@2/std': 0.2931657804555976, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@2/mean': -0.498, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@2/std': 0.04314849845702975, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@4/mean': -0.3305, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@4/std': 0.373520681083282, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@4/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@8/mean': -0.1725, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@8/std': 0.4668974129818031, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@8/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@16/mean': 0.044, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@16/std': 0.4940278498808356, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@16/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@32/mean': 0.29900000000000004, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@32/std': 0.3971168640188142, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@32/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@50/mean': 0.4185, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@50/std': 0.2654526843043212, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@50/mean': -0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/mean@50': 0.015, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/std@50': 0.05937171043518959, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@2/mean': 0.02825, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@2/std': 0.0791481996004963, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@2/mean': 0.00075, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@2/std': 0.013672508913875319, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@4/mean': 0.049, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@4/std': 0.09924212815130477, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@4/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@8/mean': 0.093, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@8/std': 0.12083459769453449, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@8/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@16/mean': 0.15175, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@16/std': 0.122104207544212, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@32/mean': 0.2105, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@32/std': 0.09118525100036737, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@50/mean': 0.2385, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@50/std': 0.052371270750288273, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/mean@50': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/std@50': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@2/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@2/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@2/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@2/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@4/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@4/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@8/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@8/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-core/grpo_convert/acc/mean@50': 0.0, 'val-aux/grpo_convert/acc/std@50': "
[36m(TaskRunner pid=2949575)[0m  "0.0, 'val-aux/grpo_convert/acc/best@2/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@2/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@2/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@2/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@4/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@4/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@8/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@8/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-core/grpo_convert/acc/best@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-core/grpo_convert/acc/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@50/std': 0.0}")
[36m(TaskRunner pid=2949575)[0m Training Progress:   0%|          | 0/525 [00:00<?, ?it/s]
[36m(WorkerDict pid=2951185)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951185)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:0 - val-aux/grpo_convert/reward/mean@50:-0.435 - val-aux/grpo_convert/reward/std@50:0.2760947210168959 - val-aux/grpo_convert/reward/best@2/mean:-0.37575000000000003 - val-aux/grpo_convert/reward/best@2/std:0.3723139800560939 - val-aux/grpo_convert/reward/worst@2/mean:-0.49724999999999997 - val-aux/grpo_convert/reward/worst@2/std:0.05682100737090506 - val-aux/grpo_convert/reward/best@4/mean:-0.2815 - val-aux/grpo_convert/reward/best@4/std:0.4727628092345868 - val-aux/grpo_convert/reward/worst@4/mean:-0.5 - val-aux/grpo_convert/reward/worst@4/std:0.0 - val-aux/grpo_convert/reward/best@8/mean:-0.0795 - val-aux/grpo_convert/reward/best@8/std:0.5877320106763376 - val-aux/grpo_convert/reward/worst@8/mean:-0.5 - val-aux/grpo_convert/reward/worst@8/std:0.0 - val-aux/grpo_convert/reward/best@16/mean:0.19574999999999998 - val-aux/grpo_convert/reward/best@16/std:0.6161320574250476 - val-aux/grpo_convert/reward/worst@16/mean:-0.5 - val-aux/grpo_convert/reward/worst@16/std:0.0 - val-aux/grpo_convert/reward/best@32/mean:0.5095000000000001 - val-aux/grpo_convert/reward/best@32/std:0.4883021150191815 - val-aux/grpo_convert/reward/worst@32/mean:-0.5 - val-aux/grpo_convert/reward/worst@32/std:0.0 - val-aux/grpo_convert/reward/best@50/mean:0.657 - val-aux/grpo_convert/reward/best@50/std:0.3178239550546094 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:-0.435 - val-aux/grpo_convert/score/std@50:0.2760947210168959 - val-aux/grpo_convert/score/best@2/mean:-0.37575000000000003 - val-aux/grpo_convert/score/best@2/std:0.3723139800560939 - val-aux/grpo_convert/score/worst@2/mean:-0.49724999999999997 - val-aux/grpo_convert/score/worst@2/std:0.05682100737090506 - val-aux/grpo_convert/score/best@4/mean:-0.2815 - val-aux/grpo_convert/score/best@4/std:0.4727628092345868 - val-aux/grpo_convert/score/worst@4/mean:-0.5 - val-aux/grpo_convert/score/worst@4/std:0.0 - val-aux/grpo_convert/score/best@8/mean:-0.0795 - val-aux/grpo_convert/score/best@8/std:0.5877320106763376 - val-aux/grpo_convert/score/worst@8/mean:-0.5 - val-aux/grpo_convert/score/worst@8/std:0.0 - val-aux/grpo_convert/score/best@16/mean:0.19574999999999998 - val-aux/grpo_convert/score/best@16/std:0.6161320574250476 - val-aux/grpo_convert/score/worst@16/mean:-0.5 - val-aux/grpo_convert/score/worst@16/std:0.0 - val-aux/grpo_convert/score/best@32/mean:0.5095000000000001 - val-aux/grpo_convert/score/best@32/std:0.4883021150191815 - val-aux/grpo_convert/score/worst@32/mean:-0.5 - val-aux/grpo_convert/score/worst@32/std:0.0 - val-aux/grpo_convert/score/best@50/mean:0.657 - val-aux/grpo_convert/score/best@50/std:0.3178239550546094 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:-0.45 - val-aux/grpo_convert/structure/std@50:0.2167230105817063 - val-aux/grpo_convert/structure/best@2/mean:-0.404 - val-aux/grpo_convert/structure/best@2/std:0.2931657804555976 - val-aux/grpo_convert/structure/worst@2/mean:-0.498 - val-aux/grpo_convert/structure/worst@2/std:0.04314849845702975 - val-aux/grpo_convert/structure/best@4/mean:-0.3305 - val-aux/grpo_convert/structure/best@4/std:0.373520681083282 - val-aux/grpo_convert/structure/worst@4/mean:-0.5 - val-aux/grpo_convert/structure/worst@4/std:0.0 - val-aux/grpo_convert/structure/best@8/mean:-0.1725 - val-aux/grpo_convert/structure/best@8/std:0.4668974129818031 - val-aux/grpo_convert/structure/worst@8/mean:-0.5 - val-aux/grpo_convert/structure/worst@8/std:0.0 - val-aux/grpo_convert/structure/best@16/mean:0.044 - val-aux/grpo_convert/structure/best@16/std:0.4940278498808356 - val-aux/grpo_convert/structure/worst@16/mean:-0.5 - val-aux/grpo_convert/structure/worst@16/std:0.0 - val-aux/grpo_convert/structure/best@32/mean:0.29900000000000004 - val-aux/grpo_convert/structure/best@32/std:0.3971168640188142 - val-aux/grpo_convert/structure/worst@32/mean:-0.5 - val-aux/grpo_convert/structure/worst@32/std:0.0 - val-aux/grpo_convert/structure/best@50/mean:0.4185 - val-aux/grpo_convert/structure/best@50/std:0.2654526843043212 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.015 - val-aux/grpo_convert/boxed/std@50:0.05937171043518959 - val-aux/grpo_convert/boxed/best@2/mean:0.02825 - val-aux/grpo_convert/boxed/best@2/std:0.0791481996004963 - val-aux/grpo_convert/boxed/worst@2/mean:0.00075 - val-aux/grpo_convert/boxed/worst@2/std:0.013672508913875319 - val-aux/grpo_convert/boxed/best@4/mean:0.049 - val-aux/grpo_convert/boxed/best@4/std:0.09924212815130477 - val-aux/grpo_convert/boxed/worst@4/mean:0.0 - val-aux/grpo_convert/boxed/worst@4/std:0.0 - val-aux/grpo_convert/boxed/best@8/mean:0.093 - val-aux/grpo_convert/boxed/best@8/std:0.12083459769453449 - val-aux/grpo_convert/boxed/worst@8/mean:0.0 - val-aux/grpo_convert/boxed/worst@8/std:0.0 - val-aux/grpo_convert/boxed/best@16/mean:0.15175 - val-aux/grpo_convert/boxed/best@16/std:0.122104207544212 - val-aux/grpo_convert/boxed/worst@16/mean:0.0 - val-aux/grpo_convert/boxed/worst@16/std:0.0 - val-aux/grpo_convert/boxed/best@32/mean:0.2105 - val-aux/grpo_convert/boxed/best@32/std:0.09118525100036737 - val-aux/grpo_convert/boxed/worst@32/mean:0.0 - val-aux/grpo_convert/boxed/worst@32/std:0.0 - val-aux/grpo_convert/boxed/best@50/mean:0.2385 - val-aux/grpo_convert/boxed/best@50/std:0.052371270750288273 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.0 - val-aux/grpo_convert/correct/std@50:0.0 - val-aux/grpo_convert/correct/best@2/mean:0.0 - val-aux/grpo_convert/correct/best@2/std:0.0 - val-aux/grpo_convert/correct/worst@2/mean:0.0 - val-aux/grpo_convert/correct/worst@2/std:0.0 - val-aux/grpo_convert/correct/best@4/mean:0.0 - val-aux/grpo_convert/correct/best@4/std:0.0 - val-aux/grpo_convert/correct/worst@4/mean:0.0 - val-aux/grpo_convert/correct/worst@4/std:0.0 - val-aux/grpo_convert/correct/best@8/mean:0.0 - val-aux/grpo_convert/correct/best@8/std:0.0 - val-aux/grpo_convert/correct/worst@8/mean:0.0 - val-aux/grpo_convert/correct/worst@8/std:0.0 - val-aux/grpo_convert/correct/best@16/mean:0.0 - val-aux/grpo_convert/correct/best@16/std:0.0 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.0 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.0 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.0 - val-aux/grpo_convert/acc/std@50:0.0 - val-aux/grpo_convert/acc/best@2/mean:0.0 - val-aux/grpo_convert/acc/best@2/std:0.0 - val-aux/grpo_convert/acc/worst@2/mean:0.0 - val-aux/grpo_convert/acc/worst@2/std:0.0 - val-aux/grpo_convert/acc/best@4/mean:0.0 - val-aux/grpo_convert/acc/best@4/std:0.0 - val-aux/grpo_convert/acc/worst@4/mean:0.0 - val-aux/grpo_convert/acc/worst@4/std:0.0 - val-aux/grpo_convert/acc/best@8/mean:0.0 - val-aux/grpo_convert/acc/best@8/std:0.0 - val-aux/grpo_convert/acc/worst@8/mean:0.0 - val-aux/grpo_convert/acc/worst@8/std:0.0 - val-aux/grpo_convert/acc/best@16/mean:0.0 - val-aux/grpo_convert/acc/best@16/std:0.0 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.0 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.0 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:   0%|          | 1/525 [00:56<8:12:25, 56.38s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   0%|          | 2/525 [02:00<8:52:22, 61.08s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.013067256659269333, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.0954431295394897, 'critic/returns/mean': -0.013067256659269333, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.0954431295394897, 'response_length/mean': 341.9312438964844, 'response_length/max': 1252.0, 'response_length/min': 10.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:1 - global_seqlen/min:27116 - global_seqlen/max:32495 - global_seqlen/minmax_diff:5379 - global_seqlen/balanced_min:30062 - global_seqlen/balanced_max:30063 - global_seqlen/mean:30062.25 - actor/entropy:0.8765016794204712 - actor/kl_loss:0.0005725616050767712 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04609485566616058 - actor/pg_clipfrac:0.0007347165897954256 - actor/ppo_kl:-0.0004584397163853282 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8143553584814072 - perf/mfu/actor:0.08636951839501253 - perf/max_memory_allocated_gb:59.163883686065674 - perf/max_memory_reserved_gb:74.833984375 - perf/cpu_memory_used_gb:95.453369140625 - actor/lr:1e-06 - training/global_step:1 - training/epoch:0 - critic/score/mean:-0.3125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.013067256659269333 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.0954431295394897 - critic/returns/mean:-0.013067256659269333 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.0954431295394897 - response_length/mean:341.9312438964844 - response_length/max:1252.0 - response_length/min:10.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0003283936530351639 - timing_s/generate_sequences:31.989768981933594 - timing_s/reshard:0.6364675760269165 - timing_s/gen:40.46916774660349 - timing_s/reward:0.07259643822908401 - timing_s/old_log_prob:1.358952108770609 - timing_s/ref:5.069706378504634 - timing_s/adv:0.007430210709571838 - timing_s/update_actor:7.441682448610663 - timing_s/step:54.77599669806659 - timing_s/stop_profile:4.299543797969818e-05 - timing_per_token_ms/adv:3.089510394918809e-05 - timing_per_token_ms/gen:0.3698584122046052 - timing_per_token_ms/ref:0.021080035503433018 - timing_per_token_ms/update_actor:0.030942803884484126 - perf/total_num_tokens:240498 - perf/time_per_step:54.77599669806659 - perf/throughput:548.8215972720236
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.28125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.28125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03429393842816353, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.0954437255859375, 'critic/returns/mean': -0.03429393842816353, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.0954437255859375, 'response_length/mean': 323.3999938964844, 'response_length/max': 1745.0, 'response_length/min': 10.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.28125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:2 - global_seqlen/min:28066 - global_seqlen/max:31421 - global_seqlen/minmax_diff:3355 - global_seqlen/balanced_min:29261 - global_seqlen/balanced_max:29835 - global_seqlen/mean:29334.125 - actor/entropy:0.9480721950531006 - actor/kl_loss:0.001377951545873657 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03345421627163887 - actor/pg_clipfrac:0.001924637213232927 - actor/ppo_kl:-0.0004276844982086914 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0594197809696198 - perf/mfu/actor:0.08742345999582286 - perf/max_memory_allocated_gb:63.122382164001465 - perf/max_memory_reserved_gb:74.833984375 - perf/cpu_memory_used_gb:95.67454528808594 - actor/lr:1e-06 - training/global_step:2 - training/epoch:0 - critic/score/mean:-0.28125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.28125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03429393842816353 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.0954437255859375 - critic/returns/mean:-0.03429393842816353 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.0954437255859375 - response_length/mean:323.3999938964844 - response_length/max:1745.0 - response_length/min:10.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.28125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.198432624340057e-05 - timing_s/generate_sequences:33.9499626159668 - timing_s/reshard:0.7250379323959351 - timing_s/gen:54.38627754710615 - timing_s/reward:0.07282046973705292 - timing_s/old_log_prob:1.189917078241706 - timing_s/ref:1.3837092462927103 - timing_s/adv:0.011655431240797043 - timing_s/update_actor:7.180286014452577 - timing_s/step:64.24245548807085 - timing_s/stop_profile:4.445388913154602e-05 - timing_per_token_ms/adv:4.96666904194221e-05 - timing_per_token_ms/gen:0.5255322119193158 - timing_per_token_ms/ref:0.005896329131569078 - timing_per_token_ms/update_actor:0.030596983949804948 - perf/total_num_tokens:234673 - perf/time_per_step:64.24245548807085 - perf/throughput:456.6158746134329
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.15625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.15625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05383343622088432, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.4142123460769653, 'critic/returns/mean': -0.05383343622088432, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.4142123460769653, 'response_length/mean': 325.80938720703125, 'response_length/max': 2048.0, 'response_length/min': 11.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.15625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   1%|          | 3/525 [03:12<9:33:09, 65.88s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   1%|          | 4/525 [04:23<9:48:32, 67.78s/it]
[36m(TaskRunner pid=2949575)[0m step:3 - global_seqlen/min:24717 - global_seqlen/max:31628 - global_seqlen/minmax_diff:6911 - global_seqlen/balanced_min:29312 - global_seqlen/balanced_max:29934 - global_seqlen/mean:29391.125 - actor/entropy:0.9304214119911194 - actor/kl_loss:0.003483903066080529 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06870090579614044 - actor/pg_clipfrac:0.002217873059271369 - actor/ppo_kl:-4.9477844186185393e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1445076316595078 - perf/mfu/actor:0.08791531003894391 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:78.841796875 - perf/cpu_memory_used_gb:96.00567626953125 - actor/lr:1e-06 - training/global_step:3 - training/epoch:0 - critic/score/mean:-0.15625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.15625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05383343622088432 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.4142123460769653 - critic/returns/mean:-0.05383343622088432 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.4142123460769653 - response_length/mean:325.80938720703125 - response_length/max:2048.0 - response_length/min:11.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.15625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011550635099411011 - timing_s/generate_sequences:40.65483856201172 - timing_s/reshard:0.6762644648551941 - timing_s/gen:61.56989020854235 - timing_s/reward:0.0733545795083046 - timing_s/old_log_prob:1.166006650775671 - timing_s/ref:1.3773124795407057 - timing_s/adv:0.008175751194357872 - timing_s/update_actor:7.148747079074383 - timing_s/step:71.36602106317878 - timing_s/stop_profile:4.665367305278778e-05 - timing_per_token_ms/adv:3.477134336622821e-05 - timing_per_token_ms/gen:0.5905474847115582 - timing_per_token_ms/ref:0.0058576886710729244 - timing_per_token_ms/update_actor:0.03040351074973475 - perf/total_num_tokens:235129 - perf/time_per_step:71.36602106317878 - perf/throughput:411.8363972398108
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.012500000186264515, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.012500000186264515, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05870366841554642, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888504266738892, 'critic/returns/mean': -0.05870366841554642, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888504266738892, 'response_length/mean': 326.6187438964844, 'response_length/max': 2048.0, 'response_length/min': 10.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.0125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:4 - global_seqlen/min:26768 - global_seqlen/max:31923 - global_seqlen/minmax_diff:5155 - global_seqlen/balanced_min:29362 - global_seqlen/balanced_max:30165 - global_seqlen/mean:29462.875 - actor/entropy:0.8994614481925964 - actor/kl_loss:0.005943676544120535 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.24447429589927197 - actor/pg_clipfrac:0.0019353954296093435 - actor/ppo_kl:-0.0005815447288114228 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1491708159446716 - perf/mfu/actor:0.08754129619085067 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:85.3046875 - perf/cpu_memory_used_gb:96.29496765136719 - actor/lr:1e-06 - training/global_step:4 - training/epoch:0 - critic/score/mean:0.012500000186264515 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.012500000186264515 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05870366841554642 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.05870366841554642 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888504266738892 - response_length/mean:326.6187438964844 - response_length/max:2048.0 - response_length/min:10.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.0125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011774897575378418 - timing_s/generate_sequences:35.85208511352539 - timing_s/reshard:0.702671468257904 - timing_s/gen:60.50448030605912 - timing_s/reward:0.07397366501390934 - timing_s/old_log_prob:1.1554703004658222 - timing_s/ref:1.3515834249556065 - timing_s/adv:0.010890793055295944 - timing_s/update_actor:7.199878705665469 - timing_s/step:70.31076269038022 - timing_s/stop_profile:4.806928336620331e-05 - timing_per_token_ms/adv:4.6205576744020844e-05 - timing_per_token_ms/gen:0.5788905289620843 - timing_per_token_ms/ref:0.00573426483734024 - timing_per_token_ms/update_actor:0.030546402488154455 - perf/total_num_tokens:235703 - perf/time_per_step:70.31076269038022 - perf/throughput:419.03790931329286
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.109375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.109375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07509125769138336, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07509125769138336, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 301.2093811035156, 'response_length/max': 1630.0, 'response_length/min': 14.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   1%|          | 5/525 [05:22<9:21:07, 64.75s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   1%|          | 6/525 [06:30<9:30:29, 65.95s/it]
[36m(TaskRunner pid=2949575)[0m step:5 - global_seqlen/min:26826 - global_seqlen/max:29753 - global_seqlen/minmax_diff:2927 - global_seqlen/balanced_min:28388 - global_seqlen/balanced_max:28813 - global_seqlen/mean:28442.125 - actor/entropy:1.0044093132019043 - actor/kl_loss:0.010182016005273908 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11085753347724676 - actor/pg_clipfrac:0.0019611482799518853 - actor/ppo_kl:-0.00043621093127512724 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.509522408246994 - perf/mfu/actor:0.08560492767546243 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:85.3046875 - perf/cpu_memory_used_gb:96.37669372558594 - actor/lr:1e-06 - training/global_step:5 - training/epoch:0 - critic/score/mean:0.109375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.109375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07509125769138336 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07509125769138336 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:301.2093811035156 - response_length/max:1630.0 - response_length/min:14.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010902993381023407 - timing_s/generate_sequences:33.64099884033203 - timing_s/reshard:0.653636634349823 - timing_s/gen:49.53314185887575 - timing_s/reward:0.07229815237224102 - timing_s/old_log_prob:1.26319800876081 - timing_s/ref:1.364430507645011 - timing_s/adv:0.00815839134156704 - timing_s/update_actor:7.091289132833481 - timing_s/step:59.347216909751296 - timing_s/stop_profile:4.5299530029296875e-05 - timing_per_token_ms/adv:3.58552294420997e-05 - timing_per_token_ms/gen:0.5138985740699031 - timing_per_token_ms/ref:0.005996521478462891 - timing_per_token_ms/update_actor:0.031165433018952877 - perf/total_num_tokens:227537 - perf/time_per_step:59.347216909751296 - perf/throughput:479.2495163379211
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.2265625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.2265625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0365910567343235, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0365910567343235, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 307.9937438964844, 'response_length/max': 1957.0, 'response_length/min': 16.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.2265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:6 - global_seqlen/min:26306 - global_seqlen/max:32277 - global_seqlen/minmax_diff:5971 - global_seqlen/balanced_min:28641 - global_seqlen/balanced_max:29064 - global_seqlen/mean:28717.875 - actor/entropy:0.9729233980178833 - actor/kl_loss:0.015810867515392603 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08598512094467878 - actor/pg_clipfrac:0.0025111982948146762 - actor/ppo_kl:-9.39516379730776e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2426160722970963 - perf/mfu/actor:0.0853283179458203 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:85.3046875 - perf/cpu_memory_used_gb:96.3979263305664 - actor/lr:1e-06 - training/global_step:6 - training/epoch:0 - critic/score/mean:0.2265625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.2265625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0365910567343235 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0365910567343235 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:307.9937438964844 - response_length/max:1957.0 - response_length/min:16.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.2265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.521469473838806e-05 - timing_s/generate_sequences:42.48627853393555 - timing_s/reshard:0.6599083542823792 - timing_s/gen:58.45203531160951 - timing_s/reward:0.07377959974110126 - timing_s/old_log_prob:1.1889890264719725 - timing_s/ref:1.3492421265691519 - timing_s/adv:0.008237164467573166 - timing_s/update_actor:7.19329778291285 - timing_s/step:68.28506308607757 - timing_s/stop_profile:4.4811517000198364e-05 - timing_per_token_ms/adv:3.5853821302817345e-05 - timing_per_token_ms/gen:0.5930724579598765 - timing_per_token_ms/ref:0.005872832367337206 - timing_per_token_ms/update_actor:0.03131019348973788 - perf/total_num_tokens:229743 - perf/time_per_step:68.28506308607757 - perf/throughput:420.5586654258389
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4906249940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4906249940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.011601711623370647, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.011601711623370647, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 284.91876220703125, 'response_length/max': 1526.0, 'response_length/min': 14.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.490625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   1%|▏         | 7/525 [07:27<9:04:01, 63.01s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   2%|▏         | 8/525 [08:19<8:31:06, 59.32s/it]
[36m(TaskRunner pid=2949575)[0m step:7 - global_seqlen/min:25073 - global_seqlen/max:30322 - global_seqlen/minmax_diff:5249 - global_seqlen/balanced_min:27748 - global_seqlen/balanced_max:27942 - global_seqlen/mean:27773.0 - actor/entropy:0.9130783677101135 - actor/kl_loss:0.016040507541038095 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12081759213469923 - actor/pg_clipfrac:0.00275836338987574 - actor/ppo_kl:4.042474029120058e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5083629786968231 - perf/mfu/actor:0.08393531339890985 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:85.3046875 - perf/cpu_memory_used_gb:96.5238151550293 - actor/lr:1e-06 - training/global_step:7 - training/epoch:0 - critic/score/mean:0.4906249940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4906249940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.011601711623370647 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.011601711623370647 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:284.91876220703125 - response_length/max:1526.0 - response_length/min:14.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.490625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.428337216377258e-05 - timing_s/generate_sequences:34.730587005615234 - timing_s/reshard:0.6527248620986938 - timing_s/gen:47.27199864387512 - timing_s/reward:0.07032500021159649 - timing_s/old_log_prob:1.157323930412531 - timing_s/ref:1.3698009140789509 - timing_s/adv:0.007508710026741028 - timing_s/update_actor:7.057617077603936 - timing_s/step:56.94868096522987 - timing_s/stop_profile:4.378706216812134e-05 - timing_per_token_ms/adv:3.379500786168684e-05 - timing_per_token_ms/gen:0.518481131066698 - timing_per_token_ms/ref:0.006165164521653004 - timing_per_token_ms/update_actor:0.03176474038456386 - perf/total_num_tokens:222184 - perf/time_per_step:56.94868096522987 - perf/throughput:487.684693117947
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6625000238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6625000238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04829324409365654, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.04829324409365654, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 290.515625, 'response_length/max': 1273.0, 'response_length/min': 53.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:8 - global_seqlen/min:25266 - global_seqlen/max:32285 - global_seqlen/minmax_diff:7019 - global_seqlen/balanced_min:27983 - global_seqlen/balanced_max:28002 - global_seqlen/mean:27988.125 - actor/entropy:0.9232574105262756 - actor/kl_loss:0.016792729450389742 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1728587055578828 - actor/pg_clipfrac:0.00381027894327417 - actor/ppo_kl:-0.0010107465189094001 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.657222181558609 - perf/mfu/actor:0.08320439430906529 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:85.3046875 - perf/cpu_memory_used_gb:96.54792404174805 - actor/lr:1e-06 - training/global_step:8 - training/epoch:0 - critic/score/mean:0.6625000238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6625000238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04829324409365654 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.04829324409365654 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:290.515625 - response_length/max:1273.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.387809455394745e-05 - timing_s/generate_sequences:31.323040008544922 - timing_s/reshard:0.7261854410171509 - timing_s/gen:41.65451106056571 - timing_s/reward:0.07219354063272476 - timing_s/old_log_prob:1.1133766192942858 - timing_s/ref:1.3487452827394009 - timing_s/adv:0.00750141404569149 - timing_s/update_actor:7.1753850765526295 - timing_s/step:51.384698923677206 - timing_s/stop_profile:4.2768195271492004e-05 - timing_per_token_ms/adv:3.3502664280348764e-05 - timing_per_token_ms/gen:0.44806659560658 - timing_per_token_ms/ref:0.006023739008684044 - timing_per_token_ms/update_actor:0.03204656026686599 - perf/total_num_tokens:223905 - perf/time_per_step:51.384698923677206 - perf/throughput:544.6781938251961
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.846875011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.846875011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.036538753658533096, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.036538753658533096, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 239.8125, 'response_length/max': 771.0, 'response_length/min': 60.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.846875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   2%|▏         | 9/525 [08:55<7:29:15, 52.24s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:49:41,108:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:49:44,915:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:49:44,917:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:49:45,445:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:   2%|▏         | 10/525 [10:00<8:01:08, 56.06s/it]
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-05 23:49:41,297:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:9 - global_seqlen/min:24269 - global_seqlen/max:28540 - global_seqlen/minmax_diff:4271 - global_seqlen/balanced_min:25973 - global_seqlen/balanced_max:25974 - global_seqlen/mean:25973.125 - actor/entropy:0.9044944047927856 - actor/kl_loss:0.02494302922859788 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2430763453245163 - actor/pg_clipfrac:0.0025228969578165563 - actor/ppo_kl:0.0018629740086907986 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4724482297897339 - perf/mfu/actor:0.07950527577463552 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:85.3046875 - perf/cpu_memory_used_gb:96.51962280273438 - actor/lr:1e-06 - training/global_step:9 - training/epoch:0 - critic/score/mean:0.846875011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.846875011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.036538753658533096 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.036538753658533096 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:239.8125 - response_length/max:771.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.846875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.432380855083466e-05 - timing_s/generate_sequences:21.969114303588867 - timing_s/reshard:0.7239785194396973 - timing_s/gen:27.047429099678993 - timing_s/reward:0.06670224107801914 - timing_s/old_log_prob:1.0596190355718136 - timing_s/ref:1.3372374661266804 - timing_s/adv:0.007458899170160294 - timing_s/update_actor:6.950427073985338 - timing_s/step:36.489540588110685 - timing_s/stop_profile:4.5416876673698425e-05 - timing_per_token_ms/adv:3.589719744043263e-05 - timing_per_token_ms/gen:0.3524554222006645 - timing_per_token_ms/ref:0.006435678543334121 - timing_per_token_ms/update_actor:0.0334500905935719 - perf/total_num_tokens:207785 - perf/time_per_step:36.489540588110685 - perf/throughput:711.796437592387
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.84375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.84375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.036246344447135925, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.036246344447135925, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 262.6000061035156, 'response_length/max': 1446.0, 'response_length/min': 37.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.84375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:10 - global_seqlen/min:23122 - global_seqlen/max:33757 - global_seqlen/minmax_diff:10635 - global_seqlen/balanced_min:26874 - global_seqlen/balanced_max:27022 - global_seqlen/mean:26897.75 - actor/entropy:0.757432222366333 - actor/kl_loss:0.021788653871044516 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.014930116385221482 - actor/pg_clipfrac:0.0015811907360330224 - actor/ppo_kl:-2.6270634407410396e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5422660112380981 - perf/mfu/actor:0.08065178325495549 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.46016311645508 - actor/lr:1e-06 - training/global_step:10 - training/epoch:0 - critic/score/mean:0.84375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.84375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.036246344447135925 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.036246344447135925 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:262.6000061035156 - response_length/max:1446.0 - response_length/min:37.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.84375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.534453809261322e-05 - timing_s/generate_sequences:30.293407440185547 - timing_s/reshard:0.6564627885818481 - timing_s/gen:46.60200713761151 - timing_s/reward:0.06799399852752686 - timing_s/old_log_prob:1.0910823307931423 - timing_s/ref:1.3423822652548552 - timing_s/adv:0.0076263677328825 - timing_s/update_actor:7.106168158352375 - timing_s/save_checkpoint:8.241471780464053 - timing_s/step:64.47961242683232 - timing_s/stop_profile:5.166791379451752e-05 - timing_per_token_ms/adv:3.54414762056422e-05 - timing_per_token_ms/gen:0.5545745327686061 - timing_per_token_ms/ref:0.0062383576007977205 - timing_per_token_ms/update_actor:0.03302398973126179 - perf/total_num_tokens:215182 - perf/time_per_step:64.47961242683232 - perf/throughput:417.1512356796807
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9750000238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9750000238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.006389816291630268, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.006389816291630268, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 251.4375, 'response_length/max': 812.0, 'response_length/min': 37.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.975, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   2%|▏         | 11/525 [10:38<7:12:55, 50.54s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-05 23:49:46,451:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-05 23:49:46,454:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_10/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:   2%|▏         | 12/525 [11:50<8:09:25, 57.24s/it]
[36m(TaskRunner pid=2949575)[0m step:11 - global_seqlen/min:24911 - global_seqlen/max:28711 - global_seqlen/minmax_diff:3800 - global_seqlen/balanced_min:26460 - global_seqlen/balanced_max:26460 - global_seqlen/mean:26460.0 - actor/entropy:0.7894261479377747 - actor/kl_loss:0.02514644619077444 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.046204082760959865 - actor/pg_clipfrac:0.0023902251152321695 - actor/ppo_kl:-0.0003235455827962141 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8374794125556946 - perf/mfu/actor:0.08060282315423009 - perf/max_memory_allocated_gb:63.38253927230835 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.48937225341797 - actor/lr:1e-06 - training/global_step:11 - training/epoch:0 - critic/score/mean:0.9750000238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9750000238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.006389816291630268 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.006389816291630268 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:251.4375 - response_length/max:812.0 - response_length/min:37.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.975 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.409656584262848e-05 - timing_s/generate_sequences:23.849897384643555 - timing_s/reshard:0.889758288860321 - timing_s/gen:28.31942205876112 - timing_s/reward:0.06771903298795223 - timing_s/old_log_prob:1.0632826182991266 - timing_s/ref:1.344941858202219 - timing_s/adv:0.007404390722513199 - timing_s/update_actor:6.9891382325440645 - timing_s/step:37.805034609511495 - timing_s/stop_profile:4.529021680355072e-05 - timing_per_token_ms/adv:3.497917007989984e-05 - timing_per_token_ms/gen:0.35196895424759034 - timing_per_token_ms/ref:0.006353655792716454 - timing_per_token_ms/update_actor:0.03301747086424823 - perf/total_num_tokens:211680 - perf/time_per_step:37.805034609511495 - perf/throughput:699.9067789067132
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9078124761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9078124761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09573903679847717, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.09573903679847717, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 275.3187561035156, 'response_length/max': 2048.0, 'response_length/min': 42.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 410.71875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9078125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:12 - global_seqlen/min:25951 - global_seqlen/max:30092 - global_seqlen/minmax_diff:4141 - global_seqlen/balanced_min:27330 - global_seqlen/balanced_max:28215 - global_seqlen/mean:27441.5 - actor/entropy:0.7510404586791992 - actor/kl_loss:0.04178844682173803 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16307399347424506 - actor/pg_clipfrac:0.0029965513123897834 - actor/ppo_kl:0.0017955041548702866 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.579826295375824 - perf/mfu/actor:0.08284819585787354 - perf/max_memory_allocated_gb:63.55276346206665 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.6644287109375 - actor/lr:1e-06 - training/global_step:12 - training/epoch:0 - critic/score/mean:0.9078124761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9078124761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09573903679847717 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.09573903679847717 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:275.3187561035156 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.71875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9078125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.827447891235352e-05 - timing_s/generate_sequences:36.004703521728516 - timing_s/reshard:0.6574113368988037 - timing_s/gen:62.59298082254827 - timing_s/reward:0.06910581700503826 - timing_s/old_log_prob:1.1035731099545956 - timing_s/ref:1.3612890783697367 - timing_s/adv:0.007396526634693146 - timing_s/update_actor:7.061795776709914 - timing_s/step:72.21624155342579 - timing_s/stop_profile:4.435144364833832e-05 - timing_per_token_ms/adv:3.369224821298556e-05 - timing_per_token_ms/gen:0.7104603848102004 - timing_per_token_ms/ref:0.006200868567542484 - timing_per_token_ms/update_actor:0.03216750075938776 - perf/total_num_tokens:219532 - perf/time_per_step:72.21624155342579 - perf/throughput:379.99069751779723
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0515625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0515625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.030185390263795853, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.030185390263795853, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 267.6468811035156, 'response_length/max': 1358.0, 'response_length/min': 19.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   2%|▏         | 13/525 [12:44<7:58:02, 56.02s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   3%|▎         | 14/525 [13:51<8:26:01, 59.42s/it]
[36m(TaskRunner pid=2949575)[0m step:13 - global_seqlen/min:23877 - global_seqlen/max:28619 - global_seqlen/minmax_diff:4742 - global_seqlen/balanced_min:27036 - global_seqlen/balanced_max:27185 - global_seqlen/mean:27073.375 - actor/entropy:0.7780858278274536 - actor/kl_loss:0.032026811875402926 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12863599099218845 - actor/pg_clipfrac:0.002766444982262328 - actor/ppo_kl:0.001362742804121808 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3034922778606415 - perf/mfu/actor:0.08213667548792687 - perf/max_memory_allocated_gb:63.55276346206665 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.6322250366211 - actor/lr:1e-06 - training/global_step:13 - training/epoch:0 - critic/score/mean:1.0515625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0515625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.030185390263795853 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.030185390263795853 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:267.6468811035156 - response_length/max:1358.0 - response_length/min:19.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.101893424987793e-05 - timing_s/generate_sequences:34.1419677734375 - timing_s/reshard:0.7426717877388 - timing_s/gen:43.580059088766575 - timing_s/reward:0.07001689448952675 - timing_s/old_log_prob:1.1438143085688353 - timing_s/ref:1.3470878414809704 - timing_s/adv:0.0074430201202631 - timing_s/update_actor:7.027419723570347 - timing_s/step:53.18944430537522 - timing_s/stop_profile:4.209578037261963e-05 - timing_per_token_ms/adv:3.4365036314566894e-05 - timing_per_token_ms/gen:0.508833456965995 - timing_per_token_ms/ref:0.006219615403883753 - timing_per_token_ms/update_actor:0.03244617508701052 - perf/total_num_tokens:216587 - perf/time_per_step:53.18944430537522 - perf/throughput:508.9990195153067
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.087499976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.087499976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05093945935368538, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05093945935368538, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 262.125, 'response_length/max': 1914.0, 'response_length/min': 45.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:14 - global_seqlen/min:24515 - global_seqlen/max:30026 - global_seqlen/minmax_diff:5511 - global_seqlen/balanced_min:26763 - global_seqlen/balanced_max:27444 - global_seqlen/mean:26848.125 - actor/entropy:0.7309288382530212 - actor/kl_loss:0.04197848218027502 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.33716158866882323 - actor/pg_clipfrac:0.0014284877193858846 - actor/ppo_kl:0.0008923139877879294 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2912631928920746 - perf/mfu/actor:0.08111853413417411 - perf/max_memory_allocated_gb:63.55276346206665 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.61132431030273 - actor/lr:1e-06 - training/global_step:14 - training/epoch:0 - critic/score/mean:1.087499976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.087499976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05093945935368538 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05093945935368538 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:262.125 - response_length/max:1914.0 - response_length/min:45.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.346831262111664e-05 - timing_s/generate_sequences:34.43695831298828 - timing_s/reshard:0.6633158326148987 - timing_s/gen:57.666456900537014 - timing_s/reward:0.06782758235931396 - timing_s/old_log_prob:1.0951079968363047 - timing_s/ref:1.3440533895045519 - timing_s/adv:0.007432887330651283 - timing_s/update_actor:7.054397692903876 - timing_s/step:67.24838439561427 - timing_s/stop_profile:4.535354673862457e-05 - timing_per_token_ms/adv:3.4606175154928336e-05 - timing_per_token_ms/gen:0.6874875643840845 - timing_per_token_ms/ref:0.006257668782757417 - timing_per_token_ms/update_actor:0.032843996056074104 - perf/total_num_tokens:214785 - perf/time_per_step:67.24838439561427 - perf/throughput:399.2382157771355
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.024999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.024999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.053113486617803574, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.053113486617803574, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 253.828125, 'response_length/max': 2048.0, 'response_length/min': 59.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.025, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   3%|▎         | 15/525 [15:01<8:53:29, 62.76s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   3%|▎         | 16/525 [15:49<8:13:58, 58.23s/it]
[36m(TaskRunner pid=2949575)[0m step:15 - global_seqlen/min:24943 - global_seqlen/max:28672 - global_seqlen/minmax_diff:3729 - global_seqlen/balanced_min:26418 - global_seqlen/balanced_max:27374 - global_seqlen/mean:26538.125 - actor/entropy:0.7334935665130615 - actor/kl_loss:0.02795028854161501 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04217883171513677 - actor/pg_clipfrac:0.00207707587396726 - actor/ppo_kl:2.13590421481058e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5014626383781433 - perf/mfu/actor:0.07702151305386863 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.58857727050781 - actor/lr:1e-06 - training/global_step:15 - training/epoch:0 - critic/score/mean:1.024999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.024999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.053113486617803574 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.053113486617803574 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:253.828125 - response_length/max:2048.0 - response_length/min:59.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.025 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.174909114837646e-05 - timing_s/generate_sequences:33.10239791870117 - timing_s/reshard:0.6841708421707153 - timing_s/gen:60.5220042783767 - timing_s/reward:0.1966502908617258 - timing_s/old_log_prob:1.0928322933614254 - timing_s/ref:1.3448121845722198 - timing_s/adv:0.007421914488077164 - timing_s/update_actor:7.338381027802825 - timing_s/step:70.51528557389975 - timing_s/stop_profile:4.3567270040512085e-05 - timing_per_token_ms/adv:3.4958736195931155e-05 - timing_per_token_ms/gen:0.7451154728024216 - timing_per_token_ms/ref:0.0063343406164349395 - timing_per_token_ms/update_actor:0.034565276502215324 - perf/total_num_tokens:212305 - perf/time_per_step:70.51528557389975 - perf/throughput:376.3457069487175
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.149999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.149999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.037657786160707474, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.037657786160707474, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 277.6343688964844, 'response_length/max': 1145.0, 'response_length/min': 53.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.15, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:16 - global_seqlen/min:25621 - global_seqlen/max:30259 - global_seqlen/minmax_diff:4638 - global_seqlen/balanced_min:27481 - global_seqlen/balanced_max:27482 - global_seqlen/mean:27481.625 - actor/entropy:0.7206591367721558 - actor/kl_loss:0.03378402572125196 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07841411512345076 - actor/pg_clipfrac:0.0011488164018373936 - actor/ppo_kl:0.00021226193493930622 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3512043952941895 - perf/mfu/actor:0.08123994029184761 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.60130310058594 - actor/lr:1e-06 - training/global_step:16 - training/epoch:0 - critic/score/mean:1.149999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.149999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.037657786160707474 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.037657786160707474 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:277.6343688964844 - response_length/max:1145.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.15 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.340684533119202e-05 - timing_s/generate_sequences:33.82514190673828 - timing_s/reshard:0.7136570811271667 - timing_s/gen:37.9382710121572 - timing_s/reward:0.06934120878577232 - timing_s/old_log_prob:1.0908108353614807 - timing_s/ref:1.349846636876464 - timing_s/adv:0.007492301985621452 - timing_s/update_actor:7.213367125019431 - timing_s/step:47.6824053786695 - timing_s/stop_profile:4.298985004425049e-05 - timing_per_token_ms/adv:3.407868887675607e-05 - timing_per_token_ms/gen:0.42702600105981564 - timing_per_token_ms/ref:0.006139769013279163 - timing_per_token_ms/update_actor:0.032809955402107 - perf/total_num_tokens:219853 - perf/time_per_step:47.6824053786695 - perf/throughput:576.347287469138
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.173437476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.173437476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.024366354569792747, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888504266738892, 'critic/returns/mean': -0.024366354569792747, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888504266738892, 'response_length/mean': 247.90625, 'response_length/max': 1157.0, 'response_length/min': 58.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   3%|▎         | 17/525 [16:37<7:46:00, 55.04s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   3%|▎         | 18/525 [17:20<7:16:24, 51.65s/it]
[36m(TaskRunner pid=2949575)[0m step:17 - global_seqlen/min:24807 - global_seqlen/max:28603 - global_seqlen/minmax_diff:3796 - global_seqlen/balanced_min:26305 - global_seqlen/balanced_max:26376 - global_seqlen/mean:26323.125 - actor/entropy:0.6933214664459229 - actor/kl_loss:0.04653397309593856 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08018673476763069 - actor/pg_clipfrac:0.00348533287178725 - actor/ppo_kl:0.0020585084950653252 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3023485839366913 - perf/mfu/actor:0.07964443723492737 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.189453125 - perf/cpu_memory_used_gb:96.63400650024414 - actor/lr:1e-06 - training/global_step:17 - training/epoch:0 - critic/score/mean:1.173437476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.173437476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.024366354569792747 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:-0.024366354569792747 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888504266738892 - response_length/mean:247.90625 - response_length/max:1157.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.398853242397308e-05 - timing_s/generate_sequences:30.707883834838867 - timing_s/reshard:0.884536623954773 - timing_s/gen:37.84084586985409 - timing_s/reward:0.06736514531075954 - timing_s/old_log_prob:1.0875381734222174 - timing_s/ref:1.3753578644245863 - timing_s/adv:0.0077845752239227295 - timing_s/update_actor:7.034598603844643 - timing_s/step:47.42666840925813 - timing_s/stop_profile:4.395097494125366e-05 - timing_per_token_ms/adv:3.696642792184975e-05 - timing_per_token_ms/gen:0.47700549438868134 - timing_per_token_ms/ref:0.006531129303723372 - timing_per_token_ms/update_actor:0.03340503171567131 - perf/total_num_tokens:210585 - perf/time_per_step:47.42666840925813 - perf/throughput:555.0279174756766
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.149999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.149999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0015403041616082191, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0015403041616082191, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 266.453125, 'response_length/max': 1045.0, 'response_length/min': 53.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.15, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:18 - global_seqlen/min:25569 - global_seqlen/max:28931 - global_seqlen/minmax_diff:3362 - global_seqlen/balanced_min:27043 - global_seqlen/balanced_max:27069 - global_seqlen/mean:27047.5 - actor/entropy:0.7121930718421936 - actor/kl_loss:0.04037037268280983 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.009831231459975243 - actor/pg_clipfrac:0.0013551093637943269 - actor/ppo_kl:0.00022734745289199054 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1595311164855957 - perf/mfu/actor:0.08298733332260513 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.6440200805664 - actor/lr:1e-06 - training/global_step:18 - training/epoch:0 - critic/score/mean:1.149999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.149999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0015403041616082191 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0015403041616082191 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:266.453125 - response_length/max:1045.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.15 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.952377200126648e-05 - timing_s/generate_sequences:27.0091552734375 - timing_s/reshard:0.75713050365448 - timing_s/gen:34.179897317662835 - timing_s/reward:0.06824414618313313 - timing_s/old_log_prob:1.0663928613066673 - timing_s/ref:1.345293067395687 - timing_s/adv:0.0074849799275398254 - timing_s/update_actor:6.940855035558343 - timing_s/step:43.62155796214938 - timing_s/stop_profile:4.2844563722610474e-05 - timing_per_token_ms/adv:3.4591828854514396e-05 - timing_per_token_ms/gen:0.4008666782110225 - timing_per_token_ms/ref:0.0062172708540331224 - timing_per_token_ms/update_actor:0.03207715609371634 - perf/total_num_tokens:216380 - perf/time_per_step:43.62155796214938 - perf/throughput:620.0489222202755
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.079687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.079687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.028359388932585716, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.028359388932585716, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 269.609375, 'response_length/max': 1085.0, 'response_length/min': 40.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.609375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   4%|▎         | 19/525 [18:05<6:58:36, 49.64s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:58:46,270:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:58:50,120:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:58:50,122:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-05 23:58:50,652:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:   4%|▍         | 20/525 [19:05<7:22:21, 52.56s/it]
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-05 23:58:46,490:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:19 - global_seqlen/min:23794 - global_seqlen/max:30254 - global_seqlen/minmax_diff:6460 - global_seqlen/balanced_min:27208 - global_seqlen/balanced_max:27209 - global_seqlen/mean:27208.75 - actor/entropy:0.6608926057815552 - actor/kl_loss:0.046185235399752854 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.009929811954498291 - actor/pg_clipfrac:0.001675402227556333 - actor/ppo_kl:0.0006492923951554985 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.229796290397644 - perf/mfu/actor:0.08296017770769439 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.68259811401367 - actor/lr:1e-06 - training/global_step:19 - training/epoch:0 - critic/score/mean:1.079687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.079687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.028359388932585716 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.028359388932585716 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:269.609375 - response_length/max:1085.0 - response_length/min:40.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.609375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.411519229412079e-05 - timing_s/generate_sequences:29.446277618408203 - timing_s/reshard:0.7787729501724243 - timing_s/gen:35.14483396336436 - timing_s/reward:0.07152491621673107 - timing_s/old_log_prob:1.1727365870028734 - timing_s/ref:1.3489448577165604 - timing_s/adv:0.007210562005639076 - timing_s/update_actor:6.988836674019694 - timing_s/step:44.747524762526155 - timing_s/stop_profile:4.4248998165130615e-05 - timing_per_token_ms/adv:3.3126117543249305e-05 - timing_per_token_ms/gen:0.407358260948877 - timing_per_token_ms/ref:0.006197201533130704 - timing_per_token_ms/update_actor:0.03210748690228187 - perf/total_num_tokens:217670 - perf/time_per_step:44.747524762526155 - perf/throughput:608.0503926059836
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3093750476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3093750476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0019157429924234748, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.0019157429924234748, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 239.1593780517578, 'response_length/max': 1302.0, 'response_length/min': 18.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.309375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:20 - global_seqlen/min:22773 - global_seqlen/max:28950 - global_seqlen/minmax_diff:6177 - global_seqlen/balanced_min:25846 - global_seqlen/balanced_max:26045 - global_seqlen/mean:25920.75 - actor/entropy:0.7636928558349609 - actor/kl_loss:0.03914099205285311 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0121498703956604 - actor/pg_clipfrac:0.0007278666249476373 - actor/ppo_kl:-0.00010779321428344701 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.154744729399681 - perf/mfu/actor:0.0753249469688103 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.71016311645508 - actor/lr:1e-06 - training/global_step:20 - training/epoch:0 - critic/score/mean:1.3093750476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3093750476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0019157429924234748 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0019157429924234748 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:239.1593780517578 - response_length/max:1302.0 - response_length/min:18.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.309375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.597038686275482e-05 - timing_s/generate_sequences:30.546958923339844 - timing_s/reshard:0.6867142915725708 - timing_s/gen:41.16227004118264 - timing_s/reward:0.06718194484710693 - timing_s/old_log_prob:1.0806059427559376 - timing_s/ref:1.3486989103257656 - timing_s/adv:0.009930243715643883 - timing_s/update_actor:7.323639681562781 - timing_s/save_checkpoint:8.01253679394722 - timing_s/step:59.018126148730516 - timing_s/stop_profile:4.9369409680366516e-05 - timing_per_token_ms/adv:4.788752117340298e-05 - timing_per_token_ms/gen:0.5378509367600403 - timing_per_token_ms/ref:0.006503953928444228 - timing_per_token_ms/update_actor:0.03531745648545461 - perf/total_num_tokens:207366 - perf/time_per_step:59.018126148730516 - perf/throughput:439.19981353995524
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.225000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.225000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0022732734214514494, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888504266738892, 'critic/returns/mean': 0.0022732734214514494, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888504266738892, 'response_length/mean': 237.140625, 'response_length/max': 1011.0, 'response_length/min': 39.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.225, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   4%|▍         | 21/525 [19:48<6:56:54, 49.63s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-05 23:58:51,432:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-05 23:58:51,435:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_20/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:   4%|▍         | 22/525 [20:31<6:40:01, 47.72s/it]
[36m(TaskRunner pid=2949575)[0m step:21 - global_seqlen/min:24235 - global_seqlen/max:27231 - global_seqlen/minmax_diff:2996 - global_seqlen/balanced_min:25857 - global_seqlen/balanced_max:25892 - global_seqlen/mean:25861.875 - actor/entropy:0.7337387204170227 - actor/kl_loss:0.052405704464763406 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.18143510799854995 - actor/pg_clipfrac:0.0008384670480154454 - actor/ppo_kl:0.0013469490135321394 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4073121845722198 - perf/mfu/actor:0.07882582858344778 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.55578994750977 - actor/lr:1e-06 - training/global_step:21 - training/epoch:0 - critic/score/mean:1.225000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.225000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0022732734214514494 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888504266738892 - critic/returns/mean:0.0022732734214514494 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888504266738892 - response_length/mean:237.140625 - response_length/max:1011.0 - response_length/min:39.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.225 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.373839616775513e-05 - timing_s/generate_sequences:24.188194274902344 - timing_s/reshard:0.6841760277748108 - timing_s/gen:33.27391556277871 - timing_s/reward:0.0663421731442213 - timing_s/old_log_prob:1.1084047816693783 - timing_s/ref:1.3429331853985786 - timing_s/adv:0.007414335384964943 - timing_s/update_actor:6.978755172342062 - timing_s/step:42.791349705308676 - timing_s/stop_profile:4.484318196773529e-05 - timing_per_token_ms/adv:3.583622313233738e-05 - timing_per_token_ms/gen:0.43847816515488847 - timing_per_token_ms/ref:0.006490892411119547 - timing_per_token_ms/update_actor:0.03373090298142566 - perf/total_num_tokens:206895 - perf/time_per_step:42.791349705308676 - perf/throughput:604.3715652369709
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2109375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2109375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.01674197055399418, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.01674197055399418, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 264.05938720703125, 'response_length/max': 1012.0, 'response_length/min': 51.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:22 - global_seqlen/min:24036 - global_seqlen/max:29924 - global_seqlen/minmax_diff:5888 - global_seqlen/balanced_min:26938 - global_seqlen/balanced_max:26939 - global_seqlen/mean:26938.625 - actor/entropy:0.6637237668037415 - actor/kl_loss:0.04715621806681156 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06767612472176551 - actor/pg_clipfrac:0.001541824999731034 - actor/ppo_kl:5.03873383422615e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3764655590057373 - perf/mfu/actor:0.08104490496959978 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.55221557617188 - actor/lr:1e-06 - training/global_step:22 - training/epoch:0 - critic/score/mean:1.2109375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2109375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.01674197055399418 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.01674197055399418 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:264.05938720703125 - response_length/max:1012.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.238239049911499e-05 - timing_s/generate_sequences:27.500043869018555 - timing_s/reshard:0.6666742563247681 - timing_s/gen:33.64380579814315 - timing_s/reward:0.06831914000213146 - timing_s/old_log_prob:1.0742207281291485 - timing_s/ref:1.346278753131628 - timing_s/adv:0.007485078647732735 - timing_s/update_actor:7.080879986286163 - timing_s/step:43.23862767033279 - timing_s/stop_profile:4.505552351474762e-05 - timing_per_token_ms/adv:3.47320930807193e-05 - timing_per_token_ms/gen:0.3981562598154197 - timing_per_token_ms/ref:0.006246972298751458 - timing_per_token_ms/update_actor:0.03285653957044097 - perf/total_num_tokens:215509 - perf/time_per_step:43.23862767033279 - perf/throughput:623.0222014766516
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.193750023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.193750023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.008201244287192822, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.008201244287192822, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 278.79998779296875, 'response_length/max': 2048.0, 'response_length/min': 48.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.19375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   4%|▍         | 23/525 [21:42<7:39:03, 54.87s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   5%|▍         | 24/525 [22:26<7:10:39, 51.58s/it]
[36m(TaskRunner pid=2949575)[0m step:23 - global_seqlen/min:24851 - global_seqlen/max:30810 - global_seqlen/minmax_diff:5959 - global_seqlen/balanced_min:27443 - global_seqlen/balanced_max:28219 - global_seqlen/mean:27541.375 - actor/entropy:0.6279597878456116 - actor/kl_loss:0.06874510520137847 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12149179261177778 - actor/pg_clipfrac:0.002340404872666113 - actor/ppo_kl:0.001021293307439919 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2330092787742615 - perf/mfu/actor:0.0834442308785792 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.58532333374023 - actor/lr:1e-06 - training/global_step:23 - training/epoch:0 - critic/score/mean:1.193750023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.193750023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.008201244287192822 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.008201244287192822 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:278.79998779296875 - response_length/max:2048.0 - response_length/min:48.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.19375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.273256778717041e-05 - timing_s/generate_sequences:40.038448333740234 - timing_s/reshard:0.7531173825263977 - timing_s/gen:61.8433325085789 - timing_s/reward:0.06932376883924007 - timing_s/old_log_prob:1.2082250900566578 - timing_s/ref:1.3567661885172129 - timing_s/adv:0.0075332652777433395 - timing_s/update_actor:7.039547014981508 - timing_s/step:71.53812649101019 - timing_s/stop_profile:4.5260414481163025e-05 - timing_per_token_ms/adv:3.41906734764665e-05 - timing_per_token_ms/gen:0.6931865641653839 - timing_per_token_ms/ref:0.006157854267067334 - timing_per_token_ms/update_actor:0.03194987094408643 - perf/total_num_tokens:220331 - perf/time_per_step:71.53812649101019 - perf/throughput:384.9887654446888
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.264062523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.264062523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.007067169528454542, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.007067169528454542, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 259.171875, 'response_length/max': 1016.0, 'response_length/min': 51.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:24 - global_seqlen/min:23539 - global_seqlen/max:30241 - global_seqlen/minmax_diff:6702 - global_seqlen/balanced_min:26730 - global_seqlen/balanced_max:26730 - global_seqlen/mean:26730.0 - actor/entropy:0.6509729027748108 - actor/kl_loss:0.05296105295419693 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06684689372777938 - actor/pg_clipfrac:0.0017715816909912973 - actor/ppo_kl:-0.00047148297726380407 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.409722924232483 - perf/mfu/actor:0.07752678468818709 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.63180541992188 - actor/lr:1e-06 - training/global_step:24 - training/epoch:0 - critic/score/mean:1.264062523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.264062523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.007067169528454542 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.007067169528454542 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:259.171875 - response_length/max:1016.0 - response_length/min:51.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.095746695995331e-05 - timing_s/generate_sequences:28.37706756591797 - timing_s/reshard:0.6805906295776367 - timing_s/gen:34.02344308234751 - timing_s/reward:0.06777544319629669 - timing_s/old_log_prob:1.0786636117845774 - timing_s/ref:1.3492613714188337 - timing_s/adv:0.00750076025724411 - timing_s/update_actor:7.341481989249587 - timing_s/step:43.88117568939924 - timing_s/stop_profile:4.1853636503219604e-05 - timing_per_token_ms/adv:3.507650700170272e-05 - timing_per_token_ms/gen:0.4102422750629712 - timing_per_token_ms/ref:0.006309677195187213 - timing_per_token_ms/update_actor:0.0343316591341638 - perf/total_num_tokens:213840 - perf/time_per_step:43.88117568939924 - perf/throughput:609.1450281369147
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2703125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2703125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.003277992829680443, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.003277992829680443, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 311.2281188964844, 'response_length/max': 1199.0, 'response_length/min': 58.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   5%|▍         | 25/525 [23:15<7:03:45, 50.85s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   5%|▍         | 26/525 [23:55<6:33:49, 47.35s/it]
[36m(TaskRunner pid=2949575)[0m step:25 - global_seqlen/min:27568 - global_seqlen/max:31063 - global_seqlen/minmax_diff:3495 - global_seqlen/balanced_min:28796 - global_seqlen/balanced_max:28887 - global_seqlen/mean:28807.875 - actor/entropy:0.6374835968017578 - actor/kl_loss:0.05751388603821397 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1082801178097725 - actor/pg_clipfrac:0.001586403645342216 - actor/ppo_kl:0.0013679237286851275 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0093065798282623 - perf/mfu/actor:0.08717377376163078 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.65328216552734 - actor/lr:1e-06 - training/global_step:25 - training/epoch:0 - critic/score/mean:1.2703125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2703125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.003277992829680443 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.003277992829680443 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:311.2281188964844 - response_length/max:1199.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.621066808700562e-05 - timing_s/generate_sequences:28.937828063964844 - timing_s/reshard:0.7284139394760132 - timing_s/gen:39.201121132820845 - timing_s/reward:0.07222814112901688 - timing_s/old_log_prob:1.237518372014165 - timing_s/ref:1.35663291066885 - timing_s/adv:0.007425729185342789 - timing_s/update_actor:7.051485031843185 - timing_s/step:48.939566833898425 - timing_s/stop_profile:4.328414797782898e-05 - timing_per_token_ms/adv:3.222091695995795e-05 - timing_per_token_ms/gen:0.39361321712189457 - timing_per_token_ms/ref:0.005886554070149438 - timing_per_token_ms/update_actor:0.03059703740662573 - perf/total_num_tokens:230463 - perf/time_per_step:48.939566833898425 - perf/throughput:588.6418058781421
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.189062476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.189062476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01143368985503912, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.01143368985503912, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 269.28436279296875, 'response_length/max': 859.0, 'response_length/min': 61.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:26 - global_seqlen/min:24728 - global_seqlen/max:29446 - global_seqlen/minmax_diff:4718 - global_seqlen/balanced_min:27165 - global_seqlen/balanced_max:27166 - global_seqlen/mean:27165.125 - actor/entropy:0.6227263808250427 - actor/kl_loss:0.06174110919237137 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.011932998523116111 - actor/pg_clipfrac:0.0015702416305430234 - actor/ppo_kl:0.0009209837502567097 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1842896044254303 - perf/mfu/actor:0.0830436384764153 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.68630599975586 - actor/lr:1e-06 - training/global_step:26 - training/epoch:0 - critic/score/mean:1.189062476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.189062476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01143368985503912 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.01143368985503912 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:269.28436279296875 - response_length/max:859.0 - response_length/min:61.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.388794958591461e-05 - timing_s/generate_sequences:25.215320587158203 - timing_s/reshard:0.687451958656311 - timing_s/gen:29.59066439792514 - timing_s/reward:0.068941755220294 - timing_s/old_log_prob:1.0804989524185658 - timing_s/ref:1.3742219507694244 - timing_s/adv:0.007515564560890198 - timing_s/update_actor:6.970576843246818 - timing_s/step:39.10571206174791 - timing_s/stop_profile:4.38690185546875e-05 - timing_per_token_ms/adv:3.4582781051486964e-05 - timing_per_token_ms/gen:0.34339469656758237 - timing_per_token_ms/ref:0.006323465982438073 - timing_per_token_ms/update_actor:0.03207502654251921 - perf/total_num_tokens:217321 - perf/time_per_step:39.10571206174791 - perf/throughput:694.6587484996124
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2937500476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2937500476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.027047174051404, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.027047174051404, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 299.71875, 'response_length/max': 1872.0, 'response_length/min': 27.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.29375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   5%|▌         | 27/525 [25:02<7:23:10, 53.40s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   5%|▌         | 28/525 [25:53<7:16:17, 52.67s/it]
[36m(TaskRunner pid=2949575)[0m step:27 - global_seqlen/min:24927 - global_seqlen/max:31689 - global_seqlen/minmax_diff:6762 - global_seqlen/balanced_min:28289 - global_seqlen/balanced_max:28856 - global_seqlen/mean:28360.625 - actor/entropy:0.5966547131538391 - actor/kl_loss:0.056493199430406094 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.25855091284029186 - actor/pg_clipfrac:0.0014075088605750353 - actor/ppo_kl:0.00014149325506878084 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4456331431865692 - perf/mfu/actor:0.086227327558725 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.59347915649414 - actor/lr:1e-06 - training/global_step:27 - training/epoch:0 - critic/score/mean:1.2937500476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2937500476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.027047174051404 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.027047174051404 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:299.71875 - response_length/max:1872.0 - response_length/min:27.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.29375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.617527782917023e-05 - timing_s/generate_sequences:37.211124420166016 - timing_s/reshard:0.6673580408096313 - timing_s/gen:57.70765941217542 - timing_s/reward:0.07144972495734692 - timing_s/old_log_prob:1.1539142914116383 - timing_s/ref:1.3561072945594788 - timing_s/adv:0.007438594475388527 - timing_s/update_actor:7.0238119047135115 - timing_s/step:67.33381247706711 - timing_s/stop_profile:4.305504262447357e-05 - timing_per_token_ms/adv:3.278574817810136e-05 - timing_per_token_ms/gen:0.6016855323967826 - timing_per_token_ms/ref:0.00597706897573431 - timing_per_token_ms/update_actor:0.030957586022493825 - perf/total_num_tokens:226885 - perf/time_per_step:67.33381247706711 - perf/throughput:421.1944037723871
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3859374523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3859374523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00612938916310668, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.00612938916310668, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 279.68438720703125, 'response_length/max': 1286.0, 'response_length/min': 53.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.53125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:28 - global_seqlen/min:25298 - global_seqlen/max:29683 - global_seqlen/minmax_diff:4385 - global_seqlen/balanced_min:27522 - global_seqlen/balanced_max:27568 - global_seqlen/mean:27528.625 - actor/entropy:0.6404309272766113 - actor/kl_loss:0.06785428011789918 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.34114017644897104 - actor/pg_clipfrac:0.0019336458441102876 - actor/ppo_kl:0.0009632013832742814 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.164828211069107 - perf/mfu/actor:0.08349326133008418 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.66534042358398 - actor/lr:1e-06 - training/global_step:28 - training/epoch:0 - critic/score/mean:1.3859374523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3859374523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00612938916310668 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.00612938916310668 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:279.68438720703125 - response_length/max:1286.0 - response_length/min:53.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.53125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.609145879745483e-05 - timing_s/generate_sequences:32.468990325927734 - timing_s/reshard:0.6705645322799683 - timing_s/gen:41.07275323010981 - timing_s/reward:0.06958824396133423 - timing_s/old_log_prob:1.0942489095032215 - timing_s/ref:1.3538683094084263 - timing_s/adv:0.007407695055007935 - timing_s/update_actor:7.029436765238643 - timing_s/step:50.64063325151801 - timing_s/stop_profile:4.597753286361694e-05 - timing_per_token_ms/adv:3.363632879869561e-05 - timing_per_token_ms/gen:0.45891857149364584 - timing_per_token_ms/ref:0.00614754782253212 - timing_per_token_ms/update_actor:0.03191876076828502 - perf/total_num_tokens:220229 - perf/time_per_step:50.64063325151801 - perf/throughput:543.607439963733
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.357812523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.357812523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04732483625411987, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': 0.04732483625411987, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 256.6187438964844, 'response_length/max': 1257.0, 'response_length/min': 59.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   6%|▌         | 29/525 [26:44<7:09:43, 51.98s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:07:15,683:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:07:19,311:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:07:19,314:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:07:19,881:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:   6%|▌         | 30/525 [27:35<7:06:31, 51.70s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:07:16,092:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:29 - global_seqlen/min:24304 - global_seqlen/max:29112 - global_seqlen/minmax_diff:4808 - global_seqlen/balanced_min:26629 - global_seqlen/balanced_max:26770 - global_seqlen/mean:26654.125 - actor/entropy:0.5963819026947021 - actor/kl_loss:0.08164118053391575 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07916275560855865 - actor/pg_clipfrac:0.0017613998847082258 - actor/ppo_kl:-0.0005791324787423946 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1894310414791107 - perf/mfu/actor:0.08162324691033235 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.70555877685547 - actor/lr:1e-06 - training/global_step:29 - training/epoch:0 - critic/score/mean:1.357812523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.357812523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04732483625411987 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.04732483625411987 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:256.6187438964844 - response_length/max:1257.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.174909114837646e-05 - timing_s/generate_sequences:28.193042755126953 - timing_s/reshard:0.6639148592948914 - timing_s/gen:40.83607617393136 - timing_s/reward:0.06959620863199234 - timing_s/old_log_prob:1.1353031769394875 - timing_s/ref:1.3483447190374136 - timing_s/adv:0.007460802793502808 - timing_s/update_actor:6.952519629150629 - timing_s/step:50.362928096204996 - timing_s/stop_profile:4.40012663602829e-05 - timing_per_token_ms/adv:3.498896884395383e-05 - timing_per_token_ms/gen:0.49728532324132785 - timing_per_token_ms/ref:0.006323339816245204 - timing_per_token_ms/update_actor:0.03260527042789169 - perf/total_num_tokens:213233 - perf/time_per_step:50.362928096204996 - perf/throughput:529.2409716346193
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.381250023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.381250023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02498752996325493, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.02498752996325493, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 276.6343688964844, 'response_length/max': 987.0, 'response_length/min': 47.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.38125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:30 - global_seqlen/min:23583 - global_seqlen/max:30887 - global_seqlen/minmax_diff:7304 - global_seqlen/balanced_min:27432 - global_seqlen/balanced_max:27433 - global_seqlen/mean:27432.875 - actor/entropy:0.6310005784034729 - actor/kl_loss:0.06874113995581865 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.00576486736536026 - actor/pg_clipfrac:0.0011350678920280187 - actor/ppo_kl:0.00042228312177030605 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1170027703046799 - perf/mfu/actor:0.08362755446470761 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.66873931884766 - actor/lr:1e-06 - training/global_step:30 - training/epoch:0 - critic/score/mean:1.381250023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.381250023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02498752996325493 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02498752996325493 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:276.6343688964844 - response_length/max:987.0 - response_length/min:47.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.38125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.115118205547333e-05 - timing_s/generate_sequences:26.880138397216797 - timing_s/reshard:0.7184833884239197 - timing_s/gen:33.21759879589081 - timing_s/reward:0.0694830920547247 - timing_s/old_log_prob:1.1286511588841677 - timing_s/ref:1.3522648941725492 - timing_s/adv:0.007489420473575592 - timing_s/update_actor:6.990278335288167 - timing_s/save_checkpoint:8.247499810531735 - timing_s/step:51.02649490348995 - timing_s/stop_profile:5.085766315460205e-05 - timing_per_token_ms/adv:3.41261190887557e-05 - timing_per_token_ms/gen:0.3752425787184213 - timing_per_token_ms/ref:0.0061616987563851274 - timing_per_token_ms/update_actor:0.03185173963396184 - perf/total_num_tokens:219463 - perf/time_per_step:51.02649490348995 - perf/throughput:537.6202118504466
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3046875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3046875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07261008024215698, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07261008024215698, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 317.03125, 'response_length/max': 2048.0, 'response_length/min': 68.0, 'response_length/clip_ratio': 0.00937500037252903, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   6%|▌         | 31/525 [28:48<7:58:14, 58.09s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:07:21,174:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:07:21,176:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_30/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:   6%|▌         | 32/525 [29:42<7:49:27, 57.13s/it]
[36m(TaskRunner pid=2949575)[0m step:31 - global_seqlen/min:25684 - global_seqlen/max:31702 - global_seqlen/minmax_diff:6018 - global_seqlen/balanced_min:28773 - global_seqlen/balanced_max:29535 - global_seqlen/mean:29079.375 - actor/entropy:0.5500984787940979 - actor/kl_loss:0.05484496848657727 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22962272734148428 - actor/pg_clipfrac:0.0016426256974227727 - actor/ppo_kl:-0.0008249383499787655 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3293116688728333 - perf/mfu/actor:0.08612726535243453 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.62984848022461 - actor/lr:1e-06 - training/global_step:31 - training/epoch:0 - critic/score/mean:1.3046875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3046875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07261008024215698 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07261008024215698 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:317.03125 - response_length/max:2048.0 - response_length/min:68.0 - response_length/clip_ratio:0.00937500037252903 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:6.918422877788544e-05 - timing_s/generate_sequences:52.3150634765625 - timing_s/reshard:0.6658521294593811 - timing_s/gen:63.13842288963497 - timing_s/reward:0.07262708246707916 - timing_s/old_log_prob:1.1625734809786081 - timing_s/ref:1.361104641109705 - timing_s/adv:0.0074371472001075745 - timing_s/update_actor:7.21993394009769 - timing_s/step:72.97515512630343 - timing_s/stop_profile:4.132278263568878e-05 - timing_per_token_ms/adv:3.1969167150719256e-05 - timing_per_token_ms/gen:0.6223600087691963 - timing_per_token_ms/ref:0.005850816261997141 - timing_per_token_ms/update_actor:0.03103545872331201 - perf/total_num_tokens:232635 - perf/time_per_step:72.97515512630343 - perf/throughput:398.48322281289023
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3125, 'critic/score/max': 2.0, 'critic/score/min': 0.5, 'critic/rewards/mean': 1.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': 0.5, 'critic/advantages/mean': -0.026977194473147392, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.026977194473147392, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 305.6812438964844, 'response_length/max': 1410.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:32 - global_seqlen/min:25617 - global_seqlen/max:31810 - global_seqlen/minmax_diff:6193 - global_seqlen/balanced_min:28541 - global_seqlen/balanced_max:28810 - global_seqlen/mean:28577.25 - actor/entropy:0.6054060459136963 - actor/kl_loss:0.07166354083456099 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13058837465941905 - actor/pg_clipfrac:0.0016666934156091885 - actor/ppo_kl:0.001962019319398678 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0828809589147568 - perf/mfu/actor:0.08726231499321443 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.72421264648438 - actor/lr:1e-06 - training/global_step:32 - training/epoch:0 - critic/score/mean:1.3125 - critic/score/max:2.0 - critic/score/min:0.5 - critic/rewards/mean:1.3125 - critic/rewards/max:2.0 - critic/rewards/min:0.5 - critic/advantages/mean:-0.026977194473147392 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.026977194473147392 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:305.6812438964844 - response_length/max:1410.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:6.936304271221161e-05 - timing_s/generate_sequences:29.0082950592041 - timing_s/reshard:0.6600945591926575 - timing_s/gen:45.377893382683396 - timing_s/reward:0.07155902124941349 - timing_s/old_log_prob:1.0863658599555492 - timing_s/ref:1.3604542762041092 - timing_s/adv:0.007496418431401253 - timing_s/update_actor:6.987273903563619 - timing_s/step:54.90447996556759 - timing_s/stop_profile:5.720183253288269e-05 - timing_per_token_ms/adv:3.2790149644390435e-05 - timing_per_token_ms/gen:0.46390125930486614 - timing_per_token_ms/ref:0.005950774987989175 - timing_per_token_ms/update_actor:0.030563096097261013 - perf/total_num_tokens:228618 - perf/time_per_step:54.90447996556759 - perf/throughput:520.4903136851808
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.310937523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.310937523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.019174959510564804, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.019174959510564804, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 303.9375, 'response_length/max': 1163.0, 'response_length/min': 66.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   6%|▋         | 33/525 [30:31<7:27:09, 54.53s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   6%|▋         | 34/525 [31:44<8:11:21, 60.04s/it]
[36m(TaskRunner pid=2949575)[0m step:33 - global_seqlen/min:25443 - global_seqlen/max:32194 - global_seqlen/minmax_diff:6751 - global_seqlen/balanced_min:28551 - global_seqlen/balanced_max:28552 - global_seqlen/mean:28551.25 - actor/entropy:0.5477224588394165 - actor/kl_loss:0.05910017043352127 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07805068464949727 - actor/pg_clipfrac:0.0018650310870725662 - actor/ppo_kl:1.515236890554661e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3385650217533112 - perf/mfu/actor:0.08571958899964943 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.69213485717773 - actor/lr:1e-06 - training/global_step:33 - training/epoch:0 - critic/score/mean:1.310937523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.310937523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.019174959510564804 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.019174959510564804 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:303.9375 - response_length/max:1163.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.863342761993408e-05 - timing_s/generate_sequences:28.675601959228516 - timing_s/reshard:0.6780939102172852 - timing_s/gen:38.65445598773658 - timing_s/reward:0.07154267095029354 - timing_s/old_log_prob:1.1069336496293545 - timing_s/ref:1.370906388387084 - timing_s/adv:0.007450191304087639 - timing_s/update_actor:7.106720669195056 - timing_s/step:48.33095775358379 - timing_s/stop_profile:4.328601062297821e-05 - timing_per_token_ms/adv:3.261762315173433e-05 - timing_per_token_ms/gen:0.3974342585619636 - timing_per_token_ms/ref:0.006001954329438659 - timing_per_token_ms/update_actor:0.03111387710343267 - perf/total_num_tokens:228410 - perf/time_per_step:48.33095775358379 - perf/throughput:590.7445522923223
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3312499523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3312499523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.017821192741394043, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.017821192741394043, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 303.59686279296875, 'response_length/max': 2048.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.33125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:34 - global_seqlen/min:25335 - global_seqlen/max:32023 - global_seqlen/minmax_diff:6688 - global_seqlen/balanced_min:28365 - global_seqlen/balanced_max:29030 - global_seqlen/mean:28507.0 - actor/entropy:0.5340558886528015 - actor/kl_loss:0.06910487646237015 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10634365044534207 - actor/pg_clipfrac:0.002612196106929332 - actor/ppo_kl:0.0011356681323377415 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1026694923639297 - perf/mfu/actor:0.08461931491608495 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.69333267211914 - actor/lr:1e-06 - training/global_step:34 - training/epoch:0 - critic/score/mean:1.3312499523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3312499523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.017821192741394043 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.017821192741394043 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:303.59686279296875 - response_length/max:2048.0 - response_length/min:74.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.33125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.134730160236359e-05 - timing_s/generate_sequences:39.116416931152344 - timing_s/reshard:0.7064871788024902 - timing_s/gen:62.965999035164714 - timing_s/reward:0.0716523565351963 - timing_s/old_log_prob:1.2098333314061165 - timing_s/ref:1.3567361701279879 - timing_s/adv:0.007432103157043457 - timing_s/update_actor:7.195165762677789 - timing_s/step:72.81975891068578 - timing_s/stop_profile:4.445388913154602e-05 - timing_per_token_ms/adv:3.258893937034525e-05 - timing_per_token_ms/gen:0.6481250737014 - timing_per_token_ms/ref:0.005949136046093889 - timing_per_token_ms/update_actor:0.03154999545145836 - perf/total_num_tokens:228056 - perf/time_per_step:72.81975891068578 - perf/throughput:391.47341911642616
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3781249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3781249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0196185614913702, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0196185614913702, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 319.52813720703125, 'response_length/max': 988.0, 'response_length/min': 62.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.378125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   7%|▋         | 35/525 [32:27<7:29:11, 55.00s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   7%|▋         | 36/525 [33:11<7:01:20, 51.70s/it]
[36m(TaskRunner pid=2949575)[0m step:35 - global_seqlen/min:25667 - global_seqlen/max:31464 - global_seqlen/minmax_diff:5797 - global_seqlen/balanced_min:29161 - global_seqlen/balanced_max:29162 - global_seqlen/mean:29161.75 - actor/entropy:0.5232863426208496 - actor/kl_loss:0.06622794521972537 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.050768877193331716 - actor/pg_clipfrac:0.0013492320198565722 - actor/ppo_kl:-0.0007304490276510478 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9821948856115341 - perf/mfu/actor:0.08801964853198123 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.68886184692383 - actor/lr:1e-06 - training/global_step:35 - training/epoch:0 - critic/score/mean:1.3781249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3781249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0196185614913702 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0196185614913702 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:319.52813720703125 - response_length/max:988.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.378125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.069723844528198e-05 - timing_s/generate_sequences:29.782726287841797 - timing_s/reshard:0.6768800020217896 - timing_s/gen:33.319227393716574 - timing_s/reward:0.07177584432065487 - timing_s/old_log_prob:1.306684823706746 - timing_s/ref:1.3566094283014536 - timing_s/adv:0.007875273004174232 - timing_s/update_actor:7.075791820883751 - timing_s/step:43.15097998827696 - timing_s/stop_profile:4.283897578716278e-05 - timing_per_token_ms/adv:3.375686046008141e-05 - timing_per_token_ms/gen:0.3258636015385634 - timing_per_token_ms/ref:0.005815020653344936 - timing_per_token_ms/update_actor:0.030329934849947924 - perf/total_num_tokens:233294 - perf/time_per_step:43.15097998827696 - perf/throughput:675.807363075474
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3171875476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3171875476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.025153761729598045, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.025153761729598045, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 296.8656311035156, 'response_length/max': 952.0, 'response_length/min': 54.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3171875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:36 - global_seqlen/min:26608 - global_seqlen/max:29861 - global_seqlen/minmax_diff:3253 - global_seqlen/balanced_min:28259 - global_seqlen/balanced_max:28260 - global_seqlen/mean:28259.625 - actor/entropy:0.4880698025226593 - actor/kl_loss:0.06424521766602993 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.16109443362802267 - actor/pg_clipfrac:0.0016594883723882957 - actor/ppo_kl:0.000822716583206784 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0479106605052948 - perf/mfu/actor:0.08569909572036336 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.24660873413086 - actor/lr:1e-06 - training/global_step:36 - training/epoch:1 - critic/score/mean:1.3171875476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3171875476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.025153761729598045 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.025153761729598045 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:296.8656311035156 - response_length/max:952.0 - response_length/min:54.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3171875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00032191909849643707 - timing_s/generate_sequences:25.447647094726562 - timing_s/reshard:0.7350493669509888 - timing_s/gen:32.10142517648637 - timing_s/reward:0.07040798105299473 - timing_s/old_log_prob:1.1419399995356798 - timing_s/ref:1.3575607370585203 - timing_s/adv:0.007513057440519333 - timing_s/update_actor:7.036508051678538 - timing_s/step:41.74083731509745 - timing_s/stop_profile:4.547834396362305e-05 - timing_per_token_ms/adv:3.3232294486034993e-05 - timing_per_token_ms/gen:0.3379204098706946 - timing_per_token_ms/ref:0.006004860012555547 - timing_per_token_ms/update_actor:0.031124387052546425 - perf/total_num_tokens:226077 - perf/time_per_step:41.74083731509745 - perf/throughput:677.0258293256287
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.421875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.421875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.020133651793003082, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.020133651793003082, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 312.984375, 'response_length/max': 2048.0, 'response_length/min': 71.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   7%|▋         | 37/525 [34:24<7:51:15, 57.94s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   7%|▋         | 38/525 [35:11<7:24:33, 54.77s/it]
[36m(TaskRunner pid=2949575)[0m step:37 - global_seqlen/min:26481 - global_seqlen/max:30606 - global_seqlen/minmax_diff:4125 - global_seqlen/balanced_min:28773 - global_seqlen/balanced_max:29533 - global_seqlen/mean:28869.375 - actor/entropy:0.5243279337882996 - actor/kl_loss:0.05080386176705361 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.19124230220913888 - actor/pg_clipfrac:0.0017795097548514605 - actor/ppo_kl:6.6552445787237955e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1160203963518143 - perf/mfu/actor:0.08723683133460858 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.20279693603516 - actor/lr:1e-06 - training/global_step:37 - training/epoch:1 - critic/score/mean:1.421875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.421875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.020133651793003082 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.020133651793003082 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:312.984375 - response_length/max:2048.0 - response_length/min:71.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.50608742237091e-05 - timing_s/generate_sequences:37.23249816894531 - timing_s/reshard:0.6774947047233582 - timing_s/gen:62.84189283847809 - timing_s/reward:0.0736859068274498 - timing_s/old_log_prob:1.1301524173468351 - timing_s/ref:1.3557029832154512 - timing_s/adv:0.008254844695329666 - timing_s/update_actor:7.066799994558096 - timing_s/step:72.49392625875771 - timing_s/stop_profile:4.612095654010773e-05 - timing_per_token_ms/adv:3.5742221191702566e-05 - timing_per_token_ms/gen:0.627446386485728 - timing_per_token_ms/ref:0.005869987587259212 - timing_per_token_ms/update_actor:0.03059816845081551 - perf/total_num_tokens:230955 - perf/time_per_step:72.49392625875771 - perf/throughput:398.2316380127418
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.34375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.34375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.011742751114070415, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': 0.011742751114070415, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 324.8374938964844, 'response_length/max': 1166.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.34375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:38 - global_seqlen/min:27351 - global_seqlen/max:31304 - global_seqlen/minmax_diff:3953 - global_seqlen/balanced_min:29400 - global_seqlen/balanced_max:29401 - global_seqlen/mean:29400.375 - actor/entropy:0.5106422305107117 - actor/kl_loss:0.06653078980743884 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.024830354563891887 - actor/pg_clipfrac:0.0019730118336156012 - actor/ppo_kl:0.00018133918674720917 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0239424407482147 - perf/mfu/actor:0.08654875025080236 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.21232223510742 - actor/lr:1e-06 - training/global_step:38 - training/epoch:1 - critic/score/mean:1.34375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.34375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.011742751114070415 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.011742751114070415 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:324.8374938964844 - response_length/max:1166.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.34375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.493343532085419e-05 - timing_s/generate_sequences:30.25890350341797 - timing_s/reshard:0.6516625881195068 - timing_s/gen:37.46368210762739 - timing_s/reward:0.07314315997064114 - timing_s/old_log_prob:1.1554943788796663 - timing_s/ref:1.3762448281049728 - timing_s/adv:0.00785772129893303 - timing_s/update_actor:7.260232258588076 - timing_s/step:47.35353595390916 - timing_s/stop_profile:4.5491382479667664e-05 - timing_per_token_ms/adv:3.3408252866387886e-05 - timing_per_token_ms/gen:0.3604079165316061 - timing_per_token_ms/ref:0.005851306437864198 - timing_per_token_ms/update_actor:0.030867940709038897 - perf/total_num_tokens:235203 - perf/time_per_step:47.35353595390916 - perf/throughput:620.8696860275948
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3828125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3828125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.023828573524951935, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.023828573524951935, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 321.5218811035156, 'response_length/max': 1216.0, 'response_length/min': 63.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   7%|▋         | 39/525 [36:00<7:10:46, 53.18s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 00:17:02,644:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 00:17:06,160:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 00:17:06,162:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:17:07,159:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/huggingface
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 00:17:02,984:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:   8%|▊         | 40/525 [37:21<8:17:07, 61.50s/it]
[36m(TaskRunner pid=2949575)[0m step:39 - global_seqlen/min:26595 - global_seqlen/max:33182 - global_seqlen/minmax_diff:6587 - global_seqlen/balanced_min:29189 - global_seqlen/balanced_max:29266 - global_seqlen/mean:29237.125 - actor/entropy:0.48284587264060974 - actor/kl_loss:0.06907062511891127 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.042368652671575545 - actor/pg_clipfrac:0.0014544657024089247 - actor/ppo_kl:0.0012520066811703146 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0318013280630112 - perf/mfu/actor:0.0888707539979276 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.21472549438477 - actor/lr:1e-06 - training/global_step:39 - training/epoch:1 - critic/score/mean:1.3828125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3828125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.023828573524951935 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.023828573524951935 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:321.5218811035156 - response_length/max:1216.0 - response_length/min:63.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.257796823978424e-05 - timing_s/generate_sequences:31.073074340820312 - timing_s/reshard:0.6729151010513306 - timing_s/gen:39.79324381053448 - timing_s/reward:0.07245676591992378 - timing_s/old_log_prob:1.190743438899517 - timing_s/ref:1.3583338912576437 - timing_s/adv:0.00762675516307354 - timing_s/update_actor:7.023636762052774 - timing_s/step:49.45918530970812 - timing_s/stop_profile:4.396401345729828e-05 - timing_per_token_ms/adv:3.2607323578641625e-05 - timing_per_token_ms/gen:0.3867664895519791 - timing_per_token_ms/ref:0.005807401938706541 - timing_per_token_ms/update_actor:0.030028759505477943 - perf/total_num_tokens:233897 - perf/time_per_step:49.45918530970812 - perf/throughput:591.1364050361982
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3250000476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3250000476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04683542251586914, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.04683542251586914, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 314.7562561035156, 'response_length/max': 2048.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.325, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:40 - global_seqlen/min:27038 - global_seqlen/max:30805 - global_seqlen/minmax_diff:3767 - global_seqlen/balanced_min:28806 - global_seqlen/balanced_max:29436 - global_seqlen/mean:28953.375 - actor/entropy:0.477262020111084 - actor/kl_loss:0.08371873740106821 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05651509673334658 - actor/pg_clipfrac:0.0028545146342366934 - actor/ppo_kl:0.0013110695785144345 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1585010439157486 - perf/mfu/actor:0.08633687247118087 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.20762252807617 - actor/lr:1e-06 - training/global_step:40 - training/epoch:1 - critic/score/mean:1.3250000476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3250000476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04683542251586914 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04683542251586914 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:314.7562561035156 - response_length/max:2048.0 - response_length/min:70.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.325 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011511892080307007 - timing_s/generate_sequences:39.22050094604492 - timing_s/reshard:0.6702279448509216 - timing_s/gen:62.725386349484324 - timing_s/reward:0.07237165421247482 - timing_s/old_log_prob:1.2676807437092066 - timing_s/ref:1.3663522396236658 - timing_s/adv:0.010938961058855057 - timing_s/update_actor:7.166339034214616 - timing_s/save_checkpoint:8.029263878241181 - timing_s/step:80.65154672972858 - timing_s/stop_profile:4.938244819641113e-05 - timing_per_token_ms/adv:4.7226623229826645e-05 - timing_per_token_ms/gen:0.6227575539552861 - timing_per_token_ms/ref:0.005898933369700708 - timing_per_token_ms/update_actor:0.03093913504994934 - perf/total_num_tokens:231627 - perf/time_per_step:80.65154672972858 - perf/throughput:358.99342509853733
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.321874976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.321874976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03487847372889519, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.03487847372889519, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 309.51873779296875, 'response_length/max': 2048.0, 'response_length/min': 64.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 410.28125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.321875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   8%|▊         | 41/525 [38:32<8:39:01, 64.34s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:17:07,937:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:17:07,939:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_40/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:   8%|▊         | 42/525 [39:45<8:57:58, 66.83s/it]
[36m(TaskRunner pid=2949575)[0m step:41 - global_seqlen/min:27570 - global_seqlen/max:29676 - global_seqlen/minmax_diff:2106 - global_seqlen/balanced_min:28690 - global_seqlen/balanced_max:29458 - global_seqlen/mean:28792.0 - actor/entropy:0.5202006101608276 - actor/kl_loss:0.08427247838117183 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.027938505308702587 - actor/pg_clipfrac:0.0017069421999622136 - actor/ppo_kl:-0.0005323457404301735 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0564153641462326 - perf/mfu/actor:0.08620671174907668 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.00892639160156 - actor/lr:1e-06 - training/global_step:41 - training/epoch:1 - critic/score/mean:1.321874976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.321874976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03487847372889519 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.03487847372889519 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:309.51873779296875 - response_length/max:2048.0 - response_length/min:64.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.321875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.329322397708893e-05 - timing_s/generate_sequences:40.60099411010742 - timing_s/reshard:0.6854512691497803 - timing_s/gen:61.225819831714034 - timing_s/reward:0.07155609875917435 - timing_s/old_log_prob:1.1464293915778399 - timing_s/ref:1.3642143588513136 - timing_s/adv:0.007533330470323563 - timing_s/update_actor:7.132466631010175 - timing_s/step:70.96127393841743 - timing_s/stop_profile:4.036352038383484e-05 - timing_per_token_ms/adv:3.270583178627554e-05 - timing_per_token_ms/gen:0.618155400841165 - timing_per_token_ms/ref:0.0059227144643100235 - timing_per_token_ms/update_actor:0.030965487943743812 - perf/total_num_tokens:230336 - perf/time_per_step:70.96127393841743 - perf/throughput:405.74243389410765
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4109375476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4109375476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.042673930525779724, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.042673930525779724, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 347.8031311035156, 'response_length/max': 2048.0, 'response_length/min': 73.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:42 - global_seqlen/min:28104 - global_seqlen/max:33911 - global_seqlen/minmax_diff:5807 - global_seqlen/balanced_min:30214 - global_seqlen/balanced_max:30803 - global_seqlen/mean:30288.375 - actor/entropy:0.424019455909729 - actor/kl_loss:0.07420467473566532 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.021358082443475722 - actor/pg_clipfrac:0.0018761841231025756 - actor/ppo_kl:0.00046441483309536127 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8996995836496353 - perf/mfu/actor:0.08752446572015322 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:86.51171875 - perf/cpu_memory_used_gb:96.07754135131836 - actor/lr:1e-06 - training/global_step:42 - training/epoch:1 - critic/score/mean:1.4109375476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4109375476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.042673930525779724 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.042673930525779724 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:347.8031311035156 - response_length/max:2048.0 - response_length/min:73.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.330067455768585e-05 - timing_s/generate_sequences:36.982093811035156 - timing_s/reshard:0.6685364842414856 - timing_s/gen:62.59654139727354 - timing_s/reward:0.0741382222622633 - timing_s/old_log_prob:1.1507106814533472 - timing_s/ref:1.3717930112034082 - timing_s/adv:0.007575221359729767 - timing_s/update_actor:7.401249248534441 - timing_s/step:72.61538651958108 - timing_s/stop_profile:4.5204535126686096e-05 - timing_per_token_ms/adv:3.12629076325891e-05 - timing_per_token_ms/gen:0.5624279306474886 - timing_per_token_ms/ref:0.005661384158127534 - timing_per_token_ms/update_actor:0.030544925439770377 - perf/total_num_tokens:242307 - perf/time_per_step:72.61538651958108 - perf/throughput:417.106848172358
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.368749976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.368749976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04065093398094177, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.04065093398094177, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 326.04376220703125, 'response_length/max': 2048.0, 'response_length/min': 81.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.36875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   8%|▊         | 43/525 [40:55<9:05:24, 67.89s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   8%|▊         | 44/525 [41:43<8:15:52, 61.85s/it]
[36m(TaskRunner pid=2949575)[0m step:43 - global_seqlen/min:27197 - global_seqlen/max:33247 - global_seqlen/minmax_diff:6050 - global_seqlen/balanced_min:29263 - global_seqlen/balanced_max:29986 - global_seqlen/mean:29431.125 - actor/entropy:0.4364135265350342 - actor/kl_loss:0.0885424043983221 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16550678350031375 - actor/pg_clipfrac:0.002019981452031061 - actor/ppo_kl:-1.349601055835592e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.017802357673645 - perf/mfu/actor:0.08862426367901832 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:89.564453125 - perf/cpu_memory_used_gb:96.085205078125 - actor/lr:1e-06 - training/global_step:43 - training/epoch:1 - critic/score/mean:1.368749976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.368749976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04065093398094177 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04065093398094177 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:326.04376220703125 - response_length/max:2048.0 - response_length/min:81.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.36875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.458962500095367e-05 - timing_s/generate_sequences:43.90058898925781 - timing_s/reshard:0.7731087803840637 - timing_s/gen:60.64616140164435 - timing_s/reward:0.07242880947887897 - timing_s/old_log_prob:1.1609383914619684 - timing_s/ref:1.3630939573049545 - timing_s/adv:0.0076364073902368546 - timing_s/update_actor:7.099868971854448 - timing_s/step:70.36356846429408 - timing_s/stop_profile:4.474446177482605e-05 - timing_per_token_ms/adv:3.2433382134716454e-05 - timing_per_token_ms/gen:0.5812693982943656 - timing_per_token_ms/ref:0.005789338486487327 - timing_per_token_ms/update_actor:0.03015459386896716 - perf/total_num_tokens:235449 - perf/time_per_step:70.36356846429408 - perf/throughput:418.27220594894635
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.350000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.350000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.00036869614268653095, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.00036869614268653095, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 315.37811279296875, 'response_length/max': 1173.0, 'response_length/min': 58.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.35, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:44 - global_seqlen/min:26980 - global_seqlen/max:33634 - global_seqlen/minmax_diff:6654 - global_seqlen/balanced_min:29004 - global_seqlen/balanced_max:29005 - global_seqlen/mean:29004.5 - actor/entropy:0.44654518365859985 - actor/kl_loss:0.0848635139875114 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.013935796137957368 - actor/pg_clipfrac:0.002576457289978862 - actor/ppo_kl:0.000827243092135177 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9771206080913544 - perf/mfu/actor:0.08742499310987872 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:89.564453125 - perf/cpu_memory_used_gb:96.1139030456543 - actor/lr:1e-06 - training/global_step:44 - training/epoch:1 - critic/score/mean:1.350000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.350000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.00036869614268653095 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.00036869614268653095 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:315.37811279296875 - response_length/max:1173.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.35 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.495710790157318e-05 - timing_s/generate_sequences:31.693866729736328 - timing_s/reshard:0.7703111171722412 - timing_s/gen:37.809609703719616 - timing_s/reward:0.07226715050637722 - timing_s/old_log_prob:1.102925518527627 - timing_s/ref:1.3622918762266636 - timing_s/adv:0.0074755046516656876 - timing_s/update_actor:7.084598045796156 - timing_s/step:47.45282727107406 - timing_s/stop_profile:4.488416016101837e-05 - timing_per_token_ms/adv:3.221700361868713e-05 - timing_per_token_ms/gen:0.37464561096025223 - timing_per_token_ms/ref:0.005871036719417089 - timing_per_token_ms/update_actor:0.03053232276800219 - perf/total_num_tokens:232036 - perf/time_per_step:47.45282727107406 - perf/throughput:611.2280693900898
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3390624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3390624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06667965650558472, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.06667965650558472, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 350.6468811035156, 'response_length/max': 2048.0, 'response_length/min': 68.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   9%|▊         | 45/525 [42:55<8:37:55, 64.74s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   9%|▉         | 46/525 [43:42<7:55:53, 59.61s/it]
[36m(TaskRunner pid=2949575)[0m step:45 - global_seqlen/min:29492 - global_seqlen/max:31468 - global_seqlen/minmax_diff:1976 - global_seqlen/balanced_min:30316 - global_seqlen/balanced_max:31071 - global_seqlen/mean:30410.875 - actor/entropy:0.46821704506874084 - actor/kl_loss:0.0873316029086709 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.012256179749965668 - actor/pg_clipfrac:0.0013005895598325878 - actor/ppo_kl:9.67840307566803e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9245552271604538 - perf/mfu/actor:0.09088631529674808 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:89.564453125 - perf/cpu_memory_used_gb:96.27198028564453 - actor/lr:1e-06 - training/global_step:45 - training/epoch:1 - critic/score/mean:1.3390624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3390624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06667965650558472 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.06667965650558472 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:350.6468811035156 - response_length/max:2048.0 - response_length/min:68.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.450448513031006e-05 - timing_s/generate_sequences:38.8175048828125 - timing_s/reshard:0.7042492628097534 - timing_s/gen:61.29511128179729 - timing_s/reward:0.07686234638094902 - timing_s/old_log_prob:1.1674581300467253 - timing_s/ref:1.3802774716168642 - timing_s/adv:0.008173292502760887 - timing_s/update_actor:7.157311495393515 - timing_s/step:71.10183439217508 - timing_s/stop_profile:4.518777132034302e-05 - timing_per_token_ms/adv:3.359527020663203e-05 - timing_per_token_ms/gen:0.5462681586870453 - timing_per_token_ms/ref:0.005673453458741586 - timing_per_token_ms/update_actor:0.02941921062528419 - perf/total_num_tokens:243287 - perf/time_per_step:71.10183439217508 - perf/throughput:427.70872594177104
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3875000476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3875000476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0069993953220546246, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.0069993953220546246, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 351.97186279296875, 'response_length/max': 1144.0, 'response_length/min': 67.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:46 - global_seqlen/min:27285 - global_seqlen/max:33988 - global_seqlen/minmax_diff:6703 - global_seqlen/balanced_min:30468 - global_seqlen/balanced_max:30469 - global_seqlen/mean:30468.25 - actor/entropy:0.4246808588504791 - actor/kl_loss:0.06576702110469342 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0546963662840426 - actor/pg_clipfrac:0.002045043127145618 - actor/ppo_kl:0.0004315117075748276 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9387407749891281 - perf/mfu/actor:0.09152798803068518 - perf/max_memory_allocated_gb:63.8469762802124 - perf/max_memory_reserved_gb:89.564453125 - perf/cpu_memory_used_gb:96.30463027954102 - actor/lr:1e-06 - training/global_step:46 - training/epoch:1 - critic/score/mean:1.3875000476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3875000476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0069993953220546246 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0069993953220546246 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:351.97186279296875 - response_length/max:1144.0 - response_length/min:67.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.641796350479126e-05 - timing_s/generate_sequences:32.48050308227539 - timing_s/reshard:0.6683781743049622 - timing_s/gen:37.757247518748045 - timing_s/reward:0.07612386532127857 - timing_s/old_log_prob:1.2859057076275349 - timing_s/ref:1.360066557303071 - timing_s/adv:0.008217275142669678 - timing_s/update_actor:7.120903862640262 - timing_s/step:47.62599510885775 - timing_s/stop_profile:4.410743713378906e-05 - timing_per_token_ms/adv:3.371245125117819e-05 - timing_per_token_ms/gen:0.3352296216738557 - timing_per_token_ms/ref:0.0055798518018883225 - timing_per_token_ms/update_actor:0.02921444398119461 - perf/total_num_tokens:243746 - perf/time_per_step:47.62599510885775 - perf/throughput:639.7399136828396
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3718750476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3718750476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.044953007251024246, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.044953007251024246, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 382.87811279296875, 'response_length/max': 2048.0, 'response_length/min': 55.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.371875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   9%|▉         | 47/525 [44:57<8:30:10, 64.04s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:   9%|▉         | 48/525 [46:10<8:50:42, 66.76s/it]
[36m(TaskRunner pid=2949575)[0m step:47 - global_seqlen/min:28638 - global_seqlen/max:38839 - global_seqlen/minmax_diff:10201 - global_seqlen/balanced_min:31626 - global_seqlen/balanced_max:31904 - global_seqlen/mean:31695.75 - actor/entropy:0.40050700306892395 - actor/kl_loss:0.0771350844297558 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04167866446077824 - actor/pg_clipfrac:0.0017528602707898243 - actor/ppo_kl:0.0006241017628781265 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0047578811645508 - perf/mfu/actor:0.09339860611340403 - perf/max_memory_allocated_gb:64.33961629867554 - perf/max_memory_reserved_gb:90.7421875 - perf/cpu_memory_used_gb:96.26555633544922 - actor/lr:1e-06 - training/global_step:47 - training/epoch:1 - critic/score/mean:1.3718750476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3718750476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.044953007251024246 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.044953007251024246 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:382.87811279296875 - response_length/max:2048.0 - response_length/min:55.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.371875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.697116911411285e-05 - timing_s/generate_sequences:46.7565803527832 - timing_s/reshard:0.661517858505249 - timing_s/gen:64.32065694220364 - timing_s/reward:0.07788247987627983 - timing_s/old_log_prob:1.2796512078493834 - timing_s/ref:1.373324265703559 - timing_s/adv:0.008248183876276016 - timing_s/update_actor:7.279048427939415 - timing_s/step:74.35633996501565 - timing_s/stop_profile:4.620105028152466e-05 - timing_per_token_ms/adv:3.252874547958329e-05 - timing_per_token_ms/gen:0.5249765912962157 - timing_per_token_ms/ref:0.00541604263072951 - timing_per_token_ms/update_actor:0.028706721042803116 - perf/total_num_tokens:253566 - perf/time_per_step:74.35633996501565 - perf/throughput:426.26829151236757
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3671875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3671875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06600596755743027, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.06600596755743027, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 390.4468688964844, 'response_length/max': 2048.0, 'response_length/min': 41.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:48 - global_seqlen/min:27585 - global_seqlen/max:35617 - global_seqlen/minmax_diff:8032 - global_seqlen/balanced_min:31889 - global_seqlen/balanced_max:32307 - global_seqlen/mean:31994.125 - actor/entropy:0.43753302097320557 - actor/kl_loss:0.06714218272827566 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10945545993745327 - actor/pg_clipfrac:0.001155541790649295 - actor/ppo_kl:-0.0003050638963372876 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9264701008796692 - perf/mfu/actor:0.09324730676641226 - perf/max_memory_allocated_gb:64.33961629867554 - perf/max_memory_reserved_gb:90.7421875 - perf/cpu_memory_used_gb:96.20507049560547 - actor/lr:1e-06 - training/global_step:48 - training/epoch:1 - critic/score/mean:1.3671875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3671875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06600596755743027 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.06600596755743027 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:390.4468688964844 - response_length/max:2048.0 - response_length/min:41.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011659972369670868 - timing_s/generate_sequences:50.14710998535156 - timing_s/reshard:0.677068293094635 - timing_s/gen:62.78181851655245 - timing_s/reward:0.07996955141425133 - timing_s/old_log_prob:1.2182577606290579 - timing_s/ref:1.380703181028366 - timing_s/adv:0.0082324780523777 - timing_s/update_actor:7.364304896444082 - timing_s/step:72.85075091198087 - timing_s/stop_profile:4.40254807472229e-05 - timing_per_token_ms/adv:3.216402250560728e-05 - timing_per_token_ms/gen:0.5024836806908146 - timing_per_token_ms/ref:0.005394362172072084 - timing_per_token_ms/update_actor:0.028772098379171496 - perf/total_num_tokens:255953 - perf/time_per_step:72.85075091198087 - perf/throughput:439.1735788510358
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.399999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.399999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06752277910709381, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.06752277910709381, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 365.046875, 'response_length/max': 2048.0, 'response_length/min': 64.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:   9%|▉         | 49/525 [47:22<9:03:33, 68.51s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 00:29:30,977:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 00:29:34,635:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 00:29:34,637:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:29:35,872:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/huggingface
[36m(TaskRunner pid=2949575)[0m step:49 - global_seqlen/min:28159 - global_seqlen/max:35217 - global_seqlen/minmax_diff:7058 - global_seqlen/balanced_min:30801 - global_seqlen/balanced_max:31560 - global_seqlen/mean:30991.25 - actor/entropy:0.4176633358001709 - actor/kl_loss:0.0816560042090714 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09134575743228197 - actor/pg_clipfrac:0.0017371565423673018 - actor/ppo_kl:-0.0008269403226677241 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9945675283670425 - perf/mfu/actor:0.08795845860421916 - perf/max_memory_allocated_gb:64.47816753387451 - perf/max_memory_reserved_gb:90.7421875 - perf/cpu_memory_used_gb:96.14307022094727 - actor/lr:1e-06 - training/global_step:49 - training/epoch:1 - critic/score/mean:1.399999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.399999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06752277910709381 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.06752277910709381 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:365.046875 - response_length/max:2048.0 - response_length/min:64.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.48738306760788e-05 - timing_s/generate_sequences:44.153926849365234 - timing_s/reshard:0.6688914895057678 - timing_s/gen:62.40553083829582 - timing_s/reward:0.0792084988206625 - timing_s/old_log_prob:1.1836304310709238 - timing_s/ref:1.3685961943119764 - timing_s/adv:0.00827096588909626 - timing_s/update_actor:7.543451897799969 - timing_s/step:72.60603333823383 - timing_s/stop_profile:4.546903073787689e-05 - timing_per_token_ms/adv:3.336008506068753e-05 - timing_per_token_ms/gen:0.5342253207062091 - timing_per_token_ms/ref:0.00552009113181937 - timing_per_token_ms/update_actor:0.030425732657604843 - perf/total_num_tokens:247930 - perf/time_per_step:72.60603333823383 - perf/throughput:426.84124961940626
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 50}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the semi-major axis. The foci of the hyperbola are at \((\pm c, 0)\) where \(c = \sqrt{2}a\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The equation of the parabola is \(y^2 = 16x\). The focus of this parabola is at \((4, 0)\) and the directrix is the line \(x = -4\). The hyperbola intersects the parabola at points \(A\) and \(B\) such that \(|AB| = 4\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Since the hyperbola and the parabola intersect at points \(A\) and \(B\), and the foci of the hyperbola are at \((\pm c, 0)\), the points \(A\) and \(B\) must lie on the line \(x = 4\) (the directrix of the parabola). Therefore, the coordinates of \(A\) and \(B\) are \((4, y_1)\) and \((4, y_2)\) respectively.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Substituting \(x = 4\) into the equation of the parabola, we get:
[36m(TaskRunner pid=2949575)[0m \[y^2 = 16 \cdot 4 = 64 \implies y = \pm 8.\]
[36m(TaskRunner pid=2949575)[0m So, the points of intersection are \(A(4, 8)\) and \(B(4, -8)\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between these points is:
[36m(TaskRunner pid=2949575)[0m \[|AB| = |8 - (-8)| = 16.\]
[36m(TaskRunner pid=2949575)[0m However, we are given that \(|AB| = 4\sqrt{3}\). This discrepancy suggests that the points of intersection are not at \(x = 4\) but at some other point on the hyperbola. Let's assume the points of intersection are at \((x_1, y_1)\) and \((x_2, y_2)\) where \(x_1 = x_2 = 4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection is:
[36m(TaskRunner pid=2949575)[0m \[|AB| = \sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2} = \sqrt{(4 - 4)^2 + (y_1 - y_2)^2} = |y_1 - y_2| = 4\sqrt{3}.\]
[36m(TaskRunner pid=2949575)[0m This implies that the difference in the \(y\)-coordinates is \(4\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Since the hyperbola is symmetric and the foci are at \((\pm c, 0)\), the points of intersection must be symmetric about the \(x\)-axis. Therefore, the \(y\)-coordinates of the points of intersection are \(\pm 2\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Substituting \(y = \pm 2\sqrt{3}\) into the equation of the hyperbola, we get:
[36m(TaskRunner pid=2949575)[0m \[\frac{x^2}{a^2} - \frac{(2\sqrt{3})^2}{a^2} = 1 \implies \frac{x^2}{a^2} - \frac{12}{a^2} = 1 \implies \frac{x^2 - 12}{a^2} = 1 \implies x^2 - 12 = a^2 \implies x^2 = a^2 + 12.\]
[36m(TaskRunner pid=2949575)[0m Since the points of intersection are at \(x = 4\), we have:
[36m(TaskRunner pid=2949575)[0m \[4^2 = a^2 + 12 \implies 16 = a^2 + 12 \implies a^2 = 4 \implies a = 2.\]
[36m(TaskRunner pid=2949575)[0m The length of the real axis of the hyperbola is \(2a = 4\).
[36m(TaskRunner pid=2949575)[0m </think>
[36m(TaskRunner pid=2949575)[0m <answer>The answer is \boxed{C}.</answer>
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] 2.0
[36m(TaskRunner pid=2949575)[0m [structure] 0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.5
[36m(TaskRunner pid=2949575)[0m [correct] 1.0
[36m(TaskRunner pid=2949575)[0m [acc] True
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3156249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3156249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.018303189426660538, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.018303189426660538, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 386.2593688964844, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.315625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:50 - global_seqlen/min:28271 - global_seqlen/max:33656 - global_seqlen/minmax_diff:5385 - global_seqlen/balanced_min:31771 - global_seqlen/balanced_max:32387 - global_seqlen/mean:31848.5 - actor/entropy:0.40679696202278137 - actor/kl_loss:0.07515303771942854 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1885000243782997 - actor/pg_clipfrac:0.0010542272750171833 - actor/ppo_kl:0.0021198578120674937 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7584868967533112 - perf/mfu/actor:0.09276820494523721 - perf/max_memory_allocated_gb:64.47816753387451 - perf/max_memory_reserved_gb:90.7421875 - perf/cpu_memory_used_gb:96.18730926513672 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:1.35 - val-aux/grpo_convert/reward/std@50:0.5664722360224532 - val-aux/grpo_convert/reward/best@2/mean:1.5782500000000002 - val-aux/grpo_convert/reward/best@2/std:0.415392563203497 - val-aux/grpo_convert/reward/worst@2/mean:1.1139999999999999 - val-aux/grpo_convert/reward/worst@2/std:0.6009450743741787 - val-aux/grpo_convert/reward/best@4/mean:1.75 - val-aux/grpo_convert/reward/best@4/std:0.31979991993593593 - val-aux/grpo_convert/reward/worst@4/mean:0.8505 - val-aux/grpo_convert/reward/worst@4/std:0.6340834439168922 - val-aux/grpo_convert/reward/best@8/mean:1.8940000000000001 - val-aux/grpo_convert/reward/best@8/std:0.20436242316042352 - val-aux/grpo_convert/reward/worst@8/mean:0.60275 - val-aux/grpo_convert/reward/worst@8/std:0.6908605444649655 - val-aux/grpo_convert/reward/best@16/mean:1.976 - val-aux/grpo_convert/reward/best@16/std:0.1068831137270991 - val-aux/grpo_convert/reward/worst@16/mean:0.2905 - val-aux/grpo_convert/reward/worst@16/std:0.7488996753096006 - val-aux/grpo_convert/reward/best@32/mean:1.9985 - val-aux/grpo_convert/reward/best@32/std:0.027345017827750638 - val-aux/grpo_convert/reward/worst@32/mean:-0.08074999999999999 - val-aux/grpo_convert/reward/worst@32/std:0.6730883101161054 - val-aux/grpo_convert/reward/best@50/mean:2.0 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.30874999999999997 - val-aux/grpo_convert/reward/worst@50/std:0.4999328068447847 - val-aux/grpo_convert/score/mean@50:1.35 - val-aux/grpo_convert/score/std@50:0.5664722360224532 - val-aux/grpo_convert/score/best@2/mean:1.5782500000000002 - val-aux/grpo_convert/score/best@2/std:0.415392563203497 - val-aux/grpo_convert/score/worst@2/mean:1.1139999999999999 - val-aux/grpo_convert/score/worst@2/std:0.6009450743741787 - val-aux/grpo_convert/score/best@4/mean:1.75 - val-aux/grpo_convert/score/best@4/std:0.31979991993593593 - val-aux/grpo_convert/score/worst@4/mean:0.8505 - val-aux/grpo_convert/score/worst@4/std:0.6340834439168922 - val-aux/grpo_convert/score/best@8/mean:1.8940000000000001 - val-aux/grpo_convert/score/best@8/std:0.20436242316042352 - val-aux/grpo_convert/score/worst@8/mean:0.60275 - val-aux/grpo_convert/score/worst@8/std:0.6908605444649655 - val-aux/grpo_convert/score/best@16/mean:1.976 - val-aux/grpo_convert/score/best@16/std:0.1068831137270991 - val-aux/grpo_convert/score/worst@16/mean:0.2905 - val-aux/grpo_convert/score/worst@16/std:0.7488996753096006 - val-aux/grpo_convert/score/best@32/mean:1.9985 - val-aux/grpo_convert/score/best@32/std:0.027345017827750638 - val-aux/grpo_convert/score/worst@32/mean:-0.08074999999999999 - val-aux/grpo_convert/score/worst@32/std:0.6730883101161054 - val-aux/grpo_convert/score/best@50/mean:2.0 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.30874999999999997 - val-aux/grpo_convert/score/worst@50/std:0.4999328068447847 - val-aux/grpo_convert/structure/mean@50:0.46 - val-aux/grpo_convert/structure/std@50:0.19595917942265428 - val-aux/grpo_convert/structure/best@2/mean:0.4975 - val-aux/grpo_convert/structure/best@2/std:0.04968332573143931 - val-aux/grpo_convert/structure/worst@2/mean:0.415 - val-aux/grpo_convert/structure/worst@2/std:0.27885863969619695 - val-aux/grpo_convert/structure/best@4/mean:0.5 - val-aux/grpo_convert/structure/best@4/std:0.0 - val-aux/grpo_convert/structure/worst@4/mean:0.34299999999999997 - val-aux/grpo_convert/structure/worst@4/std:0.3637903848792938 - val-aux/grpo_convert/structure/best@8/mean:0.5 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:0.2245 - val-aux/grpo_convert/structure/worst@8/std:0.446748706273016 - val-aux/grpo_convert/structure/best@16/mean:0.5 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:0.027000000000000003 - val-aux/grpo_convert/structure/worst@16/std:0.4992664502064003 - val-aux/grpo_convert/structure/best@32/mean:0.5 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.2205 - val-aux/grpo_convert/structure/worst@32/std:0.4487255400774036 - val-aux/grpo_convert/structure/best@50/mean:0.5 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.3725 - val-aux/grpo_convert/structure/worst@50/std:0.33328853789652313 - val-aux/grpo_convert/boxed/mean@50:0.48 - val-aux/grpo_convert/boxed/std@50:0.09797958971132714 - val-aux/grpo_convert/boxed/best@2/mean:0.49875 - val-aux/grpo_convert/boxed/best@2/std:0.024841662865719656 - val-aux/grpo_convert/boxed/worst@2/mean:0.4575 - val-aux/grpo_convert/boxed/worst@2/std:0.13942931984809848 - val-aux/grpo_convert/boxed/best@4/mean:0.5 - val-aux/grpo_convert/boxed/best@4/std:0.0 - val-aux/grpo_convert/boxed/worst@4/mean:0.4215 - val-aux/grpo_convert/boxed/worst@4/std:0.1818951924396469 - val-aux/grpo_convert/boxed/best@8/mean:0.5 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.36224999999999996 - val-aux/grpo_convert/boxed/worst@8/std:0.223374353136508 - val-aux/grpo_convert/boxed/best@16/mean:0.5 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.2635 - val-aux/grpo_convert/boxed/worst@16/std:0.24963322510320016 - val-aux/grpo_convert/boxed/best@32/mean:0.5 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.13974999999999999 - val-aux/grpo_convert/boxed/worst@32/std:0.2243627700387018 - val-aux/grpo_convert/boxed/best@50/mean:0.5 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.06375 - val-aux/grpo_convert/boxed/worst@50/std:0.16664426894826156 - val-aux/grpo_convert/correct/mean@50:0.41000000000000003 - val-aux/grpo_convert/correct/std@50:0.43209372712298544 - val-aux/grpo_convert/correct/best@2/mean:0.582 - val-aux/grpo_convert/correct/best@2/std:0.4034848199124155 - val-aux/grpo_convert/correct/worst@2/mean:0.2415 - val-aux/grpo_convert/correct/worst@2/std:0.3440810139320052 - val-aux/grpo_convert/correct/best@4/mean:0.75 - val-aux/grpo_convert/correct/best@4/std:0.31979991993593593 - val-aux/grpo_convert/correct/worst@4/mean:0.08600000000000001 - val-aux/grpo_convert/correct/worst@4/std:0.20405796264763637 - val-aux/grpo_convert/correct/best@8/mean:0.894 - val-aux/grpo_convert/correct/best@8/std:0.20436242316042352 - val-aux/grpo_convert/correct/worst@8/mean:0.016 - val-aux/grpo_convert/correct/worst@8/std:0.08800000000000001 - val-aux/grpo_convert/correct/best@16/mean:0.976 - val-aux/grpo_convert/correct/best@16/std:0.1068831137270991 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.9984999999999999 - val-aux/grpo_convert/correct/best@32/std:0.027345017827750635 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:1.0 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.41000000000000003 - val-aux/grpo_convert/acc/std@50:0.43209372712298544 - val-aux/grpo_convert/acc/best@2/mean:0.582 - val-aux/grpo_convert/acc/best@2/std:0.4034848199124155 - val-aux/grpo_convert/acc/worst@2/mean:0.2415 - val-aux/grpo_convert/acc/worst@2/std:0.3440810139320052 - val-aux/grpo_convert/acc/best@4/mean:0.75 - val-aux/grpo_convert/acc/best@4/std:0.31979991993593593 - val-aux/grpo_convert/acc/worst@4/mean:0.08600000000000001 - val-aux/grpo_convert/acc/worst@4/std:0.20405796264763637 - val-aux/grpo_convert/acc/best@8/mean:0.894 - val-aux/grpo_convert/acc/best@8/std:0.20436242316042352 - val-aux/grpo_convert/acc/worst@8/mean:0.016 - val-aux/grpo_convert/acc/worst@8/std:0.08800000000000001 - val-aux/grpo_convert/acc/best@16/mean:0.976 - val-aux/grpo_convert/acc/best@16/std:0.1068831137270991 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.9984999999999999 - val-aux/grpo_convert/acc/best@32/std:0.027345017827750635 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:1.0 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:50 - training/epoch:1 - critic/score/mean:1.3156249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3156249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.018303189426660538 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.018303189426660538 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:386.2593688964844 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.315625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.951181709766388e-05 - timing_s/generate_sequences:40.276615142822266 - timing_s/reshard:0.6844120025634766 - timing_s/gen:62.0196529943496 - timing_s/reward:0.07837484404444695 - timing_s/old_log_prob:1.1886042021214962 - timing_s/ref:1.372029971331358 - timing_s/adv:0.00817030481994152 - timing_s/update_actor:7.356586590409279 - timing_s/testing:67.16823922842741 - timing_s/save_checkpoint:8.05155536159873 - timing_s/step:147.26074885204434 - timing_s/stop_profile:4.998408257961273e-05 - timing_per_token_ms/adv:3.206707074093568e-05 - timing_per_token_ms/gen:0.5017649490251013 - timing_per_token_ms/ref:0.0053849866215495154 - timing_per_token_ms/update_actor:0.028873363700053688 - perf/total_num_tokens:254788 - perf/time_per_step:147.26074885204434 - perf/throughput:216.27283745513742[36m(TaskRunner pid=2949575)[0m Training Progress:  10%|▉         | 50/525 [49:50<12:09:28, 92.14s/it]
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 00:29:31,234:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  10%|▉         | 51/525 [50:45<10:40:21, 81.06s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:29:36,161:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:29:36,163:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_50/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  10%|▉         | 52/525 [51:57<10:17:49, 78.37s/it]

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.274999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.274999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.016996847465634346, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.016996847465634346, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 385.1187438964844, 'response_length/max': 1365.0, 'response_length/min': 72.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.275, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:51 - global_seqlen/min:30567 - global_seqlen/max:33321 - global_seqlen/minmax_diff:2754 - global_seqlen/balanced_min:31763 - global_seqlen/balanced_max:31764 - global_seqlen/mean:31763.5 - actor/entropy:0.44815418124198914 - actor/kl_loss:0.07140475623309613 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07210762547329068 - actor/pg_clipfrac:0.0023147089115809647 - actor/ppo_kl:-0.0003689157725602854 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9541884362697601 - perf/mfu/actor:0.09326160541006369 - perf/max_memory_allocated_gb:64.47816753387451 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.0508918762207 - actor/lr:1e-06 - training/global_step:51 - training/epoch:1 - critic/score/mean:1.274999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.274999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.016996847465634346 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.016996847465634346 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:385.1187438964844 - response_length/max:1365.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.275 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.467398583889008e-05 - timing_s/generate_sequences:37.84809112548828 - timing_s/reshard:0.623010516166687 - timing_s/gen:45.19711415283382 - timing_s/reward:0.07928054220974445 - timing_s/old_log_prob:1.184527087956667 - timing_s/ref:1.371293030679226 - timing_s/adv:0.00795060582458973 - timing_s/update_actor:7.298333281651139 - timing_s/step:55.16358766891062 - timing_s/stop_profile:4.644319415092468e-05 - timing_per_token_ms/adv:3.128829405052076e-05 - timing_per_token_ms/gen:0.366746572914473 - timing_per_token_ms/ref:0.005396496885887992 - timing_per_token_ms/update_actor:0.0287213833553101 - perf/total_num_tokens:254108 - perf/time_per_step:55.16358766891062 - perf/throughput:575.8055511299066
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.392187476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.392187476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.051094964146614075, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.051094964146614075, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 329.7749938964844, 'response_length/max': 2048.0, 'response_length/min': 62.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 410.28125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:52 - global_seqlen/min:27859 - global_seqlen/max:32066 - global_seqlen/minmax_diff:4207 - global_seqlen/balanced_min:29357 - global_seqlen/balanced_max:30102 - global_seqlen/mean:29602.25 - actor/entropy:0.41247913241386414 - actor/kl_loss:0.08322714921087027 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09485398903489113 - actor/pg_clipfrac:0.001514945362578146 - actor/ppo_kl:0.0023248017786045238 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9496689289808273 - perf/mfu/actor:0.08814997465672016 - perf/max_memory_allocated_gb:64.47816753387451 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.17716979980469 - actor/lr:1e-06 - training/global_step:52 - training/epoch:1 - critic/score/mean:1.392187476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.392187476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.051094964146614075 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.051094964146614075 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:329.7749938964844 - response_length/max:2048.0 - response_length/min:62.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010482221841812134 - timing_s/generate_sequences:50.358001708984375 - timing_s/reshard:0.6948904991149902 - timing_s/gen:61.93845295533538 - timing_s/reward:0.07492432743310928 - timing_s/old_log_prob:1.164541246369481 - timing_s/ref:1.3715142123401165 - timing_s/adv:0.008089644834399223 - timing_s/update_actor:7.185157751664519 - timing_s/step:71.75824810937047 - timing_s/stop_profile:4.380941390991211e-05 - timing_per_token_ms/adv:3.415975489362812e-05 - timing_per_token_ms/gen:0.5869385656445245 - timing_per_token_ms/ref:0.0057914272240290705 - timing_per_token_ms/update_actor:0.030340420709846883 - perf/total_num_tokens:236818 - perf/time_per_step:71.75824810937047 - perf/throughput:412.52749028769034
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  10%|█         | 53/525 [52:48<9:12:00, 70.17s/it] 
[36m(TaskRunner pid=2949575)[0m Training Progress:  10%|█         | 54/525 [53:59<9:12:04, 70.33s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4265625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4265625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.029145898297429085, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.029145898297429085, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 384.95623779296875, 'response_length/max': 1255.0, 'response_length/min': 102.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:53 - global_seqlen/min:29585 - global_seqlen/max:35800 - global_seqlen/minmax_diff:6215 - global_seqlen/balanced_min:31778 - global_seqlen/balanced_max:31779 - global_seqlen/mean:31778.875 - actor/entropy:0.3814975619316101 - actor/kl_loss:0.06506255753338337 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013801955431699754 - actor/pg_clipfrac:0.002112554546329193 - actor/ppo_kl:-0.0018887040641857311 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0372245460748672 - perf/mfu/actor:0.09508398207737975 - perf/max_memory_allocated_gb:64.47816753387451 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.24269104003906 - actor/lr:1e-06 - training/global_step:53 - training/epoch:1 - critic/score/mean:1.4265625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4265625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.029145898297429085 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.029145898297429085 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:384.95623779296875 - response_length/max:1255.0 - response_length/min:102.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010140612721443176 - timing_s/generate_sequences:35.33955001831055 - timing_s/reshard:0.6713689565658569 - timing_s/gen:40.86272458918393 - timing_s/reward:0.07805391773581505 - timing_s/old_log_prob:1.137669650837779 - timing_s/ref:1.368316113948822 - timing_s/adv:0.007939998060464859 - timing_s/update_actor:7.158134216442704 - timing_s/step:50.628243658691645 - timing_s/stop_profile:4.577822983264923e-05 - timing_per_token_ms/adv:3.1231431495234095e-05 - timing_per_token_ms/gen:0.3317156542885062 - timing_per_token_ms/ref:0.005382176500697484 - timing_per_token_ms/update_actor:0.02815602431034258 - perf/total_num_tokens:254231 - perf/time_per_step:50.628243658691645 - perf/throughput:627.6906466326594
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3515625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3515625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026265857741236687, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.026265857741236687, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 357.66876220703125, 'response_length/max': 2048.0, 'response_length/min': 67.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 410.28125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:54 - global_seqlen/min:27304 - global_seqlen/max:34401 - global_seqlen/minmax_diff:7097 - global_seqlen/balanced_min:30611 - global_seqlen/balanced_max:31466 - global_seqlen/mean:30718.0 - actor/entropy:0.3781254291534424 - actor/kl_loss:0.07043124753981829 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.037508706271182746 - actor/pg_clipfrac:0.001595470157917589 - actor/ppo_kl:0.001546088453324046 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8964101821184158 - perf/mfu/actor:0.09257479473825489 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.20394515991211 - actor/lr:1e-06 - training/global_step:54 - training/epoch:1 - critic/score/mean:1.3515625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3515625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026265857741236687 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.026265857741236687 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:357.66876220703125 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.730776607990265e-05 - timing_s/generate_sequences:33.7545166015625 - timing_s/reshard:0.6684197187423706 - timing_s/gen:60.95541310682893 - timing_s/reward:0.07611877843737602 - timing_s/old_log_prob:1.1563050337135792 - timing_s/ref:1.3586589749902487 - timing_s/adv:0.010890021920204163 - timing_s/update_actor:7.1107989847660065 - timing_s/step:70.68290374986827 - timing_s/stop_profile:4.5359134674072266e-05 - timing_per_token_ms/adv:4.4314497689482396e-05 - timing_per_token_ms/gen:0.5325756470444801 - timing_per_token_ms/ref:0.005528757467080574 - timing_per_token_ms/update_actor:0.028935798980915126 - perf/total_num_tokens:245744 - perf/time_per_step:70.68290374986827 - perf/throughput:434.58882375156026
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3796875476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3796875476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0005537642282433808, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': 0.0005537642282433808, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 380.4437561035156, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  10%|█         | 55/525 [55:14<9:21:45, 71.71s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  11%|█         | 56/525 [56:25<9:20:40, 71.73s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:55 - global_seqlen/min:27078 - global_seqlen/max:39416 - global_seqlen/minmax_diff:12338 - global_seqlen/balanced_min:31608 - global_seqlen/balanced_max:31669 - global_seqlen/mean:31615.875 - actor/entropy:0.38474124670028687 - actor/kl_loss:0.0750792920589447 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06774346232414245 - actor/pg_clipfrac:0.001746389624895528 - actor/ppo_kl:-0.0009888747732475166 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.0648238360881805 - perf/mfu/actor:0.09136465116384725 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.24383926391602 - actor/lr:1e-06 - training/global_step:55 - training/epoch:1 - critic/score/mean:1.3796875476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3796875476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0005537642282433808 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.0005537642282433808 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:380.4437561035156 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.165091276168823e-05 - timing_s/generate_sequences:41.14695358276367 - timing_s/reshard:0.6830136179924011 - timing_s/gen:64.85277445800602 - timing_s/reward:0.07852737046778202 - timing_s/old_log_prob:1.1802763026207685 - timing_s/ref:1.373819274827838 - timing_s/adv:0.008028781041502953 - timing_s/update_actor:7.422789486125112 - timing_s/step:74.93243208527565 - timing_s/stop_profile:4.6193599700927734e-05 - timing_per_token_ms/adv:3.1743471600513006e-05 - timing_per_token_ms/gen:0.532706662105157 - timing_per_token_ms/ref:0.005431682955271039 - timing_per_token_ms/update_actor:0.02934755675007062 - perf/total_num_tokens:252927 - perf/time_per_step:74.93243208527565 - perf/throughput:421.9251146689068
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3359375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3359375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.002543088747188449, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.002543088747188449, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 356.99688720703125, 'response_length/max': 2010.0, 'response_length/min': 58.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:56 - global_seqlen/min:27440 - global_seqlen/max:35460 - global_seqlen/minmax_diff:8020 - global_seqlen/balanced_min:30622 - global_seqlen/balanced_max:31096 - global_seqlen/mean:30682.375 - actor/entropy:0.43040764331817627 - actor/kl_loss:0.09110459135845303 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09497663674410432 - actor/pg_clipfrac:0.0015738083922769875 - actor/ppo_kl:0.002102689573803218 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9804362207651138 - perf/mfu/actor:0.0898847259954392 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.1606674194336 - actor/lr:1e-06 - training/global_step:56 - training/epoch:1 - critic/score/mean:1.3359375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3359375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.002543088747188449 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.002543088747188449 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:356.99688720703125 - response_length/max:2010.0 - response_length/min:58.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010614842176437378 - timing_s/generate_sequences:41.08063888549805 - timing_s/reshard:0.6573637127876282 - timing_s/gen:61.402245339006186 - timing_s/reward:0.07617969810962677 - timing_s/old_log_prob:1.3009024504572153 - timing_s/ref:1.3815425727516413 - timing_s/adv:0.007970297709107399 - timing_s/update_actor:7.314155509695411 - timing_s/step:71.4977096579969 - timing_s/stop_profile:4.4055283069610596e-05 - timing_per_token_ms/adv:3.247099397091734e-05 - timing_per_token_ms/gen:0.5374893454862716 - timing_per_token_ms/ref:0.005628404632755944 - timing_per_token_ms/update_actor:0.029797870559626703 - perf/total_num_tokens:245459 - perf/time_per_step:71.4977096579969 - perf/throughput:429.1378723425755
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.368749976158142, 'critic/score/max': 2.0, 'critic/score/min': 0.5, 'critic/rewards/mean': 1.368749976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': 0.5, 'critic/advantages/mean': -0.00694329384714365, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.00694329384714365, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 369.9375, 'response_length/max': 1227.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.36875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  11%|█         | 57/525 [57:16<8:29:49, 65.36s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  11%|█         | 58/525 [58:29<8:47:34, 67.78s/it]
[36m(TaskRunner pid=2949575)[0m step:57 - global_seqlen/min:27699 - global_seqlen/max:36206 - global_seqlen/minmax_diff:8507 - global_seqlen/balanced_min:31198 - global_seqlen/balanced_max:31204 - global_seqlen/mean:31200.0 - actor/entropy:0.3903072476387024 - actor/kl_loss:0.07055532643571497 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1688310875557363 - actor/pg_clipfrac:0.0013753533421549946 - actor/ppo_kl:0.001283551670712768 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8688641488552094 - perf/mfu/actor:0.09259732586346515 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.1367301940918 - actor/lr:1e-06 - training/global_step:57 - training/epoch:1 - critic/score/mean:1.368749976158142 - critic/score/max:2.0 - critic/score/min:0.5 - critic/rewards/mean:1.368749976158142 - critic/rewards/max:2.0 - critic/rewards/min:0.5 - critic/advantages/mean:-0.00694329384714365 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00694329384714365 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:369.9375 - response_length/max:1227.0 - response_length/min:97.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.36875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.996203541755676e-05 - timing_s/generate_sequences:30.158979415893555 - timing_s/reshard:0.6880993247032166 - timing_s/gen:40.66231256723404 - timing_s/reward:0.07606000266969204 - timing_s/old_log_prob:1.1357753612101078 - timing_s/ref:1.3873883318156004 - timing_s/adv:0.007781321182847023 - timing_s/update_actor:7.209048166871071 - timing_s/step:50.49312688037753 - timing_s/stop_profile:4.439614713191986e-05 - timing_per_token_ms/adv:3.11751649953807e-05 - timing_per_token_ms/gen:0.34348971589148536 - timing_per_token_ms/ref:0.005558446842209937 - timing_per_token_ms/update_actor:0.028882404514707815 - perf/total_num_tokens:249600 - perf/time_per_step:50.49312688037753 - perf/throughput:617.9058800203724
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3953125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3953125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05035552382469177, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.05035552382469177, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 390.828125, 'response_length/max': 2048.0, 'response_length/min': 73.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:58 - global_seqlen/min:29059 - global_seqlen/max:36584 - global_seqlen/minmax_diff:7525 - global_seqlen/balanced_min:31987 - global_seqlen/balanced_max:32271 - global_seqlen/mean:32022.5 - actor/entropy:0.3834570646286011 - actor/kl_loss:0.08112849472090602 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.009857645630836487 - actor/pg_clipfrac:0.001041818133671768 - actor/ppo_kl:-7.749896994937444e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7961917817592621 - perf/mfu/actor:0.0911400227974394 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.22190475463867 - actor/lr:1e-06 - training/global_step:58 - training/epoch:1 - critic/score/mean:1.3953125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3953125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05035552382469177 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.05035552382469177 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:390.828125 - response_length/max:2048.0 - response_length/min:73.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.381344377994537e-05 - timing_s/generate_sequences:48.2003059387207 - timing_s/reshard:0.7489901781082153 - timing_s/gen:63.20371011085808 - timing_s/reward:0.0783393494784832 - timing_s/old_log_prob:1.2018806226551533 - timing_s/ref:1.3732066005468369 - timing_s/adv:0.007902812212705612 - timing_s/update_actor:7.535104284062982 - timing_s/step:73.41552684083581 - timing_s/stop_profile:4.4090673327445984e-05 - timing_per_token_ms/adv:3.0848669734973894e-05 - timing_per_token_ms/gen:0.5053668901040106 - timing_per_token_ms/ref:0.005360319308872031 - timing_per_token_ms/update_actor:0.02941331986908807 - perf/total_num_tokens:256180 - perf/time_per_step:73.41552684083581 - perf/throughput:436.1815732716117
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.435937523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.435937523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.022846758365631104, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.022846758365631104, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 371.70001220703125, 'response_length/max': 1269.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  11%|█         | 59/525 [59:21<8:10:08, 63.11s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:40:04,768:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 00:40:08,311:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 00:40:08,313:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:40:09,062:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/huggingface
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 00:40:04,997:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  11%|█▏        | 60/525 [1:00:23<8:06:02, 62.71s/it]
[36m(TaskRunner pid=2949575)[0m step:59 - global_seqlen/min:28609 - global_seqlen/max:35336 - global_seqlen/minmax_diff:6727 - global_seqlen/balanced_min:31248 - global_seqlen/balanced_max:31249 - global_seqlen/mean:31248.625 - actor/entropy:0.4156203866004944 - actor/kl_loss:0.09978587422519922 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06985391080379486 - actor/pg_clipfrac:0.0030813053133897485 - actor/ppo_kl:0.0007025353894277942 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9726538956165314 - perf/mfu/actor:0.0934742262483009 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:91.703125 - perf/cpu_memory_used_gb:96.22780227661133 - actor/lr:1e-06 - training/global_step:59 - training/epoch:1 - critic/score/mean:1.435937523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.435937523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.022846758365631104 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.022846758365631104 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:371.70001220703125 - response_length/max:1269.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.391216397285461e-05 - timing_s/generate_sequences:35.02954864501953 - timing_s/reshard:0.7362260818481445 - timing_s/gen:42.40762788057327 - timing_s/reward:0.07716206833720207 - timing_s/old_log_prob:1.1541758924722672 - timing_s/ref:1.3663254547864199 - timing_s/adv:0.007697485387325287 - timing_s/update_actor:7.156543197110295 - timing_s/step:52.184899006038904 - timing_s/stop_profile:4.505552351474762e-05 - timing_per_token_ms/adv:3.079129636634127e-05 - timing_per_token_ms/gen:0.35653440174009005 - timing_per_token_ms/ref:0.005465542303007012 - timing_per_token_ms/update_actor:0.02862743239546658 - perf/total_num_tokens:249989 - perf/time_per_step:52.184899006038904 - perf/throughput:598.8058920337063
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.412500023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.412500023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.009724854491651058, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.009724854491651058, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 347.2562561035156, 'response_length/max': 1355.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:60 - global_seqlen/min:26518 - global_seqlen/max:34072 - global_seqlen/minmax_diff:7554 - global_seqlen/balanced_min:30220 - global_seqlen/balanced_max:30317 - global_seqlen/mean:30244.625 - actor/entropy:0.42411431670188904 - actor/kl_loss:0.0912548027932644 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.053176600858569144 - actor/pg_clipfrac:0.003299561340827495 - actor/ppo_kl:-0.0008774799076491036 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8525443971157074 - perf/mfu/actor:0.09043883088069475 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.26444625854492 - actor/lr:1e-06 - training/global_step:60 - training/epoch:1 - critic/score/mean:1.412500023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.412500023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.009724854491651058 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.009724854491651058 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:347.2562561035156 - response_length/max:1355.0 - response_length/min:89.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010051019489765167 - timing_s/generate_sequences:32.69955062866211 - timing_s/reshard:0.6659064292907715 - timing_s/gen:43.806127615273 - timing_s/reward:0.07593083940446377 - timing_s/old_log_prob:1.1448783427476883 - timing_s/ref:1.3659177757799625 - timing_s/adv:0.007760088890790939 - timing_s/update_actor:7.15216458030045 - timing_s/save_checkpoint:7.8812374752014875 - timing_s/step:61.44983897730708 - timing_s/stop_profile:4.8607587814331055e-05 - timing_per_token_ms/adv:3.20721817959015e-05 - timing_per_token_ms/gen:0.39421651531895574 - timing_per_token_ms/ref:0.005645291418640347 - timing_per_token_ms/update_actor:0.029559651426908296 - perf/total_num_tokens:241957 - perf/time_per_step:61.44983897730708 - perf/throughput:492.1839585481923
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.353124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.353124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06554296612739563, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.06554296612739563, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 384.04376220703125, 'response_length/max': 2048.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.353125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  12%|█▏        | 61/525 [1:01:38<8:33:07, 66.35s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:40:09,832:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:40:09,834:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_60/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  12%|█▏        | 62/525 [1:02:51<8:46:33, 68.24s/it]
[36m(TaskRunner pid=2949575)[0m step:61 - global_seqlen/min:30079 - global_seqlen/max:33245 - global_seqlen/minmax_diff:3166 - global_seqlen/balanced_min:31633 - global_seqlen/balanced_max:31916 - global_seqlen/mean:31738.0 - actor/entropy:0.4017806053161621 - actor/kl_loss:0.08173619797453284 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10272886543534696 - actor/pg_clipfrac:0.002102456759894267 - actor/ppo_kl:-0.00038500850787386297 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1824436038732529 - perf/mfu/actor:0.09234751175822231 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.23329544067383 - actor/lr:1e-06 - training/global_step:61 - training/epoch:1 - critic/score/mean:1.353124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.353124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06554296612739563 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.06554296612739563 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:384.04376220703125 - response_length/max:2048.0 - response_length/min:74.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.353125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010645762085914612 - timing_s/generate_sequences:50.37321853637695 - timing_s/reshard:0.7131323218345642 - timing_s/gen:64.37983622960746 - timing_s/reward:0.07778403535485268 - timing_s/old_log_prob:1.236474335193634 - timing_s/ref:1.3676999043673277 - timing_s/adv:0.007628938183188438 - timing_s/update_actor:7.374349053949118 - timing_s/step:74.45899198576808 - timing_s/stop_profile:4.3449923396110535e-05 - timing_per_token_ms/adv:3.0046545872410197e-05 - timing_per_token_ms/gen:0.5238647633701194 - timing_per_token_ms/ref:0.005386681203790912 - timing_per_token_ms/update_actor:0.029043847493340467 - perf/total_num_tokens:253904 - perf/time_per_step:74.45899198576808 - perf/throughput:426.2480481345534
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3515625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3515625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005754914600402117, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.005754914600402117, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 403.0625, 'response_length/max': 1985.0, 'response_length/min': 71.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:62 - global_seqlen/min:28973 - global_seqlen/max:38251 - global_seqlen/minmax_diff:9278 - global_seqlen/balanced_min:32482 - global_seqlen/balanced_max:32606 - global_seqlen/mean:32498.75 - actor/entropy:0.39361539483070374 - actor/kl_loss:0.08705066945403814 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04031352326273918 - actor/pg_clipfrac:0.0010979615268297493 - actor/ppo_kl:0.0006957924853850273 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8083689212799072 - perf/mfu/actor:0.09499379258903332 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.17192459106445 - actor/lr:1e-06 - training/global_step:62 - training/epoch:1 - critic/score/mean:1.3515625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3515625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005754914600402117 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.005754914600402117 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:403.0625 - response_length/max:1985.0 - response_length/min:71.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.498877286911011e-05 - timing_s/generate_sequences:43.05192184448242 - timing_s/reshard:0.8249310255050659 - timing_s/gen:62.55589601583779 - timing_s/reward:0.07923776470124722 - timing_s/old_log_prob:1.228948986157775 - timing_s/ref:1.3857234194874763 - timing_s/adv:0.007938550785183907 - timing_s/update_actor:7.342063708230853 - timing_s/step:72.61483672261238 - timing_s/stop_profile:4.445761442184448e-05 - timing_per_token_ms/adv:3.053406202232358e-05 - timing_per_token_ms/gen:0.4850046209942455 - timing_per_token_ms/ref:0.005329910456123222 - timing_per_token_ms/update_actor:0.02823979271599236 - perf/total_num_tokens:259990 - perf/time_per_step:72.61483672261238 - perf/throughput:447.5497221613918
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.389062523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.389062523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0069677759893238544, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0069677759893238544, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 362.6343688964844, 'response_length/max': 1305.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  12%|█▏        | 63/525 [1:03:42<8:07:24, 63.30s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  12%|█▏        | 64/525 [1:04:43<7:59:26, 62.40s/it]
[36m(TaskRunner pid=2949575)[0m step:63 - global_seqlen/min:28558 - global_seqlen/max:34185 - global_seqlen/minmax_diff:5627 - global_seqlen/balanced_min:30893 - global_seqlen/balanced_max:30933 - global_seqlen/mean:30899.125 - actor/entropy:0.3988874852657318 - actor/kl_loss:0.08315072152763606 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.18428629292175175 - actor/pg_clipfrac:0.0019576453283661976 - actor/ppo_kl:0.00022603083180001705 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9890530854463577 - perf/mfu/actor:0.09367195909298486 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.22648239135742 - actor/lr:1e-06 - training/global_step:63 - training/epoch:1 - critic/score/mean:1.389062523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.389062523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0069677759893238544 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0069677759893238544 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:362.6343688964844 - response_length/max:1305.0 - response_length/min:85.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.319690823554993e-05 - timing_s/generate_sequences:31.729888916015625 - timing_s/reshard:0.7492650747299194 - timing_s/gen:42.03593808785081 - timing_s/reward:0.07528495229780674 - timing_s/old_log_prob:1.1970375664532185 - timing_s/ref:1.3731189705431461 - timing_s/adv:0.007985485717654228 - timing_s/update_actor:7.056384542956948 - timing_s/step:51.76785616390407 - timing_s/stop_profile:4.755333065986633e-05 - timing_per_token_ms/adv:3.230465958847633e-05 - timing_per_token_ms/gen:0.36224449633197014 - timing_per_token_ms/ref:0.005554845689575134 - timing_per_token_ms/update_actor:0.028546053257806445 - perf/total_num_tokens:247193 - perf/time_per_step:51.76785616390407 - perf/throughput:596.878590107521
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4562499523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4562499523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.015913432464003563, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': 0.015913432464003563, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 375.80938720703125, 'response_length/max': 1608.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.45625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:64 - global_seqlen/min:28613 - global_seqlen/max:34589 - global_seqlen/minmax_diff:5976 - global_seqlen/balanced_min:31395 - global_seqlen/balanced_max:31531 - global_seqlen/mean:31413.0 - actor/entropy:0.37872445583343506 - actor/kl_loss:0.08261942658573389 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07038213610649109 - actor/pg_clipfrac:0.0018983605317771436 - actor/ppo_kl:0.001225474131933879 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8047871142625809 - perf/mfu/actor:0.09340125445397246 - perf/max_memory_allocated_gb:64.70857763290405 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.22463989257812 - actor/lr:1e-06 - training/global_step:64 - training/epoch:1 - critic/score/mean:1.4562499523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4562499523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.015913432464003563 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.015913432464003563 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:375.80938720703125 - response_length/max:1608.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.45625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.687989950180054e-05 - timing_s/generate_sequences:37.89014434814453 - timing_s/reshard:0.7995796203613281 - timing_s/gen:50.13753646053374 - timing_s/reward:0.07683268934488297 - timing_s/old_log_prob:1.2319819573312998 - timing_s/ref:1.3940177280455828 - timing_s/adv:0.0077424850314855576 - timing_s/update_actor:7.206004103645682 - timing_s/step:60.0715720448643 - timing_s/stop_profile:4.5200809836387634e-05 - timing_per_token_ms/adv:3.080923913461607e-05 - timing_per_token_ms/gen:0.4169129666846867 - timing_per_token_ms/ref:0.005547137045353766 - timing_per_token_ms/update_actor:0.028674450480874487 - perf/total_num_tokens:251304 - perf/time_per_step:60.0715720448643 - perf/throughput:522.9262183539876
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.365625023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.365625023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05797315761446953, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05797315761446953, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 396.81561279296875, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.365625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  12%|█▏        | 65/525 [1:05:55<8:21:10, 65.37s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  13%|█▎        | 66/525 [1:06:49<7:54:39, 62.05s/it]
[36m(TaskRunner pid=2949575)[0m step:65 - global_seqlen/min:28763 - global_seqlen/max:34903 - global_seqlen/minmax_diff:6140 - global_seqlen/balanced_min:32134 - global_seqlen/balanced_max:32578 - global_seqlen/mean:32248.875 - actor/entropy:0.41445544362068176 - actor/kl_loss:0.0823547838255763 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1760515794157982 - actor/pg_clipfrac:0.002090902869531419 - actor/ppo_kl:0.0005360158918243485 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8332952111959457 - perf/mfu/actor:0.09467514398027042 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.19578170776367 - actor/lr:1e-06 - training/global_step:65 - training/epoch:1 - critic/score/mean:1.365625023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.365625023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05797315761446953 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05797315761446953 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:396.81561279296875 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.365625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.342228829860687e-05 - timing_s/generate_sequences:49.101463317871094 - timing_s/reshard:0.719750702381134 - timing_s/gen:62.25241415761411 - timing_s/reward:0.07864313945174217 - timing_s/old_log_prob:1.2513334937393665 - timing_s/ref:1.3731416761875153 - timing_s/adv:0.007893618196249008 - timing_s/update_actor:7.3068561889231205 - timing_s/step:72.28522181883454 - timing_s/stop_profile:4.535168409347534e-05 - timing_per_token_ms/adv:3.059648668460918e-05 - timing_per_token_ms/gen:0.49024983389337073 - timing_per_token_ms/ref:0.005322440225385828 - timing_per_token_ms/update_actor:0.028322136000570253 - perf/total_num_tokens:257991 - perf/time_per_step:72.28522181883454 - perf/throughput:446.13372123037846
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.396875023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.396875023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02504703961312771, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.02504703961312771, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 415.00311279296875, 'response_length/max': 1379.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.396875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:66 - global_seqlen/min:30279 - global_seqlen/max:35585 - global_seqlen/minmax_diff:5306 - global_seqlen/balanced_min:32950 - global_seqlen/balanced_max:32951 - global_seqlen/mean:32950.125 - actor/entropy:0.39983320236206055 - actor/kl_loss:0.08189934510737658 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.15362909510731698 - actor/pg_clipfrac:0.0027369930467102677 - actor/ppo_kl:0.0008025164832361042 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4246360957622528 - perf/mfu/actor:0.0977299765182726 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.13805770874023 - actor/lr:1e-06 - training/global_step:66 - training/epoch:1 - critic/score/mean:1.396875023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.396875023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02504703961312771 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.02504703961312771 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:415.00311279296875 - response_length/max:1379.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.396875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.015334606170654e-05 - timing_s/generate_sequences:38.4221305847168 - timing_s/reshard:0.6816521883010864 - timing_s/gen:44.32209303602576 - timing_s/reward:0.0804876871407032 - timing_s/old_log_prob:1.2358502484858036 - timing_s/ref:1.3816489297896624 - timing_s/adv:0.00790243037045002 - timing_s/update_actor:7.233657715842128 - timing_s/step:54.276909444481134 - timing_s/stop_profile:4.466995596885681e-05 - timing_per_token_ms/adv:2.9978757176376492e-05 - timing_per_token_ms/gen:0.3337481874084213 - timing_per_token_ms/ref:0.005241440395862164 - timing_per_token_ms/update_actor:0.027441692997530843 - perf/total_num_tokens:263601 - perf/time_per_step:54.276909444481134 - perf/throughput:607.0744509450024
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.484375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.484375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08305806666612625, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.08305806666612625, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 404.703125, 'response_length/max': 2048.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 408.640625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  13%|█▎        | 67/525 [1:08:03<8:19:45, 65.47s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  13%|█▎        | 68/525 [1:08:51<7:39:53, 60.38s/it]
[36m(TaskRunner pid=2949575)[0m step:67 - global_seqlen/min:27267 - global_seqlen/max:39531 - global_seqlen/minmax_diff:12264 - global_seqlen/balanced_min:32427 - global_seqlen/balanced_max:32853 - global_seqlen/mean:32533.75 - actor/entropy:0.3969417214393616 - actor/kl_loss:0.09664097875356674 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2254115879535675 - actor/pg_clipfrac:0.0017726450692862271 - actor/ppo_kl:0.000821585078665521 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8967075198888779 - perf/mfu/actor:0.09292066794800187 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.18562698364258 - actor/lr:1e-06 - training/global_step:67 - training/epoch:1 - critic/score/mean:1.484375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.484375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08305806666612625 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.08305806666612625 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:404.703125 - response_length/max:2048.0 - response_length/min:87.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.373335003852844e-05 - timing_s/generate_sequences:46.46726608276367 - timing_s/reshard:0.6702659130096436 - timing_s/gen:63.21155755966902 - timing_s/reward:0.07848841696977615 - timing_s/old_log_prob:1.2298484463244677 - timing_s/ref:1.3821474257856607 - timing_s/adv:0.007768189534544945 - timing_s/update_actor:7.5161181930452585 - timing_s/step:73.44125408865511 - timing_s/stop_profile:4.254840314388275e-05 - timing_per_token_ms/adv:2.98466574501285e-05 - timing_per_token_ms/gen:0.4881012899862478 - timing_per_token_ms/ref:0.0053104369531089286 - timing_per_token_ms/update_actor:0.028878158039901864 - perf/total_num_tokens:260270 - perf/time_per_step:73.44125408865511 - perf/throughput:442.9901205217256
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.420312523841858, 'critic/score/max': 2.0, 'critic/score/min': 0.5, 'critic/rewards/mean': 1.420312523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': 0.5, 'critic/advantages/mean': -0.019510837271809578, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.019510837271809578, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 381.70623779296875, 'response_length/max': 1151.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:68 - global_seqlen/min:29549 - global_seqlen/max:33066 - global_seqlen/minmax_diff:3517 - global_seqlen/balanced_min:31635 - global_seqlen/balanced_max:31636 - global_seqlen/mean:31635.75 - actor/entropy:0.38740798830986023 - actor/kl_loss:0.08444125521928073 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14387935362756252 - actor/pg_clipfrac:0.0021129139728145673 - actor/ppo_kl:-0.0006114580487519561 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.032784327864647 - perf/mfu/actor:0.0947306403664607 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.24809265136719 - actor/lr:1e-06 - training/global_step:68 - training/epoch:1 - critic/score/mean:1.420312523841858 - critic/score/max:2.0 - critic/score/min:0.5 - critic/rewards/mean:1.420312523841858 - critic/rewards/max:2.0 - critic/rewards/min:0.5 - critic/advantages/mean:-0.019510837271809578 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.019510837271809578 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:381.70623779296875 - response_length/max:1151.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010043196380138397 - timing_s/generate_sequences:33.030067443847656 - timing_s/reshard:0.6888546943664551 - timing_s/gen:38.35852166451514 - timing_s/reward:0.07772896997630596 - timing_s/old_log_prob:1.3037993293255568 - timing_s/ref:1.3712404798716307 - timing_s/adv:0.007954202592372894 - timing_s/update_actor:7.152551308274269 - timing_s/step:48.287091525271535 - timing_s/stop_profile:4.525668919086456e-05 - timing_per_token_ms/adv:3.1428852612838693e-05 - timing_per_token_ms/gen:0.314038295683159 - timing_per_token_ms/ref:0.0054180811260663595 - timing_per_token_ms/update_actor:0.02826134716370826 - perf/total_num_tokens:253086 - perf/time_per_step:48.287091525271535 - perf/throughput:655.1595675097373
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.396875023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.396875023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.057785771787166595, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.057785771787166595, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 383.9156188964844, 'response_length/max': 1701.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.396875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  13%|█▎        | 69/525 [1:09:56<7:48:45, 61.68s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:50:52,653:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:50:56,204:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:50:56,207:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 00:50:56,773:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/huggingface
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:50:52,971:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  13%|█▎        | 70/525 [1:11:11<8:18:19, 65.71s/it]
[36m(TaskRunner pid=2949575)[0m step:69 - global_seqlen/min:28609 - global_seqlen/max:35979 - global_seqlen/minmax_diff:7370 - global_seqlen/balanced_min:31631 - global_seqlen/balanced_max:31928 - global_seqlen/mean:31741.625 - actor/entropy:0.4232347905635834 - actor/kl_loss:0.09891111329197884 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09175227032974362 - actor/pg_clipfrac:0.004479714273475111 - actor/ppo_kl:0.0004904722241917625 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.3589437752962112 - perf/mfu/actor:0.09081716838877628 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.21881103515625 - actor/lr:1e-06 - training/global_step:69 - training/epoch:1 - critic/score/mean:1.396875023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.396875023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.057785771787166595 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.057785771787166595 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:383.9156188964844 - response_length/max:1701.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.396875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.596161544322968e-05 - timing_s/generate_sequences:41.169586181640625 - timing_s/reshard:0.6690788269042969 - timing_s/gen:54.43258544616401 - timing_s/reward:0.07804546318948269 - timing_s/old_log_prob:1.2021758295595646 - timing_s/ref:1.368430718779564 - timing_s/adv:0.007794555276632309 - timing_s/update_actor:7.488076217472553 - timing_s/step:64.59142736718059 - timing_s/stop_profile:4.2850151658058167e-05 - timing_per_token_ms/adv:3.0695322296165955e-05 - timing_per_token_ms/gen:0.44307086881202745 - timing_per_token_ms/ref:0.005388944007984641 - timing_per_token_ms/update_actor:0.02948839346391589 - perf/total_num_tokens:253933 - perf/time_per_step:64.59142736718059 - perf/throughput:491.42163741884065
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.421875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.421875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05024295672774315, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.05024295672774315, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 391.234375, 'response_length/max': 1821.0, 'response_length/min': 106.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:70 - global_seqlen/min:28486 - global_seqlen/max:35126 - global_seqlen/minmax_diff:6640 - global_seqlen/balanced_min:32001 - global_seqlen/balanced_max:32152 - global_seqlen/mean:32021.25 - actor/entropy:0.38929906487464905 - actor/kl_loss:0.15755980797111988 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17915765717625617 - actor/pg_clipfrac:0.013903093489352614 - actor/ppo_kl:0.00923739310237579 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9218853712081909 - perf/mfu/actor:0.09247709616004833 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.22114944458008 - actor/lr:1e-06 - training/global_step:70 - training/epoch:1 - critic/score/mean:1.421875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.421875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05024295672774315 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.05024295672774315 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:391.234375 - response_length/max:1821.0 - response_length/min:106.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.142553269863129e-05 - timing_s/generate_sequences:40.94490051269531 - timing_s/reshard:0.7309371829032898 - timing_s/gen:57.12900734320283 - timing_s/reward:0.0778642762452364 - timing_s/old_log_prob:1.174636173993349 - timing_s/ref:1.3687153197824955 - timing_s/adv:0.007859764620661736 - timing_s/update_actor:7.425594985485077 - timing_s/save_checkpoint:7.910806892439723 - timing_s/step:75.10978467017412 - timing_s/stop_profile:6.144493818283081e-05 - timing_per_token_ms/adv:3.068183089613044e-05 - timing_per_token_ms/gen:0.4563201992348163 - timing_per_token_ms/ref:0.005342996134529787 - timing_per_token_ms/update_actor:0.028986981244818195 - perf/total_num_tokens:256170 - perf/time_per_step:75.10978467017412 - perf/throughput:426.32594595515525
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.389062523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.389062523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026285020634531975, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.026285020634531975, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 353.70623779296875, 'response_length/max': 1800.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  14%|█▎        | 71/525 [1:12:19<8:21:57, 66.34s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:50:57,780:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 00:50:57,782:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_70/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  14%|█▎        | 72/525 [1:13:10<7:45:07, 61.61s/it]
[36m(TaskRunner pid=2949575)[0m step:71 - global_seqlen/min:27039 - global_seqlen/max:33296 - global_seqlen/minmax_diff:6257 - global_seqlen/balanced_min:30463 - global_seqlen/balanced_max:30925 - global_seqlen/mean:30546.375 - actor/entropy:0.42130154371261597 - actor/kl_loss:0.10300344061106444 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05517330449074507 - actor/pg_clipfrac:0.001505725784227252 - actor/ppo_kl:0.0003255789059039671 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.1321768909692764 - perf/mfu/actor:0.08731506379154884 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.67080307006836 - actor/lr:1e-06 - training/global_step:71 - training/epoch:2 - critic/score/mean:1.389062523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.389062523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026285020634531975 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.026285020634531975 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:353.70623779296875 - response_length/max:1800.0 - response_length/min:85.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00035883858799934387 - timing_s/generate_sequences:38.20088195800781 - timing_s/reshard:0.8297781348228455 - timing_s/gen:55.518097342923284 - timing_s/reward:0.07716668769717216 - timing_s/old_log_prob:1.1788868978619576 - timing_s/ref:1.3677069693803787 - timing_s/adv:0.010967016220092773 - timing_s/update_actor:7.486868033185601 - timing_s/step:65.66967742703855 - timing_s/stop_profile:4.6761706471443176e-05 - timing_per_token_ms/adv:4.4878550319361844e-05 - timing_per_token_ms/gen:0.4905032189751673 - timing_per_token_ms/ref:0.005596846472700847 - timing_per_token_ms/update_actor:0.030637301615926607 - perf/total_num_tokens:244371 - perf/time_per_step:65.66967742703855 - perf/throughput:465.15189653456355
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.404687523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.404687523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.013820134103298187, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.013820134103298187, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 369.6937561035156, 'response_length/max': 1217.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:72 - global_seqlen/min:26303 - global_seqlen/max:34597 - global_seqlen/minmax_diff:8294 - global_seqlen/balanced_min:31168 - global_seqlen/balanced_max:31169 - global_seqlen/mean:31168.375 - actor/entropy:0.4082525968551636 - actor/kl_loss:0.12342765368521214 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07400370767572895 - actor/pg_clipfrac:0.0016545761493034661 - actor/ppo_kl:-0.00012520482414402068 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.9562858045101166 - perf/mfu/actor:0.08745681663832741 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.65819549560547 - actor/lr:1e-06 - training/global_step:72 - training/epoch:2 - critic/score/mean:1.404687523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.404687523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.013820134103298187 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.013820134103298187 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:369.6937561035156 - response_length/max:1217.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.923932909965515e-05 - timing_s/generate_sequences:36.35011672973633 - timing_s/reshard:0.7727584838867188 - timing_s/gen:40.17719527333975 - timing_s/reward:0.07637776620686054 - timing_s/old_log_prob:1.2674451489001513 - timing_s/ref:1.3750057257711887 - timing_s/adv:0.00773204118013382 - timing_s/update_actor:7.627905437722802 - timing_s/step:50.552250042557716 - timing_s/stop_profile:4.581920802593231e-05 - timing_per_token_ms/adv:3.100916064814824e-05 - timing_per_token_ms/gen:0.3396155202223103 - timing_per_token_ms/ref:0.005514426585325626 - timing_per_token_ms/update_actor:0.030591526818942286 - perf/total_num_tokens:249347 - perf/time_per_step:50.552250042557716 - perf/throughput:616.5576205561714
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4578125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4578125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.016154037788510323, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.016154037788510323, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 389.3812561035156, 'response_length/max': 2048.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.0031250000465661287, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  14%|█▍        | 73/525 [1:14:22<8:07:58, 64.78s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  14%|█▍        | 74/525 [1:15:17<7:45:20, 61.91s/it]
[36m(TaskRunner pid=2949575)[0m step:73 - global_seqlen/min:28930 - global_seqlen/max:37247 - global_seqlen/minmax_diff:8317 - global_seqlen/balanced_min:31868 - global_seqlen/balanced_max:32424 - global_seqlen/mean:31938.375 - actor/entropy:0.39779770374298096 - actor/kl_loss:0.1657414162531495 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.18715233504772186 - actor/pg_clipfrac:0.00420293842907995 - actor/ppo_kl:0.0024503314354660686 - actor/pg_clipfrac_lower:5.692599806934595e-05 - actor/grad_norm:4.829970479011536 - perf/mfu/actor:0.09481241053514673 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.64756774902344 - actor/lr:1e-06 - training/global_step:73 - training/epoch:2 - critic/score/mean:1.4578125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4578125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.016154037788510323 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.016154037788510323 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:389.3812561035156 - response_length/max:2048.0 - response_length/min:84.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.4705650806427e-05 - timing_s/generate_sequences:37.1783447265625 - timing_s/reshard:0.6607890129089355 - timing_s/gen:62.28017886355519 - timing_s/reward:0.07828793488442898 - timing_s/old_log_prob:1.1916568167507648 - timing_s/ref:1.3616565316915512 - timing_s/adv:0.010408362373709679 - timing_s/update_actor:7.2217352241277695 - timing_s/step:72.15752161666751 - timing_s/stop_profile:4.394538700580597e-05 - timing_per_token_ms/adv:4.073611436755032e-05 - timing_per_token_ms/gen:0.4998328988584067 - timing_per_token_ms/ref:0.005329233765382363 - timing_per_token_ms/update_actor:0.028264334143987324 - perf/total_num_tokens:255507 - perf/time_per_step:72.15752161666751 - perf/throughput:442.6201771406548
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4031250476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4031250476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06101246178150177, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.06101246178150177, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 381.9624938964844, 'response_length/max': 1422.0, 'response_length/min': 55.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.403125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:74 - global_seqlen/min:28375 - global_seqlen/max:34903 - global_seqlen/minmax_diff:6528 - global_seqlen/balanced_min:31654 - global_seqlen/balanced_max:31655 - global_seqlen/mean:31654.75 - actor/entropy:0.4301117956638336 - actor/kl_loss:0.10769259035587311 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.002457152307033539 - actor/pg_clipfrac:0.0034426666563376783 - actor/ppo_kl:0.0025025091035786318 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.2536149322986603 - perf/mfu/actor:0.09423877268392258 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.59434127807617 - actor/lr:1e-06 - training/global_step:74 - training/epoch:2 - critic/score/mean:1.4031250476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4031250476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06101246178150177 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.06101246178150177 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:381.9624938964844 - response_length/max:1422.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.403125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.392520248889923e-05 - timing_s/generate_sequences:35.57406997680664 - timing_s/reshard:0.6878442168235779 - timing_s/gen:45.35755063779652 - timing_s/reward:0.07862870581448078 - timing_s/old_log_prob:1.168638015165925 - timing_s/ref:1.374472862109542 - timing_s/adv:0.008144652470946312 - timing_s/update_actor:7.195383140817285 - timing_s/step:55.19924718700349 - timing_s/stop_profile:4.626624286174774e-05 - timing_per_token_ms/adv:3.216204705038862e-05 - timing_per_token_ms/gen:0.37108969006935005 - timing_per_token_ms/ref:0.005427593260527812 - timing_per_token_ms/update_actor:0.02841352064388948 - perf/total_num_tokens:253238 - perf/time_per_step:55.19924718700349 - perf/throughput:573.463436788555
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3671875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3671875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0060508414171636105, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0060508414171636105, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 355.6781311035156, 'response_length/max': 981.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  14%|█▍        | 75/525 [1:16:00<7:02:08, 56.28s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  14%|█▍        | 76/525 [1:16:57<7:01:34, 56.34s/it]
[36m(TaskRunner pid=2949575)[0m step:75 - global_seqlen/min:29193 - global_seqlen/max:33238 - global_seqlen/minmax_diff:4045 - global_seqlen/balanced_min:30612 - global_seqlen/balanced_max:30613 - global_seqlen/mean:30612.125 - actor/entropy:0.41044607758522034 - actor/kl_loss:0.16583918631076813 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.29077778989449143 - actor/pg_clipfrac:0.004281844419892877 - actor/ppo_kl:0.003165320449625142 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.7366221845149994 - perf/mfu/actor:0.08836689227491765 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.64959716796875 - actor/lr:1e-06 - training/global_step:75 - training/epoch:2 - critic/score/mean:1.3671875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3671875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0060508414171636105 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0060508414171636105 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:355.6781311035156 - response_length/max:981.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.462928235530853e-05 - timing_s/generate_sequences:28.293331146240234 - timing_s/reshard:0.6580023765563965 - timing_s/gen:33.133512722328305 - timing_s/reward:0.08142432197928429 - timing_s/old_log_prob:1.1378183644264936 - timing_s/ref:1.3684724681079388 - timing_s/adv:0.007774818688631058 - timing_s/update_actor:7.406320968642831 - timing_s/step:43.153225008398294 - timing_s/stop_profile:4.58545982837677e-05 - timing_per_token_ms/adv:3.1747300655504385e-05 - timing_per_token_ms/gen:0.2911121600668468 - timing_per_token_ms/ref:0.005587951130916013 - timing_per_token_ms/update_actor:0.030242595738791535 - perf/total_num_tokens:244897 - perf/time_per_step:43.153225008398294 - perf/throughput:709.3820912351835
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.454687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.454687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00772089185193181, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.00772089185193181, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 351.4468688964844, 'response_length/max': 1431.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:76 - global_seqlen/min:27742 - global_seqlen/max:33600 - global_seqlen/minmax_diff:5858 - global_seqlen/balanced_min:30429 - global_seqlen/balanced_max:30430 - global_seqlen/mean:30429.75 - actor/entropy:0.4229902923107147 - actor/kl_loss:0.17116092164069413 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.018953314796090127 - actor/pg_clipfrac:0.0023181977798230947 - actor/ppo_kl:0.0026074527646414935 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.7993375360965729 - perf/mfu/actor:0.09078173348695272 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.7038803100586 - actor/lr:1e-06 - training/global_step:76 - training/epoch:2 - critic/score/mean:1.454687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.454687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00772089185193181 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00772089185193181 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:351.4468688964844 - response_length/max:1431.0 - response_length/min:89.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.441375732421875e-05 - timing_s/generate_sequences:37.36602020263672 - timing_s/reshard:0.7614394426345825 - timing_s/gen:46.52108626998961 - timing_s/reward:0.07479502446949482 - timing_s/old_log_prob:1.1705785430967808 - timing_s/ref:1.367791198194027 - timing_s/adv:0.008142327889800072 - timing_s/update_actor:7.1706261076033115 - timing_s/step:56.32958679459989 - timing_s/stop_profile:4.743598401546478e-05 - timing_per_token_ms/adv:3.3447234572252776e-05 - timing_per_token_ms/gen:0.4136568139742814 - timing_per_token_ms/ref:0.005618642932467515 - timing_per_token_ms/update_actor:0.029455656502285227 - perf/total_num_tokens:243438 - perf/time_per_step:56.32958679459989 - perf/throughput:540.2090043898065
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.423437476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.423437476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01648152992129326, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.01648152992129326, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 412.1468811035156, 'response_length/max': 1305.0, 'response_length/min': 111.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4234375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  15%|█▍        | 77/525 [1:17:50<6:53:27, 55.37s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  15%|█▍        | 78/525 [1:18:46<6:54:14, 55.60s/it]
[36m(TaskRunner pid=2949575)[0m step:77 - global_seqlen/min:30309 - global_seqlen/max:38017 - global_seqlen/minmax_diff:7708 - global_seqlen/balanced_min:32840 - global_seqlen/balanced_max:32841 - global_seqlen/mean:32840.25 - actor/entropy:0.38041865825653076 - actor/kl_loss:0.13593437783420087 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08401155173778534 - actor/pg_clipfrac:0.002333978097885847 - actor/ppo_kl:0.00031578655471093954 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.5886697471141815 - perf/mfu/actor:0.09638266719646016 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.7102279663086 - actor/lr:1e-06 - training/global_step:77 - training/epoch:2 - critic/score/mean:1.423437476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.423437476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01648152992129326 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01648152992129326 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:412.1468811035156 - response_length/max:1305.0 - response_length/min:111.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4234375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.538047015666962e-05 - timing_s/generate_sequences:35.70492172241211 - timing_s/reshard:0.6648081541061401 - timing_s/gen:42.993955098092556 - timing_s/reward:0.07993571646511555 - timing_s/old_log_prob:1.216183042153716 - timing_s/ref:1.3812614846974611 - timing_s/adv:0.0077060312032699585 - timing_s/update_actor:7.307777106761932 - timing_s/step:53.00248706899583 - timing_s/stop_profile:4.631653428077698e-05 - timing_per_token_ms/adv:2.933150327444964e-05 - timing_per_token_ms/gen:0.3259908489698951 - timing_per_token_ms/ref:0.00525750216844216 - timing_per_token_ms/update_actor:0.027815626809943334 - perf/total_num_tokens:262722 - perf/time_per_step:53.00248706899583 - perf/throughput:619.5982833267861
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4328124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4328124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.015409708023071289, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.015409708023071289, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 409.74688720703125, 'response_length/max': 1399.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4328125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:78 - global_seqlen/min:30511 - global_seqlen/max:35523 - global_seqlen/minmax_diff:5012 - global_seqlen/balanced_min:32779 - global_seqlen/balanced_max:32780 - global_seqlen/mean:32779.25 - actor/entropy:0.3864273130893707 - actor/kl_loss:0.11345691345632077 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1367897748015821 - actor/pg_clipfrac:0.00196524191997014 - actor/ppo_kl:-0.002062592653965112 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.656546950340271 - perf/mfu/actor:0.09675590945713254 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.69614791870117 - actor/lr:1e-06 - training/global_step:78 - training/epoch:2 - critic/score/mean:1.4328124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4328124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.015409708023071289 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.015409708023071289 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:409.74688720703125 - response_length/max:1399.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4328125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.670481085777283e-05 - timing_s/generate_sequences:38.92552947998047 - timing_s/reshard:0.6588958501815796 - timing_s/gen:45.9480372723192 - timing_s/reward:0.08057321421802044 - timing_s/old_log_prob:1.3179643973708153 - timing_s/ref:1.3762584067881107 - timing_s/adv:0.008120428770780563 - timing_s/update_actor:7.265453411266208 - timing_s/step:56.01226967014372 - timing_s/stop_profile:4.531256854534149e-05 - timing_per_token_ms/adv:3.0966345976420156e-05 - timing_per_token_ms/gen:0.35043004654031223 - timing_per_token_ms/ref:0.005248207352166808 - timing_per_token_ms/update_actor:0.027705993163610394 - perf/total_num_tokens:262234 - perf/time_per_step:56.01226967014372 - perf/throughput:585.2155285446745
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4796874523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4796874523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02549007721245289, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.02549007721245289, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 420.703125, 'response_length/max': 1896.0, 'response_length/min': 95.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  15%|█▌        | 79/525 [1:19:57<7:27:36, 60.22s/it]
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 01:00:41,144:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 01:00:44,795:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 01:00:44,759:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:00:45,370:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/huggingface
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:00:41,454:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  15%|█▌        | 80/525 [1:21:00<7:33:03, 61.09s/it]
[36m(TaskRunner pid=2949575)[0m step:79 - global_seqlen/min:29136 - global_seqlen/max:37137 - global_seqlen/minmax_diff:8001 - global_seqlen/balanced_min:33174 - global_seqlen/balanced_max:33474 - global_seqlen/mean:33213.125 - actor/entropy:0.33448341488838196 - actor/kl_loss:0.21055065039545298 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15600545853376388 - actor/pg_clipfrac:0.013887276349123567 - actor/ppo_kl:0.014439491009397898 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5484563112258911 - perf/mfu/actor:0.09511277094882585 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.94651794433594 - actor/lr:1e-06 - training/global_step:79 - training/epoch:2 - critic/score/mean:1.4796874523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4796874523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02549007721245289 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02549007721245289 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:420.703125 - response_length/max:1896.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.849108755588531e-05 - timing_s/generate_sequences:41.091129302978516 - timing_s/reshard:0.6829208731651306 - timing_s/gen:60.20293977856636 - timing_s/reward:0.08040536381304264 - timing_s/old_log_prob:1.2052576430141926 - timing_s/ref:1.407248755916953 - timing_s/adv:0.007787548005580902 - timing_s/update_actor:7.496709233149886 - timing_s/step:70.41568730212748 - timing_s/stop_profile:4.446879029273987e-05 - timing_per_token_ms/adv:2.930900060435785e-05 - timing_per_token_ms/gen:0.44718989621962013 - timing_per_token_ms/ref:0.005296282553647666 - timing_per_token_ms/update_actor:0.028214407832558235 - perf/total_num_tokens:265705 - perf/time_per_step:70.41568730212748 - perf/throughput:471.6722405547908
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.390625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.390625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04330626130104065, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.04330626130104065, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 381.9624938964844, 'response_length/max': 1393.0, 'response_length/min': 98.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:80 - global_seqlen/min:27516 - global_seqlen/max:34808 - global_seqlen/minmax_diff:7292 - global_seqlen/balanced_min:31663 - global_seqlen/balanced_max:31664 - global_seqlen/mean:31663.5 - actor/entropy:0.3714520037174225 - actor/kl_loss:0.20933629833161832 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.15418292954564095 - actor/pg_clipfrac:0.0027118101192172618 - actor/ppo_kl:-0.00011614073446253315 - actor/pg_clipfrac_lower:0.00011160714784637093 - actor/grad_norm:3.6321945190429688 - perf/mfu/actor:0.0938103539803151 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.77687072753906 - actor/lr:1e-06 - training/global_step:80 - training/epoch:2 - critic/score/mean:1.390625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.390625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04330626130104065 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04330626130104065 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:381.9624938964844 - response_length/max:1393.0 - response_length/min:98.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.277595043182373e-05 - timing_s/generate_sequences:34.95209503173828 - timing_s/reshard:0.7837463617324829 - timing_s/gen:44.95577193796635 - timing_s/reward:0.07787294313311577 - timing_s/old_log_prob:1.1975689083337784 - timing_s/ref:1.4006618205457926 - timing_s/adv:0.011541258543729782 - timing_s/update_actor:7.2381921000778675 - timing_s/save_checkpoint:8.192571872845292 - timing_s/step:63.09667163155973 - timing_s/stop_profile:5.1412731409072876e-05 - timing_per_token_ms/adv:4.5562155730295855e-05 - timing_per_token_ms/gen:0.36780256518937027 - timing_per_token_ms/ref:0.005529481187115261 - timing_per_token_ms/update_actor:0.028574668388198825 - perf/total_num_tokens:253308 - perf/time_per_step:63.09667163155973 - perf/throughput:501.8252022054763
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3515625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3515625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.019292347133159637, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.019292347133159637, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 388.46563720703125, 'response_length/max': 1085.0, 'response_length/min': 62.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  15%|█▌        | 81/525 [1:21:46<6:58:58, 56.62s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:00:46,509:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:00:46,512:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_80/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  16%|█▌        | 82/525 [1:22:50<7:14:30, 58.85s/it]
[36m(TaskRunner pid=2949575)[0m step:81 - global_seqlen/min:29094 - global_seqlen/max:34779 - global_seqlen/minmax_diff:5685 - global_seqlen/balanced_min:31928 - global_seqlen/balanced_max:31928 - global_seqlen/mean:31928.0 - actor/entropy:0.4111524820327759 - actor/kl_loss:0.1690070416778326 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12668911069631578 - actor/pg_clipfrac:0.00998982782184612 - actor/ppo_kl:-0.006954015150404303 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.195328861474991 - perf/mfu/actor:0.0930930884069162 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.55630874633789 - actor/lr:1e-06 - training/global_step:81 - training/epoch:2 - critic/score/mean:1.3515625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3515625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.019292347133159637 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.019292347133159637 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:388.46563720703125 - response_length/max:1085.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.203275501728058e-05 - timing_s/generate_sequences:31.911104202270508 - timing_s/reshard:0.6799618005752563 - timing_s/gen:36.22080124542117 - timing_s/reward:0.07902607508003712 - timing_s/old_log_prob:1.140446437522769 - timing_s/ref:1.3622873704880476 - timing_s/adv:0.007993604987859726 - timing_s/update_actor:7.34705575928092 - timing_s/step:46.174101362004876 - timing_s/stop_profile:4.448741674423218e-05 - timing_per_token_ms/adv:3.129543421080136e-05 - timing_per_token_ms/gen:0.2913771428088165 - timing_per_token_ms/ref:0.005333435270327172 - timing_per_token_ms/update_actor:0.028764155910489697 - perf/total_num_tokens:255424 - perf/time_per_step:46.174101362004876 - perf/throughput:691.4698728987606
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00044792008702643216, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.00044792008702643216, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 370.1343688964844, 'response_length/max': 1699.0, 'response_length/min': 98.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:82 - global_seqlen/min:28333 - global_seqlen/max:36005 - global_seqlen/minmax_diff:7672 - global_seqlen/balanced_min:31130 - global_seqlen/balanced_max:31397 - global_seqlen/mean:31194.75 - actor/entropy:0.371381938457489 - actor/kl_loss:0.2210305804386735 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.022365780919790267 - actor/pg_clipfrac:0.004232912277802825 - actor/ppo_kl:0.008906172635033727 - actor/pg_clipfrac_lower:9.433962404727935e-05 - actor/grad_norm:3.664057046175003 - perf/mfu/actor:0.09261429953208877 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.53816986083984 - actor/lr:1e-06 - training/global_step:82 - training/epoch:2 - critic/score/mean:1.4375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00044792008702643216 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.00044792008702643216 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:370.1343688964844 - response_length/max:1699.0 - response_length/min:98.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.469261229038239e-05 - timing_s/generate_sequences:33.45055389404297 - timing_s/reshard:0.7583056688308716 - timing_s/gen:54.190419517457485 - timing_s/reward:0.07710963301360607 - timing_s/old_log_prob:1.1701280903071165 - timing_s/ref:1.364775612950325 - timing_s/adv:0.007765095680952072 - timing_s/update_actor:7.213118351995945 - timing_s/step:64.03913218528032 - timing_s/stop_profile:4.641897976398468e-05 - timing_per_token_ms/adv:3.111539474171164e-05 - timing_per_token_ms/gen:0.45752319273792025 - timing_per_token_ms/ref:0.005468771239352475 - timing_per_token_ms/update_actor:0.02890357492845729 - perf/total_num_tokens:249558 - perf/time_per_step:64.03913218528032 - perf/throughput:487.120123829071
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3312499523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3312499523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.011705073527991772, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.011705073527991772, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 402.3656311035156, 'response_length/max': 1229.0, 'response_length/min': 94.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.33125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  16%|█▌        | 83/525 [1:23:41<6:55:04, 56.34s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  16%|█▌        | 84/525 [1:24:47<7:16:54, 59.44s/it]
[36m(TaskRunner pid=2949575)[0m step:83 - global_seqlen/min:29549 - global_seqlen/max:37676 - global_seqlen/minmax_diff:8127 - global_seqlen/balanced_min:32492 - global_seqlen/balanced_max:32493 - global_seqlen/mean:32492.75 - actor/entropy:0.394709050655365 - actor/kl_loss:0.17494250945746898 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.2031671278178692 - actor/pg_clipfrac:0.004275281447917223 - actor/ppo_kl:-0.0008408586501900573 - actor/pg_clipfrac_lower:8.904719725251198e-05 - actor/grad_norm:7.5174203515052795 - perf/mfu/actor:0.09145920139224206 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.55555725097656 - actor/lr:1e-06 - training/global_step:83 - training/epoch:2 - critic/score/mean:1.3312499523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3312499523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.011705073527991772 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.011705073527991772 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:402.3656311035156 - response_length/max:1229.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.33125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.096545934677124e-05 - timing_s/generate_sequences:35.8382682800293 - timing_s/reshard:0.6407731175422668 - timing_s/gen:40.21726703830063 - timing_s/reward:0.07953100651502609 - timing_s/old_log_prob:1.1857131626456976 - timing_s/ref:1.3658503219485283 - timing_s/adv:0.007916372269392014 - timing_s/update_actor:7.613821282982826 - timing_s/step:50.486143277958035 - timing_s/stop_profile:4.629790782928467e-05 - timing_per_token_ms/adv:3.0454379320740833e-05 - timing_per_token_ms/gen:0.31235014048401744 - timing_per_token_ms/ref:0.005254442613923599 - timing_per_token_ms/update_actor:0.02929046203761926 - perf/total_num_tokens:259942 - perf/time_per_step:50.486143277958035 - perf/throughput:643.5973891114426
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.540624976158142, 'critic/score/max': 2.0, 'critic/score/min': 1.0, 'critic/rewards/mean': 1.540624976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': 1.0, 'critic/advantages/mean': -0.011010582558810711, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.011010582558810711, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 376.12188720703125, 'response_length/max': 1821.0, 'response_length/min': 105.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.540625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:84 - global_seqlen/min:28541 - global_seqlen/max:35034 - global_seqlen/minmax_diff:6493 - global_seqlen/balanced_min:31318 - global_seqlen/balanced_max:31808 - global_seqlen/mean:31416.75 - actor/entropy:0.4261409342288971 - actor/kl_loss:0.2452205592766404 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0545355380512774 - actor/pg_clipfrac:0.010636786767281591 - actor/ppo_kl:0.010325315175577998 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.693763643503189 - perf/mfu/actor:0.0946674012495554 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.59811782836914 - actor/lr:1e-06 - training/global_step:84 - training/epoch:2 - critic/score/mean:1.540624976158142 - critic/score/max:2.0 - critic/score/min:1.0 - critic/rewards/mean:1.540624976158142 - critic/rewards/max:2.0 - critic/rewards/min:1.0 - critic/advantages/mean:-0.011010582558810711 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.011010582558810711 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:376.12188720703125 - response_length/max:1821.0 - response_length/min:105.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.540625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.822286665439606e-05 - timing_s/generate_sequences:35.216522216796875 - timing_s/reshard:0.7818360924720764 - timing_s/gen:56.8312881346792 - timing_s/reward:0.07945088855922222 - timing_s/old_log_prob:1.1382011342793703 - timing_s/ref:1.3651279602199793 - timing_s/adv:0.00788690336048603 - timing_s/update_actor:7.10572355799377 - timing_s/step:66.54257385805249 - timing_s/stop_profile:4.4226646423339844e-05 - timing_per_token_ms/adv:3.138016886090235e-05 - timing_per_token_ms/gen:0.4721814582596997 - timing_per_token_ms/ref:0.005431529201063045 - timing_per_token_ms/update_actor:0.028272034655055702 - perf/total_num_tokens:251334 - perf/time_per_step:66.54257385805249 - perf/throughput:472.13006919476373
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3703124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3703124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.014626824297010899, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.014626824297010899, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 370.9468688964844, 'response_length/max': 1180.0, 'response_length/min': 79.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  16%|█▌        | 85/525 [1:25:37<6:54:20, 56.50s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  16%|█▋        | 86/525 [1:26:32<6:50:46, 56.14s/it]
[36m(TaskRunner pid=2949575)[0m step:85 - global_seqlen/min:28981 - global_seqlen/max:35523 - global_seqlen/minmax_diff:6542 - global_seqlen/balanced_min:31240 - global_seqlen/balanced_max:31241 - global_seqlen/mean:31240.375 - actor/entropy:0.39827093482017517 - actor/kl_loss:0.1292508713901043 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.008218241482973098 - actor/pg_clipfrac:0.0017660968005657196 - actor/ppo_kl:-0.005729299402446486 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:9.059441924095154 - perf/mfu/actor:0.09349183933334773 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.61178970336914 - actor/lr:1e-06 - training/global_step:85 - training/epoch:2 - critic/score/mean:1.3703124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3703124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.014626824297010899 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.014626824297010899 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:370.9468688964844 - response_length/max:1180.0 - response_length/min:79.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010054558515548706 - timing_s/generate_sequences:36.2088737487793 - timing_s/reshard:0.6570100784301758 - timing_s/gen:39.66879162751138 - timing_s/reward:0.07728168740868568 - timing_s/old_log_prob:1.184939295053482 - timing_s/ref:1.389602331444621 - timing_s/adv:0.007871564477682114 - timing_s/update_actor:7.155248820781708 - timing_s/step:49.499763417989016 - timing_s/stop_profile:4.514865577220917e-05 - timing_per_token_ms/adv:3.149595866599758e-05 - timing_per_token_ms/gen:0.3341852491302779 - timing_per_token_ms/ref:0.005560121843306223 - timing_per_token_ms/update_actor:0.02862981326561264 - perf/total_num_tokens:249923 - perf/time_per_step:49.499763417989016 - perf/throughput:631.1217032735705
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4609375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4609375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.006290788296610117, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.006290788296610117, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 409.09686279296875, 'response_length/max': 1401.0, 'response_length/min': 116.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4609375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:86 - global_seqlen/min:30169 - global_seqlen/max:36505 - global_seqlen/minmax_diff:6336 - global_seqlen/balanced_min:32718 - global_seqlen/balanced_max:32719 - global_seqlen/mean:32718.25 - actor/entropy:0.3860001862049103 - actor/kl_loss:0.17754167541861535 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05983252511359751 - actor/pg_clipfrac:0.002830500982236117 - actor/ppo_kl:0.0021196968964432017 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.386776864528656 - perf/mfu/actor:0.09520702858414576 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.78612899780273 - actor/lr:1e-06 - training/global_step:86 - training/epoch:2 - critic/score/mean:1.4609375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4609375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.006290788296610117 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.006290788296610117 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:409.09686279296875 - response_length/max:1401.0 - response_length/min:116.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4609375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0001028887927532196 - timing_s/generate_sequences:39.85249710083008 - timing_s/reshard:0.660253643989563 - timing_s/gen:45.15378162264824 - timing_s/reward:0.07966345176100731 - timing_s/old_log_prob:1.184562074020505 - timing_s/ref:1.3657711613923311 - timing_s/adv:0.007695142179727554 - timing_s/update_actor:7.369458677247167 - timing_s/step:55.17585217021406 - timing_s/stop_profile:4.2889267206192017e-05 - timing_per_token_ms/adv:2.9399273263880075e-05 - timing_per_token_ms/gen:0.344919690649741 - timing_per_token_ms/ref:0.005217925627869504 - timing_per_token_ms/update_actor:0.02815500018050769 - perf/total_num_tokens:261746 - perf/time_per_step:55.17585217021406 - perf/throughput:592.9813263067736
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4171874523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4171874523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02763781137764454, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.02763781137764454, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 396.1468811035156, 'response_length/max': 1454.0, 'response_length/min': 56.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4171875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  17%|█▋        | 87/525 [1:27:29<6:51:45, 56.41s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  17%|█▋        | 88/525 [1:28:18<6:34:11, 54.12s/it]
[36m(TaskRunner pid=2949575)[0m step:87 - global_seqlen/min:28673 - global_seqlen/max:35743 - global_seqlen/minmax_diff:7070 - global_seqlen/balanced_min:32213 - global_seqlen/balanced_max:32214 - global_seqlen/mean:32213.375 - actor/entropy:0.4106735289096832 - actor/kl_loss:0.38396048098802565 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0891665942966938 - actor/pg_clipfrac:0.002912656165426597 - actor/ppo_kl:0.012367203561734642 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.636221051216125 - perf/mfu/actor:0.09597364497388373 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.97689437866211 - actor/lr:1e-06 - training/global_step:87 - training/epoch:2 - critic/score/mean:1.4171874523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4171874523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02763781137764454 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02763781137764454 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:396.1468811035156 - response_length/max:1454.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4171875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010922737419605255 - timing_s/generate_sequences:39.54876708984375 - timing_s/reshard:0.7859517931938171 - timing_s/gen:46.54583614319563 - timing_s/reward:0.07898955792188644 - timing_s/old_log_prob:1.1723535247147083 - timing_s/ref:1.361654071137309 - timing_s/adv:0.007696527987718582 - timing_s/update_actor:7.195778347551823 - timing_s/step:56.376512913033366 - timing_s/stop_profile:4.437193274497986e-05 - timing_per_token_ms/adv:2.9865420759694467e-05 - timing_per_token_ms/gen:0.3671762851782848 - timing_per_token_ms/ref:0.005283729472374864 - timing_per_token_ms/update_actor:0.02792232398635591 - perf/total_num_tokens:257707 - perf/time_per_step:56.376512913033366 - perf/throughput:571.397082499453
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.451562523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.451562523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02589091844856739, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.02589091844856739, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 413.2406311035156, 'response_length/max': 1156.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:88 - global_seqlen/min:30199 - global_seqlen/max:36173 - global_seqlen/minmax_diff:5974 - global_seqlen/balanced_min:32879 - global_seqlen/balanced_max:32880 - global_seqlen/mean:32879.625 - actor/entropy:0.3801821768283844 - actor/kl_loss:0.26661539897322656 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05224677138030529 - actor/pg_clipfrac:0.00799460633425042 - actor/ppo_kl:0.0057740513137105156 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.346121549606323 - perf/mfu/actor:0.09686744383747665 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.97657775878906 - actor/lr:1e-06 - training/global_step:88 - training/epoch:2 - critic/score/mean:1.451562523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.451562523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02589091844856739 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02589091844856739 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:413.2406311035156 - response_length/max:1156.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.375942707061768e-05 - timing_s/generate_sequences:33.94774627685547 - timing_s/reshard:0.686630129814148 - timing_s/gen:38.840682877227664 - timing_s/reward:0.08015978522598743 - timing_s/old_log_prob:1.1829912420362234 - timing_s/ref:1.3635775931179523 - timing_s/adv:0.010776173323392868 - timing_s/update_actor:7.2843969874084 - timing_s/step:48.785070296376944 - timing_s/stop_profile:4.325993359088898e-05 - timing_per_token_ms/adv:4.0968279456475205e-05 - timing_per_token_ms/gen:0.2937202362215391 - timing_per_token_ms/ref:0.005183976372593788 - timing_per_token_ms/update_actor:0.027693430914313956 - perf/total_num_tokens:263037 - perf/time_per_step:48.785070296376944 - perf/throughput:673.968999127215
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.404687523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.404687523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.008226197212934494, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.008226197212934494, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 383.10626220703125, 'response_length/max': 1030.0, 'response_length/min': 68.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  17%|█▋        | 89/525 [1:29:03<6:14:01, 51.47s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 01:09:41,232:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 01:09:44,766:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 01:09:44,769:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:09:46,235:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  17%|█▋        | 90/525 [1:30:00<6:24:12, 52.99s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:09:41,689:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:89 - global_seqlen/min:26958 - global_seqlen/max:34425 - global_seqlen/minmax_diff:7467 - global_seqlen/balanced_min:31704 - global_seqlen/balanced_max:31705 - global_seqlen/mean:31704.875 - actor/entropy:0.41938284039497375 - actor/kl_loss:0.282249148376286 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02220810651779175 - actor/pg_clipfrac:0.0032693306799046694 - actor/ppo_kl:0.02189990401384421 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:5.524650275707245 - perf/mfu/actor:0.09553247290349172 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.87705993652344 - actor/lr:1e-06 - training/global_step:89 - training/epoch:2 - critic/score/mean:1.404687523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.404687523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.008226197212934494 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.008226197212934494 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:383.10626220703125 - response_length/max:1030.0 - response_length/min:68.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.53613018989563e-05 - timing_s/generate_sequences:32.56446075439453 - timing_s/reshard:0.8505235314369202 - timing_s/gen:35.5207282230258 - timing_s/reward:0.07858878560364246 - timing_s/old_log_prob:1.1696418412029743 - timing_s/ref:1.3627972230315208 - timing_s/adv:0.007852546870708466 - timing_s/update_actor:7.109432749450207 - timing_s/step:45.26364615187049 - timing_s/stop_profile:4.635937511920929e-05 - timing_per_token_ms/adv:3.095954041258823e-05 - timing_per_token_ms/gen:0.2897427951043754 - timing_per_token_ms/ref:0.005372979798183721 - timing_per_token_ms/update_actor:0.028029730244363865 - perf/total_num_tokens:253639 - perf/time_per_step:45.26364615187049 - perf/throughput:700.4489849010941
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.443750023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.443750023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.016662826761603355, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.016662826761603355, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 385.75, 'response_length/max': 1194.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.44375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:90 - global_seqlen/min:26469 - global_seqlen/max:37937 - global_seqlen/minmax_diff:11468 - global_seqlen/balanced_min:31832 - global_seqlen/balanced_max:31833 - global_seqlen/mean:31832.5 - actor/entropy:0.4107416868209839 - actor/kl_loss:0.19093422833830118 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03611496053636074 - actor/pg_clipfrac:0.003585413034306839 - actor/ppo_kl:0.007155073300236836 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:5.731878370046616 - perf/mfu/actor:0.09492389001916687 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.86236953735352 - actor/lr:1e-06 - training/global_step:90 - training/epoch:2 - critic/score/mean:1.443750023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.443750023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.016662826761603355 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.016662826761603355 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:385.75 - response_length/max:1194.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.44375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.48621129989624e-05 - timing_s/generate_sequences:31.664043426513672 - timing_s/reshard:0.6520102024078369 - timing_s/gen:38.79325591959059 - timing_s/reward:0.07900105975568295 - timing_s/old_log_prob:1.160818513482809 - timing_s/ref:1.3710817340761423 - timing_s/adv:0.007808685302734375 - timing_s/update_actor:7.182696437463164 - timing_s/save_checkpoint:7.923087118193507 - timing_s/step:56.53390207886696 - timing_s/stop_profile:5.379505455493927e-05 - timing_per_token_ms/adv:3.0663179544233e-05 - timing_per_token_ms/gen:0.31426811341210786 - timing_per_token_ms/ref:0.005383969740344547 - timing_per_token_ms/update_actor:0.028205043734638988 - perf/total_num_tokens:254660 - perf/time_per_step:56.53390207886696 - perf/throughput:563.0692173979508
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3046875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3046875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01316077820956707, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.01316077820956707, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 429.88751220703125, 'response_length/max': 1977.0, 'response_length/min': 96.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  17%|█▋        | 91/525 [1:31:11<7:02:58, 58.48s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:09:46,524:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:09:46,526:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_90/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  18%|█▊        | 92/525 [1:31:59<6:38:49, 55.26s/it]
[36m(TaskRunner pid=2949575)[0m step:91 - global_seqlen/min:30868 - global_seqlen/max:36830 - global_seqlen/minmax_diff:5962 - global_seqlen/balanced_min:33580 - global_seqlen/balanced_max:33693 - global_seqlen/mean:33602.375 - actor/entropy:0.36711588501930237 - actor/kl_loss:0.38875217642635107 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1506946850568056 - actor/pg_clipfrac:0.009627309930510818 - actor/ppo_kl:0.002684831079568539 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:5.669106543064117 - perf/mfu/actor:0.09843685821078316 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.75029754638672 - actor/lr:1e-06 - training/global_step:91 - training/epoch:2 - critic/score/mean:1.3046875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3046875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01316077820956707 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01316077820956707 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:429.88751220703125 - response_length/max:1977.0 - response_length/min:96.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.695945143699646e-05 - timing_s/generate_sequences:45.34197235107422 - timing_s/reshard:0.6895047426223755 - timing_s/gen:61.20616804808378 - timing_s/reward:0.08183930814266205 - timing_s/old_log_prob:1.2368714455515146 - timing_s/ref:1.371638109907508 - timing_s/adv:0.007951298728585243 - timing_s/update_actor:7.332702483981848 - timing_s/step:71.25151085294783 - timing_s/stop_profile:4.6292319893836975e-05 - timing_per_token_ms/adv:2.957863368506409e-05 - timing_per_token_ms/gen:0.4449286735489211 - timing_per_token_ms/ref:0.005102459684425237 - timing_per_token_ms/update_actor:0.027277471026906013 - perf/total_num_tokens:268819 - perf/time_per_step:71.25151085294783 - perf/throughput:471.6022803972555
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.34375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.34375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.017504220828413963, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.017504220828413963, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 360.98748779296875, 'response_length/max': 1141.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.34375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:92 - global_seqlen/min:29237 - global_seqlen/max:32074 - global_seqlen/minmax_diff:2837 - global_seqlen/balanced_min:30824 - global_seqlen/balanced_max:30825 - global_seqlen/mean:30824.5 - actor/entropy:0.425111323595047 - actor/kl_loss:0.2694904498755932 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.19612441658973695 - actor/pg_clipfrac:0.0029282265750225633 - actor/ppo_kl:0.010242658780771307 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:9.227245450019836 - perf/mfu/actor:0.09154505500103688 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.72069931030273 - actor/lr:1e-06 - training/global_step:92 - training/epoch:2 - critic/score/mean:1.34375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.34375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.017504220828413963 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.017504220828413963 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:360.98748779296875 - response_length/max:1141.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.34375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.87127423286438e-05 - timing_s/generate_sequences:30.13062286376953 - timing_s/reshard:0.74376380443573 - timing_s/gen:37.867480769753456 - timing_s/reward:0.07602082192897797 - timing_s/old_log_prob:1.1133877765387297 - timing_s/ref:1.3645461238920689 - timing_s/adv:0.007945345714688301 - timing_s/update_actor:7.198245307430625 - timing_s/step:47.64256536401808 - timing_s/stop_profile:4.457123577594757e-05 - timing_per_token_ms/adv:3.222009162633742e-05 - timing_per_token_ms/gen:0.3278115652355817 - timing_per_token_ms/ref:0.005533529026797146 - timing_per_token_ms/update_actor:0.029190438236754143 - perf/total_num_tokens:246596 - perf/time_per_step:47.64256536401808 - perf/throughput:646.9949668848042
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4015624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4015624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.032336246222257614, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.032336246222257614, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 374.984375, 'response_length/max': 1128.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4015625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  18%|█▊        | 93/525 [1:32:47<6:22:28, 53.12s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  18%|█▊        | 94/525 [1:33:49<6:41:05, 55.84s/it]
[36m(TaskRunner pid=2949575)[0m step:93 - global_seqlen/min:27895 - global_seqlen/max:33938 - global_seqlen/minmax_diff:6043 - global_seqlen/balanced_min:31397 - global_seqlen/balanced_max:31398 - global_seqlen/mean:31397.5 - actor/entropy:0.40557968616485596 - actor/kl_loss:0.2011395089328289 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12651740126311778 - actor/pg_clipfrac:0.0039128038595663385 - actor/ppo_kl:-0.0036970783716242296 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.553353428840637 - perf/mfu/actor:0.09058638542446396 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:93.689453125 - perf/cpu_memory_used_gb:96.71578216552734 - actor/lr:1e-06 - training/global_step:93 - training/epoch:2 - critic/score/mean:1.4015624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4015624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.032336246222257614 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.032336246222257614 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:374.984375 - response_length/max:1128.0 - response_length/min:99.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4015625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010173581540584564 - timing_s/generate_sequences:31.80455780029297 - timing_s/reshard:0.7127187848091125 - timing_s/gen:37.96604268066585 - timing_s/reward:0.07908990792930126 - timing_s/old_log_prob:1.1379963085055351 - timing_s/ref:1.363633867353201 - timing_s/adv:0.007819585502147675 - timing_s/update_actor:7.4203728325665 - timing_s/step:47.99023452587426 - timing_s/stop_profile:4.654936492443085e-05 - timing_per_token_ms/adv:3.113140179213184e-05 - timing_per_token_ms/gen:0.31639687220855744 - timing_per_token_ms/ref:0.0054289110094482085 - timing_per_token_ms/update_actor:0.029542052840857154 - perf/total_num_tokens:251180 - perf/time_per_step:47.99023452587426 - perf/throughput:654.2476883098337
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.365625023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.365625023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.002943608444184065, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.002943608444184065, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 401.39373779296875, 'response_length/max': 1616.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.365625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:94 - global_seqlen/min:28150 - global_seqlen/max:36731 - global_seqlen/minmax_diff:8581 - global_seqlen/balanced_min:32445 - global_seqlen/balanced_max:32446 - global_seqlen/mean:32445.125 - actor/entropy:0.40240299701690674 - actor/kl_loss:0.5289805484935641 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.010329271107912064 - actor/pg_clipfrac:0.008382720395457 - actor/ppo_kl:-0.004893957025342388 - actor/pg_clipfrac_lower:4.248088225722313e-05 - actor/grad_norm:10.61070990562439 - perf/mfu/actor:0.09242648926069277 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.71035766601562 - actor/lr:1e-06 - training/global_step:94 - training/epoch:2 - critic/score/mean:1.365625023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.365625023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.002943608444184065 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.002943608444184065 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:401.39373779296875 - response_length/max:1616.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.365625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.788759052753448e-05 - timing_s/generate_sequences:37.724666595458984 - timing_s/reshard:0.7471749782562256 - timing_s/gen:51.8278243355453 - timing_s/reward:0.07983801513910294 - timing_s/old_log_prob:1.2022836916148663 - timing_s/ref:1.389292422682047 - timing_s/adv:0.007891291752457619 - timing_s/update_actor:7.528016693890095 - timing_s/step:62.0508426874876 - timing_s/stop_profile:4.29302453994751e-05 - timing_per_token_ms/adv:3.040245550162628e-05 - timing_per_token_ms/gen:0.40349893601626596 - timing_per_token_ms/ref:0.005352469834382079 - timing_per_token_ms/update_actor:0.029002880609529533 - perf/total_num_tokens:259561 - perf/time_per_step:62.0508426874876 - perf/throughput:522.8796837362288
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2843749523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2843749523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02006295695900917, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.02006295695900917, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 413.703125, 'response_length/max': 1692.0, 'response_length/min': 60.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.284375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  18%|█▊        | 95/525 [1:34:53<6:57:21, 58.24s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  18%|█▊        | 96/525 [1:35:39<6:30:51, 54.67s/it]
[36m(TaskRunner pid=2949575)[0m step:95 - global_seqlen/min:29499 - global_seqlen/max:36709 - global_seqlen/minmax_diff:7210 - global_seqlen/balanced_min:32924 - global_seqlen/balanced_max:32954 - global_seqlen/mean:32928.75 - actor/entropy:0.381560742855072 - actor/kl_loss:0.43193499110639094 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.028633184358477594 - actor/pg_clipfrac:0.009989079629303888 - actor/ppo_kl:0.0014167320485285017 - actor/pg_clipfrac_lower:8.761821372900158e-05 - actor/grad_norm:20.441219806671143 - perf/mfu/actor:0.09827788992650835 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.86931610107422 - actor/lr:1e-06 - training/global_step:95 - training/epoch:2 - critic/score/mean:1.2843749523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2843749523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02006295695900917 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02006295695900917 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:413.703125 - response_length/max:1692.0 - response_length/min:60.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.284375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0001057945191860199 - timing_s/generate_sequences:38.0297966003418 - timing_s/reshard:0.787488579750061 - timing_s/gen:53.351497976109385 - timing_s/reward:0.0802333801984787 - timing_s/old_log_prob:1.2291664332151413 - timing_s/ref:1.3760192207992077 - timing_s/adv:0.007752068340778351 - timing_s/update_actor:7.190467916429043 - timing_s/step:63.24961590394378 - timing_s/stop_profile:4.575587809085846e-05 - timing_per_token_ms/adv:2.9427431730548346e-05 - timing_per_token_ms/gen:0.40300259074751205 - timing_per_token_ms/ref:0.005223471969021022 - timing_per_token_ms/update_actor:0.027295554479098975 - perf/total_num_tokens:263430 - perf/time_per_step:63.24961590394378 - perf/throughput:520.6158097467088
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.384374976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.384374976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.010798669420182705, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.010798669420182705, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 315.85626220703125, 'response_length/max': 1125.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.384375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:96 - global_seqlen/min:26194 - global_seqlen/max:30657 - global_seqlen/minmax_diff:4463 - global_seqlen/balanced_min:29019 - global_seqlen/balanced_max:29049 - global_seqlen/mean:29023.625 - actor/entropy:0.46210017800331116 - actor/kl_loss:0.26025576163083314 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.031389370746910575 - actor/pg_clipfrac:0.0021887936163693666 - actor/ppo_kl:0.001770325742836576 - actor/pg_clipfrac_lower:0.0001519756857305765 - actor/grad_norm:7.31088200211525 - perf/mfu/actor:0.08575765993219252 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.82427215576172 - actor/lr:1e-06 - training/global_step:96 - training/epoch:2 - critic/score/mean:1.384374976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.384374976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.010798669420182705 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.010798669420182705 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:315.85626220703125 - response_length/max:1125.0 - response_length/min:82.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.384375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.633174002170563e-05 - timing_s/generate_sequences:27.76325225830078 - timing_s/reshard:0.6397620439529419 - timing_s/gen:36.5145592354238 - timing_s/reward:0.07286614738404751 - timing_s/old_log_prob:1.117544325068593 - timing_s/ref:1.351551778614521 - timing_s/adv:0.007968507707118988 - timing_s/update_actor:7.224691113457084 - timing_s/step:46.32237568311393 - timing_s/stop_profile:4.703737795352936e-05 - timing_per_token_ms/adv:3.4319057781027475e-05 - timing_per_token_ms/gen:0.3612655998122544 - timing_per_token_ms/ref:0.005820912181948848 - timing_per_token_ms/update_actor:0.031115561518664035 - perf/total_num_tokens:232189 - perf/time_per_step:46.32237568311393 - perf/throughput:626.557350999165
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3671875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3671875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.009934981353580952, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.009934981353580952, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 415.6156311035156, 'response_length/max': 1129.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  18%|█▊        | 97/525 [1:36:27<6:14:58, 52.57s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  19%|█▊        | 98/525 [1:37:26<6:27:34, 54.46s/it]
[36m(TaskRunner pid=2949575)[0m step:97 - global_seqlen/min:30502 - global_seqlen/max:36156 - global_seqlen/minmax_diff:5654 - global_seqlen/balanced_min:33009 - global_seqlen/balanced_max:33010 - global_seqlen/mean:33009.625 - actor/entropy:0.35525888204574585 - actor/kl_loss:0.20507465191185476 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10291972607374192 - actor/pg_clipfrac:0.0021995940653141586 - actor/ppo_kl:-0.008085391942950082 - actor/pg_clipfrac_lower:0.00022246940061450006 - actor/grad_norm:9.006144344806671 - perf/mfu/actor:0.09841491200923068 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.80885696411133 - actor/lr:1e-06 - training/global_step:97 - training/epoch:2 - critic/score/mean:1.3671875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3671875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.009934981353580952 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.009934981353580952 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:415.6156311035156 - response_length/max:1129.0 - response_length/min:99.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.645094931125641e-05 - timing_s/generate_sequences:34.569358825683594 - timing_s/reshard:0.655325174331665 - timing_s/gen:37.812145506963134 - timing_s/reward:0.079547930508852 - timing_s/old_log_prob:1.1693191714584827 - timing_s/ref:1.3750351890921593 - timing_s/adv:0.007779933512210846 - timing_s/update_actor:7.193680765107274 - timing_s/step:47.65302238985896 - timing_s/stop_profile:4.462525248527527e-05 - timing_per_token_ms/adv:2.946085237340187e-05 - timing_per_token_ms/gen:0.28430825888526157 - timing_per_token_ms/ref:0.005206947932202196 - timing_per_token_ms/update_actor:0.027240845530308484 - perf/total_num_tokens:264077 - perf/time_per_step:47.65302238985896 - perf/throughput:692.7078985660472
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.350000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.350000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01372751034796238, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.01372751034796238, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 348.9750061035156, 'response_length/max': 1591.0, 'response_length/min': 47.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.35, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:98 - global_seqlen/min:28824 - global_seqlen/max:32603 - global_seqlen/minmax_diff:3779 - global_seqlen/balanced_min:30288 - global_seqlen/balanced_max:30731 - global_seqlen/mean:30344.0 - actor/entropy:0.4649873673915863 - actor/kl_loss:0.484187600761652 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13384181596338748 - actor/pg_clipfrac:0.01836077300249599 - actor/ppo_kl:0.05998873388416541 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.978124916553497 - perf/mfu/actor:0.09131620234040584 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.77987670898438 - actor/lr:1e-06 - training/global_step:98 - training/epoch:2 - critic/score/mean:1.350000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.350000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01372751034796238 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01372751034796238 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:348.9750061035156 - response_length/max:1591.0 - response_length/min:47.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.35 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.55661928653717e-05 - timing_s/generate_sequences:31.928565979003906 - timing_s/reshard:0.653311550617218 - timing_s/gen:49.09506922774017 - timing_s/reward:0.07663453556597233 - timing_s/old_log_prob:1.2061739768832922 - timing_s/ref:1.3592271842062473 - timing_s/adv:0.007969576865434647 - timing_s/update_actor:7.102747809141874 - timing_s/step:58.863547364249825 - timing_s/stop_profile:4.620105028152466e-05 - timing_per_token_ms/adv:3.283011825004386e-05 - timing_per_token_ms/gen:0.43963633881134184 - timing_per_token_ms/ref:0.005599241959721227 - timing_per_token_ms/update_actor:0.0292592761713266 - perf/total_num_tokens:242752 - perf/time_per_step:58.863547364249825 - perf/throughput:515.4973045071545
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.453125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.453125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.017896952107548714, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.017896952107548714, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 348.41876220703125, 'response_length/max': 1390.0, 'response_length/min': 75.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.453125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  19%|█▉        | 99/525 [1:38:19<6:24:05, 54.10s/it]
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 01:19:43,139:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/model_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 01:19:46,605:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 01:19:46,608:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:19:47,351:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/huggingface
[36m(TaskRunner pid=2949575)[0m step:99 - global_seqlen/min:27573 - global_seqlen/max:33924 - global_seqlen/minmax_diff:6351 - global_seqlen/balanced_min:30330 - global_seqlen/balanced_max:30331 - global_seqlen/mean:30330.5 - actor/entropy:0.43517160415649414 - actor/kl_loss:0.26893376726657153 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16767850704491138 - actor/pg_clipfrac:0.017136184161063283 - actor/ppo_kl:-0.035623083746759224 - actor/pg_clipfrac_lower:0.0025385800283402203 - actor/grad_norm:12.802013874053955 - perf/mfu/actor:0.0871561300342984 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.8057975769043 - actor/lr:1e-06 - training/global_step:99 - training/epoch:2 - critic/score/mean:1.453125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.453125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.017896952107548714 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.017896952107548714 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:348.41876220703125 - response_length/max:1390.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.453125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.319132030010223e-05 - timing_s/generate_sequences:36.20813751220703 - timing_s/reshard:0.6612954139709473 - timing_s/gen:43.212769117206335 - timing_s/reward:0.07525108195841312 - timing_s/old_log_prob:1.1306853536516428 - timing_s/ref:1.3581228163093328 - timing_s/adv:0.007853809744119644 - timing_s/update_actor:7.439003638923168 - timing_s/step:53.239196583628654 - timing_s/stop_profile:4.2593106627464294e-05 - timing_per_token_ms/adv:3.236762394338885e-05 - timing_per_token_ms/gen:0.3875793237053683 - timing_per_token_ms/ref:0.005597182771094001 - timing_per_token_ms/update_actor:0.030658098444318296 - perf/total_num_tokens:242644 - perf/time_per_step:53.239196583628654 - perf/throughput:569.7024362934657
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 100}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the semi-major axis. The foci of the hyperbola are at \((\pm c, 0)\) where \(c = \sqrt{2}a\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The equation of the parabola is \(y^2 = 16x\). The focus of this parabola is at \((4, 0)\) and the directrix is the line \(x = -4\). The hyperbola intersects the parabola at points \(A\) and \(B\), and the distance between these points is \(|AB| = 4\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Since the hyperbola and the parabola intersect at points that are symmetric with respect to the \(x\)-axis, let's assume the coordinates of \(A\) and \(B\) are \((x_1, y_1)\) and \((x_1, -y_1)\) respectively. The distance between these points is \(2|y_1| = 4\sqrt{3}\), so \(|y_1| = 2\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Substituting \(y_1 = 2\sqrt{3}\) into the equation of the parabola, we get:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m (2\sqrt{3})^2 = 16x_1 \implies 12 = 16x_1 \implies x_1 = \frac{12}{16} = \frac{3}{4}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m So, the coordinates of \(A\) and \(B\) are \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) respectively.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Now, we need to find the distance between the foci of the hyperbola, which is \(2c = 2\sqrt{2}a\). The distance between the points \(A\) and \(B\) is the same as the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\), which is \(4\sqrt{3}\). This distance is also the distance between the points \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, 0\right)\) or \(\left(\frac{3}{4}, 0\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\), which is \(2\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the foci is also the distance between \(\left(\frac{3}{4}, 0\right)\) and \(\left(\frac{3}{4}, 0\right)\), which is \(2\sqrt{2}a\). Therefore, we have:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m 2\sqrt{2}a = 4\sqrt{3} \implies a = \frac{4\sqrt{3}}{2\sqrt{2}} = \frac{4\sqrt{3}}{2\sqrt{2}} \cdot \frac{\sqrt{2}}{\sqrt{2}} = \frac{4\sqrt{6}}{4} = \sqrt{6}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m The real axis length of the hyperbola is \(2a = 2\sqrt{6}\), but we need to check the options provided. The correct option is \(2\sqrt{2}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Therefore, the real axis length of the hyperbola is \(2\sqrt{2}\).
[36m(TaskRunner pid=2949575)[0m </think>
[36m(TaskRunner pid=2949575)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] 1.0
[36m(TaskRunner pid=2949575)[0m [structure] 0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.5
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3828125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3828125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021838434040546417, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.021838434040546417, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 381.6343688964844, 'response_length/max': 1332.0, 'response_length/min': 94.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:100 - global_seqlen/min:28914 - global_seqlen/max:35260 - global_seqlen/minmax_diff:6346 - global_seqlen/balanced_min:31624 - global_seqlen/balanced_max:31625 - global_seqlen/mean:31624.125 - actor/entropy:0.4574492275714874 - actor/kl_loss:0.38136823251843455 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.21232500150799752 - actor/pg_clipfrac:0.006601644097827375 - actor/ppo_kl:0.01656547366292216 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:10.061970949172974 - perf/mfu/actor:0.09470374456398518 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.79907608032227 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:1.38 - val-aux/grpo_convert/reward/std@50:0.5026932219902319 - val-aux/grpo_convert/reward/best@2/mean:1.60975 - val-aux/grpo_convert/reward/best@2/std:0.41096791966181 - val-aux/grpo_convert/reward/worst@2/mean:1.159 - val-aux/grpo_convert/reward/worst@2/std:0.4931695595068142 - val-aux/grpo_convert/reward/best@4/mean:1.7755 - val-aux/grpo_convert/reward/best@4/std:0.30858865797254076 - val-aux/grpo_convert/reward/worst@4/mean:0.954 - val-aux/grpo_convert/reward/worst@4/std:0.4558933061540651 - val-aux/grpo_convert/reward/best@8/mean:1.9155 - val-aux/grpo_convert/reward/best@8/std:0.18737595897019446 - val-aux/grpo_convert/reward/worst@8/mean:0.8075 - val-aux/grpo_convert/reward/worst@8/std:0.41407430772789977 - val-aux/grpo_convert/reward/best@16/mean:1.982 - val-aux/grpo_convert/reward/best@16/std:0.09314504817756013 - val-aux/grpo_convert/reward/worst@16/mean:0.6509999999999999 - val-aux/grpo_convert/reward/worst@16/std:0.38993547605335405 - val-aux/grpo_convert/reward/best@32/mean:1.9995 - val-aux/grpo_convert/reward/best@32/std:0.015803480629279113 - val-aux/grpo_convert/reward/worst@32/mean:0.46525 - val-aux/grpo_convert/reward/worst@32/std:0.339271185779164 - val-aux/grpo_convert/reward/best@50/mean:2.0 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:0.361 - val-aux/grpo_convert/reward/worst@50/std:0.26632498943959426 - val-aux/grpo_convert/score/mean@50:1.38 - val-aux/grpo_convert/score/std@50:0.5026932219902319 - val-aux/grpo_convert/score/best@2/mean:1.60975 - val-aux/grpo_convert/score/best@2/std:0.41096791966181 - val-aux/grpo_convert/score/worst@2/mean:1.159 - val-aux/grpo_convert/score/worst@2/std:0.4931695595068142 - val-aux/grpo_convert/score/best@4/mean:1.7755 - val-aux/grpo_convert/score/best@4/std:0.30858865797254076 - val-aux/grpo_convert/score/worst@4/mean:0.954 - val-aux/grpo_convert/score/worst@4/std:0.4558933061540651 - val-aux/grpo_convert/score/best@8/mean:1.9155 - val-aux/grpo_convert/score/best@8/std:0.18737595897019446 - val-aux/grpo_convert/score/worst@8/mean:0.8075 - val-aux/grpo_convert/score/worst@8/std:0.41407430772789977 - val-aux/grpo_convert/score/best@16/mean:1.982 - val-aux/grpo_convert/score/best@16/std:0.09314504817756013 - val-aux/grpo_convert/score/worst@16/mean:0.6509999999999999 - val-aux/grpo_convert/score/worst@16/std:0.38993547605335405 - val-aux/grpo_convert/score/best@32/mean:1.9995 - val-aux/grpo_convert/score/best@32/std:0.015803480629279113 - val-aux/grpo_convert/score/worst@32/mean:0.46525 - val-aux/grpo_convert/score/worst@32/std:0.339271185779164 - val-aux/grpo_convert/score/best@50/mean:2.0 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:0.361 - val-aux/grpo_convert/score/worst@50/std:0.26632498943959426 - val-aux/grpo_convert/structure/mean@50:0.48 - val-aux/grpo_convert/structure/std@50:0.09797958971132711 - val-aux/grpo_convert/structure/best@2/mean:0.4985 - val-aux/grpo_convert/structure/best@2/std:0.027345017827750638 - val-aux/grpo_convert/structure/worst@2/mean:0.45399999999999996 - val-aux/grpo_convert/structure/worst@2/std:0.144512975196001 - val-aux/grpo_convert/structure/best@4/mean:0.5 - val-aux/grpo_convert/structure/best@4/std:0.0 - val-aux/grpo_convert/structure/worst@4/mean:0.41900000000000004 - val-aux/grpo_convert/structure/worst@4/std:0.1842254054141285 - val-aux/grpo_convert/structure/best@8/mean:0.5 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:0.363 - val-aux/grpo_convert/structure/worst@8/std:0.22300448425984623 - val-aux/grpo_convert/structure/best@16/mean:0.5 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:0.267 - val-aux/grpo_convert/structure/worst@16/std:0.24942133028271662 - val-aux/grpo_convert/structure/best@32/mean:0.5 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:0.14350000000000002 - val-aux/grpo_convert/structure/worst@32/std:0.22618079051944265 - val-aux/grpo_convert/structure/best@50/mean:0.5 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:0.07400000000000001 - val-aux/grpo_convert/structure/worst@50/std:0.17754999295972954 - val-aux/grpo_convert/boxed/mean@50:0.49 - val-aux/grpo_convert/boxed/std@50:0.04898979485566357 - val-aux/grpo_convert/boxed/best@2/mean:0.49924999999999997 - val-aux/grpo_convert/boxed/best@2/std:0.013672508913875319 - val-aux/grpo_convert/boxed/worst@2/mean:0.477 - val-aux/grpo_convert/boxed/worst@2/std:0.0722564875980005 - val-aux/grpo_convert/boxed/best@4/mean:0.5 - val-aux/grpo_convert/boxed/best@4/std:0.0 - val-aux/grpo_convert/boxed/worst@4/mean:0.4595 - val-aux/grpo_convert/boxed/worst@4/std:0.09211270270706423 - val-aux/grpo_convert/boxed/best@8/mean:0.5 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.4315 - val-aux/grpo_convert/boxed/worst@8/std:0.11150224212992312 - val-aux/grpo_convert/boxed/best@16/mean:0.5 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.3835 - val-aux/grpo_convert/boxed/worst@16/std:0.12471066514135831 - val-aux/grpo_convert/boxed/best@32/mean:0.5 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.32175 - val-aux/grpo_convert/boxed/worst@32/std:0.11309039525972132 - val-aux/grpo_convert/boxed/best@50/mean:0.5 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.287 - val-aux/grpo_convert/boxed/worst@50/std:0.08877499647986477 - val-aux/grpo_convert/correct/mean@50:0.41000000000000003 - val-aux/grpo_convert/correct/std@50:0.442693221990232 - val-aux/grpo_convert/correct/best@2/mean:0.612 - val-aux/grpo_convert/correct/best@2/std:0.40584188904815754 - val-aux/grpo_convert/correct/worst@2/mean:0.22799999999999998 - val-aux/grpo_convert/correct/worst@2/std:0.35065919404773527 - val-aux/grpo_convert/correct/best@4/mean:0.7755 - val-aux/grpo_convert/correct/best@4/std:0.30858865797254076 - val-aux/grpo_convert/correct/worst@4/mean:0.0755 - val-aux/grpo_convert/correct/worst@4/std:0.20489501078748018 - val-aux/grpo_convert/correct/best@8/mean:0.9155 - val-aux/grpo_convert/correct/best@8/std:0.18737595897019446 - val-aux/grpo_convert/correct/worst@8/mean:0.013 - val-aux/grpo_convert/correct/worst@8/std:0.07956758133813042 - val-aux/grpo_convert/correct/best@16/mean:0.982 - val-aux/grpo_convert/correct/best@16/std:0.09314504817756013 - val-aux/grpo_convert/correct/worst@16/mean:0.0005 - val-aux/grpo_convert/correct/worst@16/std:0.015803480629279113 - val-aux/grpo_convert/correct/best@32/mean:0.9995 - val-aux/grpo_convert/correct/best@32/std:0.015803480629279113 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:1.0 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.41000000000000003 - val-aux/grpo_convert/acc/std@50:0.442693221990232 - val-aux/grpo_convert/acc/best@2/mean:0.612 - val-aux/grpo_convert/acc/best@2/std:0.40584188904815754 - val-aux/grpo_convert/acc/worst@2/mean:0.22799999999999998 - val-aux/grpo_convert/acc/worst@2/std:0.35065919404773527 - val-aux/grpo_convert/acc/best@4/mean:0.7755 - val-aux/grpo_convert/acc/best@4/std:0.30858865797254076 - val-aux/grpo_convert/acc/worst@4/mean:0.0755 - val-aux/grpo_convert/acc/worst@4/std:0.20489501078748018 - val-aux/grpo_convert/acc/best@8/mean:0.9155 - val-aux/grpo_convert/acc/best@8/std:0.18737595897019446 - val-aux/grpo_convert/acc/worst@8/mean:0.013 - val-aux/grpo_convert/acc/worst@8/std:0.07956758133813042 - val-aux/grpo_convert/acc/best@16/mean:0.982 - val-aux/grpo_convert/acc/best@16/std:0.09314504817756013 - val-aux/grpo_convert/acc/worst@16/mean:0.0005 - val-aux/grpo_convert/acc/worst@16/std:0.015803480629279113 - val-aux/grpo_convert/acc/best@32/mean:0.9995 - val-aux/grpo_convert/acc/best@32/std:0.015803480629279113 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:1.0 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:100 - training/epoch:2 - critic/score/mean:1.3828125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3828125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021838434040546417 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.021838434040546417 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:381.6343688964844 - response_length/max:1332.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.630061686038971e-05 - timing_s/generate_sequences:33.98603057861328 - timing_s/reshard:0.6653642654418945 - timing_s/gen:43.11293056793511 - timing_s/reward:0.07773657515645027 - timing_s/old_log_prob:1.1743450555950403 - timing_s/ref:1.3569456674158573 - timing_s/adv:0.007666952908039093 - timing_s/update_actor:7.150472512468696 - timing_s/testing:41.610307617112994 - timing_s/save_checkpoint:8.1266121994704 - timing_s/step:102.63170047290623 - timing_s/stop_profile:5.416013300418854e-05 - timing_per_token_ms/adv:3.03050001701197e-05 - timing_per_token_ms/gen:0.3530287543536853 - timing_per_token_ms/ref:0.00536357000950958 - timing_per_token_ms/update_actor:0.028263519198035898 - perf/total_num_tokens:252993 - perf/time_per_step:102.63170047290623 - perf/throughput:308.1321351422844[36m(TaskRunner pid=2949575)[0m Training Progress:  19%|█▉        | 100/525 [1:40:02<8:06:34, 68.69s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:19:43,448:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  19%|█▉        | 101/525 [1:40:49<7:20:15, 62.30s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:19:48,571:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:19:48,574:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_100/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  19%|█▉        | 102/525 [1:41:38<6:50:23, 58.21s/it]

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3828125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3828125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.006526983808726072, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.006526983808726072, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 366.6343688964844, 'response_length/max': 1129.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:101 - global_seqlen/min:27969 - global_seqlen/max:35530 - global_seqlen/minmax_diff:7561 - global_seqlen/balanced_min:31050 - global_seqlen/balanced_max:31051 - global_seqlen/mean:31050.375 - actor/entropy:0.40156590938568115 - actor/kl_loss:0.427750651165843 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.050625916570425034 - actor/pg_clipfrac:0.003108077048091218 - actor/ppo_kl:0.025693193953793526 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:7.602618098258972 - perf/mfu/actor:0.09412818467399535 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.77609634399414 - actor/lr:1e-06 - training/global_step:101 - training/epoch:2 - critic/score/mean:1.3828125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3828125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.006526983808726072 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.006526983808726072 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:366.6343688964844 - response_length/max:1129.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.504146873950958e-05 - timing_s/generate_sequences:30.46830940246582 - timing_s/reshard:0.5980076193809509 - timing_s/gen:37.583644745871425 - timing_s/reward:0.07657166197896004 - timing_s/old_log_prob:1.1537706013768911 - timing_s/ref:1.3663061894476414 - timing_s/adv:0.008251562714576721 - timing_s/update_actor:7.059232881292701 - timing_s/step:47.265222642570734 - timing_s/stop_profile:4.449300467967987e-05 - timing_per_token_ms/adv:3.3218450318944304e-05 - timing_per_token_ms/gen:0.3203433661419451 - timing_per_token_ms/ref:0.0055003610642691166 - timing_per_token_ms/update_actor:0.028418468703247147 - perf/total_num_tokens:248403 - perf/time_per_step:47.265222642570734 - perf/throughput:656.9391460357497
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4953124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4953124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.032774221152067184, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.032774221152067184, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 365.44061279296875, 'response_length/max': 1177.0, 'response_length/min': 72.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:102 - global_seqlen/min:28694 - global_seqlen/max:34612 - global_seqlen/minmax_diff:5918 - global_seqlen/balanced_min:31011 - global_seqlen/balanced_max:31012 - global_seqlen/mean:31011.375 - actor/entropy:0.40317121148109436 - actor/kl_loss:0.34775927364826204 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10402002185583115 - actor/pg_clipfrac:0.0034195353859104217 - actor/ppo_kl:-0.0005806004844998824 - actor/pg_clipfrac_lower:0.000409190688515082 - actor/grad_norm:20.825031399726868 - perf/mfu/actor:0.09295669663511799 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.81820678710938 - actor/lr:1e-06 - training/global_step:102 - training/epoch:2 - critic/score/mean:1.4953124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4953124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.032774221152067184 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.032774221152067184 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:365.44061279296875 - response_length/max:1177.0 - response_length/min:72.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.57883894443512e-05 - timing_s/generate_sequences:33.31159591674805 - timing_s/reshard:0.6780217885971069 - timing_s/gen:38.76120048947632 - timing_s/reward:0.0766588356345892 - timing_s/old_log_prob:1.1796832475811243 - timing_s/ref:1.3491561654955149 - timing_s/adv:0.007643913850188255 - timing_s/update_actor:7.139707872644067 - timing_s/step:48.528320675715804 - timing_s/stop_profile:4.6562403440475464e-05 - timing_per_token_ms/adv:3.081092764424447e-05 - timing_per_token_ms/gen:0.33145945809832583 - timing_per_token_ms/ref:0.005438150378270533 - timing_per_token_ms/update_actor:0.028778584763832896 - perf/total_num_tokens:248091 - perf/time_per_step:48.528320675715804 - perf/throughput:639.0366402173585
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  20%|█▉        | 103/525 [1:42:22<6:19:03, 53.90s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  20%|█▉        | 104/525 [1:43:12<6:10:11, 52.76s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.353124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.353124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0052681053057312965, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.0052681053057312965, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 384.86248779296875, 'response_length/max': 1011.0, 'response_length/min': 81.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.353125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:103 - global_seqlen/min:25317 - global_seqlen/max:35153 - global_seqlen/minmax_diff:9836 - global_seqlen/balanced_min:31783 - global_seqlen/balanced_max:31784 - global_seqlen/mean:31783.875 - actor/entropy:0.39885661005973816 - actor/kl_loss:0.41263371258974074 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06112555712461472 - actor/pg_clipfrac:0.01633398896083236 - actor/ppo_kl:0.010443713315180504 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:14.130760908126831 - perf/mfu/actor:0.09290385372265998 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.89591979980469 - actor/lr:1e-06 - training/global_step:103 - training/epoch:2 - critic/score/mean:1.353124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.353124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0052681053057312965 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0052681053057312965 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:384.86248779296875 - response_length/max:1011.0 - response_length/min:81.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.353125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010484270751476288 - timing_s/generate_sequences:30.320877075195312 - timing_s/reshard:0.7726325392723083 - timing_s/gen:33.55784143321216 - timing_s/reward:0.07897163927555084 - timing_s/old_log_prob:1.1656146440654993 - timing_s/ref:1.3584237080067396 - timing_s/adv:0.008081430569291115 - timing_s/update_actor:7.327694149687886 - timing_s/step:43.51051414757967 - timing_s/stop_profile:4.649348556995392e-05 - timing_per_token_ms/adv:3.178274584711239e-05 - timing_per_token_ms/gen:0.2724823917081763 - timing_per_token_ms/ref:0.005342424845958602 - timing_per_token_ms/update_actor:0.028818442329986062 - perf/total_num_tokens:254271 - perf/time_per_step:43.51051414757967 - perf/throughput:730.4872310217925
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4640624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4640624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05085534602403641, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.05085534602403641, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 341.2562561035156, 'response_length/max': 1268.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:104 - global_seqlen/min:28369 - global_seqlen/max:34359 - global_seqlen/minmax_diff:5990 - global_seqlen/balanced_min:30005 - global_seqlen/balanced_max:30097 - global_seqlen/mean:30017.75 - actor/entropy:0.4195997714996338 - actor/kl_loss:0.4313224717974663 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.24804253801703452 - actor/pg_clipfrac:0.013208119763294234 - actor/ppo_kl:-0.007790083770669298 - actor/pg_clipfrac_lower:0.00010176390642300249 - actor/grad_norm:22.56968855857849 - perf/mfu/actor:0.09035782139626256 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.92296600341797 - actor/lr:1e-06 - training/global_step:104 - training/epoch:2 - critic/score/mean:1.4640624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4640624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05085534602403641 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.05085534602403641 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:341.2562561035156 - response_length/max:1268.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.511170744895935e-05 - timing_s/generate_sequences:32.47417068481445 - timing_s/reshard:0.6988412141799927 - timing_s/gen:40.4636056125164 - timing_s/reward:0.07487590797245502 - timing_s/old_log_prob:1.0904791802167892 - timing_s/ref:1.3512026332318783 - timing_s/adv:0.007583988830447197 - timing_s/update_actor:7.096030551940203 - timing_s/step:50.097182024270296 - timing_s/stop_profile:5.719996988773346e-05 - timing_per_token_ms/adv:3.158126787670294e-05 - timing_per_token_ms/gen:0.3705390525129247 - timing_per_token_ms/ref:0.0056266818517039015 - timing_per_token_ms/update_actor:0.029549310624298136 - perf/total_num_tokens:240142 - perf/time_per_step:50.097182024270296 - perf/throughput:599.1903893008887
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3156249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3156249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021258044987916946, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.021258044987916946, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 396.06561279296875, 'response_length/max': 1513.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.315625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  20%|██        | 105/525 [1:44:10<6:20:19, 54.33s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  20%|██        | 106/525 [1:45:09<6:30:11, 55.87s/it]
[36m(TaskRunner pid=2949575)[0m step:105 - global_seqlen/min:29189 - global_seqlen/max:36009 - global_seqlen/minmax_diff:6820 - global_seqlen/balanced_min:32218 - global_seqlen/balanced_max:32219 - global_seqlen/mean:32218.875 - actor/entropy:0.3757503926753998 - actor/kl_loss:0.35575366355478766 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.18316401317715644 - actor/pg_clipfrac:0.002931545354658738 - actor/ppo_kl:0.011282900616788539 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:7.587075889110565 - perf/mfu/actor:0.09685891725206586 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.84599304199219 - actor/lr:1e-06 - training/global_step:105 - training/epoch:2 - critic/score/mean:1.3156249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3156249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021258044987916946 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.021258044987916946 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:396.06561279296875 - response_length/max:1513.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.315625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.331798017024994e-05 - timing_s/generate_sequences:34.41547775268555 - timing_s/reshard:0.6640282869338989 - timing_s/gen:48.15948952920735 - timing_s/reward:0.08014191314578056 - timing_s/old_log_prob:1.2416253499686718 - timing_s/ref:1.3587532695382833 - timing_s/adv:0.008058281615376472 - timing_s/update_actor:7.128870217129588 - timing_s/step:57.99137369170785 - timing_s/stop_profile:4.375353455543518e-05 - timing_per_token_ms/adv:3.126382289642512e-05 - timing_per_token_ms/gen:0.37998350596261155 - timing_per_token_ms/ref:0.0052715732219788996 - timing_per_token_ms/update_actor:0.027657973071412285 - perf/total_num_tokens:257751 - perf/time_per_step:57.99137369170785 - perf/throughput:555.5804760080542
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.381250023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.381250023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.024030953645706177, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.024030953645706177, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 387.8374938964844, 'response_length/max': 1481.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.38125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:106 - global_seqlen/min:26428 - global_seqlen/max:35040 - global_seqlen/minmax_diff:8612 - global_seqlen/balanced_min:31885 - global_seqlen/balanced_max:31886 - global_seqlen/mean:31885.375 - actor/entropy:0.38700416684150696 - actor/kl_loss:0.5980248298496008 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09146269708871842 - actor/pg_clipfrac:0.016041302948724478 - actor/ppo_kl:0.039251869231520686 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:14.955193877220154 - perf/mfu/actor:0.09438193563718697 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.25455856323242 - actor/lr:1e-06 - training/global_step:106 - training/epoch:3 - critic/score/mean:1.381250023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.381250023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.024030953645706177 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.024030953645706177 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:387.8374938964844 - response_length/max:1481.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.38125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00033452361822128296 - timing_s/generate_sequences:35.41958999633789 - timing_s/reshard:0.7379793524742126 - timing_s/gen:47.54644023254514 - timing_s/reward:0.08089515194296837 - timing_s/old_log_prob:1.3006291463971138 - timing_s/ref:1.396457303315401 - timing_s/adv:0.009468596428632736 - timing_s/update_actor:7.241642145439982 - timing_s/step:57.61354196071625 - timing_s/stop_profile:4.401989281177521e-05 - timing_per_token_ms/adv:3.711966861230555e-05 - timing_per_token_ms/gen:0.3831053617216065 - timing_per_token_ms/ref:0.0054745212472622675 - timing_per_token_ms/update_actor:0.028389356191670878 - perf/total_num_tokens:255083 - perf/time_per_step:57.61354196071625 - perf/throughput:553.435423597824
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.475000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.475000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0021953305695205927, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0021953305695205927, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 378.0093688964844, 'response_length/max': 1145.0, 'response_length/min': 119.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.475, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  20%|██        | 107/525 [1:45:58<6:14:37, 53.77s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  21%|██        | 108/525 [1:46:58<6:26:48, 55.66s/it]
[36m(TaskRunner pid=2949575)[0m step:107 - global_seqlen/min:27562 - global_seqlen/max:34493 - global_seqlen/minmax_diff:6931 - global_seqlen/balanced_min:31509 - global_seqlen/balanced_max:31510 - global_seqlen/mean:31509.75 - actor/entropy:0.3756498396396637 - actor/kl_loss:0.41923637930303814 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09712660238146782 - actor/pg_clipfrac:0.015003816096577794 - actor/ppo_kl:-0.008415620966115967 - actor/pg_clipfrac_lower:0.0005813643743749708 - actor/grad_norm:26.5158429145813 - perf/mfu/actor:0.09390770153261682 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.48273468017578 - actor/lr:1e-06 - training/global_step:107 - training/epoch:3 - critic/score/mean:1.475000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.475000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0021953305695205927 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0021953305695205927 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:378.0093688964844 - response_length/max:1145.0 - response_length/min:119.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.475 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010474957525730133 - timing_s/generate_sequences:32.04464340209961 - timing_s/reshard:0.7295419573783875 - timing_s/gen:38.51994901522994 - timing_s/reward:0.07686569914221764 - timing_s/old_log_prob:1.178501034155488 - timing_s/ref:1.380942141637206 - timing_s/adv:0.007857268676161766 - timing_s/update_actor:7.184523118659854 - timing_s/step:48.36391116306186 - timing_s/stop_profile:4.4796615839004517e-05 - timing_per_token_ms/adv:3.116998974984634e-05 - timing_per_token_ms/gen:0.31844406153311294 - timing_per_token_ms/ref:0.0054782334897817584 - timing_per_token_ms/update_actor:0.028501190578550505 - perf/total_num_tokens:252078 - perf/time_per_step:48.36391116306186 - perf/throughput:651.5136853544158
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.337499976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.337499976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05134587362408638, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.05134587362408638, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 375.25, 'response_length/max': 1601.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:108 - global_seqlen/min:28971 - global_seqlen/max:34507 - global_seqlen/minmax_diff:5536 - global_seqlen/balanced_min:31336 - global_seqlen/balanced_max:31727 - global_seqlen/mean:31386.25 - actor/entropy:0.39924103021621704 - actor/kl_loss:0.6371400874108076 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0912091176956892 - actor/pg_clipfrac:0.005980527712381445 - actor/ppo_kl:0.0730822847923264 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:15.390838861465454 - perf/mfu/actor:0.09121043375144625 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.520751953125 - actor/lr:1e-06 - training/global_step:108 - training/epoch:3 - critic/score/mean:1.337499976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.337499976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05134587362408638 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.05134587362408638 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:375.25 - response_length/max:1601.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010115653276443481 - timing_s/generate_sequences:33.197410583496094 - timing_s/reshard:0.8700070381164551 - timing_s/gen:49.92101932503283 - timing_s/reward:0.07661590166389942 - timing_s/old_log_prob:1.1306479685008526 - timing_s/ref:1.3851970508694649 - timing_s/adv:0.00789882242679596 - timing_s/update_actor:7.366734175011516 - timing_s/step:59.9094109646976 - timing_s/stop_profile:5.076266825199127e-05 - timing_per_token_ms/adv:3.1458132250571343e-05 - timing_per_token_ms/gen:0.41573134014850793 - timing_per_token_ms/ref:0.005516735237840873 - timing_per_token_ms/update_actor:0.02933901857904144 - perf/total_num_tokens:251090 - perf/time_per_step:59.9094109646976 - perf/throughput:523.8951526079059
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4890625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4890625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0234717708081007, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.0234717708081007, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 338.02813720703125, 'response_length/max': 1092.0, 'response_length/min': 56.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  21%|██        | 109/525 [1:47:45<6:07:10, 52.96s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:28:22,414:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:28:25,775:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:28:25,778:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:28:26,357:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  21%|██        | 110/525 [1:48:41<6:13:00, 53.93s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:28:22,794:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:109 - global_seqlen/min:28077 - global_seqlen/max:32694 - global_seqlen/minmax_diff:4617 - global_seqlen/balanced_min:29928 - global_seqlen/balanced_max:29928 - global_seqlen/mean:29928.0 - actor/entropy:0.37821322679519653 - actor/kl_loss:0.38402375895529983 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.029172693938016893 - actor/pg_clipfrac:0.0061462535231839865 - actor/ppo_kl:-0.0004889874340733513 - actor/pg_clipfrac_lower:0.0001418439671397209 - actor/grad_norm:12.65682578086853 - perf/mfu/actor:0.08986133852627755 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.61183166503906 - actor/lr:1e-06 - training/global_step:109 - training/epoch:3 - critic/score/mean:1.4890625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4890625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0234717708081007 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.0234717708081007 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:338.02813720703125 - response_length/max:1092.0 - response_length/min:56.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010062195360660553 - timing_s/generate_sequences:28.360301971435547 - timing_s/reshard:0.8056509494781494 - timing_s/gen:36.815045947209 - timing_s/reward:0.07424621656537056 - timing_s/old_log_prob:1.12148099206388 - timing_s/ref:1.3667714446783066 - timing_s/adv:0.007763782516121864 - timing_s/update_actor:7.124587170779705 - timing_s/step:46.52349201403558 - timing_s/stop_profile:4.20939177274704e-05 - timing_per_token_ms/adv:3.242691842138576e-05 - timing_per_token_ms/gen:0.3403474742967856 - timing_per_token_ms/ref:0.005708581615369831 - timing_per_token_ms/update_actor:0.02975719715141216 - perf/total_num_tokens:239424 - perf/time_per_step:46.52349201403558 - perf/throughput:643.2879112120621
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.365625023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.365625023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01034572347998619, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.01034572347998619, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 398.3343811035156, 'response_length/max': 1123.0, 'response_length/min': 90.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.365625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:110 - global_seqlen/min:28579 - global_seqlen/max:34226 - global_seqlen/minmax_diff:5647 - global_seqlen/balanced_min:32318 - global_seqlen/balanced_max:32319 - global_seqlen/mean:32318.375 - actor/entropy:0.3426329493522644 - actor/kl_loss:0.5312385890632868 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05989290999714285 - actor/pg_clipfrac:0.02045193425146863 - actor/ppo_kl:0.0016047359100866744 - actor/pg_clipfrac_lower:0.003951693716226145 - actor/grad_norm:16.262568950653076 - perf/mfu/actor:0.09608760176983129 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.53794479370117 - actor/lr:1e-06 - training/global_step:110 - training/epoch:3 - critic/score/mean:1.365625023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.365625023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01034572347998619 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01034572347998619 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:398.3343811035156 - response_length/max:1123.0 - response_length/min:90.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.365625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.587166666984558e-05 - timing_s/generate_sequences:32.45456314086914 - timing_s/reshard:0.6623162627220154 - timing_s/gen:38.151822324842215 - timing_s/reward:0.07851446606218815 - timing_s/old_log_prob:1.1745708137750626 - timing_s/ref:1.3785510398447514 - timing_s/adv:0.0079305749386549 - timing_s/update_actor:7.208952831104398 - timing_s/save_checkpoint:8.162482619285583 - timing_s/step:56.17700914852321 - timing_s/stop_profile:5.920231342315674e-05 - timing_per_token_ms/adv:3.067362970235547e-05 - timing_per_token_ms/gen:0.2993074468281376 - timing_per_token_ms/ref:0.005331916594834793 - timing_per_token_ms/update_actor:0.027882562285017416 - perf/total_num_tokens:258547 - perf/time_per_step:56.17700914852321 - perf/throughput:575.2954009095657
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.360937476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.360937476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.016883408650755882, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.016883408650755882, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 369.43438720703125, 'response_length/max': 1145.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3609375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  21%|██        | 111/525 [1:49:29<5:59:48, 52.15s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:28:27,811:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:28:27,813:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_110/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  21%|██▏       | 112/525 [1:50:18<5:52:28, 51.21s/it]
[36m(TaskRunner pid=2949575)[0m step:111 - global_seqlen/min:28472 - global_seqlen/max:33057 - global_seqlen/minmax_diff:4585 - global_seqlen/balanced_min:31162 - global_seqlen/balanced_max:31163 - global_seqlen/mean:31162.375 - actor/entropy:0.40052473545074463 - actor/kl_loss:1.1623728826642037 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.00307832807302475 - actor/pg_clipfrac:0.057295192976016554 - actor/ppo_kl:0.10050253063673154 - actor/pg_clipfrac_lower:0.00010840773757081479 - actor/grad_norm:17.159996509552002 - perf/mfu/actor:0.09301273728717079 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.32414245605469 - actor/lr:1e-06 - training/global_step:111 - training/epoch:3 - critic/score/mean:1.360937476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.360937476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.016883408650755882 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.016883408650755882 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:369.43438720703125 - response_length/max:1145.0 - response_length/min:99.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3609375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.649565279483795e-05 - timing_s/generate_sequences:32.318363189697266 - timing_s/reshard:0.6951727271080017 - timing_s/gen:38.15763368457556 - timing_s/reward:0.07690487243235111 - timing_s/old_log_prob:1.1595507580786943 - timing_s/ref:1.3805787544697523 - timing_s/adv:0.0077989231795072556 - timing_s/update_actor:7.173845190554857 - timing_s/step:47.971899976953864 - timing_s/stop_profile:4.885345697402954e-05 - timing_per_token_ms/adv:3.128341140360473e-05 - timing_per_token_ms/gen:0.3227707363839616 - timing_per_token_ms/ref:0.005537843130015573 - timing_per_token_ms/update_actor:0.02877606885930091 - perf/total_num_tokens:249299 - perf/time_per_step:47.971899976953864 - perf/throughput:649.5964307223747
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3859374523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3859374523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0074404096230864525, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.0074404096230864525, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 416.40625, 'response_length/max': 1140.0, 'response_length/min': 116.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:112 - global_seqlen/min:30136 - global_seqlen/max:36308 - global_seqlen/minmax_diff:6172 - global_seqlen/balanced_min:33019 - global_seqlen/balanced_max:33020 - global_seqlen/mean:33019.375 - actor/entropy:0.3523581027984619 - actor/kl_loss:1.260537625476718 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0533634128049016 - actor/pg_clipfrac:0.05529378370847553 - actor/ppo_kl:-0.05104983184719458 - actor/pg_clipfrac_lower:0.004330304294126108 - actor/grad_norm:35.60256505012512 - perf/mfu/actor:0.09552205785906664 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.30296325683594 - actor/lr:1e-06 - training/global_step:112 - training/epoch:3 - critic/score/mean:1.3859374523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3859374523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0074404096230864525 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0074404096230864525 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:416.40625 - response_length/max:1140.0 - response_length/min:116.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.856691420078278e-05 - timing_s/generate_sequences:33.06210708618164 - timing_s/reshard:0.6664905548095703 - timing_s/gen:38.806434497237206 - timing_s/reward:0.0805552490055561 - timing_s/old_log_prob:1.2919250503182411 - timing_s/ref:1.3797557763755322 - timing_s/adv:0.008092416450381279 - timing_s/update_actor:7.415529390797019 - timing_s/step:48.99891465343535 - timing_s/stop_profile:4.509836435317993e-05 - timing_per_token_ms/adv:3.0635106094456964e-05 - timing_per_token_ms/gen:0.29123027765281206 - timing_per_token_ms/ref:0.005223280938750098 - timing_per_token_ms/update_actor:0.028072644435263458 - perf/total_num_tokens:264155 - perf/time_per_step:48.99891465343535 - perf/throughput:673.8797223069713
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.412500023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.412500023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.024266541004180908, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.024266541004180908, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 342.59063720703125, 'response_length/max': 1092.0, 'response_length/min': 73.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  22%|██▏       | 113/525 [1:51:06<5:43:48, 50.07s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  22%|██▏       | 114/525 [1:52:03<5:57:10, 52.14s/it]
[36m(TaskRunner pid=2949575)[0m step:113 - global_seqlen/min:28371 - global_seqlen/max:32296 - global_seqlen/minmax_diff:3925 - global_seqlen/balanced_min:30053 - global_seqlen/balanced_max:30054 - global_seqlen/mean:30053.625 - actor/entropy:0.38927268981933594 - actor/kl_loss:0.966156504303217 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05374476537108421 - actor/pg_clipfrac:0.0392989887506701 - actor/ppo_kl:0.19048337740823626 - actor/pg_clipfrac_lower:0.0001265873434022069 - actor/grad_norm:12.01374614238739 - perf/mfu/actor:0.0890134533357568 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.17855834960938 - actor/lr:1e-06 - training/global_step:113 - training/epoch:3 - critic/score/mean:1.412500023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.412500023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.024266541004180908 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.024266541004180908 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:342.59063720703125 - response_length/max:1092.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.025447070598602e-05 - timing_s/generate_sequences:30.96817398071289 - timing_s/reshard:0.7434488534927368 - timing_s/gen:37.56332850083709 - timing_s/reward:0.07625616900622845 - timing_s/old_log_prob:1.1562782227993011 - timing_s/ref:1.3705255333334208 - timing_s/adv:0.007711980491876602 - timing_s/update_actor:7.21689004637301 - timing_s/step:47.406283248215914 - timing_s/stop_profile:4.387274384498596e-05 - timing_per_token_ms/adv:3.2075916349011984e-05 - timing_per_token_ms/gen:0.34264043730068766 - timing_per_token_ms/ref:0.005700333709050991 - timing_per_token_ms/update_actor:0.03001672030567448 - perf/total_num_tokens:240429 - perf/time_per_step:47.406283248215914 - perf/throughput:633.9586852367515
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.389062523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.389062523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021268466487526894, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.021268466487526894, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 362.5218811035156, 'response_length/max': 1413.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:114 - global_seqlen/min:27779 - global_seqlen/max:35200 - global_seqlen/minmax_diff:7421 - global_seqlen/balanced_min:30894 - global_seqlen/balanced_max:30895 - global_seqlen/mean:30894.625 - actor/entropy:0.36594143509864807 - actor/kl_loss:1.3690125323832034 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06382644604891538 - actor/pg_clipfrac:0.020067106687929482 - actor/ppo_kl:0.06831435411295388 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:21.894357204437256 - perf/mfu/actor:0.09207539598880508 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.22734451293945 - actor/lr:1e-06 - training/global_step:114 - training/epoch:3 - critic/score/mean:1.389062523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.389062523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021268466487526894 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.021268466487526894 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:362.5218811035156 - response_length/max:1413.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010079331696033478 - timing_s/generate_sequences:35.01195526123047 - timing_s/reshard:0.6700589060783386 - timing_s/gen:46.864239029586315 - timing_s/reward:0.07669384777545929 - timing_s/old_log_prob:1.1709808241575956 - timing_s/ref:1.4113421738147736 - timing_s/adv:0.008035080507397652 - timing_s/update_actor:7.181712340563536 - timing_s/step:56.72791391797364 - timing_s/stop_profile:4.534423351287842e-05 - timing_per_token_ms/adv:3.251002604578325e-05 - timing_per_token_ms/gen:0.40397768263627465 - timing_per_token_ms/ref:0.005710306298485471 - timing_per_token_ms/update_actor:0.029057288851068494 - perf/total_num_tokens:247157 - perf/time_per_step:56.72791391797364 - perf/throughput:544.610631102572
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4140625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4140625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.030971508473157883, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.030971508473157883, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 401.7437438964844, 'response_length/max': 1089.0, 'response_length/min': 103.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  22%|██▏       | 115/525 [1:52:48<5:43:13, 50.23s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  22%|██▏       | 116/525 [1:53:28<5:20:52, 47.07s/it]
[36m(TaskRunner pid=2949575)[0m step:115 - global_seqlen/min:30117 - global_seqlen/max:34809 - global_seqlen/minmax_diff:4692 - global_seqlen/balanced_min:32445 - global_seqlen/balanced_max:32447 - global_seqlen/mean:32446.0 - actor/entropy:0.31329870223999023 - actor/kl_loss:1.431967306137085 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0893386013340205 - actor/pg_clipfrac:0.021055358479497955 - actor/ppo_kl:0.02729196321743075 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:36.65361785888672 - perf/mfu/actor:0.09750807729724237 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.41082000732422 - actor/lr:1e-06 - training/global_step:115 - training/epoch:3 - critic/score/mean:1.4140625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4140625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.030971508473157883 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.030971508473157883 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:401.7437438964844 - response_length/max:1089.0 - response_length/min:103.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010128319263458252 - timing_s/generate_sequences:28.42987632751465 - timing_s/reshard:0.6852418184280396 - timing_s/gen:35.48716705664992 - timing_s/reward:0.07767913118004799 - timing_s/old_log_prob:1.1839960645884275 - timing_s/ref:1.371151989325881 - timing_s/adv:0.007802518084645271 - timing_s/update_actor:7.129306336864829 - timing_s/step:45.27835925295949 - timing_s/stop_profile:4.606693983078003e-05 - timing_per_token_ms/adv:3.0059630172614772e-05 - timing_per_token_ms/gen:0.2760401301875412 - timing_per_token_ms/ref:0.005282438472099338 - timing_per_token_ms/update_actor:0.02746604487789261 - perf/total_num_tokens:259568 - perf/time_per_step:45.27835925295949 - perf/throughput:716.5895702786372
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.337499976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.337499976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04727448895573616, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.04727448895573616, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 351.53125, 'response_length/max': 852.0, 'response_length/min': 71.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:116 - global_seqlen/min:28886 - global_seqlen/max:32443 - global_seqlen/minmax_diff:3557 - global_seqlen/balanced_min:30459 - global_seqlen/balanced_max:30460 - global_seqlen/mean:30459.375 - actor/entropy:0.3783796429634094 - actor/kl_loss:0.7762298731133341 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.020529886707663536 - actor/pg_clipfrac:0.025426267177681438 - actor/ppo_kl:-0.006569462618790567 - actor/pg_clipfrac_lower:0.0020795820513740183 - actor/grad_norm:46.250322341918945 - perf/mfu/actor:0.08929616127138326 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.40082168579102 - actor/lr:1e-06 - training/global_step:116 - training/epoch:3 - critic/score/mean:1.337499976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.337499976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04727448895573616 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.04727448895573616 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:351.53125 - response_length/max:852.0 - response_length/min:71.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010006502270698547 - timing_s/generate_sequences:27.247974395751953 - timing_s/reshard:0.7030041813850403 - timing_s/gen:29.504110671579838 - timing_s/reward:0.07475218549370766 - timing_s/old_log_prob:1.2740948386490345 - timing_s/ref:1.4095634240657091 - timing_s/adv:0.007884243503212929 - timing_s/update_actor:7.292770851403475 - timing_s/step:39.5773446187377 - timing_s/stop_profile:4.7069042921066284e-05 - timing_per_token_ms/adv:3.235556993213472e-05 - timing_per_token_ms/gen:0.26228207548741966 - timing_per_token_ms/ref:0.005784604182069187 - timing_per_token_ms/update_actor:0.02992826860122489 - perf/total_num_tokens:243675 - perf/time_per_step:39.5773446187377 - perf/throughput:769.6164382281261
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.296875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.296875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.032933879643678665, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.032933879643678665, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 351.15313720703125, 'response_length/max': 1011.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  22%|██▏       | 117/525 [1:54:12<5:14:28, 46.25s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  22%|██▏       | 118/525 [1:55:00<5:15:42, 46.54s/it]
[36m(TaskRunner pid=2949575)[0m step:117 - global_seqlen/min:27516 - global_seqlen/max:32342 - global_seqlen/minmax_diff:4826 - global_seqlen/balanced_min:30418 - global_seqlen/balanced_max:30418 - global_seqlen/mean:30418.0 - actor/entropy:0.3963530659675598 - actor/kl_loss:1.021061498299241 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11309214830398559 - actor/pg_clipfrac:0.026547629543347284 - actor/ppo_kl:0.15024463387817377 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:17.480164527893066 - perf/mfu/actor:0.08993343253579435 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.48497772216797 - actor/lr:1e-06 - training/global_step:117 - training/epoch:3 - critic/score/mean:1.296875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.296875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.032933879643678665 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.032933879643678665 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:351.15313720703125 - response_length/max:1011.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.735673666000366e-05 - timing_s/generate_sequences:27.940744400024414 - timing_s/reshard:0.8890016078948975 - timing_s/gen:34.31212123669684 - timing_s/reward:0.07536506466567516 - timing_s/old_log_prob:1.1479670740664005 - timing_s/ref:1.3979542702436447 - timing_s/adv:0.010361097753047943 - timing_s/update_actor:7.239935290068388 - timing_s/step:44.19707946665585 - timing_s/stop_profile:4.554539918899536e-05 - timing_per_token_ms/adv:4.257798734732701e-05 - timing_per_token_ms/gen:0.3053521988866755 - timing_per_token_ms/ref:0.005744765723599697 - timing_per_token_ms/update_actor:0.0297518545354247 - perf/total_num_tokens:243344 - perf/time_per_step:44.19707946665585 - perf/throughput:688.2355206965344
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3093750476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3093750476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04435310885310173, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.04435310885310173, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 380.4281311035156, 'response_length/max': 1145.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.309375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:118 - global_seqlen/min:28925 - global_seqlen/max:32515 - global_seqlen/minmax_diff:3590 - global_seqlen/balanced_min:31617 - global_seqlen/balanced_max:31632 - global_seqlen/mean:31619.625 - actor/entropy:0.36326074600219727 - actor/kl_loss:0.9796452727168798 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09692833088338375 - actor/pg_clipfrac:0.0115834831725806 - actor/ppo_kl:0.03230003375228989 - actor/pg_clipfrac_lower:0.00018950889352709055 - actor/grad_norm:21.941422939300537 - perf/mfu/actor:0.0954250753711034 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.4439582824707 - actor/lr:1e-06 - training/global_step:118 - training/epoch:3 - critic/score/mean:1.3093750476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3093750476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04435310885310173 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.04435310885310173 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:380.4281311035156 - response_length/max:1145.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.309375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.789822459220886e-05 - timing_s/generate_sequences:28.21455192565918 - timing_s/reshard:0.8293910622596741 - timing_s/gen:37.49744465947151 - timing_s/reward:0.07773474231362343 - timing_s/old_log_prob:1.150009399279952 - timing_s/ref:1.3771871123462915 - timing_s/adv:0.007906649261713028 - timing_s/update_actor:7.091636838391423 - timing_s/step:47.21582541614771 - timing_s/stop_profile:4.6055763959884644e-05 - timing_per_token_ms/adv:3.125689054548017e-05 - timing_per_token_ms/gen:0.30802011434051696 - timing_per_token_ms/ref:0.005444352646284908 - timing_per_token_ms/update_actor:0.028034949965375235 - perf/total_num_tokens:252957 - perf/time_per_step:47.21582541614771 - perf/throughput:669.6827752414164
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3156249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3156249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.00213331775739789, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.00213331775739789, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 358.6937561035156, 'response_length/max': 979.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.315625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  23%|██▎       | 119/525 [1:55:43<5:08:42, 45.62s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:36:20,403:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:36:23,850:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:36:23,853:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:36:24,441:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/huggingface
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 01:36:20,628:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/model_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  23%|██▎       | 120/525 [1:56:39<5:28:34, 48.68s/it]
[36m(TaskRunner pid=2949575)[0m step:119 - global_seqlen/min:28972 - global_seqlen/max:33611 - global_seqlen/minmax_diff:4639 - global_seqlen/balanced_min:30719 - global_seqlen/balanced_max:30720 - global_seqlen/mean:30719.625 - actor/entropy:0.3922364115715027 - actor/kl_loss:0.7311203632503748 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09177710935473442 - actor/pg_clipfrac:0.012011772021651268 - actor/ppo_kl:0.010395694500766694 - actor/pg_clipfrac_lower:0.0017875993566121907 - actor/grad_norm:27.996033191680908 - perf/mfu/actor:0.08810967256398164 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.43953704833984 - actor/lr:1e-06 - training/global_step:119 - training/epoch:3 - critic/score/mean:1.3156249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3156249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.00213331775739789 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.00213331775739789 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:358.6937561035156 - response_length/max:979.0 - response_length/min:92.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.315625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.872151374816895e-05 - timing_s/generate_sequences:26.514766693115234 - timing_s/reshard:0.6693146228790283 - timing_s/gen:33.39638313651085 - timing_s/reward:0.07658492401242256 - timing_s/old_log_prob:1.1300104968249798 - timing_s/ref:1.374750068411231 - timing_s/adv:0.007996506989002228 - timing_s/update_actor:7.452417071908712 - timing_s/step:43.4528936073184 - timing_s/stop_profile:4.203803837299347e-05 - timing_per_token_ms/adv:3.2538267430845216e-05 - timing_per_token_ms/gen:0.2909548808742734 - timing_per_token_ms/ref:0.005593940634086643 - timing_per_token_ms/update_actor:0.030324332865019968 - perf/total_num_tokens:245757 - perf/time_per_step:43.4528936073184 - perf/throughput:706.9638509603456
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.435937523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.435937523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026033777743577957, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.026033777743577957, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 342.63751220703125, 'response_length/max': 1109.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:120 - global_seqlen/min:27363 - global_seqlen/max:34426 - global_seqlen/minmax_diff:7063 - global_seqlen/balanced_min:30090 - global_seqlen/balanced_max:30091 - global_seqlen/mean:30090.5 - actor/entropy:0.3317459523677826 - actor/kl_loss:1.514446996897459 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05495756417512894 - actor/pg_clipfrac:0.03343650986207649 - actor/ppo_kl:0.009119890542933717 - actor/pg_clipfrac_lower:0.0029947151808300985 - actor/grad_norm:20.077194452285767 - perf/mfu/actor:0.09002145194587559 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.27836990356445 - actor/lr:1e-06 - training/global_step:120 - training/epoch:3 - critic/score/mean:1.435937523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.435937523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026033777743577957 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.026033777743577957 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:342.63751220703125 - response_length/max:1109.0 - response_length/min:80.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.711405098438263e-05 - timing_s/generate_sequences:30.916833877563477 - timing_s/reshard:0.9145797491073608 - timing_s/gen:38.03787408396602 - timing_s/reward:0.07376369275152683 - timing_s/old_log_prob:1.2097313310950994 - timing_s/ref:1.3626330755650997 - timing_s/adv:0.008044727146625519 - timing_s/update_actor:7.144500933587551 - timing_s/save_checkpoint:7.940487310290337 - timing_s/step:55.79878330230713 - timing_s/stop_profile:5.4463744163513184e-05 - timing_per_token_ms/adv:3.34188828144494e-05 - timing_per_token_ms/gen:0.3469216198238482 - timing_per_token_ms/ref:0.005660561786797742 - timing_per_token_ms/update_actor:0.02967922157154065 - perf/total_num_tokens:240724 - perf/time_per_step:55.79878330230713 - perf/throughput:539.2680309349297
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.024824149906635284, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.024824149906635284, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 384.0843811035156, 'response_length/max': 1296.0, 'response_length/min': 117.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  23%|██▎       | 121/525 [1:57:32<5:35:59, 49.90s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:36:25,514:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:36:25,516:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_120/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  23%|██▎       | 122/525 [1:58:20<5:32:09, 49.45s/it]
[36m(TaskRunner pid=2949575)[0m step:121 - global_seqlen/min:29044 - global_seqlen/max:34122 - global_seqlen/minmax_diff:5078 - global_seqlen/balanced_min:31748 - global_seqlen/balanced_max:31749 - global_seqlen/mean:31748.375 - actor/entropy:0.3493841588497162 - actor/kl_loss:1.1936796322464942 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13683772049844264 - actor/pg_clipfrac:0.021935486316215246 - actor/ppo_kl:0.032729924760496944 - actor/pg_clipfrac_lower:6.321112741716206e-05 - actor/grad_norm:17.613601684570312 - perf/mfu/actor:0.09527222150305541 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.25945663452148 - actor/lr:1e-06 - training/global_step:121 - training/epoch:3 - critic/score/mean:1.3125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.024824149906635284 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.024824149906635284 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:384.0843811035156 - response_length/max:1296.0 - response_length/min:117.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.683465421199799e-05 - timing_s/generate_sequences:31.087078094482422 - timing_s/reshard:0.764021635055542 - timing_s/gen:42.86906145885587 - timing_s/reward:0.07799425162374973 - timing_s/old_log_prob:1.2401398420333862 - timing_s/ref:1.386812012642622 - timing_s/adv:0.007745640352368355 - timing_s/update_actor:7.134959410876036 - timing_s/step:52.73240517824888 - timing_s/stop_profile:4.351511597633362e-05 - timing_per_token_ms/adv:3.0496207886105805e-05 - timing_per_token_ms/gen:0.3487926762418403 - timing_per_token_ms/ref:0.005460169271036006 - timing_per_token_ms/update_actor:0.028091829152185097 - perf/total_num_tokens:253987 - perf/time_per_step:52.73240517824888 - perf/throughput:602.0657486166704
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.225000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.225000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.000549496035091579, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.000549496035091579, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 373.98126220703125, 'response_length/max': 1189.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.28125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.225, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:122 - global_seqlen/min:29309 - global_seqlen/max:33371 - global_seqlen/minmax_diff:4062 - global_seqlen/balanced_min:31370 - global_seqlen/balanced_max:31371 - global_seqlen/mean:31370.5 - actor/entropy:0.3296683430671692 - actor/kl_loss:1.0747857809066772 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05986058041453361 - actor/pg_clipfrac:0.04315235005924478 - actor/ppo_kl:0.10026231367373839 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:26.896942853927612 - perf/mfu/actor:0.09422960479709586 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.23674011230469 - actor/lr:1e-06 - training/global_step:122 - training/epoch:3 - critic/score/mean:1.225000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.225000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.000549496035091579 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.000549496035091579 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:373.98126220703125 - response_length/max:1189.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.225 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010123848915100098 - timing_s/generate_sequences:33.76529312133789 - timing_s/reshard:0.727072536945343 - timing_s/gen:38.36642660573125 - timing_s/reward:0.07748138904571533 - timing_s/old_log_prob:1.1777093410491943 - timing_s/ref:1.3727887272834778 - timing_s/adv:0.00798129290342331 - timing_s/update_actor:7.125469895079732 - timing_s/step:48.144077736884356 - timing_s/stop_profile:4.556402564048767e-05 - timing_per_token_ms/adv:3.180254101553733e-05 - timing_per_token_ms/gen:0.3205911610352395 - timing_per_token_ms/ref:0.005470062348717258 - timing_per_token_ms/update_actor:0.028392398491734798 - perf/total_num_tokens:250964 - perf/time_per_step:48.144077736884356 - perf/throughput:651.596239343189
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3859374523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3859374523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026334552094340324, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.026334552094340324, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 388.5375061035156, 'response_length/max': 1036.0, 'response_length/min': 46.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  23%|██▎       | 123/525 [1:59:05<5:22:10, 48.09s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  24%|██▎       | 124/525 [1:59:51<5:16:56, 47.42s/it]
[36m(TaskRunner pid=2949575)[0m step:123 - global_seqlen/min:30253 - global_seqlen/max:35200 - global_seqlen/minmax_diff:4947 - global_seqlen/balanced_min:31904 - global_seqlen/balanced_max:31905 - global_seqlen/mean:31904.625 - actor/entropy:0.33482441306114197 - actor/kl_loss:0.9850755952298641 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16026605600491167 - actor/pg_clipfrac:0.024727602768689395 - actor/ppo_kl:-0.31694278858267355 - actor/pg_clipfrac_lower:0.032912925077835095 - actor/grad_norm:26.87010955810547 - perf/mfu/actor:0.0956707749660882 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.51311874389648 - actor/lr:1e-06 - training/global_step:123 - training/epoch:3 - critic/score/mean:1.3859374523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3859374523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026334552094340324 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.026334552094340324 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:388.5375061035156 - response_length/max:1036.0 - response_length/min:46.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011192448437213898 - timing_s/generate_sequences:27.81835174560547 - timing_s/reshard:0.7223909497261047 - timing_s/gen:34.58640030398965 - timing_s/reward:0.07764110341668129 - timing_s/old_log_prob:1.210649473592639 - timing_s/ref:1.3648912366479635 - timing_s/adv:0.01106301136314869 - timing_s/update_actor:7.1391996163874865 - timing_s/step:44.40448718518019 - timing_s/stop_profile:4.166550934314728e-05 - timing_per_token_ms/adv:4.334407379474249e-05 - timing_per_token_ms/gen:0.2781777845123512 - timing_per_token_ms/ref:0.005347544582673999 - timing_per_token_ms/update_actor:0.027970864789930484 - perf/total_num_tokens:255237 - perf/time_per_step:44.40448718518019 - perf/throughput:718.5000215619658
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3484375476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3484375476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.020806865766644478, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.020806865766644478, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 370.0406188964844, 'response_length/max': 1082.0, 'response_length/min': 79.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:124 - global_seqlen/min:25993 - global_seqlen/max:36332 - global_seqlen/minmax_diff:10339 - global_seqlen/balanced_min:31182 - global_seqlen/balanced_max:31183 - global_seqlen/mean:31182.25 - actor/entropy:0.373963326215744 - actor/kl_loss:0.5644479390233755 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.006971199717372656 - actor/pg_clipfrac:0.03220669198781252 - actor/ppo_kl:0.02237401467282325 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:18.306145668029785 - perf/mfu/actor:0.0937124402699428 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.47237014770508 - actor/lr:1e-06 - training/global_step:124 - training/epoch:3 - critic/score/mean:1.3484375476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3484375476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.020806865766644478 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.020806865766644478 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:370.0406188964844 - response_length/max:1082.0 - response_length/min:79.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.548477828502655e-05 - timing_s/generate_sequences:28.056415557861328 - timing_s/reshard:0.7005959153175354 - timing_s/gen:35.98145593702793 - timing_s/reward:0.07651297375559807 - timing_s/old_log_prob:1.1495396960526705 - timing_s/ref:1.382974011823535 - timing_s/adv:0.010221205651760101 - timing_s/update_actor:7.126266825944185 - timing_s/step:45.74855837970972 - timing_s/stop_profile:4.5282766222953796e-05 - timing_per_token_ms/adv:4.097365348780196e-05 - timing_per_token_ms/gen:0.3038640684471125 - timing_per_token_ms/ref:0.0055439152555682115 - timing_per_token_ms/update_actor:0.028567000560992973 - perf/total_num_tokens:249458 - perf/time_per_step:45.74855837970972 - perf/throughput:681.6007127741509
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3796875476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3796875476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021472789347171783, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.021472789347171783, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 359.3125, 'response_length/max': 933.0, 'response_length/min': 78.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  24%|██▍       | 125/525 [2:00:33<5:04:40, 45.70s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  24%|██▍       | 126/525 [2:01:18<5:04:15, 45.75s/it]
[36m(TaskRunner pid=2949575)[0m step:125 - global_seqlen/min:26683 - global_seqlen/max:33963 - global_seqlen/minmax_diff:7280 - global_seqlen/balanced_min:30779 - global_seqlen/balanced_max:30780 - global_seqlen/mean:30779.375 - actor/entropy:0.3554375171661377 - actor/kl_loss:0.8001851946115494 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10168802365660667 - actor/pg_clipfrac:0.04284975629416295 - actor/ppo_kl:0.147674676400311 - actor/pg_clipfrac_lower:0.0003945870412280783 - actor/grad_norm:10.912375450134277 - perf/mfu/actor:0.0931601613227097 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.52234268188477 - actor/lr:1e-06 - training/global_step:125 - training/epoch:3 - critic/score/mean:1.3796875476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3796875476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021472789347171783 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.021472789347171783 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:359.3125 - response_length/max:933.0 - response_length/min:78.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.804964065551758e-05 - timing_s/generate_sequences:27.035091400146484 - timing_s/reshard:0.7065489292144775 - timing_s/gen:31.886752346530557 - timing_s/reward:0.07596245966851711 - timing_s/old_log_prob:1.1351283565163612 - timing_s/ref:1.365903839468956 - timing_s/adv:0.00765160471200943 - timing_s/update_actor:7.06764305010438 - timing_s/step:41.55386698804796 - timing_s/stop_profile:4.2947009205818176e-05 - timing_per_token_ms/adv:3.107439930151859e-05 - timing_per_token_ms/gen:0.27732433768073195 - timing_per_token_ms/ref:0.005547155520007132 - timing_per_token_ms/update_actor:0.028702836924500496 - perf/total_num_tokens:246235 - perf/time_per_step:41.55386698804796 - perf/throughput:740.7102450622225
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02821955271065235, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.02821955271065235, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 372.890625, 'response_length/max': 1118.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:126 - global_seqlen/min:28542 - global_seqlen/max:35099 - global_seqlen/minmax_diff:6557 - global_seqlen/balanced_min:31318 - global_seqlen/balanced_max:31319 - global_seqlen/mean:31318.125 - actor/entropy:0.3373728096485138 - actor/kl_loss:0.5493659619241953 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05705696754157543 - actor/pg_clipfrac:0.005100096011301502 - actor/ppo_kl:0.002996484892355511 - actor/pg_clipfrac_lower:0.0006891301658470183 - actor/grad_norm:53.596431732177734 - perf/mfu/actor:0.09430980587752608 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.43357467651367 - actor/lr:1e-06 - training/global_step:126 - training/epoch:3 - critic/score/mean:1.375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02821955271065235 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.02821955271065235 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:372.890625 - response_length/max:1118.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.444301784038544e-05 - timing_s/generate_sequences:31.489978790283203 - timing_s/reshard:0.7002556324005127 - timing_s/gen:35.941528929397464 - timing_s/reward:0.07640425115823746 - timing_s/old_log_prob:1.3432486280798912 - timing_s/ref:1.35648650303483 - timing_s/adv:0.007740044966340065 - timing_s/update_actor:7.105586100369692 - timing_s/step:45.85824798606336 - timing_s/stop_profile:4.160962998867035e-05 - timing_per_token_ms/adv:3.089283348835565e-05 - timing_per_token_ms/gen:0.3012070306255811 - timing_per_token_ms/ref:0.005414143180006905 - timing_per_token_ms/update_actor:0.028360518471211526 - perf/total_num_tokens:250545 - perf/time_per_step:45.85824798606336 - perf/throughput:682.9333080827204
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00725792208686471, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.00725792208686471, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 380.79376220703125, 'response_length/max': 1226.0, 'response_length/min': 95.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  24%|██▍       | 127/525 [2:02:08<5:11:46, 47.00s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  24%|██▍       | 128/525 [2:02:59<5:18:06, 48.08s/it]
[36m(TaskRunner pid=2949575)[0m step:127 - global_seqlen/min:29233 - global_seqlen/max:35324 - global_seqlen/minmax_diff:6091 - global_seqlen/balanced_min:31621 - global_seqlen/balanced_max:31622 - global_seqlen/mean:31621.125 - actor/entropy:0.3428148031234741 - actor/kl_loss:0.9956948157399893 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.050050996243953705 - actor/pg_clipfrac:0.03129271083744243 - actor/ppo_kl:0.12272839461220428 - actor/pg_clipfrac_lower:0.00019980019424110652 - actor/grad_norm:11.982745170593262 - perf/mfu/actor:0.09550489670781201 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.38730239868164 - actor/lr:1e-06 - training/global_step:127 - training/epoch:3 - critic/score/mean:1.3125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00725792208686471 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.00725792208686471 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:380.79376220703125 - response_length/max:1226.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.291937410831451e-05 - timing_s/generate_sequences:30.430654525756836 - timing_s/reshard:0.6833575963973999 - timing_s/gen:40.14033050276339 - timing_s/reward:0.0778166875243187 - timing_s/old_log_prob:1.21018142439425 - timing_s/ref:1.3585703484714031 - timing_s/adv:0.0078408382833004 - timing_s/update_actor:7.087705358862877 - timing_s/step:49.89747506566346 - timing_s/stop_profile:4.485994577407837e-05 - timing_per_token_ms/adv:3.099525350260467e-05 - timing_per_token_ms/gen:0.3294133184201043 - timing_per_token_ms/ref:0.0053705013202068365 - timing_per_token_ms/update_actor:0.028018078732425226 - perf/total_num_tokens:252969 - perf/time_per_step:49.89747506566346 - perf/throughput:633.7219460180626
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3937499523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3937499523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.034674953669309616, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.034674953669309616, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 372.65313720703125, 'response_length/max': 1282.0, 'response_length/min': 113.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.39375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:128 - global_seqlen/min:27457 - global_seqlen/max:35223 - global_seqlen/minmax_diff:7766 - global_seqlen/balanced_min:31271 - global_seqlen/balanced_max:31327 - global_seqlen/mean:31291.125 - actor/entropy:0.35698941349983215 - actor/kl_loss:0.9694397322833538 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07022104486823082 - actor/pg_clipfrac:0.027017630438786 - actor/ppo_kl:0.030579764262074604 - actor/pg_clipfrac_lower:0.0002781211398541927 - actor/grad_norm:45.37493169307709 - perf/mfu/actor:0.09492291277513802 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.38370132446289 - actor/lr:1e-06 - training/global_step:128 - training/epoch:3 - critic/score/mean:1.3937499523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3937499523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.034674953669309616 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.034674953669309616 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:372.65313720703125 - response_length/max:1282.0 - response_length/min:113.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.39375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.2455575466156e-05 - timing_s/generate_sequences:32.611961364746094 - timing_s/reshard:0.6542671322822571 - timing_s/gen:40.93204245902598 - timing_s/reward:0.07793737947940826 - timing_s/old_log_prob:1.1257419865578413 - timing_s/ref:1.3595898784697056 - timing_s/adv:0.007868858054280281 - timing_s/update_actor:7.0527112279087305 - timing_s/step:50.571663320064545 - timing_s/stop_profile:4.593096673488617e-05 - timing_per_token_ms/adv:3.143406498759745e-05 - timing_per_token_ms/gen:0.3432485174636767 - timing_per_token_ms/ref:0.0054312120388357145 - timing_per_token_ms/update_actor:0.028173768232640766 - perf/total_num_tokens:250329 - perf/time_per_step:50.571663320064545 - perf/throughput:618.7481871411001
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.334375023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.334375023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.013271286152303219, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.013271286152303219, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 352.99688720703125, 'response_length/max': 1392.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.334375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  25%|██▍       | 129/525 [2:03:53<5:29:02, 49.85s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 01:44:33,312:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 01:44:36,832:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 01:44:36,834:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:44:37,663:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/huggingface
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 01:44:33,674:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  25%|██▍       | 130/525 [2:04:52<5:46:42, 52.67s/it]
[36m(TaskRunner pid=2949575)[0m step:129 - global_seqlen/min:27917 - global_seqlen/max:33925 - global_seqlen/minmax_diff:6008 - global_seqlen/balanced_min:30498 - global_seqlen/balanced_max:30578 - global_seqlen/mean:30509.25 - actor/entropy:0.356734037399292 - actor/kl_loss:0.9028807856142521 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.16400279738008977 - actor/pg_clipfrac:0.004282733239233494 - actor/ppo_kl:0.007643054302752717 - actor/pg_clipfrac_lower:0.002843601815402508 - actor/grad_norm:20.659291237592697 - perf/mfu/actor:0.09241792589536688 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.44987487792969 - actor/lr:1e-06 - training/global_step:129 - training/epoch:3 - critic/score/mean:1.334375023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.334375023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.013271286152303219 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.013271286152303219 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:352.99688720703125 - response_length/max:1392.0 - response_length/min:92.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.334375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.341670036315918e-05 - timing_s/generate_sequences:30.29619026184082 - timing_s/reshard:0.6554732322692871 - timing_s/gen:44.333964763209224 - timing_s/reward:0.07807659730315208 - timing_s/old_log_prob:1.1365238931030035 - timing_s/ref:1.3565649185329676 - timing_s/adv:0.007961446419358253 - timing_s/update_actor:7.059667631983757 - timing_s/step:53.98792317323387 - timing_s/stop_profile:4.643574357032776e-05 - timing_per_token_ms/adv:3.261898612452885e-05 - timing_per_token_ms/gen:0.39247837501402477 - timing_per_token_ms/ref:0.0055580066640976405 - timing_per_token_ms/update_actor:0.028924291944179868 - perf/total_num_tokens:244074 - perf/time_per_step:53.98792317323387 - perf/throughput:565.1124956613608
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.027568943798542023, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.027568943798542023, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 410.76873779296875, 'response_length/max': 1276.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:130 - global_seqlen/min:29356 - global_seqlen/max:37085 - global_seqlen/minmax_diff:7729 - global_seqlen/balanced_min:32793 - global_seqlen/balanced_max:32795 - global_seqlen/mean:32793.875 - actor/entropy:0.32030588388442993 - actor/kl_loss:1.374608564004302 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2323754295706749 - actor/pg_clipfrac:0.07724275997607037 - actor/ppo_kl:0.07364172685629455 - actor/pg_clipfrac_lower:0.0015841107873711736 - actor/grad_norm:35.78626310825348 - perf/mfu/actor:0.09571946429587935 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.37837219238281 - actor/lr:1e-06 - training/global_step:130 - training/epoch:3 - critic/score/mean:1.3125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.027568943798542023 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.027568943798542023 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:410.76873779296875 - response_length/max:1276.0 - response_length/min:112.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010016001760959625 - timing_s/generate_sequences:32.25489807128906 - timing_s/reshard:0.6388640999794006 - timing_s/gen:41.056555300951004 - timing_s/reward:0.07959489896893501 - timing_s/old_log_prob:1.1611224878579378 - timing_s/ref:1.3592509683221579 - timing_s/adv:0.007956404238939285 - timing_s/update_actor:7.341867960989475 - timing_s/save_checkpoint:8.016406016424298 - timing_s/step:59.03756280615926 - timing_s/stop_profile:5.280040204524994e-05 - timing_per_token_ms/adv:3.0327325754196803e-05 - timing_per_token_ms/gen:0.3123454140936278 - timing_per_token_ms/ref:0.005181039783809316 - timing_per_token_ms/update_actor:0.027984905569216338 - perf/total_num_tokens:262351 - perf/time_per_step:59.03756280615926 - perf/throughput:555.4747425410096
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4296875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4296875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.017410600557923317, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.017410600557923317, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 381.73126220703125, 'response_length/max': 1031.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  25%|██▍       | 131/525 [2:05:37<5:30:49, 50.38s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:44:38,729:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:44:38,731:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_130/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  25%|██▌       | 132/525 [2:06:32<5:39:20, 51.81s/it]
[36m(TaskRunner pid=2949575)[0m step:131 - global_seqlen/min:29631 - global_seqlen/max:34438 - global_seqlen/minmax_diff:4807 - global_seqlen/balanced_min:31641 - global_seqlen/balanced_max:31642 - global_seqlen/mean:31641.125 - actor/entropy:0.32819831371307373 - actor/kl_loss:0.8676040079444647 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22437966745346785 - actor/pg_clipfrac:0.022045391920255498 - actor/ppo_kl:0.06594055834721076 - actor/pg_clipfrac_lower:0.0001718253712169826 - actor/grad_norm:15.943353295326233 - perf/mfu/actor:0.09547828076495157 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.32101821899414 - actor/lr:1e-06 - training/global_step:131 - training/epoch:3 - critic/score/mean:1.4296875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4296875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.017410600557923317 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.017410600557923317 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:381.73126220703125 - response_length/max:1031.0 - response_length/min:100.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010317191481590271 - timing_s/generate_sequences:28.056306838989258 - timing_s/reshard:0.6974814534187317 - timing_s/gen:35.01957840844989 - timing_s/reward:0.07703417725861073 - timing_s/old_log_prob:1.1367818508297205 - timing_s/ref:1.3660142067819834 - timing_s/adv:0.007644737139344215 - timing_s/update_actor:7.0960849560797215 - timing_s/step:44.71729184500873 - timing_s/stop_profile:4.1620805859565735e-05 - timing_per_token_ms/adv:3.0200953424318098e-05 - timing_per_token_ms/gen:0.28668384505173705 - timing_per_token_ms/ref:0.005396514057188166 - timing_per_token_ms/update_actor:0.028033472877780585 - perf/total_num_tokens:253129 - perf/time_per_step:44.71729184500873 - perf/throughput:707.5814230805601
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2921874523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2921874523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01855025254189968, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.01855025254189968, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 412.54998779296875, 'response_length/max': 1426.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:132 - global_seqlen/min:30898 - global_seqlen/max:34041 - global_seqlen/minmax_diff:3143 - global_seqlen/balanced_min:32859 - global_seqlen/balanced_max:32872 - global_seqlen/mean:32860.75 - actor/entropy:0.3309688866138458 - actor/kl_loss:0.9062523139640689 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.021898428723216058 - actor/pg_clipfrac:0.02555478665162809 - actor/ppo_kl:0.01496723401651252 - actor/pg_clipfrac_lower:0.0006487672973889858 - actor/grad_norm:34.31816112995148 - perf/mfu/actor:0.09814151157049855 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.33729934692383 - actor/lr:1e-06 - training/global_step:132 - training/epoch:3 - critic/score/mean:1.2921874523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2921874523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01855025254189968 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01855025254189968 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:412.54998779296875 - response_length/max:1426.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.715929627418518e-05 - timing_s/generate_sequences:35.583770751953125 - timing_s/reshard:0.6829561591148376 - timing_s/gen:45.16984214633703 - timing_s/reward:0.08064541965723038 - timing_s/old_log_prob:1.2003179341554642 - timing_s/ref:1.3631805013865232 - timing_s/adv:0.00789235346019268 - timing_s/update_actor:7.181369556114078 - timing_s/step:55.01708482950926 - timing_s/stop_profile:4.2980536818504333e-05 - timing_per_token_ms/adv:3.002196183970497e-05 - timing_per_token_ms/gen:0.3421543005873306 - timing_per_token_ms/ref:0.0051854435054986695 - timing_per_token_ms/update_actor:0.027317428680546235 - perf/total_num_tokens:262886 - perf/time_per_step:55.01708482950926 - perf/throughput:597.2826459604532
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3624999523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3624999523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.032902806997299194, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.032902806997299194, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 392.0375061035156, 'response_length/max': 1101.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  25%|██▌       | 133/525 [2:07:19<5:28:43, 50.32s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  26%|██▌       | 134/525 [2:08:06<5:21:05, 49.27s/it]
[36m(TaskRunner pid=2949575)[0m step:133 - global_seqlen/min:30141 - global_seqlen/max:34239 - global_seqlen/minmax_diff:4098 - global_seqlen/balanced_min:32057 - global_seqlen/balanced_max:32058 - global_seqlen/mean:32057.75 - actor/entropy:0.29854080080986023 - actor/kl_loss:0.7821685185655951 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.18159072250127792 - actor/pg_clipfrac:0.04593463816563599 - actor/ppo_kl:0.13204042991856113 - actor/pg_clipfrac_lower:4.440497432369739e-05 - actor/grad_norm:21.888561606407166 - perf/mfu/actor:0.09575735703582806 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.34402847290039 - actor/lr:1e-06 - training/global_step:133 - training/epoch:3 - critic/score/mean:1.3624999523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3624999523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.032902806997299194 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.032902806997299194 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:392.0375061035156 - response_length/max:1101.0 - response_length/min:100.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.546801447868347e-05 - timing_s/generate_sequences:33.2559928894043 - timing_s/reshard:0.6550818085670471 - timing_s/gen:36.654393715783954 - timing_s/reward:0.07976905815303326 - timing_s/old_log_prob:1.4106511361896992 - timing_s/ref:1.3589175287634134 - timing_s/adv:0.007698411121964455 - timing_s/update_actor:7.17483239248395 - timing_s/step:46.70004253834486 - timing_s/stop_profile:4.270672798156738e-05 - timing_per_token_ms/adv:3.001774579456003e-05 - timing_per_token_ms/gen:0.29217863179370557 - timing_per_token_ms/ref:0.0052987090826844266 - timing_per_token_ms/update_actor:0.02797620073337941 - perf/total_num_tokens:256462 - perf/time_per_step:46.70004253834486 - perf/throughput:686.4608308156841
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3718750476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3718750476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.008999120444059372, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.008999120444059372, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 384.8843688964844, 'response_length/max': 1109.0, 'response_length/min': 132.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.371875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:134 - global_seqlen/min:29037 - global_seqlen/max:37481 - global_seqlen/minmax_diff:8444 - global_seqlen/balanced_min:31767 - global_seqlen/balanced_max:31768 - global_seqlen/mean:31767.25 - actor/entropy:0.3085764944553375 - actor/kl_loss:0.5560868836939334 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.01348239639773965 - actor/pg_clipfrac:0.005460007017245516 - actor/ppo_kl:-0.014189603985869326 - actor/pg_clipfrac_lower:0.006080447835847736 - actor/grad_norm:41.089786529541016 - perf/mfu/actor:0.09305789316424364 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.34497451782227 - actor/lr:1e-06 - training/global_step:134 - training/epoch:3 - critic/score/mean:1.3718750476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3718750476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.008999120444059372 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.008999120444059372 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:384.8843688964844 - response_length/max:1109.0 - response_length/min:132.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.371875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.992982864379883e-05 - timing_s/generate_sequences:28.899383544921875 - timing_s/reshard:0.6698964238166809 - timing_s/gen:36.91327705420554 - timing_s/reward:0.07914935238659382 - timing_s/old_log_prob:1.1359910871833563 - timing_s/ref:1.367143439128995 - timing_s/adv:0.007703930139541626 - timing_s/update_actor:7.307931628078222 - timing_s/step:46.82970467954874 - timing_s/stop_profile:4.449300467967987e-05 - timing_per_token_ms/adv:3.031396382887103e-05 - timing_per_token_ms/gen:0.29971076584855466 - timing_per_token_ms/ref:0.0053795317470389905 - timing_per_token_ms/update_actor:0.028755761153696897 - perf/total_num_tokens:254138 - perf/time_per_step:46.82970467954874 - perf/throughput:678.3568296528945
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3703124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3703124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.010016564279794693, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.010016564279794693, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 418.3843688964844, 'response_length/max': 1215.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  26%|██▌       | 135/525 [2:08:57<5:23:01, 49.70s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  26%|██▌       | 136/525 [2:09:39<5:07:36, 47.45s/it]
[36m(TaskRunner pid=2949575)[0m step:135 - global_seqlen/min:29128 - global_seqlen/max:37868 - global_seqlen/minmax_diff:8740 - global_seqlen/balanced_min:33094 - global_seqlen/balanced_max:33095 - global_seqlen/mean:33094.125 - actor/entropy:0.30882081389427185 - actor/kl_loss:0.7964397307485342 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1550901547074318 - actor/pg_clipfrac:0.015663102798862384 - actor/ppo_kl:0.14392379110504408 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:15.652943968772888 - perf/mfu/actor:0.09814248892750022 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.36713409423828 - actor/lr:1e-06 - training/global_step:135 - training/epoch:3 - critic/score/mean:1.3703124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3703124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.010016564279794693 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.010016564279794693 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:418.3843688964844 - response_length/max:1215.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.394755423069e-05 - timing_s/generate_sequences:35.910728454589844 - timing_s/reshard:0.7523080706596375 - timing_s/gen:40.67236412502825 - timing_s/reward:0.09068438969552517 - timing_s/old_log_prob:1.276550417765975 - timing_s/ref:1.3722416460514069 - timing_s/adv:0.007955402135848999 - timing_s/update_actor:7.238843927159905 - timing_s/step:50.67230123281479 - timing_s/stop_profile:4.396773874759674e-05 - timing_per_token_ms/adv:3.0048392788179922e-05 - timing_per_token_ms/gen:0.30379035519840647 - timing_per_token_ms/ref:0.005183101404144266 - timing_per_token_ms/update_actor:0.02734187687074332 - perf/total_num_tokens:264753 - perf/time_per_step:50.67230123281479 - perf/throughput:653.1008893389004
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.027360472828149796, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.027360472828149796, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 362.390625, 'response_length/max': 962.0, 'response_length/min': 94.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.390625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:136 - global_seqlen/min:28652 - global_seqlen/max:33827 - global_seqlen/minmax_diff:5175 - global_seqlen/balanced_min:30911 - global_seqlen/balanced_max:30912 - global_seqlen/mean:30911.25 - actor/entropy:0.3467468321323395 - actor/kl_loss:0.41207766681909563 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10934857353568077 - actor/pg_clipfrac:0.02046741418307647 - actor/ppo_kl:0.008326184091856703 - actor/pg_clipfrac_lower:0.0038125805382151156 - actor/grad_norm:32.12915062904358 - perf/mfu/actor:0.09422374972181399 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.31914520263672 - actor/lr:1e-06 - training/global_step:136 - training/epoch:3 - critic/score/mean:1.375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.027360472828149796 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.027360472828149796 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:362.390625 - response_length/max:962.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.315034210681915e-05 - timing_s/generate_sequences:27.593894958496094 - timing_s/reshard:0.6455200910568237 - timing_s/gen:32.59799440018833 - timing_s/reward:0.07614311203360558 - timing_s/old_log_prob:1.1131751351058483 - timing_s/ref:1.3575712945312262 - timing_s/adv:0.007684402167797089 - timing_s/update_actor:7.012689206749201 - timing_s/step:42.17973833344877 - timing_s/stop_profile:4.393234848976135e-05 - timing_per_token_ms/adv:3.107445577175417e-05 - timing_per_token_ms/gen:0.28110200836621674 - timing_per_token_ms/ref:0.005489794551058378 - timing_per_token_ms/update_actor:0.02835815927352178 - perf/total_num_tokens:247290 - perf/time_per_step:42.17973833344877 - perf/throughput:732.8459402861494
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.381250023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.381250023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.028703024610877037, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.028703024610877037, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 381.15936279296875, 'response_length/max': 949.0, 'response_length/min': 107.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.38125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  26%|██▌       | 137/525 [2:10:21<4:56:50, 45.90s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  26%|██▋       | 138/525 [2:11:09<4:59:03, 46.36s/it]
[36m(TaskRunner pid=2949575)[0m step:137 - global_seqlen/min:28771 - global_seqlen/max:33716 - global_seqlen/minmax_diff:4945 - global_seqlen/balanced_min:31622 - global_seqlen/balanced_max:31623 - global_seqlen/mean:31622.625 - actor/entropy:0.31184086203575134 - actor/kl_loss:0.8764336179941893 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1314997658599168 - actor/pg_clipfrac:0.04418565537198447 - actor/ppo_kl:0.1475862939340004 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:22.16546595096588 - perf/mfu/actor:0.09604224298593379 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.39407348632812 - actor/lr:1e-06 - training/global_step:137 - training/epoch:3 - critic/score/mean:1.381250023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.381250023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.028703024610877037 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.028703024610877037 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:381.15936279296875 - response_length/max:949.0 - response_length/min:107.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.38125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.643046021461487e-05 - timing_s/generate_sequences:28.240936279296875 - timing_s/reshard:0.6590443849563599 - timing_s/gen:32.57189321517944 - timing_s/reward:0.07899814285337925 - timing_s/old_log_prob:1.2103868704289198 - timing_s/ref:1.363408636301756 - timing_s/adv:0.007746407762169838 - timing_s/update_actor:7.045687962323427 - timing_s/step:42.2927285656333 - timing_s/stop_profile:4.377216100692749e-05 - timing_per_token_ms/adv:3.062051206284202e-05 - timing_per_token_ms/gen:0.2670462094692955 - timing_per_token_ms/ref:0.0053893716773265815 - timing_per_token_ms/update_actor:0.02785066057262572 - perf/total_num_tokens:252981 - perf/time_per_step:42.2927285656333 - perf/throughput:747.7083194319193
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4265625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4265625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.012673336081206799, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.012673336081206799, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 370.28125, 'response_length/max': 1119.0, 'response_length/min': 94.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:138 - global_seqlen/min:29402 - global_seqlen/max:32951 - global_seqlen/minmax_diff:3549 - global_seqlen/balanced_min:31170 - global_seqlen/balanced_max:31170 - global_seqlen/mean:31170.0 - actor/entropy:0.3399823009967804 - actor/kl_loss:0.6026438359171152 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.01722075454890728 - actor/pg_clipfrac:0.01572201038361527 - actor/ppo_kl:0.00014221395540516823 - actor/pg_clipfrac_lower:0.0029490106739103795 - actor/grad_norm:41.26173210144043 - perf/mfu/actor:0.09417046734906362 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.35969924926758 - actor/lr:1e-06 - training/global_step:138 - training/epoch:3 - critic/score/mean:1.4265625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4265625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.012673336081206799 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.012673336081206799 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:370.28125 - response_length/max:1119.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.693391621112823e-05 - timing_s/generate_sequences:31.84981346130371 - timing_s/reshard:0.696670413017273 - timing_s/gen:37.553991325199604 - timing_s/reward:0.0798029787838459 - timing_s/old_log_prob:1.2100540846586227 - timing_s/ref:1.3636547327041626 - timing_s/adv:0.007759176194667816 - timing_s/update_actor:7.083368673920631 - timing_s/step:47.313075967133045 - timing_s/stop_profile:4.392676055431366e-05 - timing_per_token_ms/adv:3.111636266709904e-05 - timing_per_token_ms/gen:0.3169380650282691 - timing_per_token_ms/ref:0.0054686185944183615 - timing_per_token_ms/update_actor:0.0284061945537401 - perf/total_num_tokens:249360 - perf/time_per_step:47.313075967133045 - perf/throughput:658.8030763768742
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3515625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3515625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.015034032054245472, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.015034032054245472, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 359.1656188964844, 'response_length/max': 991.0, 'response_length/min': 33.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  26%|██▋       | 139/525 [2:11:52<4:51:52, 45.37s/it]
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 01:52:27,317:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 01:52:30,647:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 01:52:30,649:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 01:52:31,708:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/huggingface
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:52:27,671:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  27%|██▋       | 140/525 [2:12:46<5:08:48, 48.13s/it]
[36m(TaskRunner pid=2949575)[0m step:139 - global_seqlen/min:26046 - global_seqlen/max:35280 - global_seqlen/minmax_diff:9234 - global_seqlen/balanced_min:30747 - global_seqlen/balanced_max:30748 - global_seqlen/mean:30747.25 - actor/entropy:0.3286978006362915 - actor/kl_loss:0.7410404339432717 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10708780363202094 - actor/pg_clipfrac:0.02399679200607352 - actor/ppo_kl:0.18426056079497358 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:28.5030916929245 - perf/mfu/actor:0.09278492479588928 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.28091049194336 - actor/lr:1e-06 - training/global_step:139 - training/epoch:3 - critic/score/mean:1.3515625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3515625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.015034032054245472 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.015034032054245472 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:359.1656188964844 - response_length/max:991.0 - response_length/min:33.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.706616401672363e-05 - timing_s/generate_sequences:28.3392391204834 - timing_s/reshard:0.6478853821754456 - timing_s/gen:33.24268040060997 - timing_s/reward:0.07774443365633488 - timing_s/old_log_prob:1.1408322155475616 - timing_s/ref:1.3570743221789598 - timing_s/adv:0.0076728928834199905 - timing_s/update_actor:7.086352486163378 - timing_s/step:42.92697134427726 - timing_s/stop_profile:4.51505184173584e-05 - timing_per_token_ms/adv:3.1193411131971117e-05 - timing_per_token_ms/gen:0.28923529709143564 - timing_per_token_ms/ref:0.005517055680503784 - timing_per_token_ms/update_actor:0.02880888732392075 - perf/total_num_tokens:245978 - perf/time_per_step:42.92697134427726 - perf/throughput:716.2687941202499
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3859374523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3859374523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.009904956445097923, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.009904956445097923, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 373.49688720703125, 'response_length/max': 1114.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:140 - global_seqlen/min:28667 - global_seqlen/max:34737 - global_seqlen/minmax_diff:6070 - global_seqlen/balanced_min:31329 - global_seqlen/balanced_max:31330 - global_seqlen/mean:31329.25 - actor/entropy:0.30651625990867615 - actor/kl_loss:1.488222496956587 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06821472533047199 - actor/pg_clipfrac:0.0465990808152128 - actor/ppo_kl:-0.007909007029957138 - actor/pg_clipfrac_lower:0.0005223171785473824 - actor/grad_norm:40.76317071914673 - perf/mfu/actor:0.0949731533549083 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.26214981079102 - actor/lr:1e-06 - training/global_step:140 - training/epoch:3 - critic/score/mean:1.3859374523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3859374523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.009904956445097923 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.009904956445097923 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:373.49688720703125 - response_length/max:1114.0 - response_length/min:80.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010037794709205627 - timing_s/generate_sequences:29.711566925048828 - timing_s/reshard:0.6762110590934753 - timing_s/gen:36.43401104211807 - timing_s/reward:0.07821654714643955 - timing_s/old_log_prob:1.2822927795350552 - timing_s/ref:1.3580323550850153 - timing_s/adv:0.007879132404923439 - timing_s/update_actor:7.058377753943205 - timing_s/save_checkpoint:8.209266018122435 - timing_s/step:54.44304111413658 - timing_s/stop_profile:4.9388036131858826e-05 - timing_per_token_ms/adv:3.143680587998212e-05 - timing_per_token_ms/gen:0.30483865362091445 - timing_per_token_ms/ref:0.005418388387389641 - timing_per_token_ms/update_actor:0.028162091950586134 - perf/total_num_tokens:250634 - perf/time_per_step:54.44304111413658 - perf/throughput:575.4500365679445
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3624999523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3624999523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03612859174609184, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.03612859174609184, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 381.1468811035156, 'response_length/max': 1192.0, 'response_length/min': 104.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  27%|██▋       | 141/525 [2:13:37<5:13:30, 48.98s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:52:32,819:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 01:52:32,821:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_140/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  27%|██▋       | 142/525 [2:14:27<5:13:50, 49.17s/it]
[36m(TaskRunner pid=2949575)[0m step:141 - global_seqlen/min:28878 - global_seqlen/max:34054 - global_seqlen/minmax_diff:5176 - global_seqlen/balanced_min:31611 - global_seqlen/balanced_max:31614 - global_seqlen/mean:31613.375 - actor/entropy:0.3372446596622467 - actor/kl_loss:1.0310845986008643 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14388842713087796 - actor/pg_clipfrac:0.05878678412991576 - actor/ppo_kl:0.22174625017833022 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:18.408364057540894 - perf/mfu/actor:0.09092612276289774 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.03897857666016 - actor/lr:1e-06 - training/global_step:141 - training/epoch:4 - critic/score/mean:1.3624999523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3624999523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03612859174609184 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.03612859174609184 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:381.1468811035156 - response_length/max:1192.0 - response_length/min:104.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0003225281834602356 - timing_s/generate_sequences:29.24700164794922 - timing_s/reshard:0.7010912895202637 - timing_s/gen:39.23965513892472 - timing_s/reward:0.08071948401629925 - timing_s/old_log_prob:1.2441046182066202 - timing_s/ref:1.3704022206366062 - timing_s/adv:0.009382853284478188 - timing_s/update_actor:7.438345946371555 - timing_s/step:49.40547441132367 - timing_s/stop_profile:4.272721707820892e-05 - timing_per_token_ms/adv:3.710001417310785e-05 - timing_per_token_ms/gen:0.3217235411129627 - timing_per_token_ms/ref:0.00541860138563427 - timing_per_token_ms/update_actor:0.029411388163916204 - perf/total_num_tokens:252907 - perf/time_per_step:49.40547441132367 - perf/throughput:639.875952547361
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3312499523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3312499523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.019826939329504967, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.019826939329504967, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 373.3843688964844, 'response_length/max': 1204.0, 'response_length/min': 98.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.33125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:142 - global_seqlen/min:27597 - global_seqlen/max:35019 - global_seqlen/minmax_diff:7422 - global_seqlen/balanced_min:31302 - global_seqlen/balanced_max:31303 - global_seqlen/mean:31302.875 - actor/entropy:0.33352380990982056 - actor/kl_loss:1.186155454069376 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09020723849534988 - actor/pg_clipfrac:0.028570208384189756 - actor/ppo_kl:0.1649030520537053 - actor/pg_clipfrac_lower:5.434782360680401e-05 - actor/grad_norm:60.306127071380615 - perf/mfu/actor:0.09419525168176089 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.34643173217773 - actor/lr:1e-06 - training/global_step:142 - training/epoch:4 - critic/score/mean:1.3312499523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3312499523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.019826939329504967 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.019826939329504967 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:373.3843688964844 - response_length/max:1204.0 - response_length/min:98.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.33125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.87667590379715e-05 - timing_s/generate_sequences:31.003454208374023 - timing_s/reshard:0.7911719679832458 - timing_s/gen:39.386794067919254 - timing_s/reward:0.07710270024836063 - timing_s/old_log_prob:1.1536885891109705 - timing_s/ref:1.3560702819377184 - timing_s/adv:0.007526274770498276 - timing_s/update_actor:7.1180610209703445 - timing_s/step:49.11253050714731 - timing_s/stop_profile:4.413537681102753e-05 - timing_per_token_ms/adv:3.0054247295569e-05 - timing_per_token_ms/gen:0.3296434979697468 - timing_per_token_ms/ref:0.005415118746831235 - timing_per_token_ms/update_actor:0.02842415042136842 - perf/total_num_tokens:250423 - perf/time_per_step:49.11253050714731 - perf/throughput:637.3704363582837
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2999999523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2999999523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.023551253601908684, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.023551253601908684, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 363.1187438964844, 'response_length/max': 1000.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  27%|██▋       | 143/525 [2:15:10<5:02:01, 47.44s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  27%|██▋       | 144/525 [2:15:57<4:59:54, 47.23s/it]
[36m(TaskRunner pid=2949575)[0m step:143 - global_seqlen/min:27030 - global_seqlen/max:35042 - global_seqlen/minmax_diff:8012 - global_seqlen/balanced_min:30909 - global_seqlen/balanced_max:30910 - global_seqlen/mean:30909.75 - actor/entropy:0.30709487199783325 - actor/kl_loss:1.2446905072778462 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08590190447866916 - actor/pg_clipfrac:0.041372624901123346 - actor/ppo_kl:0.10421295021660626 - actor/pg_clipfrac_lower:0.0017006803303956986 - actor/grad_norm:41.04995107650757 - perf/mfu/actor:0.09332068683072842 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.31245040893555 - actor/lr:1e-06 - training/global_step:143 - training/epoch:4 - critic/score/mean:1.2999999523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2999999523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.023551253601908684 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.023551253601908684 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:363.1187438964844 - response_length/max:1000.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.150003850460052e-05 - timing_s/generate_sequences:26.24521255493164 - timing_s/reshard:0.8044052720069885 - timing_s/gen:33.567900797352195 - timing_s/reward:0.07585985586047173 - timing_s/old_log_prob:1.2672606334090233 - timing_s/ref:1.3484766818583012 - timing_s/adv:0.007477555423974991 - timing_s/update_actor:7.092745594680309 - timing_s/step:43.39000788331032 - timing_s/stop_profile:4.43384051322937e-05 - timing_per_token_ms/adv:3.0239469034750326e-05 - timing_per_token_ms/gen:0.28888535772863727 - timing_per_token_ms/ref:0.005453282062530032 - timing_per_token_ms/update_actor:0.028683285996652794 - perf/total_num_tokens:247278 - perf/time_per_step:43.39000788331032 - perf/throughput:712.3702324075684
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.342187523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.342187523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.006330007221549749, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.006330007221549749, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 371.28125, 'response_length/max': 1095.0, 'response_length/min': 117.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:144 - global_seqlen/min:27626 - global_seqlen/max:33908 - global_seqlen/minmax_diff:6282 - global_seqlen/balanced_min:31227 - global_seqlen/balanced_max:31228 - global_seqlen/mean:31227.5 - actor/entropy:0.31305065751075745 - actor/kl_loss:0.8202488515526056 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13429357558488847 - actor/pg_clipfrac:0.03231469705933705 - actor/ppo_kl:0.06417817373003346 - actor/pg_clipfrac_lower:5.5066077038645744e-05 - actor/grad_norm:32.65609169006348 - perf/mfu/actor:0.0943803422235852 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.48114013671875 - actor/lr:1e-06 - training/global_step:144 - training/epoch:4 - critic/score/mean:1.342187523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.342187523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.006330007221549749 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.006330007221549749 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:371.28125 - response_length/max:1095.0 - response_length/min:117.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010051019489765167 - timing_s/generate_sequences:26.952091217041016 - timing_s/reshard:0.6989935636520386 - timing_s/gen:36.65429374575615 - timing_s/reward:0.07662265188992023 - timing_s/old_log_prob:1.13246382586658 - timing_s/ref:1.393579551950097 - timing_s/adv:0.012256734073162079 - timing_s/update_actor:7.087302476167679 - timing_s/step:46.36965324357152 - timing_s/stop_profile:4.423968493938446e-05 - timing_per_token_ms/adv:4.906226112065519e-05 - timing_per_token_ms/gen:0.3085118571311855 - timing_per_token_ms/ref:0.005578334608718666 - timing_per_token_ms/update_actor:0.028369636042621403 - perf/total_num_tokens:249820 - perf/time_per_step:46.36965324357152 - perf/throughput:673.446916585024
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1921875476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1921875476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04184354469180107, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.04184354469180107, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 386.1625061035156, 'response_length/max': 982.0, 'response_length/min': 106.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  28%|██▊       | 145/525 [2:16:39<4:50:03, 45.80s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  28%|██▊       | 146/525 [2:17:29<4:55:41, 46.81s/it]
[36m(TaskRunner pid=2949575)[0m step:145 - global_seqlen/min:28521 - global_seqlen/max:35618 - global_seqlen/minmax_diff:7097 - global_seqlen/balanced_min:31822 - global_seqlen/balanced_max:31823 - global_seqlen/mean:31822.75 - actor/entropy:0.2859337329864502 - actor/kl_loss:1.1516810882836581 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.027367023285478354 - actor/pg_clipfrac:0.02327623713063076 - actor/ppo_kl:-0.01502900666109781 - actor/pg_clipfrac_lower:0.0007314123213291168 - actor/grad_norm:55.35917854309082 - perf/mfu/actor:0.0964587131570299 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.38887786865234 - actor/lr:1e-06 - training/global_step:145 - training/epoch:4 - critic/score/mean:1.1921875476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1921875476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04184354469180107 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04184354469180107 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:386.1625061035156 - response_length/max:982.0 - response_length/min:106.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.266232907772064e-05 - timing_s/generate_sequences:28.932958602905273 - timing_s/reshard:0.7402162551879883 - timing_s/gen:32.80033159442246 - timing_s/reward:0.07719538547098637 - timing_s/old_log_prob:1.1337971705943346 - timing_s/ref:1.35292693041265 - timing_s/adv:0.007496809586882591 - timing_s/update_actor:7.064006678760052 - timing_s/step:42.449130373075604 - timing_s/stop_profile:4.387460649013519e-05 - timing_per_token_ms/adv:2.9447524125360752e-05 - timing_per_token_ms/gen:0.2654349819896292 - timing_per_token_ms/ref:0.0053143071011016105 - timing_per_token_ms/update_actor:0.02774747106535439 - perf/total_num_tokens:254582 - perf/time_per_step:42.449130373075604 - perf/throughput:749.667890020766
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.353124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.353124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0043095787987113, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0043095787987113, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 372.6656188964844, 'response_length/max': 1195.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.353125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:146 - global_seqlen/min:29026 - global_seqlen/max:34309 - global_seqlen/minmax_diff:5283 - global_seqlen/balanced_min:31303 - global_seqlen/balanced_max:31308 - global_seqlen/mean:31304.75 - actor/entropy:0.326511025428772 - actor/kl_loss:1.114677317813039 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12637552097439766 - actor/pg_clipfrac:0.030146585131296887 - actor/ppo_kl:0.07149722932372242 - actor/pg_clipfrac_lower:9.78473573923111e-05 - actor/grad_norm:21.992287278175354 - perf/mfu/actor:0.09436327015213647 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.45820999145508 - actor/lr:1e-06 - training/global_step:146 - training/epoch:4 - critic/score/mean:1.353124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.353124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0043095787987113 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0043095787987113 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:372.6656188964844 - response_length/max:1195.0 - response_length/min:112.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.353125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.199922740459442e-05 - timing_s/generate_sequences:29.87952995300293 - timing_s/reshard:0.6508310437202454 - timing_s/gen:39.27373493090272 - timing_s/reward:0.07822613790631294 - timing_s/old_log_prob:1.2997306566685438 - timing_s/ref:1.381406769156456 - timing_s/adv:0.00843481719493866 - timing_s/update_actor:7.097541270777583 - timing_s/step:49.156116496771574 - timing_s/stop_profile:4.3915584683418274e-05 - timing_per_token_ms/adv:3.368026096254825e-05 - timing_per_token_ms/gen:0.32933121121399644 - timing_per_token_ms/ref:0.005515963109258403 - timing_per_token_ms/update_actor:0.02834051250520122 - perf/total_num_tokens:250438 - perf/time_per_step:49.156116496771574 - perf/throughput:636.8434333508833
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.396875023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.396875023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01771312579512596, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.01771312579512596, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 374.64373779296875, 'response_length/max': 805.0, 'response_length/min': 81.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.396875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  28%|██▊       | 147/525 [2:18:07<4:38:31, 44.21s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  28%|██▊       | 148/525 [2:18:51<4:38:39, 44.35s/it]
[36m(TaskRunner pid=2949575)[0m step:147 - global_seqlen/min:29444 - global_seqlen/max:34599 - global_seqlen/minmax_diff:5155 - global_seqlen/balanced_min:31392 - global_seqlen/balanced_max:31393 - global_seqlen/mean:31392.625 - actor/entropy:0.3105519711971283 - actor/kl_loss:0.7521232157945633 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06364594325423241 - actor/pg_clipfrac:0.02389786976855248 - actor/ppo_kl:0.05448966089752503 - actor/pg_clipfrac_lower:0.0008837209083139896 - actor/grad_norm:40.42236089706421 - perf/mfu/actor:0.09463699662980575 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.40536499023438 - actor/lr:1e-06 - training/global_step:147 - training/epoch:4 - critic/score/mean:1.396875023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.396875023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01771312579512596 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01771312579512596 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:374.64373779296875 - response_length/max:805.0 - response_length/min:81.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.396875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.890405297279358e-05 - timing_s/generate_sequences:25.030017852783203 - timing_s/reshard:0.7689691781997681 - timing_s/gen:28.400185484439135 - timing_s/reward:0.07757781259715557 - timing_s/old_log_prob:1.1336507983505726 - timing_s/ref:1.3855221532285213 - timing_s/adv:0.008385533466935158 - timing_s/update_actor:7.096803173422813 - timing_s/step:38.12346261367202 - timing_s/stop_profile:4.322454333305359e-05 - timing_per_token_ms/adv:3.338974308032204e-05 - timing_per_token_ms/gen:0.23689326096824595 - timing_per_token_ms/ref:0.005516909438237967 - timing_per_token_ms/update_actor:0.0282582420768525 - perf/total_num_tokens:251141 - perf/time_per_step:38.12346261367202 - perf/throughput:823.4463201341482
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.314062476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.314062476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02879413403570652, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.02879413403570652, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 370.91876220703125, 'response_length/max': 1015.0, 'response_length/min': 103.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:148 - global_seqlen/min:28104 - global_seqlen/max:33603 - global_seqlen/minmax_diff:5499 - global_seqlen/balanced_min:31213 - global_seqlen/balanced_max:31213 - global_seqlen/mean:31213.0 - actor/entropy:0.3119605779647827 - actor/kl_loss:0.8178488224744797 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02556616170331836 - actor/pg_clipfrac:0.01882821767940186 - actor/ppo_kl:0.10057939435791922 - actor/pg_clipfrac_lower:0.0009558823890984059 - actor/grad_norm:20.688145399093628 - perf/mfu/actor:0.09383202558728063 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.3646469116211 - actor/lr:1e-06 - training/global_step:148 - training/epoch:4 - critic/score/mean:1.314062476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.314062476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02879413403570652 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.02879413403570652 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:370.91876220703125 - response_length/max:1015.0 - response_length/min:103.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.63485038280487e-05 - timing_s/generate_sequences:30.140460968017578 - timing_s/reshard:0.6738556623458862 - timing_s/gen:34.71212497353554 - timing_s/reward:0.076722402125597 - timing_s/old_log_prob:1.294068867340684 - timing_s/ref:1.4298405423760414 - timing_s/adv:0.00830031931400299 - timing_s/update_actor:7.117852386087179 - timing_s/step:44.660213969647884 - timing_s/stop_profile:4.492513835430145e-05 - timing_per_token_ms/adv:3.324063416686553e-05 - timing_per_token_ms/gen:0.29245054487619876 - timing_per_token_ms/ref:0.005726141921539268 - timing_per_token_ms/update_actor:0.028505159653378315 - perf/total_num_tokens:249704 - perf/time_per_step:44.660213969647884 - perf/throughput:698.8994728330921
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.392187476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.392187476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.014227353036403656, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.014227353036403656, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 341.9468688964844, 'response_length/max': 1088.0, 'response_length/min': 79.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  28%|██▊       | 149/525 [2:19:37<4:41:01, 44.84s/it]
[36m(TaskRunner pid=2949575)[0m step:149 - global_seqlen/min:27355 - global_seqlen/max:33749 - global_seqlen/minmax_diff:6394 - global_seqlen/balanced_min:30062 - global_seqlen/balanced_max:30063 - global_seqlen/mean:30062.875 - actor/entropy:0.31337639689445496 - actor/kl_loss:0.7371198477223515 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.028159529715776444 - actor/pg_clipfrac:0.03094857952091843 - actor/ppo_kl:0.03885881796013564 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:28.77915596961975 - perf/mfu/actor:0.09062512821619804 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.4019546508789 - actor/lr:1e-06 - training/global_step:149 - training/epoch:4 - critic/score/mean:1.392187476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.392187476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.014227353036403656 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.014227353036403656 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:341.9468688964844 - response_length/max:1088.0 - response_length/min:79.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.7665935754776e-05 - timing_s/generate_sequences:27.24147605895996 - timing_s/reshard:0.7408230304718018 - timing_s/gen:36.1491958592087 - timing_s/reward:0.07400704734027386 - timing_s/old_log_prob:1.1484228558838367 - timing_s/ref:1.3759748488664627 - timing_s/adv:0.013242874294519424 - timing_s/update_actor:7.088926153257489 - timing_s/step:45.8670346904546 - timing_s/stop_profile:4.4718384742736816e-05 - timing_per_token_ms/adv:5.50632395210015e-05 - timing_per_token_ms/gen:0.3303619518676028 - timing_per_token_ms/ref:0.005721237776104509 - timing_per_token_ms/update_actor:0.029475416744312914 - perf/total_num_tokens:240503 - perf/time_per_step:45.8670346904546 - perf/throughput:655.4353295975419
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 150}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \( C \) is centered at the origin and has foci on the \( x \)-axis, it can be represented in the standard form as:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \frac{x^2}{a^2} - \frac{y^2}{b^2} = 1
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m where \( a \) is the semi-major axis and \( b \) is the semi-minor axis. For an equilateral hyperbola (where \( a = b \)), the equation simplifies to:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x^2 - y^2 = a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The given hyperbola intersects the parabola \( y^2 = 16x \) at points \( A \) and \( B \). The distance between these points is \( |AB| = 4\sqrt{3} \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m First, substitute \( y^2 = 16x \) into the hyperbola's equation:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x^2 - 16x = a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m Rearrange this into a standard quadratic equation:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x^2 - 16x - a^2 = 0
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The solutions to this quadratic equation are the \( x \)-coordinates of points \( A \) and \( B \). Let these solutions be \( x_1 \) and \( x_2 \). By Vieta's formulas, we know:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x_1 + x_2 = 16 \quad \text{and} \quad x_1 x_2 = -a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between points \( A \) and \( B \) is given by:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m |AB| = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m Since \( y_2 = 4\sqrt{x_2} \) and \( y_1 = 4\sqrt{x_1} \), we have:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m |AB| = \sqrt{(x_2 - x_1)^2 + (4\sqrt{x_2} - 4\sqrt{x_1})^2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m = \sqrt{(x_2 - x_1)^2 + 16(x_2 - x_1)}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m = \sqrt{(x_2 - x_1)(x_2 - x_1 + 16)}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Given \( |AB| = 4\sqrt{3} \), we set up the equation:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \sqrt{(x_2 - x_1)(x_2 - x_1 + 16)} = 4\sqrt{3}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m Square both sides:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m (x_2 - x_1)^2 + 16(x_2 - x_1) = 48
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m Let \( u = x_2 - x_1 \). Then:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m u^2 + 16u = 48
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m u^2 + 16u - 48 = 0
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve this quadratic equation using the quadratic formula \( u = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a} \):
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m u = \frac{-16 \pm \sqrt{16^2 + 4 \cdot 48}}{2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m u = \frac{-16 \pm \sqrt{256 + 192}}{2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m u = \frac{-16 \pm \sqrt{448}}{2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m u = \frac{-16 \pm 8\sqrt{7}}{2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m \
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] -0.5
[36m(TaskRunner pid=2949575)[0m [structure] -0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.0
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 02:00:53,966:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/model_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:00:57,701:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:00:57,703:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:00:58,283:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  29%|██▊       | 150/525 [2:21:13<6:15:09, 60.03s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:00:54,343:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3468749523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3468749523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.007970655336976051, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.007970655336976051, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 357.90936279296875, 'response_length/max': 964.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.346875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:150 - global_seqlen/min:27605 - global_seqlen/max:33120 - global_seqlen/minmax_diff:5515 - global_seqlen/balanced_min:30714 - global_seqlen/balanced_max:30715 - global_seqlen/mean:30714.5 - actor/entropy:0.3214466869831085 - actor/kl_loss:0.7095377210527658 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10144382193684578 - actor/pg_clipfrac:0.03640200203517452 - actor/ppo_kl:0.15205148537424976 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:35.345668613910675 - perf/mfu/actor:0.09216068013047371 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.60822296142578 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:1.295 - val-aux/grpo_convert/reward/std@50:0.656814843000321 - val-aux/grpo_convert/reward/best@2/mean:1.592 - val-aux/grpo_convert/reward/best@2/std:0.45536814889657995 - val-aux/grpo_convert/reward/worst@2/mean:0.9950000000000001 - val-aux/grpo_convert/reward/worst@2/std:0.6887578645822128 - val-aux/grpo_convert/reward/best@4/mean:1.7875 - val-aux/grpo_convert/reward/best@4/std:0.3284354245228681 - val-aux/grpo_convert/reward/worst@4/mean:0.6705 - val-aux/grpo_convert/reward/worst@4/std:0.7164834627350469 - val-aux/grpo_convert/reward/best@8/mean:1.9315 - val-aux/grpo_convert/reward/best@8/std:0.19320009415210646 - val-aux/grpo_convert/reward/worst@8/mean:0.38 - val-aux/grpo_convert/reward/worst@8/std:0.7459810577349115 - val-aux/grpo_convert/reward/best@16/mean:1.9895 - val-aux/grpo_convert/reward/best@16/std:0.07169204976843667 - val-aux/grpo_convert/reward/worst@16/mean:0.02125 - val-aux/grpo_convert/reward/worst@16/std:0.7099916160435331 - val-aux/grpo_convert/reward/best@32/mean:1.9995 - val-aux/grpo_convert/reward/best@32/std:0.01580348062927911 - val-aux/grpo_convert/reward/worst@32/mean:-0.33875 - val-aux/grpo_convert/reward/worst@32/std:0.4573443324380594 - val-aux/grpo_convert/reward/best@50/mean:2.0 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.446 - val-aux/grpo_convert/reward/worst@50/std:0.27511142940890254 - val-aux/grpo_convert/score/mean@50:1.295 - val-aux/grpo_convert/score/std@50:0.656814843000321 - val-aux/grpo_convert/score/best@2/mean:1.592 - val-aux/grpo_convert/score/best@2/std:0.45536814889657995 - val-aux/grpo_convert/score/worst@2/mean:0.9950000000000001 - val-aux/grpo_convert/score/worst@2/std:0.6887578645822128 - val-aux/grpo_convert/score/best@4/mean:1.7875 - val-aux/grpo_convert/score/best@4/std:0.3284354245228681 - val-aux/grpo_convert/score/worst@4/mean:0.6705 - val-aux/grpo_convert/score/worst@4/std:0.7164834627350469 - val-aux/grpo_convert/score/best@8/mean:1.9315 - val-aux/grpo_convert/score/best@8/std:0.19320009415210646 - val-aux/grpo_convert/score/worst@8/mean:0.38 - val-aux/grpo_convert/score/worst@8/std:0.7459810577349115 - val-aux/grpo_convert/score/best@16/mean:1.9895 - val-aux/grpo_convert/score/best@16/std:0.07169204976843667 - val-aux/grpo_convert/score/worst@16/mean:0.02125 - val-aux/grpo_convert/score/worst@16/std:0.7099916160435331 - val-aux/grpo_convert/score/best@32/mean:1.9995 - val-aux/grpo_convert/score/best@32/std:0.01580348062927911 - val-aux/grpo_convert/score/worst@32/mean:-0.33875 - val-aux/grpo_convert/score/worst@32/std:0.4573443324380594 - val-aux/grpo_convert/score/best@50/mean:2.0 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.446 - val-aux/grpo_convert/score/worst@50/std:0.27511142940890254 - val-aux/grpo_convert/structure/mean@50:0.43 - val-aux/grpo_convert/structure/std@50:0.2543900205328845 - val-aux/grpo_convert/structure/best@2/mean:0.495 - val-aux/grpo_convert/structure/best@2/std:0.07053367989832944 - val-aux/grpo_convert/structure/worst@2/mean:0.363 - val-aux/grpo_convert/structure/worst@2/std:0.3430573877755988 - val-aux/grpo_convert/structure/best@4/mean:0.5 - val-aux/grpo_convert/structure/best@4/std:0.0 - val-aux/grpo_convert/structure/worst@4/mean:0.244 - val-aux/grpo_convert/structure/worst@4/std:0.43575765044827314 - val-aux/grpo_convert/structure/best@8/mean:0.5 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:0.083 - val-aux/grpo_convert/structure/worst@8/std:0.4919937568899897 - val-aux/grpo_convert/structure/best@16/mean:0.5 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.1525 - val-aux/grpo_convert/structure/worst@16/std:0.4733277440290221 - val-aux/grpo_convert/structure/best@32/mean:0.5 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.39249999999999996 - val-aux/grpo_convert/structure/worst@32/std:0.3048962216253729 - val-aux/grpo_convert/structure/best@50/mean:0.5 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.46399999999999997 - val-aux/grpo_convert/structure/worst@50/std:0.18340761960593507 - val-aux/grpo_convert/boxed/mean@50:0.46499999999999997 - val-aux/grpo_convert/boxed/std@50:0.12719501026644228 - val-aux/grpo_convert/boxed/best@2/mean:0.4975 - val-aux/grpo_convert/boxed/best@2/std:0.03526683994916472 - val-aux/grpo_convert/boxed/worst@2/mean:0.4315 - val-aux/grpo_convert/boxed/worst@2/std:0.1715286938877994 - val-aux/grpo_convert/boxed/best@4/mean:0.5 - val-aux/grpo_convert/boxed/best@4/std:0.0 - val-aux/grpo_convert/boxed/worst@4/mean:0.372 - val-aux/grpo_convert/boxed/worst@4/std:0.21787882522413657 - val-aux/grpo_convert/boxed/best@8/mean:0.5 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.2915 - val-aux/grpo_convert/boxed/worst@8/std:0.24599687844499485 - val-aux/grpo_convert/boxed/best@16/mean:0.5 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.17375000000000002 - val-aux/grpo_convert/boxed/worst@16/std:0.23666387201451106 - val-aux/grpo_convert/boxed/best@32/mean:0.5 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.05374999999999999 - val-aux/grpo_convert/boxed/worst@32/std:0.15244811081268647 - val-aux/grpo_convert/boxed/best@50/mean:0.5 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.018000000000000002 - val-aux/grpo_convert/boxed/worst@50/std:0.09170380980296754 - val-aux/grpo_convert/correct/mean@50:0.39999999999999997 - val-aux/grpo_convert/correct/std@50:0.4539024053571411 - val-aux/grpo_convert/correct/best@2/mean:0.5994999999999999 - val-aux/grpo_convert/correct/best@2/std:0.43191536049386775 - val-aux/grpo_convert/correct/worst@2/mean:0.20049999999999998 - val-aux/grpo_convert/correct/worst@2/std:0.3534418349452692 - val-aux/grpo_convert/correct/best@4/mean:0.7875 - val-aux/grpo_convert/correct/best@4/std:0.3284354245228681 - val-aux/grpo_convert/correct/worst@4/mean:0.0545 - val-aux/grpo_convert/correct/worst@4/std:0.1812638275944585 - val-aux/grpo_convert/correct/best@8/mean:0.9315 - val-aux/grpo_convert/correct/best@8/std:0.19320009415210646 - val-aux/grpo_convert/correct/worst@8/mean:0.0055 - val-aux/grpo_convert/correct/worst@8/std:0.05215122242095578 - val-aux/grpo_convert/correct/best@16/mean:0.9895 - val-aux/grpo_convert/correct/best@16/std:0.07169204976843667 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.9995 - val-aux/grpo_convert/correct/best@32/std:0.01580348062927911 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:1.0 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.39999999999999997 - val-aux/grpo_convert/acc/std@50:0.4539024053571411 - val-aux/grpo_convert/acc/best@2/mean:0.5994999999999999 - val-aux/grpo_convert/acc/best@2/std:0.43191536049386775 - val-aux/grpo_convert/acc/worst@2/mean:0.20049999999999998 - val-aux/grpo_convert/acc/worst@2/std:0.3534418349452692 - val-aux/grpo_convert/acc/best@4/mean:0.7875 - val-aux/grpo_convert/acc/best@4/std:0.3284354245228681 - val-aux/grpo_convert/acc/worst@4/mean:0.0545 - val-aux/grpo_convert/acc/worst@4/std:0.1812638275944585 - val-aux/grpo_convert/acc/best@8/mean:0.9315 - val-aux/grpo_convert/acc/best@8/std:0.19320009415210646 - val-aux/grpo_convert/acc/worst@8/mean:0.0055 - val-aux/grpo_convert/acc/worst@8/std:0.05215122242095578 - val-aux/grpo_convert/acc/best@16/mean:0.9895 - val-aux/grpo_convert/acc/best@16/std:0.07169204976843667 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.9995 - val-aux/grpo_convert/acc/best@32/std:0.01580348062927911 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:1.0 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:150 - training/epoch:4 - critic/score/mean:1.3468749523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3468749523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.007970655336976051 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.007970655336976051 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:357.90936279296875 - response_length/max:964.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.346875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010015256702899933 - timing_s/generate_sequences:27.11373519897461 - timing_s/reshard:0.6679641604423523 - timing_s/gen:33.00950234569609 - timing_s/reward:0.07846890389919281 - timing_s/old_log_prob:1.138121234253049 - timing_s/ref:1.3838319890201092 - timing_s/adv:0.009265158325433731 - timing_s/update_actor:7.131127122789621 - timing_s/testing:44.03694334626198 - timing_s/save_checkpoint:8.189798636361957 - timing_s/step:94.99296592362225 - timing_s/stop_profile:4.958920180797577e-05 - timing_per_token_ms/adv:3.770677662599802e-05 - timing_per_token_ms/gen:0.28821456501467807 - timing_per_token_ms/ref:0.0056318350820463835 - timing_per_token_ms/update_actor:0.029021826510237922 - perf/total_num_tokens:245716 - perf/time_per_step:94.99296592362225 - perf/throughput:323.3344669403791[36m(TaskRunner pid=2949575)[0m Training Progress:  29%|██▉       | 151/525 [2:21:51<5:32:57, 53.42s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:00:59,439:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:00:59,441:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_150/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  29%|██▉       | 152/525 [2:22:40<5:24:39, 52.23s/it]

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3390624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3390624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005347884260118008, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.005347884260118008, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 338.046875, 'response_length/max': 800.0, 'response_length/min': 90.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:151 - global_seqlen/min:28125 - global_seqlen/max:31447 - global_seqlen/minmax_diff:3322 - global_seqlen/balanced_min:29924 - global_seqlen/balanced_max:29925 - global_seqlen/mean:29924.375 - actor/entropy:0.3125479519367218 - actor/kl_loss:0.743369671702385 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10443873852491378 - actor/pg_clipfrac:0.0302430595678743 - actor/ppo_kl:0.018136355688329785 - actor/pg_clipfrac_lower:0.005297450348734856 - actor/grad_norm:43.15301012992859 - perf/mfu/actor:0.08691684030690004 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.61493682861328 - actor/lr:1e-06 - training/global_step:151 - training/epoch:4 - critic/score/mean:1.3390624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3390624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005347884260118008 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.005347884260118008 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:338.046875 - response_length/max:800.0 - response_length/min:90.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.365457713603973e-05 - timing_s/generate_sequences:24.348831176757812 - timing_s/reshard:0.63657146692276 - timing_s/gen:28.013901663944125 - timing_s/reward:0.07456661574542522 - timing_s/old_log_prob:1.1114591863006353 - timing_s/ref:1.3920888751745224 - timing_s/adv:0.008232686668634415 - timing_s/update_actor:7.352058487012982 - timing_s/step:37.97364259697497 - timing_s/stop_profile:4.731863737106323e-05 - timing_per_token_ms/adv:3.4389551446915826e-05 - timing_per_token_ms/gen:0.2589683537226173 - timing_per_token_ms/ref:0.005815029032245963 - timing_per_token_ms/update_actor:0.030710994327421134 - perf/total_num_tokens:239395 - perf/time_per_step:37.97364259697497 - perf/throughput:788.0301428439687
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.329687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.329687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.013966800644993782, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.013966800644993782, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 359.50311279296875, 'response_length/max': 1216.0, 'response_length/min': 105.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:152 - global_seqlen/min:29362 - global_seqlen/max:33428 - global_seqlen/minmax_diff:4066 - global_seqlen/balanced_min:30764 - global_seqlen/balanced_max:30913 - global_seqlen/mean:30782.625 - actor/entropy:0.30177927017211914 - actor/kl_loss:0.9058086261153221 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11498802788555622 - actor/pg_clipfrac:0.029626591532723977 - actor/ppo_kl:0.20039757071644998 - actor/pg_clipfrac_lower:8.818341884762049e-05 - actor/grad_norm:25.41423499584198 - perf/mfu/actor:0.09089404773736091 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.72085952758789 - actor/lr:1e-06 - training/global_step:152 - training/epoch:4 - critic/score/mean:1.329687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.329687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.013966800644993782 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.013966800644993782 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:359.50311279296875 - response_length/max:1216.0 - response_length/min:105.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011429376900196075 - timing_s/generate_sequences:28.121896743774414 - timing_s/reshard:0.7218784689903259 - timing_s/gen:39.140336288139224 - timing_s/reward:0.077044777572155 - timing_s/old_log_prob:1.2905428614467382 - timing_s/ref:1.3719233237206936 - timing_s/adv:0.007701892405748367 - timing_s/update_actor:7.240743860602379 - timing_s/step:49.144135070964694 - timing_s/stop_profile:4.631839692592621e-05 - timing_per_token_ms/adv:3.127532335915296e-05 - timing_per_token_ms/gen:0.34022945113602304 - timing_per_token_ms/ref:0.005571013370857317 - timing_per_token_ms/update_actor:0.029402722561032314 - perf/total_num_tokens:246261 - perf/time_per_step:49.144135070964694 - perf/throughput:626.3743365418791
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  29%|██▉       | 153/525 [2:23:22<5:03:35, 48.97s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  29%|██▉       | 154/525 [2:24:03<4:49:03, 46.75s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2546875476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2546875476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.006159443873912096, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.006159443873912096, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 372.5843811035156, 'response_length/max': 965.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:153 - global_seqlen/min:29057 - global_seqlen/max:35132 - global_seqlen/minmax_diff:6075 - global_seqlen/balanced_min:31275 - global_seqlen/balanced_max:31276 - global_seqlen/mean:31275.25 - actor/entropy:0.3134593963623047 - actor/kl_loss:1.233164021372795 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09140854813158512 - actor/pg_clipfrac:0.06178468897705898 - actor/ppo_kl:-0.06260831607505679 - actor/pg_clipfrac_lower:0.006498365802690387 - actor/grad_norm:41.06183648109436 - perf/mfu/actor:0.09277595863842822 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.677734375 - actor/lr:1e-06 - training/global_step:153 - training/epoch:4 - critic/score/mean:1.2546875476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2546875476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.006159443873912096 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.006159443873912096 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:372.5843811035156 - response_length/max:965.0 - response_length/min:89.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.536929428577423e-05 - timing_s/generate_sequences:28.622665405273438 - timing_s/reshard:0.6556606292724609 - timing_s/gen:31.403055381029844 - timing_s/reward:0.07691996730864048 - timing_s/old_log_prob:1.2579740341752768 - timing_s/ref:1.3684566300362349 - timing_s/adv:0.007874371483922005 - timing_s/update_actor:7.211690733209252 - timing_s/step:41.34673237428069 - timing_s/stop_profile:4.589557647705078e-05 - timing_per_token_ms/adv:3.147205651402469e-05 - timing_per_token_ms/gen:0.26338879097041645 - timing_per_token_ms/ref:0.00546940723909575 - timing_per_token_ms/update_actor:0.028823473566195523 - perf/total_num_tokens:250202 - perf/time_per_step:41.34673237428069 - perf/throughput:756.4140671840478
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4031250476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4031250476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02408529818058014, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.02408529818058014, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 367.25, 'response_length/max': 949.0, 'response_length/min': 71.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.640625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.403125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:154 - global_seqlen/min:27588 - global_seqlen/max:34950 - global_seqlen/minmax_diff:7362 - global_seqlen/balanced_min:31035 - global_seqlen/balanced_max:31036 - global_seqlen/mean:31035.625 - actor/entropy:0.3045135736465454 - actor/kl_loss:1.0310892470180988 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05453770868480205 - actor/pg_clipfrac:0.022060816950397567 - actor/ppo_kl:0.5490963814547285 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:29.21466898918152 - perf/mfu/actor:0.09272245790014538 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.64260482788086 - actor/lr:1e-06 - training/global_step:154 - training/epoch:4 - critic/score/mean:1.4031250476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4031250476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02408529818058014 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.02408529818058014 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:367.25 - response_length/max:949.0 - response_length/min:71.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.403125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.598955512046814e-05 - timing_s/generate_sequences:28.074119567871094 - timing_s/reshard:0.740135669708252 - timing_s/gen:31.704485656693578 - timing_s/reward:0.07649008557200432 - timing_s/old_log_prob:1.2315538078546524 - timing_s/ref:1.3622735925018787 - timing_s/adv:0.007792724296450615 - timing_s/update_actor:7.159379217773676 - timing_s/step:41.56056412495673 - timing_s/stop_profile:4.332512617111206e-05 - timing_per_token_ms/adv:3.1386206562823426e-05 - timing_per_token_ms/gen:0.2697794899310209 - timing_per_token_ms/ref:0.005486733360863035 - timing_per_token_ms/update_actor:0.028835327215795056 - perf/total_num_tokens:248285 - perf/time_per_step:41.56056412495673 - perf/throughput:746.7565865248542
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2390625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2390625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02243283949792385, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.02243283949792385, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 377.4781188964844, 'response_length/max': 1004.0, 'response_length/min': 98.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  30%|██▉       | 155/525 [2:24:47<4:42:01, 45.73s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  30%|██▉       | 156/525 [2:25:24<4:26:26, 43.32s/it]
[36m(TaskRunner pid=2949575)[0m step:155 - global_seqlen/min:27943 - global_seqlen/max:34172 - global_seqlen/minmax_diff:6229 - global_seqlen/balanced_min:31471 - global_seqlen/balanced_max:31471 - global_seqlen/mean:31471.0 - actor/entropy:0.28871622681617737 - actor/kl_loss:0.9910859201103449 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.012546249479055405 - actor/pg_clipfrac:0.03692149753915146 - actor/ppo_kl:-0.1396467803471751 - actor/pg_clipfrac_lower:0.007304342603310943 - actor/grad_norm:49.58713150024414 - perf/mfu/actor:0.09403531349600946 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.68777084350586 - actor/lr:1e-06 - training/global_step:155 - training/epoch:4 - critic/score/mean:1.2390625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2390625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02243283949792385 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.02243283949792385 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:377.4781188964844 - response_length/max:1004.0 - response_length/min:98.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.299814701080322e-05 - timing_s/generate_sequences:28.41402816772461 - timing_s/reshard:0.6562032699584961 - timing_s/gen:33.59302934631705 - timing_s/reward:0.07796073891222477 - timing_s/old_log_prob:1.1343781892210245 - timing_s/ref:1.365136543288827 - timing_s/adv:0.008090423420071602 - timing_s/update_actor:7.16004379093647 - timing_s/step:43.35376284271479 - timing_s/stop_profile:4.4345855712890625e-05 - timing_per_token_ms/adv:3.213443892818627e-05 - timing_per_token_ms/gen:0.27810410658164836 - timing_per_token_ms/ref:0.005422200372123649 - timing_per_token_ms/update_actor:0.02843905417263699 - perf/total_num_tokens:251768 - perf/time_per_step:43.35376284271479 - perf/throughput:725.9116149658142
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.334375023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.334375023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.019269216805696487, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.019269216805696487, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 334.0843811035156, 'response_length/max': 826.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.334375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:156 - global_seqlen/min:27310 - global_seqlen/max:31914 - global_seqlen/minmax_diff:4604 - global_seqlen/balanced_min:29765 - global_seqlen/balanced_max:29766 - global_seqlen/mean:29765.875 - actor/entropy:0.31367257237434387 - actor/kl_loss:1.1096551280468703 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0413498604670167 - actor/pg_clipfrac:0.034528826270252465 - actor/ppo_kl:0.45331023287290007 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:17.162347435951233 - perf/mfu/actor:0.08857817177584668 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.70530319213867 - actor/lr:1e-06 - training/global_step:156 - training/epoch:4 - critic/score/mean:1.334375023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.334375023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.019269216805696487 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.019269216805696487 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:334.0843811035156 - response_length/max:826.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.334375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.57585871219635e-05 - timing_s/generate_sequences:24.45262908935547 - timing_s/reshard:0.6719661355018616 - timing_s/gen:27.83497478812933 - timing_s/reward:0.07435249350965023 - timing_s/old_log_prob:1.1896947342902422 - timing_s/ref:1.383490838110447 - timing_s/adv:0.007950842380523682 - timing_s/update_actor:7.175577942281961 - timing_s/step:37.68133602850139 - timing_s/stop_profile:4.490651190280914e-05 - timing_per_token_ms/adv:3.338908389440795e-05 - timing_per_token_ms/gen:0.26036625092958676 - timing_per_token_ms/ref:0.005809886481207284 - timing_per_token_ms/update_actor:0.0301334075610156 - perf/total_num_tokens:238127 - perf/time_per_step:37.68133602850139 - perf/throughput:789.9368264831613
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.399999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.399999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0011974264634773135, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.0011974264634773135, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 378.7593688964844, 'response_length/max': 1053.0, 'response_length/min': 124.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.4, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  30%|██▉       | 157/525 [2:26:09<4:29:02, 43.86s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  30%|███       | 158/525 [2:26:50<4:21:55, 42.82s/it]
[36m(TaskRunner pid=2949575)[0m step:157 - global_seqlen/min:27731 - global_seqlen/max:37065 - global_seqlen/minmax_diff:9334 - global_seqlen/balanced_min:31517 - global_seqlen/balanced_max:31518 - global_seqlen/mean:31517.875 - actor/entropy:0.29961588978767395 - actor/kl_loss:0.9825005605816841 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10588715076446534 - actor/pg_clipfrac:0.017934752034489066 - actor/ppo_kl:0.074150358553743 - actor/pg_clipfrac_lower:0.00016042781062424182 - actor/grad_norm:57.58298110961914 - perf/mfu/actor:0.09532548390621547 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.67144775390625 - actor/lr:1e-06 - training/global_step:157 - training/epoch:4 - critic/score/mean:1.399999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.399999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0011974264634773135 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.0011974264634773135 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:378.7593688964844 - response_length/max:1053.0 - response_length/min:124.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.4 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010766647756099701 - timing_s/generate_sequences:28.84347915649414 - timing_s/reshard:0.7146996259689331 - timing_s/gen:35.33005261979997 - timing_s/reward:0.07769889943301678 - timing_s/old_log_prob:1.158513257279992 - timing_s/ref:1.3580963462591171 - timing_s/adv:0.008136769756674767 - timing_s/update_actor:7.075128065422177 - timing_s/step:45.02167905680835 - timing_s/stop_profile:4.5845285058021545e-05 - timing_per_token_ms/adv:3.227045667210578e-05 - timing_per_token_ms/gen:0.2914948691022497 - timing_per_token_ms/ref:0.0053862147521807745 - timing_per_token_ms/update_actor:0.028059982095168922 - perf/total_num_tokens:252143 - perf/time_per_step:45.02167905680835 - perf/throughput:700.0599635617931
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.509374976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.509374976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.012484084814786911, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.012484084814786911, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 347.23748779296875, 'response_length/max': 886.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.509375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:158 - global_seqlen/min:28240 - global_seqlen/max:32898 - global_seqlen/minmax_diff:4658 - global_seqlen/balanced_min:30283 - global_seqlen/balanced_max:30284 - global_seqlen/mean:30283.25 - actor/entropy:0.3356827199459076 - actor/kl_loss:0.9548970036208629 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09248658940196038 - actor/pg_clipfrac:0.007546599203487858 - actor/ppo_kl:-0.017528107232647017 - actor/pg_clipfrac_lower:0.013382885616738349 - actor/grad_norm:38.36237096786499 - perf/mfu/actor:0.09175802542745524 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.69560241699219 - actor/lr:1e-06 - training/global_step:158 - training/epoch:4 - critic/score/mean:1.509374976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.509374976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.012484084814786911 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.012484084814786911 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:347.23748779296875 - response_length/max:886.0 - response_length/min:110.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.509375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011140294373035431 - timing_s/generate_sequences:25.052677154541016 - timing_s/reshard:0.6540036201477051 - timing_s/gen:30.289379319176078 - timing_s/reward:0.07694087363779545 - timing_s/old_log_prob:1.2367165368050337 - timing_s/ref:1.3638937957584858 - timing_s/adv:0.007966071367263794 - timing_s/update_actor:7.054629283025861 - timing_s/step:40.044783471152186 - timing_s/stop_profile:4.61135059595108e-05 - timing_per_token_ms/adv:3.28815077941758e-05 - timing_per_token_ms/gen:0.2725924198061132 - timing_per_token_ms/ref:0.005629736718146524 - timing_per_token_ms/update_actor:0.029119353450446455 - perf/total_num_tokens:242266 - perf/time_per_step:40.044783471152186 - perf/throughput:756.2345797628226
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.235937476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.235937476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.013501591049134731, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.013501591049134731, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 389.62188720703125, 'response_length/max': 927.0, 'response_length/min': 122.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  30%|███       | 159/525 [2:27:31<4:17:43, 42.25s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:08:03,389:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:08:06,888:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:08:06,890:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:08:07,428:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/huggingface
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:08:03,631:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  30%|███       | 160/525 [2:28:22<4:33:29, 44.96s/it]
[36m(TaskRunner pid=2949575)[0m step:159 - global_seqlen/min:29477 - global_seqlen/max:34732 - global_seqlen/minmax_diff:5255 - global_seqlen/balanced_min:31961 - global_seqlen/balanced_max:31962 - global_seqlen/mean:31961.125 - actor/entropy:0.2754398286342621 - actor/kl_loss:1.8099493000656366 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0019375951029360293 - actor/pg_clipfrac:0.055867397313704714 - actor/ppo_kl:0.24130501072504557 - actor/pg_clipfrac_lower:0.0008320885826833546 - actor/grad_norm:44.38254737854004 - perf/mfu/actor:0.09594744945658294 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.63299179077148 - actor/lr:1e-06 - training/global_step:159 - training/epoch:4 - critic/score/mean:1.235937476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.235937476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.013501591049134731 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.013501591049134731 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:389.62188720703125 - response_length/max:927.0 - response_length/min:122.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.40132886171341e-05 - timing_s/generate_sequences:27.93069076538086 - timing_s/reshard:0.6722732186317444 - timing_s/gen:30.97811982035637 - timing_s/reward:0.07882943004369736 - timing_s/old_log_prob:1.3049002550542355 - timing_s/ref:1.3821755815297365 - timing_s/adv:0.00807717815041542 - timing_s/update_actor:7.131494242697954 - timing_s/step:40.89848653227091 - timing_s/stop_profile:4.612468183040619e-05 - timing_per_token_ms/adv:3.1589853886617804e-05 - timing_per_token_ms/gen:0.2484630115765796 - timing_per_token_ms/ref:0.005405690434589429 - timing_per_token_ms/update_actor:0.027891282936293522 - perf/total_num_tokens:255689 - perf/time_per_step:40.89848653227091 - perf/throughput:781.4745167839184
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3953125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3953125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005928142927587032, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.005928142927587032, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 351.82501220703125, 'response_length/max': 973.0, 'response_length/min': 96.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:160 - global_seqlen/min:29023 - global_seqlen/max:32679 - global_seqlen/minmax_diff:3656 - global_seqlen/balanced_min:30466 - global_seqlen/balanced_max:30467 - global_seqlen/mean:30466.75 - actor/entropy:0.3113652169704437 - actor/kl_loss:1.1419294595718383 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07295743096619844 - actor/pg_clipfrac:0.01595735161099583 - actor/ppo_kl:-0.08446199003956281 - actor/pg_clipfrac_lower:0.0018621973693370819 - actor/grad_norm:21.09817361831665 - perf/mfu/actor:0.09288226946182972 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.7016716003418 - actor/lr:1e-06 - training/global_step:160 - training/epoch:4 - critic/score/mean:1.3953125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3953125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005928142927587032 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.005928142927587032 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:351.82501220703125 - response_length/max:973.0 - response_length/min:96.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011623464524745941 - timing_s/generate_sequences:26.4150447845459 - timing_s/reshard:0.6667884588241577 - timing_s/gen:33.3573738001287 - timing_s/reward:0.0765011589974165 - timing_s/old_log_prob:1.1232416927814484 - timing_s/ref:1.3567190133035183 - timing_s/adv:0.007760757580399513 - timing_s/update_actor:7.012814629822969 - timing_s/save_checkpoint:8.00486584752798 - timing_s/step:50.95336322672665 - timing_s/stop_profile:5.539692938327789e-05 - timing_per_token_ms/adv:3.184109554021808e-05 - timing_per_token_ms/gen:0.2962887603933836 - timing_per_token_ms/ref:0.0055663921049320915 - timing_per_token_ms/update_actor:0.028772410208764348 - perf/total_num_tokens:243734 - perf/time_per_step:50.95336322672665 - perf/throughput:597.9340336070147
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.353124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.353124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021411066874861717, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.021411066874861717, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 371.25311279296875, 'response_length/max': 826.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.353125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  31%|███       | 161/525 [2:29:00<4:20:40, 42.97s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:08:08,589:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:08:08,591:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_160/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  31%|███       | 162/525 [2:29:36<4:06:51, 40.80s/it]
[36m(TaskRunner pid=2949575)[0m step:161 - global_seqlen/min:29016 - global_seqlen/max:33788 - global_seqlen/minmax_diff:4772 - global_seqlen/balanced_min:31222 - global_seqlen/balanced_max:31222 - global_seqlen/mean:31222.0 - actor/entropy:0.2738345265388489 - actor/kl_loss:1.6086879603564739 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.019204568478744476 - actor/pg_clipfrac:0.014188381150597706 - actor/ppo_kl:0.36734675775514913 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:36.208364486694336 - perf/mfu/actor:0.09515665714651597 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.4451789855957 - actor/lr:1e-06 - training/global_step:161 - training/epoch:4 - critic/score/mean:1.353124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.353124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021411066874861717 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.021411066874861717 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:371.25311279296875 - response_length/max:826.0 - response_length/min:110.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.353125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.701959788799286e-05 - timing_s/generate_sequences:25.662817001342773 - timing_s/reshard:0.6535058617591858 - timing_s/gen:28.599123757332563 - timing_s/reward:0.07679497450590134 - timing_s/old_log_prob:1.189002562314272 - timing_s/ref:1.4066767152398825 - timing_s/adv:0.007781384512782097 - timing_s/update_actor:7.016600165516138 - timing_s/step:38.31180492043495 - timing_s/stop_profile:4.408508539199829e-05 - timing_per_token_ms/adv:3.115345154371155e-05 - timing_per_token_ms/gen:0.24073133860264276 - timing_per_token_ms/ref:0.005631752911568295 - timing_per_token_ms/update_actor:0.028091570709420192 - perf/total_num_tokens:249776 - perf/time_per_step:38.31180492043495 - perf/throughput:814.9446382085393
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.359375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.359375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005937425885349512, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.005937425885349512, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 368.34063720703125, 'response_length/max': 747.0, 'response_length/min': 109.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:162 - global_seqlen/min:29386 - global_seqlen/max:33025 - global_seqlen/minmax_diff:3639 - global_seqlen/balanced_min:31109 - global_seqlen/balanced_max:31110 - global_seqlen/mean:31109.875 - actor/entropy:0.27386361360549927 - actor/kl_loss:1.136009019613266 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.18892053831368685 - actor/pg_clipfrac:0.02846070711966604 - actor/ppo_kl:0.04262281734554563 - actor/pg_clipfrac_lower:9.523809421807528e-05 - actor/grad_norm:35.1249303817749 - perf/mfu/actor:0.0952083921310922 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.45393753051758 - actor/lr:1e-06 - training/global_step:162 - training/epoch:4 - critic/score/mean:1.359375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.359375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005937425885349512 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.005937425885349512 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:368.34063720703125 - response_length/max:747.0 - response_length/min:109.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.297206997871399e-05 - timing_s/generate_sequences:23.01591682434082 - timing_s/reshard:0.6914661526679993 - timing_s/gen:26.10928119160235 - timing_s/reward:0.07699289172887802 - timing_s/old_log_prob:1.170351818203926 - timing_s/ref:1.3747027032077312 - timing_s/adv:0.008022427558898926 - timing_s/update_actor:6.984541412442923 - timing_s/step:35.73831611312926 - timing_s/stop_profile:4.5841559767723083e-05 - timing_per_token_ms/adv:3.223424860634656e-05 - timing_per_token_ms/gen:0.22151100960899262 - timing_per_token_ms/ref:0.0055235785389998 - timing_per_token_ms/update_actor:0.028064004646607077 - perf/total_num_tokens:248879 - perf/time_per_step:35.73831611312926 - perf/throughput:870.4907892560473
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3015625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3015625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.029716257005929947, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.029716257005929947, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 378.11248779296875, 'response_length/max': 930.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3015625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  31%|███       | 163/525 [2:30:17<4:06:15, 40.82s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  31%|███       | 164/525 [2:30:59<4:07:57, 41.21s/it]
[36m(TaskRunner pid=2949575)[0m step:163 - global_seqlen/min:28450 - global_seqlen/max:34797 - global_seqlen/minmax_diff:6347 - global_seqlen/balanced_min:31505 - global_seqlen/balanced_max:31506 - global_seqlen/mean:31505.125 - actor/entropy:0.3033217489719391 - actor/kl_loss:1.746023428440094 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12540470473468304 - actor/pg_clipfrac:0.03660062222625129 - actor/ppo_kl:0.574239122401923 - actor/pg_clipfrac_lower:0.00010852028499357403 - actor/grad_norm:37.25412964820862 - perf/mfu/actor:0.09581367810811729 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.4670295715332 - actor/lr:1e-06 - training/global_step:163 - training/epoch:4 - critic/score/mean:1.3015625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3015625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.029716257005929947 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.029716257005929947 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:378.11248779296875 - response_length/max:930.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3015625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.290315210819244e-05 - timing_s/generate_sequences:27.90753746032715 - timing_s/reshard:0.6674928665161133 - timing_s/gen:31.040205288678408 - timing_s/reward:0.08152413740754128 - timing_s/old_log_prob:1.299511481076479 - timing_s/ref:1.35857811011374 - timing_s/adv:0.008087705820798874 - timing_s/update_actor:7.034354982897639 - timing_s/step:40.8372346367687 - timing_s/stop_profile:4.4601038098335266e-05 - timing_per_token_ms/adv:3.2088849912509764e-05 - timing_per_token_ms/gen:0.25653910285198195 - timing_per_token_ms/ref:0.005390305982414528 - timing_per_token_ms/update_actor:0.027909566232865442 - perf/total_num_tokens:252041 - perf/time_per_step:40.8372346367687 - perf/throughput:771.4803727584842
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.329687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.329687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.019320907071232796, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.019320907071232796, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 370.73748779296875, 'response_length/max': 949.0, 'response_length/min': 111.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:164 - global_seqlen/min:29206 - global_seqlen/max:35115 - global_seqlen/minmax_diff:5909 - global_seqlen/balanced_min:31232 - global_seqlen/balanced_max:31232 - global_seqlen/mean:31232.0 - actor/entropy:0.2568329870700836 - actor/kl_loss:1.8037997402250767 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22445894703269004 - actor/pg_clipfrac:0.02094613841618411 - actor/ppo_kl:-0.3477964406250976 - actor/pg_clipfrac_lower:0.028509286511689425 - actor/grad_norm:57.08566761016846 - perf/mfu/actor:0.09328285469361294 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.44730758666992 - actor/lr:1e-06 - training/global_step:164 - training/epoch:4 - critic/score/mean:1.329687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.329687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.019320907071232796 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.019320907071232796 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:370.73748779296875 - response_length/max:949.0 - response_length/min:111.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.19923186302185e-05 - timing_s/generate_sequences:26.199438095092773 - timing_s/reshard:0.6544671058654785 - timing_s/gen:32.19468957744539 - timing_s/reward:0.07670312188565731 - timing_s/old_log_prob:1.2008592896163464 - timing_s/ref:1.4612812027335167 - timing_s/adv:0.008060632273554802 - timing_s/update_actor:7.160620337352157 - timing_s/step:42.11598330549896 - timing_s/stop_profile:4.4384971261024475e-05 - timing_per_token_ms/adv:3.2261111494440005e-05 - timing_per_token_ms/gen:0.27137369413538376 - timing_per_token_ms/ref:0.005848493543214959 - timing_per_token_ms/update_actor:0.028658988927030594 - perf/total_num_tokens:249856 - perf/time_per_step:42.11598330549896 - perf/throughput:741.5711933745147
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3468749523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3468749523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00418480858206749, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.00418480858206749, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 363.6875, 'response_length/max': 838.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.346875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  31%|███▏      | 165/525 [2:31:38<4:02:22, 40.40s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  32%|███▏      | 166/525 [2:32:15<3:55:57, 39.44s/it]
[36m(TaskRunner pid=2949575)[0m step:165 - global_seqlen/min:27708 - global_seqlen/max:33511 - global_seqlen/minmax_diff:5803 - global_seqlen/balanced_min:30945 - global_seqlen/balanced_max:30946 - global_seqlen/mean:30945.625 - actor/entropy:0.2851659059524536 - actor/kl_loss:1.9606676995754242 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10048725455999374 - actor/pg_clipfrac:0.06262707943096757 - actor/ppo_kl:1.0825680894893595 - actor/pg_clipfrac_lower:6.793478387407958e-05 - actor/grad_norm:20.234740614891052 - perf/mfu/actor:0.09147175818617251 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.51978302001953 - actor/lr:1e-06 - training/global_step:165 - training/epoch:4 - critic/score/mean:1.3468749523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3468749523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00418480858206749 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.00418480858206749 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:363.6875 - response_length/max:838.0 - response_length/min:82.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.346875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010780990123748779 - timing_s/generate_sequences:24.258209228515625 - timing_s/reshard:0.6383049488067627 - timing_s/gen:28.58862043917179 - timing_s/reward:0.0760123711079359 - timing_s/old_log_prob:1.1171200927346945 - timing_s/ref:1.3567381221801043 - timing_s/adv:0.007990594953298569 - timing_s/update_actor:7.23104864731431 - timing_s/step:38.39237660355866 - timing_s/stop_profile:4.680640995502472e-05 - timing_per_token_ms/adv:3.227675541089641e-05 - timing_per_token_ms/gen:0.24564891252080934 - timing_per_token_ms/ref:0.005480330911801362 - timing_per_token_ms/update_actor:0.02920868720261067 - perf/total_num_tokens:247565 - perf/time_per_step:38.39237660355866 - perf/throughput:806.0356700379833
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2999999523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2999999523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.015266436152160168, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.015266436152160168, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 368.734375, 'response_length/max': 793.0, 'response_length/min': 119.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:166 - global_seqlen/min:29874 - global_seqlen/max:32894 - global_seqlen/minmax_diff:3020 - global_seqlen/balanced_min:31130 - global_seqlen/balanced_max:31130 - global_seqlen/mean:31130.0 - actor/entropy:0.28604426980018616 - actor/kl_loss:1.1009821720421313 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0511687733232975 - actor/pg_clipfrac:0.03397449728217907 - actor/ppo_kl:-0.4720573211159717 - actor/pg_clipfrac_lower:0.01215918748639524 - actor/grad_norm:69.54347896575928 - perf/mfu/actor:0.09497223790941986 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.60463333129883 - actor/lr:1e-06 - training/global_step:166 - training/epoch:4 - critic/score/mean:1.2999999523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2999999523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.015266436152160168 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.015266436152160168 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:368.734375 - response_length/max:793.0 - response_length/min:119.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011936202645301819 - timing_s/generate_sequences:24.038650512695312 - timing_s/reshard:0.7514021396636963 - timing_s/gen:27.200099293142557 - timing_s/reward:0.0771637037396431 - timing_s/old_log_prob:1.2119810748845339 - timing_s/ref:1.3576085977256298 - timing_s/adv:0.007841113954782486 - timing_s/update_actor:7.007555339485407 - timing_s/step:36.87718007713556 - timing_s/stop_profile:4.773959517478943e-05 - timing_per_token_ms/adv:3.148535959999392e-05 - timing_per_token_ms/gen:0.23051908380136918 - timing_per_token_ms/ref:0.005451367642650296 - timing_per_token_ms/update_actor:0.0281382723236645 - perf/total_num_tokens:249040 - perf/time_per_step:36.87718007713556 - perf/throughput:844.1534828554067
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2703125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2703125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.012146512046456337, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.012146512046456337, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 381.3125, 'response_length/max': 840.0, 'response_length/min': 118.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  32%|███▏      | 167/525 [2:32:53<3:53:42, 39.17s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  32%|███▏      | 168/525 [2:33:34<3:56:40, 39.78s/it]
[36m(TaskRunner pid=2949575)[0m step:167 - global_seqlen/min:29584 - global_seqlen/max:33310 - global_seqlen/minmax_diff:3726 - global_seqlen/balanced_min:31628 - global_seqlen/balanced_max:31629 - global_seqlen/mean:31628.75 - actor/entropy:0.3095037043094635 - actor/kl_loss:1.2325509194284678 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09126120731234551 - actor/pg_clipfrac:0.028461487672757357 - actor/ppo_kl:0.06106547927192878 - actor/pg_clipfrac_lower:0.0030182785587385295 - actor/grad_norm:39.39501690864563 - perf/mfu/actor:0.09558059165429739 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.50902938842773 - actor/lr:1e-06 - training/global_step:167 - training/epoch:4 - critic/score/mean:1.2703125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2703125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.012146512046456337 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.012146512046456337 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:381.3125 - response_length/max:840.0 - response_length/min:118.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.456835687160492e-05 - timing_s/generate_sequences:25.741735458374023 - timing_s/reshard:0.6488806009292603 - timing_s/gen:28.764328373596072 - timing_s/reward:0.0788059551268816 - timing_s/old_log_prob:1.2144991047680378 - timing_s/ref:1.3606626447290182 - timing_s/adv:0.008008508011698723 - timing_s/update_actor:7.078635361045599 - timing_s/step:38.52594965882599 - timing_s/stop_profile:4.3218955397605896e-05 - timing_per_token_ms/adv:3.165042884914327e-05 - timing_per_token_ms/gen:0.23573453838383931 - timing_per_token_ms/ref:0.005377475574947706 - timing_per_token_ms/update_actor:0.027975478643028885 - perf/total_num_tokens:253030 - perf/time_per_step:38.52594965882599 - perf/throughput:820.9726244283274
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3640625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3640625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.004919889383018017, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.004919889383018017, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 372.9437561035156, 'response_length/max': 906.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.640625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:168 - global_seqlen/min:29418 - global_seqlen/max:34005 - global_seqlen/minmax_diff:4587 - global_seqlen/balanced_min:31263 - global_seqlen/balanced_max:31264 - global_seqlen/mean:31263.375 - actor/entropy:0.296583890914917 - actor/kl_loss:1.8991345588117838 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13397444635629654 - actor/pg_clipfrac:0.04310551484813914 - actor/ppo_kl:0.035778155038133266 - actor/pg_clipfrac_lower:0.01086231461376883 - actor/grad_norm:57.535961627960205 - perf/mfu/actor:0.09519933311238787 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.56835556030273 - actor/lr:1e-06 - training/global_step:168 - training/epoch:4 - critic/score/mean:1.3640625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3640625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.004919889383018017 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.004919889383018017 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:372.9437561035156 - response_length/max:906.0 - response_length/min:97.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011534802615642548 - timing_s/generate_sequences:25.39952278137207 - timing_s/reshard:0.6684033870697021 - timing_s/gen:31.26552441716194 - timing_s/reward:0.07752880826592445 - timing_s/old_log_prob:1.1338014397770166 - timing_s/ref:1.3625928219407797 - timing_s/adv:0.007720906287431717 - timing_s/update_actor:7.028450829908252 - timing_s/step:40.89047703333199 - timing_s/stop_profile:4.5018270611763e-05 - timing_per_token_ms/adv:3.0870412613128446e-05 - timing_per_token_ms/gen:0.261982574593705 - timing_per_token_ms/ref:0.005448039526845629 - timing_per_token_ms/update_actor:0.028101775759607896 - perf/total_num_tokens:250107 - perf/time_per_step:40.89047703333199 - perf/throughput:764.5637142974774
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.4656250476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.4656250476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.008237280882894993, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.008237280882894993, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 365.54376220703125, 'response_length/max': 815.0, 'response_length/min': 115.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.465625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  32%|███▏      | 169/525 [2:34:12<3:52:15, 39.15s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:14:39,128:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:14:42,590:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:14:42,592:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:14:43,342:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  32%|███▏      | 170/525 [2:34:58<4:03:16, 41.12s/it]
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:14:39,450:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:169 - global_seqlen/min:27883 - global_seqlen/max:32578 - global_seqlen/minmax_diff:4695 - global_seqlen/balanced_min:30998 - global_seqlen/balanced_max:30998 - global_seqlen/mean:30998.0 - actor/entropy:0.2758033573627472 - actor/kl_loss:1.580109877884388 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013087048381567 - actor/pg_clipfrac:0.0634699878282845 - actor/ppo_kl:0.38047785486560315 - actor/pg_clipfrac_lower:0.00010660981060937048 - actor/grad_norm:21.0608127117157 - perf/mfu/actor:0.09397543249068536 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.55821990966797 - actor/lr:1e-06 - training/global_step:169 - training/epoch:4 - critic/score/mean:1.4656250476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.4656250476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.008237280882894993 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.008237280882894993 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:365.54376220703125 - response_length/max:815.0 - response_length/min:115.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.465625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.125657379627228e-05 - timing_s/generate_sequences:25.995819091796875 - timing_s/reshard:0.647146463394165 - timing_s/gen:28.020833157002926 - timing_s/reward:0.07697104662656784 - timing_s/old_log_prob:1.117662001401186 - timing_s/ref:1.3618355374783278 - timing_s/adv:0.008077479898929596 - timing_s/update_actor:7.052086189389229 - timing_s/step:37.659119011834264 - timing_s/stop_profile:4.457123577594757e-05 - timing_per_token_ms/adv:3.2572584920517436e-05 - timing_per_token_ms/gen:0.23954753327237613 - timing_per_token_ms/ref:0.005491626627033711 - timing_per_token_ms/update_actor:0.028437666096962824 - perf/total_num_tokens:247984 - perf/time_per_step:37.659119011834264 - perf/throughput:823.1206893145581
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3015625476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3015625476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.027668971568346024, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.027668971568346024, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 353.4281311035156, 'response_length/max': 793.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3015625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:170 - global_seqlen/min:27548 - global_seqlen/max:34271 - global_seqlen/minmax_diff:6723 - global_seqlen/balanced_min:30539 - global_seqlen/balanced_max:30540 - global_seqlen/mean:30539.625 - actor/entropy:0.3082599341869354 - actor/kl_loss:1.5442449014633894 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.055687573924660685 - actor/pg_clipfrac:0.036795560247264804 - actor/ppo_kl:0.019713231700734468 - actor/pg_clipfrac_lower:0.005202185607049614 - actor/grad_norm:56.13194298744202 - perf/mfu/actor:0.0932286898869142 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.61754989624023 - actor/lr:1e-06 - training/global_step:170 - training/epoch:4 - critic/score/mean:1.3015625476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3015625476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.027668971568346024 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.027668971568346024 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:353.4281311035156 - response_length/max:793.0 - response_length/min:100.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3015625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.28640365600586e-05 - timing_s/generate_sequences:22.48090934753418 - timing_s/reshard:0.6410227417945862 - timing_s/gen:28.06608271971345 - timing_s/reward:0.07613417878746986 - timing_s/old_log_prob:1.1071443501859903 - timing_s/ref:1.3615700993686914 - timing_s/adv:0.007874693721532822 - timing_s/update_actor:7.000309456139803 - timing_s/save_checkpoint:8.070590822026134 - timing_s/step:45.70413434319198 - timing_s/stop_profile:5.031749606132507e-05 - timing_per_token_ms/adv:3.223146044496626e-05 - timing_per_token_ms/gen:0.24815939167010131 - timing_per_token_ms/ref:0.005572965038735296 - timing_per_token_ms/update_actor:0.02865256800034301 - perf/total_num_tokens:244317 - perf/time_per_step:45.70413434319198 - perf/throughput:668.2026787922116
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.204687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.204687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.005686895456165075, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.005686895456165075, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 364.2281188964844, 'response_length/max': 997.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  33%|███▎      | 171/525 [2:35:41<4:05:29, 41.61s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:14:44,471:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:14:44,473:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_170/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  33%|███▎      | 172/525 [2:36:21<4:01:59, 41.13s/it]
[36m(TaskRunner pid=2949575)[0m step:171 - global_seqlen/min:27606 - global_seqlen/max:33567 - global_seqlen/minmax_diff:5961 - global_seqlen/balanced_min:30976 - global_seqlen/balanced_max:30976 - global_seqlen/mean:30976.0 - actor/entropy:0.29314640164375305 - actor/kl_loss:1.3167502962052822 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14306997414678335 - actor/pg_clipfrac:0.029543864220613614 - actor/ppo_kl:-0.4508719660249881 - actor/pg_clipfrac_lower:0.021026455610990525 - actor/grad_norm:77.79228162765503 - perf/mfu/actor:0.09254329468369701 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.4415397644043 - actor/lr:1e-06 - training/global_step:171 - training/epoch:4 - critic/score/mean:1.204687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.204687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.005686895456165075 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.005686895456165075 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:364.2281188964844 - response_length/max:997.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.16551798582077e-05 - timing_s/generate_sequences:25.0362606048584 - timing_s/reshard:0.6652388572692871 - timing_s/gen:33.00339050963521 - timing_s/reward:0.07595077157020569 - timing_s/old_log_prob:1.1269657500088215 - timing_s/ref:1.3544719740748405 - timing_s/adv:0.007950397208333015 - timing_s/update_actor:7.155008001253009 - timing_s/step:42.7393367215991 - timing_s/stop_profile:4.388205707073212e-05 - timing_per_token_ms/adv:3.2082891627118636e-05 - timing_per_token_ms/gen:0.28316208514268365 - timing_per_token_ms/ref:0.005465812137117609 - timing_per_token_ms/update_actor:0.0288731921538167 - perf/total_num_tokens:247808 - perf/time_per_step:42.7393367215991 - perf/throughput:724.76557607282
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.228124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.228124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00610731728374958, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.00610731728374958, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 373.15313720703125, 'response_length/max': 872.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.228125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:172 - global_seqlen/min:27088 - global_seqlen/max:35748 - global_seqlen/minmax_diff:8660 - global_seqlen/balanced_min:31289 - global_seqlen/balanced_max:31290 - global_seqlen/mean:31289.25 - actor/entropy:0.28661659359931946 - actor/kl_loss:1.7344869837164878 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.027069730311632158 - actor/pg_clipfrac:0.019138478359673174 - actor/ppo_kl:0.3107192775758449 - actor/pg_clipfrac_lower:0.00021186440717428922 - actor/grad_norm:51.49267899990082 - perf/mfu/actor:0.09441801528592876 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.4195327758789 - actor/lr:1e-06 - training/global_step:172 - training/epoch:4 - critic/score/mean:1.228124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.228124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00610731728374958 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.00610731728374958 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:373.15313720703125 - response_length/max:872.0 - response_length/min:110.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.228125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.305216372013092e-05 - timing_s/generate_sequences:24.436731338500977 - timing_s/reshard:0.7158990502357483 - timing_s/gen:30.321163469925523 - timing_s/reward:0.07686423882842064 - timing_s/old_log_prob:1.1220224909484386 - timing_s/ref:1.3728162311017513 - timing_s/adv:0.008475342765450478 - timing_s/update_actor:7.087397193536162 - timing_s/step:40.003930520266294 - timing_s/stop_profile:4.601292312145233e-05 - timing_per_token_ms/adv:3.385884435329417e-05 - timing_per_token_ms/gen:0.25392695249039454 - timing_per_token_ms/ref:0.0054843765474633915 - timing_per_token_ms/update_actor:0.028314026357040206 - perf/total_num_tokens:250314 - perf/time_per_step:40.003930520266294 - perf/throughput:782.1543931576581
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.220312476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.220312476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0028208685107529163, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0028208685107529163, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 389.26251220703125, 'response_length/max': 859.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  33%|███▎      | 173/525 [2:37:00<3:59:02, 40.75s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  33%|███▎      | 174/525 [2:37:40<3:56:32, 40.44s/it]
[36m(TaskRunner pid=2949575)[0m step:173 - global_seqlen/min:30231 - global_seqlen/max:35094 - global_seqlen/minmax_diff:4863 - global_seqlen/balanced_min:31929 - global_seqlen/balanced_max:31930 - global_seqlen/mean:31929.25 - actor/entropy:0.2651970386505127 - actor/kl_loss:1.472607807442546 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.067421455681324 - actor/pg_clipfrac:0.05072439800715074 - actor/ppo_kl:-0.5889111361550021 - actor/pg_clipfrac_lower:0.012581344391219319 - actor/grad_norm:46.59168100357056 - perf/mfu/actor:0.09679916622635608 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.42511749267578 - actor/lr:1e-06 - training/global_step:173 - training/epoch:4 - critic/score/mean:1.220312476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.220312476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0028208685107529163 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0028208685107529163 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:389.26251220703125 - response_length/max:859.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0001087971031665802 - timing_s/generate_sequences:25.721317291259766 - timing_s/reshard:0.6444106101989746 - timing_s/gen:30.06301734223962 - timing_s/reward:0.07846221886575222 - timing_s/old_log_prob:1.1716943569481373 - timing_s/ref:1.3622245006263256 - timing_s/adv:0.008242251351475716 - timing_s/update_actor:7.058789407834411 - timing_s/step:39.7577118948102 - timing_s/stop_profile:4.534423351287842e-05 - timing_per_token_ms/adv:3.226763606832182e-05 - timing_per_token_ms/gen:0.24134595342345797 - timing_per_token_ms/ref:0.005332980341796024 - timing_per_token_ms/update_actor:0.027634494264015014 - perf/total_num_tokens:255434 - perf/time_per_step:39.7577118948102 - perf/throughput:803.0957637722584
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2890625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2890625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026716431602835655, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.026716431602835655, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 349.5562438964844, 'response_length/max': 881.0, 'response_length/min': 77.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:174 - global_seqlen/min:28512 - global_seqlen/max:31825 - global_seqlen/minmax_diff:3313 - global_seqlen/balanced_min:30380 - global_seqlen/balanced_max:30381 - global_seqlen/mean:30380.375 - actor/entropy:0.30142921209335327 - actor/kl_loss:1.3131659138947724 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0992071233689785 - actor/pg_clipfrac:0.04390111439861357 - actor/ppo_kl:0.21765488407108932 - actor/pg_clipfrac_lower:0.0001652335631661117 - actor/grad_norm:43.79673707485199 - perf/mfu/actor:0.09266469474891295 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.45833206176758 - actor/lr:1e-06 - training/global_step:174 - training/epoch:4 - critic/score/mean:1.2890625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2890625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026716431602835655 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.026716431602835655 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:349.5562438964844 - response_length/max:881.0 - response_length/min:77.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011200830340385437 - timing_s/generate_sequences:23.96483612060547 - timing_s/reshard:0.6721838712692261 - timing_s/gen:29.94883023761213 - timing_s/reward:0.07740412093698978 - timing_s/old_log_prob:1.1068071443587542 - timing_s/ref:1.3576688878238201 - timing_s/adv:0.007877301424741745 - timing_s/update_actor:7.005369760096073 - timing_s/step:39.518148332834244 - timing_s/stop_profile:4.317052662372589e-05 - timing_per_token_ms/adv:3.2411142985980856e-05 - timing_per_token_ms/gen:0.26773972570233806 - timing_per_token_ms/ref:0.005586126273226631 - timing_per_token_ms/update_actor:0.028823581671128456 - perf/total_num_tokens:243043 - perf/time_per_step:39.518148332834244 - perf/throughput:768.7702051251731
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3078124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3078124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.003482433967292309, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.003482433967292309, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 375.02813720703125, 'response_length/max': 884.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3078125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  33%|███▎      | 175/525 [2:38:20<3:54:48, 40.25s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  34%|███▎      | 176/525 [2:39:04<4:00:24, 41.33s/it]
[36m(TaskRunner pid=2949575)[0m step:175 - global_seqlen/min:28422 - global_seqlen/max:32984 - global_seqlen/minmax_diff:4562 - global_seqlen/balanced_min:31390 - global_seqlen/balanced_max:31391 - global_seqlen/mean:31390.5 - actor/entropy:0.27755841612815857 - actor/kl_loss:1.830600656569004 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15077983068767936 - actor/pg_clipfrac:0.06202104514813982 - actor/ppo_kl:0.23067543460056186 - actor/pg_clipfrac_lower:0.003720668191090226 - actor/grad_norm:61.016629695892334 - perf/mfu/actor:0.09364767121418771 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.46988296508789 - actor/lr:1e-06 - training/global_step:175 - training/epoch:4 - critic/score/mean:1.3078124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3078124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.003482433967292309 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.003482433967292309 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:375.02813720703125 - response_length/max:884.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3078125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.841603994369507e-05 - timing_s/generate_sequences:26.798490524291992 - timing_s/reshard:0.678735077381134 - timing_s/gen:30.01435604505241 - timing_s/reward:0.0762809794396162 - timing_s/old_log_prob:1.1495555266737938 - timing_s/ref:1.3854120261967182 - timing_s/adv:0.007902760058641434 - timing_s/update_actor:7.169622667133808 - timing_s/step:39.81756330654025 - timing_s/stop_profile:4.5672059059143066e-05 - timing_per_token_ms/adv:3.146955312372148e-05 - timing_per_token_ms/gen:0.25010087614305937 - timing_per_token_ms/ref:0.005516844372488166 - timing_per_token_ms/update_actor:0.028550129287259713 - perf/total_num_tokens:251124 - perf/time_per_step:39.81756330654025 - perf/throughput:788.3581362911763
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.353124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.353124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.015398994088172913, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.015398994088172913, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 353.29376220703125, 'response_length/max': 973.0, 'response_length/min': 123.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.353125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:176 - global_seqlen/min:28620 - global_seqlen/max:34998 - global_seqlen/minmax_diff:6378 - global_seqlen/balanced_min:30490 - global_seqlen/balanced_max:30491 - global_seqlen/mean:30490.5 - actor/entropy:0.29336613416671753 - actor/kl_loss:1.1266100402921437 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04164964454248547 - actor/pg_clipfrac:0.03303261632099748 - actor/ppo_kl:0.09985094217408914 - actor/pg_clipfrac_lower:0.0011708230478689075 - actor/grad_norm:48.4405198097229 - perf/mfu/actor:0.09225543442812653 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.54537200927734 - actor/lr:1e-06 - training/global_step:176 - training/epoch:5 - critic/score/mean:1.353124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.353124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.015398994088172913 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.015398994088172913 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:353.29376220703125 - response_length/max:973.0 - response_length/min:123.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.353125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0003471989184617996 - timing_s/generate_sequences:25.83443832397461 - timing_s/reshard:0.713636040687561 - timing_s/gen:32.23280813917518 - timing_s/reward:0.07618716545403004 - timing_s/old_log_prob:1.1986797209829092 - timing_s/ref:1.3533830307424068 - timing_s/adv:0.007732762023806572 - timing_s/update_actor:7.061891332268715 - timing_s/step:41.96421047113836 - timing_s/stop_profile:4.498474299907684e-05 - timing_per_token_ms/adv:3.1701521883072483e-05 - timing_per_token_ms/gen:0.2851098425458204 - timing_per_token_ms/ref:0.005548379949256354 - timing_per_token_ms/update_actor:0.028951195176648115 - perf/total_num_tokens:243924 - perf/time_per_step:41.96421047113836 - perf/throughput:726.5834304441494
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3203125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3203125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02496039681136608, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.02496039681136608, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 373.6812438964844, 'response_length/max': 877.0, 'response_length/min': 105.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  34%|███▎      | 177/525 [2:39:44<3:57:15, 40.91s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  34%|███▍      | 178/525 [2:40:18<3:44:09, 38.76s/it]
[36m(TaskRunner pid=2949575)[0m step:177 - global_seqlen/min:29438 - global_seqlen/max:33821 - global_seqlen/minmax_diff:4383 - global_seqlen/balanced_min:31332 - global_seqlen/balanced_max:31333 - global_seqlen/mean:31332.25 - actor/entropy:0.24740809202194214 - actor/kl_loss:1.7514088042080402 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.13430646769702434 - actor/pg_clipfrac:0.04693181897746399 - actor/ppo_kl:0.20432886795751984 - actor/pg_clipfrac_lower:0.005017611384391785 - actor/grad_norm:51.74368667602539 - perf/mfu/actor:0.09410591362245595 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.58153915405273 - actor/lr:1e-06 - training/global_step:177 - training/epoch:5 - critic/score/mean:1.3203125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3203125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02496039681136608 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.02496039681136608 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:373.6812438964844 - response_length/max:877.0 - response_length/min:105.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.476525545120239e-05 - timing_s/generate_sequences:26.896892547607422 - timing_s/reshard:0.6745882034301758 - timing_s/gen:30.185587199404836 - timing_s/reward:0.0771478433161974 - timing_s/old_log_prob:1.1313616205006838 - timing_s/ref:1.372445061802864 - timing_s/adv:0.007755909115076065 - timing_s/update_actor:7.119607023894787 - timing_s/step:39.90734630450606 - timing_s/stop_profile:4.79724258184433e-05 - timing_per_token_ms/adv:3.0942196598856074e-05 - timing_per_token_ms/gen:0.25243428723849565 - timing_per_token_ms/ref:0.00547536907580394 - timing_per_token_ms/update_actor:0.028403669637094314 - perf/total_num_tokens:250658 - perf/time_per_step:39.90734630450606 - perf/throughput:785.1248680111355
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.282812476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.282812476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01623842678964138, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.01623842678964138, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 354.390625, 'response_length/max': 670.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:178 - global_seqlen/min:29045 - global_seqlen/max:32196 - global_seqlen/minmax_diff:3151 - global_seqlen/balanced_min:30578 - global_seqlen/balanced_max:30579 - global_seqlen/mean:30578.125 - actor/entropy:0.294563353061676 - actor/kl_loss:1.4673467561602593 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.1044593520462513 - actor/pg_clipfrac:0.023406430787872523 - actor/ppo_kl:0.037360827717930076 - actor/pg_clipfrac_lower:0.0019088394241407514 - actor/grad_norm:60.25248193740845 - perf/mfu/actor:0.09352056809237881 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.77616882324219 - actor/lr:1e-06 - training/global_step:178 - training/epoch:5 - critic/score/mean:1.282812476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.282812476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01623842678964138 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.01623842678964138 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:354.390625 - response_length/max:670.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010181590914726257 - timing_s/generate_sequences:21.52836036682129 - timing_s/reshard:0.7199780941009521 - timing_s/gen:23.851117741316557 - timing_s/reward:0.07516605220735073 - timing_s/old_log_prob:1.0965771973133087 - timing_s/ref:1.3590787220746279 - timing_s/adv:0.007448667660355568 - timing_s/update_actor:6.988013407215476 - timing_s/step:33.39097755588591 - timing_s/stop_profile:4.4148415327072144e-05 - timing_per_token_ms/adv:3.0449331263589445e-05 - timing_per_token_ms/gen:0.21031804366047843 - timing_per_token_ms/ref:0.0055557638102182024 - timing_per_token_ms/update_actor:0.02856622752055381 - perf/total_num_tokens:244625 - perf/time_per_step:33.39097755588591 - perf/throughput:915.7601016269114
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.234375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.234375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0043838066048920155, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0043838066048920155, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 377.76251220703125, 'response_length/max': 807.0, 'response_length/min': 115.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.234375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  34%|███▍      | 179/525 [2:40:55<3:42:02, 38.50s/it]
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:21:29,768:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:21:33,241:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:21:33,243:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:21:34,124:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  34%|███▍      | 180/525 [2:41:48<4:06:08, 42.81s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:21:30,038:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:179 - global_seqlen/min:29768 - global_seqlen/max:33532 - global_seqlen/minmax_diff:3764 - global_seqlen/balanced_min:31495 - global_seqlen/balanced_max:31496 - global_seqlen/mean:31495.5 - actor/entropy:0.28227025270462036 - actor/kl_loss:1.1857063002884387 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.014368178695440293 - actor/pg_clipfrac:0.012799779896158724 - actor/ppo_kl:0.36609906021039934 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:36.1116898059845 - perf/mfu/actor:0.0959625923471384 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.77927780151367 - actor/lr:1e-06 - training/global_step:179 - training/epoch:5 - critic/score/mean:1.234375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.234375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0043838066048920155 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0043838066048920155 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:377.76251220703125 - response_length/max:807.0 - response_length/min:115.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.234375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.664652705192566e-05 - timing_s/generate_sequences:25.363019943237305 - timing_s/reshard:0.6862950921058655 - timing_s/gen:28.217664508149028 - timing_s/reward:0.07693985290825367 - timing_s/old_log_prob:1.2020960487425327 - timing_s/ref:1.3607166409492493 - timing_s/adv:0.007665805518627167 - timing_s/update_actor:7.017997618764639 - timing_s/step:37.89631097577512 - timing_s/stop_profile:4.44948673248291e-05 - timing_per_token_ms/adv:3.042420948479611e-05 - timing_per_token_ms/gen:0.2334276207616312 - timing_per_token_ms/ref:0.005400440701644875 - timing_per_token_ms/update_actor:0.02785317592499182 - perf/total_num_tokens:251964 - perf/time_per_step:37.89631097577512 - perf/throughput:831.0967265424124
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.321874976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.321874976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.011166255921125412, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.011166255921125412, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 369.1343688964844, 'response_length/max': 1045.0, 'response_length/min': 121.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.321875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:180 - global_seqlen/min:28280 - global_seqlen/max:33417 - global_seqlen/minmax_diff:5137 - global_seqlen/balanced_min:31137 - global_seqlen/balanced_max:31138 - global_seqlen/mean:31137.25 - actor/entropy:0.2898124158382416 - actor/kl_loss:1.0445459883660078 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.01377163827419281 - actor/pg_clipfrac:0.016614507813937963 - actor/ppo_kl:-0.011587544035864993 - actor/pg_clipfrac_lower:0.0037954627885483207 - actor/grad_norm:55.00345849990845 - perf/mfu/actor:0.09435519845727819 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.75467300415039 - actor/lr:1e-06 - training/global_step:180 - training/epoch:5 - critic/score/mean:1.321874976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.321874976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.011166255921125412 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.011166255921125412 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:369.1343688964844 - response_length/max:1045.0 - response_length/min:121.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.321875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.48621129989624e-05 - timing_s/generate_sequences:26.441205978393555 - timing_s/reshard:0.6705978512763977 - timing_s/gen:35.26134548150003 - timing_s/reward:0.07682591490447521 - timing_s/old_log_prob:1.118550505489111 - timing_s/ref:1.3521238341927528 - timing_s/adv:0.0077571868896484375 - timing_s/update_actor:7.056846279650927 - timing_s/save_checkpoint:7.9504318460822105 - timing_s/step:52.83771981857717 - timing_s/stop_profile:5.430169403553009e-05 - timing_per_token_ms/adv:3.114110466422226e-05 - timing_per_token_ms/gen:0.29851379901881964 - timing_per_token_ms/ref:0.005428079848865719 - timing_per_token_ms/update_actor:0.028329598309303674 - perf/total_num_tokens:249098 - perf/time_per_step:52.83771981857717 - perf/throughput:589.2996538630435
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2625000476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2625000476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.014352377504110336, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.014352377504110336, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 345.3125, 'response_length/max': 813.0, 'response_length/min': 98.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  34%|███▍      | 181/525 [2:42:26<3:57:26, 41.42s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:21:34,901:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:21:34,903:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_180/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  35%|███▍      | 182/525 [2:43:04<3:50:58, 40.40s/it]
[36m(TaskRunner pid=2949575)[0m step:181 - global_seqlen/min:27914 - global_seqlen/max:33321 - global_seqlen/minmax_diff:5407 - global_seqlen/balanced_min:30201 - global_seqlen/balanced_max:30202 - global_seqlen/mean:30201.875 - actor/entropy:0.29699990153312683 - actor/kl_loss:0.9827128805220127 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0846928695216775 - actor/pg_clipfrac:0.01198041969910264 - actor/ppo_kl:0.18171657657658216 - actor/pg_clipfrac_lower:0.0007735218096058816 - actor/grad_norm:39.1440646648407 - perf/mfu/actor:0.0906284489108155 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.66003036499023 - actor/lr:1e-06 - training/global_step:181 - training/epoch:5 - critic/score/mean:1.2625000476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2625000476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.014352377504110336 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.014352377504110336 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:345.3125 - response_length/max:813.0 - response_length/min:98.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.427724242210388e-05 - timing_s/generate_sequences:24.95041847229004 - timing_s/reshard:0.7962990999221802 - timing_s/gen:28.36656511388719 - timing_s/reward:0.07432245463132858 - timing_s/old_log_prob:1.188805652782321 - timing_s/ref:1.3764135390520096 - timing_s/adv:0.008093535900115967 - timing_s/update_actor:7.119989378377795 - timing_s/step:38.15106311812997 - timing_s/stop_profile:4.51989471912384e-05 - timing_per_token_ms/adv:3.3497654947399653e-05 - timing_per_token_ms/gen:0.25671099650576645 - timing_per_token_ms/ref:0.005696722219448336 - timing_per_token_ms/update_actor:0.0294683251386619 - perf/total_num_tokens:241615 - perf/time_per_step:38.15106311812997 - perf/throughput:791.6391453229938
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.310937523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.310937523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.00030011843773536384, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.00030011843773536384, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 331.97186279296875, 'response_length/max': 821.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:182 - global_seqlen/min:27081 - global_seqlen/max:31412 - global_seqlen/minmax_diff:4331 - global_seqlen/balanced_min:29681 - global_seqlen/balanced_max:29682 - global_seqlen/mean:29681.375 - actor/entropy:0.277675062417984 - actor/kl_loss:1.1102214738726617 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07598509695380926 - actor/pg_clipfrac:0.013258036214392633 - actor/ppo_kl:0.106420079000236 - actor/pg_clipfrac_lower:0.0017921613529324532 - actor/grad_norm:41.7029070854187 - perf/mfu/actor:0.09003865913851675 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.64943313598633 - actor/lr:1e-06 - training/global_step:182 - training/epoch:5 - critic/score/mean:1.310937523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.310937523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.00030011843773536384 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.00030011843773536384 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:331.97186279296875 - response_length/max:821.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.95006412267685e-05 - timing_s/generate_sequences:23.237300872802734 - timing_s/reshard:0.6779104471206665 - timing_s/gen:28.350152425467968 - timing_s/reward:0.07425180822610855 - timing_s/old_log_prob:1.0768180005252361 - timing_s/ref:1.3546344749629498 - timing_s/adv:0.0077736154198646545 - timing_s/update_actor:7.035173883661628 - timing_s/step:37.912947811186314 - timing_s/stop_profile:4.5435503125190735e-05 - timing_per_token_ms/adv:3.2737766612331194e-05 - timing_per_token_ms/gen:0.26687268712021883 - timing_per_token_ms/ref:0.0057049011162848325 - timing_per_token_ms/update_actor:0.029627897476370398 - perf/total_num_tokens:237451 - perf/time_per_step:37.912947811186314 - perf/throughput:782.8822793684861
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.267187476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.267187476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.01475326158106327, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.01475326158106327, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 341.3999938964844, 'response_length/max': 721.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  35%|███▍      | 183/525 [2:43:40<3:41:34, 38.87s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  35%|███▌      | 184/525 [2:44:17<3:38:02, 38.37s/it]
[36m(TaskRunner pid=2949575)[0m step:183 - global_seqlen/min:28112 - global_seqlen/max:32460 - global_seqlen/minmax_diff:4348 - global_seqlen/balanced_min:30062 - global_seqlen/balanced_max:30063 - global_seqlen/mean:30062.875 - actor/entropy:0.29002881050109863 - actor/kl_loss:1.0368781622499228 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06663979291915893 - actor/pg_clipfrac:0.028402600687695668 - actor/ppo_kl:-0.17928544201422483 - actor/pg_clipfrac_lower:0.005271964083658531 - actor/grad_norm:33.66894197463989 - perf/mfu/actor:0.09185242592235751 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.69072341918945 - actor/lr:1e-06 - training/global_step:183 - training/epoch:5 - critic/score/mean:1.267187476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.267187476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.01475326158106327 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.01475326158106327 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:341.3999938964844 - response_length/max:721.0 - response_length/min:92.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.668191730976105e-05 - timing_s/generate_sequences:22.719568252563477 - timing_s/reshard:0.7088390588760376 - timing_s/gen:25.726057797670364 - timing_s/reward:0.07453394308686256 - timing_s/old_log_prob:1.130532007664442 - timing_s/ref:1.350139470770955 - timing_s/adv:0.00791921466588974 - timing_s/update_actor:6.987540919333696 - timing_s/step:35.290897915139794 - timing_s/stop_profile:4.731491208076477e-05 - timing_per_token_ms/adv:3.292771676814734e-05 - timing_per_token_ms/gen:0.2354831008134736 - timing_per_token_ms/ref:0.005613815506546509 - timing_per_token_ms/update_actor:0.02905386177857946 - perf/total_num_tokens:240503 - perf/time_per_step:35.290897915139794 - perf/throughput:851.8591698145211
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.274999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.274999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.01920475624501705, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.01920475624501705, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 356.40625, 'response_length/max': 779.0, 'response_length/min': 94.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.275, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:184 - global_seqlen/min:29117 - global_seqlen/max:34601 - global_seqlen/minmax_diff:5484 - global_seqlen/balanced_min:30645 - global_seqlen/balanced_max:30646 - global_seqlen/mean:30645.625 - actor/entropy:0.27940744161605835 - actor/kl_loss:0.9336229421198368 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.027278747409582138 - actor/pg_clipfrac:0.009578058996703475 - actor/ppo_kl:0.11936520033050328 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:41.7330447435379 - perf/mfu/actor:0.09352007892540981 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.72558975219727 - actor/lr:1e-06 - training/global_step:184 - training/epoch:5 - critic/score/mean:1.274999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.274999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.01920475624501705 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.01920475624501705 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:356.40625 - response_length/max:779.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.275 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.852275252342224e-05 - timing_s/generate_sequences:22.520835876464844 - timing_s/reshard:0.669079065322876 - timing_s/gen:27.40196194127202 - timing_s/reward:0.0761381983757019 - timing_s/old_log_prob:1.1515006553381681 - timing_s/ref:1.3509027697145939 - timing_s/adv:0.007915396243333817 - timing_s/update_actor:7.00021286867559 - timing_s/step:37.00227740779519 - timing_s/stop_profile:4.3550506234169006e-05 - timing_per_token_ms/adv:3.228599613865689e-05 - timing_per_token_ms/gen:0.24026270882307776 - timing_per_token_ms/ref:0.0055101779198278465 - timing_per_token_ms/update_actor:0.028553067806071787 - perf/total_num_tokens:245165 - perf/time_per_step:37.00227740779519 - perf/throughput:828.2091575677974
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.248437523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.248437523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.005469051655381918, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.005469051655381918, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 324.8031311035156, 'response_length/max': 948.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  35%|███▌      | 185/525 [2:44:59<3:42:51, 39.33s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  35%|███▌      | 186/525 [2:45:32<3:32:46, 37.66s/it]
[36m(TaskRunner pid=2949575)[0m step:185 - global_seqlen/min:26655 - global_seqlen/max:30822 - global_seqlen/minmax_diff:4167 - global_seqlen/balanced_min:29390 - global_seqlen/balanced_max:29391 - global_seqlen/mean:29390.25 - actor/entropy:0.3140813708305359 - actor/kl_loss:1.094846360385418 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.13403038084506988 - actor/pg_clipfrac:0.01307724816724658 - actor/ppo_kl:0.06396153603709535 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:67.19123029708862 - perf/mfu/actor:0.08933947174505508 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.67221069335938 - actor/lr:1e-06 - training/global_step:185 - training/epoch:5 - critic/score/mean:1.248437523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.248437523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.005469051655381918 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.005469051655381918 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:324.8031311035156 - response_length/max:948.0 - response_length/min:99.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.374693036079407e-05 - timing_s/generate_sequences:23.72178840637207 - timing_s/reshard:0.6471818089485168 - timing_s/gen:31.920073706656694 - timing_s/reward:0.07340669631958008 - timing_s/old_log_prob:1.0879100374877453 - timing_s/ref:1.35734311491251 - timing_s/adv:0.007605209946632385 - timing_s/update_actor:7.02037862688303 - timing_s/step:41.47988263517618 - timing_s/stop_profile:4.423782229423523e-05 - timing_per_token_ms/adv:3.23458032282491e-05 - timing_per_token_ms/gen:0.3071098233223654 - timing_per_token_ms/ref:0.005772931137505252 - timing_per_token_ms/update_actor:0.029858450620882052 - perf/total_num_tokens:235122 - perf/time_per_step:41.47988263517618 - perf/throughput:708.5422651383345
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3328125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3328125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.006747966632246971, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.006747966632246971, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 325.02813720703125, 'response_length/max': 665.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3328125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:186 - global_seqlen/min:26564 - global_seqlen/max:31899 - global_seqlen/minmax_diff:5335 - global_seqlen/balanced_min:29377 - global_seqlen/balanced_max:29378 - global_seqlen/mean:29377.375 - actor/entropy:0.3108855187892914 - actor/kl_loss:1.0601467594504357 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09528651461005211 - actor/pg_clipfrac:0.01326563972979784 - actor/ppo_kl:0.09097715633106418 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:39.29735457897186 - perf/mfu/actor:0.08876794869988652 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.76633071899414 - actor/lr:1e-06 - training/global_step:186 - training/epoch:5 - critic/score/mean:1.3328125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3328125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.006747966632246971 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.006747966632246971 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:325.02813720703125 - response_length/max:665.0 - response_length/min:80.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3328125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010097585618495941 - timing_s/generate_sequences:21.691139221191406 - timing_s/reshard:0.6582964658737183 - timing_s/gen:23.66524370200932 - timing_s/reward:0.07361087389290333 - timing_s/old_log_prob:1.2183298338204622 - timing_s/ref:1.353385355323553 - timing_s/adv:0.009402381256222725 - timing_s/update_actor:7.066075067967176 - timing_s/step:33.39954946935177 - timing_s/stop_profile:4.535354673862457e-05 - timing_per_token_ms/adv:4.0006898404906515e-05 - timing_per_token_ms/gen:0.22753073005229663 - timing_per_token_ms/ref:0.005758621027761811 - timing_per_token_ms/update_actor:0.030065973678584185 - perf/total_num_tokens:235019 - perf/time_per_step:33.39954946935177 - perf/throughput:879.5739902706588
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.162500023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.162500023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.02026102878153324, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.02026102878153324, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 337.6312561035156, 'response_length/max': 848.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  36%|███▌      | 187/525 [2:46:11<3:33:40, 37.93s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  36%|███▌      | 188/525 [2:46:45<3:27:19, 36.91s/it]
[36m(TaskRunner pid=2949575)[0m step:187 - global_seqlen/min:28443 - global_seqlen/max:31526 - global_seqlen/minmax_diff:3083 - global_seqlen/balanced_min:29903 - global_seqlen/balanced_max:29904 - global_seqlen/mean:29903.375 - actor/entropy:0.3101564347743988 - actor/kl_loss:1.293179138749838 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14013298973441124 - actor/pg_clipfrac:0.04939581411308609 - actor/ppo_kl:0.23006622602697463 - actor/pg_clipfrac_lower:0.0024381840543355794 - actor/grad_norm:37.81197142601013 - perf/mfu/actor:0.09014574520925632 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.87145614624023 - actor/lr:1e-06 - training/global_step:187 - training/epoch:5 - critic/score/mean:1.162500023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.162500023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.02026102878153324 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.02026102878153324 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:337.6312561035156 - response_length/max:848.0 - response_length/min:76.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.493103086948395e-05 - timing_s/generate_sequences:22.999191284179688 - timing_s/reshard:0.6648088693618774 - timing_s/gen:28.951235866174102 - timing_s/reward:0.07470425218343735 - timing_s/old_log_prob:1.0830132886767387 - timing_s/ref:1.341882498934865 - timing_s/adv:0.007619187235832214 - timing_s/update_actor:7.080649370327592 - timing_s/step:38.55250468105078 - timing_s/stop_profile:4.4051557779312134e-05 - timing_per_token_ms/adv:3.18491944296932e-05 - timing_per_token_ms/gen:0.2679627910088123 - timing_per_token_ms/ref:0.005609243517390867 - timing_per_token_ms/update_actor:0.029598036050811957 - perf/total_num_tokens:239227 - perf/time_per_step:38.55250468105078 - perf/throughput:775.6532356949048
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1953125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1953125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0059061176143586636, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.0059061176143586636, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 342.6312561035156, 'response_length/max': 722.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:188 - global_seqlen/min:28905 - global_seqlen/max:31919 - global_seqlen/minmax_diff:3014 - global_seqlen/balanced_min:30090 - global_seqlen/balanced_max:30091 - global_seqlen/mean:30090.25 - actor/entropy:0.28802454471588135 - actor/kl_loss:1.11321221627295 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10670188777148723 - actor/pg_clipfrac:0.04006536506931298 - actor/ppo_kl:0.024242490494361845 - actor/pg_clipfrac_lower:0.010734383785165846 - actor/grad_norm:67.42471528053284 - perf/mfu/actor:0.09005483806117602 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.84163284301758 - actor/lr:1e-06 - training/global_step:188 - training/epoch:5 - critic/score/mean:1.1953125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1953125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0059061176143586636 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.0059061176143586636 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:342.6312561035156 - response_length/max:722.0 - response_length/min:92.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.170120418071747e-05 - timing_s/generate_sequences:22.647432327270508 - timing_s/reshard:0.6906245946884155 - timing_s/gen:24.871219508349895 - timing_s/reward:0.0744023248553276 - timing_s/old_log_prob:1.0843072086572647 - timing_s/ref:1.3422401584684849 - timing_s/adv:0.00851047970354557 - timing_s/update_actor:7.133839596062899 - timing_s/step:34.52775051444769 - timing_s/stop_profile:4.613026976585388e-05 - timing_per_token_ms/adv:3.535397555497865e-05 - timing_per_token_ms/gen:0.2268402574592756 - timing_per_token_ms/ref:0.005575893181630615 - timing_per_token_ms/update_actor:0.029635179152976872 - perf/total_num_tokens:240722 - perf/time_per_step:34.52775051444769 - perf/throughput:871.4801732423641
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.107812523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.107812523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0022318228147923946, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0022318228147923946, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 330.90313720703125, 'response_length/max': 786.0, 'response_length/min': 106.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1078125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  36%|███▌      | 189/525 [2:47:22<3:26:29, 36.87s/it]
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:27:46,147:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:27:49,744:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:27:49,746:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:27:50,827:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  36%|███▌      | 190/525 [2:48:05<3:35:20, 38.57s/it]
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:27:46,389:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:189 - global_seqlen/min:27460 - global_seqlen/max:32055 - global_seqlen/minmax_diff:4595 - global_seqlen/balanced_min:29629 - global_seqlen/balanced_max:29630 - global_seqlen/mean:29629.875 - actor/entropy:0.30760103464126587 - actor/kl_loss:1.537832023948431 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13829066492617131 - actor/pg_clipfrac:0.050094855343922974 - actor/ppo_kl:0.2463347172830254 - actor/pg_clipfrac_lower:0.0066749236197210845 - actor/grad_norm:62.38089394569397 - perf/mfu/actor:0.09090204779241057 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.91126251220703 - actor/lr:1e-06 - training/global_step:189 - training/epoch:5 - critic/score/mean:1.107812523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.107812523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0022318228147923946 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0022318228147923946 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:330.90313720703125 - response_length/max:786.0 - response_length/min:106.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1078125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.258409798145294e-05 - timing_s/generate_sequences:22.704635620117188 - timing_s/reshard:0.7212675213813782 - timing_s/gen:27.09579161182046 - timing_s/reward:0.07370546087622643 - timing_s/old_log_prob:1.2335971519351006 - timing_s/ref:1.3824148960411549 - timing_s/adv:0.007831135764718056 - timing_s/update_actor:6.956116449087858 - timing_s/step:36.76283775828779 - timing_s/stop_profile:4.323199391365051e-05 - timing_per_token_ms/adv:3.303733041701178e-05 - timing_per_token_ms/gen:0.2558886344362536 - timing_per_token_ms/ref:0.005832014546303161 - timing_per_token_ms/update_actor:0.02934587324907656 - perf/total_num_tokens:237039 - perf/time_per_step:36.76283775828779 - perf/throughput:805.9735539137008
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.350000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.350000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.012265190482139587, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.012265190482139587, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 326.390625, 'response_length/max': 700.0, 'response_length/min': 102.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.35, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:190 - global_seqlen/min:26962 - global_seqlen/max:31519 - global_seqlen/minmax_diff:4557 - global_seqlen/balanced_min:29418 - global_seqlen/balanced_max:29419 - global_seqlen/mean:29418.75 - actor/entropy:0.3101855218410492 - actor/kl_loss:0.9353466600179672 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.049958467856049536 - actor/pg_clipfrac:0.022307314531644806 - actor/ppo_kl:-0.1926708009239519 - actor/pg_clipfrac_lower:0.008939170488156378 - actor/grad_norm:48.76210331916809 - perf/mfu/actor:0.09006827828508805 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.95245742797852 - actor/lr:1e-06 - training/global_step:190 - training/epoch:5 - critic/score/mean:1.350000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.350000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.012265190482139587 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.012265190482139587 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:326.390625 - response_length/max:700.0 - response_length/min:102.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.35 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.627640247344971e-05 - timing_s/generate_sequences:22.216461181640625 - timing_s/reshard:0.6691868305206299 - timing_s/gen:24.969786696135998 - timing_s/reward:0.07375050149857998 - timing_s/old_log_prob:1.1925387345254421 - timing_s/ref:1.3485091645270586 - timing_s/adv:0.0076586902141571045 - timing_s/update_actor:6.970139482989907 - timing_s/save_checkpoint:7.8519766088575125 - timing_s/step:42.427813079208136 - timing_s/stop_profile:5.165673792362213e-05 - timing_per_token_ms/adv:3.254170475528831e-05 - timing_per_token_ms/gen:0.23907115415899274 - timing_per_token_ms/ref:0.005729803120998762 - timing_per_token_ms/update_actor:0.02961605898869729 - perf/total_num_tokens:235350 - perf/time_per_step:42.427813079208136 - perf/throughput:693.3836053505369
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3203125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3203125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.016110293567180634, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.016110293567180634, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 335.25, 'response_length/max': 752.0, 'response_length/min': 95.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  36%|███▋      | 191/525 [2:48:40<3:29:36, 37.65s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:27:51,337:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:27:51,339:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_190/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  37%|███▋      | 192/525 [2:49:14<3:23:13, 36.62s/it]
[36m(TaskRunner pid=2949575)[0m step:191 - global_seqlen/min:25945 - global_seqlen/max:31363 - global_seqlen/minmax_diff:5418 - global_seqlen/balanced_min:29790 - global_seqlen/balanced_max:29791 - global_seqlen/mean:29790.625 - actor/entropy:0.27496394515037537 - actor/kl_loss:2.0083434000611304 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06892664693295955 - actor/pg_clipfrac:0.07192837158218027 - actor/ppo_kl:1.418630822969135 - actor/pg_clipfrac_lower:6.775067886337638e-05 - actor/grad_norm:76.25045597553253 - perf/mfu/actor:0.09175409050076067 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.80013656616211 - actor/lr:1e-06 - training/global_step:191 - training/epoch:5 - critic/score/mean:1.3203125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3203125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.016110293567180634 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.016110293567180634 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:335.25 - response_length/max:752.0 - response_length/min:95.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.177198469638824e-05 - timing_s/generate_sequences:22.2220458984375 - timing_s/reshard:0.650346577167511 - timing_s/gen:26.054405640810728 - timing_s/reward:0.07421199604868889 - timing_s/old_log_prob:1.079556118696928 - timing_s/ref:1.3492063134908676 - timing_s/adv:0.0076947640627622604 - timing_s/update_actor:6.930302305147052 - timing_s/step:35.51001061499119 - timing_s/stop_profile:4.655309021472931e-05 - timing_per_token_ms/adv:3.228685225117911e-05 - timing_per_token_ms/gen:0.24286358725587928 - timing_per_token_ms/ref:0.005661203455327253 - timing_per_token_ms/update_actor:0.029079208245660557 - perf/total_num_tokens:238325 - perf/time_per_step:35.51001061499119 - perf/throughput:838.9359643678438
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2140624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2140624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.004878769163042307, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.004878769163042307, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 315.46875, 'response_length/max': 712.0, 'response_length/min': 108.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:192 - global_seqlen/min:28190 - global_seqlen/max:30154 - global_seqlen/minmax_diff:1964 - global_seqlen/balanced_min:29008 - global_seqlen/balanced_max:29009 - global_seqlen/mean:29008.125 - actor/entropy:0.3109484016895294 - actor/kl_loss:1.600049003213644 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08375424332916737 - actor/pg_clipfrac:0.03076027616043575 - actor/ppo_kl:0.07407948191685136 - actor/pg_clipfrac_lower:0.0010428635636344553 - actor/grad_norm:45.63591647148132 - perf/mfu/actor:0.08946028460992594 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.84735488891602 - actor/lr:1e-06 - training/global_step:192 - training/epoch:5 - critic/score/mean:1.2140624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2140624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.004878769163042307 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.004878769163042307 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:315.46875 - response_length/max:712.0 - response_length/min:108.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.980425238609314e-05 - timing_s/generate_sequences:20.705379486083984 - timing_s/reshard:0.7218889594078064 - timing_s/gen:24.589649373665452 - timing_s/reward:0.0736289769411087 - timing_s/old_log_prob:1.0818809606134892 - timing_s/ref:1.3512323629111052 - timing_s/adv:0.007642725482583046 - timing_s/update_actor:6.914195766672492 - timing_s/step:34.03161472082138 - timing_s/stop_profile:4.330836236476898e-05 - timing_per_token_ms/adv:3.293355517886388e-05 - timing_per_token_ms/gen:0.24358246036320408 - timing_per_token_ms/ref:0.005822646081533644 - timing_per_token_ms/update_actor:0.029794220441137147 - perf/total_num_tokens:232065 - perf/time_per_step:34.03161472082138 - perf/throughput:852.3875589791546
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.259374976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.259374976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.02438507415354252, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.02438507415354252, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 313.18438720703125, 'response_length/max': 728.0, 'response_length/min': 75.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.259375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  37%|███▋      | 193/525 [2:49:49<3:19:26, 36.04s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  37%|███▋      | 194/525 [2:50:27<3:21:48, 36.58s/it]
[36m(TaskRunner pid=2949575)[0m step:193 - global_seqlen/min:26621 - global_seqlen/max:30655 - global_seqlen/minmax_diff:4034 - global_seqlen/balanced_min:28903 - global_seqlen/balanced_max:28904 - global_seqlen/mean:28903.625 - actor/entropy:0.3085409104824066 - actor/kl_loss:1.4352397911250592 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08018257487565279 - actor/pg_clipfrac:0.0505004332982935 - actor/ppo_kl:0.07941630462810281 - actor/pg_clipfrac_lower:0.006220430880784988 - actor/grad_norm:62.23111081123352 - perf/mfu/actor:0.08920639334083602 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.82835388183594 - actor/lr:1e-06 - training/global_step:193 - training/epoch:5 - critic/score/mean:1.259374976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.259374976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.02438507415354252 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.02438507415354252 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:313.18438720703125 - response_length/max:728.0 - response_length/min:75.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.259375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.599514305591583e-05 - timing_s/generate_sequences:21.056360244750977 - timing_s/reshard:0.6701375246047974 - timing_s/gen:25.195746161043644 - timing_s/reward:0.07277444563806057 - timing_s/old_log_prob:1.0733362212777138 - timing_s/ref:1.3415226601064205 - timing_s/adv:0.007610047236084938 - timing_s/update_actor:6.908150075003505 - timing_s/step:34.61274831183255 - timing_s/stop_profile:4.542991518974304e-05 - timing_per_token_ms/adv:3.291130107419458e-05 - timing_per_token_ms/gen:0.25140688054204935 - timing_per_token_ms/ref:0.005801705928349906 - timing_per_token_ms/update_actor:0.029875794450538232 - perf/total_num_tokens:231229 - perf/time_per_step:34.61274831183255 - perf/throughput:835.0572089682676
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.171875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.171875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.02151240035891533, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.02151240035891533, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 312.53125, 'response_length/max': 831.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.171875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:194 - global_seqlen/min:28097 - global_seqlen/max:29974 - global_seqlen/minmax_diff:1877 - global_seqlen/balanced_min:28873 - global_seqlen/balanced_max:28874 - global_seqlen/mean:28873.125 - actor/entropy:0.32495659589767456 - actor/kl_loss:1.774460020661354 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1406256143003702 - actor/pg_clipfrac:0.0240377358160913 - actor/ppo_kl:0.21554073834558948 - actor/pg_clipfrac_lower:0.00034932002308778464 - actor/grad_norm:56.67426037788391 - perf/mfu/actor:0.08780958964918485 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94792175292969 - actor/lr:1e-06 - training/global_step:194 - training/epoch:5 - critic/score/mean:1.171875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.171875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.02151240035891533 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.02151240035891533 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:312.53125 - response_length/max:831.0 - response_length/min:88.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.171875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.730644524097443e-05 - timing_s/generate_sequences:22.20714569091797 - timing_s/reshard:0.6608043909072876 - timing_s/gen:27.89659583196044 - timing_s/reward:0.07310746982693672 - timing_s/old_log_prob:1.0792569983750582 - timing_s/ref:1.3897243589162827 - timing_s/adv:0.007622756063938141 - timing_s/update_actor:7.01212683133781 - timing_s/step:37.471695149317384 - timing_s/stop_profile:4.667602479457855e-05 - timing_per_token_ms/adv:3.3001086927454775e-05 - timing_per_token_ms/gen:0.27893806451315306 - timing_per_token_ms/ref:0.006016513448562818 - timing_per_token_ms/update_actor:0.030357498674536482 - perf/total_num_tokens:230985 - perf/time_per_step:37.471695149317384 - perf/throughput:770.5315941791862
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.225000023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.225000023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.03812304884195328, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.03812304884195328, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 310.38751220703125, 'response_length/max': 813.0, 'response_length/min': 64.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.225, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  37%|███▋      | 195/525 [2:51:04<3:21:20, 36.61s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  37%|███▋      | 196/525 [2:51:38<3:17:36, 36.04s/it]
[36m(TaskRunner pid=2949575)[0m step:195 - global_seqlen/min:27643 - global_seqlen/max:30297 - global_seqlen/minmax_diff:2654 - global_seqlen/balanced_min:28791 - global_seqlen/balanced_max:28792 - global_seqlen/mean:28791.75 - actor/entropy:0.2909110188484192 - actor/kl_loss:1.7150490552186965 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1222628247924149 - actor/pg_clipfrac:0.07400199444964528 - actor/ppo_kl:-0.09576178961724509 - actor/pg_clipfrac_lower:0.00973903676494956 - actor/grad_norm:41.63744831085205 - perf/mfu/actor:0.08839123383810658 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.8797721862793 - actor/lr:1e-06 - training/global_step:195 - training/epoch:5 - critic/score/mean:1.225000023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.225000023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.03812304884195328 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.03812304884195328 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:310.38751220703125 - response_length/max:813.0 - response_length/min:64.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.225 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.358992636203766e-05 - timing_s/generate_sequences:22.3837947845459 - timing_s/reshard:0.6446201205253601 - timing_s/gen:27.11997410096228 - timing_s/reward:0.07174316793680191 - timing_s/old_log_prob:1.1444780100136995 - timing_s/ref:1.349284389987588 - timing_s/adv:0.007528683170676231 - timing_s/update_actor:6.944554081186652 - timing_s/step:36.65424367785454 - timing_s/stop_profile:4.655122756958008e-05 - timing_per_token_ms/adv:3.268593942134566e-05 - timing_per_token_ms/gen:0.273045528784204 - timing_per_token_ms/ref:0.005857947111531897 - timing_per_token_ms/update_actor:0.030149930453978364 - perf/total_num_tokens:230334 - perf/time_per_step:36.65424367785454 - perf/throughput:785.495678291547
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.084375023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.084375023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.051840294152498245, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.051840294152498245, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 321.91876220703125, 'response_length/max': 739.0, 'response_length/min': 55.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.084375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:196 - global_seqlen/min:27288 - global_seqlen/max:30979 - global_seqlen/minmax_diff:3691 - global_seqlen/balanced_min:29274 - global_seqlen/balanced_max:29275 - global_seqlen/mean:29274.875 - actor/entropy:0.27073895931243896 - actor/kl_loss:1.9650506392121314 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10571694406680762 - actor/pg_clipfrac:0.03586079827509821 - actor/ppo_kl:0.48922821041196585 - actor/pg_clipfrac_lower:0.002670485572889447 - actor/grad_norm:68.41785383224487 - perf/mfu/actor:0.09066852549420361 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.89057922363281 - actor/lr:1e-06 - training/global_step:196 - training/epoch:5 - critic/score/mean:1.084375023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.084375023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.051840294152498245 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.051840294152498245 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:321.91876220703125 - response_length/max:739.0 - response_length/min:55.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.084375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.420327842235565e-05 - timing_s/generate_sequences:20.950092315673828 - timing_s/reshard:0.6504552960395813 - timing_s/gen:25.23597550019622 - timing_s/reward:0.07237176410853863 - timing_s/old_log_prob:1.1385433748364449 - timing_s/ref:1.3416052721440792 - timing_s/adv:0.007792333140969276 - timing_s/update_actor:6.887155642732978 - timing_s/step:34.69712411239743 - timing_s/stop_profile:4.374608397483826e-05 - timing_per_token_ms/adv:3.327227332725279e-05 - timing_per_token_ms/gen:0.24497617314341952 - timing_per_token_ms/ref:0.005728484204219827 - timing_per_token_ms/update_actor:0.02940728031602602 - perf/total_num_tokens:234199 - perf/time_per_step:34.69712411239743 - perf/throughput:843.7262669138611
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.103124976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.103124976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.03277871012687683, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.03277871012687683, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 335.5718688964844, 'response_length/max': 674.0, 'response_length/min': 104.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.103125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  38%|███▊      | 197/525 [2:52:11<3:12:07, 35.15s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  38%|███▊      | 198/525 [2:52:48<3:13:34, 35.52s/it]
[36m(TaskRunner pid=2949575)[0m step:197 - global_seqlen/min:27285 - global_seqlen/max:31809 - global_seqlen/minmax_diff:4524 - global_seqlen/balanced_min:29772 - global_seqlen/balanced_max:29773 - global_seqlen/mean:29772.875 - actor/entropy:0.2753864526748657 - actor/kl_loss:2.107071414589882 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.35322740599513053 - actor/pg_clipfrac:0.07450864585116505 - actor/ppo_kl:-0.4459411705844104 - actor/pg_clipfrac_lower:0.03875177213922143 - actor/grad_norm:55.12395763397217 - perf/mfu/actor:0.09077130258485047 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.92710494995117 - actor/lr:1e-06 - training/global_step:197 - training/epoch:5 - critic/score/mean:1.103124976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.103124976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.03277871012687683 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.03277871012687683 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:335.5718688964844 - response_length/max:674.0 - response_length/min:104.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.103125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.316710591316223e-05 - timing_s/generate_sequences:21.03586196899414 - timing_s/reshard:0.6603677868843079 - timing_s/gen:23.520253758877516 - timing_s/reward:0.07409653626382351 - timing_s/old_log_prob:1.0885790027678013 - timing_s/ref:1.3502232488244772 - timing_s/adv:0.007681423798203468 - timing_s/update_actor:7.000383285805583 - timing_s/step:33.05480343103409 - timing_s/stop_profile:4.5452266931533813e-05 - timing_per_token_ms/adv:3.2250092568333876e-05 - timing_per_token_ms/gen:0.21903144593536703 - timing_per_token_ms/ref:0.005668848107650324 - timing_per_token_ms/update_actor:0.029390776360217072 - perf/total_num_tokens:238183 - perf/time_per_step:33.05480343103409 - perf/throughput:900.7125110309145
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3546874523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3546874523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.03497925028204918, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.03497925028204918, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 307.6312561035156, 'response_length/max': 795.0, 'response_length/min': 122.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.3546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:198 - global_seqlen/min:26805 - global_seqlen/max:31376 - global_seqlen/minmax_diff:4571 - global_seqlen/balanced_min:28685 - global_seqlen/balanced_max:28686 - global_seqlen/mean:28685.875 - actor/entropy:0.24169743061065674 - actor/kl_loss:1.2911384031176567 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13551562428474426 - actor/pg_clipfrac:0.02788655712502077 - actor/ppo_kl:0.22696522939950228 - actor/pg_clipfrac_lower:0.003533362259622663 - actor/grad_norm:42.91024422645569 - perf/mfu/actor:0.08851671933589354 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.93190002441406 - actor/lr:1e-06 - training/global_step:198 - training/epoch:5 - critic/score/mean:1.3546874523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3546874523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.03497925028204918 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.03497925028204918 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:307.6312561035156 - response_length/max:795.0 - response_length/min:122.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.3546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.899213910102844e-05 - timing_s/generate_sequences:21.269943237304688 - timing_s/reshard:0.6743947267532349 - timing_s/gen:26.8661704454571 - timing_s/reward:0.07180891931056976 - timing_s/old_log_prob:1.071154871955514 - timing_s/ref:1.3418301492929459 - timing_s/adv:0.007629631087183952 - timing_s/update_actor:6.909640796482563 - timing_s/step:36.28151364997029 - timing_s/stop_profile:4.53069806098938e-05 - timing_per_token_ms/adv:3.32464631425046e-05 - timing_per_token_ms/gen:0.2729136998989974 - timing_per_token_ms/ref:0.005847085670617272 - timing_per_token_ms/update_actor:0.030109072829757517 - perf/total_num_tokens:229487 - perf/time_per_step:36.28151364997029 - perf/throughput:790.6471399388125
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.01240850891917944, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.01240850891917944, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 302.2875061035156, 'response_length/max': 620.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  38%|███▊      | 199/525 [2:53:20<3:07:05, 34.43s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:34:15,613:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 02:34:19,169:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 02:34:19,172:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:34:20,159:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/huggingface
[36m(TaskRunner pid=2949575)[0m step:199 - global_seqlen/min:26990 - global_seqlen/max:30229 - global_seqlen/minmax_diff:3239 - global_seqlen/balanced_min:28494 - global_seqlen/balanced_max:28494 - global_seqlen/mean:28494.0 - actor/entropy:0.26546552777290344 - actor/kl_loss:3.278600861132145 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06854318231344222 - actor/pg_clipfrac:0.13238300101365894 - actor/ppo_kl:0.24554254841059447 - actor/pg_clipfrac_lower:0.012447861675173044 - actor/grad_norm:60.09386920928955 - perf/mfu/actor:0.08570350387693079 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.90485382080078 - actor/lr:1e-06 - training/global_step:199 - training/epoch:5 - critic/score/mean:1.1875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.01240850891917944 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.01240850891917944 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:302.2875061035156 - response_length/max:620.0 - response_length/min:100.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.16546380519867e-05 - timing_s/generate_sequences:19.378524780273438 - timing_s/reshard:0.6568138599395752 - timing_s/gen:22.29935735091567 - timing_s/reward:0.07157527841627598 - timing_s/old_log_prob:1.064319284632802 - timing_s/ref:1.348218660801649 - timing_s/adv:0.007597718387842178 - timing_s/update_actor:7.085288448259234 - timing_s/step:31.890347987413406 - timing_s/stop_profile:5.8826059103012085e-05 - timing_per_token_ms/adv:3.333034317681871e-05 - timing_per_token_ms/gen:0.23052720248641267 - timing_per_token_ms/ref:0.005914484895072862 - timing_per_token_ms/update_actor:0.031082370184333696 - perf/total_num_tokens:227952 - perf/time_per_step:31.890347987413406 - perf/throughput:893.4991870031055
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 200}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the semi-major axis. The foci of this hyperbola are located at \((\pm c, 0)\) where \(c = \sqrt{2}a\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The equation of the parabola is \(y^2 = 16x\). The standard form of a parabola \(y^2 = 4px\) has its focus at \((p, 0)\) and its directrix at \(x = -p\). For the given parabola, \(4p = 16\), so \(p = 4\). Therefore, the focus of the parabola is \((4, 0)\) and its directrix is \(x = -4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The hyperbola intersects the parabola at points \(A\) and \(B\). The distance between the points of intersection is given as \(|AB| = 4\sqrt{3}\). The directrix of the parabola is \(x = -4\), and the foci of the hyperbola are at \((\pm \sqrt{2}a, 0)\). The points of intersection \(A\) and \(B\) must lie on the directrix \(x = -4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Substituting \(x = -4\) into the equation of the hyperbola, we get:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \frac{(-4)^2}{a^2} - \frac{y^2}{a^2} = 1 \implies \frac{16}{a^2} - \frac{y^2}{a^2} = 1 \implies \frac{16 - y^2}{a^2} = 1 \implies 16 - y^2 = a^2 \implies y^2 = 16 - a^2.
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m So, the points of intersection are \((-4, y)\) where \(y = \pm \sqrt{16 - a^2}\). The distance between these points is:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m |AB| = 2\sqrt{16 - a^2} = 4\sqrt{3}.
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m Solving for \(a\), we get:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m 2\sqrt{16 - a^2} = 4\sqrt{3} \implies \sqrt{16 - a^2} = 2\sqrt{3} \implies 16 - a^2 = 12 \implies a^2 = 4 \implies a = 2.
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m The length of the real axis of the hyperbola is \(2a = 2 \times 2 = 4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Therefore, the length of the real axis of the hyperbola is \(4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m </think>
[36m(TaskRunner pid=2949575)[0m <answer>The answer is \boxed{C}.</answer>
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] 2.0
[36m(TaskRunner pid=2949575)[0m [structure] 0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.5
[36m(TaskRunner pid=2949575)[0m [correct] 1.0
[36m(TaskRunner pid=2949575)[0m [acc] True
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1484375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1484375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.02840469405055046, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.02840469405055046, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 329.1656188964844, 'response_length/max': 691.0, 'response_length/min': 114.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:200 - global_seqlen/min:27028 - global_seqlen/max:32478 - global_seqlen/minmax_diff:5450 - global_seqlen/balanced_min:29534 - global_seqlen/balanced_max:29535 - global_seqlen/mean:29534.125 - actor/entropy:0.24066105484962463 - actor/kl_loss:2.1536677941679954 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06149381771683693 - actor/pg_clipfrac:0.05991638782434165 - actor/ppo_kl:0.5471877176081762 - actor/pg_clipfrac_lower:0.0019224656978622078 - actor/grad_norm:95.30006647109985 - perf/mfu/actor:0.08863311621670304 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.93401336669922 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:1.0 - val-aux/grpo_convert/reward/std@50:0.9058421984903521 - val-aux/grpo_convert/reward/best@2/mean:1.4642499999999998 - val-aux/grpo_convert/reward/best@2/std:0.6021348117880139 - val-aux/grpo_convert/reward/worst@2/mean:0.5795 - val-aux/grpo_convert/reward/worst@2/std:0.912638039666328 - val-aux/grpo_convert/reward/best@4/mean:1.7065000000000001 - val-aux/grpo_convert/reward/best@4/std:0.3539545868226622 - val-aux/grpo_convert/reward/worst@4/mean:0.09674999999999999 - val-aux/grpo_convert/reward/worst@4/std:0.798234078444148 - val-aux/grpo_convert/reward/best@8/mean:1.8525 - val-aux/grpo_convert/reward/best@8/std:0.2280213805764714 - val-aux/grpo_convert/reward/worst@8/mean:-0.28375 - val-aux/grpo_convert/reward/worst@8/std:0.5092417835059899 - val-aux/grpo_convert/reward/best@16/mean:1.9515 - val-aux/grpo_convert/reward/best@16/std:0.14797888362871237 - val-aux/grpo_convert/reward/worst@16/mean:-0.46299999999999997 - val-aux/grpo_convert/reward/worst@16/std:0.19021575842242291 - val-aux/grpo_convert/reward/best@32/mean:1.9955 - val-aux/grpo_convert/reward/best@32/std:0.04722022871609158 - val-aux/grpo_convert/reward/worst@32/mean:-0.5 - val-aux/grpo_convert/reward/worst@32/std:0.0 - val-aux/grpo_convert/reward/best@50/mean:1.9995 - val-aux/grpo_convert/reward/best@50/std:0.01580348062927911 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:1.0 - val-aux/grpo_convert/score/std@50:0.9058421984903521 - val-aux/grpo_convert/score/best@2/mean:1.4642499999999998 - val-aux/grpo_convert/score/best@2/std:0.6021348117880139 - val-aux/grpo_convert/score/worst@2/mean:0.5795 - val-aux/grpo_convert/score/worst@2/std:0.912638039666328 - val-aux/grpo_convert/score/best@4/mean:1.7065000000000001 - val-aux/grpo_convert/score/best@4/std:0.3539545868226622 - val-aux/grpo_convert/score/worst@4/mean:0.09674999999999999 - val-aux/grpo_convert/score/worst@4/std:0.798234078444148 - val-aux/grpo_convert/score/best@8/mean:1.8525 - val-aux/grpo_convert/score/best@8/std:0.2280213805764714 - val-aux/grpo_convert/score/worst@8/mean:-0.28375 - val-aux/grpo_convert/score/worst@8/std:0.5092417835059899 - val-aux/grpo_convert/score/best@16/mean:1.9515 - val-aux/grpo_convert/score/best@16/std:0.14797888362871237 - val-aux/grpo_convert/score/worst@16/mean:-0.46299999999999997 - val-aux/grpo_convert/score/worst@16/std:0.19021575842242291 - val-aux/grpo_convert/score/best@32/mean:1.9955 - val-aux/grpo_convert/score/best@32/std:0.04722022871609158 - val-aux/grpo_convert/score/worst@32/mean:-0.5 - val-aux/grpo_convert/score/worst@32/std:0.0 - val-aux/grpo_convert/score/best@50/mean:1.9995 - val-aux/grpo_convert/score/best@50/std:0.01580348062927911 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:0.25 - val-aux/grpo_convert/structure/std@50:0.4253318029167975 - val-aux/grpo_convert/structure/best@2/mean:0.43600000000000005 - val-aux/grpo_convert/structure/best@2/std:0.23652892680871124 - val-aux/grpo_convert/structure/worst@2/mean:0.08499999999999999 - val-aux/grpo_convert/structure/worst@2/std:0.482358428318193 - val-aux/grpo_convert/structure/best@4/mean:0.4955 - val-aux/grpo_convert/structure/best@4/std:0.0659584869803663 - val-aux/grpo_convert/structure/worst@4/mean:-0.1525 - val-aux/grpo_convert/structure/worst@4/std:0.46064807353478343 - val-aux/grpo_convert/structure/best@8/mean:0.5 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.3655 - val-aux/grpo_convert/structure/worst@8/std:0.31711482273052793 - val-aux/grpo_convert/structure/best@16/mean:0.5 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.47550000000000003 - val-aux/grpo_convert/structure/worst@16/std:0.12815772956152993 - val-aux/grpo_convert/structure/best@32/mean:0.5 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.5 - val-aux/grpo_convert/structure/worst@32/std:0.0 - val-aux/grpo_convert/structure/best@50/mean:0.5 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.37 - val-aux/grpo_convert/boxed/std@50:0.21447405638476286 - val-aux/grpo_convert/boxed/best@2/mean:0.46425 - val-aux/grpo_convert/boxed/best@2/std:0.12321708780188179 - val-aux/grpo_convert/boxed/worst@2/mean:0.28250000000000003 - val-aux/grpo_convert/boxed/worst@2/std:0.24049708551428559 - val-aux/grpo_convert/boxed/best@4/mean:0.497 - val-aux/grpo_convert/boxed/best@4/std:0.03728262327192111 - val-aux/grpo_convert/boxed/worst@4/mean:0.16625 - val-aux/grpo_convert/boxed/worst@4/std:0.22519660715984294 - val-aux/grpo_convert/boxed/best@8/mean:0.5 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.06475 - val-aux/grpo_convert/boxed/worst@8/std:0.15319793809670473 - val-aux/grpo_convert/boxed/best@16/mean:0.5 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.012 - val-aux/grpo_convert/boxed/worst@16/std:0.06081145114356017 - val-aux/grpo_convert/boxed/best@32/mean:0.5 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.0 - val-aux/grpo_convert/boxed/worst@32/std:0.0 - val-aux/grpo_convert/boxed/best@50/mean:0.5 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.38 - val-aux/grpo_convert/correct/std@50:0.41618673771920667 - val-aux/grpo_convert/correct/best@2/mean:0.5640000000000001 - val-aux/grpo_convert/correct/best@2/std:0.3869187165474823 - val-aux/grpo_convert/correct/worst@2/mean:0.21200000000000002 - val-aux/grpo_convert/correct/worst@2/std:0.31849264008483574 - val-aux/grpo_convert/correct/best@4/mean:0.714 - val-aux/grpo_convert/correct/best@4/std:0.31864432428672085 - val-aux/grpo_convert/correct/worst@4/mean:0.083 - val-aux/grpo_convert/correct/worst@4/std:0.20139375515895377 - val-aux/grpo_convert/correct/best@8/mean:0.8525 - val-aux/grpo_convert/correct/best@8/std:0.2280213805764714 - val-aux/grpo_convert/correct/worst@8/mean:0.017 - val-aux/grpo_convert/correct/worst@8/std:0.09061456836513651 - val-aux/grpo_convert/correct/best@16/mean:0.9515 - val-aux/grpo_convert/correct/best@16/std:0.14797888362871237 - val-aux/grpo_convert/correct/worst@16/mean:0.0005 - val-aux/grpo_convert/correct/worst@16/std:0.01580348062927911 - val-aux/grpo_convert/correct/best@32/mean:0.9955 - val-aux/grpo_convert/correct/best@32/std:0.04722022871609158 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.9995 - val-aux/grpo_convert/correct/best@50/std:0.01580348062927911 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.38 - val-aux/grpo_convert/acc/std@50:0.41618673771920667 - val-aux/grpo_convert/acc/best@2/mean:0.5640000000000001 - val-aux/grpo_convert/acc/best@2/std:0.3869187165474823 - val-aux/grpo_convert/acc/worst@2/mean:0.21200000000000002 - val-aux/grpo_convert/acc/worst@2/std:0.31849264008483574 - val-aux/grpo_convert/acc/best@4/mean:0.714 - val-aux/grpo_convert/acc/best@4/std:0.31864432428672085 - val-aux/grpo_convert/acc/worst@4/mean:0.083 - val-aux/grpo_convert/acc/worst@4/std:0.20139375515895377 - val-aux/grpo_convert/acc/best@8/mean:0.8525 - val-aux/grpo_convert/acc/best@8/std:0.2280213805764714 - val-aux/grpo_convert/acc/worst@8/mean:0.017 - val-aux/grpo_convert/acc/worst@8/std:0.09061456836513651 - val-aux/grpo_convert/acc/best@16/mean:0.9515 - val-aux/grpo_convert/acc/best@16/std:0.14797888362871237 - val-aux/grpo_convert/acc/worst@16/mean:0.0005 - val-aux/grpo_convert/acc/worst@16/std:0.01580348062927911 - val-aux/grpo_convert/acc/best@32/mean:0.9955 - val-aux/grpo_convert/acc/best@32/std:0.04722022871609158 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.9995 - val-core/grpo_convert/acc/best@50/std:0.01580348062927911 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:200 - training/epoch:5 - critic/score/mean:1.1484375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1484375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.02840469405055046 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.02840469405055046 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:329.1656188964844 - response_length/max:691.0 - response_length/min:114.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.725615382194519e-05 - timing_s/generate_sequences:22.141071319580078 - timing_s/reshard:0.7923265695571899 - timing_s/gen:24.584063770249486 - timing_s/reward:0.07261787168681622 - timing_s/old_log_prob:1.0970582868903875 - timing_s/ref:1.3436541203409433 - timing_s/adv:0.007620885968208313 - timing_s/update_actor:7.11000731959939 - timing_s/testing:32.12266429513693 - timing_s/save_checkpoint:7.708791242912412 - timing_s/step:74.06055592559278 - timing_s/stop_profile:5.187094211578369e-05 - timing_per_token_ms/adv:3.225457825569707e-05 - timing_per_token_ms/gen:0.23339374906486557 - timing_per_token_ms/ref:0.00568687120551626 - timing_per_token_ms/update_actor:0.0300923394530877 - perf/total_num_tokens:236273 - perf/time_per_step:74.06055592559278 - perf/throughput:398.78346348996314[36m(TaskRunner pid=2949575)[0m Training Progress:  38%|███▊      | 200/525 [2:54:34<4:11:11, 46.37s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  38%|███▊      | 201/525 [2:55:07<3:49:20, 42.47s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:34:15,916:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/model_world_size_8_rank_0.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:34:20,552:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:34:20,554:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_200/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  38%|███▊      | 202/525 [2:55:46<3:42:03, 41.25s/it]

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.154687523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.154687523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.02349572628736496, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.02349572628736496, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 310.1468811035156, 'response_length/max': 680.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.53125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:201 - global_seqlen/min:27381 - global_seqlen/max:29951 - global_seqlen/minmax_diff:2570 - global_seqlen/balanced_min:28747 - global_seqlen/balanced_max:28748 - global_seqlen/mean:28747.125 - actor/entropy:0.3159078359603882 - actor/kl_loss:2.345286034792662 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06561984522268176 - actor/pg_clipfrac:0.08535001720301807 - actor/ppo_kl:-0.39782235529273746 - actor/pg_clipfrac_lower:0.007461188361048698 - actor/grad_norm:55.15178108215332 - perf/mfu/actor:0.08752835965456605 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.69295501708984 - actor/lr:1e-06 - training/global_step:201 - training/epoch:5 - critic/score/mean:1.154687523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.154687523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.02349572628736496 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.02349572628736496 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:310.1468811035156 - response_length/max:680.0 - response_length/min:97.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.53125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.435415267944336e-05 - timing_s/generate_sequences:20.66668701171875 - timing_s/reshard:0.5984824299812317 - timing_s/gen:23.718987530097365 - timing_s/reward:0.07183543033897877 - timing_s/old_log_prob:1.069293599575758 - timing_s/ref:1.3535210900008678 - timing_s/adv:0.0076813288033008575 - timing_s/update_actor:7.000352116301656 - timing_s/step:33.241756089031696 - timing_s/stop_profile:4.64022159576416e-05 - timing_per_token_ms/adv:3.3400421795661555e-05 - timing_per_token_ms/gen:0.23898946597980156 - timing_per_token_ms/ref:0.005885462850636663 - timing_per_token_ms/update_actor:0.03043935748488612 - perf/total_num_tokens:229977 - perf/time_per_step:33.241756089031696 - perf/throughput:864.7896014580672
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.076562523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.076562523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.06503964960575104, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.06503964960575104, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 310.51251220703125, 'response_length/max': 819.0, 'response_length/min': 94.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0765625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:202 - global_seqlen/min:27834 - global_seqlen/max:29763 - global_seqlen/minmax_diff:1929 - global_seqlen/balanced_min:28805 - global_seqlen/balanced_max:28806 - global_seqlen/mean:28805.5 - actor/entropy:0.23568743467330933 - actor/kl_loss:3.006091910600662 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.026615175232291222 - actor/pg_clipfrac:0.12166449604555965 - actor/ppo_kl:1.0777101166546346 - actor/pg_clipfrac_lower:0.0008586396346800029 - actor/grad_norm:72.96732330322266 - perf/mfu/actor:0.08491072017998849 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.89753341674805 - actor/lr:1e-06 - training/global_step:202 - training/epoch:5 - critic/score/mean:1.076562523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.076562523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.06503964960575104 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.06503964960575104 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:310.51251220703125 - response_length/max:819.0 - response_length/min:94.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0765625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.995885193347931e-05 - timing_s/generate_sequences:21.72719955444336 - timing_s/reshard:0.657938539981842 - timing_s/gen:28.060139507055283 - timing_s/reward:0.07113552466034889 - timing_s/old_log_prob:1.1878843866288662 - timing_s/ref:1.3705182541161776 - timing_s/adv:0.010821999981999397 - timing_s/update_actor:7.236819930374622 - timing_s/step:37.95265999995172 - timing_s/stop_profile:4.391372203826904e-05 - timing_per_token_ms/adv:4.696151768759177e-05 - timing_per_token_ms/gen:0.2823974428068041 - timing_per_token_ms/ref:0.005947294154398368 - timing_per_token_ms/update_actor:0.03140381146992164 - perf/total_num_tokens:230444 - perf/time_per_step:37.95265999995172 - perf/throughput:758.9850092203457
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  39%|███▊      | 203/525 [2:56:22<3:32:52, 39.67s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  39%|███▉      | 204/525 [2:57:04<3:35:49, 40.34s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2625000476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2625000476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.03617396578192711, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.03617396578192711, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 299.7749938964844, 'response_length/max': 718.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:203 - global_seqlen/min:26960 - global_seqlen/max:32125 - global_seqlen/minmax_diff:5165 - global_seqlen/balanced_min:28389 - global_seqlen/balanced_max:28390 - global_seqlen/mean:28389.125 - actor/entropy:0.24515601992607117 - actor/kl_loss:2.046096384525299 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.003279995359480381 - actor/pg_clipfrac:0.07950506778433919 - actor/ppo_kl:-0.987034173309803 - actor/pg_clipfrac_lower:0.01574174463748932 - actor/grad_norm:93.36849451065063 - perf/mfu/actor:0.08655800522818034 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.07278442382812 - actor/lr:1e-06 - training/global_step:203 - training/epoch:5 - critic/score/mean:1.2625000476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2625000476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.03617396578192711 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.03617396578192711 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:299.7749938964844 - response_length/max:718.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.707121014595032e-05 - timing_s/generate_sequences:21.24106216430664 - timing_s/reshard:0.7828220129013062 - timing_s/gen:26.380765797570348 - timing_s/reward:0.0712765958160162 - timing_s/old_log_prob:1.1062479633837938 - timing_s/ref:1.3583505488932133 - timing_s/adv:0.007341304793953896 - timing_s/update_actor:6.9972830433398485 - timing_s/step:35.950976986438036 - timing_s/stop_profile:4.70820814371109e-05 - timing_per_token_ms/adv:3.232445872298766e-05 - timing_per_token_ms/gen:0.27500589814830234 - timing_per_token_ms/ref:0.0059809458238551435 - timing_per_token_ms/update_actor:0.03080969844676372 - perf/total_num_tokens:227113 - perf/time_per_step:35.950976986438036 - perf/throughput:789.662128256191
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.173437476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.173437476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.015550156123936176, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.015550156123936176, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 329.34375, 'response_length/max': 965.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:204 - global_seqlen/min:26645 - global_seqlen/max:31827 - global_seqlen/minmax_diff:5182 - global_seqlen/balanced_min:29528 - global_seqlen/balanced_max:29529 - global_seqlen/mean:29528.125 - actor/entropy:0.2350141853094101 - actor/kl_loss:3.048397359251976 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06303929761052132 - actor/pg_clipfrac:0.0977902163984254 - actor/ppo_kl:1.3428178284317256 - actor/pg_clipfrac_lower:0.0015269614581484348 - actor/grad_norm:55.19093084335327 - perf/mfu/actor:0.08980928321798072 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.9873161315918 - actor/lr:1e-06 - training/global_step:204 - training/epoch:5 - critic/score/mean:1.173437476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.173437476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.015550156123936176 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.015550156123936176 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:329.34375 - response_length/max:965.0 - response_length/min:82.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.032098412513733e-05 - timing_s/generate_sequences:24.9100284576416 - timing_s/reshard:0.72150057554245 - timing_s/gen:32.0598232652992 - timing_s/reward:0.07356180995702744 - timing_s/old_log_prob:1.378952143713832 - timing_s/ref:1.3525763135403395 - timing_s/adv:0.007535992190241814 - timing_s/update_actor:7.0191649831831455 - timing_s/step:41.90509081631899 - timing_s/stop_profile:4.2201951146125793e-05 - timing_per_token_ms/adv:3.190175548837682e-05 - timing_per_token_ms/gen:0.30420175790207044 - timing_per_token_ms/ref:0.005725796649551654 - timing_per_token_ms/update_actor:0.029713895579143383 - perf/total_num_tokens:236225 - perf/time_per_step:41.90509081631899 - perf/throughput:704.6429067396494
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2453124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2453124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.01265767402946949, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.01265767402946949, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 326.54376220703125, 'response_length/max': 860.0, 'response_length/min': 65.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2453125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  39%|███▉      | 205/525 [2:57:43<3:33:30, 40.03s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  39%|███▉      | 206/525 [2:58:16<3:21:31, 37.91s/it]
[36m(TaskRunner pid=2949575)[0m step:205 - global_seqlen/min:26929 - global_seqlen/max:32860 - global_seqlen/minmax_diff:5931 - global_seqlen/balanced_min:29429 - global_seqlen/balanced_max:29430 - global_seqlen/mean:29429.25 - actor/entropy:0.22010041773319244 - actor/kl_loss:2.5767367094755174 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.033959446102380754 - actor/pg_clipfrac:0.05584604879841208 - actor/ppo_kl:0.17371837496757508 - actor/pg_clipfrac_lower:0.0067414103425107895 - actor/grad_norm:66.9311671257019 - perf/mfu/actor:0.08730897539096141 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94847106933594 - actor/lr:1e-06 - training/global_step:205 - training/epoch:5 - critic/score/mean:1.2453124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2453124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.01265767402946949 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.01265767402946949 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:326.54376220703125 - response_length/max:860.0 - response_length/min:65.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2453125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.246302604675293e-05 - timing_s/generate_sequences:25.372846603393555 - timing_s/reshard:0.6595089435577393 - timing_s/gen:29.560037698596716 - timing_s/reward:0.07267982698976994 - timing_s/old_log_prob:1.1021876372396946 - timing_s/ref:1.3431949596852064 - timing_s/adv:0.007682302966713905 - timing_s/update_actor:7.193521521985531 - timing_s/step:39.297141971066594 - timing_s/stop_profile:4.689954221248627e-05 - timing_per_token_ms/adv:3.263038884236731e-05 - timing_per_token_ms/gen:0.2828874164889536 - timing_per_token_ms/ref:0.005705186845082725 - timing_per_token_ms/update_actor:0.03055430193593759 - perf/total_num_tokens:235434 - perf/time_per_step:39.297141971066594 - perf/throughput:748.890339701242
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2312500476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2312500476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.03321495279669762, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.03321495279669762, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 314.42498779296875, 'response_length/max': 664.0, 'response_length/min': 90.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.23125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:206 - global_seqlen/min:27046 - global_seqlen/max:31736 - global_seqlen/minmax_diff:4690 - global_seqlen/balanced_min:28962 - global_seqlen/balanced_max:28962 - global_seqlen/mean:28962.0 - actor/entropy:0.22280289232730865 - actor/kl_loss:2.6089206993579865 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1244192521669902 - actor/pg_clipfrac:0.04645057695452124 - actor/ppo_kl:0.20215430511161686 - actor/pg_clipfrac_lower:0.016365571581991388 - actor/grad_norm:88.73665070533752 - perf/mfu/actor:0.08891160641590519 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.91143417358398 - actor/lr:1e-06 - training/global_step:206 - training/epoch:5 - critic/score/mean:1.2312500476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2312500476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.03321495279669762 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.03321495279669762 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:314.42498779296875 - response_length/max:664.0 - response_length/min:90.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.23125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.927285671234131e-05 - timing_s/generate_sequences:20.957582473754883 - timing_s/reshard:0.7184016108512878 - timing_s/gen:23.35713796876371 - timing_s/reward:0.0724605917930603 - timing_s/old_log_prob:1.0733597557991743 - timing_s/ref:1.3410326074808836 - timing_s/adv:0.007575927302241325 - timing_s/update_actor:6.948772989213467 - timing_s/step:32.81381204165518 - timing_s/stop_profile:4.3550506234169006e-05 - timing_per_token_ms/adv:3.269770432912664e-05 - timing_per_token_ms/gen:0.23214138873304155 - timing_per_token_ms/ref:0.005787897104312908 - timing_per_token_ms/update_actor:0.029990906140863315 - perf/total_num_tokens:231696 - perf/time_per_step:32.81381204165518 - perf/throughput:882.6161362548936
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1218750476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1218750476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0326499380171299, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.0326499380171299, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 303.359375, 'response_length/max': 657.0, 'response_length/min': 66.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.121875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  39%|███▉      | 207/525 [2:58:49<3:13:09, 36.45s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  40%|███▉      | 208/525 [2:59:27<3:14:59, 36.91s/it]
[36m(TaskRunner pid=2949575)[0m step:207 - global_seqlen/min:27338 - global_seqlen/max:29621 - global_seqlen/minmax_diff:2283 - global_seqlen/balanced_min:28519 - global_seqlen/balanced_max:28520 - global_seqlen/mean:28519.375 - actor/entropy:0.20021799206733704 - actor/kl_loss:3.4285305976867675 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.19740978982299567 - actor/pg_clipfrac:0.1158962526358664 - actor/ppo_kl:1.0365243675361853 - actor/pg_clipfrac_lower:0.0015386141836643218 - actor/grad_norm:81.11456394195557 - perf/mfu/actor:0.08788890579507455 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.86067962646484 - actor/lr:1e-06 - training/global_step:207 - training/epoch:5 - critic/score/mean:1.1218750476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1218750476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0326499380171299 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0326499380171299 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:303.359375 - response_length/max:657.0 - response_length/min:66.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.121875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.129514753818512e-05 - timing_s/generate_sequences:20.312721252441406 - timing_s/reshard:0.6616234183311462 - timing_s/gen:23.620767643675208 - timing_s/reward:0.070986308157444 - timing_s/old_log_prob:1.0614948607981205 - timing_s/ref:1.3400255404412746 - timing_s/adv:0.007666401565074921 - timing_s/update_actor:6.915090214461088 - timing_s/step:33.029451785609126 - timing_s/stop_profile:4.4424086809158325e-05 - timing_per_token_ms/adv:3.3601724989918786e-05 - timing_per_token_ms/gen:0.2433249306585136 - timing_per_token_ms/ref:0.005873312180058621 - timing_per_token_ms/update_actor:0.030308738421078164 - perf/total_num_tokens:228155 - perf/time_per_step:33.029451785609126 - perf/throughput:863.452871852564
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0109374523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0109374523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04241614043712616, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04241614043712616, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 321.875, 'response_length/max': 827.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:208 - global_seqlen/min:27281 - global_seqlen/max:30911 - global_seqlen/minmax_diff:3630 - global_seqlen/balanced_min:29268 - global_seqlen/balanced_max:29269 - global_seqlen/mean:29268.75 - actor/entropy:0.20847265422344208 - actor/kl_loss:2.813037583231926 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0484003844554536 - actor/pg_clipfrac:0.08472109781578183 - actor/ppo_kl:-1.190430967323482 - actor/pg_clipfrac_lower:0.03272153381258249 - actor/grad_norm:74.69628667831421 - perf/mfu/actor:0.08705648538269474 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.87307357788086 - actor/lr:1e-06 - training/global_step:208 - training/epoch:5 - critic/score/mean:1.0109374523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0109374523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04241614043712616 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04241614043712616 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:321.875 - response_length/max:827.0 - response_length/min:85.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.156391024589539e-05 - timing_s/generate_sequences:21.822813034057617 - timing_s/reshard:0.6567769050598145 - timing_s/gen:28.09670947678387 - timing_s/reward:0.0720244962722063 - timing_s/old_log_prob:1.1278670355677605 - timing_s/ref:1.3694043029099703 - timing_s/adv:0.007544811815023422 - timing_s/update_actor:7.170502932742238 - timing_s/step:37.85756259225309 - timing_s/stop_profile:4.5282766222953796e-05 - timing_per_token_ms/adv:3.222213032254291e-05 - timing_per_token_ms/gen:0.27278358715324147 - timing_per_token_ms/ref:0.005848406162331712 - timing_per_token_ms/update_actor:0.03062354444903796 - perf/total_num_tokens:234150 - perf/time_per_step:37.85756259225309 - perf/throughput:773.1282205154263
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.087499976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.087499976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.023968107998371124, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.023968107998371124, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 304.15625, 'response_length/max': 748.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  40%|███▉      | 209/525 [3:00:03<3:12:27, 36.54s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:40:26,186:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:40:29,673:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:40:29,675:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:40:31,066:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/huggingface
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:40:26,625:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  40%|████      | 210/525 [3:00:45<3:21:18, 38.34s/it]
[36m(TaskRunner pid=2949575)[0m step:209 - global_seqlen/min:24899 - global_seqlen/max:31589 - global_seqlen/minmax_diff:6690 - global_seqlen/balanced_min:28538 - global_seqlen/balanced_max:28539 - global_seqlen/mean:28538.125 - actor/entropy:0.2437422126531601 - actor/kl_loss:2.9836244702339174 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1652593497186899 - actor/pg_clipfrac:0.07852589711546898 - actor/ppo_kl:0.4415783252101392 - actor/pg_clipfrac_lower:0.006660414615180343 - actor/grad_norm:101.17302560806274 - perf/mfu/actor:0.08772333245328122 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.86805725097656 - actor/lr:1e-06 - training/global_step:209 - training/epoch:5 - critic/score/mean:1.087499976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.087499976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.023968107998371124 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.023968107998371124 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:304.15625 - response_length/max:748.0 - response_length/min:101.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.996017277240753e-05 - timing_s/generate_sequences:21.38740348815918 - timing_s/reshard:0.7011317014694214 - timing_s/gen:26.12722926028073 - timing_s/reward:0.07118603587150574 - timing_s/old_log_prob:1.0753464549779892 - timing_s/ref:1.3468270637094975 - timing_s/adv:0.0077012162655591965 - timing_s/update_actor:6.934431325644255 - timing_s/step:35.57616285979748 - timing_s/stop_profile:4.448555409908295e-05 - timing_per_token_ms/adv:3.37321401877278e-05 - timing_per_token_ms/gen:0.26843963074366306 - timing_per_token_ms/ref:0.00589924471084513 - timing_per_token_ms/update_actor:0.030373541208664964 - perf/total_num_tokens:228305 - perf/time_per_step:35.57616285979748 - perf/throughput:802.1698436806194
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1218750476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1218750476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.06038711592555046, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.06038711592555046, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 308.7124938964844, 'response_length/max': 718.0, 'response_length/min': 115.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.121875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:210 - global_seqlen/min:27648 - global_seqlen/max:30197 - global_seqlen/minmax_diff:2549 - global_seqlen/balanced_min:28742 - global_seqlen/balanced_max:28743 - global_seqlen/mean:28742.25 - actor/entropy:0.23963364958763123 - actor/kl_loss:2.7616479575634 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.19963511936366557 - actor/pg_clipfrac:0.04994045658968389 - actor/ppo_kl:0.3679399462416768 - actor/pg_clipfrac_lower:0.0035617707413621246 - actor/grad_norm:62.271825313568115 - perf/mfu/actor:0.08814831989091508 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.92397689819336 - actor/lr:1e-06 - training/global_step:210 - training/epoch:5 - critic/score/mean:1.1218750476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1218750476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.06038711592555046 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.06038711592555046 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:308.7124938964844 - response_length/max:718.0 - response_length/min:115.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.121875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.307824075222015e-05 - timing_s/generate_sequences:21.80426025390625 - timing_s/reshard:0.6450328826904297 - timing_s/gen:24.829234842211008 - timing_s/reward:0.07131472788751125 - timing_s/old_log_prob:1.0809074901044369 - timing_s/ref:1.3551071397960186 - timing_s/adv:0.00757923349738121 - timing_s/update_actor:6.951269244775176 - timing_s/save_checkpoint:8.11984022706747 - timing_s/step:42.42895422130823 - timing_s/stop_profile:5.2483752369880676e-05 - timing_per_token_ms/adv:3.29620745478399e-05 - timing_per_token_ms/gen:0.2513385719137042 - timing_per_token_ms/ref:0.005893358817576993 - timing_per_token_ms/update_actor:0.030231059001883883 - perf/total_num_tokens:229938 - perf/time_per_step:42.42895422130823 - perf/throughput:677.420655953037
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.134374976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.134374976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.02907632105052471, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.02907632105052471, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 323.1625061035156, 'response_length/max': 949.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.134375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  40%|████      | 211/525 [3:01:29<3:29:25, 40.02s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:40:31,722:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:40:31,724:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_210/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  40%|████      | 212/525 [3:02:03<3:19:06, 38.17s/it]
[36m(TaskRunner pid=2949575)[0m step:211 - global_seqlen/min:26919 - global_seqlen/max:30595 - global_seqlen/minmax_diff:3676 - global_seqlen/balanced_min:29280 - global_seqlen/balanced_max:29291 - global_seqlen/mean:29285.25 - actor/entropy:0.24296414852142334 - actor/kl_loss:2.868954187631607 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.24296292955987156 - actor/pg_clipfrac:0.08167893302161247 - actor/ppo_kl:-0.24107084227725864 - actor/pg_clipfrac_lower:0.03126417915336788 - actor/grad_norm:91.48288536071777 - perf/mfu/actor:0.08888188865368485 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.97362899780273 - actor/lr:1e-06 - training/global_step:211 - training/epoch:6 - critic/score/mean:1.134374976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.134374976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.02907632105052471 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.02907632105052471 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:323.1625061035156 - response_length/max:949.0 - response_length/min:112.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.134375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00030936114490032196 - timing_s/generate_sequences:23.46346092224121 - timing_s/reshard:0.6788786053657532 - timing_s/gen:31.636542197316885 - timing_s/reward:0.07264090701937675 - timing_s/old_log_prob:1.2041037306189537 - timing_s/ref:1.347758762538433 - timing_s/adv:0.008742975071072578 - timing_s/update_actor:7.033341486006975 - timing_s/step:41.3373298458755 - timing_s/stop_profile:4.483945667743683e-05 - timing_per_token_ms/adv:3.731816815236586e-05 - timing_per_token_ms/gen:0.30592718637408506 - timing_per_token_ms/ref:0.005752720066152898 - timing_per_token_ms/update_actor:0.03002083594133128 - perf/total_num_tokens:234282 - perf/time_per_step:41.3373298458755 - perf/throughput:708.4456134246897
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.189062476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.189062476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.045157160609960556, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.045157160609960556, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 302.1187438964844, 'response_length/max': 709.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:212 - global_seqlen/min:26791 - global_seqlen/max:30574 - global_seqlen/minmax_diff:3783 - global_seqlen/balanced_min:28474 - global_seqlen/balanced_max:28475 - global_seqlen/mean:28474.125 - actor/entropy:0.2420559674501419 - actor/kl_loss:2.9747228562831878 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.024500615336000918 - actor/pg_clipfrac:0.09399921925505623 - actor/ppo_kl:1.5962119117379188 - actor/pg_clipfrac_lower:0.000621462136041373 - actor/grad_norm:58.18402862548828 - perf/mfu/actor:0.08664048454885069 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94316864013672 - actor/lr:1e-06 - training/global_step:212 - training/epoch:6 - critic/score/mean:1.189062476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.189062476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.045157160609960556 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.045157160609960556 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:302.1187438964844 - response_length/max:709.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.054690599441528e-05 - timing_s/generate_sequences:20.871383666992188 - timing_s/reshard:0.6579830646514893 - timing_s/gen:24.231891883537173 - timing_s/reward:0.0717412568628788 - timing_s/old_log_prob:1.1507368925958872 - timing_s/ref:1.343679666519165 - timing_s/adv:0.009950246661901474 - timing_s/update_actor:7.0093051847070456 - timing_s/step:33.83378567546606 - timing_s/stop_profile:4.412606358528137e-05 - timing_per_token_ms/adv:4.368109055985686e-05 - timing_per_token_ms/gen:0.2506453576153538 - timing_per_token_ms/ref:0.005898687257813739 - timing_per_token_ms/update_actor:0.030770502977295375 - perf/total_num_tokens:227793 - perf/time_per_step:33.83378567546606 - perf/throughput:841.5885018934633
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.048437476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.048437476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.045302290469408035, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.045302290469408035, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 303.2093811035156, 'response_length/max': 673.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  41%|████      | 213/525 [3:02:36<3:11:00, 36.73s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  41%|████      | 214/525 [3:03:14<3:12:07, 37.07s/it]
[36m(TaskRunner pid=2949575)[0m step:213 - global_seqlen/min:26339 - global_seqlen/max:31382 - global_seqlen/minmax_diff:5043 - global_seqlen/balanced_min:28517 - global_seqlen/balanced_max:28518 - global_seqlen/mean:28517.75 - actor/entropy:0.24278013408184052 - actor/kl_loss:2.6880387723445893 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05936839580535889 - actor/pg_clipfrac:0.07113452358171343 - actor/ppo_kl:-0.14507303796708584 - actor/pg_clipfrac_lower:0.010591444675810635 - actor/grad_norm:79.44660568237305 - perf/mfu/actor:0.08743158945913014 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.97311782836914 - actor/lr:1e-06 - training/global_step:213 - training/epoch:6 - critic/score/mean:1.048437476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.048437476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.045302290469408035 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.045302290469408035 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:303.2093811035156 - response_length/max:673.0 - response_length/min:85.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.246675133705139e-05 - timing_s/generate_sequences:20.79183578491211 - timing_s/reshard:0.6707379221916199 - timing_s/gen:23.861300384625793 - timing_s/reward:0.07089034654200077 - timing_s/old_log_prob:1.1266066748648882 - timing_s/ref:1.3370884787291288 - timing_s/adv:0.007484382018446922 - timing_s/update_actor:6.952330591157079 - timing_s/step:33.36939924955368 - timing_s/stop_profile:4.600733518600464e-05 - timing_per_token_ms/adv:3.2805805237294854e-05 - timing_per_token_ms/gen:0.24592433430515004 - timing_per_token_ms/ref:0.00586077302175456 - timing_per_token_ms/update_actor:0.030473698797928828 - perf/total_num_tokens:228142 - perf/time_per_step:33.36939924955368 - perf/throughput:854.6078335642027
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.064062476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.064062476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.10317686200141907, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.10317686200141907, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 278.95001220703125, 'response_length/max': 848.0, 'response_length/min': 69.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:214 - global_seqlen/min:26013 - global_seqlen/max:29165 - global_seqlen/minmax_diff:3152 - global_seqlen/balanced_min:27544 - global_seqlen/balanced_max:27563 - global_seqlen/mean:27547.375 - actor/entropy:0.2533816695213318 - actor/kl_loss:3.9786070048809052 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05988340452313423 - actor/pg_clipfrac:0.08154818899929524 - actor/ppo_kl:0.3564278569072485 - actor/pg_clipfrac_lower:0.0027463780686957763 - actor/grad_norm:81.180748462677 - perf/mfu/actor:0.08343788900218017 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.95172119140625 - actor/lr:1e-06 - training/global_step:214 - training/epoch:6 - critic/score/mean:1.064062476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.064062476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.10317686200141907 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.10317686200141907 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:278.95001220703125 - response_length/max:848.0 - response_length/min:69.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.528997957706451e-05 - timing_s/generate_sequences:22.24846649169922 - timing_s/reshard:0.6523601412773132 - timing_s/gen:28.30434820614755 - timing_s/reward:0.06866602413356304 - timing_s/old_log_prob:1.0724737606942654 - timing_s/ref:1.3355704341083765 - timing_s/adv:0.007570303976535797 - timing_s/update_actor:7.029632950201631 - timing_s/step:37.83148901723325 - timing_s/stop_profile:4.482269287109375e-05 - timing_per_token_ms/adv:3.435129470836966e-05 - timing_per_token_ms/gen:0.3170858151791041 - timing_per_token_ms/ref:0.0060603343971448115 - timing_per_token_ms/update_actor:0.03189792561996211 - perf/total_num_tokens:220379 - perf/time_per_step:37.83148901723325 - perf/throughput:728.1599460029563
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.139062523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.139062523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.06462053954601288, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.06462053954601288, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 284.01873779296875, 'response_length/max': 629.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  41%|████      | 215/525 [3:03:46<3:03:09, 35.45s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  41%|████      | 216/525 [3:04:18<2:57:14, 34.41s/it]
[36m(TaskRunner pid=2949575)[0m step:215 - global_seqlen/min:26291 - global_seqlen/max:28841 - global_seqlen/minmax_diff:2550 - global_seqlen/balanced_min:27763 - global_seqlen/balanced_max:27764 - global_seqlen/mean:27763.25 - actor/entropy:0.25454747676849365 - actor/kl_loss:3.2314052790403367 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0015144623117521404 - actor/pg_clipfrac:0.05497978664934635 - actor/ppo_kl:-0.6198263230733574 - actor/pg_clipfrac_lower:0.03380951564759016 - actor/grad_norm:114.01639938354492 - perf/mfu/actor:0.08510361594785486 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.8212776184082 - actor/lr:1e-06 - training/global_step:215 - training/epoch:6 - critic/score/mean:1.139062523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.139062523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.06462053954601288 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.06462053954601288 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:284.01873779296875 - response_length/max:629.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.615983486175537e-05 - timing_s/generate_sequences:19.741527557373047 - timing_s/reshard:0.6533252596855164 - timing_s/gen:22.118583081290126 - timing_s/reward:0.0701780840754509 - timing_s/old_log_prob:1.1658925861120224 - timing_s/ref:1.3390551712363958 - timing_s/adv:0.007542790845036507 - timing_s/update_actor:6.94706385396421 - timing_s/step:31.661488397046924 - timing_s/stop_profile:4.6040862798690796e-05 - timing_per_token_ms/adv:3.3960320050050454e-05 - timing_per_token_ms/gen:0.24336622891633614 - timing_per_token_ms/ref:0.006028901385988653 - timing_per_token_ms/update_actor:0.03127814581309919 - perf/total_num_tokens:222106 - perf/time_per_step:31.661488397046924 - perf/throughput:876.877601325574
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2265625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2265625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.036850713193416595, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.036850713193416595, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 264.9375, 'response_length/max': 641.0, 'response_length/min': 52.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:216 - global_seqlen/min:25465 - global_seqlen/max:28552 - global_seqlen/minmax_diff:3087 - global_seqlen/balanced_min:26956 - global_seqlen/balanced_max:26957 - global_seqlen/mean:26956.25 - actor/entropy:0.29511040449142456 - actor/kl_loss:3.2065791130065917 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.007407060265541077 - actor/pg_clipfrac:0.05553785082884133 - actor/ppo_kl:0.23547371495515107 - actor/pg_clipfrac_lower:0.0035470085684210064 - actor/grad_norm:81.43660306930542 - perf/mfu/actor:0.0822991712975128 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.78086471557617 - actor/lr:1e-06 - training/global_step:216 - training/epoch:6 - critic/score/mean:1.2265625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2265625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.036850713193416595 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.036850713193416595 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:264.9375 - response_length/max:641.0 - response_length/min:52.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.131749927997589e-05 - timing_s/generate_sequences:18.60251235961914 - timing_s/reshard:0.6675513386726379 - timing_s/gen:22.464998941868544 - timing_s/reward:0.06850501708686352 - timing_s/old_log_prob:1.1319302767515182 - timing_s/ref:1.3326233867555857 - timing_s/adv:0.007544403895735741 - timing_s/update_actor:6.968501556664705 - timing_s/step:31.987259915098548 - timing_s/stop_profile:4.597008228302002e-05 - timing_per_token_ms/adv:3.498448363429511e-05 - timing_per_token_ms/gen:0.26497993562005834 - timing_per_token_ms/ref:0.006179565901950316 - timing_per_token_ms/update_actor:0.03231394183475402 - perf/total_num_tokens:215650 - perf/time_per_step:31.987259915098548 - perf/throughput:842.7183219678087
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.204687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.204687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.06662999838590622, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.06662999838590622, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 257.2406311035156, 'response_length/max': 853.0, 'response_length/min': 81.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  41%|████▏     | 217/525 [3:04:55<3:01:43, 35.40s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  42%|████▏     | 218/525 [3:05:29<2:58:39, 34.92s/it]
[36m(TaskRunner pid=2949575)[0m step:217 - global_seqlen/min:25162 - global_seqlen/max:27691 - global_seqlen/minmax_diff:2529 - global_seqlen/balanced_min:26679 - global_seqlen/balanced_max:26701 - global_seqlen/mean:26683.375 - actor/entropy:0.31118038296699524 - actor/kl_loss:3.607080751657486 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.009248485974967479 - actor/pg_clipfrac:0.07573888855986297 - actor/ppo_kl:0.6824727753642946 - actor/pg_clipfrac_lower:0.0010618918400723486 - actor/grad_norm:76.04155254364014 - perf/mfu/actor:0.08026023394507227 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.6763801574707 - actor/lr:1e-06 - training/global_step:217 - training/epoch:6 - critic/score/mean:1.204687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.204687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.06662999838590622 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.06662999838590622 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:257.2406311035156 - response_length/max:853.0 - response_length/min:81.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.797963917255402e-05 - timing_s/generate_sequences:21.802997589111328 - timing_s/reshard:0.6949566602706909 - timing_s/gen:28.004155550152063 - timing_s/reward:0.06756578013300896 - timing_s/old_log_prob:1.1855430789291859 - timing_s/ref:1.3380079697817564 - timing_s/adv:0.007498588413000107 - timing_s/update_actor:7.072071671485901 - timing_s/step:37.68799925222993 - timing_s/stop_profile:4.424341022968292e-05 - timing_per_token_ms/adv:3.512762353431728e-05 - timing_per_token_ms/gen:0.3401989327860838 - timing_per_token_ms/ref:0.0062679850739540835 - timing_per_token_ms/update_actor:0.033129578208743744 - perf/total_num_tokens:213467 - perf/time_per_step:37.68799925222993 - perf/throughput:708.0072046653205
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.165624976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.165624976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04850032925605774, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04850032925605774, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 273.8968811035156, 'response_length/max': 695.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.390625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.165625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:218 - global_seqlen/min:25666 - global_seqlen/max:28649 - global_seqlen/minmax_diff:2983 - global_seqlen/balanced_min:27371 - global_seqlen/balanced_max:27372 - global_seqlen/mean:27371.5 - actor/entropy:0.29717135429382324 - actor/kl_loss:2.6277862548828126 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10450743343681097 - actor/pg_clipfrac:0.04822181449271738 - actor/ppo_kl:-0.6450243394472637 - actor/pg_clipfrac_lower:0.018216210417449474 - actor/grad_norm:90.57098388671875 - perf/mfu/actor:0.08330240255034994 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.7058219909668 - actor/lr:1e-06 - training/global_step:218 - training/epoch:6 - critic/score/mean:1.165624976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.165624976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04850032925605774 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04850032925605774 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:273.8968811035156 - response_length/max:695.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.165625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.977709174156189e-05 - timing_s/generate_sequences:20.338180541992188 - timing_s/reshard:0.6543612480163574 - timing_s/gen:24.173310631886125 - timing_s/reward:0.0687029268592596 - timing_s/old_log_prob:1.1261261869221926 - timing_s/ref:1.3908335138112307 - timing_s/adv:0.007633069530129433 - timing_s/update_actor:6.994159705936909 - timing_s/step:33.774614783003926 - timing_s/stop_profile:4.369951784610748e-05 - timing_per_token_ms/adv:3.4858655582126634e-05 - timing_per_token_ms/gen:0.27580305808397465 - timing_per_token_ms/ref:0.006351650045719227 - timing_per_token_ms/update_actor:0.03194088607647055 - perf/total_num_tokens:218972 - perf/time_per_step:33.774614783003926 - perf/throughput:810.4163489608147
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0703125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0703125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.07864486426115036, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.07864486426115036, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 276.47186279296875, 'response_length/max': 635.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  42%|████▏     | 219/525 [3:06:02<2:55:17, 34.37s/it]
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:46:23,828:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:46:27,229:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:46:27,232:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:46:28,302:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  42%|████▏     | 220/525 [3:06:42<3:03:11, 36.04s/it]
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 02:46:24,287:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:219 - global_seqlen/min:25442 - global_seqlen/max:29343 - global_seqlen/minmax_diff:3901 - global_seqlen/balanced_min:27430 - global_seqlen/balanced_max:27431 - global_seqlen/mean:27430.75 - actor/entropy:0.3346271216869354 - actor/kl_loss:3.937978172302246 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15553759187459945 - actor/pg_clipfrac:0.12658675536513328 - actor/ppo_kl:1.8257311701774597 - actor/pg_clipfrac_lower:0.0013932482106611133 - actor/grad_norm:86.61021661758423 - perf/mfu/actor:0.08273875565220608 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94071960449219 - actor/lr:1e-06 - training/global_step:219 - training/epoch:6 - critic/score/mean:1.0703125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0703125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.07864486426115036 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.07864486426115036 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:276.47186279296875 - response_length/max:635.0 - response_length/min:82.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.28044319152832e-05 - timing_s/generate_sequences:19.245899200439453 - timing_s/reshard:0.6853755712509155 - timing_s/gen:22.824395639821887 - timing_s/reward:0.06993952207267284 - timing_s/old_log_prob:1.0553530622273684 - timing_s/ref:1.3650799375027418 - timing_s/adv:0.00733196921646595 - timing_s/update_actor:7.059835458174348 - timing_s/step:32.395043121650815 - timing_s/stop_profile:4.124082624912262e-05 - timing_per_token_ms/adv:3.3411268450853285e-05 - timing_per_token_ms/gen:0.25798731380703155 - timing_per_token_ms/ref:0.006220573341517922 - timing_per_token_ms/update_actor:0.03217117403905447 - perf/total_num_tokens:219446 - perf/time_per_step:32.395043121650815 - perf/throughput:846.757631931257
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04980355128645897, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04980355128645897, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 279.42498779296875, 'response_length/max': 651.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.71875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:220 - global_seqlen/min:26042 - global_seqlen/max:28391 - global_seqlen/minmax_diff:2349 - global_seqlen/balanced_min:27605 - global_seqlen/balanced_max:27606 - global_seqlen/mean:27605.75 - actor/entropy:0.364176869392395 - actor/kl_loss:3.5544288873672487 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.15174573790282012 - actor/pg_clipfrac:0.07014689045026898 - actor/ppo_kl:0.1648861078545451 - actor/pg_clipfrac_lower:0.00019685039296746254 - actor/grad_norm:87.8343505859375 - perf/mfu/actor:0.08427198865703399 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.87141418457031 - actor/lr:1e-06 - training/global_step:220 - training/epoch:6 - critic/score/mean:1.0625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04980355128645897 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04980355128645897 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:279.42498779296875 - response_length/max:651.0 - response_length/min:70.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.71875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.819384336471558e-05 - timing_s/generate_sequences:19.181976318359375 - timing_s/reshard:0.7720708250999451 - timing_s/gen:22.71093124896288 - timing_s/reward:0.06969003565609455 - timing_s/old_log_prob:1.0695733483880758 - timing_s/ref:1.339122410863638 - timing_s/adv:0.009659934788942337 - timing_s/update_actor:6.975797116756439 - timing_s/save_checkpoint:7.725641084834933 - timing_s/step:39.92066247202456 - timing_s/stop_profile:4.883483052253723e-05 - timing_per_token_ms/adv:4.374059203672395e-05 - timing_per_token_ms/gen:0.25399180514631475 - timing_per_token_ms/ref:0.006063602740659274 - timing_per_token_ms/update_actor:0.03158670348005596 - perf/total_num_tokens:220846 - perf/time_per_step:39.92066247202456 - perf/throughput:691.5153279168512
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.109375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.109375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.042107485234737396, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.042107485234737396, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 272.9281311035156, 'response_length/max': 803.0, 'response_length/min': 73.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  42%|████▏     | 221/525 [3:07:20<3:04:41, 36.45s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:46:28,918:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:46:28,919:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_220/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  42%|████▏     | 222/525 [3:07:53<2:59:01, 35.45s/it]
[36m(TaskRunner pid=2949575)[0m step:221 - global_seqlen/min:25763 - global_seqlen/max:28869 - global_seqlen/minmax_diff:3106 - global_seqlen/balanced_min:27271 - global_seqlen/balanced_max:27272 - global_seqlen/mean:27271.5 - actor/entropy:0.463968425989151 - actor/kl_loss:4.320811128616333 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04204592637252062 - actor/pg_clipfrac:0.10455361790955067 - actor/ppo_kl:0.3724839191418141 - actor/pg_clipfrac_lower:0.00583150468301028 - actor/grad_norm:96.98197078704834 - perf/mfu/actor:0.08128430117537551 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.70611953735352 - actor/lr:1e-06 - training/global_step:221 - training/epoch:6 - critic/score/mean:1.109375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.109375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.042107485234737396 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.042107485234737396 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:272.9281311035156 - response_length/max:803.0 - response_length/min:73.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.750466465950012e-05 - timing_s/generate_sequences:22.592025756835938 - timing_s/reshard:0.6727620363235474 - timing_s/gen:27.66088450141251 - timing_s/reward:0.06869659014046192 - timing_s/old_log_prob:1.1606528498232365 - timing_s/ref:1.3577037453651428 - timing_s/adv:0.007503170520067215 - timing_s/update_actor:7.140889812260866 - timing_s/step:37.40940450876951 - timing_s/stop_profile:4.3122097849845886e-05 - timing_per_token_ms/adv:3.439107914886977e-05 - timing_per_token_ms/gen:0.31671438796171736 - timing_per_token_ms/ref:0.006223088871922808 - timing_per_token_ms/update_actor:0.03273055118099878 - perf/total_num_tokens:218172 - perf/time_per_step:37.40940450876951 - perf/throughput:729.001179198322
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.053125023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.053125023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.05237364396452904, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.05237364396452904, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 295.58123779296875, 'response_length/max': 654.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.053125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:222 - global_seqlen/min:26958 - global_seqlen/max:31020 - global_seqlen/minmax_diff:4062 - global_seqlen/balanced_min:28208 - global_seqlen/balanced_max:28209 - global_seqlen/mean:28208.25 - actor/entropy:0.4295697510242462 - actor/kl_loss:4.641626369953156 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.19420561697334052 - actor/pg_clipfrac:0.1009139746427536 - actor/ppo_kl:-0.15344335362315178 - actor/pg_clipfrac_lower:0.027336661168374122 - actor/grad_norm:80.05417442321777 - perf/mfu/actor:0.08483358473683837 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.68219757080078 - actor/lr:1e-06 - training/global_step:222 - training/epoch:6 - critic/score/mean:1.053125023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.053125023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.05237364396452904 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.05237364396452904 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:295.58123779296875 - response_length/max:654.0 - response_length/min:83.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.053125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.75698572397232e-05 - timing_s/generate_sequences:21.009883880615234 - timing_s/reshard:0.6639904975891113 - timing_s/gen:23.39565535634756 - timing_s/reward:0.07026233337819576 - timing_s/old_log_prob:1.1725660916417837 - timing_s/ref:1.350921606644988 - timing_s/adv:0.007527146488428116 - timing_s/update_actor:7.084582906216383 - timing_s/step:33.09465171396732 - timing_s/stop_profile:4.300661385059357e-05 - timing_per_token_ms/adv:3.335525284459385e-05 - timing_per_token_ms/gen:0.24734797281148965 - timing_per_token_ms/ref:0.005986376355520938 - timing_per_token_ms/update_actor:0.031394108577350525 - perf/total_num_tokens:225666 - perf/time_per_step:33.09465171396732 - perf/throughput:852.3507134566684
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.047250114381313324, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.047250114381313324, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 291.6468811035156, 'response_length/max': 636.0, 'response_length/min': 62.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  42%|████▏     | 223/525 [3:08:26<2:54:32, 34.68s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  43%|████▎     | 224/525 [3:08:56<2:47:58, 33.48s/it]
[36m(TaskRunner pid=2949575)[0m step:223 - global_seqlen/min:26283 - global_seqlen/max:29197 - global_seqlen/minmax_diff:2914 - global_seqlen/balanced_min:28064 - global_seqlen/balanced_max:28064 - global_seqlen/mean:28064.0 - actor/entropy:0.45645639300346375 - actor/kl_loss:4.276710331439972 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15534470230340958 - actor/pg_clipfrac:0.11640989079605787 - actor/ppo_kl:0.07831716216169297 - actor/pg_clipfrac_lower:0.01597516723559238 - actor/grad_norm:110.5984296798706 - perf/mfu/actor:0.08012974005664886 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.79445266723633 - actor/lr:1e-06 - training/global_step:223 - training/epoch:6 - critic/score/mean:1.125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.047250114381313324 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.047250114381313324 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:291.6468811035156 - response_length/max:636.0 - response_length/min:62.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.414553642272949e-05 - timing_s/generate_sequences:19.675880432128906 - timing_s/reshard:0.7485233545303345 - timing_s/gen:22.735583471134305 - timing_s/reward:0.07000638544559479 - timing_s/old_log_prob:1.060860911384225 - timing_s/ref:1.3364453595131636 - timing_s/adv:0.007775940001010895 - timing_s/update_actor:7.459271363914013 - timing_s/step:32.68286197818816 - timing_s/stop_profile:4.4578686356544495e-05 - timing_per_token_ms/adv:3.463485248454824e-05 - timing_per_token_ms/gen:0.24361206800962534 - timing_per_token_ms/ref:0.005952667828504328 - timing_per_token_ms/update_actor:0.03322437715540378 - perf/total_num_tokens:224512 - perf/time_per_step:32.68286197818816 - perf/throughput:858.676330693723
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.240625023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.240625023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.042141638696193695, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.042141638696193695, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 269.9624938964844, 'response_length/max': 593.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.240625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:224 - global_seqlen/min:25419 - global_seqlen/max:28552 - global_seqlen/minmax_diff:3133 - global_seqlen/balanced_min:27174 - global_seqlen/balanced_max:27175 - global_seqlen/mean:27174.75 - actor/entropy:0.5328465104103088 - actor/kl_loss:3.941994255781174 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15914854141883553 - actor/pg_clipfrac:0.10112561453133821 - actor/ppo_kl:-0.742001436650753 - actor/pg_clipfrac_lower:0.024527855613268913 - actor/grad_norm:92.75232028961182 - perf/mfu/actor:0.08197969459671908 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.74933624267578 - actor/lr:1e-06 - training/global_step:224 - training/epoch:6 - critic/score/mean:1.240625023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.240625023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.042141638696193695 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.042141638696193695 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:269.9624938964844 - response_length/max:593.0 - response_length/min:91.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.240625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.013099431991577e-05 - timing_s/generate_sequences:18.422443389892578 - timing_s/reshard:0.654373824596405 - timing_s/gen:21.160606909543276 - timing_s/reward:0.06808296963572502 - timing_s/old_log_prob:1.0375414341688156 - timing_s/ref:1.3488613311201334 - timing_s/adv:0.007538557052612305 - timing_s/update_actor:7.053884686902165 - timing_s/step:30.68975673802197 - timing_s/stop_profile:4.196353256702423e-05 - timing_per_token_ms/adv:3.4676294412148704e-05 - timing_per_token_ms/gen:0.24494845244181224 - timing_per_token_ms/ref:0.006204571022365124 - timing_per_token_ms/update_actor:0.03244687019614792 - perf/total_num_tokens:217398 - perf/time_per_step:30.68975673802197 - perf/throughput:885.4664516233464
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1124999523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1124999523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.06457450985908508, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.06457450985908508, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 286.0375061035156, 'response_length/max': 724.0, 'response_length/min': 46.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  43%|████▎     | 225/525 [3:09:31<2:48:54, 33.78s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  43%|████▎     | 226/525 [3:10:06<2:50:58, 34.31s/it]
[36m(TaskRunner pid=2949575)[0m step:225 - global_seqlen/min:26080 - global_seqlen/max:29431 - global_seqlen/minmax_diff:3351 - global_seqlen/balanced_min:27844 - global_seqlen/balanced_max:27844 - global_seqlen/mean:27844.0 - actor/entropy:0.5628208518028259 - actor/kl_loss:4.354302850365639 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.161707073263824 - actor/pg_clipfrac:0.06685761401895433 - actor/ppo_kl:0.35321170184761286 - actor/pg_clipfrac_lower:0.002592401544097811 - actor/grad_norm:87.44919443130493 - perf/mfu/actor:0.08189823761758742 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.6617317199707 - actor/lr:1e-06 - training/global_step:225 - training/epoch:6 - critic/score/mean:1.1124999523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1124999523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.06457450985908508 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.06457450985908508 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:286.0375061035156 - response_length/max:724.0 - response_length/min:46.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.764436304569244e-05 - timing_s/generate_sequences:21.473691940307617 - timing_s/reshard:0.6952548623085022 - timing_s/gen:24.721255341544747 - timing_s/reward:0.06914101168513298 - timing_s/old_log_prob:1.0580802150070667 - timing_s/ref:1.3496755193918943 - timing_s/adv:0.007500767707824707 - timing_s/update_actor:7.240532288327813 - timing_s/step:34.459278490394354 - timing_s/stop_profile:4.693120718002319e-05 - timing_per_token_ms/adv:3.367317782926621e-05 - timing_per_token_ms/gen:0.2700831986796393 - timing_per_token_ms/ref:0.006059094954891064 - timing_per_token_ms/update_actor:0.03250490360727541 - perf/total_num_tokens:222752 - perf/time_per_step:34.459278490394354 - perf/throughput:808.0262042561807
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.048437476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.048437476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.07280030846595764, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.07280030846595764, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 308.59686279296875, 'response_length/max': 747.0, 'response_length/min': 59.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:226 - global_seqlen/min:26960 - global_seqlen/max:31722 - global_seqlen/minmax_diff:4762 - global_seqlen/balanced_min:28737 - global_seqlen/balanced_max:28738 - global_seqlen/mean:28737.625 - actor/entropy:0.5404847264289856 - actor/kl_loss:4.756564486026764 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08947044187225402 - actor/pg_clipfrac:0.10688920974498614 - actor/ppo_kl:-0.03297731427010149 - actor/pg_clipfrac_lower:0.00560895748785697 - actor/grad_norm:129.2262954711914 - perf/mfu/actor:0.08741148829047132 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.75661087036133 - actor/lr:1e-06 - training/global_step:226 - training/epoch:6 - critic/score/mean:1.048437476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.048437476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.07280030846595764 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.07280030846595764 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:308.59686279296875 - response_length/max:747.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.672794163227081e-05 - timing_s/generate_sequences:22.904048919677734 - timing_s/reshard:0.7854161858558655 - timing_s/gen:25.98267692513764 - timing_s/reward:0.07087857648730278 - timing_s/old_log_prob:1.0846469439566135 - timing_s/ref:1.3624363914132118 - timing_s/adv:0.007569631561636925 - timing_s/update_actor:7.009781014174223 - timing_s/step:35.53096920065582 - timing_s/stop_profile:4.396215081214905e-05 - timing_per_token_ms/adv:3.292561390179653e-05 - timing_per_token_ms/gen:0.2631130512616342 - timing_per_token_ms/ref:0.005926187321556722 - timing_per_token_ms/update_actor:0.030490432900136245 - perf/total_num_tokens:229901 - perf/time_per_step:35.53096920065582 - perf/throughput:808.8049846799443
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0265624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0265624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.08163397014141083, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.08163397014141083, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 281.36248779296875, 'response_length/max': 733.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  43%|████▎     | 227/525 [3:10:42<2:51:43, 34.58s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  43%|████▎     | 228/525 [3:11:22<2:59:28, 36.26s/it]
[36m(TaskRunner pid=2949575)[0m step:227 - global_seqlen/min:26366 - global_seqlen/max:29562 - global_seqlen/minmax_diff:3196 - global_seqlen/balanced_min:27630 - global_seqlen/balanced_max:27631 - global_seqlen/mean:27630.75 - actor/entropy:0.7204161286354065 - actor/kl_loss:4.825484573841095 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0706290939822793 - actor/pg_clipfrac:0.06458298983052373 - actor/ppo_kl:0.1185318685369566 - actor/pg_clipfrac_lower:0.0024616822774987668 - actor/grad_norm:101.95682668685913 - perf/mfu/actor:0.08488385084446623 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.98908615112305 - actor/lr:1e-06 - training/global_step:227 - training/epoch:6 - critic/score/mean:1.0265624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0265624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.08163397014141083 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.08163397014141083 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:281.36248779296875 - response_length/max:733.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010028667747974396 - timing_s/generate_sequences:20.558950424194336 - timing_s/reshard:0.7207724452018738 - timing_s/gen:25.07976063527167 - timing_s/reward:0.06886901147663593 - timing_s/old_log_prob:1.1015921793878078 - timing_s/ref:1.3353824317455292 - timing_s/adv:0.007475860416889191 - timing_s/update_actor:6.932898988947272 - timing_s/step:34.539085233584046 - timing_s/stop_profile:4.5103952288627625e-05 - timing_per_token_ms/adv:3.382038316408888e-05 - timing_per_token_ms/gen:0.27855258602416444 - timing_per_token_ms/ref:0.006041196998568303 - timing_per_token_ms/update_actor:0.031364055395470956 - perf/total_num_tokens:221046 - perf/time_per_step:34.539085233584046 - perf/throughput:799.984997087684
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.126562476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.126562476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.05647817254066467, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.05647817254066467, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 267.73126220703125, 'response_length/max': 907.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:228 - global_seqlen/min:25048 - global_seqlen/max:29697 - global_seqlen/minmax_diff:4649 - global_seqlen/balanced_min:27059 - global_seqlen/balanced_max:27060 - global_seqlen/mean:27059.25 - actor/entropy:0.6857752799987793 - actor/kl_loss:5.621247363090515 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11681154444813728 - actor/pg_clipfrac:0.09070545607246458 - actor/ppo_kl:0.7473200693726539 - actor/pg_clipfrac_lower:0.002302152174524963 - actor/grad_norm:95.40119361877441 - perf/mfu/actor:0.07965287339377171 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.95126724243164 - actor/lr:1e-06 - training/global_step:228 - training/epoch:6 - critic/score/mean:1.126562476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.126562476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.05647817254066467 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.05647817254066467 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:267.73126220703125 - response_length/max:907.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.009560406208038e-05 - timing_s/generate_sequences:20.825056076049805 - timing_s/reshard:0.6507821679115295 - timing_s/gen:30.357576683163643 - timing_s/reward:0.0683285053819418 - timing_s/old_log_prob:1.1564433351159096 - timing_s/ref:1.3374166917055845 - timing_s/adv:0.007489586248993874 - timing_s/update_actor:7.232010085135698 - timing_s/step:40.17224959470332 - timing_s/stop_profile:4.4930726289749146e-05 - timing_per_token_ms/adv:3.4598086832570536e-05 - timing_per_token_ms/gen:0.3543382669557117 - timing_per_token_ms/ref:0.006178186256573928 - timing_per_token_ms/update_actor:0.033408215698585965 - perf/total_num_tokens:216474 - perf/time_per_step:40.17224959470332 - perf/throughput:673.5806501502904
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.040624976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.040624976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.1015399694442749, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.1015399694442749, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 275.375, 'response_length/max': 740.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.040625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  44%|████▎     | 229/525 [3:11:57<2:57:50, 36.05s/it]
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 02:52:19,522:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/model_world_size_8_rank_5.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:52:23,294:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:52:23,296:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:52:23,911:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  44%|████▍     | 230/525 [3:12:38<3:04:11, 37.46s/it]
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 02:52:19,914:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/model_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:229 - global_seqlen/min:26270 - global_seqlen/max:28699 - global_seqlen/minmax_diff:2429 - global_seqlen/balanced_min:27378 - global_seqlen/balanced_max:27379 - global_seqlen/mean:27378.125 - actor/entropy:0.8724784255027771 - actor/kl_loss:5.294583022594452 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08034528438001871 - actor/pg_clipfrac:0.12783286049962045 - actor/ppo_kl:-0.8952408946119249 - actor/pg_clipfrac_lower:0.02398837320506573 - actor/grad_norm:155.1031093597412 - perf/mfu/actor:0.0826967384214337 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.0234489440918 - actor/lr:1e-06 - training/global_step:229 - training/epoch:6 - critic/score/mean:1.040624976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.040624976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.1015399694442749 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.1015399694442749 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:275.375 - response_length/max:740.0 - response_length/min:5.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.040625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.957220077514648e-05 - timing_s/generate_sequences:21.605831146240234 - timing_s/reshard:0.7349792122840881 - timing_s/gen:25.987047323957086 - timing_s/reward:0.06826102547347546 - timing_s/old_log_prob:1.0672393832355738 - timing_s/ref:1.3571648877114058 - timing_s/adv:0.0075058769434690475 - timing_s/update_actor:7.051410665735602 - timing_s/step:35.551800049841404 - timing_s/stop_profile:4.5532360672950745e-05 - timing_per_token_ms/adv:3.426949865754616e-05 - timing_per_token_ms/gen:0.29490521248249074 - timing_per_token_ms/ref:0.006196392593135057 - timing_per_token_ms/update_actor:0.03219454704136789 - perf/total_num_tokens:219025 - perf/time_per_step:35.551800049841404 - perf/throughput:770.0911054185042
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.15625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.15625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.07525797933340073, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.07525797933340073, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 293.1656188964844, 'response_length/max': 656.0, 'response_length/min': 17.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.15625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:230 - global_seqlen/min:26251 - global_seqlen/max:30993 - global_seqlen/minmax_diff:4742 - global_seqlen/balanced_min:28107 - global_seqlen/balanced_max:28108 - global_seqlen/mean:28107.25 - actor/entropy:0.8027127385139465 - actor/kl_loss:4.326878023147583 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07368975076824427 - actor/pg_clipfrac:0.07339048343710601 - actor/ppo_kl:0.5170179091859609 - actor/pg_clipfrac_lower:0.0008415924501605331 - actor/grad_norm:128.83228969573975 - perf/mfu/actor:0.08484474468254934 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.95581436157227 - actor/lr:1e-06 - training/global_step:230 - training/epoch:6 - critic/score/mean:1.15625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.15625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.07525797933340073 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.07525797933340073 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:293.1656188964844 - response_length/max:656.0 - response_length/min:17.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.15625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.725134491920471e-05 - timing_s/generate_sequences:20.790693283081055 - timing_s/reshard:0.7794775366783142 - timing_s/gen:23.298908000811934 - timing_s/reward:0.07044327072799206 - timing_s/old_log_prob:1.1182919573038816 - timing_s/ref:1.3484033774584532 - timing_s/adv:0.00758105143904686 - timing_s/update_actor:7.058650240302086 - timing_s/save_checkpoint:7.832966156303883 - timing_s/step:40.74828777834773 - timing_s/stop_profile:5.0416216254234314e-05 - timing_per_token_ms/adv:3.3714839761302064e-05 - timing_per_token_ms/gen:0.24835479092249405 - timing_per_token_ms/ref:0.005996688476542765 - timing_per_token_ms/update_actor:0.03139159042730117 - perf/total_num_tokens:224858 - perf/time_per_step:40.74828777834773 - perf/throughput:689.7774491259789
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2062499523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2062499523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.08364392817020416, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.08364392817020416, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 287.65625, 'response_length/max': 778.0, 'response_length/min': 59.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.20625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  44%|████▍     | 231/525 [3:13:15<3:02:05, 37.16s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:52:24,743:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:52:24,746:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_230/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  44%|████▍     | 232/525 [3:13:49<2:57:57, 36.44s/it]
[36m(TaskRunner pid=2949575)[0m step:231 - global_seqlen/min:26722 - global_seqlen/max:28989 - global_seqlen/minmax_diff:2267 - global_seqlen/balanced_min:27882 - global_seqlen/balanced_max:27883 - global_seqlen/mean:27882.5 - actor/entropy:0.7826326489448547 - actor/kl_loss:4.075742107629776 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0971329927444458 - actor/pg_clipfrac:0.12023614589124917 - actor/ppo_kl:-1.4101148039102553 - actor/pg_clipfrac_lower:0.0256173855625093 - actor/grad_norm:174.06770849227905 - perf/mfu/actor:0.08462883883394338 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94531631469727 - actor/lr:1e-06 - training/global_step:231 - training/epoch:6 - critic/score/mean:1.2062499523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2062499523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.08364392817020416 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.08364392817020416 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:287.65625 - response_length/max:778.0 - response_length/min:59.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.20625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.709224104881287e-05 - timing_s/generate_sequences:21.142887115478516 - timing_s/reshard:0.8508845567703247 - timing_s/gen:26.694900391623378 - timing_s/reward:0.06988019496202469 - timing_s/old_log_prob:1.112031925469637 - timing_s/ref:1.342330876737833 - timing_s/adv:0.0074553582817316055 - timing_s/update_actor:7.018230939283967 - timing_s/step:36.25783207640052 - timing_s/stop_profile:4.524737596511841e-05 - timing_per_token_ms/adv:3.3423107153822316e-05 - timing_per_token_ms/gen:0.29000434971888517 - timing_per_token_ms/ref:0.006017801832412055 - timing_per_token_ms/update_actor:0.03146342212536522 - perf/total_num_tokens:223060 - perf/time_per_step:36.25783207640052 - perf/throughput:769.0062643913051
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.251562476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.251562476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.040761977434158325, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.040761977434158325, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 291.43438720703125, 'response_length/max': 753.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:232 - global_seqlen/min:26592 - global_seqlen/max:32787 - global_seqlen/minmax_diff:6195 - global_seqlen/balanced_min:28042 - global_seqlen/balanced_max:28043 - global_seqlen/mean:28042.375 - actor/entropy:0.6429846882820129 - actor/kl_loss:3.907614368200302 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12758909836411475 - actor/pg_clipfrac:0.1061128132045269 - actor/ppo_kl:0.16896956577547825 - actor/pg_clipfrac_lower:0.011334913386963307 - actor/grad_norm:97.22337627410889 - perf/mfu/actor:0.08646201155725924 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94369125366211 - actor/lr:1e-06 - training/global_step:232 - training/epoch:6 - critic/score/mean:1.251562476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.251562476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.040761977434158325 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.040761977434158325 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:291.43438720703125 - response_length/max:753.0 - response_length/min:85.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.684528827667236e-05 - timing_s/generate_sequences:21.26643180847168 - timing_s/reshard:0.6567901372909546 - timing_s/gen:25.25204831175506 - timing_s/reward:0.06979653052985668 - timing_s/old_log_prob:1.1518848203122616 - timing_s/ref:1.3496210351586342 - timing_s/adv:0.007566941902041435 - timing_s/update_actor:6.909635020419955 - timing_s/step:34.75361976772547 - timing_s/stop_profile:4.558078944683075e-05 - timing_per_token_ms/adv:3.372994397782568e-05 - timing_per_token_ms/gen:0.27077331208521493 - timing_per_token_ms/ref:0.006015989351644761 - timing_per_token_ms/update_actor:0.030799972454276587 - perf/total_num_tokens:224339 - perf/time_per_step:34.75361976772547 - perf/throughput:806.8907695779656
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.140625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.140625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.054799217730760574, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.054799217730760574, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 296.6000061035156, 'response_length/max': 765.0, 'response_length/min': 7.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  44%|████▍     | 233/525 [3:14:25<2:56:18, 36.23s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  45%|████▍     | 234/525 [3:14:58<2:51:28, 35.36s/it]
[36m(TaskRunner pid=2949575)[0m step:233 - global_seqlen/min:26948 - global_seqlen/max:31140 - global_seqlen/minmax_diff:4192 - global_seqlen/balanced_min:28231 - global_seqlen/balanced_max:28232 - global_seqlen/mean:28231.5 - actor/entropy:0.6979386210441589 - actor/kl_loss:3.8782070159912108 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08606538996100425 - actor/pg_clipfrac:0.10187513227574527 - actor/ppo_kl:0.373763445019722 - actor/pg_clipfrac_lower:0.0015596980811096728 - actor/grad_norm:93.65311336517334 - perf/mfu/actor:0.08655633002873481 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.89482498168945 - actor/lr:1e-06 - training/global_step:233 - training/epoch:6 - critic/score/mean:1.140625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.140625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.054799217730760574 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.054799217730760574 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:296.6000061035156 - response_length/max:765.0 - response_length/min:7.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.877498865127563e-05 - timing_s/generate_sequences:20.834819793701172 - timing_s/reshard:0.6644677519798279 - timing_s/gen:26.16044587083161 - timing_s/reward:0.0704023651778698 - timing_s/old_log_prob:1.1600066013634205 - timing_s/ref:1.3398511577397585 - timing_s/adv:0.007555458694696426 - timing_s/update_actor:6.951291814446449 - timing_s/step:35.70267022587359 - timing_s/stop_profile:4.5221298933029175e-05 - timing_per_token_ms/adv:3.345314052873752e-05 - timing_per_token_ms/gen:0.27562843339969245 - timing_per_token_ms/ref:0.005932429899844847 - timing_per_token_ms/update_actor:0.030778083941901995 - perf/total_num_tokens:225852 - perf/time_per_step:35.70267022587359 - perf/throughput:790.739175008281
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.271875023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.271875023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0525844469666481, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.0525844469666481, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 284.88751220703125, 'response_length/max': 665.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.271875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:234 - global_seqlen/min:25119 - global_seqlen/max:29885 - global_seqlen/minmax_diff:4766 - global_seqlen/balanced_min:27776 - global_seqlen/balanced_max:27777 - global_seqlen/mean:27776.125 - actor/entropy:0.7019906640052795 - actor/kl_loss:4.360551118850708 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09507978968322277 - actor/pg_clipfrac:0.09786708804313093 - actor/ppo_kl:-0.7993642432615161 - actor/pg_clipfrac_lower:0.022375340585131197 - actor/grad_norm:196.3290843963623 - perf/mfu/actor:0.08560426695180386 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.9237060546875 - actor/lr:1e-06 - training/global_step:234 - training/epoch:6 - critic/score/mean:1.271875023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.271875023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0525844469666481 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.0525844469666481 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:284.88751220703125 - response_length/max:665.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.271875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.576681673526764e-05 - timing_s/generate_sequences:20.179676055908203 - timing_s/reshard:0.6516169309616089 - timing_s/gen:23.8989468626678 - timing_s/reward:0.07016644813120365 - timing_s/old_log_prob:1.0556946992874146 - timing_s/ref:1.35775625705719 - timing_s/adv:0.007520996034145355 - timing_s/update_actor:6.909656262025237 - timing_s/step:33.3128838930279 - timing_s/stop_profile:4.340335726737976e-05 - timing_per_token_ms/adv:3.3846496020167296e-05 - timing_per_token_ms/gen:0.26215333753090914 - timing_per_token_ms/ref:0.006110266717627054 - timing_per_token_ms/update_actor:0.031095303349662873 - perf/total_num_tokens:222209 - perf/time_per_step:33.3128838930279 - perf/throughput:833.7952693976549
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0578124523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0578124523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.05319508537650108, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.05319508537650108, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 312.96875, 'response_length/max': 719.0, 'response_length/min': 8.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  45%|████▍     | 235/525 [3:15:35<2:52:00, 35.59s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  45%|████▍     | 236/525 [3:16:12<2:53:37, 36.05s/it]
[36m(TaskRunner pid=2949575)[0m step:235 - global_seqlen/min:26837 - global_seqlen/max:31584 - global_seqlen/minmax_diff:4747 - global_seqlen/balanced_min:28895 - global_seqlen/balanced_max:28895 - global_seqlen/mean:28895.0 - actor/entropy:0.6691631078720093 - actor/kl_loss:4.174746108055115 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.09892000202089549 - actor/pg_clipfrac:0.09586037714034319 - actor/ppo_kl:0.5598107684170828 - actor/pg_clipfrac_lower:0.0023354186152573673 - actor/grad_norm:90.4109148979187 - perf/mfu/actor:0.08761769597220534 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.17173767089844 - actor/lr:1e-06 - training/global_step:235 - training/epoch:6 - critic/score/mean:1.0578124523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0578124523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.05319508537650108 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.05319508537650108 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:312.96875 - response_length/max:719.0 - response_length/min:8.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.634532034397125e-05 - timing_s/generate_sequences:22.995677947998047 - timing_s/reshard:0.6409212350845337 - timing_s/gen:25.79452866129577 - timing_s/reward:0.07123243995010853 - timing_s/old_log_prob:1.1607267688959837 - timing_s/ref:1.349668538197875 - timing_s/adv:0.008662685751914978 - timing_s/update_actor:7.047099383547902 - timing_s/step:35.44510198198259 - timing_s/stop_profile:4.624202847480774e-05 - timing_per_token_ms/adv:3.7474847516503626e-05 - timing_per_token_ms/gen:0.2575589481906717 - timing_per_token_ms/ref:0.005838676839409392 - timing_per_token_ms/update_actor:0.030485808027114994 - perf/total_num_tokens:231160 - perf/time_per_step:35.44510198198259 - perf/throughput:815.2043127055431
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.271875023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.271875023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04249958321452141, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04249958321452141, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 287.7281188964844, 'response_length/max': 819.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.271875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:236 - global_seqlen/min:26097 - global_seqlen/max:30095 - global_seqlen/minmax_diff:3998 - global_seqlen/balanced_min:27881 - global_seqlen/balanced_max:27881 - global_seqlen/mean:27881.0 - actor/entropy:0.6160756945610046 - actor/kl_loss:4.16234981417656 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.023057068604975937 - actor/pg_clipfrac:0.07441405197605491 - actor/ppo_kl:0.27373738698661326 - actor/pg_clipfrac_lower:0.0007750137883704156 - actor/grad_norm:176.53809928894043 - perf/mfu/actor:0.08560254395942159 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.14840316772461 - actor/lr:1e-06 - training/global_step:236 - training/epoch:6 - critic/score/mean:1.271875023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.271875023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04249958321452141 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04249958321452141 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:287.7281188964844 - response_length/max:819.0 - response_length/min:74.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.271875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.975473999977112e-05 - timing_s/generate_sequences:22.84453010559082 - timing_s/reshard:0.6437058448791504 - timing_s/gen:27.65780415199697 - timing_s/reward:0.06982591189444065 - timing_s/old_log_prob:1.0655640661716461 - timing_s/ref:1.3412071261554956 - timing_s/adv:0.007449517026543617 - timing_s/update_actor:6.939601412042975 - timing_s/step:37.10110980272293 - timing_s/stop_profile:4.258938133716583e-05 - timing_per_token_ms/adv:3.3398716987122134e-05 - timing_per_token_ms/gen:0.3003899531023967 - timing_per_token_ms/ref:0.006013087434792043 - timing_per_token_ms/update_actor:0.031112591962460884 - perf/total_num_tokens:223048 - perf/time_per_step:37.10110980272293 - perf/throughput:751.4869541167675
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.3156249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.3156249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.06768296658992767, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.06768296658992767, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 296.5218811035156, 'response_length/max': 771.0, 'response_length/min': 2.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.315625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  45%|████▌     | 237/525 [3:16:48<2:53:05, 36.06s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  45%|████▌     | 238/525 [3:17:29<2:59:21, 37.50s/it]
[36m(TaskRunner pid=2949575)[0m step:237 - global_seqlen/min:26452 - global_seqlen/max:30585 - global_seqlen/minmax_diff:4133 - global_seqlen/balanced_min:28250 - global_seqlen/balanced_max:28251 - global_seqlen/mean:28250.25 - actor/entropy:0.5595155358314514 - actor/kl_loss:3.442332810163498 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05828291326761246 - actor/pg_clipfrac:0.05811097449623048 - actor/ppo_kl:-0.2153007909655571 - actor/pg_clipfrac_lower:0.006092289299704135 - actor/grad_norm:104.76198482513428 - perf/mfu/actor:0.08369162046639608 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.10114669799805 - actor/lr:1e-06 - training/global_step:237 - training/epoch:6 - critic/score/mean:1.3156249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.3156249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.06768296658992767 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.06768296658992767 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:296.5218811035156 - response_length/max:771.0 - response_length/min:2.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.315625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.177012205123901e-05 - timing_s/generate_sequences:22.329673767089844 - timing_s/reshard:0.6490035653114319 - timing_s/gen:26.370840499177575 - timing_s/reward:0.07052376866340637 - timing_s/old_log_prob:1.072190085425973 - timing_s/ref:1.3441618457436562 - timing_s/adv:0.007477184757590294 - timing_s/update_actor:7.192676683887839 - timing_s/step:36.07782358303666 - timing_s/stop_profile:4.3412670493125916e-05 - timing_per_token_ms/adv:3.308459552389047e-05 - timing_per_token_ms/gen:0.27791837131722547 - timing_per_token_ms/ref:0.005947566153147565 - timing_per_token_ms/update_actor:0.03182572138250033 - perf/total_num_tokens:226002 - perf/time_per_step:36.07782358303666 - perf/throughput:783.0364249933001
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.078125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.078125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04547686502337456, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04547686502337456, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 319.13751220703125, 'response_length/max': 922.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.078125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:238 - global_seqlen/min:25757 - global_seqlen/max:32773 - global_seqlen/minmax_diff:7016 - global_seqlen/balanced_min:29133 - global_seqlen/balanced_max:29133 - global_seqlen/mean:29133.0 - actor/entropy:0.650704562664032 - actor/kl_loss:5.1036352753639225 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06219914350658655 - actor/pg_clipfrac:0.0919762060046196 - actor/ppo_kl:0.7609916001558303 - actor/pg_clipfrac_lower:0.0009390710270963609 - actor/grad_norm:136.67445278167725 - perf/mfu/actor:0.08875716425586766 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.10304641723633 - actor/lr:1e-06 - training/global_step:238 - training/epoch:6 - critic/score/mean:1.078125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.078125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04547686502337456 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04547686502337456 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:319.13751220703125 - response_length/max:922.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.078125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.529929280281067e-05 - timing_s/generate_sequences:23.594812393188477 - timing_s/reshard:0.728060245513916 - timing_s/gen:31.29859358817339 - timing_s/reward:0.072315389290452 - timing_s/old_log_prob:1.0942601412534714 - timing_s/ref:1.3437164220958948 - timing_s/adv:0.007588563486933708 - timing_s/update_actor:7.0035658441483974 - timing_s/step:40.83314744196832 - timing_s/stop_profile:4.639290273189545e-05 - timing_per_token_ms/adv:3.2559998485110136e-05 - timing_per_token_ms/gen:0.3064763776210625 - timing_per_token_ms/ref:0.005765439630727589 - timing_per_token_ms/update_actor:0.030049968438490705 - perf/total_num_tokens:233064 - perf/time_per_step:40.83314744196832 - perf/throughput:713.464472495135
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.279687523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.279687523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04140983149409294, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04140983149409294, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 340.53125, 'response_length/max': 1086.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  46%|████▌     | 239/525 [3:18:14<3:10:02, 39.87s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 02:58:39,038:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 02:58:42,638:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 02:58:42,641:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 02:58:43,855:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  46%|████▌     | 240/525 [3:18:58<3:14:45, 41.00s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:58:39,481:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m step:239 - global_seqlen/min:28036 - global_seqlen/max:33914 - global_seqlen/minmax_diff:5878 - global_seqlen/balanced_min:29988 - global_seqlen/balanced_max:29989 - global_seqlen/mean:29988.75 - actor/entropy:0.5347176790237427 - actor/kl_loss:3.915964651107788 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07270655725151301 - actor/pg_clipfrac:0.1137642776593566 - actor/ppo_kl:0.4682222127914429 - actor/pg_clipfrac_lower:0.004176646750420332 - actor/grad_norm:104.81258487701416 - perf/mfu/actor:0.09125810991700756 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.12577819824219 - actor/lr:1e-06 - training/global_step:239 - training/epoch:6 - critic/score/mean:1.279687523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.279687523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04140983149409294 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04140983149409294 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:340.53125 - response_length/max:1086.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.646080434322357e-05 - timing_s/generate_sequences:26.0008544921875 - timing_s/reshard:0.7431463599205017 - timing_s/gen:35.612345181405544 - timing_s/reward:0.07486854307353497 - timing_s/old_log_prob:1.1168405562639236 - timing_s/ref:1.3517751973122358 - timing_s/adv:0.007471945136785507 - timing_s/update_actor:7.016194703057408 - timing_s/step:45.19274624250829 - timing_s/stop_profile:4.434213042259216e-05 - timing_per_token_ms/adv:3.1144784030617764e-05 - timing_per_token_ms/gen:0.3268087104836702 - timing_per_token_ms/ref:0.005634509596566362 - timing_per_token_ms/update_actor:0.029245111512889867 - perf/total_num_tokens:239910 - perf/time_per_step:45.19274624250829 - perf/throughput:663.5744116783189
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.165624976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.165624976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04209713265299797, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04209713265299797, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 307.34063720703125, 'response_length/max': 798.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.165625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:240 - global_seqlen/min:26585 - global_seqlen/max:32172 - global_seqlen/minmax_diff:5587 - global_seqlen/balanced_min:28678 - global_seqlen/balanced_max:28679 - global_seqlen/mean:28678.625 - actor/entropy:0.6489521861076355 - actor/kl_loss:3.9193294525146483 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.07596144443377853 - actor/pg_clipfrac:0.06411406976403669 - actor/ppo_kl:0.20542886569164692 - actor/pg_clipfrac_lower:0.0015491512138396501 - actor/grad_norm:187.1094913482666 - perf/mfu/actor:0.08802545166836727 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.09415435791016 - actor/lr:1e-06 - training/global_step:240 - training/epoch:6 - critic/score/mean:1.165624976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.165624976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04209713265299797 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04209713265299797 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:307.34063720703125 - response_length/max:798.0 - response_length/min:84.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.165625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.924437522888184e-05 - timing_s/generate_sequences:23.19881820678711 - timing_s/reshard:0.6526989936828613 - timing_s/gen:26.27892261557281 - timing_s/reward:0.0714301522821188 - timing_s/old_log_prob:1.1629262324422598 - timing_s/ref:1.339916555210948 - timing_s/adv:0.007553143426775932 - timing_s/update_actor:6.946548603475094 - timing_s/save_checkpoint:7.813150513917208 - timing_s/step:43.63375720381737 - timing_s/stop_profile:5.110353231430054e-05 - timing_per_token_ms/adv:3.2921485194879166e-05 - timing_per_token_ms/gen:0.2672007098757772 - timing_per_token_ms/ref:0.005840223141847578 - timing_per_token_ms/update_actor:0.03027755254773849 - perf/total_num_tokens:229429 - perf/time_per_step:43.63375720381737 - perf/throughput:657.2577480788431
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1593749523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1593749523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.03740020841360092, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': 0.03740020841360092, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 323.3999938964844, 'response_length/max': 1060.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.159375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  46%|████▌     | 241/525 [3:19:42<3:18:46, 41.99s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:58:44,253:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 02:58:44,255:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_240/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  46%|████▌     | 242/525 [3:20:22<3:15:45, 41.50s/it]
[36m(TaskRunner pid=2949575)[0m step:241 - global_seqlen/min:27406 - global_seqlen/max:30369 - global_seqlen/minmax_diff:2963 - global_seqlen/balanced_min:29338 - global_seqlen/balanced_max:29339 - global_seqlen/mean:29338.5 - actor/entropy:0.5976824164390564 - actor/kl_loss:4.672832882404327 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03963134884834289 - actor/pg_clipfrac:0.11241368856281042 - actor/ppo_kl:-0.25946988370269536 - actor/pg_clipfrac_lower:0.015723985387012362 - actor/grad_norm:93.54145431518555 - perf/mfu/actor:0.08772621004819893 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.90110397338867 - actor/lr:1e-06 - training/global_step:241 - training/epoch:6 - critic/score/mean:1.1593749523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1593749523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.03740020841360092 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:0.03740020841360092 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:323.3999938964844 - response_length/max:1060.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.159375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.480010390281677e-05 - timing_s/generate_sequences:27.48255157470703 - timing_s/reshard:0.6523815393447876 - timing_s/gen:34.63648699596524 - timing_s/reward:0.0723728109151125 - timing_s/old_log_prob:1.0734007973223925 - timing_s/ref:1.3464476987719536 - timing_s/adv:0.0076374392956495285 - timing_s/update_actor:7.137186530977488 - timing_s/step:44.286647111177444 - timing_s/stop_profile:4.421547055244446e-05 - timing_per_token_ms/adv:3.254017458139275e-05 - timing_per_token_ms/gen:0.3346908530067761 - timing_per_token_ms/ref:0.005736692821599407 - timing_per_token_ms/update_actor:0.030408791055172756 - perf/total_num_tokens:234708 - perf/time_per_step:44.286647111177444 - perf/throughput:662.4683039641377
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2265625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2265625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.04048239439725876, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.04048239439725876, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 321.375, 'response_length/max': 910.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:242 - global_seqlen/min:26883 - global_seqlen/max:31868 - global_seqlen/minmax_diff:4985 - global_seqlen/balanced_min:29231 - global_seqlen/balanced_max:29232 - global_seqlen/mean:29231.25 - actor/entropy:0.6566202044487 - actor/kl_loss:5.1564171552658085 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07418512552976608 - actor/pg_clipfrac:0.11893486892804503 - actor/ppo_kl:-0.35359572421293706 - actor/pg_clipfrac_lower:0.012835539132356643 - actor/grad_norm:290.3698844909668 - perf/mfu/actor:0.08565042533707241 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.94722747802734 - actor/lr:1e-06 - training/global_step:242 - training/epoch:6 - critic/score/mean:1.2265625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2265625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.04048239439725876 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.04048239439725876 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:321.375 - response_length/max:910.0 - response_length/min:87.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.118152618408203e-05 - timing_s/generate_sequences:24.43636703491211 - timing_s/reshard:0.7314159274101257 - timing_s/gen:30.533161338418722 - timing_s/reward:0.07262138649821281 - timing_s/old_log_prob:1.086925145238638 - timing_s/ref:1.357643712311983 - timing_s/adv:0.007488138973712921 - timing_s/update_actor:7.281119247898459 - timing_s/step:40.35206098295748 - timing_s/stop_profile:4.448741674423218e-05 - timing_per_token_ms/adv:3.20211202638996e-05 - timing_per_token_ms/gen:0.29689966295623027 - timing_per_token_ms/ref:0.005805617756305252 - timing_per_token_ms/update_actor:0.031135853101981865 - perf/total_num_tokens:233850 - perf/time_per_step:40.35206098295748 - perf/throughput:724.4053782617372
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2312500476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2312500476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.018169324845075607, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.018169324845075607, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 303.5843811035156, 'response_length/max': 1342.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.23125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  46%|████▋     | 243/525 [3:21:13<3:28:37, 44.39s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  46%|████▋     | 244/525 [3:22:18<3:56:12, 50.44s/it]
[36m(TaskRunner pid=2949575)[0m step:243 - global_seqlen/min:26387 - global_seqlen/max:31986 - global_seqlen/minmax_diff:5599 - global_seqlen/balanced_min:28493 - global_seqlen/balanced_max:28630 - global_seqlen/mean:28510.875 - actor/entropy:0.6430751085281372 - actor/kl_loss:5.089112716913223 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04426221789326519 - actor/pg_clipfrac:0.08290864310692996 - actor/ppo_kl:0.262831064267084 - actor/pg_clipfrac_lower:0.0032200921268668026 - actor/grad_norm:131.03937530517578 - perf/mfu/actor:0.0872373003531651 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.14951705932617 - actor/lr:1e-06 - training/global_step:243 - training/epoch:6 - critic/score/mean:1.2312500476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2312500476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.018169324845075607 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.018169324845075607 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:303.5843811035156 - response_length/max:1342.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.23125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.282119572162628e-05 - timing_s/generate_sequences:27.61707878112793 - timing_s/reshard:0.7462656497955322 - timing_s/gen:41.30665252543986 - timing_s/reward:0.07108958810567856 - timing_s/old_log_prob:1.0932066980749369 - timing_s/ref:1.3478715624660254 - timing_s/adv:0.00745767168700695 - timing_s/update_actor:6.972630616277456 - timing_s/step:50.81194551475346 - timing_s/stop_profile:4.517287015914917e-05 - timing_per_token_ms/adv:3.269661000849216e-05 - timing_per_token_ms/gen:0.4251974072842173 - timing_per_token_ms/ref:0.00590946245277471 - timing_per_token_ms/update_actor:0.030570048342419588 - perf/total_num_tokens:228087 - perf/time_per_step:50.81194551475346 - perf/throughput:561.1057539948308
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.235937476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.235937476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0893189013004303, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.0893189013004303, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 302.45001220703125, 'response_length/max': 1855.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:244 - global_seqlen/min:25358 - global_seqlen/max:33323 - global_seqlen/minmax_diff:7965 - global_seqlen/balanced_min:28320 - global_seqlen/balanced_max:28900 - global_seqlen/mean:28491.75 - actor/entropy:0.6558459997177124 - actor/kl_loss:4.831484723091125 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05019909245893359 - actor/pg_clipfrac:0.09001050889492035 - actor/ppo_kl:0.5984713464509696 - actor/pg_clipfrac_lower:0.0012282416340894998 - actor/grad_norm:175.21904182434082 - perf/mfu/actor:0.08631144939598355 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.08304977416992 - actor/lr:1e-06 - training/global_step:244 - training/epoch:6 - critic/score/mean:1.235937476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.235937476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0893189013004303 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.0893189013004303 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:302.45001220703125 - response_length/max:1855.0 - response_length/min:3.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.07046890258789e-05 - timing_s/generate_sequences:39.60683822631836 - timing_s/reshard:0.823013424873352 - timing_s/gen:54.86260109394789 - timing_s/reward:0.0714814867824316 - timing_s/old_log_prob:1.1755672451108694 - timing_s/ref:1.3539437353610992 - timing_s/adv:0.007670026272535324 - timing_s/update_actor:7.0467235166579485 - timing_s/step:64.53105536475778 - timing_s/stop_profile:4.2768195271492004e-05 - timing_per_token_ms/adv:3.3650206956993357e-05 - timing_per_token_ms/gen:0.5668561032190019 - timing_per_token_ms/ref:0.005940069210214795 - timing_per_token_ms/update_actor:0.030915631352312286 - perf/total_num_tokens:227934 - perf/time_per_step:64.53105536475778 - perf/throughput:441.5199757535679
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.201562523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.201562523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.060451894998550415, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.060451894998550415, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 337.171875, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2015625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  47%|████▋     | 245/525 [3:23:31<4:27:33, 57.34s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  47%|████▋     | 246/525 [3:24:40<4:42:06, 60.67s/it]
[36m(TaskRunner pid=2949575)[0m step:245 - global_seqlen/min:27890 - global_seqlen/max:31847 - global_seqlen/minmax_diff:3957 - global_seqlen/balanced_min:29516 - global_seqlen/balanced_max:30286 - global_seqlen/mean:29876.25 - actor/entropy:0.6326369643211365 - actor/kl_loss:5.48603492975235 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1523878164589405 - actor/pg_clipfrac:0.09403430130332709 - actor/ppo_kl:-0.36194846709258854 - actor/pg_clipfrac_lower:0.014024437637999654 - actor/grad_norm:121.14422130584717 - perf/mfu/actor:0.08945420716474074 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.93909072875977 - actor/lr:1e-06 - training/global_step:245 - training/epoch:6 - critic/score/mean:1.201562523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.201562523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.060451894998550415 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.060451894998550415 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:337.171875 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2015625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.78399407863617e-05 - timing_s/generate_sequences:45.79128646850586 - timing_s/reshard:0.6311662197113037 - timing_s/gen:63.578523179516196 - timing_s/reward:0.07425393909215927 - timing_s/old_log_prob:1.2462630681693554 - timing_s/ref:1.3617141023278236 - timing_s/adv:0.0076273102313280106 - timing_s/update_actor:7.1416514571756124 - timing_s/step:73.42306840792298 - timing_s/stop_profile:4.354305565357208e-05 - timing_per_token_ms/adv:3.191209669607134e-05 - timing_per_token_ms/gen:0.58926292394936 - timing_per_token_ms/ref:0.005697310164126286 - timing_per_token_ms/update_actor:0.02988013663518519 - perf/total_num_tokens:239010 - perf/time_per_step:73.42306840792298 - perf/throughput:406.90549506885077
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.079687476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.079687476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.002517182379961014, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': 0.002517182379961014, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 349.76251220703125, 'response_length/max': 1819.0, 'response_length/min': 10.0, 'response_length/clip_ratio': 0.0, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:246 - global_seqlen/min:28440 - global_seqlen/max:32620 - global_seqlen/minmax_diff:4180 - global_seqlen/balanced_min:30268 - global_seqlen/balanced_max:30710 - global_seqlen/mean:30358.0 - actor/entropy:0.6091378331184387 - actor/kl_loss:5.375822484493256 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07663433011621237 - actor/pg_clipfrac:0.11715048896148801 - actor/ppo_kl:0.04778584942687303 - actor/pg_clipfrac_lower:0.012705558724701405 - actor/grad_norm:206.7196969985962 - perf/mfu/actor:0.09206108237083846 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.8062858581543 - actor/lr:1e-06 - training/global_step:246 - training/epoch:7 - critic/score/mean:1.079687476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.079687476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.002517182379961014 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:0.002517182379961014 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:349.76251220703125 - response_length/max:1819.0 - response_length/min:10.0 - response_length/clip_ratio:0.0 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00030820630490779877 - timing_s/generate_sequences:35.943965911865234 - timing_s/reshard:0.8291997313499451 - timing_s/gen:56.1852497626096 - timing_s/reward:0.07687043398618698 - timing_s/old_log_prob:1.1499507389962673 - timing_s/ref:1.3715598657727242 - timing_s/adv:0.009050531312823296 - timing_s/update_actor:7.052701108157635 - timing_s/step:65.86734334006906 - timing_s/stop_profile:4.737265408039093e-05 - timing_per_token_ms/adv:3.726584142904381e-05 - timing_per_token_ms/gen:0.5019946549677424 - timing_per_token_ms/ref:0.005647439990170318 - timing_per_token_ms/update_actor:0.029039714029900004 - perf/total_num_tokens:242864 - perf/time_per_step:65.86734334006906 - perf/throughput:460.89607475533825
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1515624523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1515624523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1702248603105545, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1702248603105545, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 367.58123779296875, 'response_length/max': 2048.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.02500000037252903, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  47%|████▋     | 247/525 [3:25:55<5:01:05, 64.98s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  47%|████▋     | 248/525 [3:27:08<5:11:49, 67.54s/it]
[36m(TaskRunner pid=2949575)[0m step:247 - global_seqlen/min:28654 - global_seqlen/max:33637 - global_seqlen/minmax_diff:4983 - global_seqlen/balanced_min:30854 - global_seqlen/balanced_max:31427 - global_seqlen/mean:31092.625 - actor/entropy:0.663661777973175 - actor/kl_loss:5.289723110198975 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13899016194045544 - actor/pg_clipfrac:0.11731734827626497 - actor/ppo_kl:-0.5455148088745773 - actor/pg_clipfrac_lower:0.01844295244954992 - actor/grad_norm:170.01321935653687 - perf/mfu/actor:0.08842213609943614 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.79324340820312 - actor/lr:1e-06 - training/global_step:247 - training/epoch:7 - critic/score/mean:1.1515624523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1515624523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1702248603105545 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1702248603105545 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:367.58123779296875 - response_length/max:2048.0 - response_length/min:101.0 - response_length/clip_ratio:0.02500000037252903 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.362904191017151e-05 - timing_s/generate_sequences:62.336097717285156 - timing_s/reshard:0.643726646900177 - timing_s/gen:64.69476415216923 - timing_s/reward:0.07891490124166012 - timing_s/old_log_prob:1.3216028902679682 - timing_s/ref:1.3582226242870092 - timing_s/adv:0.00745186023414135 - timing_s/update_actor:7.554000977426767 - timing_s/step:75.03798036649823 - timing_s/stop_profile:4.723668098449707e-05 - timing_per_token_ms/adv:2.995831099071464e-05 - timing_per_token_ms/gen:0.5500039459997724 - timing_per_token_ms/ref:0.005460389016233791 - timing_per_token_ms/update_actor:0.030368941901121115 - perf/total_num_tokens:248741 - perf/time_per_step:75.03798036649823 - perf/throughput:414.35850016402816
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.15625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.15625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07218341529369354, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07218341529369354, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 340.04376220703125, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.00937500037252903, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.15625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:248 - global_seqlen/min:27008 - global_seqlen/max:33903 - global_seqlen/minmax_diff:6895 - global_seqlen/balanced_min:29947 - global_seqlen/balanced_max:30069 - global_seqlen/mean:29999.875 - actor/entropy:0.6106259226799011 - actor/kl_loss:5.9028814196586605 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12967412881553173 - actor/pg_clipfrac:0.15641303043812513 - actor/ppo_kl:-0.6025349088944495 - actor/pg_clipfrac_lower:0.02111796325771138 - actor/grad_norm:221.76748275756836 - perf/mfu/actor:0.0891034635124272 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.8287353515625 - actor/lr:1e-06 - training/global_step:248 - training/epoch:7 - critic/score/mean:1.15625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.15625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07218341529369354 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07218341529369354 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:340.04376220703125 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.00937500037252903 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.15625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.578039705753326e-05 - timing_s/generate_sequences:58.33506774902344 - timing_s/reshard:0.884272575378418 - timing_s/gen:63.63981983996928 - timing_s/reward:0.07646389305591583 - timing_s/old_log_prob:1.1950582787394524 - timing_s/ref:1.3631918132305145 - timing_s/adv:0.0074622780084609985 - timing_s/update_actor:7.207764782011509 - timing_s/step:73.50265292078257 - timing_s/stop_profile:4.481710493564606e-05 - timing_per_token_ms/adv:3.1092954589231615e-05 - timing_per_token_ms/gen:0.5848495583286092 - timing_per_token_ms/ref:0.005679989555083623 - timing_per_token_ms/update_actor:0.03003247839370793 - perf/total_num_tokens:239999 - perf/time_per_step:73.50265292078257 - perf/throughput:408.1468329086345
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0203125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0203125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.2474544495344162, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.2474544495344162, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 398.34063720703125, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.02812499925494194, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  47%|████▋     | 249/525 [3:28:25<5:23:02, 70.23s/it]
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 03:10:36,648:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 03:10:39,848:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 03:10:39,850:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:10:41,099:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/huggingface
[36m(TaskRunner pid=2949575)[0m step:249 - global_seqlen/min:29117 - global_seqlen/max:34705 - global_seqlen/minmax_diff:5588 - global_seqlen/balanced_min:32327 - global_seqlen/balanced_max:32328 - global_seqlen/mean:32327.375 - actor/entropy:0.6919935941696167 - actor/kl_loss:5.145612645149231 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13303261548280715 - actor/pg_clipfrac:0.12236379296518862 - actor/ppo_kl:-0.6697913547046482 - actor/pg_clipfrac_lower:0.02348722376918886 - actor/grad_norm:139.14847612380981 - perf/mfu/actor:0.08803700321765189 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.93434143066406 - actor/lr:1e-06 - training/global_step:249 - training/epoch:7 - critic/score/mean:1.0203125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0203125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.2474544495344162 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.2474544495344162 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:398.34063720703125 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.02812499925494194 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.984228432178497e-05 - timing_s/generate_sequences:59.342796325683594 - timing_s/reshard:0.7435445189476013 - timing_s/gen:65.821792954579 - timing_s/reward:0.08115524426102638 - timing_s/old_log_prob:1.2828863132745028 - timing_s/ref:1.3586204294115305 - timing_s/adv:0.007541883736848831 - timing_s/update_actor:7.910533173009753 - timing_s/step:76.4762288723141 - timing_s/stop_profile:4.451535642147064e-05 - timing_per_token_ms/adv:2.916214097513652e-05 - timing_per_token_ms/gen:0.5163749064837646 - timing_per_token_ms/ref:0.005253366649053359 - timing_per_token_ms/update_actor:0.03058759477459024 - perf/total_num_tokens:258619 - perf/time_per_step:76.4762288723141 - perf/throughput:422.71141603980357
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 250}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m The problem involves an equilateral hyperbola with its center at the origin and foci on the x-axis. The hyperbola intersects the parabola \( y^2 = 16x \) at points \( A \) and \( B \), and the distance \( |AB| = 4\sqrt{3} \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m For an equilateral hyperbola, the relationship between the semi-major axis \( a \) and the semi-minor axis \( b \) is given by \( a = b \). The standard form of the equation for an equilateral hyperbola centered at the origin with foci on the x-axis is:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \frac{x^2}{a^2} - \frac{y^2}{a^2} = 1
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The parabola \( y^2 = 16x \) has its focus at \( (4, 0) \) and its directrix at \( x = -4 \). The points \( A \) and \( B \) lie on both the hyperbola and the parabola, and the distance between them is \( 4\sqrt{3} \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Since the hyperbola and the parabola intersect at points \( A \) and \( B \), we can use the properties of the parabola to find the coordinates of \( A \) and \( B \). The distance between the points of intersection of the hyperbola and the parabola can be calculated using the distance formula.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m By substituting the coordinates of \( A \) and \( B \) into the hyperbola equation and solving, we can find the value of \( a \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m After solving, we find that the semi-major axis \( a \) of the hyperbola is 2. Therefore, the length of the real axis (which is \( 2a \)) is \( 4 \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Thus, the length of the real axis of the hyperbola is \( 4 \).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m </think>
[36m(TaskRunner pid=2949575)[0m <answer>The answer is \boxed{C}.).</answer>
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] 2.0
[36m(TaskRunner pid=2949575)[0m [structure] 0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.5
[36m(TaskRunner pid=2949575)[0m [correct] 1.0
[36m(TaskRunner pid=2949575)[0m [acc] True
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.142187476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.142187476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14506831765174866, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14506831765174866, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 350.57501220703125, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.015625, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:250 - global_seqlen/min:28304 - global_seqlen/max:36575 - global_seqlen/minmax_diff:8271 - global_seqlen/balanced_min:30412 - global_seqlen/balanced_max:30413 - global_seqlen/mean:30412.375 - actor/entropy:0.6935366988182068 - actor/kl_loss:5.639290750026703 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02499707490205765 - actor/pg_clipfrac:0.13114081062376498 - actor/ppo_kl:-0.5372261188924312 - actor/pg_clipfrac_lower:0.015169878851156681 - actor/grad_norm:154.34259605407715 - perf/mfu/actor:0.09017289191530939 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.97270202636719 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:1.21 - val-aux/grpo_convert/reward/std@50:0.7603446910208049 - val-aux/grpo_convert/reward/best@2/mean:1.56875 - val-aux/grpo_convert/reward/best@2/std:0.5175699683446895 - val-aux/grpo_convert/reward/worst@2/mean:0.85425 - val-aux/grpo_convert/reward/worst@2/std:0.8137772005698427 - val-aux/grpo_convert/reward/best@4/mean:1.76975 - val-aux/grpo_convert/reward/best@4/std:0.3446262963799527 - val-aux/grpo_convert/reward/worst@4/mean:0.4615 - val-aux/grpo_convert/reward/worst@4/std:0.8097943061081222 - val-aux/grpo_convert/reward/best@8/mean:1.913 - val-aux/grpo_convert/reward/best@8/std:0.20492711743864253 - val-aux/grpo_convert/reward/worst@8/mean:0.07025 - val-aux/grpo_convert/reward/worst@8/std:0.7348997642767172 - val-aux/grpo_convert/reward/best@16/mean:1.9849999999999999 - val-aux/grpo_convert/reward/best@16/std:0.0852936105461599 - val-aux/grpo_convert/reward/worst@16/mean:-0.28475 - val-aux/grpo_convert/reward/worst@16/std:0.5085497574396429 - val-aux/grpo_convert/reward/best@32/mean:2.0 - val-aux/grpo_convert/reward/best@32/std:0.0 - val-aux/grpo_convert/reward/worst@32/mean:-0.4565 - val-aux/grpo_convert/reward/worst@32/std:0.2349487283736451 - val-aux/grpo_convert/reward/best@50/mean:2.0 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.49475 - val-aux/grpo_convert/reward/worst@50/std:0.08640772177928008 - val-aux/grpo_convert/score/mean@50:1.21 - val-aux/grpo_convert/score/std@50:0.7603446910208049 - val-aux/grpo_convert/score/best@2/mean:1.56875 - val-aux/grpo_convert/score/best@2/std:0.5175699683446895 - val-aux/grpo_convert/score/worst@2/mean:0.85425 - val-aux/grpo_convert/score/worst@2/std:0.8137772005698427 - val-aux/grpo_convert/score/best@4/mean:1.76975 - val-aux/grpo_convert/score/best@4/std:0.3446262963799527 - val-aux/grpo_convert/score/worst@4/mean:0.4615 - val-aux/grpo_convert/score/worst@4/std:0.8097943061081222 - val-aux/grpo_convert/score/best@8/mean:1.913 - val-aux/grpo_convert/score/best@8/std:0.20492711743864253 - val-aux/grpo_convert/score/worst@8/mean:0.07025 - val-aux/grpo_convert/score/worst@8/std:0.7348997642767172 - val-aux/grpo_convert/score/best@16/mean:1.9849999999999999 - val-aux/grpo_convert/score/best@16/std:0.0852936105461599 - val-aux/grpo_convert/score/worst@16/mean:-0.28475 - val-aux/grpo_convert/score/worst@16/std:0.5085497574396429 - val-aux/grpo_convert/score/best@32/mean:2.0 - val-aux/grpo_convert/score/best@32/std:0.0 - val-aux/grpo_convert/score/worst@32/mean:-0.4565 - val-aux/grpo_convert/score/worst@32/std:0.2349487283736451 - val-aux/grpo_convert/score/best@50/mean:2.0 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.49475 - val-aux/grpo_convert/score/worst@50/std:0.08640772177928008 - val-aux/grpo_convert/structure/mean@50:0.38 - val-aux/grpo_convert/structure/std@50:0.3234935157289747 - val-aux/grpo_convert/structure/best@2/mean:0.4805 - val-aux/grpo_convert/structure/best@2/std:0.1354842863107054 - val-aux/grpo_convert/structure/worst@2/mean:0.26949999999999996 - val-aux/grpo_convert/structure/worst@2/std:0.4197889123420955 - val-aux/grpo_convert/structure/best@4/mean:0.4995 - val-aux/grpo_convert/structure/best@4/std:0.01580348062927911 - val-aux/grpo_convert/structure/worst@4/mean:0.102 - val-aux/grpo_convert/structure/worst@4/std:0.4871243642736235 - val-aux/grpo_convert/structure/best@8/mean:0.5 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.1245 - val-aux/grpo_convert/structure/worst@8/std:0.47992773034476877 - val-aux/grpo_convert/structure/best@16/mean:0.5 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.3565 - val-aux/grpo_convert/structure/worst@16/std:0.3390331716264286 - val-aux/grpo_convert/structure/best@32/mean:0.5 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.471 - val-aux/grpo_convert/structure/worst@32/std:0.1566324855824301 - val-aux/grpo_convert/structure/best@50/mean:0.5 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.4965 - val-aux/grpo_convert/structure/worst@50/std:0.057605147852853394 - val-aux/grpo_convert/boxed/mean@50:0.44 - val-aux/grpo_convert/boxed/std@50:0.16174675786448736 - val-aux/grpo_convert/boxed/best@2/mean:0.49024999999999996 - val-aux/grpo_convert/boxed/best@2/std:0.0677421431553527 - val-aux/grpo_convert/boxed/worst@2/mean:0.38475000000000004 - val-aux/grpo_convert/boxed/worst@2/std:0.20989445617104774 - val-aux/grpo_convert/boxed/best@4/mean:0.49975 - val-aux/grpo_convert/boxed/best@4/std:0.007901740314639555 - val-aux/grpo_convert/boxed/worst@4/mean:0.30100000000000005 - val-aux/grpo_convert/boxed/worst@4/std:0.24356218213681174 - val-aux/grpo_convert/boxed/best@8/mean:0.5 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.18775 - val-aux/grpo_convert/boxed/worst@8/std:0.23996386517238438 - val-aux/grpo_convert/boxed/best@16/mean:0.5 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.07175 - val-aux/grpo_convert/boxed/worst@16/std:0.16951658581321433 - val-aux/grpo_convert/boxed/best@32/mean:0.5 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.0145 - val-aux/grpo_convert/boxed/worst@32/std:0.07831624279121505 - val-aux/grpo_convert/boxed/best@50/mean:0.5 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.00175 - val-aux/grpo_convert/boxed/worst@50/std:0.028802573926426697 - val-aux/grpo_convert/correct/mean@50:0.39 - val-aux/grpo_convert/correct/std@50:0.4467792535850613 - val-aux/grpo_convert/correct/best@2/mean:0.598 - val-aux/grpo_convert/correct/best@2/std:0.4263297270494572 - val-aux/grpo_convert/correct/worst@2/mean:0.19999999999999998 - val-aux/grpo_convert/correct/worst@2/std:0.34568009863268784 - val-aux/grpo_convert/correct/best@4/mean:0.7705 - val-aux/grpo_convert/correct/best@4/std:0.3377860675312014 - val-aux/grpo_convert/correct/worst@4/mean:0.0585 - val-aux/grpo_convert/correct/worst@4/std:0.18625065020118164 - val-aux/grpo_convert/correct/best@8/mean:0.913 - val-aux/grpo_convert/correct/best@8/std:0.20492711743864253 - val-aux/grpo_convert/correct/worst@8/mean:0.007 - val-aux/grpo_convert/correct/worst@8/std:0.05874521257089806 - val-aux/grpo_convert/correct/best@16/mean:0.985 - val-aux/grpo_convert/correct/best@16/std:0.0852936105461599 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:1.0 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:1.0 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.39 - val-aux/grpo_convert/acc/std@50:0.4467792535850613 - val-aux/grpo_convert/acc/best@2/mean:0.598 - val-aux/grpo_convert/acc/best@2/std:0.4263297270494572 - val-aux/grpo_convert/acc/worst@2/mean:0.19999999999999998 - val-aux/grpo_convert/acc/worst@2/std:0.34568009863268784 - val-aux/grpo_convert/acc/best@4/mean:0.7705 - val-aux/grpo_convert/acc/best@4/std:0.3377860675312014 - val-aux/grpo_convert/acc/worst@4/mean:0.0585 - val-aux/grpo_convert/acc/worst@4/std:0.18625065020118164 - val-aux/grpo_convert/acc/best@8/mean:0.913 - val-aux/grpo_convert/acc/best@8/std:0.20492711743864253 - val-aux/grpo_convert/acc/worst@8/mean:0.007 - val-aux/grpo_convert/acc/worst@8/std:0.05874521257089806 - val-aux/grpo_convert/acc/best@16/mean:0.985 - val-aux/grpo_convert/acc/best@16/std:0.0852936105461599 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:1.0 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:1.0 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:250 - training/epoch:7 - critic/score/mean:1.142187476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.142187476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14506831765174866 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14506831765174866 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:350.57501220703125 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.804110646247864e-05 - timing_s/generate_sequences:55.783241271972656 - timing_s/reshard:0.6848293542861938 - timing_s/gen:65.23735376819968 - timing_s/reward:0.07688155770301819 - timing_s/old_log_prob:1.1865377705544233 - timing_s/ref:1.3492100182920694 - timing_s/adv:0.0075743719935417175 - timing_s/update_actor:7.230687214061618 - timing_s/testing:67.50576398335397 - timing_s/save_checkpoint:7.498432965949178 - timing_s/step:150.10611832514405 - timing_s/stop_profile:5.508586764335632e-05 - timing_per_token_ms/adv:3.113194872786866e-05 - timing_per_token_ms/gen:0.5815210169738972 - timing_per_token_ms/ref:0.005545481149910478 - timing_per_token_ms/update_actor:0.02971934621211603 - perf/total_num_tokens:243299 - perf/time_per_step:150.10611832514405 - perf/throughput:202.6058320562518[36m(TaskRunner pid=2949575)[0m Training Progress:  48%|████▊     | 250/525 [3:30:55<7:11:44, 94.20s/it]
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 03:10:37,152:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  48%|████▊     | 251/525 [3:32:11<6:45:09, 88.72s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:10:41,643:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:10:41,645:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_250/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  48%|████▊     | 252/525 [3:33:26<6:25:04, 84.63s/it]

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.009374976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.009374976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14945334196090698, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14945334196090698, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 413.0625, 'response_length/max': 2048.0, 'response_length/min': 13.0, 'response_length/clip_ratio': 0.01875000074505806, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.009375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:251 - global_seqlen/min:29525 - global_seqlen/max:40675 - global_seqlen/minmax_diff:11150 - global_seqlen/balanced_min:32898 - global_seqlen/balanced_max:32899 - global_seqlen/mean:32898.75 - actor/entropy:0.7673801779747009 - actor/kl_loss:4.401672726869583 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.022752279043197633 - actor/pg_clipfrac:0.1901087407954037 - actor/ppo_kl:-0.2616011151985731 - actor/pg_clipfrac_lower:0.006764310481958091 - actor/grad_norm:138.28963375091553 - perf/mfu/actor:0.09497824419214974 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.88945388793945 - actor/lr:1e-06 - training/global_step:251 - training/epoch:7 - critic/score/mean:1.009374976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.009374976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14945334196090698 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14945334196090698 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:413.0625 - response_length/max:2048.0 - response_length/min:13.0 - response_length/clip_ratio:0.01875000074505806 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.009375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.608400821685791e-05 - timing_s/generate_sequences:61.01214599609375 - timing_s/reshard:0.6186302900314331 - timing_s/gen:65.58177578449249 - timing_s/reward:0.08324083499610424 - timing_s/old_log_prob:1.3675153255462646 - timing_s/ref:1.3987478390336037 - timing_s/adv:0.010317318141460419 - timing_s/update_actor:7.463866975158453 - timing_s/step:75.92798273824155 - timing_s/stop_profile:4.518590867519379e-05 - timing_per_token_ms/adv:3.920102641232729e-05 - timing_per_token_ms/gen:0.4961550596496633 - timing_per_token_ms/ref:0.005314593407931926 - timing_per_token_ms/update_actor:0.028359234678971286 - perf/total_num_tokens:263190 - perf/time_per_step:75.92798273824155 - perf/throughput:433.2888720804953
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10633006691932678, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10633006691932678, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 370.37188720703125, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.015625, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:252 - global_seqlen/min:27458 - global_seqlen/max:37588 - global_seqlen/minmax_diff:10130 - global_seqlen/balanced_min:31178 - global_seqlen/balanced_max:31178 - global_seqlen/mean:31178.0 - actor/entropy:0.7376317381858826 - actor/kl_loss:4.931048321723938 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.02177289016544819 - actor/pg_clipfrac:0.11370466402731835 - actor/ppo_kl:-0.10254966281354427 - actor/pg_clipfrac_lower:0.006952114513842389 - actor/grad_norm:205.52524185180664 - perf/mfu/actor:0.09037035182565471 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:96.96725845336914 - actor/lr:1e-06 - training/global_step:252 - training/epoch:7 - critic/score/mean:1.0625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10633006691932678 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10633006691932678 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:370.37188720703125 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.04817134141922e-05 - timing_s/generate_sequences:62.495689392089844 - timing_s/reshard:0.6772469878196716 - timing_s/gen:64.82428606040776 - timing_s/reward:0.07917332090437412 - timing_s/old_log_prob:1.337317941710353 - timing_s/ref:1.3893397320061922 - timing_s/adv:0.008437491953372955 - timing_s/update_actor:7.4156250189989805 - timing_s/step:75.07215651869774 - timing_s/stop_profile:4.1229650378227234e-05 - timing_per_token_ms/adv:3.3827907311938525e-05 - timing_per_token_ms/gen:0.5469526916393807 - timing_per_token_ms/ref:0.005570192651894734 - timing_per_token_ms/update_actor:0.02973100030068871 - perf/total_num_tokens:249424 - perf/time_per_step:75.07215651869774 - perf/throughput:415.30710513470723
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  48%|████▊     | 253/525 [3:34:41<6:11:07, 81.86s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  48%|████▊     | 254/525 [3:35:59<6:03:36, 80.51s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0828125476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0828125476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.16732656955718994, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.16732656955718994, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 383.62188720703125, 'response_length/max': 2048.0, 'response_length/min': 9.0, 'response_length/clip_ratio': 0.015625, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:253 - global_seqlen/min:28869 - global_seqlen/max:34815 - global_seqlen/minmax_diff:5946 - global_seqlen/balanced_min:31708 - global_seqlen/balanced_max:31708 - global_seqlen/mean:31708.0 - actor/entropy:0.6808643937110901 - actor/kl_loss:5.711987084150314 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.023328451812267302 - actor/pg_clipfrac:0.2112401754129678 - actor/ppo_kl:0.12250465685501695 - actor/pg_clipfrac_lower:0.004607017734088004 - actor/grad_norm:233.18749809265137 - perf/mfu/actor:0.09234845558995262 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.0802116394043 - actor/lr:1e-06 - training/global_step:253 - training/epoch:7 - critic/score/mean:1.0828125476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0828125476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.16732656955718994 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.16732656955718994 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:383.62188720703125 - response_length/max:2048.0 - response_length/min:9.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.794665336608887e-05 - timing_s/generate_sequences:56.89274597167969 - timing_s/reshard:0.6475806832313538 - timing_s/gen:65.24026757478714 - timing_s/reward:0.08008317090570927 - timing_s/old_log_prob:1.2736940737813711 - timing_s/ref:1.3940277006477118 - timing_s/adv:0.00843803770840168 - timing_s/update_actor:7.377839624881744 - timing_s/step:75.39161954075098 - timing_s/stop_profile:4.4094398617744446e-05 - timing_per_token_ms/adv:3.3264624496978996e-05 - timing_per_token_ms/gen:0.5314499757637904 - timing_per_token_ms/ref:0.005495567761478616 - timing_per_token_ms/update_actor:0.02908508745774625 - perf/total_num_tokens:253664 - perf/time_per_step:75.39161954075098 - perf/throughput:420.57724974141274
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1906249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1906249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10074814409017563, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10074814409017563, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 335.62188720703125, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.00937500037252903, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.190625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:254 - global_seqlen/min:26939 - global_seqlen/max:33854 - global_seqlen/minmax_diff:6915 - global_seqlen/balanced_min:29758 - global_seqlen/balanced_max:29878 - global_seqlen/mean:29809.875 - actor/entropy:0.6042315363883972 - actor/kl_loss:5.015821868181229 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.054204335622489455 - actor/pg_clipfrac:0.18552404846996068 - actor/ppo_kl:0.1924826769158244 - actor/pg_clipfrac_lower:0.007901244447566569 - actor/grad_norm:115.7642765045166 - perf/mfu/actor:0.088633328946895 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.23299407958984 - actor/lr:1e-06 - training/global_step:254 - training/epoch:7 - critic/score/mean:1.1906249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1906249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10074814409017563 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10074814409017563 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:335.62188720703125 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.00937500037252903 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.190625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010306946933269501 - timing_s/generate_sequences:58.84587097167969 - timing_s/reshard:0.6894291639328003 - timing_s/gen:66.56277327798307 - timing_s/reward:0.0761084146797657 - timing_s/old_log_prob:1.273822607472539 - timing_s/ref:1.3741065058857203 - timing_s/adv:0.008211672306060791 - timing_s/update_actor:7.207576889544725 - timing_s/step:76.51918936148286 - timing_s/stop_profile:4.4131651520729065e-05 - timing_per_token_ms/adv:3.443352373190424e-05 - timing_per_token_ms/gen:0.6197708849987715 - timing_per_token_ms/ref:0.005761960197274059 - timing_per_token_ms/update_actor:0.030223109328472216 - perf/total_num_tokens:238479 - perf/time_per_step:76.51918936148286 - perf/throughput:389.5738474067692
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.056249976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.056249976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14450915157794952, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14450915157794952, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 357.89373779296875, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.012500000186264515, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.05625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  49%|████▊     | 255/525 [3:37:14<5:54:56, 78.88s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  49%|████▉     | 256/525 [3:38:29<5:48:03, 77.63s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:255 - global_seqlen/min:26449 - global_seqlen/max:37428 - global_seqlen/minmax_diff:10979 - global_seqlen/balanced_min:30718 - global_seqlen/balanced_max:30719 - global_seqlen/mean:30718.25 - actor/entropy:0.57692551612854 - actor/kl_loss:4.5875644266605375 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04232136532664299 - actor/pg_clipfrac:0.13544288016855716 - actor/ppo_kl:-1.0012507185339927 - actor/pg_clipfrac_lower:0.0336867518723011 - actor/grad_norm:226.03600692749023 - perf/mfu/actor:0.09073933682008353 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.19736099243164 - actor/lr:1e-06 - training/global_step:255 - training/epoch:7 - critic/score/mean:1.056249976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.056249976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14450915157794952 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14450915157794952 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:357.89373779296875 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.012500000186264515 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.05625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.587539196014404e-05 - timing_s/generate_sequences:58.57820129394531 - timing_s/reshard:0.7586513757705688 - timing_s/gen:64.91666469909251 - timing_s/reward:0.07918637432157993 - timing_s/old_log_prob:1.3862116038799286 - timing_s/ref:1.372563535347581 - timing_s/adv:0.008172700181603432 - timing_s/update_actor:7.2774840500205755 - timing_s/step:75.05687869898975 - timing_s/stop_profile:4.5808032155036926e-05 - timing_per_token_ms/adv:3.3256696677070764e-05 - timing_per_token_ms/gen:0.566829058022567 - timing_per_token_ms/ref:0.00558529349550992 - timing_per_token_ms/update_actor:0.0296138453932946 - perf/total_num_tokens:245746 - perf/time_per_step:75.05687869898975 - perf/throughput:409.26628621466324
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.045312523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.045312523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15425144135951996, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15425144135951996, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 378.26873779296875, 'response_length/max': 2048.0, 'response_length/min': 14.0, 'response_length/clip_ratio': 0.0062500000931322575, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0453125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:256 - global_seqlen/min:27638 - global_seqlen/max:36291 - global_seqlen/minmax_diff:8653 - global_seqlen/balanced_min:31515 - global_seqlen/balanced_max:31516 - global_seqlen/mean:31515.75 - actor/entropy:0.4337088465690613 - actor/kl_loss:4.576716035604477 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15182077176868916 - actor/pg_clipfrac:0.15059200655668975 - actor/ppo_kl:-0.4180697496980429 - actor/pg_clipfrac_lower:0.01680063360836357 - actor/grad_norm:126.18199729919434 - perf/mfu/actor:0.09262996045029119 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.02469253540039 - actor/lr:1e-06 - training/global_step:256 - training/epoch:7 - critic/score/mean:1.045312523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.045312523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15425144135951996 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15425144135951996 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:378.26873779296875 - response_length/max:2048.0 - response_length/min:14.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0453125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.917281568050385e-05 - timing_s/generate_sequences:56.6329460144043 - timing_s/reshard:0.7729623317718506 - timing_s/gen:64.50328620709479 - timing_s/reward:0.08073707669973373 - timing_s/old_log_prob:1.4301130697131157 - timing_s/ref:1.374144209548831 - timing_s/adv:0.008275199681520462 - timing_s/update_actor:7.3103586211800575 - timing_s/step:74.72420093975961 - timing_s/stop_profile:4.6022236347198486e-05 - timing_per_token_ms/adv:3.2821683132721184e-05 - timing_per_token_ms/gen:0.5328824265741519 - timing_per_token_ms/ref:0.005450228098446138 - timing_per_token_ms/update_actor:0.028994862176768988 - perf/total_num_tokens:252126 - perf/time_per_step:74.72420093975961 - perf/throughput:421.7609503165787
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0437500476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0437500476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.28110042214393616, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.28110042214393616, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 382.86248779296875, 'response_length/max': 2048.0, 'response_length/min': 8.0, 'response_length/clip_ratio': 0.015625, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.04375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  49%|████▉     | 257/525 [3:39:45<5:45:34, 77.37s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  49%|████▉     | 258/525 [3:41:01<5:42:27, 76.96s/it]
[36m(TaskRunner pid=2949575)[0m step:257 - global_seqlen/min:28124 - global_seqlen/max:35237 - global_seqlen/minmax_diff:7113 - global_seqlen/balanced_min:31664 - global_seqlen/balanced_max:31665 - global_seqlen/mean:31664.5 - actor/entropy:0.3935557007789612 - actor/kl_loss:4.675388693809509 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08883685935288668 - actor/pg_clipfrac:0.10215128008276224 - actor/ppo_kl:-0.6764839425683021 - actor/pg_clipfrac_lower:0.028438593551982194 - actor/grad_norm:257.6044578552246 - perf/mfu/actor:0.09204967318975762 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.05804824829102 - actor/lr:1e-06 - training/global_step:257 - training/epoch:7 - critic/score/mean:1.0437500476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0437500476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.28110042214393616 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.28110042214393616 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:382.86248779296875 - response_length/max:2048.0 - response_length/min:8.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.04375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.856505155563354e-05 - timing_s/generate_sequences:63.603965759277344 - timing_s/reshard:0.8646741509437561 - timing_s/gen:66.56332484446466 - timing_s/reward:0.08421480096876621 - timing_s/old_log_prob:1.3063862230628729 - timing_s/ref:1.3631408624351025 - timing_s/adv:0.007530083879828453 - timing_s/update_actor:7.396715059876442 - timing_s/step:76.7350443713367 - timing_s/stop_profile:4.319287836551666e-05 - timing_per_token_ms/adv:2.972604920268934e-05 - timing_per_token_ms/gen:0.5433031183230326 - timing_per_token_ms/ref:0.005381187380327742 - timing_per_token_ms/update_actor:0.029199557311328308 - perf/total_num_tokens:253316 - perf/time_per_step:76.7350443713367 - perf/throughput:412.64718433951714
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.064062476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.064062476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.2052866369485855, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.2052866369485855, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 374.7593688964844, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.02812499925494194, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:258 - global_seqlen/min:28053 - global_seqlen/max:36661 - global_seqlen/minmax_diff:8608 - global_seqlen/balanced_min:31384 - global_seqlen/balanced_max:31385 - global_seqlen/mean:31384.125 - actor/entropy:0.28354260325431824 - actor/kl_loss:4.09898419380188 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.051903636567294596 - actor/pg_clipfrac:0.10281393411569298 - actor/ppo_kl:0.07657118765637279 - actor/pg_clipfrac_lower:0.007308893033768982 - actor/grad_norm:121.97802448272705 - perf/mfu/actor:0.08984995306870122 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.1005744934082 - actor/lr:1e-06 - training/global_step:258 - training/epoch:7 - critic/score/mean:1.064062476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.064062476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.2052866369485855 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.2052866369485855 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:374.7593688964844 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.02812499925494194 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.794424891471863e-05 - timing_s/generate_sequences:63.03739547729492 - timing_s/reshard:0.6909451484680176 - timing_s/gen:65.70218368805945 - timing_s/reward:0.08146780170500278 - timing_s/old_log_prob:1.2877980452030897 - timing_s/ref:1.369036102667451 - timing_s/adv:0.007670298218727112 - timing_s/update_actor:7.522017473354936 - timing_s/step:75.9836570378393 - timing_s/stop_profile:4.474632441997528e-05 - timing_per_token_ms/adv:3.0550071966030246e-05 - timing_per_token_ms/gen:0.5478697471549198 - timing_per_token_ms/ref:0.005452741245245211 - timing_per_token_ms/update_actor:0.029959483788997366 - perf/total_num_tokens:251073 - perf/time_per_step:75.9836570378393 - perf/throughput:413.0378323903381
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.971875011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.971875011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.24225974082946777, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.24225974082946777, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 416.51251220703125, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.05312500149011612, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.971875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  49%|████▉     | 259/525 [3:42:17<5:39:59, 76.69s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:23:23,441:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:23:28,215:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:23:28,218:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:23:23,797:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:23:28,758:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  50%|████▉     | 260/525 [3:43:44<5:51:45, 79.64s/it]
[36m(TaskRunner pid=2949575)[0m step:259 - global_seqlen/min:29869 - global_seqlen/max:38438 - global_seqlen/minmax_diff:8569 - global_seqlen/balanced_min:33049 - global_seqlen/balanced_max:33050 - global_seqlen/mean:33049.875 - actor/entropy:0.21184475719928741 - actor/kl_loss:4.302552050352096 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.3100505931768566 - actor/pg_clipfrac:0.07879455778747797 - actor/ppo_kl:-0.6377690594643355 - actor/pg_clipfrac_lower:0.032558581657940525 - actor/grad_norm:227.13619661331177 - perf/mfu/actor:0.09159395188512726 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.09789276123047 - actor/lr:1e-06 - training/global_step:259 - training/epoch:7 - critic/score/mean:0.971875011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.971875011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.24225974082946777 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.24225974082946777 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:416.51251220703125 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.05312500149011612 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.971875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.707066833972931e-05 - timing_s/generate_sequences:62.49261474609375 - timing_s/reshard:0.6752200126647949 - timing_s/gen:65.27034031040967 - timing_s/reward:0.08690577372908592 - timing_s/old_log_prob:1.4481727816164494 - timing_s/ref:1.4122898429632187 - timing_s/adv:0.008147425949573517 - timing_s/update_actor:7.813341984525323 - timing_s/step:76.05644173361361 - timing_s/stop_profile:4.414096474647522e-05 - timing_per_token_ms/adv:3.081488942686439e-05 - timing_per_token_ms/gen:0.489708744563561 - timing_per_token_ms/ref:0.005341509774860036 - timing_per_token_ms/update_actor:0.02955132956072195 - perf/total_num_tokens:264399 - perf/time_per_step:76.05644173361361 - perf/throughput:434.5440602619384
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.095312476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.095312476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.2767222225666046, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.2767222225666046, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 449.36248779296875, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.06562499701976776, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:260 - global_seqlen/min:29328 - global_seqlen/max:40001 - global_seqlen/minmax_diff:10673 - global_seqlen/balanced_min:34270 - global_seqlen/balanced_max:34393 - global_seqlen/mean:34377.0 - actor/entropy:0.1535181701183319 - actor/kl_loss:3.00836843252182 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.022403243556618692 - actor/pg_clipfrac:0.07630227152258158 - actor/ppo_kl:-0.2921492388471961 - actor/pg_clipfrac_lower:0.00996192111633718 - actor/grad_norm:141.22471380233765 - perf/mfu/actor:0.09558456792709719 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.06501770019531 - actor/lr:1e-06 - training/global_step:260 - training/epoch:7 - critic/score/mean:1.095312476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.095312476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.2767222225666046 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.2767222225666046 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:449.36248779296875 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.893758058547974e-05 - timing_s/generate_sequences:64.16976928710938 - timing_s/reshard:0.699351966381073 - timing_s/gen:65.99182438291609 - timing_s/reward:0.08795989863574505 - timing_s/old_log_prob:1.385569492354989 - timing_s/ref:1.395452942699194 - timing_s/adv:0.008348623290657997 - timing_s/update_actor:7.797580551356077 - timing_s/save_checkpoint:9.831671183928847 - timing_s/step:86.51511975936592 - timing_s/stop_profile:5.1079317927360535e-05 - timing_per_token_ms/adv:3.03568639303095e-05 - timing_per_token_ms/gen:0.45892670437923233 - timing_per_token_ms/ref:0.005074079117939298 - timing_per_token_ms/update_actor:0.028353188728496077 - perf/total_num_tokens:275016 - perf/time_per_step:86.51511975936592 - perf/throughput:397.3525101232774
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.971875011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.971875011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.312985360622406, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.312985360622406, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 467.234375, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.08437500149011612, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.971875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  50%|████▉     | 261/525 [3:45:01<5:46:44, 78.81s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:23:30,581:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:23:30,583:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_260/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  50%|████▉     | 262/525 [3:46:18<5:43:26, 78.35s/it]
[36m(TaskRunner pid=2949575)[0m step:261 - global_seqlen/min:32720 - global_seqlen/max:40701 - global_seqlen/minmax_diff:7981 - global_seqlen/balanced_min:35065 - global_seqlen/balanced_max:35066 - global_seqlen/mean:35065.625 - actor/entropy:0.15072765946388245 - actor/kl_loss:3.9904420256614683 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10912739033810795 - actor/pg_clipfrac:0.08029696057201363 - actor/ppo_kl:-0.204790005274117 - actor/pg_clipfrac_lower:0.00496434597298503 - actor/grad_norm:138.44703483581543 - perf/mfu/actor:0.09782964560834079 - perf/max_memory_allocated_gb:65.59972906112671 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.20672988891602 - actor/lr:1e-06 - training/global_step:261 - training/epoch:7 - critic/score/mean:0.971875011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.971875011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.312985360622406 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.312985360622406 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:467.234375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.08437500149011612 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.971875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.681230247020721e-05 - timing_s/generate_sequences:63.850589752197266 - timing_s/reshard:0.6814489960670471 - timing_s/gen:66.12055762857199 - timing_s/reward:0.09031221084296703 - timing_s/old_log_prob:1.4146055467426777 - timing_s/ref:1.396547257900238 - timing_s/adv:0.008465681225061417 - timing_s/update_actor:7.791229488328099 - timing_s/step:76.83897373825312 - timing_s/stop_profile:4.621967673301697e-05 - timing_per_token_ms/adv:3.0177992068662032e-05 - timing_per_token_ms/gen:0.4422336061838076 - timing_per_token_ms/ref:0.004978334401212862 - timing_per_token_ms/update_actor:0.027773743831487743 - perf/total_num_tokens:280525 - perf/time_per_step:76.83897373825312 - perf/throughput:456.35207361629705
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9750000238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9750000238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.27462446689605713, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.27462446689605713, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 454.7906188964844, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.08749999850988388, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.975, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:262 - global_seqlen/min:28083 - global_seqlen/max:39957 - global_seqlen/minmax_diff:11874 - global_seqlen/balanced_min:34545 - global_seqlen/balanced_max:34574 - global_seqlen/mean:34559.125 - actor/entropy:0.13674655556678772 - actor/kl_loss:3.7957465410232545 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06549107199534773 - actor/pg_clipfrac:0.08524257238022984 - actor/ppo_kl:-0.2058368450962007 - actor/pg_clipfrac_lower:0.010506100847851484 - actor/grad_norm:163.23257637023926 - perf/mfu/actor:0.09633040884708316 - perf/max_memory_allocated_gb:67.36093997955322 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.36012649536133 - actor/lr:1e-06 - training/global_step:262 - training/epoch:7 - critic/score/mean:0.9750000238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9750000238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.27462446689605713 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.27462446689605713 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:454.7906188964844 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.08749999850988388 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.975 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010406039655208588 - timing_s/generate_sequences:63.811832427978516 - timing_s/reshard:0.706979513168335 - timing_s/gen:65.65477421879768 - timing_s/reward:0.09077342972159386 - timing_s/old_log_prob:1.443443601951003 - timing_s/ref:1.4267177488654852 - timing_s/adv:0.009569350630044937 - timing_s/update_actor:7.815493330359459 - timing_s/step:76.45794591121376 - timing_s/stop_profile:4.499219357967377e-05 - timing_per_token_ms/adv:3.461224289549047e-05 - timing_per_token_ms/gen:0.45113324276141964 - timing_per_token_ms/ref:0.0051604234368834755 - timing_per_token_ms/update_actor:0.02826855906493386 - perf/total_num_tokens:276473 - perf/time_per_step:76.45794591121376 - perf/throughput:452.0017453794997
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.848437488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.848437488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.224092498421669, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.224092498421669, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 421.8843688964844, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.0625, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  50%|█████     | 263/525 [3:47:35<5:40:12, 77.91s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  50%|█████     | 264/525 [3:48:53<5:38:25, 77.80s/it]
[36m(TaskRunner pid=2949575)[0m step:263 - global_seqlen/min:28905 - global_seqlen/max:40197 - global_seqlen/minmax_diff:11292 - global_seqlen/balanced_min:33242 - global_seqlen/balanced_max:33243 - global_seqlen/mean:33242.875 - actor/entropy:0.11761189252138138 - actor/kl_loss:3.3215999394655227 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14360372424125672 - actor/pg_clipfrac:0.040427754470147195 - actor/ppo_kl:-0.24013318435754627 - actor/pg_clipfrac_lower:0.007897147508629132 - actor/grad_norm:194.85137748718262 - perf/mfu/actor:0.0938342192080059 - perf/max_memory_allocated_gb:67.36093997955322 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.21331787109375 - actor/lr:1e-06 - training/global_step:263 - training/epoch:7 - critic/score/mean:0.848437488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.848437488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.224092498421669 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.224092498421669 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:421.8843688964844 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.571892976760864e-05 - timing_s/generate_sequences:63.563255310058594 - timing_s/reshard:0.6648586988449097 - timing_s/gen:66.25132587179542 - timing_s/reward:0.08628430590033531 - timing_s/old_log_prob:1.4322133511304855 - timing_s/ref:1.3832695242017508 - timing_s/adv:0.008236413821578026 - timing_s/update_actor:7.681265935301781 - timing_s/step:76.85862294957042 - timing_s/stop_profile:4.717335104942322e-05 - timing_per_token_ms/adv:3.09705982920326e-05 - timing_per_token_ms/gen:0.4907396566875952 - timing_per_token_ms/ref:0.005201375949740173 - timing_per_token_ms/update_actor:0.028883128848293735 - perf/total_num_tokens:265943 - perf/time_per_step:76.85862294957042 - perf/throughput:432.5197840431228
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.848437488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.848437488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.29113224148750305, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.29113224148750305, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 487.35626220703125, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.12187500298023224, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:264 - global_seqlen/min:29786 - global_seqlen/max:44080 - global_seqlen/minmax_diff:14294 - global_seqlen/balanced_min:35874 - global_seqlen/balanced_max:35880 - global_seqlen/mean:35874.875 - actor/entropy:0.08857151120901108 - actor/kl_loss:2.9101213052868844 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.14923707954585552 - actor/pg_clipfrac:0.04038881192682311 - actor/ppo_kl:0.036439110664650796 - actor/pg_clipfrac_lower:0.0034606339235324413 - actor/grad_norm:87.97987365722656 - perf/mfu/actor:0.09653644185494831 - perf/max_memory_allocated_gb:67.36093997955322 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.17446517944336 - actor/lr:1e-06 - training/global_step:264 - training/epoch:7 - critic/score/mean:0.848437488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.848437488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.29113224148750305 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.29113224148750305 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:487.35626220703125 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.12187500298023224 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.335895836353302e-05 - timing_s/generate_sequences:64.19837951660156 - timing_s/reshard:0.6809415817260742 - timing_s/gen:66.39691067487001 - timing_s/reward:0.09493636153638363 - timing_s/old_log_prob:1.4656982645392418 - timing_s/ref:1.412326905876398 - timing_s/adv:0.008477816358208656 - timing_s/update_actor:8.126698307693005 - timing_s/step:77.52224006690085 - timing_s/stop_profile:4.6158209443092346e-05 - timing_per_token_ms/adv:2.9539532744743556e-05 - timing_per_token_ms/gen:0.4257467629869706 - timing_per_token_ms/ref:0.004921016818443263 - timing_per_token_ms/update_actor:0.028316120640465663 - perf/total_num_tokens:286999 - perf/time_per_step:77.52224006690085 - perf/throughput:462.76881278250437
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.84375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.84375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.2488699108362198, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.2488699108362198, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 532.3812255859375, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.11874999850988388, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.84375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  50%|█████     | 265/525 [3:50:10<5:36:57, 77.76s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  51%|█████     | 266/525 [3:51:27<5:34:46, 77.56s/it]
[36m(TaskRunner pid=2949575)[0m step:265 - global_seqlen/min:30442 - global_seqlen/max:45493 - global_seqlen/minmax_diff:15051 - global_seqlen/balanced_min:37658 - global_seqlen/balanced_max:37659 - global_seqlen/mean:37658.375 - actor/entropy:0.0868111327290535 - actor/kl_loss:2.8992215171456337 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22082975283265113 - actor/pg_clipfrac:0.06600050189881586 - actor/ppo_kl:-0.6569871142040938 - actor/pg_clipfrac_lower:0.04470763672143221 - actor/grad_norm:175.8915672302246 - perf/mfu/actor:0.10381228958905436 - perf/max_memory_allocated_gb:67.36093997955322 - perf/max_memory_reserved_gb:97.890625 - perf/cpu_memory_used_gb:97.13036727905273 - actor/lr:1e-06 - training/global_step:265 - training/epoch:7 - critic/score/mean:0.84375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.84375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.2488699108362198 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.2488699108362198 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:532.3812255859375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.11874999850988388 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.84375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.622929453849792e-05 - timing_s/generate_sequences:64.2666015625 - timing_s/reshard:0.7491735219955444 - timing_s/gen:66.6656349543482 - timing_s/reward:0.0987519659101963 - timing_s/old_log_prob:1.5131287798285484 - timing_s/ref:1.4018773194402456 - timing_s/adv:0.00830848142504692 - timing_s/update_actor:7.945955054834485 - timing_s/step:77.65091786161065 - timing_s/stop_profile:4.525110125541687e-05 - timing_per_token_ms/adv:2.75784650328344e-05 - timing_per_token_ms/gen:0.39131751772313195 - timing_per_token_ms/ref:0.004653272079053616 - timing_per_token_ms/update_actor:0.026375125901059476 - perf/total_num_tokens:301267 - perf/time_per_step:77.65091786161065 - perf/throughput:484.97012059940744
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.620312511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.620312511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.20807869732379913, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.20807869732379913, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 509.98126220703125, 'response_length/max': 2048.0, 'response_length/min': 2.0, 'response_length/clip_ratio': 0.13750000298023224, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:266 - global_seqlen/min:30891 - global_seqlen/max:44529 - global_seqlen/minmax_diff:13638 - global_seqlen/balanced_min:36642 - global_seqlen/balanced_max:36867 - global_seqlen/mean:36784.25 - actor/entropy:0.08372405916452408 - actor/kl_loss:3.2783205643296243 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.010280177183449268 - actor/pg_clipfrac:0.04994841311126948 - actor/ppo_kl:-0.6954278956574399 - actor/pg_clipfrac_lower:0.016012330213561653 - actor/grad_norm:89.03950500488281 - perf/mfu/actor:0.10094272206659019 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.11402130126953 - actor/lr:1e-06 - training/global_step:266 - training/epoch:7 - critic/score/mean:0.620312511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.620312511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.20807869732379913 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.20807869732379913 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:509.98126220703125 - response_length/max:2048.0 - response_length/min:2.0 - response_length/clip_ratio:0.13750000298023224 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.128451347351074e-05 - timing_s/generate_sequences:63.85249328613281 - timing_s/reshard:0.692805826663971 - timing_s/gen:65.98433065600693 - timing_s/reward:0.09702585637569427 - timing_s/old_log_prob:1.5352178644388914 - timing_s/ref:1.4354324955493212 - timing_s/adv:0.008319113403558731 - timing_s/update_actor:7.989454647526145 - timing_s/step:77.06711155921221 - timing_s/stop_profile:4.4947490096092224e-05 - timing_per_token_ms/adv:2.826995726281877e-05 - timing_per_token_ms/gen:0.40433061666487086 - timing_per_token_ms/ref:0.004877877405239067 - timing_per_token_ms/update_actor:0.027149713014150572 - perf/total_num_tokens:294274 - perf/time_per_step:77.06711155921221 - perf/throughput:477.3015266277097
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6781250238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6781250238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.18454842269420624, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.18454842269420624, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 608.1156005859375, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.18437500298023224, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.678125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  51%|█████     | 267/525 [3:52:45<5:34:06, 77.70s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  51%|█████     | 268/525 [3:54:04<5:34:17, 78.04s/it]
[36m(TaskRunner pid=2949575)[0m step:267 - global_seqlen/min:32128 - global_seqlen/max:50833 - global_seqlen/minmax_diff:18705 - global_seqlen/balanced_min:40683 - global_seqlen/balanced_max:40878 - global_seqlen/mean:40714.0 - actor/entropy:0.06531982868909836 - actor/kl_loss:2.62192837446928 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15281158103607595 - actor/pg_clipfrac:0.03914192116353661 - actor/ppo_kl:-0.1918729071505368 - actor/pg_clipfrac_lower:0.00418303805636242 - actor/grad_norm:73.44282960891724 - perf/mfu/actor:0.11072097400363892 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.0536994934082 - actor/lr:1e-06 - training/global_step:267 - training/epoch:7 - critic/score/mean:0.6781250238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6781250238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.18454842269420624 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.18454842269420624 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:608.1156005859375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.18437500298023224 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.678125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.623674511909485e-05 - timing_s/generate_sequences:64.56238555908203 - timing_s/reshard:0.8076177835464478 - timing_s/gen:66.72044721245766 - timing_s/reward:0.10696857236325741 - timing_s/old_log_prob:1.6097699515521526 - timing_s/ref:1.4596259854733944 - timing_s/adv:0.008467396721243858 - timing_s/update_actor:8.105301525443792 - timing_s/step:78.02803056873381 - timing_s/stop_profile:4.557706415653229e-05 - timing_per_token_ms/adv:2.5996575874526755e-05 - timing_per_token_ms/gen:0.34286472665281403 - timing_per_token_ms/ref:0.004481339298132689 - timing_per_token_ms/update_actor:0.02488487229651899 - perf/total_num_tokens:325712 - perf/time_per_step:78.02803056873381 - perf/throughput:521.7868463838211
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5687500238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5687500238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.2494964748620987, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.2494964748620987, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 586.1468505859375, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.16562500596046448, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.56875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:268 - global_seqlen/min:28447 - global_seqlen/max:49674 - global_seqlen/minmax_diff:21227 - global_seqlen/balanced_min:39751 - global_seqlen/balanced_max:39921 - global_seqlen/mean:39835.25 - actor/entropy:0.07625814527273178 - actor/kl_loss:2.77897153198719 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09010149957612157 - actor/pg_clipfrac:0.06406945679336787 - actor/ppo_kl:-0.28466419333126397 - actor/pg_clipfrac_lower:0.02053676957730204 - actor/grad_norm:118.47366380691528 - perf/mfu/actor:0.10975504095195211 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.0722427368164 - actor/lr:1e-06 - training/global_step:268 - training/epoch:7 - critic/score/mean:0.5687500238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5687500238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.2494964748620987 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.2494964748620987 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:586.1468505859375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.16562500596046448 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.56875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.640065789222717e-05 - timing_s/generate_sequences:64.61903381347656 - timing_s/reshard:0.7103219032287598 - timing_s/gen:67.63612715527415 - timing_s/reward:0.10515100508928299 - timing_s/old_log_prob:1.5968054626137018 - timing_s/ref:1.477188117802143 - timing_s/adv:0.008423669263720512 - timing_s/update_actor:7.991068737581372 - timing_s/step:78.83189829066396 - timing_s/stop_profile:4.653260111808777e-05 - timing_per_token_ms/adv:2.6432836695265223e-05 - timing_per_token_ms/gen:0.3605971581102974 - timing_per_token_ms/ref:0.004635304528659112 - timing_per_token_ms/update_actor:0.025075368980932003 - perf/total_num_tokens:318682 - perf/time_per_step:78.83189829066396 - perf/throughput:505.3189237321421
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1023937240242958, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1023937240242958, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 637.4156494140625, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.20624999701976776, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  51%|█████     | 269/525 [3:55:23<5:34:26, 78.39s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:36:33,864:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:36:38,699:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:36:38,701:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:36:34,357:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:36:39,248:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  51%|█████▏    | 270/525 [3:56:54<5:49:10, 82.16s/it]
[36m(TaskRunner pid=2949575)[0m step:269 - global_seqlen/min:33829 - global_seqlen/max:52867 - global_seqlen/minmax_diff:19038 - global_seqlen/balanced_min:41413 - global_seqlen/balanced_max:42217 - global_seqlen/mean:41886.0 - actor/entropy:0.06408314406871796 - actor/kl_loss:1.573055635392666 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05594070218503475 - actor/pg_clipfrac:0.04097196976654231 - actor/ppo_kl:-0.055590108096998846 - actor/pg_clipfrac_lower:0.0069554456742480395 - actor/grad_norm:172.89928913116455 - perf/mfu/actor:0.1122344805529319 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.15234756469727 - actor/lr:1e-06 - training/global_step:269 - training/epoch:7 - critic/score/mean:0.625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1023937240242958 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1023937240242958 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:637.4156494140625 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.20624999701976776 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.665451943874359e-05 - timing_s/generate_sequences:65.219970703125 - timing_s/reshard:0.7076947689056396 - timing_s/gen:67.6839352324605 - timing_s/reward:0.1119416356086731 - timing_s/old_log_prob:1.5729349665343761 - timing_s/ref:1.5113903377205133 - timing_s/adv:0.008397478610277176 - timing_s/update_actor:8.262692974880338 - timing_s/step:79.16885878890753 - timing_s/stop_profile:4.331767559051514e-05 - timing_per_token_ms/adv:2.5060517267933128e-05 - timing_per_token_ms/gen:0.33182791463801825 - timing_per_token_ms/ref:0.00451042811954028 - timing_per_token_ms/update_actor:0.024658277750562053 - perf/total_num_tokens:335088 - perf/time_per_step:79.16885878890753 - perf/throughput:529.0716658134867
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.582812488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.582812488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.24303653836250305, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.24303653836250305, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 671.265625, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21562500298023224, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:270 - global_seqlen/min:30056 - global_seqlen/max:54847 - global_seqlen/minmax_diff:24791 - global_seqlen/balanced_min:43207 - global_seqlen/balanced_max:43332 - global_seqlen/mean:43240.0 - actor/entropy:0.06543619185686111 - actor/kl_loss:2.0615167491137982 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16290261819958687 - actor/pg_clipfrac:0.037499145092442634 - actor/ppo_kl:0.3968026508378898 - actor/pg_clipfrac_lower:0.0011387455160729587 - actor/grad_norm:93.36273908615112 - perf/mfu/actor:0.1152035536832305 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.27797317504883 - actor/lr:1e-06 - training/global_step:270 - training/epoch:7 - critic/score/mean:0.582812488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.582812488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.24303653836250305 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.24303653836250305 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:671.265625 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21562500298023224 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010669976472854614 - timing_s/generate_sequences:65.24818420410156 - timing_s/reshard:0.7094460129737854 - timing_s/gen:68.07172811962664 - timing_s/reward:0.1118504386395216 - timing_s/old_log_prob:1.5979762580245733 - timing_s/ref:1.4735706634819508 - timing_s/adv:0.008012868463993073 - timing_s/update_actor:8.307043887674809 - timing_s/save_checkpoint:10.606070298701525 - timing_s/step:90.19259949214756 - timing_s/stop_profile:5.091913044452667e-05 - timing_per_token_ms/adv:2.316393519886989e-05 - timing_per_token_ms/gen:0.31690010995845835 - timing_per_token_ms/ref:0.004259859688604159 - timing_per_token_ms/update_actor:0.024014349814046047 - perf/total_num_tokens:345920 - perf/time_per_step:90.19259949214756 - perf/throughput:479.41849157773305
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5718749761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5718749761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.23311294615268707, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.23311294615268707, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 542.4718627929688, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.16562500596046448, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.571875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  52%|█████▏    | 271/525 [3:58:12<5:42:01, 80.80s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:36:40,923:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:36:40,926:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_270/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  52%|█████▏    | 272/525 [3:59:29<5:35:26, 79.55s/it]
[36m(TaskRunner pid=2949575)[0m step:271 - global_seqlen/min:34363 - global_seqlen/max:43458 - global_seqlen/minmax_diff:9095 - global_seqlen/balanced_min:37827 - global_seqlen/balanced_max:38622 - global_seqlen/mean:38097.0 - actor/entropy:0.0675147995352745 - actor/kl_loss:2.412804052233696 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.350059712678194 - actor/pg_clipfrac:0.028089041321072726 - actor/ppo_kl:-1.4063632509249147 - actor/pg_clipfrac_lower:0.06277817632071674 - actor/grad_norm:152.16636848449707 - perf/mfu/actor:0.1017858606700727 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.23724746704102 - actor/lr:1e-06 - training/global_step:271 - training/epoch:7 - critic/score/mean:0.5718749761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5718749761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.23311294615268707 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.23311294615268707 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:542.4718627929688 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.16562500596046448 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.571875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.720718324184418e-05 - timing_s/generate_sequences:64.10568237304688 - timing_s/reshard:0.7008534669876099 - timing_s/gen:66.31768740527332 - timing_s/reward:0.09910072945058346 - timing_s/old_log_prob:1.4910417161881924 - timing_s/ref:1.423667972907424 - timing_s/adv:0.008199013769626617 - timing_s/update_actor:8.236393576487899 - timing_s/step:77.59824118204415 - timing_s/stop_profile:4.3723732233047485e-05 - timing_per_token_ms/adv:2.690176972473757e-05 - timing_per_token_ms/gen:0.3820341342884903 - timing_per_token_ms/ref:0.004671194493357167 - timing_per_token_ms/update_actor:0.027024416543585776 - perf/total_num_tokens:304776 - perf/time_per_step:77.59824118204415 - perf/throughput:490.95184916144024
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8828125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8828125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3318687975406647, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3318687975406647, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 513.6343994140625, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.13437500596046448, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:272 - global_seqlen/min:28858 - global_seqlen/max:42120 - global_seqlen/minmax_diff:13262 - global_seqlen/balanced_min:36855 - global_seqlen/balanced_max:36907 - global_seqlen/mean:36899.75 - actor/entropy:0.0939662978053093 - actor/kl_loss:1.9944433704018594 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22413875106722117 - actor/pg_clipfrac:0.053930713096633554 - actor/ppo_kl:-0.5149238312995295 - actor/pg_clipfrac_lower:0.016499263793230058 - actor/grad_norm:143.70643281936646 - perf/mfu/actor:0.10433592733999528 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.2806167602539 - actor/lr:1e-06 - training/global_step:272 - training/epoch:7 - critic/score/mean:0.8828125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8828125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3318687975406647 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3318687975406647 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:513.6343994140625 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.13437500596046448 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.618645370006561e-05 - timing_s/generate_sequences:64.15792083740234 - timing_s/reshard:0.694088339805603 - timing_s/gen:65.87320679053664 - timing_s/reward:0.10489190183579922 - timing_s/old_log_prob:1.4799967352300882 - timing_s/ref:1.4076811876147985 - timing_s/adv:0.00827968493103981 - timing_s/update_actor:7.743806334212422 - timing_s/step:76.63496534712613 - timing_s/stop_profile:4.6191737055778503e-05 - timing_per_token_ms/adv:2.804790320747366e-05 - timing_per_token_ms/gen:0.4007788053913389 - timing_per_token_ms/ref:0.004768600016310404 - timing_per_token_ms/update_actor:0.026232584008741327 - perf/total_num_tokens:295198 - perf/time_per_step:76.63496534712613 - perf/throughput:481.50018510295797
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.785937488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.785937488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4082372486591339, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4082372486591339, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 645.6218872070312, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21250000596046448, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  52%|█████▏    | 273/525 [4:00:48<5:34:26, 79.63s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  52%|█████▏    | 274/525 [4:02:05<5:29:04, 78.66s/it]
[36m(TaskRunner pid=2949575)[0m step:273 - global_seqlen/min:33318 - global_seqlen/max:50202 - global_seqlen/minmax_diff:16884 - global_seqlen/balanced_min:41242 - global_seqlen/balanced_max:42383 - global_seqlen/mean:42218.625 - actor/entropy:0.07355005294084549 - actor/kl_loss:1.9740531653165818 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10107160955667496 - actor/pg_clipfrac:0.054834691854193804 - actor/ppo_kl:0.29497558438092286 - actor/pg_clipfrac_lower:0.0020832022186368705 - actor/grad_norm:73.17014503479004 - perf/mfu/actor:0.11682763629466386 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.28260040283203 - actor/lr:1e-06 - training/global_step:273 - training/epoch:7 - critic/score/mean:0.785937488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.785937488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4082372486591339 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4082372486591339 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:645.6218872070312 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21250000596046448 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.192153811454773e-05 - timing_s/generate_sequences:64.79650115966797 - timing_s/reshard:0.9214304089546204 - timing_s/gen:68.68622197024524 - timing_s/reward:0.11208918876945972 - timing_s/old_log_prob:1.5490276161581278 - timing_s/ref:1.4455482009798288 - timing_s/adv:0.008188799023628235 - timing_s/update_actor:7.981262624263763 - timing_s/step:79.79949712008238 - timing_s/stop_profile:4.567764699459076e-05 - timing_per_token_ms/adv:2.424522063315727e-05 - timing_per_token_ms/gen:0.33246154129615946 - timing_per_token_ms/ref:0.004279948130060574 - timing_per_token_ms/update_actor:0.023630751310185265 - perf/total_num_tokens:337749 - perf/time_per_step:79.79949712008238 - perf/throughput:529.058785125793
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1359374523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1359374523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.336504191160202, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.336504191160202, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 453.8343811035156, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.109375, 'prompt_length/mean': 408.421875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:274 - global_seqlen/min:28140 - global_seqlen/max:45190 - global_seqlen/minmax_diff:17050 - global_seqlen/balanced_min:33899 - global_seqlen/balanced_max:35018 - global_seqlen/mean:34490.25 - actor/entropy:0.11693728715181351 - actor/kl_loss:2.0162274524569512 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09114453345537185 - actor/pg_clipfrac:0.06092146307928488 - actor/ppo_kl:-0.5920867551001721 - actor/pg_clipfrac_lower:0.009650893090292812 - actor/grad_norm:72.49392414093018 - perf/mfu/actor:0.09706617163041069 - perf/max_memory_allocated_gb:69.26846504211426 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.24935531616211 - actor/lr:1e-06 - training/global_step:274 - training/epoch:7 - critic/score/mean:1.1359374523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1359374523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.336504191160202 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.336504191160202 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:453.8343811035156 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:408.421875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.876435458660126e-05 - timing_s/generate_sequences:63.66355514526367 - timing_s/reshard:0.6914629340171814 - timing_s/gen:65.74079014547169 - timing_s/reward:0.09018838964402676 - timing_s/old_log_prob:1.3992214240133762 - timing_s/ref:1.39791763946414 - timing_s/adv:0.008365025743842125 - timing_s/update_actor:7.738799795508385 - timing_s/step:76.39246954768896 - timing_s/stop_profile:4.456937313079834e-05 - timing_per_token_ms/adv:3.031663203311851e-05 - timing_per_token_ms/gen:0.45267608740435106 - timing_per_token_ms/ref:0.0050663507783509105 - timing_per_token_ms/update_actor:0.02804705603579412 - perf/total_num_tokens:275922 - perf/time_per_step:76.39246954768896 - perf/throughput:451.48756420904846
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7328125238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7328125238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.43957045674324036, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.43957045674324036, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 771.5687255859375, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.28437501192092896, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7328125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  52%|█████▏    | 275/525 [4:03:25<5:29:07, 78.99s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  53%|█████▎    | 276/525 [4:04:44<5:28:42, 79.21s/it]
[36m(TaskRunner pid=2949575)[0m step:275 - global_seqlen/min:38321 - global_seqlen/max:57737 - global_seqlen/minmax_diff:19416 - global_seqlen/balanced_min:46691 - global_seqlen/balanced_max:47813 - global_seqlen/mean:47252.125 - actor/entropy:0.06302397698163986 - actor/kl_loss:1.6310885481536388 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.221145086735487 - actor/pg_clipfrac:0.07400088817812503 - actor/ppo_kl:0.050667573641931085 - actor/pg_clipfrac_lower:0.004972675201133825 - actor/grad_norm:88.46263551712036 - perf/mfu/actor:0.12689651129195986 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.2237319946289 - actor/lr:1e-06 - training/global_step:275 - training/epoch:7 - critic/score/mean:0.7328125238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7328125238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.43957045674324036 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.43957045674324036 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:771.5687255859375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.28437501192092896 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7328125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.958950638771057e-05 - timing_s/generate_sequences:65.57205200195312 - timing_s/reshard:0.6920550465583801 - timing_s/gen:67.92345409281552 - timing_s/reward:0.1261173002421856 - timing_s/old_log_prob:1.8815981894731522 - timing_s/ref:1.507734289392829 - timing_s/adv:0.008373526856303215 - timing_s/update_actor:8.275059962645173 - timing_s/step:79.73976619541645 - timing_s/stop_profile:4.7147274017333984e-05 - timing_per_token_ms/adv:2.2151191232942474e-05 - timing_per_token_ms/gen:0.27510289140150956 - timing_per_token_ms/ref:0.003988535672715325 - timing_per_token_ms/update_actor:0.021890708520106696 - perf/total_num_tokens:378017 - perf/time_per_step:79.73976619541645 - perf/throughput:592.5791766707753
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.729687511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.729687511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.30794620513916016, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.30794620513916016, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 689.4593505859375, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.24687500298023224, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:276 - global_seqlen/min:35677 - global_seqlen/max:62610 - global_seqlen/minmax_diff:26933 - global_seqlen/balanced_min:43980 - global_seqlen/balanced_max:43981 - global_seqlen/mean:43980.875 - actor/entropy:0.061472583562135696 - actor/kl_loss:1.0908634960651398 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.24432090492919087 - actor/pg_clipfrac:0.07366950770956464 - actor/ppo_kl:-0.4929631867071521 - actor/pg_clipfrac_lower:0.013327622041106223 - actor/grad_norm:89.9367778301239 - perf/mfu/actor:0.11897639123788116 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:100.1171875 - perf/cpu_memory_used_gb:97.19320297241211 - actor/lr:1e-06 - training/global_step:276 - training/epoch:7 - critic/score/mean:0.729687511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.729687511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.30794620513916016 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.30794620513916016 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:689.4593505859375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.24687500298023224 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.911453187465668e-05 - timing_s/generate_sequences:64.79164123535156 - timing_s/reshard:0.729507565498352 - timing_s/gen:68.22457639873028 - timing_s/reward:0.11594739928841591 - timing_s/old_log_prob:1.63573251478374 - timing_s/ref:1.5073975641280413 - timing_s/adv:0.008399147540330887 - timing_s/update_actor:8.189100602641702 - timing_s/step:79.69846667721868 - timing_s/stop_profile:4.736892879009247e-05 - timing_per_token_ms/adv:2.3871590607084576e-05 - timing_per_token_ms/gen:0.3092304042512035 - timing_per_token_ms/ref:0.004284241628116884 - timing_per_token_ms/update_actor:0.02327460686787638 - perf/total_num_tokens:351847 - perf/time_per_step:79.69846667721868 - perf/throughput:551.8409178199619
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7562500238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7562500238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.32521510124206543, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.32521510124206543, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 749.9406127929688, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.26249998807907104, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.75625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  53%|█████▎    | 277/525 [4:06:03<5:26:54, 79.09s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  53%|█████▎    | 278/525 [4:07:21<5:23:46, 78.65s/it]
[36m(TaskRunner pid=2949575)[0m step:277 - global_seqlen/min:35700 - global_seqlen/max:52947 - global_seqlen/minmax_diff:17247 - global_seqlen/balanced_min:45712 - global_seqlen/balanced_max:46514 - global_seqlen/mean:46395.75 - actor/entropy:0.06913992762565613 - actor/kl_loss:0.8011692702770233 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.3421639653854072 - actor/pg_clipfrac:0.027572950324974956 - actor/ppo_kl:-0.2307243245188147 - actor/pg_clipfrac_lower:0.009739972732495517 - actor/grad_norm:35.71814954280853 - perf/mfu/actor:0.1230403281823953 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:101.150390625 - perf/cpu_memory_used_gb:97.16344451904297 - actor/lr:1e-06 - training/global_step:277 - training/epoch:7 - critic/score/mean:0.7562500238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7562500238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.32521510124206543 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.32521510124206543 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:749.9406127929688 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.26249998807907104 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.75625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.373335003852844e-05 - timing_s/generate_sequences:64.88066101074219 - timing_s/reshard:0.7532923817634583 - timing_s/gen:67.10811354406178 - timing_s/reward:0.12102971598505974 - timing_s/old_log_prob:1.6762611363083124 - timing_s/ref:1.4989938493818045 - timing_s/adv:0.008376166224479675 - timing_s/update_actor:8.367524106055498 - timing_s/step:78.7974952030927 - timing_s/stop_profile:4.429556429386139e-05 - timing_per_token_ms/adv:2.256717001147647e-05 - timing_per_token_ms/gen:0.2796392778764226 - timing_per_token_ms/ref:0.004038607656363472 - timing_per_token_ms/update_actor:0.022543886309779177 - perf/total_num_tokens:371166 - perf/time_per_step:78.7974952030927 - perf/throughput:588.7972692586176
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9624999761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9624999761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4280497133731842, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4280497133731842, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 581.0531005859375, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.16562500596046448, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:278 - global_seqlen/min:32929 - global_seqlen/max:44556 - global_seqlen/minmax_diff:11627 - global_seqlen/balanced_min:38835 - global_seqlen/balanced_max:39897 - global_seqlen/mean:39631.5 - actor/entropy:0.12223522365093231 - actor/kl_loss:0.7314378134906292 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.06216084472835064 - actor/pg_clipfrac:0.02352014018688351 - actor/ppo_kl:-0.06540448410127056 - actor/pg_clipfrac_lower:0.0009754333063028753 - actor/grad_norm:19.056613445281982 - perf/mfu/actor:0.11057669100541337 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:96.99780654907227 - actor/lr:1e-06 - training/global_step:278 - training/epoch:7 - critic/score/mean:0.9624999761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9624999761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4280497133731842 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4280497133731842 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:581.0531005859375 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.16562500596046448 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010405294597148895 - timing_s/generate_sequences:64.15816497802734 - timing_s/reshard:0.7283201217651367 - timing_s/gen:66.38166063278913 - timing_s/reward:0.10218872502446175 - timing_s/old_log_prob:1.5034274607896805 - timing_s/ref:1.4362409468740225 - timing_s/adv:0.008312320336699486 - timing_s/update_actor:7.869048707187176 - timing_s/step:77.31810270808637 - timing_s/stop_profile:4.5146793127059937e-05 - timing_per_token_ms/adv:2.6217530047750798e-05 - timing_per_token_ms/gen:0.3570115718377146 - timing_per_token_ms/ref:0.004529985449938882 - timing_per_token_ms/update_actor:0.024819426173584066 - perf/total_num_tokens:317052 - perf/time_per_step:77.31810270808637 - perf/throughput:512.5772440333706
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8921874761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8921874761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3609221279621124, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3609221279621124, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 648.7249755859375, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21875, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  53%|█████▎    | 279/525 [4:08:39<5:22:27, 78.65s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:49:48,596:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:49:53,314:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:49:53,315:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 03:49:48,871:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 03:49:53,860:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  53%|█████▎    | 280/525 [4:10:09<5:34:26, 81.90s/it]
[36m(TaskRunner pid=2949575)[0m step:279 - global_seqlen/min:35049 - global_seqlen/max:54313 - global_seqlen/minmax_diff:19264 - global_seqlen/balanced_min:41580 - global_seqlen/balanced_max:42587 - global_seqlen/mean:42347.125 - actor/entropy:0.0924658477306366 - actor/kl_loss:0.7732376895844937 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.01373136816546321 - actor/pg_clipfrac:0.023545155680039898 - actor/ppo_kl:-0.06624493501585675 - actor/pg_clipfrac_lower:0.0009717705601360649 - actor/grad_norm:17.196012020111084 - perf/mfu/actor:0.11320427765769685 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.04106140136719 - actor/lr:1e-06 - training/global_step:279 - training/epoch:7 - critic/score/mean:0.8921874761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8921874761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3609221279621124 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3609221279621124 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:648.7249755859375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21875 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.369982242584229e-05 - timing_s/generate_sequences:65.27498626708984 - timing_s/reshard:0.6988880634307861 - timing_s/gen:67.08148461394012 - timing_s/reward:0.10993757285177708 - timing_s/old_log_prob:1.6759124770760536 - timing_s/ref:1.48461221344769 - timing_s/adv:0.008357362821698189 - timing_s/update_actor:8.260135643184185 - timing_s/step:78.63772328197956 - timing_s/stop_profile:4.526786506175995e-05 - timing_per_token_ms/adv:2.466921550665538e-05 - timing_per_token_ms/gen:0.323140991049463 - timing_per_token_ms/ref:0.004382269792363974 - timing_per_token_ms/update_actor:0.02438222088035547 - perf/total_num_tokens:338777 - perf/time_per_step:78.63772328197956 - perf/throughput:538.5090416230828
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.859375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.859375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3353310227394104, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.3353310227394104, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 675.9406127929688, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.234375, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:280 - global_seqlen/min:35490 - global_seqlen/max:48479 - global_seqlen/minmax_diff:12989 - global_seqlen/balanced_min:43023 - global_seqlen/balanced_max:44040 - global_seqlen/mean:43405.125 - actor/entropy:0.09407591819763184 - actor/kl_loss:0.7214589148759842 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.027286733873188494 - actor/pg_clipfrac:0.01608652669383446 - actor/ppo_kl:-0.03690158340614289 - actor/pg_clipfrac_lower:0.00136043134261854 - actor/grad_norm:30.086581230163574 - perf/mfu/actor:0.11561981912461987 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.02801895141602 - actor/lr:1e-06 - training/global_step:280 - training/epoch:7 - critic/score/mean:0.859375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.859375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3353310227394104 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3353310227394104 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:675.9406127929688 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.234375 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.468702435493469e-05 - timing_s/generate_sequences:64.76107025146484 - timing_s/reshard:0.702561616897583 - timing_s/gen:67.50715807080269 - timing_s/reward:0.11337894201278687 - timing_s/old_log_prob:1.6164088528603315 - timing_s/ref:1.4835513271391392 - timing_s/adv:0.008364060893654823 - timing_s/update_actor:8.304565602913499 - timing_s/save_checkpoint:10.429872395470738 - timing_s/step:89.48051516711712 - timing_s/stop_profile:5.3454190492630005e-05 - timing_per_token_ms/adv:2.40871927383426e-05 - timing_per_token_ms/gen:0.3120982245611564 - timing_per_token_ms/ref:0.004272396770943349 - timing_per_token_ms/update_actor:0.02391585556692182 - perf/total_num_tokens:347241 - perf/time_per_step:89.48051516711712 - perf/throughput:485.0790691016361
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.895312488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.895312488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.36237257719039917, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.36237257719039917, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 660.3531494140625, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21875, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  54%|█████▎    | 281/525 [4:11:30<5:32:15, 81.70s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:49:55,461:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 03:49:55,464:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_280/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  54%|█████▎    | 282/525 [4:12:49<5:27:07, 80.77s/it]
[36m(TaskRunner pid=2949575)[0m step:281 - global_seqlen/min:32293 - global_seqlen/max:55325 - global_seqlen/minmax_diff:23032 - global_seqlen/balanced_min:42003 - global_seqlen/balanced_max:43077 - global_seqlen/mean:42807.875 - actor/entropy:0.08986654877662659 - actor/kl_loss:0.8316067911684513 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14687054976820946 - actor/pg_clipfrac:0.029091316560516133 - actor/ppo_kl:0.1816669243909473 - actor/pg_clipfrac_lower:0.0003469086834229529 - actor/grad_norm:77.88476133346558 - perf/mfu/actor:0.11610402674689596 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.00003814697266 - actor/lr:1e-06 - training/global_step:281 - training/epoch:8 - critic/score/mean:0.895312488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.895312488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.36237257719039917 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.36237257719039917 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:660.3531494140625 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21875 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0003291964530944824 - timing_s/generate_sequences:65.57518768310547 - timing_s/reshard:0.7773109674453735 - timing_s/gen:67.78581743873656 - timing_s/reward:0.11034896411001682 - timing_s/old_log_prob:1.6371470000594854 - timing_s/ref:1.4348050504922867 - timing_s/adv:0.008865678682923317 - timing_s/update_actor:8.143464477732778 - timing_s/step:79.15016233734787 - timing_s/stop_profile:4.5102089643478394e-05 - timing_per_token_ms/adv:2.588798989357483e-05 - timing_per_token_ms/gen:0.32078394343337396 - timing_per_token_ms/ref:0.004189664432339513 - timing_per_token_ms/update_actor:0.02377910745900368 - perf/total_num_tokens:342463 - perf/time_per_step:79.15016233734787 - perf/throughput:540.8438054434746
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8609374761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8609374761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.5053608417510986, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.5053608417510986, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 679.7999877929688, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.22812500596046448, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8609375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:282 - global_seqlen/min:36484 - global_seqlen/max:53660 - global_seqlen/minmax_diff:17176 - global_seqlen/balanced_min:43372 - global_seqlen/balanced_max:44533 - global_seqlen/mean:43581.375 - actor/entropy:0.09676720947027206 - actor/kl_loss:0.506231751292944 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.25482875797897575 - actor/pg_clipfrac:0.02165347303962335 - actor/ppo_kl:-0.07302636241286961 - actor/pg_clipfrac_lower:0.0008311713667353615 - actor/grad_norm:13.759866952896118 - perf/mfu/actor:0.11937512868005573 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.11931610107422 - actor/lr:1e-06 - training/global_step:282 - training/epoch:8 - critic/score/mean:0.8609374761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8609374761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.5053608417510986 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.5053608417510986 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:679.7999877929688 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.22812500596046448 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8609375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011195428669452667 - timing_s/generate_sequences:64.8592300415039 - timing_s/reshard:0.7134003639221191 - timing_s/gen:67.02759494632483 - timing_s/reward:0.11321726255118847 - timing_s/old_log_prob:1.4981692507863045 - timing_s/ref:1.427869450300932 - timing_s/adv:0.00795300304889679 - timing_s/update_actor:8.070801746100187 - timing_s/step:78.1687137670815 - timing_s/stop_profile:4.462525248527527e-05 - timing_per_token_ms/adv:2.2810785137277075e-05 - timing_per_token_ms/gen:0.308121850849169 - timing_per_token_ms/ref:0.0040954118883953635 - timing_per_token_ms/update_actor:0.023148655090908063 - perf/total_num_tokens:348651 - perf/time_per_step:78.1687137670815 - perf/throughput:557.5296419723493
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9828125238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9828125238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.42106813192367554, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.42106813192367554, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 639.8718872070312, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.20000000298023224, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  54%|█████▍    | 283/525 [4:14:07<5:22:26, 79.94s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  54%|█████▍    | 284/525 [4:15:26<5:20:36, 79.82s/it]
[36m(TaskRunner pid=2949575)[0m step:283 - global_seqlen/min:35755 - global_seqlen/max:49584 - global_seqlen/minmax_diff:13829 - global_seqlen/balanced_min:41971 - global_seqlen/balanced_max:41972 - global_seqlen/mean:41971.125 - actor/entropy:0.10981915891170502 - actor/kl_loss:0.5182031907141209 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.043229198269546035 - actor/pg_clipfrac:0.016210796614177524 - actor/ppo_kl:-0.011038355139072564 - actor/pg_clipfrac_lower:0.0002657053613802418 - actor/grad_norm:17.314168214797974 - perf/mfu/actor:0.11597037525109868 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.1449203491211 - actor/lr:1e-06 - training/global_step:283 - training/epoch:8 - critic/score/mean:0.9828125238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9828125238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.42106813192367554 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.42106813192367554 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:639.8718872070312 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.20000000298023224 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.31229442358017e-05 - timing_s/generate_sequences:64.39655303955078 - timing_s/reshard:0.6840293407440186 - timing_s/gen:66.78188713826239 - timing_s/reward:0.10995840467512608 - timing_s/old_log_prob:1.6365205738693476 - timing_s/ref:1.4578830860555172 - timing_s/adv:0.008257105946540833 - timing_s/update_actor:7.973877415060997 - timing_s/step:77.99119147099555 - timing_s/stop_profile:4.2343512177467346e-05 - timing_per_token_ms/adv:2.4591626822430995e-05 - timing_per_token_ms/gen:0.32614872673856776 - timing_per_token_ms/ref:0.0043419228280619036 - timing_per_token_ms/update_actor:0.0237481048430945 - perf/total_num_tokens:335769 - perf/time_per_step:77.99119147099555 - perf/throughput:538.1521195968497
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.800000011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.800000011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4808920621871948, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4808920621871948, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 768.9156494140625, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.2718749940395355, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:284 - global_seqlen/min:33728 - global_seqlen/max:58212 - global_seqlen/minmax_diff:24484 - global_seqlen/balanced_min:46384 - global_seqlen/balanced_max:47251 - global_seqlen/mean:47141.625 - actor/entropy:0.0859825387597084 - actor/kl_loss:0.4172018066048622 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05464327009394765 - actor/pg_clipfrac:0.0149582279365859 - actor/ppo_kl:-0.026591399128665216 - actor/pg_clipfrac_lower:1.220703125e-05 - actor/grad_norm:10.616413235664368 - perf/mfu/actor:0.1170474943135943 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.04608535766602 - actor/lr:1e-06 - training/global_step:284 - training/epoch:8 - critic/score/mean:0.800000011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.800000011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4808920621871948 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4808920621871948 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:768.9156494140625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.2718749940395355 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.910335600376129e-05 - timing_s/generate_sequences:64.93443298339844 - timing_s/reshard:0.7189905047416687 - timing_s/gen:67.17826901376247 - timing_s/reward:0.12430452927947044 - timing_s/old_log_prob:1.7238237299025059 - timing_s/ref:1.5278608780354261 - timing_s/adv:0.008140366524457932 - timing_s/update_actor:8.937014827504754 - timing_s/step:79.51633371785283 - timing_s/stop_profile:4.4751912355422974e-05 - timing_per_token_ms/adv:2.158486932848075e-05 - timing_per_token_ms/gen:0.2730235722131511 - timing_per_token_ms/ref:0.004051252152517617 - timing_per_token_ms/update_actor:0.02369724958437674 - perf/total_num_tokens:377133 - perf/time_per_step:79.51633371785283 - perf/throughput:592.8546098122714
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.973437488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.973437488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4186113178730011, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4186113178730011, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 657.484375, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.19374999403953552, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  54%|█████▍    | 285/525 [4:16:46<5:18:56, 79.74s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  54%|█████▍    | 286/525 [4:18:04<5:15:34, 79.22s/it]
[36m(TaskRunner pid=2949575)[0m step:285 - global_seqlen/min:36618 - global_seqlen/max:52885 - global_seqlen/minmax_diff:16267 - global_seqlen/balanced_min:41950 - global_seqlen/balanced_max:42889 - global_seqlen/mean:42653.75 - actor/entropy:0.11430592089891434 - actor/kl_loss:0.5448079667985439 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.364062709081918 - actor/pg_clipfrac:0.012189404972014017 - actor/ppo_kl:0.0008935239131233174 - actor/pg_clipfrac_lower:0.0010091580159496516 - actor/grad_norm:11.491419613361359 - perf/mfu/actor:0.11692941244912133 - perf/max_memory_allocated_gb:70.1733021736145 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.0334358215332 - actor/lr:1e-06 - training/global_step:285 - training/epoch:8 - critic/score/mean:0.973437488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.973437488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4186113178730011 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4186113178730011 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:657.484375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.19374999403953552 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.435787796974182e-05 - timing_s/generate_sequences:64.3888931274414 - timing_s/reshard:0.7422923445701599 - timing_s/gen:68.22461442649364 - timing_s/reward:0.11150341667234898 - timing_s/old_log_prob:1.6667233761399984 - timing_s/ref:1.462256159633398 - timing_s/adv:0.007905134931206703 - timing_s/update_actor:8.030723337084055 - timing_s/step:79.52084690146148 - timing_s/stop_profile:4.6897679567337036e-05 - timing_per_token_ms/adv:2.316658831640449e-05 - timing_per_token_ms/gen:0.3242691814277604 - timing_per_token_ms/ref:0.004285250885424488 - timing_per_token_ms/update_actor:0.02353463451948555 - perf/total_num_tokens:341230 - perf/time_per_step:79.52084690146148 - perf/throughput:536.3845037120208
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.979687511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.979687511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.37599241733551025, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.37599241733551025, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 677.3375244140625, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.21250000596046448, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:286 - global_seqlen/min:30337 - global_seqlen/max:55826 - global_seqlen/minmax_diff:25489 - global_seqlen/balanced_min:42924 - global_seqlen/balanced_max:43962 - global_seqlen/mean:43456.625 - actor/entropy:0.10534442216157913 - actor/kl_loss:0.5122275903820992 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11999600064009427 - actor/pg_clipfrac:0.018444305821321904 - actor/ppo_kl:0.024482037254686163 - actor/pg_clipfrac_lower:0.000527990487171337 - actor/grad_norm:22.52213704586029 - perf/mfu/actor:0.11992746191256162 - perf/max_memory_allocated_gb:70.51211166381836 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.0799560546875 - actor/lr:1e-06 - training/global_step:286 - training/epoch:8 - critic/score/mean:0.979687511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.979687511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.37599241733551025 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.37599241733551025 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:677.3375244140625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.21250000596046448 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.07406210899353e-05 - timing_s/generate_sequences:64.42638397216797 - timing_s/reshard:0.696801483631134 - timing_s/gen:66.74137232080102 - timing_s/reward:0.11354574747383595 - timing_s/old_log_prob:1.6550555173307657 - timing_s/ref:1.487322436645627 - timing_s/adv:0.008138731122016907 - timing_s/update_actor:7.993916671723127 - timing_s/step:78.01619694009423 - timing_s/stop_profile:4.33456152677536e-05 - timing_per_token_ms/adv:2.341050162667058e-05 - timing_per_token_ms/gen:0.3079215140199726 - timing_per_token_ms/ref:0.0042781809351440285 - timing_per_token_ms/update_actor:0.02299395279696458 - perf/total_num_tokens:347653 - perf/time_per_step:78.01619694009423 - perf/throughput:557.0205509167378
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.964062511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.964062511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.42861273884773254, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.42861273884773254, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 693.3531494140625, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21250000596046448, 'prompt_length/mean': 410.5, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  55%|█████▍    | 287/525 [4:19:23<5:13:49, 79.11s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  55%|█████▍    | 288/525 [4:20:39<5:09:20, 78.31s/it]
[36m(TaskRunner pid=2949575)[0m step:287 - global_seqlen/min:36481 - global_seqlen/max:55714 - global_seqlen/minmax_diff:19233 - global_seqlen/balanced_min:43667 - global_seqlen/balanced_max:44649 - global_seqlen/mean:44154.125 - actor/entropy:0.10597129911184311 - actor/kl_loss:0.47664695493876935 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1665039911866188 - actor/pg_clipfrac:0.015604587554116733 - actor/ppo_kl:-0.0403020264551742 - actor/pg_clipfrac_lower:0.0021063819265691565 - actor/grad_norm:31.46702218055725 - perf/mfu/actor:0.11891678628658177 - perf/max_memory_allocated_gb:70.51211166381836 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.0644416809082 - actor/lr:1e-06 - training/global_step:287 - training/epoch:8 - critic/score/mean:0.964062511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.964062511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.42861273884773254 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.42861273884773254 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:693.3531494140625 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21250000596046448 - prompt_length/mean:410.5 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.333156049251556e-05 - timing_s/generate_sequences:64.71585083007812 - timing_s/reshard:0.7009940147399902 - timing_s/gen:67.50056739524007 - timing_s/reward:0.11562108993530273 - timing_s/old_log_prob:1.5635674055665731 - timing_s/ref:1.447407415136695 - timing_s/adv:0.008106503635644913 - timing_s/update_actor:8.191284390166402 - timing_s/step:78.84266273491085 - timing_s/stop_profile:4.354119300842285e-05 - timing_per_token_ms/adv:2.294945159609921e-05 - timing_per_token_ms/gen:0.304230651747802 - timing_per_token_ms/ref:0.004097599644248116 - timing_per_token_ms/update_actor:0.023189465282593646 - perf/total_num_tokens:353233 - perf/time_per_step:78.84266273491085 - perf/throughput:560.0283332446221
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.123437523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.123437523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3729357123374939, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3729357123374939, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 541.4749755859375, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.140625, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1234375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:288 - global_seqlen/min:31222 - global_seqlen/max:45533 - global_seqlen/minmax_diff:14311 - global_seqlen/balanced_min:37360 - global_seqlen/balanced_max:38420 - global_seqlen/mean:38022.125 - actor/entropy:0.13421909511089325 - actor/kl_loss:0.5343976639211178 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10511934086680412 - actor/pg_clipfrac:0.0100361219025217 - actor/ppo_kl:0.032447160412277756 - actor/pg_clipfrac_lower:0.0008127034408971668 - actor/grad_norm:15.813502669334412 - perf/mfu/actor:0.10650234240811977 - perf/max_memory_allocated_gb:70.51211166381836 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:96.93103408813477 - actor/lr:1e-06 - training/global_step:288 - training/epoch:8 - critic/score/mean:1.123437523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.123437523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3729357123374939 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3729357123374939 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:541.4749755859375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.140625 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1234375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.206123650074005e-05 - timing_s/generate_sequences:63.51892852783203 - timing_s/reshard:0.7688512802124023 - timing_s/gen:65.63746592216194 - timing_s/reward:0.09972071088850498 - timing_s/old_log_prob:1.4480644538998604 - timing_s/ref:1.4091239124536514 - timing_s/adv:0.007968658581376076 - timing_s/update_actor:7.807656031101942 - timing_s/step:76.42635120637715 - timing_s/stop_profile:4.75514680147171e-05 - timing_per_token_ms/adv:2.6197439587398376e-05 - timing_per_token_ms/gen:0.37881172908584154 - timing_per_token_ms/ref:0.004632578769774347 - timing_per_token_ms/update_actor:0.025668134116326815 - perf/total_num_tokens:304177 - perf/time_per_step:76.42635120637715 - perf/throughput:497.5001998633603
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.25, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.25, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.31718671321868896, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.31718671321868896, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 491.671875, 'response_length/max': 2048.0, 'response_length/min': 6.0, 'response_length/clip_ratio': 0.10000000149011612, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.25, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  55%|█████▌    | 289/525 [4:21:57<5:07:22, 78.15s/it]
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 04:03:06,297:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 04:03:11,044:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 04:03:11,047:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 04:03:06,674:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:03:11,752:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  55%|█████▌    | 290/525 [4:23:27<5:19:46, 81.64s/it]
[36m(TaskRunner pid=2949575)[0m step:289 - global_seqlen/min:29015 - global_seqlen/max:43468 - global_seqlen/minmax_diff:14453 - global_seqlen/balanced_min:36073 - global_seqlen/balanced_max:36074 - global_seqlen/mean:36073.75 - actor/entropy:0.18937018513679504 - actor/kl_loss:0.43628825843334196 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04089637752622366 - actor/pg_clipfrac:0.007672759951674379 - actor/ppo_kl:0.09582805973950599 - actor/pg_clipfrac_lower:0.00041627334430813787 - actor/grad_norm:11.181150138378143 - perf/mfu/actor:0.10158258404928745 - perf/max_memory_allocated_gb:70.51211166381836 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.12022399902344 - actor/lr:1e-06 - training/global_step:289 - training/epoch:8 - critic/score/mean:1.25 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.25 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.31718671321868896 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.31718671321868896 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:491.671875 - response_length/max:2048.0 - response_length/min:6.0 - response_length/clip_ratio:0.10000000149011612 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.25 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010930374264717102 - timing_s/generate_sequences:64.00437927246094 - timing_s/reshard:0.6731700301170349 - timing_s/gen:66.41871139407158 - timing_s/reward:0.0928830374032259 - timing_s/old_log_prob:1.548445176333189 - timing_s/ref:1.4217442590743303 - timing_s/adv:0.007892090827226639 - timing_s/update_actor:7.726873772218823 - timing_s/step:77.23306609131396 - timing_s/stop_profile:4.242919385433197e-05 - timing_per_token_ms/adv:2.7347069639372947e-05 - timing_per_token_ms/gen:0.42214835474669704 - timing_per_token_ms/ref:0.004926519488112306 - timing_per_token_ms/update_actor:0.026774572134234807 - perf/total_num_tokens:288590 - perf/time_per_step:77.23306609131396 - perf/throughput:467.0764974855381
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7953125238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7953125238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.39940425753593445, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.39940425753593445, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 761.0968627929688, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.26249998807907104, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:290 - global_seqlen/min:41536 - global_seqlen/max:57460 - global_seqlen/minmax_diff:15924 - global_seqlen/balanced_min:46300 - global_seqlen/balanced_max:47322 - global_seqlen/mean:46811.375 - actor/entropy:0.11195039004087448 - actor/kl_loss:0.35337056443095205 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2020672842860222 - actor/pg_clipfrac:0.014751050295308233 - actor/ppo_kl:-0.03364868683856912 - actor/pg_clipfrac_lower:0.002520629408536479 - actor/grad_norm:14.04285478591919 - perf/mfu/actor:0.12450518934668446 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.17638397216797 - actor/lr:1e-06 - training/global_step:290 - training/epoch:8 - critic/score/mean:0.7953125238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7953125238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.39940425753593445 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.39940425753593445 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:761.0968627929688 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.26249998807907104 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010884925723075867 - timing_s/generate_sequences:65.33035278320312 - timing_s/reshard:0.7353771328926086 - timing_s/gen:67.27808136120439 - timing_s/reward:0.12195954844355583 - timing_s/old_log_prob:1.7028279937803745 - timing_s/ref:1.5019625145941973 - timing_s/adv:0.011777697131037712 - timing_s/update_actor:8.339506726711988 - timing_s/save_checkpoint:10.438384499400854 - timing_s/step:89.40861410833895 - timing_s/stop_profile:4.986487329006195e-05 - timing_per_token_ms/adv:3.144988032032201e-05 - timing_per_token_ms/gen:0.2762381651531071 - timing_per_token_ms/ref:0.004010677198101415 - timing_per_token_ms/update_actor:0.022268910939680763 - perf/total_num_tokens:374491 - perf/time_per_step:89.40861410833895 - perf/throughput:523.5667219187329
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9140625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9140625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3403345048427582, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3403345048427582, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 710.0656127929688, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.23125000298023224, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  55%|█████▌    | 291/525 [4:24:45<5:14:31, 80.65s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:03:13,277:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:03:13,279:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_290/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  56%|█████▌    | 292/525 [4:26:04<5:11:45, 80.28s/it]
[36m(TaskRunner pid=2949575)[0m step:291 - global_seqlen/min:36283 - global_seqlen/max:50571 - global_seqlen/minmax_diff:14288 - global_seqlen/balanced_min:44579 - global_seqlen/balanced_max:45481 - global_seqlen/mean:44805.125 - actor/entropy:0.10327862203121185 - actor/kl_loss:0.3552344284951687 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07470074258744716 - actor/pg_clipfrac:0.01185445770388469 - actor/ppo_kl:-0.005513226457696874 - actor/pg_clipfrac_lower:0.00038313060940708965 - actor/grad_norm:21.472108960151672 - perf/mfu/actor:0.12534224627138643 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.00825119018555 - actor/lr:1e-06 - training/global_step:291 - training/epoch:8 - critic/score/mean:0.9140625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9140625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3403345048427582 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3403345048427582 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:710.0656127929688 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.23125000298023224 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.146332740783691e-05 - timing_s/generate_sequences:64.68394470214844 - timing_s/reshard:0.6980507373809814 - timing_s/gen:67.1771640945226 - timing_s/reward:0.11600321717560291 - timing_s/old_log_prob:1.6341516729444265 - timing_s/ref:1.4620380960404873 - timing_s/adv:0.007897727191448212 - timing_s/update_actor:7.899792402982712 - timing_s/step:78.3122190348804 - timing_s/stop_profile:4.6040862798690796e-05 - timing_per_token_ms/adv:2.203354859362688e-05 - timing_per_token_ms/gen:0.2956468112301354 - timing_per_token_ms/ref:0.004078880753151808 - timing_per_token_ms/update_actor:0.022039310243478598 - perf/total_num_tokens:358441 - perf/time_per_step:78.3122190348804 - perf/throughput:572.1345347147387
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8843749761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8843749761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3189927935600281, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3189927935600281, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 740.828125, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.24375000596046448, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.884375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:292 - global_seqlen/min:29803 - global_seqlen/max:55458 - global_seqlen/minmax_diff:25655 - global_seqlen/balanced_min:45290 - global_seqlen/balanced_max:46250 - global_seqlen/mean:46009.375 - actor/entropy:0.10602166503667831 - actor/kl_loss:0.4070566430687904 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.022925937036052346 - actor/pg_clipfrac:0.015047067338309716 - actor/ppo_kl:-0.023018904333002865 - actor/pg_clipfrac_lower:9.556281293043867e-05 - actor/grad_norm:15.799823939800262 - perf/mfu/actor:0.12348671303235635 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.05623245239258 - actor/lr:1e-06 - training/global_step:292 - training/epoch:8 - critic/score/mean:0.8843749761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8843749761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3189927935600281 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3189927935600281 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:740.828125 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.24375000596046448 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.884375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.066052734851837e-05 - timing_s/generate_sequences:65.02024841308594 - timing_s/reshard:0.821138858795166 - timing_s/gen:67.79332989640534 - timing_s/reward:0.1182102095335722 - timing_s/old_log_prob:1.7196784652769566 - timing_s/ref:1.5102085061371326 - timing_s/adv:0.007756521925330162 - timing_s/update_actor:8.246383775025606 - timing_s/step:79.4106957167387 - timing_s/stop_profile:4.5610591769218445e-05 - timing_per_token_ms/adv:2.1073210419969195e-05 - timing_per_token_ms/gen:0.285969375050747 - timing_per_token_ms/ref:0.004102991254872329 - timing_per_token_ms/update_actor:0.022404085512533062 - perf/total_num_tokens:368075 - perf/time_per_step:79.4106957167387 - perf/throughput:579.3851141175917
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.745312511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.745312511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.32964569330215454, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.32964569330215454, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 815.1749877929688, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.2874999940395355, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7453125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  56%|█████▌    | 293/525 [4:27:24<5:10:04, 80.19s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  56%|█████▌    | 294/525 [4:28:43<5:06:39, 79.65s/it]
[36m(TaskRunner pid=2949575)[0m step:293 - global_seqlen/min:39994 - global_seqlen/max:63701 - global_seqlen/minmax_diff:23707 - global_seqlen/balanced_min:48526 - global_seqlen/balanced_max:49423 - global_seqlen/mean:48974.5 - actor/entropy:0.09605909138917923 - actor/kl_loss:0.2978546768426895 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05878581013530493 - actor/pg_clipfrac:0.009724151837872341 - actor/ppo_kl:-0.030889149324013588 - actor/pg_clipfrac_lower:0.00044396790326572955 - actor/grad_norm:20.264235615730286 - perf/mfu/actor:0.12974165511178434 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.20020294189453 - actor/lr:1e-06 - training/global_step:293 - training/epoch:8 - critic/score/mean:0.745312511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.745312511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.32964569330215454 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.32964569330215454 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:815.1749877929688 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.2874999940395355 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7453125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.137950837612152e-05 - timing_s/generate_sequences:65.3328857421875 - timing_s/reshard:0.6967354416847229 - timing_s/gen:68.07762111909688 - timing_s/reward:0.12629078701138496 - timing_s/old_log_prob:1.8007030189037323 - timing_s/ref:1.5536756608635187 - timing_s/adv:0.007603269070386887 - timing_s/update_actor:8.382981941103935 - timing_s/step:79.96364773251116 - timing_s/stop_profile:4.429183900356293e-05 - timing_per_token_ms/adv:1.9406193708937525e-05 - timing_per_token_ms/gen:0.2609777851346984 - timing_per_token_ms/ref:0.003965522008554244 - timing_per_token_ms/update_actor:0.021396292818466587 - perf/total_num_tokens:391796 - perf/time_per_step:79.96364773251116 - perf/throughput:612.4595536690134
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8671875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8671875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3869597911834717, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3869597911834717, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 675.2312622070312, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.21562500298023224, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:294 - global_seqlen/min:35579 - global_seqlen/max:48266 - global_seqlen/minmax_diff:12687 - global_seqlen/balanced_min:42818 - global_seqlen/balanced_max:43726 - global_seqlen/mean:43385.5 - actor/entropy:0.1355455070734024 - actor/kl_loss:0.2824924200773239 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09430159348994493 - actor/pg_clipfrac:0.010222160944249482 - actor/ppo_kl:0.039710475314481644 - actor/pg_clipfrac_lower:0.0006816431879997254 - actor/grad_norm:12.276273161172867 - perf/mfu/actor:0.11940619472590264 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.20166778564453 - actor/lr:1e-06 - training/global_step:294 - training/epoch:8 - critic/score/mean:0.8671875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8671875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3869597911834717 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3869597911834717 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:675.2312622070312 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.21562500298023224 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.462051093578339e-05 - timing_s/generate_sequences:64.82572937011719 - timing_s/reshard:0.7188715934753418 - timing_s/gen:67.11507318727672 - timing_s/reward:0.11146150156855583 - timing_s/old_log_prob:1.630084566771984 - timing_s/ref:1.4722164683043957 - timing_s/adv:0.008001834154129028 - timing_s/update_actor:8.019944537431002 - timing_s/step:78.37163582071662 - timing_s/stop_profile:4.342570900917053e-05 - timing_per_token_ms/adv:2.3054459883281938e-05 - timing_per_token_ms/gen:0.31061151821726224 - timing_per_token_ms/ref:0.004241671953487904 - timing_per_token_ms/update_actor:0.023106638558478644 - perf/total_num_tokens:347084 - perf/time_per_step:78.37163582071662 - perf/throughput:553.5867606393837
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.09375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.09375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.36354780197143555, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.36354780197143555, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 540.7312622070312, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.140625, 'prompt_length/mean': 408.421875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.09375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  56%|█████▌    | 295/525 [4:30:00<5:02:24, 78.89s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  56%|█████▋    | 296/525 [4:31:17<4:59:16, 78.41s/it]
[36m(TaskRunner pid=2949575)[0m step:295 - global_seqlen/min:29097 - global_seqlen/max:46789 - global_seqlen/minmax_diff:17692 - global_seqlen/balanced_min:37354 - global_seqlen/balanced_max:38279 - global_seqlen/mean:37966.125 - actor/entropy:0.17325924336910248 - actor/kl_loss:0.3694967992603779 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.014966761134564877 - actor/pg_clipfrac:0.009441069248714485 - actor/ppo_kl:-0.055058041369193234 - actor/pg_clipfrac_lower:0.0015087698950082995 - actor/grad_norm:27.450901746749878 - perf/mfu/actor:0.10659585522266589 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.32698822021484 - actor/lr:1e-06 - training/global_step:295 - training/epoch:8 - critic/score/mean:1.09375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.09375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.36354780197143555 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.36354780197143555 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:540.7312622070312 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.140625 - prompt_length/mean:408.421875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.09375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.577240467071533e-05 - timing_s/generate_sequences:64.10165405273438 - timing_s/reshard:0.7086694240570068 - timing_s/gen:66.26090373285115 - timing_s/reward:0.09769368171691895 - timing_s/old_log_prob:1.5256894901394844 - timing_s/ref:1.4065063539892435 - timing_s/adv:0.007991358637809753 - timing_s/update_actor:7.791758362203836 - timing_s/step:77.10405930504203 - timing_s/stop_profile:8.191913366317749e-05 - timing_per_token_ms/adv:2.6310818650210396e-05 - timing_per_token_ms/gen:0.3829357451879466 - timing_per_token_ms/ref:0.004630793747021995 - timing_per_token_ms/update_actor:0.025653652967625208 - perf/total_num_tokens:303729 - perf/time_per_step:77.10405930504203 - perf/throughput:492.40111794629337
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0234375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0234375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.43160709738731384, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.43160709738731384, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 595.8781127929688, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.17499999701976776, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0234375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:296 - global_seqlen/min:33530 - global_seqlen/max:47934 - global_seqlen/minmax_diff:14404 - global_seqlen/balanced_min:40233 - global_seqlen/balanced_max:40234 - global_seqlen/mean:40233.25 - actor/entropy:0.15999168157577515 - actor/kl_loss:0.3369560491293669 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04575489256531 - actor/pg_clipfrac:0.011363966716453433 - actor/ppo_kl:0.011263187861914048 - actor/pg_clipfrac_lower:0.00023951518815010787 - actor/grad_norm:28.81293159723282 - perf/mfu/actor:0.11008007930368852 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.2142333984375 - actor/lr:1e-06 - training/global_step:296 - training/epoch:8 - critic/score/mean:1.0234375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0234375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.43160709738731384 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.43160709738731384 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:595.8781127929688 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.17499999701976776 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0234375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.582828402519226e-05 - timing_s/generate_sequences:64.05096435546875 - timing_s/reshard:0.733148455619812 - timing_s/gen:66.18314600549638 - timing_s/reward:0.10496407188475132 - timing_s/old_log_prob:1.517113285139203 - timing_s/ref:1.424521030858159 - timing_s/adv:0.008147381246089935 - timing_s/update_actor:8.029061237350106 - timing_s/step:77.28173078410327 - timing_s/stop_profile:4.430115222930908e-05 - timing_per_token_ms/adv:2.531296019489457e-05 - timing_per_token_ms/gen:0.3470883098237181 - timing_per_token_ms/ref:0.004425820157637523 - timing_per_token_ms/update_actor:0.024945353772533 - perf/total_num_tokens:321866 - perf/time_per_step:77.28173078410327 - perf/throughput:520.604929415943
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9781249761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9781249761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3690584599971771, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3690584599971771, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 628.5062255859375, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.1875, 'prompt_length/mean': 410.28125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.978125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  57%|█████▋    | 297/525 [4:32:36<4:58:16, 78.49s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  57%|█████▋    | 298/525 [4:33:54<4:57:06, 78.53s/it]
[36m(TaskRunner pid=2949575)[0m step:297 - global_seqlen/min:32117 - global_seqlen/max:49821 - global_seqlen/minmax_diff:17704 - global_seqlen/balanced_min:41035 - global_seqlen/balanced_max:42068 - global_seqlen/mean:41551.5 - actor/entropy:0.1523420363664627 - actor/kl_loss:0.272992617636919 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1012494571506977 - actor/pg_clipfrac:0.003064906960935332 - actor/ppo_kl:0.07635582582031689 - actor/pg_clipfrac_lower:0.00022369040962075815 - actor/grad_norm:8.850590288639069 - perf/mfu/actor:0.11357565451680487 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.45523834228516 - actor/lr:1e-06 - training/global_step:297 - training/epoch:8 - critic/score/mean:0.9781249761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9781249761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3690584599971771 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3690584599971771 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:628.5062255859375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.1875 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.978125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.712895214557648e-05 - timing_s/generate_sequences:64.3342056274414 - timing_s/reshard:0.687612771987915 - timing_s/gen:66.84304979257286 - timing_s/reward:0.10607785917818546 - timing_s/old_log_prob:1.6441781055182219 - timing_s/ref:1.468389993533492 - timing_s/adv:0.007752610370516777 - timing_s/update_actor:8.05183576233685 - timing_s/step:78.13524699024856 - timing_s/stop_profile:4.5018270611763e-05 - timing_per_token_ms/adv:2.332229393197832e-05 - timing_per_token_ms/gen:0.33235076119257395 - timing_per_token_ms/ref:0.004417379617864253 - timing_per_token_ms/update_actor:0.024222458161368574 - perf/total_num_tokens:332412 - perf/time_per_step:78.13524699024856 - perf/throughput:531.7894497112899
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8687499761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8687499761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.38438400626182556, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.38438400626182556, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 676.3031005859375, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21250000596046448, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.86875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:298 - global_seqlen/min:38778 - global_seqlen/max:50256 - global_seqlen/minmax_diff:11478 - global_seqlen/balanced_min:42904 - global_seqlen/balanced_max:43935 - global_seqlen/mean:43419.625 - actor/entropy:0.14987395703792572 - actor/kl_loss:0.2713204246014357 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23124313484877349 - actor/pg_clipfrac:0.009302429000672418 - actor/ppo_kl:0.053506778089649744 - actor/pg_clipfrac_lower:0.0013706846017157658 - actor/grad_norm:21.495772123336792 - perf/mfu/actor:0.12149011509993038 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.49504470825195 - actor/lr:1e-06 - training/global_step:298 - training/epoch:8 - critic/score/mean:0.8687499761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8687499761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.38438400626182556 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.38438400626182556 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:676.3031005859375 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21250000596046448 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.86875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.561275899410248e-05 - timing_s/generate_sequences:65.07795715332031 - timing_s/reshard:0.7192785739898682 - timing_s/gen:67.21198049560189 - timing_s/reward:0.11304494552314281 - timing_s/old_log_prob:1.5690730661153793 - timing_s/ref:1.4379573315382004 - timing_s/adv:0.007556430995464325 - timing_s/update_actor:7.886006394401193 - timing_s/step:78.23962484113872 - timing_s/stop_profile:5.2947551012039185e-05 - timing_per_token_ms/adv:2.1754077204329622e-05 - timing_per_token_ms/gen:0.31056700950295907 - timing_per_token_ms/ref:0.004139710244901357 - timing_per_token_ms/update_actor:0.02270288606362098 - perf/total_num_tokens:347357 - perf/time_per_step:78.23962484113872 - perf/throughput:554.9569682646252
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9765625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9765625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.38748034834861755, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.38748034834861755, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 616.7312622070312, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.17499999701976776, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9765625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  57%|█████▋    | 299/525 [4:35:14<4:56:20, 78.67s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:17:29,461:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:17:34,199:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:17:34,202:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:17:29,719:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:17:34,738:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/huggingface
[36m(TaskRunner pid=2949575)[0m step:299 - global_seqlen/min:32937 - global_seqlen/max:47562 - global_seqlen/minmax_diff:14625 - global_seqlen/balanced_min:41058 - global_seqlen/balanced_max:41059 - global_seqlen/mean:41058.625 - actor/entropy:0.17855627834796906 - actor/kl_loss:0.21811846680939198 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.24942661835812033 - actor/pg_clipfrac:0.004945196252083406 - actor/ppo_kl:0.0031985202060660356 - actor/pg_clipfrac_lower:0.0002650556882144883 - actor/grad_norm:21.16345638036728 - perf/mfu/actor:0.11200975893109584 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.4645004272461 - actor/lr:1e-06 - training/global_step:299 - training/epoch:8 - critic/score/mean:0.9765625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9765625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.38748034834861755 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.38748034834861755 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:616.7312622070312 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.17499999701976776 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9765625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.415562868118286e-05 - timing_s/generate_sequences:64.6484146118164 - timing_s/reshard:0.7239671945571899 - timing_s/gen:67.85975254327059 - timing_s/reward:0.10704185627400875 - timing_s/old_log_prob:1.5224380791187286 - timing_s/ref:1.4157419987022877 - timing_s/adv:0.010941604152321815 - timing_s/update_actor:8.065721467137337 - timing_s/step:78.99514995515347 - timing_s/stop_profile:4.250742495059967e-05 - timing_per_token_ms/adv:3.331091869345909e-05 - timing_per_token_ms/gen:0.34384787003694167 - timing_per_token_ms/ref:0.004310123630242999 - timing_per_token_ms/update_actor:0.02455550285456873 - perf/total_num_tokens:328469 - perf/time_per_step:78.99514995515347 - perf/throughput:519.7613400735298
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 300}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), where \(a\) is the distance from the center to each vertex of the hyperbola.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The equation of the parabola is \(y^2 = 16x\). The standard form of a parabola that opens to the right is \(y^2 = 4px\), where \(p\) is the distance from the vertex to the focus. By comparing \(y^2 = 16x\) with \(y^2 = 4px\), we get \(4p = 16\), so \(p = 4\). Therefore, the focus of the parabola is at \((4, 0)\) and the directrix is the line \(x = -4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The hyperbola intersects the parabola at points \(A\) and \(B\), and the distance between these points is \(|AB| = 4\sqrt{3}\). Since the hyperbola is equilateral, the distance between the foci is \(2c = 2a\), where \(c\) is the distance from the center to each focus. The foci of the hyperbola are at \((\pm c, 0)\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The points \(A\) and \(B\) lie on both the hyperbola and the parabola, and the distance between them is the length of the chord of the parabola that is also a focal chord of the hyperbola. For an equilateral hyperbola, the length of the focal chord is given by \(4a\sqrt{2}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Given that \(|AB| = 4\sqrt{3}\), we can set up the equation:
[36m(TaskRunner pid=2949575)[0m \[4a\sqrt{2} = 4\sqrt{3}\]
[36m(TaskRunner pid=2949575)[0m Dividing both sides by 4, we get:
[36m(TaskRunner pid=2949575)[0m \[a\sqrt{2} = \sqrt{3}\]
[36m(TaskRunner pid=2949575)[0m Solving for \(a\), we divide both sides by \(\sqrt{2}\):
[36m(TaskRunner pid=2949575)[0m \[a = \frac{\sqrt{3}}{\sqrt{2}} = \frac{\sqrt{6}}{2}\]
[36m(TaskRunner pid=2949575)[0m The length of the real axis of the hyperbola is \(2a\), so:
[36m(TaskRunner pid=2949575)[0m \[2a = 2 \cdot \frac{\sqrt{6}}{2} = \sqrt{6}\]
[36m(TaskRunner pid=2949575)[0m Therefore, the length of the real axis of the hyperbola is \(\sqrt{6}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The correct answer is \(\sqrt{6}\), which is not one of the given options. However, if we look at the options provided, the closest match to \(\sqrt{6}\) is \(2\sqrt{2}\), which is option B.
[36m(TaskRunner pid=2949575)[0m </think>
[36m(TaskRunner pid=2949575)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] 1.0
[36m(TaskRunner pid=2949575)[0m [structure] 0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.5
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.021875023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.021875023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3283482789993286, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3283482789993286, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 564.0125122070312, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.140625, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.021875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:300 - global_seqlen/min:28709 - global_seqlen/max:49137 - global_seqlen/minmax_diff:20428 - global_seqlen/balanced_min:38420 - global_seqlen/balanced_max:39282 - global_seqlen/mean:38958.625 - actor/entropy:0.19131958484649658 - actor/kl_loss:0.38883210010826585 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.027678389847278596 - actor/pg_clipfrac:0.006670443111215718 - actor/ppo_kl:-0.21190034119489526 - actor/pg_clipfrac_lower:0.01199904246313963 - actor/grad_norm:70.11913934350014 - perf/mfu/actor:0.10705688683011215 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.30977249145508 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:0.97 - val-aux/grpo_convert/reward/std@50:0.8744574113100405 - val-aux/grpo_convert/reward/best@2/mean:1.40675 - val-aux/grpo_convert/reward/best@2/std:0.6458445542133733 - val-aux/grpo_convert/reward/worst@2/mean:0.529 - val-aux/grpo_convert/reward/worst@2/std:0.8480232385585482 - val-aux/grpo_convert/reward/best@4/mean:1.7005 - val-aux/grpo_convert/reward/best@4/std:0.4382706188658031 - val-aux/grpo_convert/reward/worst@4/mean:0.09975 - val-aux/grpo_convert/reward/worst@4/std:0.7275350111834891 - val-aux/grpo_convert/reward/best@8/mean:1.892 - val-aux/grpo_convert/reward/best@8/std:0.26712852254083175 - val-aux/grpo_convert/reward/worst@8/mean:-0.2195 - val-aux/grpo_convert/reward/worst@8/std:0.5270694310039588 - val-aux/grpo_convert/reward/best@16/mean:1.9775 - val-aux/grpo_convert/reward/best@16/std:0.10365206220813937 - val-aux/grpo_convert/reward/worst@16/mean:-0.425 - val-aux/grpo_convert/reward/worst@16/std:0.26828263318844214 - val-aux/grpo_convert/reward/best@32/mean:1.9995 - val-aux/grpo_convert/reward/best@32/std:0.01580348062927911 - val-aux/grpo_convert/reward/worst@32/mean:-0.4925 - val-aux/grpo_convert/reward/worst@32/std:0.07462405778299648 - val-aux/grpo_convert/reward/best@50/mean:2.0 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:0.97 - val-aux/grpo_convert/score/std@50:0.8744574113100405 - val-aux/grpo_convert/score/best@2/mean:1.40675 - val-aux/grpo_convert/score/best@2/std:0.6458445542133733 - val-aux/grpo_convert/score/worst@2/mean:0.529 - val-aux/grpo_convert/score/worst@2/std:0.8480232385585482 - val-aux/grpo_convert/score/best@4/mean:1.7005 - val-aux/grpo_convert/score/best@4/std:0.4382706188658031 - val-aux/grpo_convert/score/worst@4/mean:0.09975 - val-aux/grpo_convert/score/worst@4/std:0.7275350111834891 - val-aux/grpo_convert/score/best@8/mean:1.892 - val-aux/grpo_convert/score/best@8/std:0.26712852254083175 - val-aux/grpo_convert/score/worst@8/mean:-0.2195 - val-aux/grpo_convert/score/worst@8/std:0.5270694310039588 - val-aux/grpo_convert/score/best@16/mean:1.9775 - val-aux/grpo_convert/score/best@16/std:0.10365206220813937 - val-aux/grpo_convert/score/worst@16/mean:-0.425 - val-aux/grpo_convert/score/worst@16/std:0.26828263318844214 - val-aux/grpo_convert/score/best@32/mean:1.9995 - val-aux/grpo_convert/score/best@32/std:0.01580348062927911 - val-aux/grpo_convert/score/worst@32/mean:-0.4925 - val-aux/grpo_convert/score/worst@32/std:0.07462405778299648 - val-aux/grpo_convert/score/best@50/mean:2.0 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:0.28 - val-aux/grpo_convert/structure/std@50:0.4026223004767667 - val-aux/grpo_convert/structure/best@2/mean:0.4445 - val-aux/grpo_convert/structure/best@2/std:0.20934501767938996 - val-aux/grpo_convert/structure/worst@2/mean:0.11499999999999999 - val-aux/grpo_convert/structure/worst@2/std:0.4703816363752479 - val-aux/grpo_convert/structure/best@4/mean:0.496 - val-aux/grpo_convert/structure/best@4/std:0.057489809323468526 - val-aux/grpo_convert/structure/worst@4/mean:-0.11150000000000002 - val-aux/grpo_convert/structure/worst@4/std:0.45705255997098115 - val-aux/grpo_convert/structure/best@8/mean:0.5 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.314 - val-aux/grpo_convert/structure/worst@8/std:0.3458585861659969 - val-aux/grpo_convert/structure/best@16/mean:0.5 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.45 - val-aux/grpo_convert/structure/worst@16/std:0.17885508879229475 - val-aux/grpo_convert/structure/best@32/mean:0.5 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.495 - val-aux/grpo_convert/structure/worst@32/std:0.049749371855330994 - val-aux/grpo_convert/structure/best@50/mean:0.5 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.39 - val-aux/grpo_convert/boxed/std@50:0.20131115023838336 - val-aux/grpo_convert/boxed/best@2/mean:0.47225 - val-aux/grpo_convert/boxed/best@2/std:0.10467250883969498 - val-aux/grpo_convert/boxed/worst@2/mean:0.3075 - val-aux/grpo_convert/boxed/worst@2/std:0.23519081818762394 - val-aux/grpo_convert/boxed/best@4/mean:0.498 - val-aux/grpo_convert/boxed/best@4/std:0.028744904661734263 - val-aux/grpo_convert/boxed/worst@4/mean:0.19425 - val-aux/grpo_convert/boxed/worst@4/std:0.22852627998549058 - val-aux/grpo_convert/boxed/best@8/mean:0.5 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.093 - val-aux/grpo_convert/boxed/worst@8/std:0.17292929308299845 - val-aux/grpo_convert/boxed/best@16/mean:0.5 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.025 - val-aux/grpo_convert/boxed/worst@16/std:0.08942754439614738 - val-aux/grpo_convert/boxed/best@32/mean:0.5 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.0025 - val-aux/grpo_convert/boxed/worst@32/std:0.024874685927665497 - val-aux/grpo_convert/boxed/best@50/mean:0.5 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.3 - val-aux/grpo_convert/correct/std@50:0.4388729807080468 - val-aux/grpo_convert/correct/best@2/mean:0.49 - val-aux/grpo_convert/correct/best@2/std:0.4659655688791642 - val-aux/grpo_convert/correct/worst@2/mean:0.1065 - val-aux/grpo_convert/correct/worst@2/std:0.2863522104088835 - val-aux/grpo_convert/correct/best@4/mean:0.7065 - val-aux/grpo_convert/correct/best@4/std:0.4119356738372244 - val-aux/grpo_convert/correct/worst@4/mean:0.017 - val-aux/grpo_convert/correct/worst@4/std:0.09061456836513652 - val-aux/grpo_convert/correct/best@8/mean:0.892 - val-aux/grpo_convert/correct/best@8/std:0.2671285225408318 - val-aux/grpo_convert/correct/worst@8/mean:0.0015 - val-aux/grpo_convert/correct/worst@8/std:0.027345017827750638 - val-aux/grpo_convert/correct/best@16/mean:0.9775 - val-aux/grpo_convert/correct/best@16/std:0.10365206220813941 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.9995 - val-aux/grpo_convert/correct/best@32/std:0.01580348062927911 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:1.0 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.3 - val-aux/grpo_convert/acc/std@50:0.4388729807080468 - val-aux/grpo_convert/acc/best@2/mean:0.49 - val-aux/grpo_convert/acc/best@2/std:0.4659655688791642 - val-aux/grpo_convert/acc/worst@2/mean:0.1065 - val-aux/grpo_convert/acc/worst@2/std:0.2863522104088835 - val-aux/grpo_convert/acc/best@4/mean:0.7065 - val-aux/grpo_convert/acc/best@4/std:0.4119356738372244 - val-aux/grpo_convert/acc/worst@4/mean:0.017 - val-aux/grpo_convert/acc/worst@4/std:0.09061456836513652 - val-aux/grpo_convert/acc/best@8/mean:0.892 - val-aux/grpo_convert/acc/best@8/std:0.2671285225408318 - val-aux/grpo_convert/acc/worst@8/mean:0.0015 - val-aux/grpo_convert/acc/worst@8/std:0.027345017827750638 - val-aux/grpo_convert/acc/best@16/mean:0.9775 - val-aux/grpo_convert/acc/best@16/std:0.10365206220813941 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.9995 - val-aux/grpo_convert/acc/best@32/std:0.01580348062927911 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:1.0 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:300 - training/epoch:8 - critic/score/mean:1.021875023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.021875023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3283482789993286 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3283482789993286 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:564.0125122070312 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.140625 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.021875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.468834519386292e-05 - timing_s/generate_sequences:64.20508575439453 - timing_s/reshard:0.8220374584197998 - timing_s/gen:66.67122555151582 - timing_s/reward:0.09982376731932163 - timing_s/old_log_prob:1.515736086294055 - timing_s/ref:1.4282819293439388 - timing_s/adv:0.007962750270962715 - timing_s/update_actor:7.963104151189327 - timing_s/testing:67.8293541483581 - timing_s/save_checkpoint:10.523992698639631 - timing_s/step:156.05370466597378 - timing_s/stop_profile:5.02951443195343e-05 - timing_per_token_ms/adv:2.554874007669263e-05 - timing_per_token_ms/gen:0.36940241545796754 - timing_per_token_ms/ref:0.004582688459050912 - timing_per_token_ms/update_actor:0.025549875512769403 - perf/total_num_tokens:311669 - perf/time_per_step:156.05370466597378 - perf/throughput:249.6488313647488[36m(TaskRunner pid=2949575)[0m Training Progress:  57%|█████▋    | 300/525 [4:37:50<6:22:06, 101.89s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  57%|█████▋    | 301/525 [4:39:08<5:53:38, 94.73s/it] 
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:17:36,185:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:17:36,187:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_300/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  58%|█████▊    | 302/525 [4:40:26<5:33:31, 89.74s/it]

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.024999976158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.024999976158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.43049976229667664, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.43049976229667664, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 684.3875122070312, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.21875, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.025, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:301 - global_seqlen/min:33833 - global_seqlen/max:54221 - global_seqlen/minmax_diff:20388 - global_seqlen/balanced_min:42893 - global_seqlen/balanced_max:44009 - global_seqlen/mean:43729.875 - actor/entropy:0.1418077051639557 - actor/kl_loss:0.2312771938741207 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.050050408020615576 - actor/pg_clipfrac:0.00529474914947059 - actor/ppo_kl:-0.009179570415290073 - actor/pg_clipfrac_lower:0.0005017743475036696 - actor/grad_norm:6.331317514181137 - perf/mfu/actor:0.11882483777988269 - perf/max_memory_allocated_gb:70.70352411270142 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.35940170288086 - actor/lr:1e-06 - training/global_step:301 - training/epoch:8 - critic/score/mean:1.024999976158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.024999976158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.43049976229667664 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.43049976229667664 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:684.3875122070312 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.21875 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.025 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.660128176212311e-05 - timing_s/generate_sequences:64.8359603881836 - timing_s/reshard:0.6057392358779907 - timing_s/gen:66.51992225646973 - timing_s/reward:0.11404453217983246 - timing_s/old_log_prob:1.7005824837833643 - timing_s/ref:1.50164863653481 - timing_s/adv:0.007772630080580711 - timing_s/update_actor:8.122234396636486 - timing_s/step:77.98518901132047 - timing_s/stop_profile:4.567764699459076e-05 - timing_per_token_ms/adv:2.221773467389488e-05 - timing_per_token_ms/gen:0.30373838951101223 - timing_per_token_ms/ref:0.004292399179436284 - timing_per_token_ms/update_actor:0.023217063839756247 - perf/total_num_tokens:349839 - perf/time_per_step:77.98518901132047 - perf/throughput:560.7459000150925
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9593750238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9593750238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4119977056980133, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4119977056980133, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 653.140625, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.1875, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.959375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:302 - global_seqlen/min:32339 - global_seqlen/max:51539 - global_seqlen/minmax_diff:19200 - global_seqlen/balanced_min:41973 - global_seqlen/balanced_max:42952 - global_seqlen/mean:42484.375 - actor/entropy:0.1665162891149521 - actor/kl_loss:0.5636818766593933 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.035848306212574246 - actor/pg_clipfrac:0.029510197683703155 - actor/ppo_kl:0.1272829221386928 - actor/pg_clipfrac_lower:6.04846136411652e-05 - actor/grad_norm:38.25871762633324 - perf/mfu/actor:0.11591268592090023 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.39925384521484 - actor/lr:1e-06 - training/global_step:302 - training/epoch:8 - critic/score/mean:0.9593750238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9593750238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4119977056980133 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4119977056980133 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:653.140625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.1875 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.959375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.556751370429993e-05 - timing_s/generate_sequences:64.3718490600586 - timing_s/reshard:0.7268432974815369 - timing_s/gen:66.9154192134738 - timing_s/reward:0.1094678845256567 - timing_s/old_log_prob:1.5194945931434631 - timing_s/ref:1.4527346640825272 - timing_s/adv:0.007856884971261024 - timing_s/update_actor:8.062946235761046 - timing_s/step:78.08154322952032 - timing_s/stop_profile:4.3354928493499756e-05 - timing_per_token_ms/adv:2.311698410080478e-05 - timing_per_token_ms/gen:0.32016181054746917 - timing_per_token_ms/ref:0.0042743204533505766 - timing_per_token_ms/update_actor:0.023723269542511354 - perf/total_num_tokens:339875 - perf/time_per_step:78.08154322952032 - perf/throughput:544.1026552858642
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  58%|█████▊    | 303/525 [4:41:46<5:21:20, 86.85s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  58%|█████▊    | 304/525 [4:43:06<5:12:30, 84.84s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8140624761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8140624761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.26578789949417114, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.26578789949417114, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 825.1437377929688, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.2906250059604645, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:303 - global_seqlen/min:35479 - global_seqlen/max:57787 - global_seqlen/minmax_diff:22308 - global_seqlen/balanced_min:48883 - global_seqlen/balanced_max:49730 - global_seqlen/mean:49412.625 - actor/entropy:0.11885979026556015 - actor/kl_loss:0.2647293247282505 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22422825451940298 - actor/pg_clipfrac:0.0038478278307593427 - actor/ppo_kl:-0.004224184839586087 - actor/pg_clipfrac_lower:0.0007152304518967867 - actor/grad_norm:9.065515041351318 - perf/mfu/actor:0.13000385605234827 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.34175491333008 - actor/lr:1e-06 - training/global_step:303 - training/epoch:8 - critic/score/mean:0.8140624761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8140624761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.26578789949417114 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.26578789949417114 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:825.1437377929688 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.2906250059604645 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.3971226811409e-05 - timing_s/generate_sequences:66.0742416381836 - timing_s/reshard:0.7054845094680786 - timing_s/gen:68.16258827596903 - timing_s/reward:0.1282081063836813 - timing_s/old_log_prob:1.7842226549983025 - timing_s/ref:1.5600705798715353 - timing_s/adv:0.008116746321320534 - timing_s/update_actor:8.443291630595922 - timing_s/step:80.10015054047108 - timing_s/stop_profile:4.280358552932739e-05 - timing_per_token_ms/adv:2.0533078138736138e-05 - timing_per_token_ms/gen:0.2581466421607183 - timing_per_token_ms/ref:0.003946538409646157 - timing_per_token_ms/update_actor:0.021359145639894467 - perf/total_num_tokens:395301 - perf/time_per_step:80.10015054047108 - perf/throughput:616.8855447410673
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9828125238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9828125238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3279557228088379, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3279557228088379, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 780.921875, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.2562499940395355, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:304 - global_seqlen/min:38481 - global_seqlen/max:53742 - global_seqlen/minmax_diff:15261 - global_seqlen/balanced_min:47365 - global_seqlen/balanced_max:48349 - global_seqlen/mean:47608.75 - actor/entropy:0.13362771272659302 - actor/kl_loss:0.195355124771595 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.014910575561225414 - actor/pg_clipfrac:0.0018595885296235793 - actor/ppo_kl:0.0037952059705276043 - actor/pg_clipfrac_lower:2.198768634116277e-05 - actor/grad_norm:8.055868268013 - perf/mfu/actor:0.12475885504410647 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.30527877807617 - actor/lr:1e-06 - training/global_step:304 - training/epoch:8 - critic/score/mean:0.9828125238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9828125238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3279557228088379 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3279557228088379 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:780.921875 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.2562499940395355 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.879175245761871e-05 - timing_s/generate_sequences:66.0501937866211 - timing_s/reshard:0.7089660167694092 - timing_s/gen:68.3210491836071 - timing_s/reward:0.12361053563654423 - timing_s/old_log_prob:1.721039330586791 - timing_s/ref:1.4965651780366898 - timing_s/adv:0.007829336449503899 - timing_s/update_actor:8.450706450268626 - timing_s/step:80.13596747256815 - timing_s/stop_profile:4.343502223491669e-05 - timing_per_token_ms/adv:2.0556453513019925e-05 - timing_per_token_ms/gen:0.27339902432464475 - timing_per_token_ms/ref:0.003929333310674744 - timing_per_token_ms/update_actor:0.022187902565885015 - perf/total_num_tokens:380870 - perf/time_per_step:80.13596747256815 - perf/throughput:594.0996471565312
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0437500476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0437500476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3151070773601532, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.3151070773601532, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 626.7000122070312, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.171875, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.04375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  58%|█████▊    | 305/525 [4:44:25<5:04:26, 83.03s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  58%|█████▊    | 306/525 [4:45:42<4:57:09, 81.41s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:305 - global_seqlen/min:32692 - global_seqlen/max:52295 - global_seqlen/minmax_diff:19603 - global_seqlen/balanced_min:40628 - global_seqlen/balanced_max:41587 - global_seqlen/mean:41466.125 - actor/entropy:0.20150624215602875 - actor/kl_loss:0.1902883294969797 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10635899174958467 - actor/pg_clipfrac:0.006010042451089248 - actor/ppo_kl:0.035692704525718 - actor/pg_clipfrac_lower:0.00015578276215819642 - actor/grad_norm:23.96567302942276 - perf/mfu/actor:0.11490314242660433 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.45759582519531 - actor/lr:1e-06 - training/global_step:305 - training/epoch:8 - critic/score/mean:1.0437500476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0437500476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3151070773601532 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3151070773601532 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:626.7000122070312 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.171875 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.04375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.7762251496315e-05 - timing_s/generate_sequences:64.90962219238281 - timing_s/reshard:0.72495037317276 - timing_s/gen:67.25980622507632 - timing_s/reward:0.10778448358178139 - timing_s/old_log_prob:1.5074658319354057 - timing_s/ref:1.423243971541524 - timing_s/adv:0.007881281897425652 - timing_s/update_actor:7.929499430581927 - timing_s/step:78.25727324932814 - timing_s/stop_profile:4.482641816139221e-05 - timing_per_token_ms/adv:2.3758193879418598e-05 - timing_per_token_ms/gen:0.33538677908626696 - timing_per_token_ms/ref:0.004290381520884589 - timing_per_token_ms/update_actor:0.0239035460589274 - perf/total_num_tokens:331729 - perf/time_per_step:78.25727324932814 - perf/throughput:529.8692795989541
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0390625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0390625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.35974904894828796, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.35974904894828796, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 588.6124877929688, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.15312500298023224, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:306 - global_seqlen/min:31869 - global_seqlen/max:46620 - global_seqlen/minmax_diff:14751 - global_seqlen/balanced_min:39797 - global_seqlen/balanced_max:40917 - global_seqlen/mean:39938.25 - actor/entropy:0.18891049921512604 - actor/kl_loss:0.2589875780045986 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05053920694626868 - actor/pg_clipfrac:0.009594277892028913 - actor/ppo_kl:-0.020366258283320348 - actor/pg_clipfrac_lower:8.624407346360385e-05 - actor/grad_norm:31.016001045703888 - perf/mfu/actor:0.11035277487967908 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.60887908935547 - actor/lr:1e-06 - training/global_step:306 - training/epoch:8 - critic/score/mean:1.0390625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0390625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.35974904894828796 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.35974904894828796 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:588.6124877929688 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.15312500298023224 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.813105523586273e-05 - timing_s/generate_sequences:64.39254760742188 - timing_s/reshard:0.701188862323761 - timing_s/gen:66.38201003707945 - timing_s/reward:0.10245380364358425 - timing_s/old_log_prob:1.4447005931288004 - timing_s/ref:1.4093118775635958 - timing_s/adv:0.007654229179024696 - timing_s/update_actor:7.929302539676428 - timing_s/step:77.29555511660874 - timing_s/stop_profile:4.3859705328941345e-05 - timing_per_token_ms/adv:2.395644895252263e-05 - timing_per_token_ms/gen:0.3524284335889457 - timing_per_token_ms/ref:0.004410908958090288 - timing_per_token_ms/update_actor:0.02481738227036872 - perf/total_num_tokens:319506 - perf/time_per_step:77.29555511660874 - perf/throughput:516.6952994871285
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9281250238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9281250238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.40901851654052734, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.40901851654052734, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 693.421875, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.21562500298023224, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.928125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  58%|█████▊    | 307/525 [4:47:01<4:52:27, 80.49s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  59%|█████▊    | 308/525 [4:48:19<4:48:44, 79.83s/it]
[36m(TaskRunner pid=2949575)[0m step:307 - global_seqlen/min:30669 - global_seqlen/max:48373 - global_seqlen/minmax_diff:17704 - global_seqlen/balanced_min:43528 - global_seqlen/balanced_max:44472 - global_seqlen/mean:44117.5 - actor/entropy:0.15804915130138397 - actor/kl_loss:0.23766464851796626 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.25819986425340175 - actor/pg_clipfrac:0.00709890959697077 - actor/ppo_kl:-0.024935216615494936 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:29.915245294570923 - perf/mfu/actor:0.12262697923659693 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.52100372314453 - actor/lr:1e-06 - training/global_step:307 - training/epoch:8 - critic/score/mean:0.9281250238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9281250238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.40901851654052734 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.40901851654052734 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:693.421875 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.21562500298023224 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.928125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.546693086624146e-05 - timing_s/generate_sequences:65.09654998779297 - timing_s/reshard:0.6805881261825562 - timing_s/gen:67.27474298514426 - timing_s/reward:0.11426368355751038 - timing_s/old_log_prob:1.5300271213054657 - timing_s/ref:1.4271302912384272 - timing_s/adv:0.00763089582324028 - timing_s/update_actor:7.938289673998952 - timing_s/step:78.31637968495488 - timing_s/stop_profile:4.392862319946289e-05 - timing_per_token_ms/adv:2.162094356899269e-05 - timing_per_token_ms/gen:0.30318278007681226 - timing_per_token_ms/ref:0.004043549303673222 - timing_per_token_ms/update_actor:0.02249189571598275 - perf/total_num_tokens:352940 - perf/time_per_step:78.31637968495488 - perf/throughput:563.3240476318299
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0671875476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0671875476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.410978227853775, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.410978227853775, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 617.359375, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.16249999403953552, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:308 - global_seqlen/min:32512 - global_seqlen/max:45776 - global_seqlen/minmax_diff:13264 - global_seqlen/balanced_min:40676 - global_seqlen/balanced_max:41492 - global_seqlen/mean:41088.125 - actor/entropy:0.19416654109954834 - actor/kl_loss:0.22939570471644402 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.036147267743945125 - actor/pg_clipfrac:0.009090883938188198 - actor/ppo_kl:-0.008289663605683017 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:12.302726984024048 - perf/mfu/actor:0.1142810751581856 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.47290420532227 - actor/lr:1e-06 - training/global_step:308 - training/epoch:8 - critic/score/mean:1.0671875476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0671875476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.410978227853775 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.410978227853775 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:617.359375 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.16249999403953552 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.645785808563232e-05 - timing_s/generate_sequences:64.93719482421875 - timing_s/reshard:0.6838283538818359 - timing_s/gen:67.36042262800038 - timing_s/reward:0.10462413355708122 - timing_s/old_log_prob:1.47995850071311 - timing_s/ref:1.4288564547896385 - timing_s/adv:0.007848884910345078 - timing_s/update_actor:7.889614874497056 - timing_s/step:78.28470428101718 - timing_s/stop_profile:4.505179822444916e-05 - timing_per_token_ms/adv:2.3878203587852564e-05 - timing_per_token_ms/gen:0.3409704772240661 - timing_per_token_ms/ref:0.00434692643795999 - timing_per_token_ms/update_actor:0.0240021139760486 - perf/total_num_tokens:328705 - perf/time_per_step:78.28470428101718 - perf/throughput:524.8550834720752
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.115625023841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.115625023841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4776369333267212, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4776369333267212, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 616.0625, 'response_length/max': 2048.0, 'response_length/min': 5.0, 'response_length/clip_ratio': 0.16875000298023224, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.115625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  59%|█████▉    | 309/525 [4:49:38<4:46:10, 79.49s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:30:46,178:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:30:50,735:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:30:50,738:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:30:51,287:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/huggingface
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 04:30:46,576:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  59%|█████▉    | 310/525 [4:51:06<4:54:24, 82.16s/it]
[36m(TaskRunner pid=2949575)[0m step:309 - global_seqlen/min:32119 - global_seqlen/max:48072 - global_seqlen/minmax_diff:15953 - global_seqlen/balanced_min:40334 - global_seqlen/balanced_max:41236 - global_seqlen/mean:41010.0 - actor/entropy:0.2047823667526245 - actor/kl_loss:0.20616003461182117 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05442374423146248 - actor/pg_clipfrac:0.009049021030659788 - actor/ppo_kl:-0.04725433617422823 - actor/pg_clipfrac_lower:0.0009411949024070055 - actor/grad_norm:7.616018235683441 - perf/mfu/actor:0.10988067130273076 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.43254089355469 - actor/lr:1e-06 - training/global_step:309 - training/epoch:8 - critic/score/mean:1.115625023841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.115625023841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4776369333267212 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4776369333267212 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:616.0625 - response_length/max:2048.0 - response_length/min:5.0 - response_length/clip_ratio:0.16875000298023224 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.115625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.240846753120422e-05 - timing_s/generate_sequences:64.75669860839844 - timing_s/reshard:0.6862284541130066 - timing_s/gen:67.36932543851435 - timing_s/reward:0.10626145824790001 - timing_s/old_log_prob:1.5521330665796995 - timing_s/ref:1.4412852190434933 - timing_s/adv:0.007618429139256477 - timing_s/update_actor:8.19233139231801 - timing_s/step:78.68231052719057 - timing_s/stop_profile:4.113093018531799e-05 - timing_per_token_ms/adv:2.3221254386907088e-05 - timing_per_token_ms/gen:0.3417334150274645 - timing_per_token_ms/ref:0.004393090767628302 - timing_per_token_ms/update_actor:0.024970529725426755 - perf/total_num_tokens:328080 - perf/time_per_step:78.68231052719057 - perf/throughput:521.2099101465508
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9390624761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9390624761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.42433789372444153, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.42433789372444153, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 706.171875, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.20937499403953552, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:310 - global_seqlen/min:38999 - global_seqlen/max:49922 - global_seqlen/minmax_diff:10923 - global_seqlen/balanced_min:44260 - global_seqlen/balanced_max:45266 - global_seqlen/mean:44636.25 - actor/entropy:0.17067715525627136 - actor/kl_loss:0.18546698689460756 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12175006382167339 - actor/pg_clipfrac:0.003100086077756714 - actor/ppo_kl:-0.00530571402341593 - actor/pg_clipfrac_lower:0.00028928123065270485 - actor/grad_norm:12.232730627059937 - perf/mfu/actor:0.12094632948057613 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.44260787963867 - actor/lr:1e-06 - training/global_step:310 - training/epoch:8 - critic/score/mean:0.9390624761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9390624761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.42433789372444153 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.42433789372444153 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:706.171875 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.20937499403953552 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.295981049537659e-05 - timing_s/generate_sequences:65.02469635009766 - timing_s/reshard:0.74106764793396 - timing_s/gen:66.97675142996013 - timing_s/reward:0.11507030762732029 - timing_s/old_log_prob:1.6524299830198288 - timing_s/ref:1.4850585665553808 - timing_s/adv:0.007854998111724854 - timing_s/update_actor:8.137061787769198 - timing_s/save_checkpoint:9.988449258729815 - timing_s/step:88.37654072418809 - timing_s/stop_profile:4.7750771045684814e-05 - timing_per_token_ms/adv:2.199725030587486e-05 - timing_per_token_ms/gen:0.29639009372700575 - timing_per_token_ms/ref:0.0041587794857189525 - timing_per_token_ms/update_actor:0.022787145503288243 - perf/total_num_tokens:357090 - perf/time_per_step:88.37654072418809 - perf/throughput:505.0689881526823
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1906249523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1906249523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.4074457287788391, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.4074457287788391, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 540.4937744140625, 'response_length/max': 2048.0, 'response_length/min': 114.0, 'response_length/clip_ratio': 0.10625000298023224, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.190625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  59%|█████▉    | 311/525 [4:52:24<4:48:01, 80.75s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:30:52,730:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:30:52,733:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_310/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  59%|█████▉    | 312/525 [4:53:40<4:42:30, 79.58s/it]
[36m(TaskRunner pid=2949575)[0m step:311 - global_seqlen/min:32587 - global_seqlen/max:42258 - global_seqlen/minmax_diff:9671 - global_seqlen/balanced_min:37747 - global_seqlen/balanced_max:38740 - global_seqlen/mean:37996.0 - actor/entropy:0.2543189525604248 - actor/kl_loss:0.16926510035991668 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17271563243120908 - actor/pg_clipfrac:0.004076030058786273 - actor/ppo_kl:0.012749015487497673 - actor/pg_clipfrac_lower:0.00026674030086724085 - actor/grad_norm:25.784282982349396 - perf/mfu/actor:0.1042969032998117 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.30599594116211 - actor/lr:1e-06 - training/global_step:311 - training/epoch:8 - critic/score/mean:1.1906249523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1906249523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.4074457287788391 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.4074457287788391 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:540.4937744140625 - response_length/max:2048.0 - response_length/min:114.0 - response_length/clip_ratio:0.10625000298023224 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.190625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.401220500469208e-05 - timing_s/generate_sequences:64.26370239257812 - timing_s/reshard:0.7372024655342102 - timing_s/gen:66.50563763454556 - timing_s/reward:0.09713930822908878 - timing_s/old_log_prob:1.4720920156687498 - timing_s/ref:1.4198915250599384 - timing_s/adv:0.007752027362585068 - timing_s/update_actor:7.9331396501511335 - timing_s/step:77.45030963607132 - timing_s/stop_profile:4.5418739318847656e-05 - timing_per_token_ms/adv:2.5502774511083625e-05 - timing_per_token_ms/gen:0.3845190025008705 - timing_per_token_ms/ref:0.004671187510066646 - timing_per_token_ms/update_actor:0.02609860133353226 - perf/total_num_tokens:303968 - perf/time_per_step:77.45030963607132 - perf/throughput:490.5855144871355
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1328125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1328125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3142840564250946, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3142840564250946, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 506.1343688964844, 'response_length/max': 2048.0, 'response_length/min': 4.0, 'response_length/clip_ratio': 0.10625000298023224, 'prompt_length/mean': 410.609375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1328125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:312 - global_seqlen/min:29662 - global_seqlen/max:43511 - global_seqlen/minmax_diff:13849 - global_seqlen/balanced_min:36431 - global_seqlen/balanced_max:37383 - global_seqlen/mean:36669.75 - actor/entropy:0.26291051506996155 - actor/kl_loss:0.16736876629292965 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10015251846052706 - actor/pg_clipfrac:0.0028312750509940088 - actor/ppo_kl:0.01074414059985429 - actor/pg_clipfrac_lower:0.00012956376012880356 - actor/grad_norm:37.29589334130287 - perf/mfu/actor:0.10374937479005235 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.2640380859375 - actor/lr:1e-06 - training/global_step:312 - training/epoch:8 - critic/score/mean:1.1328125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1328125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3142840564250946 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3142840564250946 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:506.1343688964844 - response_length/max:2048.0 - response_length/min:4.0 - response_length/clip_ratio:0.10625000298023224 - prompt_length/mean:410.609375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1328125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.398240268230438e-05 - timing_s/generate_sequences:64.28640747070312 - timing_s/reshard:0.695298433303833 - timing_s/gen:66.21280104108155 - timing_s/reward:0.09387918189167976 - timing_s/old_log_prob:1.4060993324965239 - timing_s/ref:1.3983429186046124 - timing_s/adv:0.007756493985652924 - timing_s/update_actor:7.6944407150149345 - timing_s/step:76.8274099919945 - timing_s/stop_profile:4.565715789794922e-05 - timing_per_token_ms/adv:2.644036973817971e-05 - timing_per_token_ms/gen:0.40881436526293996 - timing_per_token_ms/ref:0.004766677297379353 - timing_per_token_ms/update_actor:0.026228842284904227 - perf/total_num_tokens:293358 - perf/time_per_step:76.8274099919945 - perf/throughput:477.30035418115784
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.9859374761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.9859374761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.33636078238487244, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.33636078238487244, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 696.8218994140625, 'response_length/max': 2048.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.20624999701976776, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.9859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  60%|█████▉    | 313/525 [4:55:00<4:40:58, 79.52s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  60%|█████▉    | 314/525 [4:56:18<4:38:38, 79.24s/it]
[36m(TaskRunner pid=2949575)[0m step:313 - global_seqlen/min:34309 - global_seqlen/max:52270 - global_seqlen/minmax_diff:17961 - global_seqlen/balanced_min:43986 - global_seqlen/balanced_max:45002 - global_seqlen/mean:44240.375 - actor/entropy:0.19280694425106049 - actor/kl_loss:0.32097125984728336 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13868884276598692 - actor/pg_clipfrac:0.007420041425211821 - actor/ppo_kl:0.1627739583784205 - actor/pg_clipfrac_lower:0.00021835494844708593 - actor/grad_norm:68.11500710248947 - perf/mfu/actor:0.11987346206234534 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.23984909057617 - actor/lr:1e-06 - training/global_step:313 - training/epoch:8 - critic/score/mean:0.9859374761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.9859374761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.33636078238487244 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.33636078238487244 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:696.8218994140625 - response_length/max:2048.0 - response_length/min:91.0 - response_length/clip_ratio:0.20624999701976776 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.9859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.278526365756989e-05 - timing_s/generate_sequences:65.12531280517578 - timing_s/reshard:0.6878238916397095 - timing_s/gen:67.98368065990508 - timing_s/reward:0.11440271697938442 - timing_s/old_log_prob:1.5794163085520267 - timing_s/ref:1.449518034234643 - timing_s/adv:0.007922418415546417 - timing_s/update_actor:8.13470452092588 - timing_s/step:79.28367159329355 - timing_s/stop_profile:4.230625927448273e-05 - timing_per_token_ms/adv:2.238458200101835e-05 - timing_per_token_ms/gen:0.304882796715019 - timing_per_token_ms/ref:0.004095574557840669 - timing_per_token_ms/update_actor:0.022984390731672934 - perf/total_num_tokens:353923 - perf/time_per_step:79.28367159329355 - perf/throughput:558.0010878777492
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.0437500476837158, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.0437500476837158, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.40021803975105286, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.40021803975105286, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 637.3125, 'response_length/max': 2048.0, 'response_length/min': 3.0, 'response_length/clip_ratio': 0.16562500596046448, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.04375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:314 - global_seqlen/min:29273 - global_seqlen/max:51113 - global_seqlen/minmax_diff:21840 - global_seqlen/balanced_min:41365 - global_seqlen/balanced_max:42165 - global_seqlen/mean:41864.375 - actor/entropy:0.21626326441764832 - actor/kl_loss:0.2788020096719265 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10944670423632488 - actor/pg_clipfrac:0.006810413826315198 - actor/ppo_kl:-0.06430742768570781 - actor/pg_clipfrac_lower:0.0034711744927335532 - actor/grad_norm:46.586480021476746 - perf/mfu/actor:0.11576935610852174 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.24300765991211 - actor/lr:1e-06 - training/global_step:314 - training/epoch:8 - critic/score/mean:1.0437500476837158 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.0437500476837158 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.40021803975105286 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.40021803975105286 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:637.3125 - response_length/max:2048.0 - response_length/min:3.0 - response_length/clip_ratio:0.16562500596046448 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.04375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.66912305355072e-05 - timing_s/generate_sequences:64.86341094970703 - timing_s/reshard:0.7386857271194458 - timing_s/gen:67.30097467266023 - timing_s/reward:0.11034723557531834 - timing_s/old_log_prob:1.5834107622504234 - timing_s/ref:1.4436342976987362 - timing_s/adv:0.008169872686266899 - timing_s/update_actor:7.936080181971192 - timing_s/step:78.40003754012287 - timing_s/stop_profile:4.307739436626434e-05 - timing_per_token_ms/adv:2.439386914968544e-05 - timing_per_token_ms/gen:0.3300037985322165 - timing_per_token_ms/ref:0.004310449808753673 - timing_per_token_ms/update_actor:0.023695803956141685 - perf/total_num_tokens:334915 - perf/time_per_step:78.40003754012287 - perf/throughput:533.9841193133999
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3682544529438019, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3682544529438019, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 547.1375122070312, 'response_length/max': 2048.0, 'response_length/min': 93.0, 'response_length/clip_ratio': 0.12187500298023224, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  60%|██████    | 315/525 [4:57:36<4:35:35, 78.74s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  60%|██████    | 316/525 [4:58:56<4:35:08, 78.99s/it]
[36m(TaskRunner pid=2949575)[0m step:315 - global_seqlen/min:30597 - global_seqlen/max:52441 - global_seqlen/minmax_diff:21844 - global_seqlen/balanced_min:37378 - global_seqlen/balanced_max:38409 - global_seqlen/mean:38279.25 - actor/entropy:0.2607598304748535 - actor/kl_loss:0.29676441587507724 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04879698269069195 - actor/pg_clipfrac:0.009222365589812398 - actor/ppo_kl:0.06156015412293527 - actor/pg_clipfrac_lower:0.0008159952150890604 - actor/grad_norm:33.437031507492065 - perf/mfu/actor:0.10642197782955144 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:97.26863098144531 - actor/lr:1e-06 - training/global_step:315 - training/epoch:8 - critic/score/mean:1.125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3682544529438019 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3682544529438019 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:547.1375122070312 - response_length/max:2048.0 - response_length/min:93.0 - response_length/clip_ratio:0.12187500298023224 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.258650243282318e-05 - timing_s/generate_sequences:63.689483642578125 - timing_s/reshard:0.7016473412513733 - timing_s/gen:66.73468302190304 - timing_s/reward:0.10008065216243267 - timing_s/old_log_prob:1.463286504149437 - timing_s/ref:1.4045247863978148 - timing_s/adv:0.00823676586151123 - timing_s/update_actor:7.8484483398497105 - timing_s/step:77.5757146961987 - timing_s/stop_profile:4.46811318397522e-05 - timing_per_token_ms/adv:2.6896967226079504e-05 - timing_per_token_ms/gen:0.38115808995626693 - timing_per_token_ms/ref:0.004586443002402786 - timing_per_token_ms/update_actor:0.02562892539642793 - perf/total_num_tokens:306234 - perf/time_per_step:77.5757146961987 - perf/throughput:493.44372977946574
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.1749999523162842, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.1749999523162842, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.36141034960746765, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.36141034960746765, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 553.7374877929688, 'response_length/max': 2048.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.125, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.175, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:316 - global_seqlen/min:34149 - global_seqlen/max:52256 - global_seqlen/minmax_diff:18107 - global_seqlen/balanced_min:38521 - global_seqlen/balanced_max:38522 - global_seqlen/mean:38521.375 - actor/entropy:0.23407360911369324 - actor/kl_loss:0.4329879395663738 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21134001091122628 - actor/pg_clipfrac:0.012697216583183036 - actor/ppo_kl:-0.028983632219024003 - actor/pg_clipfrac_lower:0.0018821102814399638 - actor/grad_norm:18.945128858089447 - perf/mfu/actor:0.10747116913579338 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.00167846679688 - actor/lr:1e-06 - training/global_step:316 - training/epoch:9 - critic/score/mean:1.1749999523162842 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.1749999523162842 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.36141034960746765 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.36141034960746765 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:553.7374877929688 - response_length/max:2048.0 - response_length/min:88.0 - response_length/clip_ratio:0.125 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.175 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00038638897240161896 - timing_s/generate_sequences:63.67998123168945 - timing_s/reshard:0.7420145273208618 - timing_s/gen:66.74073969572783 - timing_s/reward:0.09965785406529903 - timing_s/old_log_prob:1.572727058082819 - timing_s/ref:1.444948734715581 - timing_s/adv:0.00986575148999691 - timing_s/update_actor:7.824932347983122 - timing_s/step:77.72976338490844 - timing_s/stop_profile:4.501268267631531e-05 - timing_per_token_ms/adv:3.201388673819701e-05 - timing_per_token_ms/gen:0.3766492454441851 - timing_per_token_ms/ref:0.004688788804642815 - timing_per_token_ms/update_actor:0.025391527262406656 - perf/total_num_tokens:308171 - perf/time_per_step:77.72976338490844 - perf/throughput:495.58075726085497
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.123437523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.123437523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.42340391874313354, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.42340391874313354, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 599.7281494140625, 'response_length/max': 2048.0, 'response_length/min': 83.0, 'response_length/clip_ratio': 0.14687499403953552, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1234375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  60%|██████    | 317/525 [5:00:14<4:33:15, 78.83s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  61%|██████    | 318/525 [5:01:32<4:31:20, 78.65s/it]
[36m(TaskRunner pid=2949575)[0m step:317 - global_seqlen/min:33911 - global_seqlen/max:49987 - global_seqlen/minmax_diff:16076 - global_seqlen/balanced_min:39711 - global_seqlen/balanced_max:40439 - global_seqlen/mean:40347.875 - actor/entropy:0.2203882932662964 - actor/kl_loss:0.19572761096060276 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17000871784985067 - actor/pg_clipfrac:0.006060789912589825 - actor/ppo_kl:0.03282582461106358 - actor/pg_clipfrac_lower:0.0004913256052532233 - actor/grad_norm:35.41666257381439 - perf/mfu/actor:0.11092194900037497 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.25800323486328 - actor/lr:1e-06 - training/global_step:317 - training/epoch:9 - critic/score/mean:1.123437523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.123437523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.42340391874313354 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.42340391874313354 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:599.7281494140625 - response_length/max:2048.0 - response_length/min:83.0 - response_length/clip_ratio:0.14687499403953552 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1234375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0001004878431558609 - timing_s/generate_sequences:64.359375 - timing_s/reshard:0.7165976762771606 - timing_s/gen:66.79997325129807 - timing_s/reward:0.10466769896447659 - timing_s/old_log_prob:1.6208863593637943 - timing_s/ref:1.47254229336977 - timing_s/adv:0.008260350674390793 - timing_s/update_actor:7.969486556947231 - timing_s/step:77.99237045273185 - timing_s/stop_profile:4.254095256328583e-05 - timing_per_token_ms/adv:2.559103383508671e-05 - timing_per_token_ms/gen:0.3480742484943598 - timing_per_token_ms/ref:0.004562019354705081 - timing_per_token_ms/update_actor:0.024689920339507444 - perf/total_num_tokens:322783 - perf/time_per_step:77.99237045273185 - perf/throughput:517.3310513039642
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.092187523841858, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.092187523841858, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.37246251106262207, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.37246251106262207, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 630.484375, 'response_length/max': 2048.0, 'response_length/min': 95.0, 'response_length/clip_ratio': 0.16875000298023224, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.0921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:318 - global_seqlen/min:34027 - global_seqlen/max:48948 - global_seqlen/minmax_diff:14921 - global_seqlen/balanced_min:40936 - global_seqlen/balanced_max:41805 - global_seqlen/mean:41586.875 - actor/entropy:0.20847319066524506 - actor/kl_loss:0.21315342076122762 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2060422170907259 - actor/pg_clipfrac:0.0055182158073876055 - actor/ppo_kl:-0.1068375291859411 - actor/pg_clipfrac_lower:0.005613366095349193 - actor/grad_norm:45.73876115679741 - perf/mfu/actor:0.11493500014432391 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.17631912231445 - actor/lr:1e-06 - training/global_step:318 - training/epoch:9 - critic/score/mean:1.092187523841858 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.092187523841858 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.37246251106262207 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.37246251106262207 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:630.484375 - response_length/max:2048.0 - response_length/min:95.0 - response_length/clip_ratio:0.16875000298023224 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.0921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.692406117916107e-05 - timing_s/generate_sequences:64.52177429199219 - timing_s/reshard:0.8608193397521973 - timing_s/gen:67.09965268336236 - timing_s/reward:0.10844942554831505 - timing_s/old_log_prob:1.5952235870063305 - timing_s/ref:1.4531013406813145 - timing_s/adv:0.00786040909588337 - timing_s/update_actor:7.943098904564977 - timing_s/step:78.22385304607451 - timing_s/stop_profile:4.3895095586776733e-05 - timing_per_token_ms/adv:2.362647198149467e-05 - timing_per_token_ms/gen:0.3325798750135678 - timing_per_token_ms/ref:0.004367668106467829 - timing_per_token_ms/update_actor:0.023875017371962237 - perf/total_num_tokens:332695 - perf/time_per_step:78.22385304607451 - perf/throughput:531.6393066895462
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.2265625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.2265625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.37876394391059875, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.37876394391059875, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 514.5250244140625, 'response_length/max': 2048.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.10625000298023224, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.2265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  61%|██████    | 319/525 [5:02:49<4:27:37, 77.95s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:43:57,246:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:44:01,966:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:44:01,968:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:43:57,558:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:44:02,512:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  61%|██████    | 320/525 [5:04:17<4:37:30, 81.22s/it]
[36m(TaskRunner pid=2949575)[0m step:319 - global_seqlen/min:32453 - global_seqlen/max:43591 - global_seqlen/minmax_diff:11138 - global_seqlen/balanced_min:36684 - global_seqlen/balanced_max:37774 - global_seqlen/mean:36957.25 - actor/entropy:0.2568257451057434 - actor/kl_loss:0.17405832782387734 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1043934851884842 - actor/pg_clipfrac:0.003843425720697269 - actor/ppo_kl:0.05320681012817659 - actor/pg_clipfrac_lower:0.00022354694083333017 - actor/grad_norm:37.16127422451973 - perf/mfu/actor:0.10355536357760928 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.24831771850586 - actor/lr:1e-06 - training/global_step:319 - training/epoch:9 - critic/score/mean:1.2265625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.2265625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.37876394391059875 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.37876394391059875 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:514.5250244140625 - response_length/max:2048.0 - response_length/min:101.0 - response_length/clip_ratio:0.10625000298023224 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.2265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010015442967414856 - timing_s/generate_sequences:63.41279220581055 - timing_s/reshard:0.7063466310501099 - timing_s/gen:65.26143447309732 - timing_s/reward:0.09460534155368805 - timing_s/old_log_prob:1.510320845991373 - timing_s/ref:1.4091265834867954 - timing_s/adv:0.0076138731092214584 - timing_s/update_actor:7.774772038683295 - timing_s/step:76.07343021780252 - timing_s/stop_profile:4.612281918525696e-05 - timing_per_token_ms/adv:2.575229863295246e-05 - timing_per_token_ms/gen:0.39636943341611997 - timing_per_token_ms/ref:0.004766069524541177 - timing_per_token_ms/update_actor:0.026296504876185643 - perf/total_num_tokens:295658 - perf/time_per_step:76.07343021780252 - perf/throughput:485.8102217053879
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 1.126562476158142, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 1.126562476158142, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.3469298481941223, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.3469298481941223, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 594.15625, 'response_length/max': 2048.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.14687499403953552, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 1.1265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:320 - global_seqlen/min:35165 - global_seqlen/max:49187 - global_seqlen/minmax_diff:14022 - global_seqlen/balanced_min:39581 - global_seqlen/balanced_max:40228 - global_seqlen/mean:40146.875 - actor/entropy:0.2171517163515091 - actor/kl_loss:0.195906213670969 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.054678394086658956 - actor/pg_clipfrac:0.0030595201722462663 - actor/ppo_kl:-0.03679627294186503 - actor/pg_clipfrac_lower:0.00019797275890596211 - actor/grad_norm:49.16919323801994 - perf/mfu/actor:0.10920768967913222 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.24250793457031 - actor/lr:1e-06 - training/global_step:320 - training/epoch:9 - critic/score/mean:1.126562476158142 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:1.126562476158142 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.3469298481941223 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.3469298481941223 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:594.15625 - response_length/max:2048.0 - response_length/min:99.0 - response_length/clip_ratio:0.14687499403953552 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:1.1265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.602626621723175e-05 - timing_s/generate_sequences:64.03152465820312 - timing_s/reshard:0.7259072065353394 - timing_s/gen:67.34362033940852 - timing_s/reward:0.10318237729370594 - timing_s/old_log_prob:1.5491546411067247 - timing_s/ref:1.4777518901973963 - timing_s/adv:0.008251270279288292 - timing_s/update_actor:8.05012809485197 - timing_s/save_checkpoint:10.299932792782784 - timing_s/step:88.84735886380076 - timing_s/stop_profile:4.937313497066498e-05 - timing_per_token_ms/adv:2.5690885901107782e-05 - timing_per_token_ms/gen:0.35419776121289914 - timing_per_token_ms/ref:0.004601080065999521 - timing_per_token_ms/update_actor:0.02506461615895375 - perf/total_num_tokens:321175 - perf/time_per_step:88.84735886380076 - perf/throughput:451.8634601344026
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8765624761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8765624761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.27957838773727417, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.27957838773727417, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 817.2937622070312, 'response_length/max': 2048.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.2718749940395355, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8765625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  61%|██████    | 321/525 [5:05:38<4:35:17, 80.97s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:44:04,006:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:44:04,008:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_320/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  61%|██████▏   | 322/525 [5:07:01<4:36:08, 81.62s/it]
[36m(TaskRunner pid=2949575)[0m step:321 - global_seqlen/min:35396 - global_seqlen/max:56327 - global_seqlen/minmax_diff:20931 - global_seqlen/balanced_min:48351 - global_seqlen/balanced_max:49157 - global_seqlen/mean:49054.875 - actor/entropy:0.1574983298778534 - actor/kl_loss:0.2623215287923813 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16582800410687923 - actor/pg_clipfrac:0.005268005962716415 - actor/ppo_kl:0.03078803958487697 - actor/pg_clipfrac_lower:0.0005091976883704775 - actor/grad_norm:18.237148374319077 - perf/mfu/actor:0.13155809494543078 - perf/max_memory_allocated_gb:70.79563236236572 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.36326217651367 - actor/lr:1e-06 - training/global_step:321 - training/epoch:9 - critic/score/mean:0.8765624761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8765624761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.27957838773727417 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.27957838773727417 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:817.2937622070312 - response_length/max:2048.0 - response_length/min:85.0 - response_length/clip_ratio:0.2718749940395355 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8765625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.516067802906036e-05 - timing_s/generate_sequences:66.02503967285156 - timing_s/reshard:0.6823750138282776 - timing_s/gen:68.64252660609782 - timing_s/reward:0.1256898883730173 - timing_s/old_log_prob:1.6652824021875858 - timing_s/ref:1.5088509805500507 - timing_s/adv:0.007992254570126534 - timing_s/update_actor:8.27032415010035 - timing_s/step:80.23556511849165 - timing_s/stop_profile:4.610233008861542e-05 - timing_per_token_ms/adv:2.03655971249711e-05 - timing_per_token_ms/gen:0.26246119665549345 - timing_per_token_ms/ref:0.0038448038562682372 - timing_per_token_ms/update_actor:0.021074164774908585 - perf/total_num_tokens:392439 - perf/time_per_step:80.23556511849165 - perf/throughput:611.3856732679069
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.651562511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.651562511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12139938026666641, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12139938026666641, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1058.262451171875, 'response_length/max': 2048.0, 'response_length/min': 64.0, 'response_length/clip_ratio': 0.421875, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:322 - global_seqlen/min:46640 - global_seqlen/max:83144 - global_seqlen/minmax_diff:36504 - global_seqlen/balanced_min:58052 - global_seqlen/balanced_max:58811 - global_seqlen/mean:58715.5 - actor/entropy:0.0874413475394249 - actor/kl_loss:0.32450924068689346 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07156846765428782 - actor/pg_clipfrac:0.008417443439248018 - actor/ppo_kl:0.06414336840389297 - actor/pg_clipfrac_lower:0.00032000397040974347 - actor/grad_norm:15.005167692899704 - perf/mfu/actor:0.15340147945937016 - perf/max_memory_allocated_gb:70.93808889389038 - perf/max_memory_reserved_gb:105.185546875 - perf/cpu_memory_used_gb:98.32908248901367 - actor/lr:1e-06 - training/global_step:322 - training/epoch:9 - critic/score/mean:0.651562511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.651562511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12139938026666641 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12139938026666641 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1058.262451171875 - response_length/max:2048.0 - response_length/min:64.0 - response_length/clip_ratio:0.421875 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.528865873813629e-05 - timing_s/generate_sequences:67.29534912109375 - timing_s/reshard:0.7337376475334167 - timing_s/gen:70.6471822950989 - timing_s/reward:0.1520496867597103 - timing_s/old_log_prob:1.9671249575912952 - timing_s/ref:1.7525335829705 - timing_s/adv:0.008176973089575768 - timing_s/update_actor:8.582272181287408 - timing_s/step:83.12472168542445 - timing_s/stop_profile:4.497542977333069e-05 - timing_per_token_ms/adv:1.7408037676541476e-05 - timing_per_token_ms/gen:0.20861784734145267 - timing_per_token_ms/ref:0.0037309858192694006 - timing_per_token_ms/update_actor:0.01827088286161109 - perf/total_num_tokens:469724 - perf/time_per_step:83.12472168542445 - perf/throughput:706.3542446758712
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6109374761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6109374761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09677071869373322, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09677071869373322, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1118.840576171875, 'response_length/max': 2048.0, 'response_length/min': 90.0, 'response_length/clip_ratio': 0.44999998807907104, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  62%|██████▏   | 323/525 [5:08:25<4:37:21, 82.38s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  62%|██████▏   | 324/525 [5:09:46<4:34:58, 82.08s/it]
[36m(TaskRunner pid=2949575)[0m step:323 - global_seqlen/min:39989 - global_seqlen/max:79311 - global_seqlen/minmax_diff:39322 - global_seqlen/balanced_min:61147 - global_seqlen/balanced_max:61148 - global_seqlen/mean:61147.375 - actor/entropy:0.07944882661104202 - actor/kl_loss:0.26639802493155 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.005480658123269677 - actor/pg_clipfrac:0.0013486872194334865 - actor/ppo_kl:-0.026369441047245347 - actor/pg_clipfrac_lower:0.0017484447103925048 - actor/grad_norm:30.040137231349945 - perf/mfu/actor:0.15224570333989687 - perf/max_memory_allocated_gb:70.93808889389038 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.34493255615234 - actor/lr:1e-06 - training/global_step:323 - training/epoch:9 - critic/score/mean:0.6109374761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6109374761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09677071869373322 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09677071869373322 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1118.840576171875 - response_length/max:2048.0 - response_length/min:90.0 - response_length/clip_ratio:0.44999998807907104 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.510425686836243e-05 - timing_s/generate_sequences:67.69365692138672 - timing_s/reshard:0.8833900094032288 - timing_s/gen:71.17456072568893 - timing_s/reward:0.15938420221209526 - timing_s/old_log_prob:2.025611786171794 - timing_s/ref:1.7603141944855452 - timing_s/adv:0.0077649932354688644 - timing_s/update_actor:9.014092007651925 - timing_s/step:84.15632973238826 - timing_s/stop_profile:4.2382627725601196e-05 - timing_per_token_ms/adv:1.587352121711861e-05 - timing_per_token_ms/gen:0.19879551859120054 - timing_per_token_ms/ref:0.0035985072836028226 - timing_per_token_ms/update_actor:0.018426980732312557 - perf/total_num_tokens:489179 - perf/time_per_step:84.15632973238826 - perf/throughput:726.5927018733438
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8265625238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8265625238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10764981061220169, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10764981061220169, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 952.1624755859375, 'response_length/max': 2048.0, 'response_length/min': 52.0, 'response_length/clip_ratio': 0.3499999940395355, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:324 - global_seqlen/min:34692 - global_seqlen/max:75251 - global_seqlen/minmax_diff:40559 - global_seqlen/balanced_min:54449 - global_seqlen/balanced_max:54450 - global_seqlen/mean:54449.625 - actor/entropy:0.11395096033811569 - actor/kl_loss:0.27599105313420297 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08247639536857605 - actor/pg_clipfrac:0.004912918867194094 - actor/ppo_kl:-0.05955476758726945 - actor/pg_clipfrac_lower:7.977662608027458e-05 - actor/grad_norm:36.792458191514015 - perf/mfu/actor:0.13867739097260134 - perf/max_memory_allocated_gb:70.93808889389038 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.27495956420898 - actor/lr:1e-06 - training/global_step:324 - training/epoch:9 - critic/score/mean:0.8265625238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8265625238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10764981061220169 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10764981061220169 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:952.1624755859375 - response_length/max:2048.0 - response_length/min:52.0 - response_length/clip_ratio:0.3499999940395355 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.602494537830353e-05 - timing_s/generate_sequences:66.05924224853516 - timing_s/reshard:0.8676938414573669 - timing_s/gen:68.75515516661108 - timing_s/reward:0.1398748829960823 - timing_s/old_log_prob:1.9483675695955753 - timing_s/ref:1.658451871946454 - timing_s/adv:0.007797146216034889 - timing_s/update_actor:8.758584786206484 - timing_s/step:81.28192252852023 - timing_s/stop_profile:4.2088329792022705e-05 - timing_per_token_ms/adv:1.789990797924432e-05 - timing_per_token_ms/gen:0.22565461241716578 - timing_per_token_ms/ref:0.003807307837167047 - timing_per_token_ms/update_actor:0.020107082432171214 - perf/total_num_tokens:435597 - perf/time_per_step:81.28192252852023 - perf/throughput:669.8860374629389
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11243853718042374, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11243853718042374, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1062.737548828125, 'response_length/max': 2048.0, 'response_length/min': 49.0, 'response_length/clip_ratio': 0.4312500059604645, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  62%|██████▏   | 325/525 [5:11:10<4:34:49, 82.45s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  62%|██████▏   | 326/525 [5:12:34<4:35:07, 82.95s/it]
[36m(TaskRunner pid=2949575)[0m step:325 - global_seqlen/min:43101 - global_seqlen/max:87857 - global_seqlen/minmax_diff:44756 - global_seqlen/balanced_min:58621 - global_seqlen/balanced_max:59732 - global_seqlen/mean:58898.875 - actor/entropy:0.08536755293607712 - actor/kl_loss:0.2750901602208614 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.214518528804183 - actor/pg_clipfrac:0.0006746421466232277 - actor/ppo_kl:-0.026062281698341395 - actor/pg_clipfrac_lower:0.0013056680036243051 - actor/grad_norm:5.505865812301636 - perf/mfu/actor:0.14887662762425763 - perf/max_memory_allocated_gb:70.93808889389038 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.48815536499023 - actor/lr:1e-06 - training/global_step:325 - training/epoch:9 - critic/score/mean:0.625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11243853718042374 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11243853718042374 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1062.737548828125 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.4312500059604645 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.927339851856232e-05 - timing_s/generate_sequences:67.08199310302734 - timing_s/reshard:0.7552264928817749 - timing_s/gen:70.12936872802675 - timing_s/reward:0.15277929976582527 - timing_s/old_log_prob:2.044426005333662 - timing_s/ref:1.6656939797103405 - timing_s/adv:0.0078062210232019424 - timing_s/update_actor:8.875527698546648 - timing_s/step:82.89080830663443 - timing_s/stop_profile:4.266388714313507e-05 - timing_per_token_ms/adv:1.6566999418923413e-05 - timing_per_token_ms/gen:0.20621675369043022 - timing_per_token_ms/ref:0.0035350717218926944 - timing_per_token_ms/update_actor:0.018836369324852657 - perf/total_num_tokens:471191 - perf/time_per_step:82.89080830663443 - perf/throughput:710.5597858584985
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5234375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5234375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08951215445995331, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08951215445995331, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1191.1343994140625, 'response_length/max': 2048.0, 'response_length/min': 111.0, 'response_length/clip_ratio': 0.484375, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5234375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:326 - global_seqlen/min:52799 - global_seqlen/max:74262 - global_seqlen/minmax_diff:21463 - global_seqlen/balanced_min:63729 - global_seqlen/balanced_max:64578 - global_seqlen/mean:64047.875 - actor/entropy:0.07702679187059402 - actor/kl_loss:0.25960917621850965 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12719920929521322 - actor/pg_clipfrac:0.0013988514212542214 - actor/ppo_kl:0.004759925621328875 - actor/pg_clipfrac_lower:5.035246722400189e-05 - actor/grad_norm:20.19008420407772 - perf/mfu/actor:0.15622691981407702 - perf/max_memory_allocated_gb:74.0533185005188 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.39382934570312 - actor/lr:1e-06 - training/global_step:326 - training/epoch:9 - critic/score/mean:0.5234375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5234375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08951215445995331 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08951215445995331 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1191.1343994140625 - response_length/max:2048.0 - response_length/min:111.0 - response_length/clip_ratio:0.484375 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5234375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.500553667545319e-05 - timing_s/generate_sequences:67.85276794433594 - timing_s/reshard:0.7903079986572266 - timing_s/gen:70.7590792067349 - timing_s/reward:0.17010842263698578 - timing_s/old_log_prob:2.1610133592039347 - timing_s/ref:1.796250443905592 - timing_s/adv:0.00794074684381485 - timing_s/update_actor:9.215617826208472 - timing_s/step:84.12430162169039 - timing_s/stop_profile:4.4638291001319885e-05 - timing_per_token_ms/adv:1.5497678189586403e-05 - timing_per_token_ms/gen:0.1856399472318533 - timing_per_token_ms/ref:0.0035056792358559748 - timing_per_token_ms/update_actor:0.017985799345818405 - perf/total_num_tokens:512383 - perf/time_per_step:84.12430162169039 - perf/throughput:761.348073806607
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.737500011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.737500011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.052948031574487686, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.052948031574487686, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1039.065673828125, 'response_length/max': 2048.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.3968749940395355, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  62%|██████▏   | 327/525 [5:13:56<4:32:44, 82.65s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  62%|██████▏   | 328/525 [5:15:18<4:31:09, 82.59s/it]
[36m(TaskRunner pid=2949575)[0m step:327 - global_seqlen/min:40625 - global_seqlen/max:67448 - global_seqlen/minmax_diff:26823 - global_seqlen/balanced_min:57294 - global_seqlen/balanced_max:58037 - global_seqlen/mean:57943.25 - actor/entropy:0.09461396932601929 - actor/kl_loss:0.33901501074433327 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06712910849601031 - actor/pg_clipfrac:0.002835031523136422 - actor/ppo_kl:0.07414004490747175 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:9.136224925518036 - perf/mfu/actor:0.1476087624235176 - perf/max_memory_allocated_gb:74.0533185005188 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.40873336791992 - actor/lr:1e-06 - training/global_step:327 - training/epoch:9 - critic/score/mean:0.737500011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.737500011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.052948031574487686 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.052948031574487686 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:1039.065673828125 - response_length/max:2048.0 - response_length/min:70.0 - response_length/clip_ratio:0.3968749940395355 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.823590517044067e-05 - timing_s/generate_sequences:66.70416259765625 - timing_s/reshard:0.8087353706359863 - timing_s/gen:69.130047025159 - timing_s/reward:0.1495475433766842 - timing_s/old_log_prob:1.9711689315736294 - timing_s/ref:1.6564424261450768 - timing_s/adv:0.007841004058718681 - timing_s/update_actor:8.78235955350101 - timing_s/step:81.71277272701263 - timing_s/stop_profile:4.433467984199524e-05 - timing_per_token_ms/adv:1.691526635699301e-05 - timing_per_token_ms/gen:0.2079092905740404 - timing_per_token_ms/ref:0.0035734154240249657 - timing_per_token_ms/update_actor:0.018946036754714762 - perf/total_num_tokens:463546 - perf/time_per_step:81.71277272701263 - perf/throughput:709.1088463437382
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5249999761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5249999761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10959804058074951, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10959804058074951, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1190.6968994140625, 'response_length/max': 2048.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.4937500059604645, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.525, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:328 - global_seqlen/min:49670 - global_seqlen/max:83201 - global_seqlen/minmax_diff:33531 - global_seqlen/balanced_min:63396 - global_seqlen/balanced_max:64237 - global_seqlen/mean:64026.0 - actor/entropy:0.0651988536119461 - actor/kl_loss:0.36483261063694955 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.20510222762823105 - actor/pg_clipfrac:0.004942717717494815 - actor/ppo_kl:0.05429424194007879 - actor/pg_clipfrac_lower:0.0004387387351016514 - actor/grad_norm:7.94586181640625 - perf/mfu/actor:0.15892666604163488 - perf/max_memory_allocated_gb:74.0533185005188 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.29585266113281 - actor/lr:1e-06 - training/global_step:328 - training/epoch:9 - critic/score/mean:0.5249999761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5249999761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10959804058074951 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10959804058074951 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1190.6968994140625 - response_length/max:2048.0 - response_length/min:82.0 - response_length/clip_ratio:0.4937500059604645 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.525 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.69259238243103e-05 - timing_s/generate_sequences:67.60575103759766 - timing_s/reshard:0.832076370716095 - timing_s/gen:69.29142503254116 - timing_s/reward:0.16349073871970177 - timing_s/old_log_prob:2.1016961093991995 - timing_s/ref:1.7855506800115108 - timing_s/adv:0.007875807583332062 - timing_s/update_actor:9.061653930693865 - timing_s/step:82.42690886370838 - timing_s/stop_profile:4.6037137508392334e-05 - timing_per_token_ms/adv:1.5376190108963666e-05 - timing_per_token_ms/gen:0.18185627910268187 - timing_per_token_ms/ref:0.003485987489479881 - timing_per_token_ms/update_actor:0.017691355720125153 - perf/total_num_tokens:512208 - perf/time_per_step:82.42690886370838 - perf/throughput:776.7609010531501
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5718749761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5718749761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11463586241006851, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11463586241006851, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1143.6812744140625, 'response_length/max': 2048.0, 'response_length/min': 119.0, 'response_length/clip_ratio': 0.4593749940395355, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.571875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  63%|██████▎   | 329/525 [5:16:41<4:30:00, 82.66s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 04:57:54,372:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 04:57:59,112:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 04:57:59,114:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:57:54,762:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 04:58:00,446:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  63%|██████▎   | 330/525 [5:18:15<4:39:33, 86.02s/it]
[36m(TaskRunner pid=2949575)[0m step:329 - global_seqlen/min:47577 - global_seqlen/max:76683 - global_seqlen/minmax_diff:29106 - global_seqlen/balanced_min:61791 - global_seqlen/balanced_max:62674 - global_seqlen/mean:62136.625 - actor/entropy:0.07575665414333344 - actor/kl_loss:0.2497199885547161 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13472451334819197 - actor/pg_clipfrac:0.002175305358832702 - actor/ppo_kl:-0.03736709134755074 - actor/pg_clipfrac_lower:0.0017598593840375543 - actor/grad_norm:49.646954983472824 - perf/mfu/actor:0.15157570128760178 - perf/max_memory_allocated_gb:74.0533185005188 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.28073501586914 - actor/lr:1e-06 - training/global_step:329 - training/epoch:9 - critic/score/mean:0.5718749761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5718749761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11463586241006851 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11463586241006851 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1143.6812744140625 - response_length/max:2048.0 - response_length/min:119.0 - response_length/clip_ratio:0.4593749940395355 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.571875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.840354323387146e-05 - timing_s/generate_sequences:67.25495910644531 - timing_s/reshard:0.7866576313972473 - timing_s/gen:69.40231654047966 - timing_s/reward:0.15935084782540798 - timing_s/old_log_prob:2.1196330282837152 - timing_s/ref:1.774205543100834 - timing_s/adv:0.008269445970654488 - timing_s/update_actor:9.205441981554031 - timing_s/step:82.68445967696607 - timing_s/stop_profile:4.513561725616455e-05 - timing_per_token_ms/adv:1.6635611385906636e-05 - timing_per_token_ms/gen:0.18963521452240206 - timing_per_token_ms/ref:0.003569162195204587 - timing_per_token_ms/update_actor:0.018518550817561364 - perf/total_num_tokens:497093 - perf/time_per_step:82.68445967696607 - perf/throughput:751.4909723393862
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.574999988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.574999988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12107358872890472, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12107358872890472, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1124.9937744140625, 'response_length/max': 2048.0, 'response_length/min': 79.0, 'response_length/clip_ratio': 0.453125, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.575, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:330 - global_seqlen/min:49288 - global_seqlen/max:72338 - global_seqlen/minmax_diff:23050 - global_seqlen/balanced_min:61245 - global_seqlen/balanced_max:62343 - global_seqlen/mean:61384.75 - actor/entropy:0.09484313428401947 - actor/kl_loss:0.2658870745450258 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1435677251778543 - actor/pg_clipfrac:0.0019369035537238233 - actor/ppo_kl:0.011628284328435257 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:21.45765647292137 - perf/mfu/actor:0.1545696577762989 - perf/max_memory_allocated_gb:74.0533185005188 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.18364334106445 - actor/lr:1e-06 - training/global_step:330 - training/epoch:9 - critic/score/mean:0.574999988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.574999988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12107358872890472 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12107358872890472 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1124.9937744140625 - response_length/max:2048.0 - response_length/min:79.0 - response_length/clip_ratio:0.453125 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.575 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.50427895784378e-05 - timing_s/generate_sequences:67.90494537353516 - timing_s/reshard:0.871024489402771 - timing_s/gen:70.44993383996189 - timing_s/reward:0.15930207073688507 - timing_s/old_log_prob:1.951638150960207 - timing_s/ref:1.676988322287798 - timing_s/adv:0.00779062882065773 - timing_s/update_actor:8.913516230881214 - timing_s/save_checkpoint:10.668850431218743 - timing_s/step:93.84312954172492 - timing_s/stop_profile:5.1468610763549805e-05 - timing_per_token_ms/adv:1.5864340941067875e-05 - timing_per_token_ms/gen:0.19569534786293782 - timing_per_token_ms/ref:0.0034149123403772884 - timing_per_token_ms/update_actor:0.01815091743242665 - perf/total_num_tokens:491078 - perf/time_per_step:93.84312954172492 - perf/throughput:654.1208749086619
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.675000011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.675000011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10143272578716278, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10143272578716278, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1057.078125, 'response_length/max': 2048.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.41874998807907104, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.675, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  63%|██████▎   | 331/525 [5:19:38<4:34:56, 85.04s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:58:01,551:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 04:58:01,553:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_330/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  63%|██████▎   | 332/525 [5:21:00<4:30:50, 84.20s/it]
[36m(TaskRunner pid=2949575)[0m step:331 - global_seqlen/min:46871 - global_seqlen/max:80087 - global_seqlen/minmax_diff:33216 - global_seqlen/balanced_min:57908 - global_seqlen/balanced_max:58918 - global_seqlen/mean:58663.75 - actor/entropy:0.08743847161531448 - actor/kl_loss:0.32764039374887943 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13293390898033977 - actor/pg_clipfrac:0.001273701581521891 - actor/ppo_kl:-0.005492020044766832 - actor/pg_clipfrac_lower:0.0005721485824324191 - actor/grad_norm:8.25698547065258 - perf/mfu/actor:0.14647258399572605 - perf/max_memory_allocated_gb:74.0533185005188 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.33291244506836 - actor/lr:1e-06 - training/global_step:331 - training/epoch:9 - critic/score/mean:0.675000011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.675000011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10143272578716278 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10143272578716278 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1057.078125 - response_length/max:2048.0 - response_length/min:85.0 - response_length/clip_ratio:0.41874998807907104 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.675 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.142739534378052e-05 - timing_s/generate_sequences:67.50762939453125 - timing_s/reshard:0.8329039812088013 - timing_s/gen:69.84327797219157 - timing_s/reward:0.15135573409497738 - timing_s/old_log_prob:2.0113082695752382 - timing_s/ref:1.7297026012092829 - timing_s/adv:0.0077796820551157 - timing_s/update_actor:8.97505210340023 - timing_s/step:82.73297964408994 - timing_s/stop_profile:4.5243650674819946e-05 - timing_per_token_ms/adv:1.657685123929961e-05 - timing_per_token_ms/gen:0.20647503576246898 - timing_per_token_ms/ref:0.0036856291176605716 - timing_per_token_ms/update_actor:0.019123931097569262 - perf/total_num_tokens:469310 - perf/time_per_step:82.73297964408994 - perf/throughput:709.07333752956
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5453125238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5453125238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.133863165974617, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.133863165974617, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1128.393798828125, 'response_length/max': 2048.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.46562498807907104, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5453125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:332 - global_seqlen/min:52073 - global_seqlen/max:75954 - global_seqlen/minmax_diff:23881 - global_seqlen/balanced_min:60816 - global_seqlen/balanced_max:61918 - global_seqlen/mean:61516.375 - actor/entropy:0.08532439172267914 - actor/kl_loss:0.28399931713938714 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03606072645634413 - actor/pg_clipfrac:0.0027450594847323374 - actor/ppo_kl:-0.005046351444798347 - actor/pg_clipfrac_lower:0.00010267129400745034 - actor/grad_norm:43.38811847567558 - perf/mfu/actor:0.15758325607449855 - perf/max_memory_allocated_gb:74.06689929962158 - perf/max_memory_reserved_gb:114.68359375 - perf/cpu_memory_used_gb:98.40460205078125 - actor/lr:1e-06 - training/global_step:332 - training/epoch:9 - critic/score/mean:0.5453125238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5453125238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.133863165974617 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.133863165974617 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1128.393798828125 - response_length/max:2048.0 - response_length/min:85.0 - response_length/clip_ratio:0.46562498807907104 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5453125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.187310934066772e-05 - timing_s/generate_sequences:67.4570083618164 - timing_s/reshard:0.8315497040748596 - timing_s/gen:69.51645460538566 - timing_s/reward:0.15803332813084126 - timing_s/old_log_prob:1.972369996830821 - timing_s/ref:1.6836895737797022 - timing_s/adv:0.008128175511956215 - timing_s/update_actor:8.771172342821956 - timing_s/step:82.12636557593942 - timing_s/stop_profile:4.477053880691528e-05 - timing_per_token_ms/adv:1.651628430632538e-05 - timing_per_token_ms/gen:0.19252049263994078 - timing_per_token_ms/ref:0.0034212223448222166 - timing_per_token_ms/update_actor:0.017822840550223325 - perf/total_num_tokens:492131 - perf/time_per_step:82.12636557593942 - perf/throughput:749.0453835208126
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.534375011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.534375011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11484717577695847, 'critic/advantages/max': 1.2915425300598145, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11484717577695847, 'critic/returns/max': 1.2915425300598145, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1150.4000244140625, 'response_length/max': 2048.0, 'response_length/min': 62.0, 'response_length/clip_ratio': 0.48124998807907104, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.534375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  63%|██████▎   | 333/525 [5:22:25<4:30:20, 84.48s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  64%|██████▎   | 334/525 [5:23:47<4:26:01, 83.57s/it]
[36m(TaskRunner pid=2949575)[0m step:333 - global_seqlen/min:48569 - global_seqlen/max:84584 - global_seqlen/minmax_diff:36015 - global_seqlen/balanced_min:62153 - global_seqlen/balanced_max:63147 - global_seqlen/mean:62405.375 - actor/entropy:0.06984493136405945 - actor/kl_loss:0.253950859606266 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16256763897836207 - actor/pg_clipfrac:0.0014642015215940774 - actor/ppo_kl:0.006803027985733933 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:29.93968164920807 - perf/mfu/actor:0.15160205489914777 - perf/max_memory_allocated_gb:74.06689929962158 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.37849426269531 - actor/lr:1e-06 - training/global_step:333 - training/epoch:9 - critic/score/mean:0.534375011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.534375011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11484717577695847 - critic/advantages/max:1.2915425300598145 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11484717577695847 - critic/returns/max:1.2915425300598145 - critic/returns/min:-1.7888528108596802 - response_length/mean:1150.4000244140625 - response_length/max:2048.0 - response_length/min:62.0 - response_length/clip_ratio:0.48124998807907104 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.534375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.487196803092957e-05 - timing_s/generate_sequences:67.27183532714844 - timing_s/reshard:0.8123335242271423 - timing_s/gen:71.29430855624378 - timing_s/reward:0.15966054052114487 - timing_s/old_log_prob:2.1907981764525175 - timing_s/ref:1.806479437276721 - timing_s/adv:0.0086212158203125 - timing_s/update_actor:9.256473643705249 - timing_s/step:84.73193255066872 - timing_s/stop_profile:4.665181040763855e-05 - timing_per_token_ms/adv:1.7268576265090345e-05 - timing_per_token_ms/gen:0.19366717162574915 - timing_per_token_ms/ref:0.0036184371884567653 - timing_per_token_ms/update_actor:0.018541018389251825 - perf/total_num_tokens:499243 - perf/time_per_step:84.73193255066872 - perf/throughput:736.5036193725701
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.690625011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.690625011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12929658591747284, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12929658591747284, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1041.4781494140625, 'response_length/max': 2048.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.4156250059604645, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.690625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:334 - global_seqlen/min:49631 - global_seqlen/max:69994 - global_seqlen/minmax_diff:20363 - global_seqlen/balanced_min:57400 - global_seqlen/balanced_max:58403 - global_seqlen/mean:58026.625 - actor/entropy:0.0931629166007042 - actor/kl_loss:0.35031676664948463 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04461907078512013 - actor/pg_clipfrac:0.003536528661788907 - actor/ppo_kl:0.040873018731872435 - actor/pg_clipfrac_lower:0.00018418786348775029 - actor/grad_norm:16.512868016958237 - perf/mfu/actor:0.14947196715879996 - perf/max_memory_allocated_gb:74.06689929962158 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.31176376342773 - actor/lr:1e-06 - training/global_step:334 - training/epoch:9 - critic/score/mean:0.690625011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.690625011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12929658591747284 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12929658591747284 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1041.4781494140625 - response_length/max:2048.0 - response_length/min:80.0 - response_length/clip_ratio:0.4156250059604645 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.690625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.08611512184143e-05 - timing_s/generate_sequences:66.484130859375 - timing_s/reshard:0.9018614292144775 - timing_s/gen:69.00386134721339 - timing_s/reward:0.14797239936888218 - timing_s/old_log_prob:1.9184626135975122 - timing_s/ref:1.6251664012670517 - timing_s/adv:0.008013971149921417 - timing_s/update_actor:8.700202636420727 - timing_s/step:81.41970449872315 - timing_s/stop_profile:4.443898797035217e-05 - timing_per_token_ms/adv:1.7263564678114178e-05 - timing_per_token_ms/gen:0.20704905992148595 - timing_per_token_ms/ref:0.003500906698578135 - timing_per_token_ms/update_actor:0.0187418332455591 - perf/total_num_tokens:464213 - perf/time_per_step:81.41970449872315 - perf/throughput:712.6852812504372
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.3296875059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.3296875059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1368594467639923, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1368594467639923, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1317.9312744140625, 'response_length/max': 2048.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.581250011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  64%|██████▍   | 335/525 [5:25:11<4:25:28, 83.84s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  64%|██████▍   | 336/525 [5:26:35<4:24:18, 83.91s/it]
[36m(TaskRunner pid=2949575)[0m step:335 - global_seqlen/min:43114 - global_seqlen/max:82259 - global_seqlen/minmax_diff:39145 - global_seqlen/balanced_min:68788 - global_seqlen/balanced_max:70003 - global_seqlen/mean:69093.5 - actor/entropy:0.057155542075634 - actor/kl_loss:0.3066884208470583 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09502743147313594 - actor/pg_clipfrac:0.00022306953906081617 - actor/ppo_kl:-0.017377673746796062 - actor/pg_clipfrac_lower:0.00015869140625 - actor/grad_norm:6.686778545379639 - perf/mfu/actor:0.1703417377732503 - perf/max_memory_allocated_gb:74.06689929962158 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.43909072875977 - actor/lr:1e-06 - training/global_step:335 - training/epoch:9 - critic/score/mean:0.3296875059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.3296875059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1368594467639923 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1368594467639923 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1317.9312744140625 - response_length/max:2048.0 - response_length/min:87.0 - response_length/clip_ratio:0.581250011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.973719716072083e-05 - timing_s/generate_sequences:68.0567855834961 - timing_s/reshard:0.7482540607452393 - timing_s/gen:70.79582726210356 - timing_s/reward:0.177820710465312 - timing_s/old_log_prob:2.2064381260424852 - timing_s/ref:1.8497893530875444 - timing_s/adv:0.008178029209375381 - timing_s/update_actor:9.163627637550235 - timing_s/step:84.21731136925519 - timing_s/stop_profile:4.351511597633362e-05 - timing_per_token_ms/adv:1.4795221709305835e-05 - timing_per_token_ms/gen:0.16786684449137512 - timing_per_token_ms/ref:0.0033465328740900817 - timing_per_token_ms/update_actor:0.01657830989447313 - perf/total_num_tokens:552748 - perf/time_per_step:84.21731136925519 - perf/throughput:820.419209265135
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.421875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.421875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08173535019159317, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08173535019159317, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1295.675048828125, 'response_length/max': 2048.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.5625, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:336 - global_seqlen/min:61900 - global_seqlen/max:74798 - global_seqlen/minmax_diff:12898 - global_seqlen/balanced_min:67770 - global_seqlen/balanced_max:68670 - global_seqlen/mean:68220.75 - actor/entropy:0.05339469015598297 - actor/kl_loss:0.3205034077167511 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.19671905152499675 - actor/pg_clipfrac:0.0016161035367986188 - actor/ppo_kl:0.012330648861643567 - actor/pg_clipfrac_lower:0.00010245901066809892 - actor/grad_norm:6.905175507068634 - perf/mfu/actor:0.16627243349907292 - perf/max_memory_allocated_gb:74.06689929962158 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.37554931640625 - actor/lr:1e-06 - training/global_step:336 - training/epoch:9 - critic/score/mean:0.421875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.421875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08173535019159317 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08173535019159317 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1295.675048828125 - response_length/max:2048.0 - response_length/min:85.0 - response_length/clip_ratio:0.5625 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.81111079454422e-05 - timing_s/generate_sequences:68.2059326171875 - timing_s/reshard:0.8343438506126404 - timing_s/gen:70.58649742044508 - timing_s/reward:0.1756300274282694 - timing_s/old_log_prob:2.168960388749838 - timing_s/ref:1.836453065276146 - timing_s/adv:0.00825214572250843 - timing_s/update_actor:9.259841673076153 - timing_s/step:84.05061146244407 - timing_s/stop_profile:4.653818905353546e-05 - timing_per_token_ms/adv:1.5120300133222719e-05 - timing_per_token_ms/gen:0.17024547393357972 - timing_per_token_ms/ref:0.00336490925648748 - timing_per_token_ms/update_actor:0.01696668842155091 - perf/total_num_tokens:545766 - perf/time_per_step:84.05061146244407 - perf/throughput:811.6627447794684
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.528124988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.528124988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07045694440603256, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07045694440603256, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1186.9625244140625, 'response_length/max': 2048.0, 'response_length/min': 107.0, 'response_length/clip_ratio': 0.503125011920929, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.528125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  64%|██████▍   | 337/525 [5:27:59<4:22:41, 83.84s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  64%|██████▍   | 338/525 [5:29:22<4:20:52, 83.70s/it]
[36m(TaskRunner pid=2949575)[0m step:337 - global_seqlen/min:53785 - global_seqlen/max:79529 - global_seqlen/minmax_diff:25744 - global_seqlen/balanced_min:63731 - global_seqlen/balanced_max:64882 - global_seqlen/mean:63876.625 - actor/entropy:0.06387624144554138 - actor/kl_loss:0.2891979716718197 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03471319191157818 - actor/pg_clipfrac:0.0022453874116763473 - actor/ppo_kl:0.012712263592311502 - actor/pg_clipfrac_lower:6.784260622225702e-05 - actor/grad_norm:34.438107550144196 - perf/mfu/actor:0.15868440744458318 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.42449569702148 - actor/lr:1e-06 - training/global_step:337 - training/epoch:9 - critic/score/mean:0.528124988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.528124988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07045694440603256 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07045694440603256 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1186.9625244140625 - response_length/max:2048.0 - response_length/min:107.0 - response_length/clip_ratio:0.503125011920929 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.528125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.606219828128815e-05 - timing_s/generate_sequences:67.66253662109375 - timing_s/reshard:0.8705878853797913 - timing_s/gen:70.32365411147475 - timing_s/reward:0.16471640206873417 - timing_s/old_log_prob:2.180241856724024 - timing_s/ref:1.7787673845887184 - timing_s/adv:0.008110739290714264 - timing_s/update_actor:9.061954721808434 - timing_s/step:83.53401164710522 - timing_s/stop_profile:4.301406443119049e-05 - timing_per_token_ms/adv:1.587188445443514e-05 - timing_per_token_ms/gen:0.1851460506109996 - timing_per_token_ms/ref:0.003480865231586512 - timing_per_token_ms/update_actor:0.017733315437784232 - perf/total_num_tokens:511013 - perf/time_per_step:83.53401164710522 - perf/throughput:764.6780483840629
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5687500238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5687500238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15121322870254517, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15121322870254517, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1135.6468505859375, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.4781250059604645, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.56875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:338 - global_seqlen/min:40860 - global_seqlen/max:83123 - global_seqlen/minmax_diff:42263 - global_seqlen/balanced_min:61653 - global_seqlen/balanced_max:62934 - global_seqlen/mean:61815.25 - actor/entropy:0.07603979110717773 - actor/kl_loss:0.5378232907503844 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16410498530603945 - actor/pg_clipfrac:0.01590771636692807 - actor/ppo_kl:-0.012827848305641964 - actor/pg_clipfrac_lower:7.019185577519237e-05 - actor/grad_norm:12.222565770149231 - perf/mfu/actor:0.15137753598478343 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.43571090698242 - actor/lr:1e-06 - training/global_step:338 - training/epoch:9 - critic/score/mean:0.5687500238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5687500238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15121322870254517 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15121322870254517 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1135.6468505859375 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.4781250059604645 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.56875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.227862417697906e-05 - timing_s/generate_sequences:67.65818786621094 - timing_s/reshard:1.0368740558624268 - timing_s/gen:70.1668898537755 - timing_s/reward:0.1619239766150713 - timing_s/old_log_prob:2.07882646471262 - timing_s/ref:1.7692314442247152 - timing_s/adv:0.008154060691595078 - timing_s/update_actor:9.18153183721006 - timing_s/step:83.38165668584406 - timing_s/stop_profile:4.446879029273987e-05 - timing_per_token_ms/adv:1.6488772373312164e-05 - timing_per_token_ms/gen:0.19308073277007737 - timing_per_token_ms/ref:0.003577659728434155 - timing_per_token_ms/update_actor:0.01856647800746996 - perf/total_num_tokens:494522 - perf/time_per_step:83.38165668584406 - perf/throughput:741.3531039914508
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.41718751192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.41718751192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08391855657100677, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08391855657100677, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1270.46875, 'response_length/max': 2048.0, 'response_length/min': 63.0, 'response_length/clip_ratio': 0.5531250238418579, 'prompt_length/mean': 410.390625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4171875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  65%|██████▍   | 339/525 [5:30:46<4:19:36, 83.74s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:11:59,495:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:12:04,110:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:12:04,113:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:11:59,978:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:12:04,666:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  65%|██████▍   | 340/525 [5:32:20<4:27:29, 86.76s/it]
[36m(TaskRunner pid=2949575)[0m step:339 - global_seqlen/min:57487 - global_seqlen/max:83657 - global_seqlen/minmax_diff:26170 - global_seqlen/balanced_min:67088 - global_seqlen/balanced_max:68242 - global_seqlen/mean:67234.375 - actor/entropy:0.056834083050489426 - actor/kl_loss:0.3544441893696785 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.157661406788975 - actor/pg_clipfrac:0.0029453887182171457 - actor/ppo_kl:0.026712594865239227 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:5.2602840811014175 - perf/mfu/actor:0.16566598051751394 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.4232063293457 - actor/lr:1e-06 - training/global_step:339 - training/epoch:9 - critic/score/mean:0.41718751192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.41718751192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08391855657100677 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08391855657100677 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1270.46875 - response_length/max:2048.0 - response_length/min:63.0 - response_length/clip_ratio:0.5531250238418579 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4171875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.335337042808533e-05 - timing_s/generate_sequences:68.26093292236328 - timing_s/reshard:0.8553868532180786 - timing_s/gen:70.40609996765852 - timing_s/reward:0.17499103024601936 - timing_s/old_log_prob:2.196539234369993 - timing_s/ref:1.8618822321295738 - timing_s/adv:0.008193204179406166 - timing_s/update_actor:9.156964097172022 - timing_s/step:83.81943819671869 - timing_s/stop_profile:4.0529295802116394e-05 - timing_per_token_ms/adv:1.5232543210608721e-05 - timing_per_token_ms/gen:0.17317943664409918 - timing_per_token_ms/ref:0.0034615519072824985 - timing_per_token_ms/update_actor:0.017024334830903133 - perf/total_num_tokens:537875 - perf/time_per_step:83.81943819671869 - perf/throughput:802.1334483560407
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.512499988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.512499988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.21817098557949066, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.21817098557949066, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1178.1656494140625, 'response_length/max': 2048.0, 'response_length/min': 109.0, 'response_length/clip_ratio': 0.4906249940395355, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:340 - global_seqlen/min:46018 - global_seqlen/max:73607 - global_seqlen/minmax_diff:27589 - global_seqlen/balanced_min:62773 - global_seqlen/balanced_max:63909 - global_seqlen/mean:63485.375 - actor/entropy:0.08509191125631332 - actor/kl_loss:0.3264806229621172 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.3375485137104988 - actor/pg_clipfrac:0.0031541831282083876 - actor/ppo_kl:-0.007120335965737468 - actor/pg_clipfrac_lower:0.0018818982352968305 - actor/grad_norm:49.99217915534973 - perf/mfu/actor:0.15863532121271187 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.39413070678711 - actor/lr:1e-06 - training/global_step:340 - training/epoch:9 - critic/score/mean:0.512499988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.512499988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.21817098557949066 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.21817098557949066 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1178.1656494140625 - response_length/max:2048.0 - response_length/min:109.0 - response_length/clip_ratio:0.4906249940395355 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.591318666934967e-05 - timing_s/generate_sequences:68.08382415771484 - timing_s/reshard:0.75238037109375 - timing_s/gen:70.38606512360275 - timing_s/reward:0.16480962559580803 - timing_s/old_log_prob:2.0413724929094315 - timing_s/ref:1.7410501781851053 - timing_s/adv:0.00811184011399746 - timing_s/update_actor:9.003707384690642 - timing_s/save_checkpoint:10.293450560420752 - timing_s/step:93.65327110514045 - timing_s/stop_profile:4.8099085688591003e-05 - timing_per_token_ms/adv:1.5971867760876932e-05 - timing_per_token_ms/gen:0.186694000269494 - timing_per_token_ms/ref:0.0034280536623299174 - timing_per_token_ms/update_actor:0.017727916438807053 - perf/total_num_tokens:507883 - perf/time_per_step:93.65327110514045 - perf/throughput:677.8767495342232
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.2578125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.2578125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1867927759885788, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1867927759885788, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1397.1312255859375, 'response_length/max': 2048.0, 'response_length/min': 65.0, 'response_length/clip_ratio': 0.621874988079071, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.2578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  65%|██████▍   | 341/525 [5:33:45<4:24:14, 86.16s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:12:06,340:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:12:06,342:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_340/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  65%|██████▌   | 342/525 [5:35:08<4:19:57, 85.23s/it]
[36m(TaskRunner pid=2949575)[0m step:341 - global_seqlen/min:59905 - global_seqlen/max:89363 - global_seqlen/minmax_diff:29458 - global_seqlen/balanced_min:71623 - global_seqlen/balanced_max:72355 - global_seqlen/mean:72261.5 - actor/entropy:0.04812648892402649 - actor/kl_loss:0.33859687596559523 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06600817926228046 - actor/pg_clipfrac:0.005126035264402163 - actor/ppo_kl:-0.07173767322074127 - actor/pg_clipfrac_lower:0.0014404296875 - actor/grad_norm:25.96100167185068 - perf/mfu/actor:0.17586652485250695 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.66763305664062 - actor/lr:1e-06 - training/global_step:341 - training/epoch:9 - critic/score/mean:0.2578125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.2578125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1867927759885788 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1867927759885788 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1397.1312255859375 - response_length/max:2048.0 - response_length/min:65.0 - response_length/clip_ratio:0.621874988079071 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.2578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010333210229873657 - timing_s/generate_sequences:68.66160583496094 - timing_s/reshard:0.8658058643341064 - timing_s/gen:70.77442904189229 - timing_s/reward:0.1857334729284048 - timing_s/old_log_prob:2.2329261172562838 - timing_s/ref:1.8680889941751957 - timing_s/adv:0.008010512217879295 - timing_s/update_actor:9.296984178945422 - timing_s/step:84.38017241470516 - timing_s/stop_profile:4.5027583837509155e-05 - timing_per_token_ms/adv:1.3856812095443797e-05 - timing_per_token_ms/gen:0.15830301609524045 - timing_per_token_ms/ref:0.0032314735270081506 - timing_per_token_ms/update_actor:0.01608218791982145 - perf/total_num_tokens:578092 - perf/time_per_step:84.38017241470516 - perf/throughput:856.380094186757
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4515624940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4515624940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15157008171081543, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15157008171081543, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1194.403076171875, 'response_length/max': 2048.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.5, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:342 - global_seqlen/min:53244 - global_seqlen/max:78782 - global_seqlen/minmax_diff:25538 - global_seqlen/balanced_min:64136 - global_seqlen/balanced_max:64191 - global_seqlen/mean:64143.625 - actor/entropy:0.06471911072731018 - actor/kl_loss:0.29462833106517794 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10002567768096923 - actor/pg_clipfrac:0.003984367780503817 - actor/ppo_kl:0.03535893001262593 - actor/pg_clipfrac_lower:5.224660271778703e-05 - actor/grad_norm:14.926703318953514 - perf/mfu/actor:0.15513945159381945 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.5628662109375 - actor/lr:1e-06 - training/global_step:342 - training/epoch:9 - critic/score/mean:0.4515624940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4515624940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15157008171081543 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15157008171081543 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1194.403076171875 - response_length/max:2048.0 - response_length/min:82.0 - response_length/clip_ratio:0.5 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.114427328109741e-05 - timing_s/generate_sequences:67.91773223876953 - timing_s/reshard:0.7720165848731995 - timing_s/gen:69.69836447574198 - timing_s/reward:0.1643330603837967 - timing_s/old_log_prob:2.076914107427001 - timing_s/ref:1.7759324125945568 - timing_s/adv:0.010488910600543022 - timing_s/update_actor:9.306951297447085 - timing_s/step:83.04792335815728 - timing_s/stop_profile:4.5163556933403015e-05 - timing_per_token_ms/adv:2.044028264800871e-05 - timing_per_token_ms/gen:0.1823566804437938 - timing_per_token_ms/ref:0.003460851356223157 - timing_per_token_ms/update_actor:0.01813693741476079 - perf/total_num_tokens:513149 - perf/time_per_step:83.04792335815728 - perf/throughput:772.3688011242676
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.47968751192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.47968751192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.13011440634727478, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.13011440634727478, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1189.015625, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.5062500238418579, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  65%|██████▌   | 343/525 [5:36:31<4:16:32, 84.57s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  66%|██████▌   | 344/525 [5:37:53<4:13:07, 83.91s/it]
[36m(TaskRunner pid=2949575)[0m step:343 - global_seqlen/min:45113 - global_seqlen/max:81097 - global_seqlen/minmax_diff:35984 - global_seqlen/balanced_min:63679 - global_seqlen/balanced_max:64799 - global_seqlen/mean:63958.75 - actor/entropy:0.06266745924949646 - actor/kl_loss:0.3189981896430254 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07824012506753206 - actor/pg_clipfrac:0.0023948882633703763 - actor/ppo_kl:0.018266083477828942 - actor/pg_clipfrac_lower:2.09292586077936e-05 - actor/grad_norm:15.68848405778408 - perf/mfu/actor:0.1630204566641027 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.51140975952148 - actor/lr:1e-06 - training/global_step:343 - training/epoch:9 - critic/score/mean:0.47968751192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.47968751192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.13011440634727478 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.13011440634727478 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1189.015625 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.5062500238418579 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010025501251220703 - timing_s/generate_sequences:67.97953796386719 - timing_s/reshard:0.8843666911125183 - timing_s/gen:70.00287928245962 - timing_s/reward:0.1639982871711254 - timing_s/old_log_prob:2.034670142456889 - timing_s/ref:1.7111889757215977 - timing_s/adv:0.007986161857843399 - timing_s/update_actor:8.837371781468391 - timing_s/step:82.7731545176357 - timing_s/stop_profile:4.2615458369255066e-05 - timing_per_token_ms/adv:1.5608032243132094e-05 - timing_per_token_ms/gen:0.18398328260630412 - timing_per_token_ms/ref:0.0033443214879152533 - timing_per_token_ms/update_actor:0.017271623861997754 - perf/total_num_tokens:511670 - perf/time_per_step:82.7731545176357 - perf/throughput:772.6991966504419
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.48906248807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.48906248807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1078280359506607, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1078280359506607, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1159.6156005859375, 'response_length/max': 2048.0, 'response_length/min': 98.0, 'response_length/clip_ratio': 0.4906249940395355, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:344 - global_seqlen/min:52612 - global_seqlen/max:77847 - global_seqlen/minmax_diff:25235 - global_seqlen/balanced_min:62118 - global_seqlen/balanced_max:63159 - global_seqlen/mean:62774.0 - actor/entropy:0.07088427245616913 - actor/kl_loss:0.2846871666610241 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07659656824544073 - actor/pg_clipfrac:0.0015734082815470174 - actor/ppo_kl:-0.020457259793329286 - actor/pg_clipfrac_lower:0.0009258614154532552 - actor/grad_norm:40.65815480053425 - perf/mfu/actor:0.15523344954405252 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.48280715942383 - actor/lr:1e-06 - training/global_step:344 - training/epoch:9 - critic/score/mean:0.48906248807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.48906248807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1078280359506607 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1078280359506607 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1159.6156005859375 - response_length/max:2048.0 - response_length/min:98.0 - response_length/clip_ratio:0.4906249940395355 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.375011384487152e-05 - timing_s/generate_sequences:67.40518951416016 - timing_s/reshard:0.8185560703277588 - timing_s/gen:69.29391459189355 - timing_s/reward:0.16170019656419754 - timing_s/old_log_prob:2.038716334849596 - timing_s/ref:1.7184386234730482 - timing_s/adv:0.00817253440618515 - timing_s/update_actor:9.097857102751732 - timing_s/step:82.33460554294288 - timing_s/stop_profile:4.213675856590271e-05 - timing_per_token_ms/adv:1.6273724802834672e-05 - timing_per_token_ms/gen:0.18673729331619462 - timing_per_token_ms/ref:0.003421875743685778 - timing_per_token_ms/update_actor:0.01811629237971081 - perf/total_num_tokens:502192 - perf/time_per_step:82.33460554294288 - perf/throughput:762.425466012092
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.84375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.84375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11972159892320633, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11972159892320633, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 906.8875122070312, 'response_length/max': 2048.0, 'response_length/min': 67.0, 'response_length/clip_ratio': 0.34375, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.84375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  66%|██████▌   | 345/525 [5:39:15<4:10:12, 83.40s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  66%|██████▌   | 346/525 [5:40:37<4:07:40, 83.02s/it]
[36m(TaskRunner pid=2949575)[0m step:345 - global_seqlen/min:31791 - global_seqlen/max:75060 - global_seqlen/minmax_diff:43269 - global_seqlen/balanced_min:51962 - global_seqlen/balanced_max:52866 - global_seqlen/mean:52638.625 - actor/entropy:0.09907343983650208 - actor/kl_loss:0.2748197041451931 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.002456802036613226 - actor/pg_clipfrac:0.004047166836971883 - actor/ppo_kl:-0.03691392202199495 - actor/pg_clipfrac_lower:0.0013254459714516996 - actor/grad_norm:16.6709988117218 - perf/mfu/actor:0.12936527771593184 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.5733528137207 - actor/lr:1e-06 - training/global_step:345 - training/epoch:9 - critic/score/mean:0.84375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.84375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11972159892320633 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11972159892320633 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:906.8875122070312 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.34375 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.84375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.36705619096756e-05 - timing_s/generate_sequences:66.14611053466797 - timing_s/reshard:0.8877037167549133 - timing_s/gen:69.33785705827177 - timing_s/reward:0.13578518666327 - timing_s/old_log_prob:1.8915263246744871 - timing_s/ref:1.6322005968540907 - timing_s/adv:0.008131278678774834 - timing_s/update_actor:9.079948095604777 - timing_s/step:82.10023021697998 - timing_s/stop_profile:4.5904889702796936e-05 - timing_per_token_ms/adv:1.930920184269354e-05 - timing_per_token_ms/gen:0.23892798534228255 - timing_per_token_ms/ref:0.0038759575237149783 - timing_per_token_ms/update_actor:0.021561990115634616 - perf/total_num_tokens:421109 - perf/time_per_step:82.10023021697998 - perf/throughput:641.1507600025374
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6859375238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6859375238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1538114994764328, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1538114994764328, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1044.375, 'response_length/max': 2048.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.41874998807907104, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:346 - global_seqlen/min:41182 - global_seqlen/max:74543 - global_seqlen/minmax_diff:33361 - global_seqlen/balanced_min:57307 - global_seqlen/balanced_max:58427 - global_seqlen/mean:58146.875 - actor/entropy:0.09151378273963928 - actor/kl_loss:0.2452220804989338 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.049707689136266706 - actor/pg_clipfrac:0.0016016661335015669 - actor/ppo_kl:0.004877850121556548 - actor/pg_clipfrac_lower:5.4902413103263827e-05 - actor/grad_norm:28.618806764483452 - perf/mfu/actor:0.14434123090600776 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.47747421264648 - actor/lr:1e-06 - training/global_step:346 - training/epoch:9 - critic/score/mean:0.6859375238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6859375238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1538114994764328 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1538114994764328 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1044.375 - response_length/max:2048.0 - response_length/min:88.0 - response_length/clip_ratio:0.41874998807907104 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.268840610980988e-05 - timing_s/generate_sequences:67.12957763671875 - timing_s/reshard:0.7125780582427979 - timing_s/gen:69.26045499742031 - timing_s/reward:0.1502473894506693 - timing_s/old_log_prob:1.9694786220788956 - timing_s/ref:1.6775035168975592 - timing_s/adv:0.00810505822300911 - timing_s/update_actor:9.027946203947067 - timing_s/step:82.108980467543 - timing_s/stop_profile:4.281662404537201e-05 - timing_per_token_ms/adv:1.742367544044523e-05 - timing_per_token_ms/gen:0.20724253440281362 - timing_per_token_ms/ref:0.0036061772814479694 - timing_per_token_ms/update_actor:0.019407634124677955 - perf/total_num_tokens:465175 - perf/time_per_step:82.108980467543 - perf/throughput:708.1670563792346
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5296875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5296875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1141485720872879, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1141485720872879, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1207.390625, 'response_length/max': 2048.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.512499988079071, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  66%|██████▌   | 347/525 [5:42:00<4:06:02, 82.93s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  66%|██████▋   | 348/525 [5:43:25<4:06:27, 83.54s/it]
[36m(TaskRunner pid=2949575)[0m step:347 - global_seqlen/min:42910 - global_seqlen/max:82074 - global_seqlen/minmax_diff:39164 - global_seqlen/balanced_min:64094 - global_seqlen/balanced_max:65292 - global_seqlen/mean:64693.75 - actor/entropy:0.0683683305978775 - actor/kl_loss:0.31657904796302316 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.029168826481327414 - actor/pg_clipfrac:0.003334758481651079 - actor/ppo_kl:0.03945194770785747 - actor/pg_clipfrac_lower:8.66082773427479e-05 - actor/grad_norm:31.744064524769783 - perf/mfu/actor:0.16207823705471053 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.4344596862793 - actor/lr:1e-06 - training/global_step:347 - training/epoch:9 - critic/score/mean:0.5296875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5296875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1141485720872879 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1141485720872879 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1207.390625 - response_length/max:2048.0 - response_length/min:99.0 - response_length/clip_ratio:0.512499988079071 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.211098611354828e-05 - timing_s/generate_sequences:67.76106262207031 - timing_s/reshard:0.7564648985862732 - timing_s/gen:69.67256071232259 - timing_s/reward:0.16742322407662868 - timing_s/old_log_prob:2.094013214111328 - timing_s/ref:1.7756486665457487 - timing_s/adv:0.008231086656451225 - timing_s/update_actor:8.988002499565482 - timing_s/step:82.72283348627388 - timing_s/stop_profile:4.604645073413849e-05 - timing_per_token_ms/adv:1.5903944848712636e-05 - timing_per_token_ms/gen:0.18032834421420832 - timing_per_token_ms/ref:0.0034308736673669188 - timing_per_token_ms/update_actor:0.017366442854923163 - perf/total_num_tokens:517550 - perf/time_per_step:82.72283348627388 - perf/throughput:782.0543285758529
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.39531248807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.39531248807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09372742474079132, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09372742474079132, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1302.003173828125, 'response_length/max': 2048.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.5718749761581421, 'prompt_length/mean': 410.5, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:348 - global_seqlen/min:45319 - global_seqlen/max:82971 - global_seqlen/minmax_diff:37652 - global_seqlen/balanced_min:67562 - global_seqlen/balanced_max:68635 - global_seqlen/mean:68500.125 - actor/entropy:0.051122408360242844 - actor/kl_loss:0.3393444258719683 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.18610910419374704 - actor/pg_clipfrac:0.0014139554230496287 - actor/ppo_kl:0.03151086720317835 - actor/pg_clipfrac_lower:2.16637781704776e-05 - actor/grad_norm:46.81217050552368 - perf/mfu/actor:0.1680052875137082 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.55271911621094 - actor/lr:1e-06 - training/global_step:348 - training/epoch:9 - critic/score/mean:0.39531248807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.39531248807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09372742474079132 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09372742474079132 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1302.003173828125 - response_length/max:2048.0 - response_length/min:92.0 - response_length/clip_ratio:0.5718749761581421 - prompt_length/mean:410.5 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.559467434883118e-05 - timing_s/generate_sequences:68.69287872314453 - timing_s/reshard:0.9052209854125977 - timing_s/gen:71.38524840585887 - timing_s/reward:0.1775552947074175 - timing_s/old_log_prob:2.204201316460967 - timing_s/ref:1.876334298402071 - timing_s/adv:0.008180655539035797 - timing_s/update_actor:9.206526888534427 - timing_s/step:84.8734898287803 - timing_s/stop_profile:4.470162093639374e-05 - timing_per_token_ms/adv:1.4928176297188868e-05 - timing_per_token_ms/gen:0.17133515041932712 - timing_per_token_ms/ref:0.003423961449709163 - timing_per_token_ms/update_actor:0.01680020089111959 - perf/total_num_tokens:548001 - perf/time_per_step:84.8734898287803 - perf/throughput:807.0850525669307
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7437499761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7437499761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14916718006134033, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14916718006134033, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 976.0, 'response_length/max': 2048.0, 'response_length/min': 102.0, 'response_length/clip_ratio': 0.38749998807907104, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.74375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  66%|██████▋   | 349/525 [5:44:47<4:03:22, 82.97s/it]
[36m(TaskRunner pid=2949575)[0m step:349 - global_seqlen/min:37514 - global_seqlen/max:70851 - global_seqlen/minmax_diff:33337 - global_seqlen/balanced_min:54845 - global_seqlen/balanced_max:55925 - global_seqlen/mean:55403.125 - actor/entropy:0.10206004977226257 - actor/kl_loss:0.2980414878576994 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1029548266902566 - actor/pg_clipfrac:0.001062279019970447 - actor/ppo_kl:-0.007771347444031562 - actor/pg_clipfrac_lower:0.00020974158687749877 - actor/grad_norm:30.094358652830124 - perf/mfu/actor:0.1447659296572638 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.42118072509766 - actor/lr:1e-06 - training/global_step:349 - training/epoch:9 - critic/score/mean:0.7437499761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7437499761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14916718006134033 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14916718006134033 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:976.0 - response_length/max:2048.0 - response_length/min:102.0 - response_length/clip_ratio:0.38749998807907104 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.74375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.749270975589752e-05 - timing_s/generate_sequences:66.62909698486328 - timing_s/reshard:0.8622120022773743 - timing_s/gen:69.21733613498509 - timing_s/reward:0.1443496160209179 - timing_s/old_log_prob:1.861062539741397 - timing_s/ref:1.6446996368467808 - timing_s/adv:0.008020790293812752 - timing_s/update_actor:8.563418550416827 - timing_s/step:81.45361770503223 - timing_s/stop_profile:4.402734339237213e-05 - timing_per_token_ms/adv:1.8096430241553956e-05 - timing_per_token_ms/gen:0.22162313055515206 - timing_per_token_ms/ref:0.0037107555684963186 - timing_per_token_ms/update_actor:0.019320702917066564 - perf/total_num_tokens:443225 - perf/time_per_step:81.45361770503223 - perf/throughput:680.1800406291491
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 350}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, its standard form is \(\frac{x^2}{a^2} - \frac{y^2}{a^2} = 1\), which simplifies to \(x^2 - y^2 = a^2\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The equation of the parabola is \(y^2 = 16x\). The focus of this parabola is at \((4, 0)\) and its directrix is the line \(x = -4\). The hyperbola intersects the parabola at points \(A\) and \(B\), and the distance between these points is \(|AB| = 4\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Since the hyperbola and the parabola intersect at points that are symmetric with respect to the \(x\)-axis, let's assume the coordinates of \(A\) and \(B\) are \((x_1, y_1)\) and \((x_1, -y_1)\) respectively. The distance between these points is \(2|y_1| = 4\sqrt{3}\), so \(|y_1| = 2\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Substituting \(y_1 = 2\sqrt{3}\) into the equation of the parabola \(y^2 = 16x\), we get:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m (2\sqrt{3})^2 = 16x \implies 12 = 16x \implies x = \frac{12}{16} = \frac{3}{4}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m So, the coordinates of \(A\) and \(B\) are \(\left(\frac{3}{4}, 2\sqrt{3}\right)\) and \(\left(\frac{3}{4}, -2\sqrt{3}\right)\) respectively.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Now, substituting \(x = \frac{3}{4}\) and \(y = 2\sqrt{3}\) into the equation of the hyperbola \(x^2 - y^2 = a^2\), we get:
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \left(\frac{3}{4}\right)^2 - (2\sqrt{3})^2 = a^2 \implies \frac{9}{16} - 12 = a^2 \implies \frac{9}{16} - \frac{192}{16} = a^2 \implies -\frac{183}{16} = a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m This is incorrect, so letأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاع[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:27:10,276:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:27:14,883:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:27:14,886:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 05:27:10,677:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:27:15,449:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/huggingface

[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] -0.5
[36m(TaskRunner pid=2949575)[0m [structure] -0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.0
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5296875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5296875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.13688385486602783, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.13688385486602783, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1133.3968505859375, 'response_length/max': 2048.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.46875, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:350 - global_seqlen/min:49185 - global_seqlen/max:74600 - global_seqlen/minmax_diff:25415 - global_seqlen/balanced_min:60969 - global_seqlen/balanced_max:61934 - global_seqlen/mean:61716.5 - actor/entropy:0.09121626615524292 - actor/kl_loss:0.3339849911630154 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1773630887735635 - actor/pg_clipfrac:0.0036429286250495353 - actor/ppo_kl:0.00742981377770775 - actor/pg_clipfrac_lower:0.000950555206509307 - actor/grad_norm:30.768942892551422 - perf/mfu/actor:0.15424798251167973 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:98.4676628112793 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:0.30500000000000005 - val-aux/grpo_convert/reward/std@50:0.43957365708149526 - val-aux/grpo_convert/reward/best@2/mean:0.54 - val-aux/grpo_convert/reward/best@2/std:0.31068472765811966 - val-aux/grpo_convert/reward/worst@2/mean:0.09575 - val-aux/grpo_convert/reward/worst@2/std:0.4409018456527484 - val-aux/grpo_convert/reward/best@4/mean:0.675 - val-aux/grpo_convert/reward/best@4/std:0.17853571071357124 - val-aux/grpo_convert/reward/worst@4/mean:-0.14625 - val-aux/grpo_convert/reward/worst@4/std:0.3899338886272903 - val-aux/grpo_convert/reward/best@8/mean:0.7415 - val-aux/grpo_convert/reward/best@8/std:0.06463551655243424 - val-aux/grpo_convert/reward/worst@8/mean:-0.33575 - val-aux/grpo_convert/reward/worst@8/std:0.3101764618729152 - val-aux/grpo_convert/reward/best@16/mean:0.75 - val-aux/grpo_convert/reward/best@16/std:0.0 - val-aux/grpo_convert/reward/worst@16/mean:-0.47525 - val-aux/grpo_convert/reward/worst@16/std:0.13397737682161115 - val-aux/grpo_convert/reward/best@32/mean:0.75 - val-aux/grpo_convert/reward/best@32/std:0.0 - val-aux/grpo_convert/reward/worst@32/mean:-0.497 - val-aux/grpo_convert/reward/worst@32/std:0.04733920151417852 - val-aux/grpo_convert/reward/best@50/mean:0.75 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:0.30500000000000005 - val-aux/grpo_convert/score/std@50:0.43957365708149526 - val-aux/grpo_convert/score/best@2/mean:0.54 - val-aux/grpo_convert/score/best@2/std:0.31068472765811966 - val-aux/grpo_convert/score/worst@2/mean:0.09575 - val-aux/grpo_convert/score/worst@2/std:0.4409018456527484 - val-aux/grpo_convert/score/best@4/mean:0.675 - val-aux/grpo_convert/score/best@4/std:0.17853571071357124 - val-aux/grpo_convert/score/worst@4/mean:-0.14625 - val-aux/grpo_convert/score/worst@4/std:0.3899338886272903 - val-aux/grpo_convert/score/best@8/mean:0.7415 - val-aux/grpo_convert/score/best@8/std:0.06463551655243424 - val-aux/grpo_convert/score/worst@8/mean:-0.33575 - val-aux/grpo_convert/score/worst@8/std:0.3101764618729152 - val-aux/grpo_convert/score/best@16/mean:0.75 - val-aux/grpo_convert/score/best@16/std:0.0 - val-aux/grpo_convert/score/worst@16/mean:-0.47525 - val-aux/grpo_convert/score/worst@16/std:0.13397737682161115 - val-aux/grpo_convert/score/best@32/mean:0.75 - val-aux/grpo_convert/score/best@32/std:0.0 - val-aux/grpo_convert/score/worst@32/mean:-0.497 - val-aux/grpo_convert/score/worst@32/std:0.04733920151417852 - val-aux/grpo_convert/score/best@50/mean:0.75 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:-0.09 - val-aux/grpo_convert/structure/std@50:0.19209372712298547 - val-aux/grpo_convert/structure/best@2/mean:-0.01899999999999999 - val-aux/grpo_convert/structure/best@2/std:0.09559811713627 - val-aux/grpo_convert/structure/worst@2/mean:-0.1575 - val-aux/grpo_convert/structure/worst@2/std:0.23225793850803036 - val-aux/grpo_convert/structure/best@4/mean:0.0 - val-aux/grpo_convert/structure/best@4/std:0.0 - val-aux/grpo_convert/structure/worst@4/mean:-0.2705 - val-aux/grpo_convert/structure/worst@4/std:0.24915808234933903 - val-aux/grpo_convert/structure/best@8/mean:0.0 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.3905 - val-aux/grpo_convert/structure/worst@8/std:0.20678430791527677 - val-aux/grpo_convert/structure/best@16/mean:0.0 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.48350000000000004 - val-aux/grpo_convert/structure/worst@16/std:0.08931825121440747 - val-aux/grpo_convert/structure/best@32/mean:0.0 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.498 - val-aux/grpo_convert/structure/worst@32/std:0.031559467676119 - val-aux/grpo_convert/structure/best@50/mean:0.0 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.205 - val-aux/grpo_convert/boxed/std@50:0.09604686356149272 - val-aux/grpo_convert/boxed/best@2/mean:0.2405 - val-aux/grpo_convert/boxed/best@2/std:0.047799058568135 - val-aux/grpo_convert/boxed/worst@2/mean:0.17125 - val-aux/grpo_convert/boxed/worst@2/std:0.11612896925401517 - val-aux/grpo_convert/boxed/best@4/mean:0.25 - val-aux/grpo_convert/boxed/best@4/std:0.0 - val-aux/grpo_convert/boxed/worst@4/mean:0.11475 - val-aux/grpo_convert/boxed/worst@4/std:0.1245790411746695 - val-aux/grpo_convert/boxed/best@8/mean:0.25 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.05475 - val-aux/grpo_convert/boxed/worst@8/std:0.10339215395763839 - val-aux/grpo_convert/boxed/best@16/mean:0.25 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.00825 - val-aux/grpo_convert/boxed/worst@16/std:0.044659125607203726 - val-aux/grpo_convert/boxed/best@32/mean:0.25 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.001 - val-aux/grpo_convert/boxed/worst@32/std:0.0157797338380595 - val-aux/grpo_convert/boxed/best@50/mean:0.25 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.19 - val-aux/grpo_convert/correct/std@50:0.24269322199023194 - val-aux/grpo_convert/correct/best@2/mean:0.3185 - val-aux/grpo_convert/correct/best@2/std:0.2404324229383383 - val-aux/grpo_convert/correct/worst@2/mean:0.082 - val-aux/grpo_convert/correct/worst@2/std:0.18513778652668395 - val-aux/grpo_convert/correct/best@4/mean:0.425 - val-aux/grpo_convert/correct/best@4/std:0.17853571071357122 - val-aux/grpo_convert/correct/worst@4/mean:0.0095 - val-aux/grpo_convert/correct/worst@4/std:0.06826236151789651 - val-aux/grpo_convert/correct/best@8/mean:0.4915 - val-aux/grpo_convert/correct/best@8/std:0.06463551655243424 - val-aux/grpo_convert/correct/worst@8/mean:0.0 - val-aux/grpo_convert/correct/worst@8/std:0.0 - val-aux/grpo_convert/correct/best@16/mean:0.5 - val-aux/grpo_convert/correct/best@16/std:0.0 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.5 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.5 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.19 - val-aux/grpo_convert/acc/std@50:0.24269322199023194 - val-aux/grpo_convert/acc/best@2/mean:0.3185 - val-aux/grpo_convert/acc/best@2/std:0.2404324229383383 - val-aux/grpo_convert/acc/worst@2/mean:0.082 - val-aux/grpo_convert/acc/worst@2/std:0.18513778652668395 - val-aux/grpo_convert/acc/best@4/mean:0.425 - val-aux/grpo_convert/acc/best@4/std:0.17853571071357122 - val-aux/grpo_convert/acc/worst@4/mean:0.0095 - val-aux/grpo_convert/acc/worst@4/std:0.06826236151789651 - val-aux/grpo_convert/acc/best@8/mean:0.4915 - val-aux/grpo_convert/acc/best@8/std:0.06463551655243424 - val-aux/grpo_convert/acc/worst@8/mean:0.0 - val-aux/grpo_convert/acc/worst@8/std:0.0 - val-aux/grpo_convert/acc/best@16/mean:0.5 - val-aux/grpo_convert/acc/best@16/std:0.0 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.5 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.5 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:350 - training/epoch:9 - critic/score/mean:0.5296875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5296875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.13688385486602783 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.13688385486602783 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1133.3968505859375 - response_length/max:2048.0 - response_length/min:100.0 - response_length/clip_ratio:0.46875 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.995776832103729e-05 - timing_s/generate_sequences:67.76892852783203 - timing_s/reshard:0.7631510496139526 - timing_s/gen:70.33338635601103 - timing_s/reward:0.163329865783453 - timing_s/old_log_prob:2.1005969513207674 - timing_s/ref:1.7439181338995695 - timing_s/adv:0.008045665919780731 - timing_s/update_actor:8.990612914785743 - timing_s/testing:70.25746488571167 - timing_s/save_checkpoint:10.267569741234183 - timing_s/step:163.88066510669887 - timing_s/stop_profile:5.000457167625427e-05 - timing_per_token_ms/adv:1.629561365230678e-05 - timing_per_token_ms/gen:0.19392309720505846 - timing_per_token_ms/ref:0.0035321148596800887 - timing_per_token_ms/update_actor:0.01820950012311485 - perf/total_num_tokens:493732 - perf/time_per_step:163.88066510669887 - perf/throughput:376.59415135896495[36m(TaskRunner pid=2949575)[0m Training Progress:  67%|██████▋   | 350/525 [5:47:31<5:12:48, 107.25s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  67%|██████▋   | 351/525 [5:48:54<4:50:12, 100.07s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:27:17,150:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:27:17,153:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_350/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  67%|██████▋   | 352/525 [5:50:16<4:33:22, 94.81s/it] 

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7171875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7171875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.19002869725227356, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.19002869725227356, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1031.1937255859375, 'response_length/max': 2048.0, 'response_length/min': 125.0, 'response_length/clip_ratio': 0.40312498807907104, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7171875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:351 - global_seqlen/min:42721 - global_seqlen/max:78143 - global_seqlen/minmax_diff:35422 - global_seqlen/balanced_min:57466 - global_seqlen/balanced_max:58609 - global_seqlen/mean:57610.875 - actor/entropy:0.09494374692440033 - actor/kl_loss:0.24454290568828582 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10666402680799365 - actor/pg_clipfrac:0.002006178814917803 - actor/ppo_kl:0.0010554464744927828 - actor/pg_clipfrac_lower:0.0001547238673083484 - actor/grad_norm:50.91085563600063 - perf/mfu/actor:0.14565823634522307 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:96.56537246704102 - actor/lr:1e-06 - training/global_step:351 - training/epoch:10 - critic/score/mean:0.7171875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7171875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.19002869725227356 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.19002869725227356 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1031.1937255859375 - response_length/max:2048.0 - response_length/min:125.0 - response_length/clip_ratio:0.40312498807907104 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7171875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00035082176327705383 - timing_s/generate_sequences:66.72834777832031 - timing_s/reshard:0.6296769380569458 - timing_s/gen:68.89759476855397 - timing_s/reward:0.15000342577695847 - timing_s/old_log_prob:1.9389071576297283 - timing_s/ref:1.6659848298877478 - timing_s/adv:0.007571432739496231 - timing_s/update_actor:8.85407149232924 - timing_s/step:81.54951907508075 - timing_s/stop_profile:4.3584033846855164e-05 - timing_per_token_ms/adv:1.6427958999703248e-05 - timing_per_token_ms/gen:0.20879197886113174 - timing_per_token_ms/ref:0.003614735997951228 - timing_per_token_ms/update_actor:0.019210937805425713 - perf/total_num_tokens:460887 - perf/time_per_step:81.54951907508075 - perf/throughput:706.4526640182759
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5921875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5921875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1588558405637741, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1588558405637741, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1105.8843994140625, 'response_length/max': 2048.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.44999998807907104, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:352 - global_seqlen/min:43361 - global_seqlen/max:78201 - global_seqlen/minmax_diff:34840 - global_seqlen/balanced_min:60611 - global_seqlen/balanced_max:60612 - global_seqlen/mean:60611.625 - actor/entropy:0.09639466553926468 - actor/kl_loss:0.27329777665436267 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11364320777356625 - actor/pg_clipfrac:0.001937130001897458 - actor/ppo_kl:-0.005548801702389028 - actor/pg_clipfrac_lower:0.00032987415324896573 - actor/grad_norm:16.57821699976921 - perf/mfu/actor:0.1526906017023361 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:96.70465469360352 - actor/lr:1e-06 - training/global_step:352 - training/epoch:10 - critic/score/mean:0.5921875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5921875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1588558405637741 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1588558405637741 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1105.8843994140625 - response_length/max:2048.0 - response_length/min:99.0 - response_length/clip_ratio:0.44999998807907104 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.317960262298584e-05 - timing_s/generate_sequences:67.65204620361328 - timing_s/reshard:0.8421023488044739 - timing_s/gen:69.72941346280277 - timing_s/reward:0.15776912681758404 - timing_s/old_log_prob:2.002308053895831 - timing_s/ref:1.7134818620979786 - timing_s/adv:0.00756363570690155 - timing_s/update_actor:8.910190645605326 - timing_s/step:82.53402591124177 - timing_s/stop_profile:4.560500383377075e-05 - timing_per_token_ms/adv:1.5598566502097472e-05 - timing_per_token_ms/gen:0.1970408679218916 - timing_per_token_ms/ref:0.003533731899817029 - timing_per_token_ms/update_actor:0.018375581098521377 - perf/total_num_tokens:484893 - perf/time_per_step:82.53402591124177 - perf/throughput:734.3834779752848
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  67%|██████▋   | 353/525 [5:51:40<4:22:08, 91.45s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  67%|██████▋   | 354/525 [5:53:02<4:12:53, 88.73s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.528124988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.528124988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.17001895606517792, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.17001895606517792, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1173.5, 'response_length/max': 2048.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.4906249940395355, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.528125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:353 - global_seqlen/min:46127 - global_seqlen/max:78628 - global_seqlen/minmax_diff:32501 - global_seqlen/balanced_min:62674 - global_seqlen/balanced_max:63715 - global_seqlen/mean:63325.0 - actor/entropy:0.07158412784337997 - actor/kl_loss:0.35432019606232645 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10959108229726552 - actor/pg_clipfrac:0.003587301427614875 - actor/ppo_kl:0.03130675529691871 - actor/pg_clipfrac_lower:0.0013349839951843022 - actor/grad_norm:18.0358963906765 - perf/mfu/actor:0.15794276981324978 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:96.80613708496094 - actor/lr:1e-06 - training/global_step:353 - training/epoch:10 - critic/score/mean:0.528124988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.528124988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.17001895606517792 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.17001895606517792 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1173.5 - response_length/max:2048.0 - response_length/min:80.0 - response_length/clip_ratio:0.4906249940395355 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.528125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011711381375789642 - timing_s/generate_sequences:67.82614135742188 - timing_s/reshard:0.7575687766075134 - timing_s/gen:70.10646280832589 - timing_s/reward:0.16484674997627735 - timing_s/old_log_prob:2.113883588463068 - timing_s/ref:1.8777318894863129 - timing_s/adv:0.0074836742132902145 - timing_s/update_actor:9.018709881231189 - timing_s/step:83.3022265508771 - timing_s/stop_profile:4.41819429397583e-05 - timing_per_token_ms/adv:1.4772353362199397e-05 - timing_per_token_ms/gen:0.18669168834769356 - timing_per_token_ms/ref:0.003706537484181431 - timing_per_token_ms/update_actor:0.017802427716603213 - perf/total_num_tokens:506600 - perf/time_per_step:83.3022265508771 - perf/throughput:760.183762451104
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7124999761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7124999761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14466504752635956, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14466504752635956, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1005.0499877929688, 'response_length/max': 2048.0, 'response_length/min': 125.0, 'response_length/clip_ratio': 0.390625, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:354 - global_seqlen/min:43824 - global_seqlen/max:68082 - global_seqlen/minmax_diff:24258 - global_seqlen/balanced_min:56052 - global_seqlen/balanced_max:56883 - global_seqlen/mean:56569.5 - actor/entropy:0.11488863825798035 - actor/kl_loss:0.2561519663780928 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02192510520108044 - actor/pg_clipfrac:0.004441252601100132 - actor/ppo_kl:-0.03440468775443151 - actor/pg_clipfrac_lower:0.0004385316948173568 - actor/grad_norm:70.97769902646542 - perf/mfu/actor:0.14498852384538677 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:96.74740219116211 - actor/lr:1e-06 - training/global_step:354 - training/epoch:10 - critic/score/mean:0.7124999761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7124999761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14466504752635956 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14466504752635956 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1005.0499877929688 - response_length/max:2048.0 - response_length/min:125.0 - response_length/clip_ratio:0.390625 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.558295667171478e-05 - timing_s/generate_sequences:66.92760467529297 - timing_s/reshard:0.8298779726028442 - timing_s/gen:69.66502248123288 - timing_s/reward:0.1461445651948452 - timing_s/old_log_prob:1.8928339406847954 - timing_s/ref:1.6250927243381739 - timing_s/adv:0.007374793291091919 - timing_s/update_actor:8.727675979956985 - timing_s/step:82.07706189155579 - timing_s/stop_profile:4.4327229261398315e-05 - timing_per_token_ms/adv:1.6295868999840723e-05 - timing_per_token_ms/gen:0.2166093181969581 - timing_per_token_ms/ref:0.0035909207354187633 - timing_per_token_ms/update_actor:0.019285295035215498 - perf/total_num_tokens:452556 - perf/time_per_step:82.07706189155579 - perf/throughput:689.2242326454422
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.13635969161987305, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.13635969161987305, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1121.481201171875, 'response_length/max': 2048.0, 'response_length/min': 81.0, 'response_length/clip_ratio': 0.4593749940395355, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  68%|██████▊   | 355/525 [5:54:25<4:06:06, 86.86s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  68%|██████▊   | 356/525 [5:55:47<4:00:18, 85.32s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:355 - global_seqlen/min:49644 - global_seqlen/max:73685 - global_seqlen/minmax_diff:24041 - global_seqlen/balanced_min:60850 - global_seqlen/balanced_max:61881 - global_seqlen/mean:61235.5 - actor/entropy:0.08498583734035492 - actor/kl_loss:0.30366518422961236 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02077089585363865 - actor/pg_clipfrac:0.0017615155506064185 - actor/ppo_kl:-0.00046054029298829845 - actor/pg_clipfrac_lower:0.0003097893437370658 - actor/grad_norm:17.509896486997604 - perf/mfu/actor:0.15100963103770146 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:96.6727066040039 - actor/lr:1e-06 - training/global_step:355 - training/epoch:10 - critic/score/mean:0.5625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.13635969161987305 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.13635969161987305 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1121.481201171875 - response_length/max:2048.0 - response_length/min:81.0 - response_length/clip_ratio:0.4593749940395355 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.270649075508118e-05 - timing_s/generate_sequences:67.25007629394531 - timing_s/reshard:0.8836246728897095 - timing_s/gen:69.3032046649605 - timing_s/reward:0.15698140114545822 - timing_s/old_log_prob:2.1201203614473343 - timing_s/ref:1.7785275280475616 - timing_s/adv:0.007465839385986328 - timing_s/update_actor:9.108299657702446 - timing_s/step:82.49397806823254 - timing_s/stop_profile:4.501454532146454e-05 - timing_per_token_ms/adv:1.5240014750402807e-05 - timing_per_token_ms/gen:0.1931129161348008 - timing_per_token_ms/ref:0.003630507483501322 - timing_per_token_ms/update_actor:0.018592768201660895 - perf/total_num_tokens:489884 - perf/time_per_step:82.49397806823254 - perf/throughput:742.3026678305029
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7359374761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7359374761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14482909440994263, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14482909440994263, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 988.7687377929688, 'response_length/max': 2048.0, 'response_length/min': 63.0, 'response_length/clip_ratio': 0.3812499940395355, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:356 - global_seqlen/min:40684 - global_seqlen/max:66236 - global_seqlen/minmax_diff:25552 - global_seqlen/balanced_min:55616 - global_seqlen/balanced_max:56805 - global_seqlen/mean:55913.875 - actor/entropy:0.10670273751020432 - actor/kl_loss:0.2844244036823511 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22931437604129315 - actor/pg_clipfrac:0.0023895144287962465 - actor/ppo_kl:0.032742245610643296 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.308781683444977 - perf/mfu/actor:0.1400885082835809 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:116.927734375 - perf/cpu_memory_used_gb:96.66282272338867 - actor/lr:1e-06 - training/global_step:356 - training/epoch:10 - critic/score/mean:0.7359374761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7359374761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14482909440994263 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14482909440994263 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:988.7687377929688 - response_length/max:2048.0 - response_length/min:63.0 - response_length/clip_ratio:0.3812499940395355 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.351487874984741e-05 - timing_s/generate_sequences:66.49885559082031 - timing_s/reshard:0.8423035144805908 - timing_s/gen:69.03855452872813 - timing_s/reward:0.14539391174912453 - timing_s/old_log_prob:1.9123390950262547 - timing_s/ref:1.650518512353301 - timing_s/adv:0.008312229067087173 - timing_s/update_actor:8.925735708326101 - timing_s/step:81.69845204427838 - timing_s/stop_profile:4.307180643081665e-05 - timing_per_token_ms/adv:1.8582661877501723e-05 - timing_per_token_ms/gen:0.21819609782598348 - timing_per_token_ms/ref:0.0036898679271319085 - timing_per_token_ms/update_actor:0.019954205705484777 - perf/total_num_tokens:447311 - perf/time_per_step:81.69845204427838 - perf/throughput:684.3933220386621
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.37187498807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.37187498807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09863734990358353, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09863734990358353, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1291.90625, 'response_length/max': 2048.0, 'response_length/min': 150.0, 'response_length/clip_ratio': 0.559374988079071, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.371875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  68%|██████▊   | 357/525 [5:57:11<3:57:50, 84.94s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  68%|██████▊   | 358/525 [5:58:32<3:53:32, 83.91s/it]
[36m(TaskRunner pid=2949575)[0m step:357 - global_seqlen/min:56604 - global_seqlen/max:79565 - global_seqlen/minmax_diff:22961 - global_seqlen/balanced_min:67672 - global_seqlen/balanced_max:68765 - global_seqlen/mean:68083.125 - actor/entropy:0.06120182201266289 - actor/kl_loss:0.30911994762718675 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.055701087415218356 - actor/pg_clipfrac:0.0005865758721483871 - actor/ppo_kl:-0.00734933373023523 - actor/pg_clipfrac_lower:0.0001953125 - actor/grad_norm:21.540688320994377 - perf/mfu/actor:0.16782161823115702 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:96.85675811767578 - actor/lr:1e-06 - training/global_step:357 - training/epoch:10 - critic/score/mean:0.37187498807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.37187498807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09863734990358353 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09863734990358353 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1291.90625 - response_length/max:2048.0 - response_length/min:150.0 - response_length/clip_ratio:0.559374988079071 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.371875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.431503713130951e-05 - timing_s/generate_sequences:68.2492446899414 - timing_s/reshard:0.7279514074325562 - timing_s/gen:70.57134643383324 - timing_s/reward:0.1753476094454527 - timing_s/old_log_prob:2.302599184215069 - timing_s/ref:1.8214734066277742 - timing_s/adv:0.008051736280322075 - timing_s/update_actor:9.153064331039786 - timing_s/step:84.05094346962869 - timing_s/stop_profile:4.630163311958313e-05 - timing_per_token_ms/adv:1.47829147830723e-05 - timing_per_token_ms/gen:0.17070546535844136 - timing_per_token_ms/ref:0.0033442086541778417 - timing_per_token_ms/update_actor:0.016804943095370155 - perf/total_num_tokens:544665 - perf/time_per_step:84.05094346962869 - perf/throughput:810.022138830618
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.8921874761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.8921874761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06694857031106949, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.06694857031106949, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 856.0750122070312, 'response_length/max': 2048.0, 'response_length/min': 88.0, 'response_length/clip_ratio': 0.31562501192092896, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.8921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:358 - global_seqlen/min:29537 - global_seqlen/max:65749 - global_seqlen/minmax_diff:36212 - global_seqlen/balanced_min:49930 - global_seqlen/balanced_max:51013 - global_seqlen/mean:50606.125 - actor/entropy:0.11708049476146698 - actor/kl_loss:0.28029442839324475 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10001437775790692 - actor/pg_clipfrac:0.0013266271460452117 - actor/ppo_kl:0.01119563423198997 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:35.27620676159859 - perf/mfu/actor:0.13499223000174143 - perf/max_memory_allocated_gb:74.08111476898193 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:96.9218864440918 - actor/lr:1e-06 - training/global_step:358 - training/epoch:10 - critic/score/mean:0.8921874761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.8921874761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06694857031106949 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.06694857031106949 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:856.0750122070312 - response_length/max:2048.0 - response_length/min:88.0 - response_length/clip_ratio:0.31562501192092896 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.8921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.801983833312988e-05 - timing_s/generate_sequences:66.00491333007812 - timing_s/reshard:0.7872255444526672 - timing_s/gen:69.64449839293957 - timing_s/reward:0.13115003518760204 - timing_s/old_log_prob:1.769437801092863 - timing_s/ref:1.563859710469842 - timing_s/adv:0.008400464430451393 - timing_s/update_actor:8.346184372901917 - timing_s/step:81.47979686968029 - timing_s/stop_profile:4.5746564865112305e-05 - timing_per_token_ms/adv:2.0749623762072756e-05 - timing_per_token_ms/gen:0.25422896063772 - timing_per_token_ms/ref:0.0038628222138867626 - timing_per_token_ms/update_actor:0.02061554894022689 - perf/total_num_tokens:404849 - perf/time_per_step:81.47979686968029 - perf/throughput:621.0880113132831
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.581250011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.581250011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12811236083507538, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.12811236083507538, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1116.40625, 'response_length/max': 2048.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.45625001192092896, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.58125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  68%|██████▊   | 359/525 [5:59:54<3:50:48, 83.42s/it]
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 05:41:06,291:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 05:41:11,201:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 05:41:11,203:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:41:06,735:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:41:12,095:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  69%|██████▊   | 360/525 [6:01:27<3:56:45, 86.09s/it]
[36m(TaskRunner pid=2949575)[0m step:359 - global_seqlen/min:40071 - global_seqlen/max:73245 - global_seqlen/minmax_diff:33174 - global_seqlen/balanced_min:60770 - global_seqlen/balanced_max:61844 - global_seqlen/mean:61045.625 - actor/entropy:0.08570152521133423 - actor/kl_loss:0.26271342523396013 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07351787909865379 - actor/pg_clipfrac:0.001765863853506744 - actor/ppo_kl:0.006112930287054041 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:28.277110278606415 - perf/mfu/actor:0.1515902696255634 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.00918579101562 - actor/lr:1e-06 - training/global_step:359 - training/epoch:10 - critic/score/mean:0.581250011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.581250011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12811236083507538 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.12811236083507538 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1116.40625 - response_length/max:2048.0 - response_length/min:110.0 - response_length/clip_ratio:0.45625001192092896 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.58125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010949000716209412 - timing_s/generate_sequences:66.499755859375 - timing_s/reshard:0.7643740177154541 - timing_s/gen:68.93293026834726 - timing_s/reward:0.15685272961854935 - timing_s/old_log_prob:2.15310125797987 - timing_s/ref:1.7698383182287216 - timing_s/adv:0.008317478001117706 - timing_s/update_actor:9.0431833807379 - timing_s/step:82.08095220476389 - timing_s/stop_profile:4.544109106063843e-05 - timing_per_token_ms/adv:1.7031273742216798e-05 - timing_per_token_ms/gen:0.19295431845583558 - timing_per_token_ms/ref:0.0036240072860027265 - timing_per_token_ms/update_actor:0.018517263482718666 - perf/total_num_tokens:488365 - perf/time_per_step:82.08095220476389 - perf/throughput:743.724620149533
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7875000238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7875000238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.13625825941562653, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.13625825941562653, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 987.8312377929688, 'response_length/max': 2048.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.3843750059604645, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:360 - global_seqlen/min:39400 - global_seqlen/max:63854 - global_seqlen/minmax_diff:24454 - global_seqlen/balanced_min:55460 - global_seqlen/balanced_max:56579 - global_seqlen/mean:55880.75 - actor/entropy:0.09922980517148972 - actor/kl_loss:0.27048558443784715 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04263921026140451 - actor/pg_clipfrac:0.004312632718938403 - actor/ppo_kl:-0.027942674959558645 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:29.624572038650513 - perf/mfu/actor:0.14125872649924207 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:96.9658088684082 - actor/lr:1e-06 - training/global_step:360 - training/epoch:10 - critic/score/mean:0.7875000238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7875000238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.13625825941562653 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.13625825941562653 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:987.8312377929688 - response_length/max:2048.0 - response_length/min:112.0 - response_length/clip_ratio:0.3843750059604645 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.50545072555542e-05 - timing_s/generate_sequences:66.68569946289062 - timing_s/reshard:0.7772805690765381 - timing_s/gen:69.12416096404195 - timing_s/reward:0.1450935024768114 - timing_s/old_log_prob:1.9825573284178972 - timing_s/ref:1.6860161125659943 - timing_s/adv:0.008505621924996376 - timing_s/update_actor:8.845664903521538 - timing_s/save_checkpoint:10.502811003476381 - timing_s/step:92.31145413778722 - timing_s/stop_profile:5.067884922027588e-05 - timing_per_token_ms/adv:1.902627900707394e-05 - timing_per_token_ms/gen:0.21867399215466315 - timing_per_token_ms/ref:0.0037714600120927026 - timing_per_token_ms/update_actor:0.019786923277518506 - perf/total_num_tokens:447046 - perf/time_per_step:92.31145413778722 - perf/throughput:605.350121736686
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4390625059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4390625059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10177882760763168, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10177882760763168, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1300.949951171875, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.5625, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  69%|██████▉   | 361/525 [6:02:50<3:53:10, 85.31s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:41:13,410:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:41:13,412:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_360/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  69%|██████▉   | 362/525 [6:04:15<3:50:59, 85.03s/it]
[36m(TaskRunner pid=2949575)[0m step:361 - global_seqlen/min:46063 - global_seqlen/max:84400 - global_seqlen/minmax_diff:38337 - global_seqlen/balanced_min:67933 - global_seqlen/balanced_max:68885 - global_seqlen/mean:68427.375 - actor/entropy:0.06021494045853615 - actor/kl_loss:0.29895834624767303 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0802242934703827 - actor/pg_clipfrac:0.002578675013501197 - actor/ppo_kl:0.028857062441863944 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:11.55531743913889 - perf/mfu/actor:0.16779789417943297 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.00156784057617 - actor/lr:1e-06 - training/global_step:361 - training/epoch:10 - critic/score/mean:0.4390625059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4390625059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10177882760763168 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10177882760763168 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1300.949951171875 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.5625 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011009350419044495 - timing_s/generate_sequences:67.320068359375 - timing_s/reshard:0.7809559106826782 - timing_s/gen:69.79027941077948 - timing_s/reward:0.1757059134542942 - timing_s/old_log_prob:2.1468206234276295 - timing_s/ref:1.8329044356942177 - timing_s/adv:0.008146913722157478 - timing_s/update_actor:9.201993454247713 - timing_s/step:83.17267447337508 - timing_s/stop_profile:4.3353065848350525e-05 - timing_per_token_ms/adv:1.4882409492833604e-05 - timing_per_token_ms/gen:0.16764258669332863 - timing_per_token_ms/ref:0.0033482660187063615 - timing_per_token_ms/update_actor:0.016809780906851448 - perf/total_num_tokens:547419 - perf/time_per_step:83.17267447337508 - perf/throughput:822.7146167086969
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.3734374940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.3734374940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.17577947676181793, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.17577947676181793, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1307.106201171875, 'response_length/max': 2048.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.565625011920929, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:362 - global_seqlen/min:54201 - global_seqlen/max:91750 - global_seqlen/minmax_diff:37549 - global_seqlen/balanced_min:68025 - global_seqlen/balanced_max:69015 - global_seqlen/mean:68643.0 - actor/entropy:0.06855828315019608 - actor/kl_loss:0.3009028390049934 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14222063701599835 - actor/pg_clipfrac:0.002205827173020225 - actor/ppo_kl:0.010934771203028503 - actor/pg_clipfrac_lower:5.6513631716370585e-05 - actor/grad_norm:11.370399683713913 - perf/mfu/actor:0.1675823845068521 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.07541275024414 - actor/lr:1e-06 - training/global_step:362 - training/epoch:10 - critic/score/mean:0.3734374940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.3734374940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.17577947676181793 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.17577947676181793 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1307.106201171875 - response_length/max:2048.0 - response_length/min:110.0 - response_length/clip_ratio:0.565625011920929 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010787695646286011 - timing_s/generate_sequences:67.57128143310547 - timing_s/reshard:0.755488395690918 - timing_s/gen:70.63790939562023 - timing_s/reward:0.1771722361445427 - timing_s/old_log_prob:2.1258459873497486 - timing_s/ref:1.8186137527227402 - timing_s/adv:0.008268019184470177 - timing_s/update_actor:9.245367975905538 - timing_s/step:84.03057623840868 - timing_s/stop_profile:4.5921653509140015e-05 - timing_per_token_ms/adv:1.505619506808811e-05 - timing_per_token_ms/gen:0.16887951294036976 - timing_per_token_ms/ref:0.003311724707404142 - timing_per_token_ms/update_actor:0.016835962836533838 - perf/total_num_tokens:549144 - perf/time_per_step:84.03057623840868 - perf/throughput:816.8812243444389
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.2265625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.2265625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12842118740081787, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12842118740081787, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1441.081298828125, 'response_length/max': 2048.0, 'response_length/min': 134.0, 'response_length/clip_ratio': 0.643750011920929, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.2265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  69%|██████▉   | 363/525 [6:05:40<3:49:29, 84.99s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  69%|██████▉   | 364/525 [6:07:05<3:48:45, 85.25s/it]
[36m(TaskRunner pid=2949575)[0m step:363 - global_seqlen/min:58394 - global_seqlen/max:85413 - global_seqlen/minmax_diff:27019 - global_seqlen/balanced_min:73260 - global_seqlen/balanced_max:74286 - global_seqlen/mean:74028.25 - actor/entropy:0.04254472255706787 - actor/kl_loss:0.31370824165642264 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14838467072695494 - actor/pg_clipfrac:0.00397920922114281 - actor/ppo_kl:-0.03024544619547669 - actor/pg_clipfrac_lower:0.0011457178770797327 - actor/grad_norm:8.714595586061478 - perf/mfu/actor:0.18156242892577026 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.06776428222656 - actor/lr:1e-06 - training/global_step:363 - training/epoch:10 - critic/score/mean:0.2265625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.2265625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12842118740081787 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12842118740081787 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1441.081298828125 - response_length/max:2048.0 - response_length/min:134.0 - response_length/clip_ratio:0.643750011920929 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.2265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.288638830184937e-05 - timing_s/generate_sequences:68.503662109375 - timing_s/reshard:0.8740565180778503 - timing_s/gen:71.42825911939144 - timing_s/reward:0.18898730911314487 - timing_s/old_log_prob:2.1750816516578197 - timing_s/ref:1.8573143500834703 - timing_s/adv:0.007492903620004654 - timing_s/update_actor:9.228487819433212 - timing_s/step:84.89937641844153 - timing_s/stop_profile:4.423782229423523e-05 - timing_per_token_ms/adv:1.2652101765212358e-05 - timing_per_token_ms/gen:0.15489293872090715 - timing_per_token_ms/ref:0.0031361580715528704 - timing_per_token_ms/update_actor:0.015582713051154816 - perf/total_num_tokens:592226 - perf/time_per_step:84.89937641844153 - perf/throughput:871.9528119398514
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.3734374940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.3734374940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.16358159482479095, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.16358159482479095, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1326.7437744140625, 'response_length/max': 2048.0, 'response_length/min': 111.0, 'response_length/clip_ratio': 0.574999988079071, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:364 - global_seqlen/min:47806 - global_seqlen/max:90922 - global_seqlen/minmax_diff:43116 - global_seqlen/balanced_min:69441 - global_seqlen/balanced_max:69442 - global_seqlen/mean:69441.625 - actor/entropy:0.05676262825727463 - actor/kl_loss:0.2977439250797033 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07669487595558167 - actor/pg_clipfrac:0.0005632893720758147 - actor/ppo_kl:-0.000728251759755949 - actor/pg_clipfrac_lower:5.9171597240492704e-05 - actor/grad_norm:13.245509669184685 - perf/mfu/actor:0.17023496880533884 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.171875 - actor/lr:1e-06 - training/global_step:364 - training/epoch:10 - critic/score/mean:0.3734374940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.3734374940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.16358159482479095 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.16358159482479095 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1326.7437744140625 - response_length/max:2048.0 - response_length/min:111.0 - response_length/clip_ratio:0.574999988079071 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.813610136508942e-05 - timing_s/generate_sequences:68.88871002197266 - timing_s/reshard:1.019677758216858 - timing_s/gen:72.43000574409962 - timing_s/reward:0.1818338967859745 - timing_s/old_log_prob:2.1913211680948734 - timing_s/ref:1.812041899189353 - timing_s/adv:0.007567755877971649 - timing_s/update_actor:9.20873573422432 - timing_s/step:85.84487008862197 - timing_s/stop_profile:4.0747225284576416e-05 - timing_per_token_ms/adv:1.3622513654403338e-05 - timing_per_token_ms/gen:0.17060096793394453 - timing_per_token_ms/ref:0.0032618078479394615 - timing_per_token_ms/update_actor:0.0165763973233351 - perf/total_num_tokens:555533 - perf/time_per_step:85.84487008862197 - perf/throughput:808.9199148220729
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.3734374940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.3734374940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09046220779418945, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09046220779418945, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1354.340576171875, 'response_length/max': 2048.0, 'response_length/min': 126.0, 'response_length/clip_ratio': 0.5718749761581421, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  70%|██████▉   | 365/525 [6:08:29<3:46:13, 84.84s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  70%|██████▉   | 366/525 [6:09:53<3:44:06, 84.57s/it]
[36m(TaskRunner pid=2949575)[0m step:365 - global_seqlen/min:57795 - global_seqlen/max:80932 - global_seqlen/minmax_diff:23137 - global_seqlen/balanced_min:70040 - global_seqlen/balanced_max:70609 - global_seqlen/mean:70536.75 - actor/entropy:0.06309512257575989 - actor/kl_loss:0.2908926039934158 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.00281791090965271 - actor/pg_clipfrac:0.0007893004571087658 - actor/ppo_kl:-0.0016733530908823013 - actor/pg_clipfrac_lower:0.00015099084412213416 - actor/grad_norm:0.7863528728485107 - perf/mfu/actor:0.17279452125974104 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.04906845092773 - actor/lr:1e-06 - training/global_step:365 - training/epoch:10 - critic/score/mean:0.3734374940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.3734374940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09046220779418945 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09046220779418945 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1354.340576171875 - response_length/max:2048.0 - response_length/min:126.0 - response_length/clip_ratio:0.5718749761581421 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.724948227405548e-05 - timing_s/generate_sequences:68.27387237548828 - timing_s/reshard:0.8915338516235352 - timing_s/gen:70.18442865274847 - timing_s/reward:0.17984635569155216 - timing_s/old_log_prob:2.295582951977849 - timing_s/ref:1.9527519382536411 - timing_s/adv:0.007567634806036949 - timing_s/update_actor:9.210664169862866 - timing_s/step:83.84420090168715 - timing_s/stop_profile:4.493445158004761e-05 - timing_per_token_ms/adv:1.3410801472347657e-05 - timing_per_token_ms/gen:0.16194326264106487 - timing_per_token_ms/ref:0.0034605222424013743 - timing_per_token_ms/update_actor:0.01632245632571473 - perf/total_num_tokens:564294 - perf/time_per_step:83.84420090168715 - perf/throughput:841.2835860014814
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.37812501192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.37812501192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.13691025972366333, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.13691025972366333, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1339.65625, 'response_length/max': 2048.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.5874999761581421, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.378125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:366 - global_seqlen/min:59185 - global_seqlen/max:80901 - global_seqlen/minmax_diff:21716 - global_seqlen/balanced_min:69363 - global_seqlen/balanced_max:70526 - global_seqlen/mean:69945.0 - actor/entropy:0.0511927455663681 - actor/kl_loss:0.2995371311903 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21670150551944972 - actor/pg_clipfrac:0.0005837802498717792 - actor/ppo_kl:-0.005093997327367106 - actor/pg_clipfrac_lower:8.381286170333624e-05 - actor/grad_norm:18.732221491634846 - perf/mfu/actor:0.1712271724259626 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.04962539672852 - actor/lr:1e-06 - training/global_step:366 - training/epoch:10 - critic/score/mean:0.37812501192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.37812501192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.13691025972366333 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.13691025972366333 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1339.65625 - response_length/max:2048.0 - response_length/min:80.0 - response_length/clip_ratio:0.5874999761581421 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.378125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.843039929866791e-05 - timing_s/generate_sequences:68.44303894042969 - timing_s/reshard:0.8898763060569763 - timing_s/gen:70.38096489571035 - timing_s/reward:0.17977868765592575 - timing_s/old_log_prob:2.248162815347314 - timing_s/ref:1.8795380480587482 - timing_s/adv:0.007574401795864105 - timing_s/update_actor:9.226568764075637 - timing_s/step:83.93636923283339 - timing_s/stop_profile:4.1700899600982666e-05 - timing_per_token_ms/adv:1.3536353198699165e-05 - timing_per_token_ms/gen:0.16417682916725454 - timing_per_token_ms/ref:0.0033589571235591326 - timing_per_token_ms/update_actor:0.016488971270418967 - perf/total_num_tokens:559560 - perf/time_per_step:83.93636923283339 - perf/throughput:833.3098112211366
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4703125059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4703125059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08040790259838104, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.08040790259838104, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1221.1312255859375, 'response_length/max': 2048.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.515625, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  70%|██████▉   | 367/525 [6:11:17<3:42:21, 84.44s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  70%|███████   | 368/525 [6:12:40<3:39:34, 83.92s/it]
[36m(TaskRunner pid=2949575)[0m step:367 - global_seqlen/min:47189 - global_seqlen/max:86973 - global_seqlen/minmax_diff:39784 - global_seqlen/balanced_min:64695 - global_seqlen/balanced_max:65575 - global_seqlen/mean:65243.375 - actor/entropy:0.07233226299285889 - actor/kl_loss:0.2926204279065132 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13773370068520308 - actor/pg_clipfrac:0.0023496831432566977 - actor/ppo_kl:-0.023985319735947995 - actor/pg_clipfrac_lower:0.0008878598353476263 - actor/grad_norm:7.116612419486046 - perf/mfu/actor:0.1609915365698941 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.04585266113281 - actor/lr:1e-06 - training/global_step:367 - training/epoch:10 - critic/score/mean:0.4703125059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4703125059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08040790259838104 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.08040790259838104 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1221.1312255859375 - response_length/max:2048.0 - response_length/min:74.0 - response_length/clip_ratio:0.515625 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.671917021274567e-05 - timing_s/generate_sequences:68.11934661865234 - timing_s/reshard:0.8674178123474121 - timing_s/gen:70.69244748540223 - timing_s/reward:0.16677672415971756 - timing_s/old_log_prob:2.1250842697918415 - timing_s/ref:1.815009418874979 - timing_s/adv:0.007576458156108856 - timing_s/update_actor:9.126705741509795 - timing_s/step:83.94713786430657 - timing_s/stop_profile:4.459545016288757e-05 - timing_per_token_ms/adv:1.4515761477906484e-05 - timing_per_token_ms/gen:0.18090921708201468 - timing_per_token_ms/ref:0.003477382605657239 - timing_per_token_ms/update_actor:0.017485886002812152 - perf/total_num_tokens:521947 - perf/time_per_step:83.94713786430657 - perf/throughput:777.1959433025625
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6640625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6640625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06603367626667023, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.06603367626667023, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1081.159423828125, 'response_length/max': 2048.0, 'response_length/min': 113.0, 'response_length/clip_ratio': 0.44062501192092896, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:368 - global_seqlen/min:47973 - global_seqlen/max:74607 - global_seqlen/minmax_diff:26634 - global_seqlen/balanced_min:58986 - global_seqlen/balanced_max:60028 - global_seqlen/mean:59635.75 - actor/entropy:0.07856474071741104 - actor/kl_loss:0.2770559713244438 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.16404952835291625 - actor/pg_clipfrac:0.0006227941164979711 - actor/ppo_kl:-0.00015771745092933996 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:26.49497589468956 - perf/mfu/actor:0.1520027439347309 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.00264739990234 - actor/lr:1e-06 - training/global_step:368 - training/epoch:10 - critic/score/mean:0.6640625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6640625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06603367626667023 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.06603367626667023 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1081.159423828125 - response_length/max:2048.0 - response_length/min:113.0 - response_length/clip_ratio:0.44062501192092896 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.538124918937683e-05 - timing_s/generate_sequences:67.58306121826172 - timing_s/reshard:0.8559540510177612 - timing_s/gen:69.93467890098691 - timing_s/reward:0.15293852612376213 - timing_s/old_log_prob:2.0497794579714537 - timing_s/ref:1.72791663184762 - timing_s/adv:0.007516372948884964 - timing_s/update_actor:8.803123192861676 - timing_s/step:82.68927530571818 - timing_s/stop_profile:4.5491382479667664e-05 - timing_per_token_ms/adv:1.5754754800780077e-05 - timing_per_token_ms/gen:0.2021402918192187 - timing_per_token_ms/ref:0.0036218137439531237 - timing_per_token_ms/update_actor:0.018451858140590326 - perf/total_num_tokens:477086 - perf/time_per_step:82.68927530571818 - perf/throughput:721.2029586607833
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.543749988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.543749988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.058637671172618866, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.058637671172618866, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1146.1812744140625, 'response_length/max': 2048.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.47187501192092896, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.54375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  70%|███████   | 369/525 [6:14:03<3:37:16, 83.57s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 05:55:17,677:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 05:55:22,501:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/optim_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 05:55:22,504:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/extra_state_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:55:18,069:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 05:55:23,463:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  70%|███████   | 370/525 [6:15:38<3:44:57, 87.08s/it]
[36m(TaskRunner pid=2949575)[0m step:369 - global_seqlen/min:39880 - global_seqlen/max:83555 - global_seqlen/minmax_diff:43675 - global_seqlen/balanced_min:61453 - global_seqlen/balanced_max:62365 - global_seqlen/mean:62249.75 - actor/entropy:0.08664876967668533 - actor/kl_loss:0.26975067891180515 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08192485426552594 - actor/pg_clipfrac:0.0010958230923279189 - actor/ppo_kl:0.0007754241087241098 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.813355505466461 - perf/mfu/actor:0.158179862352198 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.00738906860352 - actor/lr:1e-06 - training/global_step:369 - training/epoch:10 - critic/score/mean:0.543749988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.543749988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.058637671172618866 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.058637671172618866 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1146.1812744140625 - response_length/max:2048.0 - response_length/min:110.0 - response_length/clip_ratio:0.47187501192092896 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.54375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.803978562355042e-05 - timing_s/generate_sequences:67.47191619873047 - timing_s/reshard:0.7753496766090393 - timing_s/gen:69.75815655849874 - timing_s/reward:0.15903154388070107 - timing_s/old_log_prob:1.9955470897257328 - timing_s/ref:1.7106414083391428 - timing_s/adv:0.007653752341866493 - timing_s/update_actor:8.843565601855516 - timing_s/step:82.48822689242661 - timing_s/stop_profile:4.273653030395508e-05 - timing_per_token_ms/adv:1.536904232921918e-05 - timing_per_token_ms/gen:0.190191768749758 - timing_per_token_ms/ref:0.003435036703639659 - timing_per_token_ms/update_actor:0.017758235177361185 - perf/total_num_tokens:497998 - perf/time_per_step:82.48822689242661 - perf/throughput:754.6501160848113
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.3296875059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.3296875059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07501687109470367, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07501687109470367, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1349.278076171875, 'response_length/max': 2048.0, 'response_length/min': 95.0, 'response_length/clip_ratio': 0.590624988079071, 'prompt_length/mean': 410.5, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:370 - global_seqlen/min:51834 - global_seqlen/max:89170 - global_seqlen/minmax_diff:37336 - global_seqlen/balanced_min:69756 - global_seqlen/balanced_max:70773 - global_seqlen/mean:70391.125 - actor/entropy:0.05535801500082016 - actor/kl_loss:0.3096988327801228 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1267353887669742 - actor/pg_clipfrac:0.0008590044410084375 - actor/ppo_kl:0.009691098037001212 - actor/pg_clipfrac_lower:8.702325721969828e-05 - actor/grad_norm:14.943108633160591 - perf/mfu/actor:0.174239507218355 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.09290313720703 - actor/lr:1e-06 - training/global_step:370 - training/epoch:10 - critic/score/mean:0.3296875059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.3296875059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07501687109470367 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07501687109470367 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1349.278076171875 - response_length/max:2048.0 - response_length/min:95.0 - response_length/clip_ratio:0.590624988079071 - prompt_length/mean:410.5 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.03252512216568e-05 - timing_s/generate_sequences:68.22297668457031 - timing_s/reshard:0.7481287717819214 - timing_s/gen:71.10195026360452 - timing_s/reward:0.1824430227279663 - timing_s/old_log_prob:2.1815316397696733 - timing_s/ref:1.8682541642338037 - timing_s/adv:0.0087819192558527 - timing_s/update_actor:9.130098655819893 - timing_s/save_checkpoint:10.464652631431818 - timing_s/step:94.95489528216422 - timing_s/stop_profile:5.449354648590088e-05 - timing_per_token_ms/adv:1.5594862377630525e-05 - timing_per_token_ms/gen:0.1646759036975895 - timing_per_token_ms/ref:0.0033176308878317467 - timing_per_token_ms/update_actor:0.016213156587247136 - perf/total_num_tokens:563129 - perf/time_per_step:94.95489528216422 - perf/throughput:741.311175067157
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.707812488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.707812488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07587048411369324, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.07587048411369324, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1012.8343505859375, 'response_length/max': 2048.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.390625, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7078125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  71%|███████   | 371/525 [6:17:01<3:40:00, 85.72s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:55:24,708:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 05:55:24,710:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_370/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  71%|███████   | 372/525 [6:18:23<3:35:39, 84.57s/it]
[36m(TaskRunner pid=2949575)[0m step:371 - global_seqlen/min:37739 - global_seqlen/max:75826 - global_seqlen/minmax_diff:38087 - global_seqlen/balanced_min:56427 - global_seqlen/balanced_max:57154 - global_seqlen/mean:56880.875 - actor/entropy:0.10471201688051224 - actor/kl_loss:0.25769204199314116 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15211583562195302 - actor/pg_clipfrac:0.0012429829555912874 - actor/ppo_kl:-0.001986719425985939 - actor/pg_clipfrac_lower:0.0005303406840539537 - actor/grad_norm:26.32173092663288 - perf/mfu/actor:0.14378092727611844 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.14941024780273 - actor/lr:1e-06 - training/global_step:371 - training/epoch:10 - critic/score/mean:0.707812488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.707812488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07587048411369324 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.07587048411369324 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1012.8343505859375 - response_length/max:2048.0 - response_length/min:112.0 - response_length/clip_ratio:0.390625 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7078125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.247846901416779e-05 - timing_s/generate_sequences:67.37200164794922 - timing_s/reshard:0.8754549622535706 - timing_s/gen:69.89174670912325 - timing_s/reward:0.14528133161365986 - timing_s/old_log_prob:1.9416977167129517 - timing_s/ref:1.6649020723998547 - timing_s/adv:0.007583361119031906 - timing_s/update_actor:8.849150158464909 - timing_s/step:82.51346540078521 - timing_s/stop_profile:4.269927740097046e-05 - timing_per_token_ms/adv:1.6665006293925475e-05 - timing_per_token_ms/gen:0.2156440518381993 - timing_per_token_ms/ref:0.003658747497291169 - timing_per_token_ms/update_actor:0.019446672889756243 - perf/total_num_tokens:455047 - perf/time_per_step:82.51346540078521 - perf/throughput:689.3526374600516
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.996874988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.996874988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.060055576264858246, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.060055576264858246, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 836.3781127929688, 'response_length/max': 2048.0, 'response_length/min': 67.0, 'response_length/clip_ratio': 0.2906250059604645, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.996875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:372 - global_seqlen/min:28099 - global_seqlen/max:64204 - global_seqlen/minmax_diff:36105 - global_seqlen/balanced_min:49287 - global_seqlen/balanced_max:50111 - global_seqlen/mean:49809.5 - actor/entropy:0.14386439323425293 - actor/kl_loss:0.2264545738697052 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07893276829272508 - actor/pg_clipfrac:0.002811741655750666 - actor/ppo_kl:0.01324007323164551 - actor/pg_clipfrac_lower:0.0002092229202389717 - actor/grad_norm:2.755546674132347 - perf/mfu/actor:0.12773635189082064 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:119.453125 - perf/cpu_memory_used_gb:97.10548782348633 - actor/lr:1e-06 - training/global_step:372 - training/epoch:10 - critic/score/mean:0.996874988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.996874988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.060055576264858246 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.060055576264858246 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:836.3781127929688 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.2906250059604645 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.996875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.671304047107697e-05 - timing_s/generate_sequences:66.24179077148438 - timing_s/reshard:0.7820637822151184 - timing_s/gen:69.70259224250913 - timing_s/reward:0.12723793275654316 - timing_s/old_log_prob:1.7728299908339977 - timing_s/ref:1.6074761971831322 - timing_s/adv:0.007652688771486282 - timing_s/update_actor:8.662014473229647 - timing_s/step:81.89348586462438 - timing_s/stop_profile:4.501454532146454e-05 - timing_per_token_ms/adv:1.920489256940514e-05 - timing_per_token_ms/gen:0.2604331632392239 - timing_per_token_ms/ref:0.004034060262558177 - timing_per_token_ms/update_actor:0.02173785741984372 - perf/total_num_tokens:398476 - perf/time_per_step:81.89348586462438 - perf/throughput:608.2229798147629
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.574999988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.574999988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0406348742544651, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0406348742544651, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1172.4593505859375, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.48750001192092896, 'prompt_length/mean': 410.28125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.575, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  71%|███████   | 373/525 [6:19:46<3:33:22, 84.23s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  71%|███████   | 374/525 [6:21:09<3:31:02, 83.86s/it]
[36m(TaskRunner pid=2949575)[0m step:373 - global_seqlen/min:41781 - global_seqlen/max:88967 - global_seqlen/minmax_diff:47186 - global_seqlen/balanced_min:62819 - global_seqlen/balanced_max:63801 - global_seqlen/mean:63309.625 - actor/entropy:0.07878010720014572 - actor/kl_loss:0.2965252961963415 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15596372298896313 - actor/pg_clipfrac:0.00026140191475860776 - actor/ppo_kl:0.010150883816069012 - actor/pg_clipfrac_lower:8.238289592554793e-05 - actor/grad_norm:15.315966211259365 - perf/mfu/actor:0.15897023785310266 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:96.9848747253418 - actor/lr:1e-06 - training/global_step:373 - training/epoch:10 - critic/score/mean:0.574999988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.574999988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0406348742544651 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0406348742544651 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1172.4593505859375 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.48750001192092896 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.575 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.494166493415833e-05 - timing_s/generate_sequences:67.65617370605469 - timing_s/reshard:0.7818779349327087 - timing_s/gen:70.54532401449978 - timing_s/reward:0.162119397893548 - timing_s/old_log_prob:1.9939433746039867 - timing_s/ref:1.7217328306287527 - timing_s/adv:0.00763261504471302 - timing_s/update_actor:8.957236809656024 - timing_s/step:83.40095155499876 - timing_s/stop_profile:4.540197551250458e-05 - timing_per_token_ms/adv:1.5070013139220577e-05 - timing_per_token_ms/gen:0.18802710119087224 - timing_per_token_ms/ref:0.0033994294521345544 - timing_per_token_ms/update_actor:0.01768537724251254 - perf/total_num_tokens:506477 - perf/time_per_step:83.40095155499876 - perf/throughput:759.099552458349
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6546875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6546875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09441999346017838, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09441999346017838, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1067.5875244140625, 'response_length/max': 2048.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.4281249940395355, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:374 - global_seqlen/min:35920 - global_seqlen/max:88426 - global_seqlen/minmax_diff:52506 - global_seqlen/balanced_min:58959 - global_seqlen/balanced_max:60020 - global_seqlen/mean:59092.875 - actor/entropy:0.09375891089439392 - actor/kl_loss:0.29635064899921415 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.015668530017137527 - actor/pg_clipfrac:0.0036820596564211884 - actor/ppo_kl:0.013023349579998466 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:12.300628915429115 - perf/mfu/actor:0.15155367701193384 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:96.87042617797852 - actor/lr:1e-06 - training/global_step:374 - training/epoch:10 - critic/score/mean:0.6546875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6546875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09441999346017838 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09441999346017838 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1067.5875244140625 - response_length/max:2048.0 - response_length/min:85.0 - response_length/clip_ratio:0.4281249940395355 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.255561649799347e-05 - timing_s/generate_sequences:66.94844055175781 - timing_s/reshard:0.8178185224533081 - timing_s/gen:70.29167066141963 - timing_s/reward:0.15118211321532726 - timing_s/old_log_prob:2.0387312956154346 - timing_s/ref:1.743882354348898 - timing_s/adv:0.007532551884651184 - timing_s/update_actor:8.741622695699334 - timing_s/step:82.9885031376034 - timing_s/stop_profile:4.686973989009857e-05 - timing_per_token_ms/adv:1.593371426896048e-05 - timing_per_token_ms/gen:0.2057550044534395 - timing_per_token_ms/ref:0.0036888591779230956 - timing_per_token_ms/update_actor:0.01849127897335198 - perf/total_num_tokens:472743 - perf/time_per_step:82.9885031376034 - perf/throughput:712.0609815315983
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.16291290521621704, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.16291290521621704, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1062.731201171875, 'response_length/max': 2048.0, 'response_length/min': 118.0, 'response_length/clip_ratio': 0.4281249940395355, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  71%|███████▏  | 375/525 [6:22:31<3:28:38, 83.46s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  72%|███████▏  | 376/525 [6:23:55<3:27:16, 83.47s/it]
[36m(TaskRunner pid=2949575)[0m step:375 - global_seqlen/min:46396 - global_seqlen/max:69429 - global_seqlen/minmax_diff:23033 - global_seqlen/balanced_min:58748 - global_seqlen/balanced_max:59798 - global_seqlen/mean:58881.125 - actor/entropy:0.1052054688334465 - actor/kl_loss:0.2428700838238001 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03393755313009024 - actor/pg_clipfrac:0.003074314707191661 - actor/ppo_kl:0.0059959011123282835 - actor/pg_clipfrac_lower:2.0946795120835305e-05 - actor/grad_norm:16.11893540620804 - perf/mfu/actor:0.14939151683934931 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:96.85186004638672 - actor/lr:1e-06 - training/global_step:375 - training/epoch:10 - critic/score/mean:0.625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.16291290521621704 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.16291290521621704 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1062.731201171875 - response_length/max:2048.0 - response_length/min:118.0 - response_length/clip_ratio:0.4281249940395355 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.96211713552475e-05 - timing_s/generate_sequences:67.124755859375 - timing_s/reshard:0.7712581753730774 - timing_s/gen:69.76330942474306 - timing_s/reward:0.15335379540920258 - timing_s/old_log_prob:1.9231899697333574 - timing_s/ref:1.6476761475205421 - timing_s/adv:0.007554797455668449 - timing_s/update_actor:8.837530925869942 - timing_s/step:82.34616828337312 - timing_s/stop_profile:4.4133514165878296e-05 - timing_per_token_ms/adv:1.603824115042904e-05 - timing_per_token_ms/gen:0.20514155573417273 - timing_per_token_ms/ref:0.003497886944926201 - timing_per_token_ms/update_actor:0.01876138347787585 - perf/total_num_tokens:471049 - perf/time_per_step:82.34616828337312 - perf/throughput:715.0438961212595
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.573437511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.573437511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1521802395582199, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1521802395582199, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1128.7281494140625, 'response_length/max': 2048.0, 'response_length/min': 56.0, 'response_length/clip_ratio': 0.4625000059604645, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5734375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:376 - global_seqlen/min:34314 - global_seqlen/max:78331 - global_seqlen/minmax_diff:44017 - global_seqlen/balanced_min:61030 - global_seqlen/balanced_max:62003 - global_seqlen/mean:61516.625 - actor/entropy:0.08616869151592255 - actor/kl_loss:0.26949819587171076 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09501023106276989 - actor/pg_clipfrac:0.0014322560033178887 - actor/ppo_kl:0.014799360965844244 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:34.0319484770298 - perf/mfu/actor:0.1507160278117247 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:96.9206314086914 - actor/lr:1e-06 - training/global_step:376 - training/epoch:10 - critic/score/mean:0.573437511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.573437511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1521802395582199 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1521802395582199 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1128.7281494140625 - response_length/max:2048.0 - response_length/min:56.0 - response_length/clip_ratio:0.4625000059604645 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5734375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.280148565769196e-05 - timing_s/generate_sequences:67.19808959960938 - timing_s/reshard:0.8334053754806519 - timing_s/gen:70.34260838665068 - timing_s/reward:0.15858696587383747 - timing_s/old_log_prob:1.9782262295484543 - timing_s/ref:1.8043840546160936 - timing_s/adv:0.007581964135169983 - timing_s/update_actor:9.166780604049563 - timing_s/step:83.47170856781304 - timing_s/stop_profile:4.474259912967682e-05 - timing_per_token_ms/adv:1.5406331490003684e-05 - timing_per_token_ms/gen:0.1947507520540284 - timing_per_token_ms/ref:0.0036664561299813133 - timing_per_token_ms/update_actor:0.01862663264615371 - perf/total_num_tokens:492133 - perf/time_per_step:83.47170856781304 - perf/throughput:736.9757496939629
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.15937499701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.15937499701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10321775823831558, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10321775823831558, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1507.6937255859375, 'response_length/max': 2048.0, 'response_length/min': 87.0, 'response_length/clip_ratio': 0.6968749761581421, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.159375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  72%|███████▏  | 377/525 [6:25:20<3:27:20, 84.06s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  72%|███████▏  | 378/525 [6:26:46<3:27:07, 84.54s/it]
[36m(TaskRunner pid=2949575)[0m step:377 - global_seqlen/min:65128 - global_seqlen/max:89213 - global_seqlen/minmax_diff:24085 - global_seqlen/balanced_min:75648 - global_seqlen/balanced_max:76840 - global_seqlen/mean:76688.375 - actor/entropy:0.0337829664349556 - actor/kl_loss:0.34134540483355524 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.029118102975189686 - actor/pg_clipfrac:0.002222498990886379 - actor/ppo_kl:0.018506643043656366 - actor/pg_clipfrac_lower:2.44140625e-05 - actor/grad_norm:11.699146196246147 - perf/mfu/actor:0.18724725819997232 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.01113510131836 - actor/lr:1e-06 - training/global_step:377 - training/epoch:10 - critic/score/mean:0.15937499701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.15937499701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10321775823831558 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10321775823831558 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1507.6937255859375 - response_length/max:2048.0 - response_length/min:87.0 - response_length/clip_ratio:0.6968749761581421 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.159375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.896365761756897e-05 - timing_s/generate_sequences:68.86558532714844 - timing_s/reshard:0.7827380895614624 - timing_s/gen:71.40067707188427 - timing_s/reward:0.19487396627664566 - timing_s/old_log_prob:2.318224897608161 - timing_s/ref:1.987789923325181 - timing_s/adv:0.007487015798687935 - timing_s/update_actor:9.289857348427176 - timing_s/step:85.21243062615395 - timing_s/stop_profile:4.3295323848724365e-05 - timing_per_token_ms/adv:1.2203635490202939e-05 - timing_per_token_ms/gen:0.14799233322393116 - timing_per_token_ms/ref:0.0032400444058913445 - timing_per_token_ms/update_actor:0.015142218994122604 - perf/total_num_tokens:613507 - perf/time_per_step:85.21243062615395 - perf/throughput:899.9669935064886
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.09062500298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.09062500298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07031013071537018, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.07031013071537018, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1710.4625244140625, 'response_length/max': 2048.0, 'response_length/min': 138.0, 'response_length/clip_ratio': 0.8062499761581421, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.090625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:378 - global_seqlen/min:62491 - global_seqlen/max:96739 - global_seqlen/minmax_diff:34248 - global_seqlen/balanced_min:84383 - global_seqlen/balanced_max:85740 - global_seqlen/mean:84794.75 - actor/entropy:0.018157992511987686 - actor/kl_loss:0.32259034030139444 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13889498449862003 - actor/pg_clipfrac:0.00027115076227346435 - actor/ppo_kl:-0.0013516713224817067 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:9.519977098330855 - perf/mfu/actor:0.20816337156180256 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.1359748840332 - actor/lr:1e-06 - training/global_step:378 - training/epoch:10 - critic/score/mean:-0.09062500298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.09062500298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07031013071537018 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.07031013071537018 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1710.4625244140625 - response_length/max:2048.0 - response_length/min:138.0 - response_length/clip_ratio:0.8062499761581421 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.090625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.93864780664444e-05 - timing_s/generate_sequences:69.26947021484375 - timing_s/reshard:0.9329038858413696 - timing_s/gen:71.56328133493662 - timing_s/reward:0.21686971373856068 - timing_s/old_log_prob:2.310113875195384 - timing_s/ref:1.976803496479988 - timing_s/adv:0.00747171975672245 - timing_s/update_actor:9.266951320692897 - timing_s/step:85.35969210974872 - timing_s/stop_profile:4.363618791103363e-05 - timing_per_token_ms/adv:1.1014419755825759e-05 - timing_per_token_ms/gen:0.13074548794356902 - timing_per_token_ms/ref:0.002914100661420648 - timing_per_token_ms/update_actor:0.013660856539899135 - perf/total_num_tokens:678358 - perf/time_per_step:85.35969210974872 - perf/throughput:993.3816290126449
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.1484375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.1484375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08273603022098541, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08273603022098541, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1508.074951171875, 'response_length/max': 2048.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.684374988079071, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.1484375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  72%|███████▏  | 379/525 [6:28:11<3:25:44, 84.55s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:09:26,482:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:09:31,116:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:09:31,118:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:09:26,842:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:09:31,676:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  72%|███████▏  | 380/525 [6:29:47<3:32:44, 88.03s/it]
[36m(TaskRunner pid=2949575)[0m step:379 - global_seqlen/min:66927 - global_seqlen/max:89745 - global_seqlen/minmax_diff:22818 - global_seqlen/balanced_min:76261 - global_seqlen/balanced_max:77424 - global_seqlen/mean:76699.25 - actor/entropy:0.03241719678044319 - actor/kl_loss:0.29657838903367517 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17308646366000174 - actor/pg_clipfrac:0.0006458382122218609 - actor/ppo_kl:-0.014828791268155329 - actor/pg_clipfrac_lower:0.0010046634124591947 - actor/grad_norm:3.674821063876152 - perf/mfu/actor:0.1881476151461005 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.11649703979492 - actor/lr:1e-06 - training/global_step:379 - training/epoch:10 - critic/score/mean:0.1484375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.1484375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08273603022098541 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08273603022098541 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1508.074951171875 - response_length/max:2048.0 - response_length/min:100.0 - response_length/clip_ratio:0.684374988079071 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.1484375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.361173629760742e-05 - timing_s/generate_sequences:68.47420501708984 - timing_s/reshard:0.90369713306427 - timing_s/gen:70.90386165119708 - timing_s/reward:0.19593172147870064 - timing_s/old_log_prob:2.2678609900176525 - timing_s/ref:1.9315591640770435 - timing_s/adv:0.007458308711647987 - timing_s/update_actor:9.23988907970488 - timing_s/step:84.55996068194509 - timing_s/stop_profile:4.37665730714798e-05 - timing_per_token_ms/adv:1.2155120016897146e-05 - timing_per_token_ms/gen:0.14692542987582902 - timing_per_token_ms/ref:0.003147943369845604 - timing_per_token_ms/update_actor:0.015058636622432554 - perf/total_num_tokens:613594 - perf/time_per_step:84.55996068194509 - perf/throughput:907.0398020700183
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.22968749701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.22968749701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.056512556970119476, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.056512556970119476, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1816.949951171875, 'response_length/max': 2048.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.8687499761581421, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:380 - global_seqlen/min:72789 - global_seqlen/max:98375 - global_seqlen/minmax_diff:25586 - global_seqlen/balanced_min:88093 - global_seqlen/balanced_max:89404 - global_seqlen/mean:89071.75 - actor/entropy:0.010593093000352383 - actor/kl_loss:0.35237863212823867 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.032157647982239725 - actor/pg_clipfrac:0.0001934338768478483 - actor/ppo_kl:-0.0009335731017927173 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.2080779643256676 - perf/mfu/actor:0.21666266798449835 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.15333557128906 - actor/lr:1e-06 - training/global_step:380 - training/epoch:10 - critic/score/mean:-0.22968749701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.22968749701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.056512556970119476 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.056512556970119476 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1816.949951171875 - response_length/max:2048.0 - response_length/min:112.0 - response_length/clip_ratio:0.8687499761581421 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.319264113903046e-05 - timing_s/generate_sequences:69.56123352050781 - timing_s/reshard:0.9078748822212219 - timing_s/gen:71.70999679900706 - timing_s/reward:0.22717012837529182 - timing_s/old_log_prob:2.3998827263712883 - timing_s/ref:2.00238224491477 - timing_s/adv:0.007776273414492607 - timing_s/update_actor:9.367228472605348 - timing_s/save_checkpoint:10.401620836928487 - timing_s/step:96.129807876423 - timing_s/stop_profile:6.0074031352996826e-05 - timing_per_token_ms/adv:1.091293453661319e-05 - timing_per_token_ms/gen:0.12333511653974906 - timing_per_token_ms/ref:0.00281006919269405 - timing_per_token_ms/update_actor:0.013145622030280852 - perf/total_num_tokens:712574 - perf/time_per_step:96.129807876423 - perf/throughput:926.577842686461
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.10000000149011612, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.10000000149011612, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03499120846390724, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.03499120846390724, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1720.965576171875, 'response_length/max': 2048.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.8125, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  73%|███████▎  | 381/525 [6:31:12<3:29:29, 87.29s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:09:33,395:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:09:33,398:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_380/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  73%|███████▎  | 382/525 [6:32:38<3:26:33, 86.67s/it]
[36m(TaskRunner pid=2949575)[0m step:381 - global_seqlen/min:61774 - global_seqlen/max:98340 - global_seqlen/minmax_diff:36566 - global_seqlen/balanced_min:84584 - global_seqlen/balanced_max:85882 - global_seqlen/mean:85232.375 - actor/entropy:0.01267989445477724 - actor/kl_loss:0.33887133821845056 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03496405892074108 - actor/pg_clipfrac:2.2686025477014483e-05 - actor/ppo_kl:-0.00010655495134415105 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.645185723900795 - perf/mfu/actor:0.20683306246720562 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.34896087646484 - actor/lr:1e-06 - training/global_step:381 - training/epoch:10 - critic/score/mean:-0.10000000149011612 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.10000000149011612 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03499120846390724 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03499120846390724 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1720.965576171875 - response_length/max:2048.0 - response_length/min:80.0 - response_length/clip_ratio:0.8125 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.256120443344116e-05 - timing_s/generate_sequences:69.03091430664062 - timing_s/reshard:0.8359140157699585 - timing_s/gen:71.29485829919577 - timing_s/reward:0.21767236851155758 - timing_s/old_log_prob:2.6245134249329567 - timing_s/ref:2.000344878062606 - timing_s/adv:0.00827089138329029 - timing_s/update_actor:9.376832965761423 - timing_s/step:85.53985678218305 - timing_s/stop_profile:4.67449426651001e-05 - timing_per_token_ms/adv:1.2129914517943285e-05 - timing_per_token_ms/gen:0.12946012921378763 - timing_per_token_ms/ref:0.0029336635258354086 - timing_per_token_ms/update_actor:0.013751865071461143 - perf/total_num_tokens:681859 - perf/time_per_step:85.53985678218305 - perf/throughput:996.405397510005
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.17499999701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.17499999701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05782710760831833, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05782710760831833, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1803.824951171875, 'response_length/max': 2048.0, 'response_length/min': 125.0, 'response_length/clip_ratio': 0.846875011920929, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.175, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:382 - global_seqlen/min:73005 - global_seqlen/max:97082 - global_seqlen/minmax_diff:24077 - global_seqlen/balanced_min:87893 - global_seqlen/balanced_max:88665 - global_seqlen/mean:88551.125 - actor/entropy:0.017453357577323914 - actor/kl_loss:0.4367687001824379 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0636575810611248 - actor/pg_clipfrac:0.009062085114419461 - actor/ppo_kl:-0.05096191084594466 - actor/pg_clipfrac_lower:1.9425019854679703e-05 - actor/grad_norm:0.42787645384669304 - perf/mfu/actor:0.21703533027688743 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.26190948486328 - actor/lr:1e-06 - training/global_step:382 - training/epoch:10 - critic/score/mean:-0.17499999701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.17499999701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05782710760831833 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05782710760831833 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1803.824951171875 - response_length/max:2048.0 - response_length/min:125.0 - response_length/clip_ratio:0.846875011920929 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.175 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.894316852092743e-05 - timing_s/generate_sequences:68.7100830078125 - timing_s/reshard:0.7453578114509583 - timing_s/gen:71.23092753626406 - timing_s/reward:0.2278316393494606 - timing_s/old_log_prob:2.402875442057848 - timing_s/ref:2.027945477515459 - timing_s/adv:0.008359288796782494 - timing_s/update_actor:9.28997152671218 - timing_s/step:85.20609979145229 - timing_s/stop_profile:4.622340202331543e-05 - timing_per_token_ms/adv:1.1800088362489033e-05 - timing_per_token_ms/gen:0.1234025742801132 - timing_per_token_ms/ref:0.002862676049450895 - timing_per_token_ms/update_actor:0.01311385305199705 - perf/total_num_tokens:708409 - perf/time_per_step:85.20609979145229 - perf/throughput:1039.2580486225152
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.12187500298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.12187500298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.034252800047397614, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.034252800047397614, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1773.418701171875, 'response_length/max': 2048.0, 'response_length/min': 160.0, 'response_length/clip_ratio': 0.8374999761581421, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.121875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  73%|███████▎  | 383/525 [6:34:04<3:25:01, 86.63s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  73%|███████▎  | 384/525 [6:35:30<3:23:09, 86.45s/it]
[36m(TaskRunner pid=2949575)[0m step:383 - global_seqlen/min:76909 - global_seqlen/max:98375 - global_seqlen/minmax_diff:21466 - global_seqlen/balanced_min:86798 - global_seqlen/balanced_max:87870 - global_seqlen/mean:87334.875 - actor/entropy:0.013547598384320736 - actor/kl_loss:0.3376476600766182 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08258156180381775 - actor/pg_clipfrac:0.00035028685815632345 - actor/ppo_kl:-0.0005225990200415254 - actor/pg_clipfrac_lower:0.00011413709726184606 - actor/grad_norm:0.1685677357017994 - perf/mfu/actor:0.20943128017755086 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.19584655761719 - actor/lr:1e-06 - training/global_step:383 - training/epoch:10 - critic/score/mean:-0.12187500298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.12187500298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.034252800047397614 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.034252800047397614 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1773.418701171875 - response_length/max:2048.0 - response_length/min:160.0 - response_length/clip_ratio:0.8374999761581421 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.121875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011067278683185577 - timing_s/generate_sequences:68.96429443359375 - timing_s/reshard:0.9052756428718567 - timing_s/gen:72.17507373355329 - timing_s/reward:0.22307519800961018 - timing_s/old_log_prob:2.4134242329746485 - timing_s/ref:2.024997813627124 - timing_s/adv:0.007660010829567909 - timing_s/update_actor:9.493290157988667 - timing_s/step:86.35076833888888 - timing_s/stop_profile:4.653632640838623e-05 - timing_per_token_ms/adv:1.0963562422182302e-05 - timing_per_token_ms/gen:0.1271820913235264 - timing_per_token_ms/ref:0.0028983235700903043 - timing_per_token_ms/update_actor:0.013587484607364279 - perf/total_num_tokens:698679 - perf/time_per_step:86.35076833888888 - perf/throughput:1011.3966173091701
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.11874999850988388, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.11874999850988388, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.034536756575107574, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.5652457475662231, 'critic/returns/mean': -0.034536756575107574, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.5652457475662231, 'response_length/mean': 1742.5, 'response_length/max': 2048.0, 'response_length/min': 119.0, 'response_length/clip_ratio': 0.8187500238418579, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.11875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:384 - global_seqlen/min:73292 - global_seqlen/max:98305 - global_seqlen/minmax_diff:25013 - global_seqlen/balanced_min:85407 - global_seqlen/balanced_max:86347 - global_seqlen/mean:86106.875 - actor/entropy:0.018960611894726753 - actor/kl_loss:0.318427824601531 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06949759423732757 - actor/pg_clipfrac:0.0004169753985479474 - actor/ppo_kl:0.0003737096587428823 - actor/pg_clipfrac_lower:5.800463841296732e-05 - actor/grad_norm:4.3985741920769215 - perf/mfu/actor:0.21114341706814313 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.3139419555664 - actor/lr:1e-06 - training/global_step:384 - training/epoch:10 - critic/score/mean:-0.11874999850988388 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.11874999850988388 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.034536756575107574 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.5652457475662231 - critic/returns/mean:-0.034536756575107574 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.5652457475662231 - response_length/mean:1742.5 - response_length/max:2048.0 - response_length/min:119.0 - response_length/clip_ratio:0.8187500238418579 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.11875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.303804159164429e-05 - timing_s/generate_sequences:69.57576751708984 - timing_s/reshard:0.9076264500617981 - timing_s/gen:72.21420279704034 - timing_s/reward:0.2199428677558899 - timing_s/old_log_prob:2.3039827197790146 - timing_s/ref:1.9872114602476358 - timing_s/adv:0.007660688832402229 - timing_s/update_actor:9.279852056875825 - timing_s/step:86.02684657275677 - timing_s/stop_profile:4.561804234981537e-05 - timing_per_token_ms/adv:1.112090183333536e-05 - timing_per_token_ms/gen:0.12950897201764766 - timing_per_token_ms/ref:0.0028848037108646024 - timing_per_token_ms/update_actor:0.013471415692527201 - perf/total_num_tokens:688855 - perf/time_per_step:86.02684657275677 - perf/throughput:1000.9302727047602
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.1796875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.1796875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04866442829370499, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.04866442829370499, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1762.012451171875, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.8374999761581421, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  73%|███████▎  | 385/525 [6:36:57<3:21:42, 86.45s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  74%|███████▎  | 386/525 [6:38:25<3:21:32, 86.99s/it]
[36m(TaskRunner pid=2949575)[0m step:385 - global_seqlen/min:71706 - global_seqlen/max:98375 - global_seqlen/minmax_diff:26669 - global_seqlen/balanced_min:86198 - global_seqlen/balanced_max:87521 - global_seqlen/mean:86869.875 - actor/entropy:0.015461040660738945 - actor/kl_loss:0.3503995582461357 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.032333252020180225 - actor/pg_clipfrac:6.426484178518876e-05 - actor/ppo_kl:0.00023269166704267263 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.34430262073874474 - perf/mfu/actor:0.21275999010543653 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.22338104248047 - actor/lr:1e-06 - training/global_step:385 - training/epoch:10 - critic/score/mean:-0.1796875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.1796875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04866442829370499 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04866442829370499 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:1762.012451171875 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.8374999761581421 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.60113650560379e-05 - timing_s/generate_sequences:69.84437561035156 - timing_s/reshard:0.7964600324630737 - timing_s/gen:72.47275826334953 - timing_s/reward:0.22372732684016228 - timing_s/old_log_prob:2.3270146809518337 - timing_s/ref:1.9968167841434479 - timing_s/adv:0.007620362564921379 - timing_s/update_actor:9.296594547107816 - timing_s/step:86.33870275132358 - timing_s/stop_profile:4.495866596698761e-05 - timing_per_token_ms/adv:1.0965197320879907e-05 - timing_per_token_ms/gen:0.12853335011696415 - timing_per_token_ms/ref:0.0028732871782989325 - timing_per_token_ms/update_actor:0.013377184189438248 - perf/total_num_tokens:694959 - perf/time_per_step:86.33870275132358 - perf/throughput:1006.1521916793946
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.02968749962747097, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.02968749962747097, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09346677362918854, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09346677362918854, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1659.215576171875, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.768750011920929, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.0296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:386 - global_seqlen/min:71618 - global_seqlen/max:93050 - global_seqlen/minmax_diff:21432 - global_seqlen/balanced_min:82067 - global_seqlen/balanced_max:82926 - global_seqlen/mean:82723.0 - actor/entropy:0.02433471754193306 - actor/kl_loss:0.32728818245232105 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10936634223908186 - actor/pg_clipfrac:6.60550722386688e-05 - actor/ppo_kl:-0.00017706193611957132 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:12.242225974798203 - perf/mfu/actor:0.20102300625046263 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.52103042602539 - actor/lr:1e-06 - training/global_step:386 - training/epoch:11 - critic/score/mean:-0.02968749962747097 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.02968749962747097 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09346677362918854 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09346677362918854 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1659.215576171875 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.768750011920929 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.0296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.000314272940158844 - timing_s/generate_sequences:69.57123565673828 - timing_s/reshard:0.961936354637146 - timing_s/gen:71.90137802809477 - timing_s/reward:0.211505014449358 - timing_s/old_log_prob:2.367865474894643 - timing_s/ref:1.9917709920555353 - timing_s/adv:0.007497623562812805 - timing_s/update_actor:9.354150181636214 - timing_s/step:85.85789499431849 - timing_s/stop_profile:4.248693585395813e-05 - timing_per_token_ms/adv:1.132941195739517e-05 - timing_per_token_ms/gen:0.1354204980668478 - timing_per_token_ms/ref:0.0030096995274221426 - timing_per_token_ms/update_actor:0.014134748168037024 - perf/total_num_tokens:661784 - perf/time_per_step:85.85789499431849 - perf/throughput:963.4873997956049
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.15468749403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.15468749403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08015163987874985, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08015163987874985, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1759.487548828125, 'response_length/max': 2048.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.8343750238418579, 'prompt_length/mean': 408.75, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  74%|███████▎  | 387/525 [6:39:51<3:19:43, 86.84s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  74%|███████▍  | 388/525 [6:41:18<3:18:08, 86.78s/it]
[36m(TaskRunner pid=2949575)[0m step:387 - global_seqlen/min:74191 - global_seqlen/max:98340 - global_seqlen/minmax_diff:24149 - global_seqlen/balanced_min:86219 - global_seqlen/balanced_max:87544 - global_seqlen/mean:86729.5 - actor/entropy:0.015690753236413002 - actor/kl_loss:0.3501993402838707 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03505734195932746 - actor/pg_clipfrac:0.00010750010696938261 - actor/ppo_kl:-5.6677816064620853e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:13.282876022160053 - perf/mfu/actor:0.2077134048987841 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.51273345947266 - actor/lr:1e-06 - training/global_step:387 - training/epoch:11 - critic/score/mean:-0.15468749403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.15468749403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08015163987874985 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08015163987874985 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1759.487548828125 - response_length/max:2048.0 - response_length/min:101.0 - response_length/clip_ratio:0.8343750238418579 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.888674736022949e-05 - timing_s/generate_sequences:69.54109191894531 - timing_s/reshard:0.8885471224784851 - timing_s/gen:71.92773599177599 - timing_s/reward:0.22016492672264576 - timing_s/old_log_prob:2.774513805285096 - timing_s/ref:1.999289782717824 - timing_s/adv:0.009152743965387344 - timing_s/update_actor:9.514291480183601 - timing_s/step:86.46449911780655 - timing_s/stop_profile:4.425644874572754e-05 - timing_per_token_ms/adv:1.3191509182843416e-05 - timing_per_token_ms/gen:0.12774979928774713 - timing_per_token_ms/ref:0.002881501943856796 - timing_per_token_ms/update_actor:0.013712594157961826 - perf/total_num_tokens:693836 - perf/time_per_step:86.46449911780655 - perf/throughput:1003.0648518744367
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.13750000298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.13750000298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08763159811496735, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.08763159811496735, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1768.78125, 'response_length/max': 2048.0, 'response_length/min': 123.0, 'response_length/clip_ratio': 0.8374999761581421, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:388 - global_seqlen/min:74650 - global_seqlen/max:96741 - global_seqlen/minmax_diff:22091 - global_seqlen/balanced_min:86583 - global_seqlen/balanced_max:87673 - global_seqlen/mean:87127.5 - actor/entropy:0.014729352667927742 - actor/kl_loss:0.34093606323003767 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04732549395412207 - actor/pg_clipfrac:0.00041706533083925025 - actor/ppo_kl:0.001763311003742274 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:9.149113468825817 - perf/mfu/actor:0.21148598950327077 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.48305892944336 - actor/lr:1e-06 - training/global_step:388 - training/epoch:11 - critic/score/mean:-0.13750000298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.13750000298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08763159811496735 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.08763159811496735 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1768.78125 - response_length/max:2048.0 - response_length/min:123.0 - response_length/clip_ratio:0.8374999761581421 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.84061849117279e-05 - timing_s/generate_sequences:70.08341217041016 - timing_s/reshard:0.8683703541755676 - timing_s/gen:72.56341327168047 - timing_s/reward:0.22127285227179527 - timing_s/old_log_prob:2.4180088732391596 - timing_s/ref:2.0205033626407385 - timing_s/adv:0.007519612088799477 - timing_s/update_actor:9.381119126453996 - timing_s/step:86.62477514334023 - timing_s/stop_profile:4.727952182292938e-05 - timing_per_token_ms/adv:1.0788230020371691e-05 - timing_per_token_ms/gen:0.12820164532725653 - timing_per_token_ms/ref:0.0028987738696748134 - timing_per_token_ms/update_actor:0.013458895191607121 - perf/total_num_tokens:697020 - perf/time_per_step:86.62477514334023 - perf/throughput:1005.8034766131041
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.10468749701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.10468749701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07478813081979752, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07478813081979752, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1739.8843994140625, 'response_length/max': 2048.0, 'response_length/min': 147.0, 'response_length/clip_ratio': 0.8218749761581421, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  74%|███████▍  | 389/525 [6:42:44<3:16:18, 86.60s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:24:00,099:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:24:05,044:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:24:05,046:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:24:00,269:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:24:05,554:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  74%|███████▍  | 390/525 [6:44:20<3:21:16, 89.45s/it]
[36m(TaskRunner pid=2949575)[0m step:389 - global_seqlen/min:74824 - global_seqlen/max:98410 - global_seqlen/minmax_diff:23586 - global_seqlen/balanced_min:84834 - global_seqlen/balanced_max:86151 - global_seqlen/mean:85984.75 - actor/entropy:0.014761214144527912 - actor/kl_loss:0.3398228719830513 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17585097793489696 - actor/pg_clipfrac:0.0004963676838087849 - actor/ppo_kl:0.002967164547590073 - actor/pg_clipfrac_lower:1.220703125e-05 - actor/grad_norm:3.023707466199994 - perf/mfu/actor:0.209554297231832 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.5023078918457 - actor/lr:1e-06 - training/global_step:389 - training/epoch:11 - critic/score/mean:-0.10468749701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.10468749701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07478813081979752 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07478813081979752 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1739.8843994140625 - response_length/max:2048.0 - response_length/min:147.0 - response_length/clip_ratio:0.8218749761581421 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.472613990306854e-05 - timing_s/generate_sequences:69.8214340209961 - timing_s/reshard:0.9551984071731567 - timing_s/gen:71.91278545558453 - timing_s/reward:0.21818189881742 - timing_s/old_log_prob:2.53167437389493 - timing_s/ref:2.024980181828141 - timing_s/adv:0.007490441203117371 - timing_s/update_actor:9.341585224494338 - timing_s/step:86.04964665137231 - timing_s/stop_profile:4.371814429759979e-05 - timing_per_token_ms/adv:1.088920012432055e-05 - timing_per_token_ms/gen:0.12916229249354666 - timing_per_token_ms/ref:0.002943807160322239 - timing_per_token_ms/update_actor:0.013580293634182715 - perf/total_num_tokens:687878 - perf/time_per_step:86.04964665137231 - perf/throughput:999.2458231509626
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.010937499813735485, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.010937499813735485, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08063182234764099, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.08063182234764099, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1646.903076171875, 'response_length/max': 2048.0, 'response_length/min': 75.0, 'response_length/clip_ratio': 0.768750011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.0109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:390 - global_seqlen/min:65982 - global_seqlen/max:98375 - global_seqlen/minmax_diff:32393 - global_seqlen/balanced_min:81491 - global_seqlen/balanced_max:82508 - global_seqlen/mean:82252.375 - actor/entropy:0.02315947785973549 - actor/kl_loss:0.33427972085773944 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11401473190635443 - actor/pg_clipfrac:0.00021437359682749957 - actor/ppo_kl:-0.00025052292021428003 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.051400251686573 - perf/mfu/actor:0.1985981985131138 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.50656509399414 - actor/lr:1e-06 - training/global_step:390 - training/epoch:11 - critic/score/mean:-0.010937499813735485 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.010937499813735485 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08063182234764099 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.08063182234764099 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1646.903076171875 - response_length/max:2048.0 - response_length/min:75.0 - response_length/clip_ratio:0.768750011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.0109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.585304021835327e-05 - timing_s/generate_sequences:69.53373718261719 - timing_s/reshard:0.9564486742019653 - timing_s/gen:71.57576903142035 - timing_s/reward:0.21065315045416355 - timing_s/old_log_prob:2.5137281958013773 - timing_s/ref:1.997102476656437 - timing_s/adv:0.0076178982853889465 - timing_s/update_actor:9.415431752800941 - timing_s/save_checkpoint:10.357615048065782 - timing_s/step:96.09092844091356 - timing_s/stop_profile:5.168654024600983e-05 - timing_per_token_ms/adv:1.1577018726494139e-05 - timing_per_token_ms/gen:0.13581507911899104 - timing_per_token_ms/ref:0.0030350225094661963 - timing_per_token_ms/update_actor:0.014308753626872388 - perf/total_num_tokens:658019 - perf/time_per_step:96.09092844091356 - perf/throughput:855.9848087072767
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.16562500596046448, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.16562500596046448, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0401943139731884, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.0401943139731884, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1762.925048828125, 'response_length/max': 2048.0, 'response_length/min': 129.0, 'response_length/clip_ratio': 0.8374999761581421, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.165625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  74%|███████▍  | 391/525 [6:45:47<3:17:45, 88.55s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:24:06,873:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:24:06,875:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_390/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  75%|███████▍  | 392/525 [6:47:13<3:14:31, 87.75s/it]
[36m(TaskRunner pid=2949575)[0m step:391 - global_seqlen/min:65493 - global_seqlen/max:98305 - global_seqlen/minmax_diff:32812 - global_seqlen/balanced_min:86253 - global_seqlen/balanced_max:87570 - global_seqlen/mean:86910.75 - actor/entropy:0.013363170437514782 - actor/kl_loss:0.34164381921291354 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02217253651469946 - actor/pg_clipfrac:0.0010450188536196947 - actor/ppo_kl:0.007140303794585634 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.5464682001620531 - perf/mfu/actor:0.2128147135340365 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.56330108642578 - actor/lr:1e-06 - training/global_step:391 - training/epoch:11 - critic/score/mean:-0.16562500596046448 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.16562500596046448 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0401943139731884 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0401943139731884 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1762.925048828125 - response_length/max:2048.0 - response_length/min:129.0 - response_length/clip_ratio:0.8374999761581421 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.165625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.401593029499054e-05 - timing_s/generate_sequences:69.8082275390625 - timing_s/reshard:0.9859497547149658 - timing_s/gen:72.4727765917778 - timing_s/reward:0.2230126839131117 - timing_s/old_log_prob:2.383194051682949 - timing_s/ref:2.0314760003238916 - timing_s/adv:0.007525796070694923 - timing_s/update_actor:9.29829028993845 - timing_s/step:86.42923044227064 - timing_s/stop_profile:4.336237907409668e-05 - timing_per_token_ms/adv:1.0824029350073097e-05 - timing_per_token_ms/gen:0.12846685301377292 - timing_per_token_ms/ref:0.0029217847048896304 - timing_per_token_ms/update_actor:0.013373331679249187 - perf/total_num_tokens:695286 - perf/time_per_step:86.42923044227064 - perf/throughput:1005.5712581873674
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.140625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.140625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05166396126151085, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.05166396126151085, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1722.793701171875, 'response_length/max': 2048.0, 'response_length/min': 105.0, 'response_length/clip_ratio': 0.815625011920929, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.140625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:392 - global_seqlen/min:77143 - global_seqlen/max:88942 - global_seqlen/minmax_diff:11799 - global_seqlen/balanced_min:84584 - global_seqlen/balanced_max:85728 - global_seqlen/mean:85296.75 - actor/entropy:0.01652846485376358 - actor/kl_loss:0.35021494030952455 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.021946391835808755 - actor/pg_clipfrac:0.000217093997343909 - actor/ppo_kl:0.000570175801840378 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.403724517673254 - perf/mfu/actor:0.2074615385906402 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.48398971557617 - actor/lr:1e-06 - training/global_step:392 - training/epoch:11 - critic/score/mean:-0.140625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.140625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05166396126151085 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.05166396126151085 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1722.793701171875 - response_length/max:2048.0 - response_length/min:105.0 - response_length/clip_ratio:0.815625011920929 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.140625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.577240467071533e-05 - timing_s/generate_sequences:69.52941131591797 - timing_s/reshard:0.950364887714386 - timing_s/gen:71.84158877469599 - timing_s/reward:0.2188908401876688 - timing_s/old_log_prob:2.414519617334008 - timing_s/ref:2.0196367278695107 - timing_s/adv:0.007570547983050346 - timing_s/update_actor:9.356753831729293 - timing_s/step:85.8720069359988 - timing_s/stop_profile:4.388205707073212e-05 - timing_per_token_ms/adv:1.1094426198903163e-05 - timing_per_token_ms/gen:0.13031447607754845 - timing_per_token_ms/ref:0.002959721102898866 - timing_per_token_ms/update_actor:0.013712060881172631 - perf/total_num_tokens:682374 - perf/time_per_step:85.8720069359988 - perf/throughput:993.300995789844
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04328735172748566, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.04328735172748566, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1898.8687744140625, 'response_length/max': 2048.0, 'response_length/min': 126.0, 'response_length/clip_ratio': 0.9125000238418579, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  75%|███████▍  | 393/525 [6:48:38<3:11:47, 87.18s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  75%|███████▌  | 394/525 [6:50:06<3:10:23, 87.21s/it]
[36m(TaskRunner pid=2949575)[0m step:393 - global_seqlen/min:82714 - global_seqlen/max:98340 - global_seqlen/minmax_diff:15626 - global_seqlen/balanced_min:91699 - global_seqlen/balanced_max:93006 - global_seqlen/mean:92348.5 - actor/entropy:0.006644402164965868 - actor/kl_loss:0.3498640894889832 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11016811206936836 - actor/pg_clipfrac:0.00013094979367451743 - actor/ppo_kl:-0.000368634215919883 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.5910350270569324 - perf/mfu/actor:0.22296764067490302 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.65992736816406 - actor/lr:1e-06 - training/global_step:393 - training/epoch:11 - critic/score/mean:-0.3125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04328735172748566 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.04328735172748566 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1898.8687744140625 - response_length/max:2048.0 - response_length/min:126.0 - response_length/clip_ratio:0.9125000238418579 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.621757686138153e-05 - timing_s/generate_sequences:69.801513671875 - timing_s/reshard:0.8891094326972961 - timing_s/gen:71.68852750398219 - timing_s/reward:0.23549920320510864 - timing_s/old_log_prob:2.366228951141238 - timing_s/ref:2.061337562277913 - timing_s/adv:0.0075439102947711945 - timing_s/update_actor:9.44611886702478 - timing_s/step:85.81819412857294 - timing_s/stop_profile:4.437007009983063e-05 - timing_per_token_ms/adv:1.0211197657205037e-05 - timing_per_token_ms/gen:0.11797900642155722 - timing_per_token_ms/ref:0.0027901611318509683 - timing_per_token_ms/update_actor:0.012785966836257193 - perf/total_num_tokens:738788 - perf/time_per_step:85.81819412857294 - perf/throughput:1076.0946549591029
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2593750059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2593750059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03272377699613571, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.03272377699613571, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1860.3812255859375, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.893750011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.259375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:394 - global_seqlen/min:82551 - global_seqlen/max:98340 - global_seqlen/minmax_diff:15789 - global_seqlen/balanced_min:89781 - global_seqlen/balanced_max:91132 - global_seqlen/mean:90791.5 - actor/entropy:0.009440473280847073 - actor/kl_loss:0.3485002383589745 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06330848596990109 - actor/pg_clipfrac:0.00012857947149313986 - actor/ppo_kl:-0.010160833105328494 - actor/pg_clipfrac_lower:0.001011804398149252 - actor/grad_norm:0.47246255073696375 - perf/mfu/actor:0.2200076046832587 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.76922988891602 - actor/lr:1e-06 - training/global_step:394 - training/epoch:11 - critic/score/mean:-0.2593750059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2593750059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03272377699613571 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.03272377699613571 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1860.3812255859375 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.893750011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.259375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.660368621349335e-05 - timing_s/generate_sequences:69.98542785644531 - timing_s/reshard:0.8916905522346497 - timing_s/gen:72.50574131682515 - timing_s/reward:0.23028159886598587 - timing_s/old_log_prob:2.506954049691558 - timing_s/ref:2.037762613967061 - timing_s/adv:0.007597588002681732 - timing_s/update_actor:9.410581583157182 - timing_s/step:86.71201747097075 - timing_s/stop_profile:4.626438021659851e-05 - timing_per_token_ms/adv:1.0460213790225039e-05 - timing_per_token_ms/gen:0.12179247754463156 - timing_per_token_ms/ref:0.002805552576462363 - timing_per_token_ms/update_actor:0.012956308662095545 - perf/total_num_tokens:726332 - perf/time_per_step:86.71201747097075 - perf/throughput:1047.0463339224575
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.34375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.34375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03373754397034645, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.03373754397034645, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1899.9124755859375, 'response_length/max': 2048.0, 'response_length/min': 96.0, 'response_length/clip_ratio': 0.9156249761581421, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.34375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  75%|███████▌  | 395/525 [6:51:33<3:08:50, 87.16s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  75%|███████▌  | 396/525 [6:53:00<3:07:10, 87.06s/it]
[36m(TaskRunner pid=2949575)[0m step:395 - global_seqlen/min:82561 - global_seqlen/max:98410 - global_seqlen/minmax_diff:15849 - global_seqlen/balanced_min:91520 - global_seqlen/balanced_max:92892 - global_seqlen/mean:92381.5 - actor/entropy:0.006383057683706284 - actor/kl_loss:0.3535132423043251 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03397053368389606 - actor/pg_clipfrac:0.00015277489874279126 - actor/ppo_kl:-0.0001320832991041243 - actor/pg_clipfrac_lower:2.0064205455128103e-05 - actor/grad_norm:1.030694818124175 - perf/mfu/actor:0.21821133341789273 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.65633773803711 - actor/lr:1e-06 - training/global_step:395 - training/epoch:11 - critic/score/mean:-0.34375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.34375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03373754397034645 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03373754397034645 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1899.9124755859375 - response_length/max:2048.0 - response_length/min:96.0 - response_length/clip_ratio:0.9156249761581421 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.34375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.522664964199066e-05 - timing_s/generate_sequences:70.32438659667969 - timing_s/reshard:0.7738999128341675 - timing_s/gen:72.68031308427453 - timing_s/reward:0.23474350199103355 - timing_s/old_log_prob:2.3719159066677094 - timing_s/ref:2.0566754583269358 - timing_s/adv:0.007529444992542267 - timing_s/update_actor:9.659851079806685 - timing_s/step:87.03127101622522 - timing_s/stop_profile:4.24850732088089e-05 - timing_per_token_ms/adv:1.0187977290559077e-05 - timing_per_token_ms/gen:0.11954549401004409 - timing_per_token_ms/ref:0.002782856224361663 - timing_per_token_ms/update_actor:0.01307059730547605 - perf/total_num_tokens:739052 - perf/time_per_step:87.03127101622522 - perf/throughput:1061.4747885593597
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3031249940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3031249940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03807743266224861, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.03807743266224861, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1868.153076171875, 'response_length/max': 2048.0, 'response_length/min': 139.0, 'response_length/clip_ratio': 0.893750011920929, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.303125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:396 - global_seqlen/min:80563 - global_seqlen/max:96474 - global_seqlen/minmax_diff:15911 - global_seqlen/balanced_min:90440 - global_seqlen/balanced_max:91371 - global_seqlen/mean:91089.25 - actor/entropy:0.007967767305672169 - actor/kl_loss:0.3443929836153984 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05706426613032818 - actor/pg_clipfrac:8.39499945868738e-05 - actor/ppo_kl:-0.00036723271332448346 - actor/pg_clipfrac_lower:4.8828125e-05 - actor/grad_norm:6.219529654830694 - perf/mfu/actor:0.22251448464914922 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.64894485473633 - actor/lr:1e-06 - training/global_step:396 - training/epoch:11 - critic/score/mean:-0.3031249940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3031249940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03807743266224861 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03807743266224861 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:1868.153076171875 - response_length/max:2048.0 - response_length/min:139.0 - response_length/clip_ratio:0.893750011920929 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.303125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.602386176586151e-05 - timing_s/generate_sequences:70.71958923339844 - timing_s/reshard:0.9438100457191467 - timing_s/gen:72.8213160354644 - timing_s/reward:0.23066058941185474 - timing_s/old_log_prob:2.3849271181970835 - timing_s/ref:2.0329788234084845 - timing_s/adv:0.0075505804270505905 - timing_s/update_actor:9.33198131248355 - timing_s/step:86.82247112691402 - timing_s/stop_profile:4.480406641960144e-05 - timing_per_token_ms/adv:1.036151415651489e-05 - timing_per_token_ms/gen:0.12181368302495346 - timing_per_token_ms/ref:0.0027898171620258216 - timing_per_token_ms/update_actor:0.012806095824265142 - perf/total_num_tokens:728714 - perf/time_per_step:86.82247112691402 - perf/throughput:1049.1437161106478
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.18281249701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.18281249701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05399170145392418, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05399170145392418, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1751.7750244140625, 'response_length/max': 2048.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.831250011920929, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  76%|███████▌  | 397/525 [6:54:26<3:05:31, 86.96s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  76%|███████▌  | 398/525 [6:55:52<3:03:29, 86.69s/it]
[36m(TaskRunner pid=2949575)[0m step:397 - global_seqlen/min:75376 - global_seqlen/max:98375 - global_seqlen/minmax_diff:22999 - global_seqlen/balanced_min:86091 - global_seqlen/balanced_max:87485 - global_seqlen/mean:86464.75 - actor/entropy:0.018422260880470276 - actor/kl_loss:0.3532164111733437 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1857905044220388 - actor/pg_clipfrac:0.0004407139931572601 - actor/ppo_kl:-0.015640060391615408 - actor/pg_clipfrac_lower:0.0012367491610348225 - actor/grad_norm:12.565924987196922 - perf/mfu/actor:0.21046431445062552 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.61861801147461 - actor/lr:1e-06 - training/global_step:397 - training/epoch:11 - critic/score/mean:-0.18281249701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.18281249701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05399170145392418 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05399170145392418 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1751.7750244140625 - response_length/max:2048.0 - response_length/min:91.0 - response_length/clip_ratio:0.831250011920929 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.028986096382141e-05 - timing_s/generate_sequences:70.03382873535156 - timing_s/reshard:0.9051305055618286 - timing_s/gen:72.50076236389577 - timing_s/reward:0.2189465630799532 - timing_s/old_log_prob:2.3921643272042274 - timing_s/ref:2.0282700937241316 - timing_s/adv:0.009657543152570724 - timing_s/update_actor:9.355280814692378 - timing_s/step:86.5183224901557 - timing_s/stop_profile:4.4601038098335266e-05 - timing_per_token_ms/adv:1.3961676799751814e-05 - timing_per_token_ms/gen:0.12933446497819315 - timing_per_token_ms/ref:0.0029322210694591316 - timing_per_token_ms/update_actor:0.013524703440842046 - perf/total_num_tokens:691718 - perf/time_per_step:86.5183224901557 - perf/throughput:999.3807960139103
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.13593749701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.13593749701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05873487517237663, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.05873487517237663, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1760.768798828125, 'response_length/max': 2048.0, 'response_length/min': 126.0, 'response_length/clip_ratio': 0.8343750238418579, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:398 - global_seqlen/min:75625 - global_seqlen/max:98305 - global_seqlen/minmax_diff:22680 - global_seqlen/balanced_min:86287 - global_seqlen/balanced_max:87667 - global_seqlen/mean:86807.0 - actor/entropy:0.01508454978466034 - actor/kl_loss:0.3445154830813408 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06200578473508358 - actor/pg_clipfrac:0.00014808277774136513 - actor/ppo_kl:-0.0020332338455773423 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.5808575227856636 - perf/mfu/actor:0.21236009867134592 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.5772705078125 - actor/lr:1e-06 - training/global_step:398 - training/epoch:11 - critic/score/mean:-0.13593749701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.13593749701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05873487517237663 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.05873487517237663 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1760.768798828125 - response_length/max:2048.0 - response_length/min:126.0 - response_length/clip_ratio:0.8343750238418579 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.703155279159546e-05 - timing_s/generate_sequences:69.76797485351562 - timing_s/reshard:0.8856931924819946 - timing_s/gen:72.10161041468382 - timing_s/reward:0.22262751124799252 - timing_s/old_log_prob:2.3770457971841097 - timing_s/ref:2.0150066781789064 - timing_s/adv:0.007513724267482758 - timing_s/update_actor:9.311249043792486 - timing_s/step:86.04807143844664 - timing_s/stop_profile:4.7694891691207886e-05 - timing_per_token_ms/adv:1.0819582907315594e-05 - timing_per_token_ms/gen:0.12796543131850047 - timing_per_token_ms/ref:0.0029015613345970176 - timing_per_token_ms/update_actor:0.013407975514348622 - perf/total_num_tokens:694456 - perf/time_per_step:86.04807143844664 - perf/throughput:1008.819820698669
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.21562500298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.21562500298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04964547976851463, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.5652457475662231, 'critic/returns/mean': -0.04964547976851463, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.5652457475662231, 'response_length/mean': 1793.15625, 'response_length/max': 2048.0, 'response_length/min': 143.0, 'response_length/clip_ratio': 0.8531249761581421, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.215625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  76%|███████▌  | 399/525 [6:57:19<3:01:43, 86.53s/it]
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 06:39:43,668:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 06:39:48,334:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 06:39:48,339:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:39:44,199:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:39:49,259:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/huggingface
[36m(TaskRunner pid=2949575)[0m step:399 - global_seqlen/min:71626 - global_seqlen/max:97071 - global_seqlen/minmax_diff:25445 - global_seqlen/balanced_min:87895 - global_seqlen/balanced_max:89271 - global_seqlen/mean:88115.625 - actor/entropy:0.012857476249337196 - actor/kl_loss:0.34434990361332896 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03254679329693318 - actor/pg_clipfrac:0.00010692899813875556 - actor/ppo_kl:0.0001444467901819735 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5462268441915512 - perf/mfu/actor:0.21517058090698127 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.53849411010742 - actor/lr:1e-06 - training/global_step:399 - training/epoch:11 - critic/score/mean:-0.21562500298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.21562500298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04964547976851463 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.5652457475662231 - critic/returns/mean:-0.04964547976851463 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.5652457475662231 - response_length/mean:1793.15625 - response_length/max:2048.0 - response_length/min:143.0 - response_length/clip_ratio:0.8531249761581421 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.215625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.731467485427856e-05 - timing_s/generate_sequences:70.34844970703125 - timing_s/reshard:0.8981555104255676 - timing_s/gen:72.18823032081127 - timing_s/reward:0.22304202429950237 - timing_s/old_log_prob:2.3664505761116743 - timing_s/ref:2.027318798005581 - timing_s/adv:0.007526561617851257 - timing_s/update_actor:9.327596809715033 - timing_s/step:86.15331881307065 - timing_s/stop_profile:4.306808114051819e-05 - timing_per_token_ms/adv:1.067710978877364e-05 - timing_per_token_ms/gen:0.12580511026439287 - timing_per_token_ms/ref:0.0028759354512970614 - timing_per_token_ms/update_actor:0.013232041436628057 - perf/total_num_tokens:704925 - perf/time_per_step:86.15331881307065 - perf/throughput:1022.7769076567673
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 400}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, the standard form of the equation of the hyperbola is:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \frac{x^2}{a^2} - \frac{y^2}{b^2} = 1
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m For an equilateral hyperbola, \(a = b\), so the equation simplifies to:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x^2 - y^2 = a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The foci of the hyperbola are at \((\pm c, 0)\) where \(c = \sqrt{a^2 + b^2} = \sqrt{2a^2} = a\sqrt{2}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The given parabola is \(y^2 = 16x\). The standard form of a parabola \(y^2 = 4px\) has its focus at \((p, 0)\). Here, \(4p = 16\), so \(p = 4\). Therefore, the focus of the parabola is at \((4, 0)\) and the directrix is the line \(x = -4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The hyperbola intersects the parabola at points \(A\) and \(B\), and the distance \(|AB| = 4\sqrt{3}\). The distance from the focus of the parabola to the directrix is 4, so the distance from the focus of the hyperbola to the directrix is also 4. This means the distance from the center of the hyperbola to the directrix is \(a\sqrt{2} - 4 = 4\), so:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m a\sqrt{2} = 8 \implies a = \frac{8}{\sqrt{2}} = 4\sqrt{2}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The real axis length of the hyperbola is \(2a = 2 \times 4\sqrt{2} = 8\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Therefore, the real axis length of the hyperbola is 8.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The answer is \(8\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m </think>
[36m(TaskRunner pid=2949575)[0m <answer>The answer is \boxed{D}.</answer>
[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] 1.0
[36m(TaskRunner pid=2949575)[0m [structure] 0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.5
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.10625000298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.10625000298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05810908228158951, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05810908228158951, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1717.4281005859375, 'response_length/max': 2048.0, 'response_length/min': 130.0, 'response_length/clip_ratio': 0.8031250238418579, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.10625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:400 - global_seqlen/min:71886 - global_seqlen/max:93341 - global_seqlen/minmax_diff:21455 - global_seqlen/balanced_min:84909 - global_seqlen/balanced_max:86104 - global_seqlen/mean:85060.25 - actor/entropy:0.01715552620589733 - actor/kl_loss:0.3323344748467207 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03678721906617284 - actor/pg_clipfrac:0.000311549793696031 - actor/ppo_kl:-0.0029612232217914427 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:13.95513018220663 - perf/mfu/actor:0.20644507764521633 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.50461196899414 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:0.33999999999999997 - val-aux/grpo_convert/reward/std@50:0.4737087712930805 - val-aux/grpo_convert/reward/best@2/mean:0.6055 - val-aux/grpo_convert/reward/best@2/std:0.29175289201651455 - val-aux/grpo_convert/reward/worst@2/mean:0.11275000000000002 - val-aux/grpo_convert/reward/worst@2/std:0.4896171335850084 - val-aux/grpo_convert/reward/best@4/mean:0.7095 - val-aux/grpo_convert/reward/best@4/std:0.14312494541483678 - val-aux/grpo_convert/reward/worst@4/mean:-0.14250000000000002 - val-aux/grpo_convert/reward/worst@4/std:0.42242602902756826 - val-aux/grpo_convert/reward/best@8/mean:0.746 - val-aux/grpo_convert/reward/best@8/std:0.044542114902640165 - val-aux/grpo_convert/reward/worst@8/mean:-0.3555 - val-aux/grpo_convert/reward/worst@8/std:0.29684970944907463 - val-aux/grpo_convert/reward/best@16/mean:0.75 - val-aux/grpo_convert/reward/best@16/std:0.0 - val-aux/grpo_convert/reward/worst@16/mean:-0.47975 - val-aux/grpo_convert/reward/worst@16/std:0.12156248393316087 - val-aux/grpo_convert/reward/best@32/mean:0.75 - val-aux/grpo_convert/reward/best@32/std:0.0 - val-aux/grpo_convert/reward/worst@32/mean:-0.49924999999999997 - val-aux/grpo_convert/reward/worst@32/std:0.02370522094391866 - val-aux/grpo_convert/reward/best@50/mean:0.75 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:0.33999999999999997 - val-aux/grpo_convert/score/std@50:0.4737087712930805 - val-aux/grpo_convert/score/best@2/mean:0.6055 - val-aux/grpo_convert/score/best@2/std:0.29175289201651455 - val-aux/grpo_convert/score/worst@2/mean:0.11275000000000002 - val-aux/grpo_convert/score/worst@2/std:0.4896171335850084 - val-aux/grpo_convert/score/best@4/mean:0.7095 - val-aux/grpo_convert/score/best@4/std:0.14312494541483678 - val-aux/grpo_convert/score/worst@4/mean:-0.14250000000000002 - val-aux/grpo_convert/score/worst@4/std:0.42242602902756826 - val-aux/grpo_convert/score/best@8/mean:0.746 - val-aux/grpo_convert/score/best@8/std:0.044542114902640165 - val-aux/grpo_convert/score/worst@8/mean:-0.3555 - val-aux/grpo_convert/score/worst@8/std:0.29684970944907463 - val-aux/grpo_convert/score/best@16/mean:0.75 - val-aux/grpo_convert/score/best@16/std:0.0 - val-aux/grpo_convert/score/worst@16/mean:-0.47975 - val-aux/grpo_convert/score/worst@16/std:0.12156248393316087 - val-aux/grpo_convert/score/best@32/mean:0.75 - val-aux/grpo_convert/score/best@32/std:0.0 - val-aux/grpo_convert/score/worst@32/mean:-0.49924999999999997 - val-aux/grpo_convert/score/worst@32/std:0.02370522094391866 - val-aux/grpo_convert/score/best@50/mean:0.75 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:-0.1 - val-aux/grpo_convert/structure/std@50:0.2 - val-aux/grpo_convert/structure/best@2/mean:-0.017999999999999988 - val-aux/grpo_convert/structure/best@2/std:0.09314504817756011 - val-aux/grpo_convert/structure/worst@2/mean:-0.1745 - val-aux/grpo_convert/structure/worst@2/std:0.23832698126733365 - val-aux/grpo_convert/structure/best@4/mean:-0.0010000000000000009 - val-aux/grpo_convert/structure/best@4/std:0.022338307903688678 - val-aux/grpo_convert/structure/worst@4/mean:-0.28200000000000003 - val-aux/grpo_convert/structure/worst@4/std:0.24794354196066495 - val-aux/grpo_convert/structure/best@8/mean:0.0 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.404 - val-aux/grpo_convert/structure/worst@8/std:0.19693653800145874 - val-aux/grpo_convert/structure/best@16/mean:0.0 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.4865 - val-aux/grpo_convert/structure/worst@16/std:0.08104165595544058 - val-aux/grpo_convert/structure/best@32/mean:0.0 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.4995 - val-aux/grpo_convert/structure/worst@32/std:0.015803480629279106 - val-aux/grpo_convert/structure/best@50/mean:0.0 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.2 - val-aux/grpo_convert/boxed/std@50:0.1 - val-aux/grpo_convert/boxed/best@2/mean:0.241 - val-aux/grpo_convert/boxed/best@2/std:0.046572524088780064 - val-aux/grpo_convert/boxed/worst@2/mean:0.16275 - val-aux/grpo_convert/boxed/worst@2/std:0.11916349063366682 - val-aux/grpo_convert/boxed/best@4/mean:0.2495 - val-aux/grpo_convert/boxed/best@4/std:0.011169153951844339 - val-aux/grpo_convert/boxed/worst@4/mean:0.109 - val-aux/grpo_convert/boxed/worst@4/std:0.12397177098033248 - val-aux/grpo_convert/boxed/best@8/mean:0.25 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.048 - val-aux/grpo_convert/boxed/worst@8/std:0.09846826900072937 - val-aux/grpo_convert/boxed/best@16/mean:0.25 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.00675 - val-aux/grpo_convert/boxed/worst@16/std:0.04052082797772029 - val-aux/grpo_convert/boxed/best@32/mean:0.25 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.00025 - val-aux/grpo_convert/boxed/worst@32/std:0.007901740314639553 - val-aux/grpo_convert/boxed/best@50/mean:0.25 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.24 - val-aux/grpo_convert/correct/std@50:0.24979991993593592 - val-aux/grpo_convert/correct/best@2/mean:0.3825 - val-aux/grpo_convert/correct/best@2/std:0.21199941037653858 - val-aux/grpo_convert/correct/worst@2/mean:0.1245 - val-aux/grpo_convert/correct/worst@2/std:0.21621690498201104 - val-aux/grpo_convert/correct/best@4/mean:0.461 - val-aux/grpo_convert/correct/best@4/std:0.13408579343092242 - val-aux/grpo_convert/correct/worst@4/mean:0.0305 - val-aux/grpo_convert/correct/worst@4/std:0.11966515783635603 - val-aux/grpo_convert/correct/best@8/mean:0.496 - val-aux/grpo_convert/correct/best@8/std:0.044542114902640165 - val-aux/grpo_convert/correct/worst@8/mean:0.0005 - val-aux/grpo_convert/correct/worst@8/std:0.01580348062927911 - val-aux/grpo_convert/correct/best@16/mean:0.5 - val-aux/grpo_convert/correct/best@16/std:0.0 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.5 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.5 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.24 - val-aux/grpo_convert/acc/std@50:0.24979991993593592 - val-aux/grpo_convert/acc/best@2/mean:0.3825 - val-aux/grpo_convert/acc/best@2/std:0.21199941037653858 - val-aux/grpo_convert/acc/worst@2/mean:0.1245 - val-aux/grpo_convert/acc/worst@2/std:0.21621690498201104 - val-aux/grpo_convert/acc/best@4/mean:0.461 - val-aux/grpo_convert/acc/best@4/std:0.13408579343092242 - val-aux/grpo_convert/acc/worst@4/mean:0.0305 - val-aux/grpo_convert/acc/worst@4/std:0.11966515783635603 - val-aux/grpo_convert/acc/best@8/mean:0.496 - val-aux/grpo_convert/acc/best@8/std:0.044542114902640165 - val-aux/grpo_convert/acc/worst@8/mean:0.0005 - val-aux/grpo_convert/acc/worst@8/std:0.01580348062927911 - val-aux/grpo_convert/acc/best@16/mean:0.5 - val-aux/grpo_convert/acc/best@16/std:0.0 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.5 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.5 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:400 - training/epoch:11 - critic/score/mean:-0.10625000298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.10625000298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05810908228158951 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05810908228158951 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1717.4281005859375 - response_length/max:2048.0 - response_length/min:130.0 - response_length/clip_ratio:0.8031250238418579 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.10625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.31293112039566e-05 - timing_s/generate_sequences:69.96601104736328 - timing_s/reshard:0.7761715650558472 - timing_s/gen:72.18957022950053 - timing_s/reward:0.2179957963526249 - timing_s/old_log_prob:2.3653787411749363 - timing_s/ref:2.0146989692002535 - timing_s/adv:0.007481427863240242 - timing_s/update_actor:9.370295699685812 - timing_s/testing:68.84717920608819 - timing_s/save_checkpoint:10.846501907333732 - timing_s/step:165.87240942008793 - timing_s/stop_profile:5.415081977844238e-05 - timing_per_token_ms/adv:1.0994306775550628e-05 - timing_per_token_ms/gen:0.1313547878268205 - timing_per_token_ms/ref:0.002960693992200019 - timing_per_token_ms/update_actor:0.013770086056186367 - perf/total_num_tokens:680482 - perf/time_per_step:165.87240942008793 - perf/throughput:512.8052959342785[36m(TaskRunner pid=2949575)[0m Training Progress:  76%|███████▌  | 400/525 [7:00:04<3:49:52, 110.34s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  76%|███████▋  | 401/525 [7:01:30<3:32:53, 103.02s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:39:51,039:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:39:51,042:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_400/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  77%|███████▋  | 402/525 [7:02:56<3:20:47, 97.94s/it] 

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.1015625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.1015625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.055855970829725266, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.055855970829725266, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1702.4906005859375, 'response_length/max': 2048.0, 'response_length/min': 93.0, 'response_length/clip_ratio': 0.8031250238418579, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1015625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:401 - global_seqlen/min:71517 - global_seqlen/max:98410 - global_seqlen/minmax_diff:26893 - global_seqlen/balanced_min:84320 - global_seqlen/balanced_max:85647 - global_seqlen/mean:84489.0 - actor/entropy:0.019084621220827103 - actor/kl_loss:0.3430346377193928 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07142639309167861 - actor/pg_clipfrac:0.00028528627590276303 - actor/ppo_kl:0.00046334719518199564 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.5111512690782547 - perf/mfu/actor:0.2053920708562901 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.51016616821289 - actor/lr:1e-06 - training/global_step:401 - training/epoch:11 - critic/score/mean:-0.1015625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.1015625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.055855970829725266 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.055855970829725266 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1702.4906005859375 - response_length/max:2048.0 - response_length/min:93.0 - response_length/clip_ratio:0.8031250238418579 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1015625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.598847150802612e-05 - timing_s/generate_sequences:69.36479949951172 - timing_s/reshard:0.6060929894447327 - timing_s/gen:71.52743959054351 - timing_s/reward:0.2178801503032446 - timing_s/old_log_prob:2.778878726065159 - timing_s/ref:1.9990776274353266 - timing_s/adv:0.008023394271731377 - timing_s/update_actor:9.358147917315364 - timing_s/step:85.90607281215489 - timing_s/stop_profile:4.193931818008423e-05 - timing_per_token_ms/adv:1.1870471705978555e-05 - timing_per_token_ms/gen:0.13129191164882242 - timing_per_token_ms/ref:0.002957600438274992 - timing_per_token_ms/update_actor:0.01384521641473352 - perf/total_num_tokens:675912 - perf/time_per_step:85.90607281215489 - perf/throughput:983.5043930450237
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.23593750596046448, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.23593750596046448, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03612801060080528, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.03612801060080528, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1829.168701171875, 'response_length/max': 2048.0, 'response_length/min': 109.0, 'response_length/clip_ratio': 0.871874988079071, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:402 - global_seqlen/min:79839 - global_seqlen/max:98375 - global_seqlen/minmax_diff:18536 - global_seqlen/balanced_min:88628 - global_seqlen/balanced_max:89715 - global_seqlen/mean:89573.625 - actor/entropy:0.012653163634240627 - actor/kl_loss:0.3392683994024992 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05181504264473915 - actor/pg_clipfrac:0.00019793471437878907 - actor/ppo_kl:0.00033067543554352594 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.4150233455002308 - perf/mfu/actor:0.21900368207078438 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.67082214355469 - actor/lr:1e-06 - training/global_step:402 - training/epoch:11 - critic/score/mean:-0.23593750596046448 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.23593750596046448 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03612801060080528 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03612801060080528 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1829.168701171875 - response_length/max:2048.0 - response_length/min:109.0 - response_length/clip_ratio:0.871874988079071 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.087659418582916e-05 - timing_s/generate_sequences:69.5846939086914 - timing_s/reshard:0.9008058309555054 - timing_s/gen:71.60353846289217 - timing_s/reward:0.2283851746469736 - timing_s/old_log_prob:2.336358265951276 - timing_s/ref:2.011033834889531 - timing_s/adv:0.007438695058226585 - timing_s/update_actor:9.322285197675228 - timing_s/step:85.52858997322619 - timing_s/stop_profile:4.3997541069984436e-05 - timing_per_token_ms/adv:1.0380699477980524e-05 - timing_per_token_ms/gen:0.1223293682972323 - timing_per_token_ms/ref:0.0028063978583114327 - timing_per_token_ms/update_actor:0.013009249650322888 - perf/total_num_tokens:716589 - perf/time_per_step:85.52858997322619 - perf/throughput:1047.294536575899
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  77%|███████▋  | 403/525 [7:04:23<3:12:18, 94.58s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  77%|███████▋  | 404/525 [7:05:50<3:05:54, 92.19s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2640624940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2640624940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03285294771194458, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.03285294771194458, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1847.8843994140625, 'response_length/max': 2048.0, 'response_length/min': 107.0, 'response_length/clip_ratio': 0.8812500238418579, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:403 - global_seqlen/min:82127 - global_seqlen/max:96886 - global_seqlen/minmax_diff:14759 - global_seqlen/balanced_min:89969 - global_seqlen/balanced_max:91196 - global_seqlen/mean:90291.625 - actor/entropy:0.010070528835058212 - actor/kl_loss:0.35065236389636995 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.006063250638544559 - actor/pg_clipfrac:2.025931898970157e-05 - actor/ppo_kl:6.383175787050277e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.30572034418582916 - perf/mfu/actor:0.21449603259613176 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.5980224609375 - actor/lr:1e-06 - training/global_step:403 - training/epoch:11 - critic/score/mean:-0.2640624940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2640624940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03285294771194458 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.03285294771194458 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1847.8843994140625 - response_length/max:2048.0 - response_length/min:107.0 - response_length/clip_ratio:0.8812500238418579 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.949132800102234e-05 - timing_s/generate_sequences:69.86756134033203 - timing_s/reshard:0.8801854252815247 - timing_s/gen:72.43912729620934 - timing_s/reward:0.2296043001115322 - timing_s/old_log_prob:2.379465166479349 - timing_s/ref:2.0323840007185936 - timing_s/adv:0.009609654545783997 - timing_s/update_actor:9.60211363248527 - timing_s/step:86.711859498173 - timing_s/stop_profile:4.4951215386390686e-05 - timing_per_token_ms/adv:1.3303634952001358e-05 - timing_per_token_ms/gen:0.12250348336900363 - timing_per_token_ms/ref:0.0028136385859687894 - timing_per_token_ms/update_actor:0.013293195288717629 - perf/total_num_tokens:722333 - perf/time_per_step:86.711859498173 - perf/throughput:1041.2834590625107
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2796874940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2796874940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04719200357794762, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.04719200357794762, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1864.296875, 'response_length/max': 2048.0, 'response_length/min': 111.0, 'response_length/clip_ratio': 0.893750011920929, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:404 - global_seqlen/min:85811 - global_seqlen/max:98305 - global_seqlen/minmax_diff:12494 - global_seqlen/balanced_min:89978 - global_seqlen/balanced_max:91265 - global_seqlen/mean:90939.375 - actor/entropy:0.009889375418424606 - actor/kl_loss:0.3507029816508293 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03162649665027857 - actor/pg_clipfrac:4.161917313467711e-05 - actor/ppo_kl:1.8434036610415207e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.166445361915976 - perf/mfu/actor:0.2189876968549109 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.55094146728516 - actor/lr:1e-06 - training/global_step:404 - training/epoch:11 - critic/score/mean:-0.2796874940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2796874940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04719200357794762 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04719200357794762 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1864.296875 - response_length/max:2048.0 - response_length/min:111.0 - response_length/clip_ratio:0.893750011920929 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.811561226844788e-05 - timing_s/generate_sequences:69.9837417602539 - timing_s/reshard:0.9183787107467651 - timing_s/gen:72.46183304488659 - timing_s/reward:0.23121441528201103 - timing_s/old_log_prob:2.3639957681298256 - timing_s/ref:2.0402779318392277 - timing_s/adv:0.009925412014126778 - timing_s/update_actor:9.473340764641762 - timing_s/step:86.59365350753069 - timing_s/stop_profile:4.574097692966461e-05 - timing_per_token_ms/adv:1.364289672945132e-05 - timing_per_token_ms/gen:0.1214630734524353 - timing_per_token_ms/ref:0.0028044479245640675 - timing_per_token_ms/update_actor:0.013021505762275365 - perf/total_num_tokens:727515 - perf/time_per_step:86.59365350753069 - perf/throughput:1050.1852193139232
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.10468749701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.10468749701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.041454777121543884, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.041454777121543884, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1705.346923828125, 'response_length/max': 2048.0, 'response_length/min': 118.0, 'response_length/clip_ratio': 0.800000011920929, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  77%|███████▋  | 405/525 [7:07:16<3:00:41, 90.34s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  77%|███████▋  | 406/525 [7:08:42<2:56:43, 89.11s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:405 - global_seqlen/min:77283 - global_seqlen/max:93874 - global_seqlen/minmax_diff:16591 - global_seqlen/balanced_min:84595 - global_seqlen/balanced_max:84752 - global_seqlen/mean:84616.375 - actor/entropy:0.018999725580215454 - actor/kl_loss:0.3059646923094988 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.005007044319063425 - actor/pg_clipfrac:0.0005495321092894301 - actor/ppo_kl:-0.0016293529942231545 - actor/pg_clipfrac_lower:4.8828125e-05 - actor/grad_norm:1.1731660850346088 - perf/mfu/actor:0.20644602606836612 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.61391067504883 - actor/lr:1e-06 - training/global_step:405 - training/epoch:11 - critic/score/mean:-0.10468749701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.10468749701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.041454777121543884 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.041454777121543884 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1705.346923828125 - response_length/max:2048.0 - response_length/min:118.0 - response_length/clip_ratio:0.800000011920929 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.933991193771362e-05 - timing_s/generate_sequences:69.67670440673828 - timing_s/reshard:0.7660009860992432 - timing_s/gen:71.82827483676374 - timing_s/reward:0.21632562391459942 - timing_s/old_log_prob:2.3791106455028057 - timing_s/ref:2.018600717186928 - timing_s/adv:0.0074082911014556885 - timing_s/update_actor:9.321838352829218 - timing_s/step:85.78480162471533 - timing_s/stop_profile:4.270114004611969e-05 - timing_per_token_ms/adv:1.0943938306054367e-05 - timing_per_token_ms/gen:0.13162328565259587 - timing_per_token_ms/ref:0.002981988883928979 - timing_per_token_ms/update_actor:0.013770736386469548 - perf/total_num_tokens:676931 - perf/time_per_step:85.78480162471533 - perf/throughput:986.3795613839982
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.18593749403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.18593749403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.045670270919799805, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.045670270919799805, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1777.0875244140625, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.8343750238418579, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:406 - global_seqlen/min:78000 - global_seqlen/max:91632 - global_seqlen/minmax_diff:13632 - global_seqlen/balanced_min:87060 - global_seqlen/balanced_max:88174 - global_seqlen/mean:87481.625 - actor/entropy:0.017216283828020096 - actor/kl_loss:0.3470045104622841 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.014693486504256725 - actor/pg_clipfrac:7.901198405306787e-05 - actor/ppo_kl:-3.4958170726895335e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:6.115635219961405 - perf/mfu/actor:0.21369130000113576 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.53973388671875 - actor/lr:1e-06 - training/global_step:406 - training/epoch:11 - critic/score/mean:-0.18593749403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.18593749403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.045670270919799805 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.045670270919799805 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:1777.0875244140625 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.8343750238418579 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.395632565021515e-05 - timing_s/generate_sequences:69.83185577392578 - timing_s/reshard:0.8957952260971069 - timing_s/gen:72.207463812083 - timing_s/reward:0.2215726263821125 - timing_s/old_log_prob:2.370582288131118 - timing_s/ref:2.0587783716619015 - timing_s/adv:0.007437959313392639 - timing_s/update_actor:9.318142311647534 - timing_s/step:86.20381395705044 - timing_s/stop_profile:5.776435136795044e-05 - timing_per_token_ms/adv:1.0627888018473364e-05 - timing_per_token_ms/gen:0.12697648507052095 - timing_per_token_ms/ref:0.0029417297227587813 - timing_per_token_ms/update_actor:0.013314427903641957 - perf/total_num_tokens:699853 - perf/time_per_step:86.20381395705044 - perf/throughput:1014.8231381454445
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.1796875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.1796875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07539506256580353, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07539506256580353, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1752.4281005859375, 'response_length/max': 2048.0, 'response_length/min': 165.0, 'response_length/clip_ratio': 0.8218749761581421, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  78%|███████▊  | 407/525 [7:10:09<2:53:42, 88.33s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  78%|███████▊  | 408/525 [7:11:35<2:51:03, 87.72s/it]
[36m(TaskRunner pid=2949575)[0m step:407 - global_seqlen/min:75338 - global_seqlen/max:94939 - global_seqlen/minmax_diff:19601 - global_seqlen/balanced_min:85553 - global_seqlen/balanced_max:86613 - global_seqlen/mean:86477.75 - actor/entropy:0.018915308639407158 - actor/kl_loss:0.32300791777670385 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12268579490482807 - actor/pg_clipfrac:0.0002072815739666112 - actor/ppo_kl:0.0009954652314590362 - actor/pg_clipfrac_lower:2.0096462685614823e-05 - actor/grad_norm:3.7208908200263977 - perf/mfu/actor:0.20593900181768604 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.53826904296875 - actor/lr:1e-06 - training/global_step:407 - training/epoch:11 - critic/score/mean:-0.1796875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.1796875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07539506256580353 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07539506256580353 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1752.4281005859375 - response_length/max:2048.0 - response_length/min:165.0 - response_length/clip_ratio:0.8218749761581421 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.400475442409515e-05 - timing_s/generate_sequences:69.93289184570312 - timing_s/reshard:0.901756227016449 - timing_s/gen:72.30521849729121 - timing_s/reward:0.21933173574507236 - timing_s/old_log_prob:2.3546834271401167 - timing_s/ref:2.032737497240305 - timing_s/adv:0.007535196840763092 - timing_s/update_actor:9.55443768389523 - timing_s/step:86.48696587607265 - timing_s/stop_profile:4.5452266931533813e-05 - timing_per_token_ms/adv:1.089181442735717e-05 - timing_per_token_ms/gen:0.12893756073678345 - timing_per_token_ms/ref:0.0029382377219000044 - timing_per_token_ms/update_actor:0.013810543295667426 - perf/total_num_tokens:691822 - perf/time_per_step:86.48696587607265 - perf/throughput:999.8934420235547
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.23593750596046448, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.23593750596046448, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07146799564361572, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.07146799564361572, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1807.6156005859375, 'response_length/max': 2048.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.856249988079071, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:408 - global_seqlen/min:74543 - global_seqlen/max:98340 - global_seqlen/minmax_diff:23797 - global_seqlen/balanced_min:88366 - global_seqlen/balanced_max:89512 - global_seqlen/mean:88659.0 - actor/entropy:0.015396562404930592 - actor/kl_loss:0.3352585282176733 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.010459155961871146 - actor/pg_clipfrac:0.00030795710190432144 - actor/ppo_kl:-0.00015593703574268147 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:16.27651547640562 - perf/mfu/actor:0.2168300535600123 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.44150161743164 - actor/lr:1e-06 - training/global_step:408 - training/epoch:11 - critic/score/mean:-0.23593750596046448 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.23593750596046448 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07146799564361572 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.07146799564361572 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1807.6156005859375 - response_length/max:2048.0 - response_length/min:97.0 - response_length/clip_ratio:0.856249988079071 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.498078048229218e-05 - timing_s/generate_sequences:69.69569396972656 - timing_s/reshard:0.869728684425354 - timing_s/gen:72.33615721575916 - timing_s/reward:0.2294751424342394 - timing_s/old_log_prob:2.3684707917273045 - timing_s/ref:2.0278855226933956 - timing_s/adv:0.0075096264481544495 - timing_s/update_actor:9.31257170252502 - timing_s/step:86.2960860338062 - timing_s/stop_profile:4.243291914463043e-05 - timing_per_token_ms/adv:1.05877948772184e-05 - timing_per_token_ms/gen:0.12505451279181512 - timing_per_token_ms/ref:0.002859108385349197 - timing_per_token_ms/update_actor:0.013129760800546222 - perf/total_num_tokens:709272 - perf/time_per_step:86.2960860338062 - perf/throughput:1027.3814731906627
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.0031250000465661287, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.0031250000465661287, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0785505473613739, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.0785505473613739, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1613.753173828125, 'response_length/max': 2048.0, 'response_length/min': 117.0, 'response_length/clip_ratio': 0.7406250238418579, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.003125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  78%|███████▊  | 409/525 [7:13:00<2:48:20, 87.07s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:54:17,602:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:54:22,193:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:54:22,195:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:54:18,116:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 06:54:22,758:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  78%|███████▊  | 410/525 [7:14:38<2:52:48, 90.16s/it]
[36m(TaskRunner pid=2949575)[0m step:409 - global_seqlen/min:61375 - global_seqlen/max:95567 - global_seqlen/minmax_diff:34192 - global_seqlen/balanced_min:80329 - global_seqlen/balanced_max:81276 - global_seqlen/mean:80922.0 - actor/entropy:0.030126960948109627 - actor/kl_loss:0.32476045563817024 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.027281418815255164 - actor/pg_clipfrac:0.0003640408074716106 - actor/ppo_kl:-0.00021237998153083025 - actor/pg_clipfrac_lower:2.44140625e-05 - actor/grad_norm:2.2641402762383223 - perf/mfu/actor:0.2018093226008547 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.51384353637695 - actor/lr:1e-06 - training/global_step:409 - training/epoch:11 - critic/score/mean:0.0031250000465661287 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.0031250000465661287 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0785505473613739 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.0785505473613739 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1613.753173828125 - response_length/max:2048.0 - response_length/min:117.0 - response_length/clip_ratio:0.7406250238418579 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.003125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.516518235206604e-05 - timing_s/generate_sequences:68.88748168945312 - timing_s/reshard:0.927250325679779 - timing_s/gen:71.99116520769894 - timing_s/reward:0.2067419271916151 - timing_s/old_log_prob:2.272676410153508 - timing_s/ref:1.938982604071498 - timing_s/adv:0.0075853001326322556 - timing_s/update_actor:9.103617800399661 - timing_s/step:85.53405142202973 - timing_s/stop_profile:4.499591886997223e-05 - timing_per_token_ms/adv:1.1716993111626405e-05 - timing_per_token_ms/gen:0.13940942253732844 - timing_per_token_ms/ref:0.0029951413152039894 - timing_per_token_ms/update_actor:0.014062334409060052 - perf/total_num_tokens:647376 - perf/time_per_step:85.53405142202973 - perf/throughput:946.0793526630275
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2593750059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2593750059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07016562670469284, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07016562670469284, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1857.0718994140625, 'response_length/max': 2048.0, 'response_length/min': 109.0, 'response_length/clip_ratio': 0.887499988079071, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.259375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:410 - global_seqlen/min:78658 - global_seqlen/max:98375 - global_seqlen/minmax_diff:19717 - global_seqlen/balanced_min:90052 - global_seqlen/balanced_max:91289 - global_seqlen/mean:90685.375 - actor/entropy:0.009147263132035732 - actor/kl_loss:0.35186457335948945 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10109208524227142 - actor/pg_clipfrac:2.09292586077936e-05 - actor/ppo_kl:0.00010263147632940672 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.059516154229641 - perf/mfu/actor:0.22103050836865548 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.69876861572266 - actor/lr:1e-06 - training/global_step:410 - training/epoch:11 - critic/score/mean:-0.2593750059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2593750059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07016562670469284 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07016562670469284 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1857.0718994140625 - response_length/max:2048.0 - response_length/min:109.0 - response_length/clip_ratio:0.887499988079071 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.259375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.939579129219055e-05 - timing_s/generate_sequences:69.93144226074219 - timing_s/reshard:0.9549098610877991 - timing_s/gen:72.37944197282195 - timing_s/reward:0.23319515027105808 - timing_s/old_log_prob:2.455862956121564 - timing_s/ref:2.030100878328085 - timing_s/adv:0.0073996130377054214 - timing_s/update_actor:9.355851452797651 - timing_s/save_checkpoint:10.338854977861047 - timing_s/step:96.81384629011154 - timing_s/stop_profile:5.137920379638672e-05 - timing_per_token_ms/adv:1.0199567788225804e-05 - timing_per_token_ms/gen:0.12179698546404866 - timing_per_token_ms/ref:0.002798274912476357 - timing_per_token_ms/update_actor:0.012896031268544751 - perf/total_num_tokens:725483 - perf/time_per_step:96.81384629011154 - perf/throughput:936.69840084912
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.13124999403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.13124999403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.057531606405973434, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.057531606405973434, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1751.378173828125, 'response_length/max': 2048.0, 'response_length/min': 107.0, 'response_length/clip_ratio': 0.831250011920929, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.13125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  78%|███████▊  | 411/525 [7:16:04<2:49:01, 88.96s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:54:24,401:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 06:54:24,403:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_410/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  78%|███████▊  | 412/525 [7:17:30<2:45:47, 88.03s/it]
[36m(TaskRunner pid=2949575)[0m step:411 - global_seqlen/min:76317 - global_seqlen/max:98340 - global_seqlen/minmax_diff:22023 - global_seqlen/balanced_min:86111 - global_seqlen/balanced_max:87450 - global_seqlen/mean:86448.875 - actor/entropy:0.014301680959761143 - actor/kl_loss:0.3507267162203789 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013310918863862754 - actor/pg_clipfrac:0.0001932992337970063 - actor/ppo_kl:-0.00021387192537076772 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.33603495731949806 - perf/mfu/actor:0.2119661882499574 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.79558181762695 - actor/lr:1e-06 - training/global_step:411 - training/epoch:11 - critic/score/mean:-0.13124999403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.13124999403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.057531606405973434 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.057531606405973434 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1751.378173828125 - response_length/max:2048.0 - response_length/min:107.0 - response_length/clip_ratio:0.831250011920929 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.13125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.452629506587982e-05 - timing_s/generate_sequences:69.81356811523438 - timing_s/reshard:0.9404716491699219 - timing_s/gen:72.28197586722672 - timing_s/reward:0.21969428658485413 - timing_s/old_log_prob:2.3422181848436594 - timing_s/ref:2.0000302512198687 - timing_s/adv:0.00744948536157608 - timing_s/update_actor:9.287404296919703 - timing_s/step:86.15845874883235 - timing_s/stop_profile:4.357285797595978e-05 - timing_per_token_ms/adv:1.0771518659982678e-05 - timing_per_token_ms/gen:0.12897339036085284 - timing_per_token_ms/ref:0.002891926371540215 - timing_per_token_ms/update_actor:0.013429041582264234 - perf/total_num_tokens:691591 - perf/time_per_step:86.15845874883235 - perf/throughput:1003.3707224500646
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.22499999403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.22499999403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.061107490211725235, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.061107490211725235, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1812.581298828125, 'response_length/max': 2048.0, 'response_length/min': 138.0, 'response_length/clip_ratio': 0.859375, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.225, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:412 - global_seqlen/min:82839 - global_seqlen/max:96701 - global_seqlen/minmax_diff:13862 - global_seqlen/balanced_min:88454 - global_seqlen/balanced_max:89575 - global_seqlen/mean:88875.125 - actor/entropy:0.011958775110542774 - actor/kl_loss:0.33487062305212023 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.019171383418142795 - actor/pg_clipfrac:0.0003757000435143709 - actor/ppo_kl:-0.0013557995669543743 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.975376568734646 - perf/mfu/actor:0.21623286184705234 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.72252655029297 - actor/lr:1e-06 - training/global_step:412 - training/epoch:11 - critic/score/mean:-0.22499999403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.22499999403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.061107490211725235 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.061107490211725235 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1812.581298828125 - response_length/max:2048.0 - response_length/min:138.0 - response_length/clip_ratio:0.859375 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.225 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.374957203865051e-05 - timing_s/generate_sequences:69.66522216796875 - timing_s/reshard:0.9190986752510071 - timing_s/gen:71.7911190316081 - timing_s/reward:0.23224236629903316 - timing_s/old_log_prob:2.392878146842122 - timing_s/ref:2.044856123626232 - timing_s/adv:0.0075081028044223785 - timing_s/update_actor:9.361123843118548 - timing_s/step:85.84277787618339 - timing_s/stop_profile:4.015490412712097e-05 - timing_per_token_ms/adv:1.0559904703962973e-05 - timing_per_token_ms/gen:0.12377224302291295 - timing_per_token_ms/ref:0.0028760242582306244 - timing_per_token_ms/update_actor:0.013166119095639174 - perf/total_num_tokens:711001 - perf/time_per_step:85.84277787618339 - perf/throughput:1035.3244291347416
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.13750000298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.13750000298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11951613426208496, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11951613426208496, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1538.7750244140625, 'response_length/max': 2048.0, 'response_length/min': 153.0, 'response_length/clip_ratio': 0.6968749761581421, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.1375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  79%|███████▊  | 413/525 [7:18:55<2:42:50, 87.24s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  79%|███████▉  | 414/525 [7:20:22<2:40:54, 86.98s/it]
[36m(TaskRunner pid=2949575)[0m step:413 - global_seqlen/min:67998 - global_seqlen/max:89858 - global_seqlen/minmax_diff:21860 - global_seqlen/balanced_min:77149 - global_seqlen/balanced_max:78033 - global_seqlen/mean:77918.5 - actor/entropy:0.039362214505672455 - actor/kl_loss:0.293278294429183 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14984483309090138 - actor/pg_clipfrac:0.00025604877882869916 - actor/ppo_kl:-0.0006521533403429202 - actor/pg_clipfrac_lower:0.00024424629227723924 - actor/grad_norm:0.7188284546136856 - perf/mfu/actor:0.18936826949135535 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.8184814453125 - actor/lr:1e-06 - training/global_step:413 - training/epoch:11 - critic/score/mean:0.13750000298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.13750000298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11951613426208496 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11951613426208496 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1538.7750244140625 - response_length/max:2048.0 - response_length/min:153.0 - response_length/clip_ratio:0.6968749761581421 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.1375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.929707109928131e-05 - timing_s/generate_sequences:68.82307434082031 - timing_s/reshard:0.9323779940605164 - timing_s/gen:71.42844588682055 - timing_s/reward:0.1972106210887432 - timing_s/old_log_prob:2.2712183594703674 - timing_s/ref:1.9294068329036236 - timing_s/adv:0.007695140317082405 - timing_s/update_actor:9.330811012536287 - timing_s/step:85.17778155580163 - timing_s/stop_profile:4.461035132408142e-05 - timing_per_token_ms/adv:1.2344854426552111e-05 - timing_per_token_ms/gen:0.14505947483960568 - timing_per_token_ms/ref:0.0030952322505303997 - timing_per_token_ms/update_actor:0.014968863319584386 - perf/total_num_tokens:623348 - perf/time_per_step:85.17778155580163 - perf/throughput:914.7749398586304
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.07187499850988388, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.07187499850988388, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08078230172395706, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08078230172395706, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1689.78125, 'response_length/max': 2048.0, 'response_length/min': 130.0, 'response_length/clip_ratio': 0.7906249761581421, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.071875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:414 - global_seqlen/min:75474 - global_seqlen/max:93318 - global_seqlen/minmax_diff:17844 - global_seqlen/balanced_min:83272 - global_seqlen/balanced_max:84396 - global_seqlen/mean:83989.375 - actor/entropy:0.02386707253754139 - actor/kl_loss:0.33650624603033064 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12997504714876412 - actor/pg_clipfrac:0.00039742557710269465 - actor/ppo_kl:0.0019776844620537303 - actor/pg_clipfrac_lower:2.18150089494884e-05 - actor/grad_norm:7.648808278143406 - perf/mfu/actor:0.20319099582057024 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.76202011108398 - actor/lr:1e-06 - training/global_step:414 - training/epoch:11 - critic/score/mean:-0.07187499850988388 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.07187499850988388 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08078230172395706 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08078230172395706 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1689.78125 - response_length/max:2048.0 - response_length/min:130.0 - response_length/clip_ratio:0.7906249761581421 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.071875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:6.953254342079163e-05 - timing_s/generate_sequences:69.64385223388672 - timing_s/reshard:1.0153870582580566 - timing_s/gen:72.35123486816883 - timing_s/reward:0.21502584405243397 - timing_s/old_log_prob:2.3629608657211065 - timing_s/ref:2.011726353317499 - timing_s/adv:0.00747167132794857 - timing_s/update_actor:9.39905346557498 - timing_s/step:86.36352670006454 - timing_s/stop_profile:4.3477863073349e-05 - timing_per_token_ms/adv:1.1119965066933422e-05 - timing_per_token_ms/gen:0.13380288659436101 - timing_per_token_ms/ref:0.0029940191144973683 - timing_per_token_ms/update_actor:0.013988456077889287 - perf/total_num_tokens:671915 - perf/time_per_step:86.36352670006454 - perf/throughput:972.5097875135434
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.06093750149011612, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.06093750149011612, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10750914365053177, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10750914365053177, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1655.309326171875, 'response_length/max': 2048.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.768750011920929, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.0609375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  79%|███████▉  | 415/525 [7:21:48<2:39:05, 86.78s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  79%|███████▉  | 416/525 [7:23:14<2:37:14, 86.56s/it]
[36m(TaskRunner pid=2949575)[0m step:415 - global_seqlen/min:70443 - global_seqlen/max:89014 - global_seqlen/minmax_diff:18571 - global_seqlen/balanced_min:81775 - global_seqlen/balanced_max:82856 - global_seqlen/mean:82584.25 - actor/entropy:0.027058253064751625 - actor/kl_loss:0.3384333740919828 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08686922527849675 - actor/pg_clipfrac:0.0006971395137952641 - actor/ppo_kl:0.005764950170305383 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.4444987773895264 - perf/mfu/actor:0.20305333230878006 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.68261337280273 - actor/lr:1e-06 - training/global_step:415 - training/epoch:11 - critic/score/mean:-0.06093750149011612 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.06093750149011612 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10750914365053177 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10750914365053177 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1655.309326171875 - response_length/max:2048.0 - response_length/min:100.0 - response_length/clip_ratio:0.768750011920929 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.0609375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.533840835094452e-05 - timing_s/generate_sequences:69.38885498046875 - timing_s/reshard:0.9288151264190674 - timing_s/gen:72.05786471441388 - timing_s/reward:0.21055984869599342 - timing_s/old_log_prob:2.7856103386729956 - timing_s/ref:1.9905272852629423 - timing_s/adv:0.007472924888134003 - timing_s/update_actor:9.241497291252017 - timing_s/step:86.306540613994 - timing_s/stop_profile:4.190020263195038e-05 - timing_per_token_ms/adv:1.1311062472768722e-05 - timing_per_token_ms/gen:0.1360354932035248 - timing_per_token_ms/ref:0.0030128736491264107 - timing_per_token_ms/update_actor:0.013987983924374225 - perf/total_num_tokens:660674 - perf/time_per_step:86.306540613994 - perf/throughput:956.8712801195225
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.14687499403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.14687499403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.06433066725730896, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.06433066725730896, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1759.284423828125, 'response_length/max': 2048.0, 'response_length/min': 186.0, 'response_length/clip_ratio': 0.831250011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.146875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:416 - global_seqlen/min:79685 - global_seqlen/max:98270 - global_seqlen/minmax_diff:18585 - global_seqlen/balanced_min:86389 - global_seqlen/balanced_max:87808 - global_seqlen/mean:86747.625 - actor/entropy:0.015073654241859913 - actor/kl_loss:0.3316972706466913 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03847687877714634 - actor/pg_clipfrac:5.741976201534271e-05 - actor/ppo_kl:5.854504706803709e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.44005945697426796 - perf/mfu/actor:0.21202195876434216 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.70754623413086 - actor/lr:1e-06 - training/global_step:416 - training/epoch:11 - critic/score/mean:-0.14687499403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.14687499403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.06433066725730896 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.06433066725730896 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1759.284423828125 - response_length/max:2048.0 - response_length/min:186.0 - response_length/clip_ratio:0.831250011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.146875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.54576176404953e-05 - timing_s/generate_sequences:69.40130615234375 - timing_s/reshard:0.9143679141998291 - timing_s/gen:72.07754332572222 - timing_s/reward:0.22175238654017448 - timing_s/old_log_prob:2.3649443313479424 - timing_s/ref:2.018922533839941 - timing_s/adv:0.007594076916575432 - timing_s/update_actor:9.312608908861876 - timing_s/step:86.01850263029337 - timing_s/stop_profile:4.3645501136779785e-05 - timing_per_token_ms/adv:1.0942773529211077e-05 - timing_per_token_ms/gen:0.1280306504699571 - timing_per_token_ms/ref:0.0029091899257183427 - timing_per_token_ms/update_actor:0.013419112207483886 - perf/total_num_tokens:693981 - perf/time_per_step:86.01850263029337 - perf/throughput:1008.4763434309057
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.28125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.28125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.028171662241220474, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.028171662241220474, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1852.3031005859375, 'response_length/max': 2048.0, 'response_length/min': 156.0, 'response_length/clip_ratio': 0.8843749761581421, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.28125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  79%|███████▉  | 417/525 [7:24:41<2:35:51, 86.59s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  80%|███████▉  | 418/525 [7:26:07<2:34:31, 86.65s/it]
[36m(TaskRunner pid=2949575)[0m step:417 - global_seqlen/min:78309 - global_seqlen/max:98375 - global_seqlen/minmax_diff:20066 - global_seqlen/balanced_min:90007 - global_seqlen/balanced_max:91291 - global_seqlen/mean:90494.625 - actor/entropy:0.010204769670963287 - actor/kl_loss:0.3561094895005226 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.025106292217969894 - actor/pg_clipfrac:0.00038902538362890483 - actor/ppo_kl:0.0019121116689348127 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.6635586898773909 - perf/mfu/actor:0.221949984677809 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.66688919067383 - actor/lr:1e-06 - training/global_step:417 - training/epoch:11 - critic/score/mean:-0.28125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.28125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.028171662241220474 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.028171662241220474 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1852.3031005859375 - response_length/max:2048.0 - response_length/min:156.0 - response_length/clip_ratio:0.8843749761581421 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.28125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.211416959762573e-05 - timing_s/generate_sequences:69.62217712402344 - timing_s/reshard:1.0223804712295532 - timing_s/gen:72.6790055334568 - timing_s/reward:0.23182198032736778 - timing_s/old_log_prob:2.3649401292204857 - timing_s/ref:2.047114597633481 - timing_s/adv:0.007556712254881859 - timing_s/update_actor:9.292631464079022 - timing_s/step:86.63609299063683 - timing_s/stop_profile:4.3760985136032104e-05 - timing_per_token_ms/adv:1.0438067806350182e-05 - timing_per_token_ms/gen:0.12261594186537504 - timing_per_token_ms/ref:0.0028276742923039368 - timing_per_token_ms/update_actor:0.012835888684105578 - perf/total_num_tokens:723957 - perf/time_per_step:86.63609299063683 - perf/throughput:1044.5372347271036
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.16249999403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.16249999403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08611298352479935, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.08611298352479935, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1792.65625, 'response_length/max': 2048.0, 'response_length/min': 141.0, 'response_length/clip_ratio': 0.84375, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:418 - global_seqlen/min:81109 - global_seqlen/max:94848 - global_seqlen/minmax_diff:13739 - global_seqlen/balanced_min:87169 - global_seqlen/balanced_max:88379 - global_seqlen/mean:88073.75 - actor/entropy:0.02033928968012333 - actor/kl_loss:0.3125843569636345 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12269833944737911 - actor/pg_clipfrac:0.0010876631102291867 - actor/ppo_kl:0.013121085378224961 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:8.249052070081234 - perf/mfu/actor:0.2157309181687411 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.62223052978516 - actor/lr:1e-06 - training/global_step:418 - training/epoch:11 - critic/score/mean:-0.16249999403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.16249999403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08611298352479935 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.08611298352479935 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1792.65625 - response_length/max:2048.0 - response_length/min:141.0 - response_length/clip_ratio:0.84375 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.732080459594727e-05 - timing_s/generate_sequences:69.94096374511719 - timing_s/reshard:0.8730584383010864 - timing_s/gen:72.22875968553126 - timing_s/reward:0.22404644079506397 - timing_s/old_log_prob:2.786200536414981 - timing_s/ref:2.0248421039432287 - timing_s/adv:0.007448146119713783 - timing_s/update_actor:9.294830244034529 - timing_s/step:86.57897557504475 - timing_s/stop_profile:4.5437365770339966e-05 - timing_per_token_ms/adv:1.0570893881141917e-05 - timing_per_token_ms/gen:0.12591085101635363 - timing_per_token_ms/ref:0.0028737877403074534 - timing_per_token_ms/update_actor:0.013191828217877814 - perf/total_num_tokens:704590 - perf/time_per_step:86.57897557504475 - perf/throughput:1017.2648661528642
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.11562500149011612, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.11562500149011612, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05420541390776634, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05420541390776634, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1728.671875, 'response_length/max': 2048.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.8125, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.115625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  80%|███████▉  | 419/525 [7:27:34<2:32:55, 86.56s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:08:49,923:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 07:08:54,541:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/optim_world_size_8_rank_5.pt
[36m(WorkerDict pid=2951185)[0m INFO:2025-08-06 07:08:54,544:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/extra_state_world_size_8_rank_5.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:08:55,109:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/huggingface
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 07:08:50,207:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  80%|████████  | 420/525 [7:29:10<2:36:27, 89.41s/it]
[36m(TaskRunner pid=2949575)[0m step:419 - global_seqlen/min:65864 - global_seqlen/max:98445 - global_seqlen/minmax_diff:32581 - global_seqlen/balanced_min:84984 - global_seqlen/balanced_max:86086 - global_seqlen/mean:85536.25 - actor/entropy:0.017697812989354134 - actor/kl_loss:0.33576553128659725 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08822957575321197 - actor/pg_clipfrac:0.0004317618135246448 - actor/ppo_kl:0.005782652507332386 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8786813989281654 - perf/mfu/actor:0.20417761690685057 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.73309326171875 - actor/lr:1e-06 - training/global_step:419 - training/epoch:11 - critic/score/mean:-0.11562500149011612 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.11562500149011612 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05420541390776634 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05420541390776634 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1728.671875 - response_length/max:2048.0 - response_length/min:110.0 - response_length/clip_ratio:0.8125 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.115625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.131323218345642e-05 - timing_s/generate_sequences:69.03691864013672 - timing_s/reshard:1.2024598121643066 - timing_s/gen:72.24824808724225 - timing_s/reward:0.217635290697217 - timing_s/old_log_prob:2.326622450724244 - timing_s/ref:1.992123942822218 - timing_s/adv:0.007260449230670929 - timing_s/update_actor:9.530567895621061 - timing_s/step:86.33541054837406 - timing_s/stop_profile:4.382990300655365e-05 - timing_per_token_ms/adv:1.061019338390292e-05 - timing_per_token_ms/gen:0.13060649538978125 - timing_per_token_ms/ref:0.00291122761230212 - timing_per_token_ms/update_actor:0.013927673786875537 - perf/total_num_tokens:684290 - perf/time_per_step:86.33541054837406 - perf/throughput:990.7435368257584
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3109374940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3109374940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.02662866748869419, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.02662866748869419, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1897.1781005859375, 'response_length/max': 2048.0, 'response_length/min': 130.0, 'response_length/clip_ratio': 0.909375011920929, 'prompt_length/mean': 410.5, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3109375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:420 - global_seqlen/min:86096 - global_seqlen/max:98410 - global_seqlen/minmax_diff:12314 - global_seqlen/balanced_min:91822 - global_seqlen/balanced_max:93045 - global_seqlen/mean:92307.125 - actor/entropy:0.008719959296286106 - actor/kl_loss:0.3551091909408569 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03428968731313944 - actor/pg_clipfrac:4.070004215463996e-05 - actor/ppo_kl:6.392306386260316e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8846811149269342 - perf/mfu/actor:0.2261038389173149 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.74237060546875 - actor/lr:1e-06 - training/global_step:420 - training/epoch:11 - critic/score/mean:-0.3109374940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3109374940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.02662866748869419 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.02662866748869419 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1897.1781005859375 - response_length/max:2048.0 - response_length/min:130.0 - response_length/clip_ratio:0.909375011920929 - prompt_length/mean:410.5 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3109375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.31106847524643e-05 - timing_s/generate_sequences:69.92881774902344 - timing_s/reshard:0.8572089672088623 - timing_s/gen:72.03499162010849 - timing_s/reward:0.236357644200325 - timing_s/old_log_prob:2.4230376575142145 - timing_s/ref:2.0575591791421175 - timing_s/adv:0.007601112127304077 - timing_s/update_actor:9.309964483603835 - timing_s/save_checkpoint:9.956118015572429 - timing_s/step:96.03903208486736 - timing_s/stop_profile:4.883110523223877e-05 - timing_per_token_ms/adv:1.0293235932903442e-05 - timing_per_token_ms/gen:0.11865483048031614 - timing_per_token_ms/ref:0.002786295179194073 - timing_per_token_ms/update_actor:0.012607321054040837 - perf/total_num_tokens:738457 - perf/time_per_step:96.03903208486736 - perf/throughput:961.1417670102135
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.22968749701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.22968749701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05980962887406349, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.05980962887406349, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1829.7125244140625, 'response_length/max': 2048.0, 'response_length/min': 119.0, 'response_length/clip_ratio': 0.8687499761581421, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  80%|████████  | 421/525 [7:30:38<2:34:15, 88.99s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:08:56,400:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:08:56,402:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_420/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  80%|████████  | 422/525 [7:32:04<2:31:19, 88.15s/it]
[36m(TaskRunner pid=2949575)[0m step:421 - global_seqlen/min:79336 - global_seqlen/max:96427 - global_seqlen/minmax_diff:17091 - global_seqlen/balanced_min:88765 - global_seqlen/balanced_max:89839 - global_seqlen/mean:89569.125 - actor/entropy:0.011743486858904362 - actor/kl_loss:0.33560261614620684 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07798896990716457 - actor/pg_clipfrac:0.00010077600018121302 - actor/ppo_kl:-0.010959981982159661 - actor/pg_clipfrac_lower:0.0006199147552251816 - actor/grad_norm:5.450764510780573 - perf/mfu/actor:0.2184922877577973 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.18137741088867 - actor/lr:1e-06 - training/global_step:421 - training/epoch:12 - critic/score/mean:-0.22968749701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.22968749701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05980962887406349 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.05980962887406349 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1829.7125244140625 - response_length/max:2048.0 - response_length/min:119.0 - response_length/clip_ratio:0.8687499761581421 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0003102365881204605 - timing_s/generate_sequences:70.04035949707031 - timing_s/reshard:0.9458406567573547 - timing_s/gen:72.16593924351037 - timing_s/reward:0.2323886826634407 - timing_s/old_log_prob:2.4053208008408546 - timing_s/ref:2.034622171893716 - timing_s/adv:0.010021552443504333 - timing_s/update_actor:9.33928732201457 - timing_s/step:86.21484315022826 - timing_s/stop_profile:4.47593629360199e-05 - timing_per_token_ms/adv:1.3985779758795697e-05 - timing_per_token_ms/gen:0.12325354947073373 - timing_per_token_ms/ref:0.0028394580329629713 - timing_per_token_ms/update_actor:0.013033630899618828 - perf/total_num_tokens:716553 - perf/time_per_step:86.21484315022826 - perf/throughput:1038.906083073502
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2578125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2578125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03796070069074631, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.03796070069074631, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1848.293701171875, 'response_length/max': 2048.0, 'response_length/min': 116.0, 'response_length/clip_ratio': 0.8843749761581421, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:422 - global_seqlen/min:83971 - global_seqlen/max:98270 - global_seqlen/minmax_diff:14299 - global_seqlen/balanced_min:89782 - global_seqlen/balanced_max:91163 - global_seqlen/mean:90321.125 - actor/entropy:0.008681279607117176 - actor/kl_loss:0.35202372819185257 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03585597816854715 - actor/pg_clipfrac:8.637227292638273e-05 - actor/ppo_kl:-6.329050884232857e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.22199917398393154 - perf/mfu/actor:0.2194435986266165 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.18424987792969 - actor/lr:1e-06 - training/global_step:422 - training/epoch:12 - critic/score/mean:-0.2578125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2578125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03796070069074631 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.03796070069074631 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1848.293701171875 - response_length/max:2048.0 - response_length/min:116.0 - response_length/clip_ratio:0.8843749761581421 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011545605957508087 - timing_s/generate_sequences:69.64507293701172 - timing_s/reshard:0.866507351398468 - timing_s/gen:72.01161469891667 - timing_s/reward:0.23011488653719425 - timing_s/old_log_prob:2.3792559672147036 - timing_s/ref:2.038311352953315 - timing_s/adv:0.008212821558117867 - timing_s/update_actor:9.380935119464993 - timing_s/step:86.06421762704849 - timing_s/stop_profile:4.204548895359039e-05 - timing_per_token_ms/adv:1.1366141583873466e-05 - timing_per_token_ms/gen:0.1217535340008127 - timing_per_token_ms/ref:0.002820922781012353 - timing_per_token_ms/update_actor:0.012982753369525946 - perf/total_num_tokens:722569 - perf/time_per_step:86.06421762704849 - perf/throughput:1049.4619888534678
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.09375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.09375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08688221126794815, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08688221126794815, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1694.253173828125, 'response_length/max': 2048.0, 'response_length/min': 150.0, 'response_length/clip_ratio': 0.78125, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.09375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  81%|████████  | 423/525 [7:33:30<2:28:50, 87.56s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  81%|████████  | 424/525 [7:34:57<2:26:51, 87.24s/it]
[36m(TaskRunner pid=2949575)[0m step:423 - global_seqlen/min:76078 - global_seqlen/max:91426 - global_seqlen/minmax_diff:15348 - global_seqlen/balanced_min:83891 - global_seqlen/balanced_max:84926 - global_seqlen/mean:84155.125 - actor/entropy:0.023638183251023293 - actor/kl_loss:0.33077702075243 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0816260851919651 - actor/pg_clipfrac:0.0006524345968500711 - actor/ppo_kl:0.005462553824509086 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:18.24871750175953 - perf/mfu/actor:0.20480654973951803 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.15333557128906 - actor/lr:1e-06 - training/global_step:423 - training/epoch:12 - critic/score/mean:-0.09375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.09375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08688221126794815 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08688221126794815 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1694.253173828125 - response_length/max:2048.0 - response_length/min:150.0 - response_length/clip_ratio:0.78125 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.09375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011508725583553314 - timing_s/generate_sequences:69.76671600341797 - timing_s/reshard:0.9213083386421204 - timing_s/gen:71.97553043998778 - timing_s/reward:0.21377766877412796 - timing_s/old_log_prob:2.35473296046257 - timing_s/ref:1.9813400153070688 - timing_s/adv:0.007825305685400963 - timing_s/update_actor:9.341667778789997 - timing_s/step:85.890529923141 - timing_s/stop_profile:4.66369092464447e-05 - timing_per_token_ms/adv:1.1623335009901302e-05 - timing_per_token_ms/gen:0.13275674650147792 - timing_per_token_ms/ref:0.0029429877492711657 - timing_per_token_ms/update_actor:0.01387566678023174 - perf/total_num_tokens:673241 - perf/time_per_step:85.890529923141 - perf/throughput:979.7951540793388
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.1796875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.1796875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08646523952484131, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.643166184425354, 'critic/returns/mean': -0.08646523952484131, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.643166184425354, 'response_length/mean': 1776.409423828125, 'response_length/max': 2048.0, 'response_length/min': 102.0, 'response_length/clip_ratio': 0.831250011920929, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.1796875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:424 - global_seqlen/min:76725 - global_seqlen/max:95295 - global_seqlen/minmax_diff:18570 - global_seqlen/balanced_min:87169 - global_seqlen/balanced_max:88226 - global_seqlen/mean:87437.0 - actor/entropy:0.015953799709677696 - actor/kl_loss:0.34210877418518065 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11010109684430062 - actor/pg_clipfrac:0.00018230369605589657 - actor/ppo_kl:0.00035626956669148057 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:2.9424281492829323 - perf/mfu/actor:0.2131861860443874 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.10422897338867 - actor/lr:1e-06 - training/global_step:424 - training/epoch:12 - critic/score/mean:-0.1796875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.1796875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08646523952484131 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.643166184425354 - critic/returns/mean:-0.08646523952484131 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.643166184425354 - response_length/mean:1776.409423828125 - response_length/max:2048.0 - response_length/min:102.0 - response_length/clip_ratio:0.831250011920929 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.1796875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00011392123997211456 - timing_s/generate_sequences:69.64049530029297 - timing_s/reshard:0.9274749159812927 - timing_s/gen:72.35438851453364 - timing_s/reward:0.22041537798941135 - timing_s/old_log_prob:2.3947684690356255 - timing_s/ref:2.030623484402895 - timing_s/adv:0.00793030858039856 - timing_s/update_actor:9.334919147193432 - timing_s/step:86.35830167680979 - timing_s/stop_profile:4.869513213634491e-05 - timing_per_token_ms/adv:1.1337175023729313e-05 - timing_per_token_ms/gen:0.12728342199157647 - timing_per_token_ms/ref:0.002902980838207645 - timing_per_token_ms/update_actor:0.013345207330983211 - perf/total_num_tokens:699496 - perf/time_per_step:86.35830167680979 - perf/throughput:1012.4909626781125
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.39531248807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.39531248807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.030628159642219543, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.561438798904419, 'critic/returns/mean': -0.030628159642219543, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.561438798904419, 'response_length/mean': 1955.675048828125, 'response_length/max': 2048.0, 'response_length/min': 122.0, 'response_length/clip_ratio': 0.9468749761581421, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3953125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  81%|████████  | 425/525 [7:36:23<2:24:59, 86.99s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  81%|████████  | 426/525 [7:37:50<2:23:21, 86.88s/it]
[36m(TaskRunner pid=2949575)[0m step:425 - global_seqlen/min:89803 - global_seqlen/max:98410 - global_seqlen/minmax_diff:8607 - global_seqlen/balanced_min:93457 - global_seqlen/balanced_max:94806 - global_seqlen/mean:94603.25 - actor/entropy:0.003995887003839016 - actor/kl_loss:0.35344371348619463 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.018983143335208296 - actor/pg_clipfrac:0.00010558085050433874 - actor/ppo_kl:6.48825240205042e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.8802388356998563 - perf/mfu/actor:0.2287962196522148 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.09091567993164 - actor/lr:1e-06 - training/global_step:425 - training/epoch:12 - critic/score/mean:-0.39531248807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.39531248807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.030628159642219543 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.561438798904419 - critic/returns/mean:-0.030628159642219543 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.561438798904419 - response_length/mean:1955.675048828125 - response_length/max:2048.0 - response_length/min:122.0 - response_length/clip_ratio:0.9468749761581421 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3953125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.491108357906342e-05 - timing_s/generate_sequences:70.23098754882812 - timing_s/reshard:0.8597093820571899 - timing_s/gen:72.25340856984258 - timing_s/reward:0.23929239064455032 - timing_s/old_log_prob:2.3841042555868626 - timing_s/ref:2.0544514134526253 - timing_s/adv:0.007824769243597984 - timing_s/update_actor:9.437766185030341 - timing_s/step:86.39276210591197 - timing_s/stop_profile:4.323199391365051e-05 - timing_per_token_ms/adv:1.033892763144763e-05 - timing_per_token_ms/gen:0.11545471603449349 - timing_per_token_ms/ref:0.002714562413887241 - timing_per_token_ms/update_actor:0.0124701928647144 - perf/total_num_tokens:756826 - perf/time_per_step:86.39276210591197 - perf/throughput:1095.0367564822445
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3671875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3671875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.010910890065133572, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -1.643166184425354, 'critic/returns/mean': -0.010910890065133572, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -1.643166184425354, 'response_length/mean': 1937.425048828125, 'response_length/max': 2048.0, 'response_length/min': 181.0, 'response_length/clip_ratio': 0.934374988079071, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:426 - global_seqlen/min:78719 - global_seqlen/max:98375 - global_seqlen/minmax_diff:19656 - global_seqlen/balanced_min:93345 - global_seqlen/balanced_max:94710 - global_seqlen/mean:93873.25 - actor/entropy:0.004561570007354021 - actor/kl_loss:0.3542507663369179 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.008104568347334862 - actor/pg_clipfrac:4.262574657332152e-05 - actor/ppo_kl:5.843669350724667e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.06330204152042995 - perf/mfu/actor:0.2295969664790682 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.02608489990234 - actor/lr:1e-06 - training/global_step:426 - training/epoch:12 - critic/score/mean:-0.3671875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3671875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.010910890065133572 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-1.643166184425354 - critic/returns/mean:-0.010910890065133572 - critic/returns/max:1.4768644571304321 - critic/returns/min:-1.643166184425354 - response_length/mean:1937.425048828125 - response_length/max:2048.0 - response_length/min:181.0 - response_length/clip_ratio:0.934374988079071 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.040107786655426e-05 - timing_s/generate_sequences:70.27880859375 - timing_s/reshard:0.9354974031448364 - timing_s/gen:72.46120653301477 - timing_s/reward:0.24054700694978237 - timing_s/old_log_prob:2.373699599877 - timing_s/ref:2.066300956532359 - timing_s/adv:0.007838785648345947 - timing_s/update_actor:9.329676927998662 - timing_s/step:86.49462949112058 - timing_s/stop_profile:4.272162914276123e-05 - timing_per_token_ms/adv:1.0437991718015978e-05 - timing_per_token_ms/gen:0.1168774380508516 - timing_per_token_ms/ref:0.0027514507015208795 - timing_per_token_ms/update_actor:0.012423236821989574 - perf/total_num_tokens:750986 - perf/time_per_step:86.49462949112058 - perf/throughput:1085.3072676568538
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.421875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.421875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.031154559925198555, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.561438798904419, 'critic/returns/mean': -0.031154559925198555, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.561438798904419, 'response_length/mean': 1989.018798828125, 'response_length/max': 2048.0, 'response_length/min': 213.0, 'response_length/clip_ratio': 0.9624999761581421, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  81%|████████▏ | 427/525 [7:39:16<2:21:49, 86.83s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  82%|████████▏ | 428/525 [7:40:43<2:20:19, 86.80s/it]
[36m(TaskRunner pid=2949575)[0m step:427 - global_seqlen/min:92093 - global_seqlen/max:98305 - global_seqlen/minmax_diff:6212 - global_seqlen/balanced_min:95264 - global_seqlen/balanced_max:96639 - global_seqlen/mean:95928.25 - actor/entropy:0.0031336862593889236 - actor/kl_loss:0.3542092368006706 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.021050509717315435 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.10791068231446843 - perf/mfu/actor:0.23475253070344562 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.16727447509766 - actor/lr:1e-06 - training/global_step:427 - training/epoch:12 - critic/score/mean:-0.421875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.421875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.031154559925198555 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.561438798904419 - critic/returns/mean:-0.031154559925198555 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.561438798904419 - response_length/mean:1989.018798828125 - response_length/max:2048.0 - response_length/min:213.0 - response_length/clip_ratio:0.9624999761581421 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.465295493602753e-05 - timing_s/generate_sequences:70.71006774902344 - timing_s/reshard:0.7559264302253723 - timing_s/gen:72.48921084776521 - timing_s/reward:0.24264755845069885 - timing_s/old_log_prob:2.5264573246240616 - timing_s/ref:2.0827964320778847 - timing_s/adv:0.007929710671305656 - timing_s/update_actor:9.329956224188209 - timing_s/step:86.6928378045559 - timing_s/stop_profile:4.186667501926422e-05 - timing_per_token_ms/adv:1.0332866844888832e-05 - timing_per_token_ms/gen:0.11388971768077413 - timing_per_token_ms/ref:0.002714002955435292 - timing_per_token_ms/update_actor:0.01215746694038019 - perf/total_num_tokens:767426 - perf/time_per_step:86.6928378045559 - perf/throughput:1106.5302789633536
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.46406251192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.46406251192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01098950020968914, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -1.0954443216323853, 'critic/returns/mean': -0.01098950020968914, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -1.0954443216323853, 'response_length/mean': 2022.234375, 'response_length/max': 2048.0, 'response_length/min': 312.0, 'response_length/clip_ratio': 0.984375, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:428 - global_seqlen/min:93155 - global_seqlen/max:98375 - global_seqlen/minmax_diff:5220 - global_seqlen/balanced_min:96548 - global_seqlen/balanced_max:98284 - global_seqlen/mean:97252.5 - actor/entropy:0.0008915624348446727 - actor/kl_loss:0.3565308541059494 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.7939101593064706 - perf/mfu/actor:0.23591811703688723 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.25085830688477 - actor/lr:1e-06 - training/global_step:428 - training/epoch:12 - critic/score/mean:-0.46406251192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.46406251192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01098950020968914 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-1.0954443216323853 - critic/returns/mean:-0.01098950020968914 - critic/returns/max:1.4768644571304321 - critic/returns/min:-1.0954443216323853 - response_length/mean:2022.234375 - response_length/max:2048.0 - response_length/min:312.0 - response_length/clip_ratio:0.984375 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.555074989795685e-05 - timing_s/generate_sequences:70.42752838134766 - timing_s/reshard:0.8870602250099182 - timing_s/gen:72.56090606376529 - timing_s/reward:0.2468737978488207 - timing_s/old_log_prob:2.4085392393171787 - timing_s/ref:2.0582005996257067 - timing_s/adv:0.007903967052698135 - timing_s/update_actor:9.416090657934546 - timing_s/step:86.71357370726764 - timing_s/stop_profile:4.201382398605347e-05 - timing_per_token_ms/adv:1.0159079525845269e-05 - timing_per_token_ms/gen:0.11212984718908585 - timing_per_token_ms/ref:0.002645434050057462 - timing_per_token_ms/update_actor:0.012102633168729013 - perf/total_num_tokens:778020 - perf/time_per_step:86.71357370726764 - perf/throughput:1121.537215480361
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4921875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4921875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.004649598151445389, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -0.44721320271492004, 'critic/returns/mean': -0.004649598151445389, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -0.44721320271492004, 'response_length/mean': 2042.690673828125, 'response_length/max': 2048.0, 'response_length/min': 349.0, 'response_length/clip_ratio': 0.996874988079071, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  82%|████████▏ | 429/525 [7:42:10<2:19:02, 86.90s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:23:26,656:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:23:31,237:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:23:31,239:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:23:31,795:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/huggingface
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:23:26,986:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  82%|████████▏ | 430/525 [7:43:47<2:22:07, 89.76s/it]
[36m(TaskRunner pid=2949575)[0m step:429 - global_seqlen/min:96536 - global_seqlen/max:98375 - global_seqlen/minmax_diff:1839 - global_seqlen/balanced_min:96606 - global_seqlen/balanced_max:98305 - global_seqlen/mean:98092.625 - actor/entropy:0.00023851398145779967 - actor/kl_loss:0.35716248750686647 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.011180330067873001 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.016999070184897214 - perf/mfu/actor:0.23769365940640733 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.22538757324219 - actor/lr:1e-06 - training/global_step:429 - training/epoch:12 - critic/score/mean:-0.4921875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4921875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.004649598151445389 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-0.44721320271492004 - critic/returns/mean:-0.004649598151445389 - critic/returns/max:1.7888528108596802 - critic/returns/min:-0.44721320271492004 - response_length/mean:2042.690673828125 - response_length/max:2048.0 - response_length/min:349.0 - response_length/clip_ratio:0.996874988079071 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.755363523960114e-05 - timing_s/generate_sequences:70.71316528320312 - timing_s/reshard:0.93894362449646 - timing_s/gen:72.81283882446587 - timing_s/reward:0.2474108524620533 - timing_s/old_log_prob:2.378622330725193 - timing_s/ref:2.0588575527071953 - timing_s/adv:0.007654322311282158 - timing_s/update_actor:9.429753666743636 - timing_s/step:86.94915707223117 - timing_s/stop_profile:4.3837353587150574e-05 - timing_per_token_ms/adv:9.75394724027693e-06 - timing_per_token_ms/gen:0.11139235601399788 - timing_per_token_ms/ref:0.0026236141003301667 - timing_per_token_ms/update_actor:0.01201638969640128 - perf/total_num_tokens:784741 - perf/time_per_step:86.94915707223117 - perf/throughput:1128.1607355723027
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4437499940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4437499940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.014151329174637794, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.014151329174637794, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 2006.1624755859375, 'response_length/max': 2048.0, 'response_length/min': 249.0, 'response_length/clip_ratio': 0.9750000238418579, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.44375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:430 - global_seqlen/min:91201 - global_seqlen/max:98340 - global_seqlen/minmax_diff:7139 - global_seqlen/balanced_min:96499 - global_seqlen/balanced_max:96830 - global_seqlen/mean:96622.75 - actor/entropy:0.0014431134331971407 - actor/kl_loss:0.35367309898138044 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.008806200325489044 - actor/pg_clipfrac:9.48766595683992e-05 - actor/ppo_kl:-4.607763548847288e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.044003360513657164 - perf/mfu/actor:0.23705641333678823 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.2258071899414 - actor/lr:1e-06 - training/global_step:430 - training/epoch:12 - critic/score/mean:-0.4437499940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4437499940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.014151329174637794 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.014151329174637794 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:2006.1624755859375 - response_length/max:2048.0 - response_length/min:249.0 - response_length/clip_ratio:0.9750000238418579 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.44375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.059665560722351e-05 - timing_s/generate_sequences:70.43386840820312 - timing_s/reshard:0.7994928359985352 - timing_s/gen:72.14777541346848 - timing_s/reward:0.24532253295183182 - timing_s/old_log_prob:2.413142453879118 - timing_s/ref:2.060342622920871 - timing_s/adv:0.007997171953320503 - timing_s/update_actor:9.30785720795393 - timing_s/save_checkpoint:10.14336008951068 - timing_s/step:96.33972470648587 - timing_s/stop_profile:5.11612743139267e-05 - timing_per_token_ms/adv:1.034587086545418e-05 - timing_per_token_ms/gen:0.11238461399168263 - timing_per_token_ms/ref:0.002665447090515524 - timing_per_token_ms/update_actor:0.012041492826422775 - perf/total_num_tokens:772982 - perf/time_per_step:96.33972470648587 - perf/throughput:1002.9377839139194
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.453125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.453125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021181385964155197, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.0954443216323853, 'critic/returns/mean': -0.021181385964155197, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.0954443216323853, 'response_length/mean': 2014.7406005859375, 'response_length/max': 2048.0, 'response_length/min': 71.0, 'response_length/clip_ratio': 0.981249988079071, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.453125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  82%|████████▏ | 431/525 [7:45:14<2:19:36, 89.11s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:23:33,320:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:23:33,323:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_430/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  82%|████████▏ | 432/525 [7:46:41<2:17:02, 88.41s/it]
[36m(TaskRunner pid=2949575)[0m step:431 - global_seqlen/min:93220 - global_seqlen/max:98375 - global_seqlen/minmax_diff:5155 - global_seqlen/balanced_min:96342 - global_seqlen/balanced_max:98319 - global_seqlen/mean:96987.75 - actor/entropy:0.0016907439567148685 - actor/kl_loss:0.3575835719704628 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.011180330067873001 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.0860751615892914 - perf/mfu/actor:0.23512783728688524 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.40189743041992 - actor/lr:1e-06 - training/global_step:431 - training/epoch:12 - critic/score/mean:-0.453125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.453125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021181385964155197 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.0954443216323853 - critic/returns/mean:-0.021181385964155197 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.0954443216323853 - response_length/mean:2014.7406005859375 - response_length/max:2048.0 - response_length/min:71.0 - response_length/clip_ratio:0.981249988079071 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.453125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.275173604488373e-05 - timing_s/generate_sequences:70.71967315673828 - timing_s/reshard:0.9397407174110413 - timing_s/gen:73.18890236504376 - timing_s/reward:0.24400298669934273 - timing_s/old_log_prob:2.396284330636263 - timing_s/ref:2.053210960701108 - timing_s/adv:0.007837584242224693 - timing_s/update_actor:9.423860227689147 - timing_s/step:87.32743728160858 - timing_s/stop_profile:4.48860228061676e-05 - timing_per_token_ms/adv:1.010125536759113e-05 - timing_per_token_ms/gen:0.1135209748851725 - timing_per_token_ms/ref:0.002646224601433052 - timing_per_token_ms/update_actor:0.012145683640059114 - perf/total_num_tokens:775902 - perf/time_per_step:87.32743728160858 - perf/throughput:1110.621736067204
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.41874998807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.41874998807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026709765195846558, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.0954443216323853, 'critic/returns/mean': -0.026709765195846558, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.0954443216323853, 'response_length/mean': 1986.378173828125, 'response_length/max': 2048.0, 'response_length/min': 176.0, 'response_length/clip_ratio': 0.9624999761581421, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.41875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:432 - global_seqlen/min:92917 - global_seqlen/max:98340 - global_seqlen/minmax_diff:5423 - global_seqlen/balanced_min:95134 - global_seqlen/balanced_max:96535 - global_seqlen/mean:95827.0 - actor/entropy:0.0046198247000575066 - actor/kl_loss:0.35054671615362165 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05136883482336998 - actor/pg_clipfrac:0.0002502545743482187 - actor/ppo_kl:0.0016717381891794502 - actor/pg_clipfrac_lower:1.220703125e-05 - actor/grad_norm:0.07985234819352627 - perf/mfu/actor:0.2334904646655071 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.4155502319336 - actor/lr:1e-06 - training/global_step:432 - training/epoch:12 - critic/score/mean:-0.41874998807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.41874998807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026709765195846558 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.0954443216323853 - critic/returns/mean:-0.026709765195846558 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.0954443216323853 - response_length/mean:1986.378173828125 - response_length/max:2048.0 - response_length/min:176.0 - response_length/clip_ratio:0.9624999761581421 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.41875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.443184196949005e-05 - timing_s/generate_sequences:70.52928161621094 - timing_s/reshard:0.8999509215354919 - timing_s/gen:72.60166001319885 - timing_s/reward:0.2408915963023901 - timing_s/old_log_prob:2.3712442442774773 - timing_s/ref:2.053723620250821 - timing_s/adv:0.007649760693311691 - timing_s/update_actor:9.373453348875046 - timing_s/step:86.66217652335763 - timing_s/stop_profile:4.560686647891998e-05 - timing_per_token_ms/adv:9.978608186251906e-06 - timing_per_token_ms/gen:0.1142180256043881 - timing_per_token_ms/ref:0.0026789469829103765 - timing_per_token_ms/update_actor:0.012227051547156654 - perf/total_num_tokens:766616 - perf/time_per_step:86.66217652335763 - perf/throughput:1105.7534422086921
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4359374940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4359374940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0049743433482944965, 'critic/advantages/max': 0.6390091180801392, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.0049743433482944965, 'critic/returns/max': 0.6390091180801392, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1995.9749755859375, 'response_length/max': 2048.0, 'response_length/min': 127.0, 'response_length/clip_ratio': 0.971875011920929, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  82%|████████▏ | 433/525 [7:48:08<2:14:50, 87.94s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  83%|████████▎ | 434/525 [7:49:35<2:13:11, 87.81s/it]
[36m(TaskRunner pid=2949575)[0m step:433 - global_seqlen/min:89343 - global_seqlen/max:98410 - global_seqlen/minmax_diff:9067 - global_seqlen/balanced_min:94790 - global_seqlen/balanced_max:96461 - global_seqlen/mean:96202.125 - actor/entropy:0.0011749227996915579 - actor/kl_loss:0.3558128386735916 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0022134372964501383 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.03224328400441934 - perf/mfu/actor:0.23343878572631843 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.34683990478516 - actor/lr:1e-06 - training/global_step:433 - training/epoch:12 - critic/score/mean:-0.4359374940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4359374940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0049743433482944965 - critic/advantages/max:0.6390091180801392 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.0049743433482944965 - critic/returns/max:0.6390091180801392 - critic/returns/min:-1.78885018825531 - response_length/mean:1995.9749755859375 - response_length/max:2048.0 - response_length/min:127.0 - response_length/clip_ratio:0.971875011920929 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.310137152671814e-05 - timing_s/generate_sequences:70.52692413330078 - timing_s/reshard:0.9442766308784485 - timing_s/gen:72.32138468883932 - timing_s/reward:0.24351318925619125 - timing_s/old_log_prob:2.786830322816968 - timing_s/ref:2.0532803665846586 - timing_s/adv:0.007888900116086006 - timing_s/update_actor:9.4113331977278 - timing_s/step:86.83783436752856 - timing_s/stop_profile:4.6815723180770874e-05 - timing_per_token_ms/adv:1.0250423413315982e-05 - timing_per_token_ms/gen:0.11323003902985902 - timing_per_token_ms/ref:0.0026679249114620112 - timing_per_token_ms/update_actor:0.012228593180410256 - perf/total_num_tokens:769617 - perf/time_per_step:86.83783436752856 - perf/throughput:1107.8365288664206
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4156250059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4156250059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01599033735692501, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.01599033735692501, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1986.971923828125, 'response_length/max': 2048.0, 'response_length/min': 138.0, 'response_length/clip_ratio': 0.9624999761581421, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.415625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:434 - global_seqlen/min:90632 - global_seqlen/max:98340 - global_seqlen/minmax_diff:7708 - global_seqlen/balanced_min:95212 - global_seqlen/balanced_max:96473 - global_seqlen/mean:95846.375 - actor/entropy:0.004363608546555042 - actor/kl_loss:0.35564735233783723 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.026631159335374834 - actor/pg_clipfrac:8.75273544806987e-05 - actor/ppo_kl:2.2751330106984824e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.569826737046242 - perf/mfu/actor:0.2292455360437348 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.34559631347656 - actor/lr:1e-06 - training/global_step:434 - training/epoch:12 - critic/score/mean:-0.4156250059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4156250059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01599033735692501 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.01599033735692501 - critic/returns/max:1.4768644571304321 - critic/returns/min:-1.78885018825531 - response_length/mean:1986.971923828125 - response_length/max:2048.0 - response_length/min:138.0 - response_length/clip_ratio:0.9624999761581421 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.415625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.245371282100677e-05 - timing_s/generate_sequences:70.81200408935547 - timing_s/reshard:0.8412305116653442 - timing_s/gen:72.94174054637551 - timing_s/reward:0.2454671934247017 - timing_s/old_log_prob:2.5093413665890694 - timing_s/ref:2.1147749070078135 - timing_s/adv:0.007749622687697411 - timing_s/update_actor:9.545371735468507 - timing_s/step:87.37854550033808 - timing_s/stop_profile:4.274584352970123e-05 - timing_per_token_ms/adv:1.01068280982163e-05 - timing_per_token_ms/gen:0.11471875474202345 - timing_per_token_ms/ref:0.002758026721156399 - timing_per_token_ms/update_actor:0.012448790754304098 - perf/total_num_tokens:766771 - perf/time_per_step:87.37854550033808 - perf/throughput:1096.9097099428047
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3843750059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3843750059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.026923296973109245, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.026923296973109245, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1946.518798828125, 'response_length/max': 2048.0, 'response_length/min': 124.0, 'response_length/clip_ratio': 0.9437500238418579, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.384375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  83%|████████▎ | 435/525 [7:51:02<2:11:06, 87.41s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  83%|████████▎ | 436/525 [7:52:29<2:09:21, 87.21s/it]
[36m(TaskRunner pid=2949575)[0m step:435 - global_seqlen/min:81993 - global_seqlen/max:98375 - global_seqlen/minmax_diff:16382 - global_seqlen/balanced_min:93171 - global_seqlen/balanced_max:94606 - global_seqlen/mean:94241.375 - actor/entropy:0.0037952514830976725 - actor/kl_loss:0.3553044483065605 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0068035435397177935 - actor/pg_clipfrac:6.744684360455721e-05 - actor/ppo_kl:-1.2794666690751911e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.06641959123088359 - perf/mfu/actor:0.2276704213417675 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.34151840209961 - actor/lr:1e-06 - training/global_step:435 - training/epoch:12 - critic/score/mean:-0.3843750059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3843750059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.026923296973109245 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.026923296973109245 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1946.518798828125 - response_length/max:2048.0 - response_length/min:124.0 - response_length/clip_ratio:0.9437500238418579 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.384375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.413700222969055e-05 - timing_s/generate_sequences:70.43925476074219 - timing_s/reshard:0.9185466170310974 - timing_s/gen:72.22738139331341 - timing_s/reward:0.23865030705928802 - timing_s/old_log_prob:2.391128335148096 - timing_s/ref:2.1120006181299686 - timing_s/adv:0.007500095292925835 - timing_s/update_actor:9.448306376114488 - timing_s/step:86.43884731456637 - timing_s/stop_profile:4.317425191402435e-05 - timing_per_token_ms/adv:9.94798634480587e-06 - timing_per_token_ms/gen:0.11595601987091282 - timing_per_token_ms/ref:0.0028013181818097 - timing_per_token_ms/update_actor:0.012532057145964932 - perf/total_num_tokens:753931 - perf/time_per_step:86.43884731456637 - perf/throughput:1090.2664476429081
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4296875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4296875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.010113502852618694, 'critic/advantages/max': 1.2298359870910645, 'critic/advantages/min': -1.5652457475662231, 'critic/returns/mean': -0.010113502852618694, 'critic/returns/max': 1.2298359870910645, 'critic/returns/min': -1.5652457475662231, 'response_length/mean': 1990.184326171875, 'response_length/max': 2048.0, 'response_length/min': 120.0, 'response_length/clip_ratio': 0.965624988079071, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:436 - global_seqlen/min:87352 - global_seqlen/max:98375 - global_seqlen/minmax_diff:11023 - global_seqlen/balanced_min:95247 - global_seqlen/balanced_max:96469 - global_seqlen/mean:95996.75 - actor/entropy:0.002083751605823636 - actor/kl_loss:0.35659103840589523 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013123210892081261 - actor/pg_clipfrac:6.637168116867543e-05 - actor/ppo_kl:5.086122200737009e-07 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.04113889249775671 - perf/mfu/actor:0.23505582518102225 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.32305145263672 - actor/lr:1e-06 - training/global_step:436 - training/epoch:12 - critic/score/mean:-0.4296875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4296875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.010113502852618694 - critic/advantages/max:1.2298359870910645 - critic/advantages/min:-1.5652457475662231 - critic/returns/mean:-0.010113502852618694 - critic/returns/max:1.2298359870910645 - critic/returns/min:-1.5652457475662231 - response_length/mean:1990.184326171875 - response_length/max:2048.0 - response_length/min:120.0 - response_length/clip_ratio:0.965624988079071 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.298588752746582e-05 - timing_s/generate_sequences:70.4166259765625 - timing_s/reshard:0.887991726398468 - timing_s/gen:72.67964000068605 - timing_s/reward:0.24376164749264717 - timing_s/old_log_prob:2.4085967130959034 - timing_s/ref:2.049751928076148 - timing_s/adv:0.0077943019568920135 - timing_s/update_actor:9.325825529173017 - timing_s/step:86.73108254745603 - timing_s/stop_profile:4.357099533081055e-05 - timing_per_token_ms/adv:1.0149174264873569e-05 - timing_per_token_ms/gen:0.11412202701176563 - timing_per_token_ms/ref:0.0026690381810792396 - timing_per_token_ms/update_actor:0.01214341309624156 - perf/total_num_tokens:767974 - perf/time_per_step:86.73108254745603 - perf/throughput:1106.832143453002
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.5, 'critic/score/max': -0.5, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.5, 'critic/rewards/max': -0.5, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.0, 'critic/advantages/max': 0.0, 'critic/advantages/min': 0.0, 'critic/returns/mean': 0.0, 'critic/returns/max': 0.0, 'critic/returns/min': 0.0, 'response_length/mean': 2048.0, 'response_length/max': 2048.0, 'response_length/min': 2048.0, 'response_length/clip_ratio': 1.0, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.5, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  83%|████████▎ | 437/525 [7:53:56<2:07:54, 87.21s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  83%|████████▎ | 438/525 [7:55:23<2:06:32, 87.27s/it]
[36m(TaskRunner pid=2949575)[0m step:437 - global_seqlen/min:98270 - global_seqlen/max:98375 - global_seqlen/minmax_diff:105 - global_seqlen/balanced_min:98312 - global_seqlen/balanced_max:98319 - global_seqlen/mean:98313.75 - actor/entropy:4.423782229423523e-09 - actor/kl_loss:0.3575835719704628 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.3501436230997115e-08 - perf/mfu/actor:0.2407435053388707 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.37324905395508 - actor/lr:1e-06 - training/global_step:437 - training/epoch:12 - critic/score/mean:-0.5 - critic/score/max:-0.5 - critic/score/min:-0.5 - critic/rewards/mean:-0.5 - critic/rewards/max:-0.5 - critic/rewards/min:-0.5 - critic/advantages/mean:0.0 - critic/advantages/max:0.0 - critic/advantages/min:0.0 - critic/returns/mean:0.0 - critic/returns/max:0.0 - critic/returns/min:0.0 - response_length/mean:2048.0 - response_length/max:2048.0 - response_length/min:2048.0 - response_length/clip_ratio:1.0 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.5 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.443184196949005e-05 - timing_s/generate_sequences:70.61579895019531 - timing_s/reshard:0.9654340744018555 - timing_s/gen:72.98210843279958 - timing_s/reward:0.24767366237938404 - timing_s/old_log_prob:2.3925346601754427 - timing_s/ref:2.0687659084796906 - timing_s/adv:0.007643569260835648 - timing_s/update_actor:9.331525646150112 - timing_s/step:87.04429999552667 - timing_s/stop_profile:4.399940371513367e-05 - timing_per_token_ms/adv:9.718337034285194e-06 - timing_per_token_ms/gen:0.11136185979125912 - timing_per_token_ms/ref:0.002630311004920078 - timing_per_token_ms/update_actor:0.011864471711930061 - perf/total_num_tokens:786510 - perf/time_per_step:87.04429999552667 - perf/throughput:1129.4679836020564
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 0.00016399148444179446, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': 0.00016399148444179446, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1994.153076171875, 'response_length/max': 2048.0, 'response_length/min': 231.0, 'response_length/clip_ratio': 0.96875, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:438 - global_seqlen/min:89509 - global_seqlen/max:98340 - global_seqlen/minmax_diff:8831 - global_seqlen/balanced_min:95006 - global_seqlen/balanced_max:96572 - global_seqlen/mean:96146.75 - actor/entropy:0.002989797852933407 - actor/kl_loss:0.3549855798482895 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.012166697531938553 - actor/pg_clipfrac:2.1097046555951238e-05 - actor/ppo_kl:-1.165882931672968e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.08894421494516092 - perf/mfu/actor:0.23307565367155783 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.40641403198242 - actor/lr:1e-06 - training/global_step:438 - training/epoch:12 - critic/score/mean:-0.4375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:0.00016399148444179446 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:0.00016399148444179446 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:1994.153076171875 - response_length/max:2048.0 - response_length/min:231.0 - response_length/clip_ratio:0.96875 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.09449702501297e-05 - timing_s/generate_sequences:70.75203704833984 - timing_s/reshard:0.9502743482589722 - timing_s/gen:73.19129791669548 - timing_s/reward:0.2439835388213396 - timing_s/old_log_prob:2.3889319244772196 - timing_s/ref:2.0520520340651274 - timing_s/adv:0.007743353024125099 - timing_s/update_actor:9.420270817354321 - timing_s/step:87.31790346093476 - timing_s/stop_profile:4.373304545879364e-05 - timing_per_token_ms/adv:1.006710188348163e-05 - timing_per_token_ms/gen:0.11469671166283851 - timing_per_token_ms/ref:0.002667864532687178 - timing_per_token_ms/update_actor:0.01224725591004678 - perf/total_num_tokens:769174 - perf/time_per_step:87.31790346093476 - perf/throughput:1101.1115268361339
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3187499940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3187499940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04691832885146141, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.04691832885146141, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1886.5374755859375, 'response_length/max': 2048.0, 'response_length/min': 118.0, 'response_length/clip_ratio': 0.909375011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.31875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  84%|████████▎ | 439/525 [7:56:50<2:04:54, 87.14s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:38:07,166:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 07:38:11,836:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 07:38:11,839:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:38:07,328:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:38:12,552:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  84%|████████▍ | 440/525 [7:58:27<2:07:36, 90.07s/it]
[36m(TaskRunner pid=2949575)[0m step:439 - global_seqlen/min:84401 - global_seqlen/max:98340 - global_seqlen/minmax_diff:13939 - global_seqlen/balanced_min:91268 - global_seqlen/balanced_max:92756 - global_seqlen/mean:91837.75 - actor/entropy:0.0059884171932935715 - actor/kl_loss:0.3541297897696495 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0058353913482278585 - actor/pg_clipfrac:4.443989309947938e-05 - actor/ppo_kl:4.7131958126556125e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.1933986321091652 - perf/mfu/actor:0.22435783789697866 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.4418716430664 - actor/lr:1e-06 - training/global_step:439 - training/epoch:12 - critic/score/mean:-0.3187499940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3187499940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04691832885146141 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.04691832885146141 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1886.5374755859375 - response_length/max:2048.0 - response_length/min:118.0 - response_length/clip_ratio:0.909375011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.31875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.597038686275482e-05 - timing_s/generate_sequences:70.1805419921875 - timing_s/reshard:0.806866466999054 - timing_s/gen:72.5959550626576 - timing_s/reward:0.23350315541028976 - timing_s/old_log_prob:2.368225248530507 - timing_s/ref:2.041689896956086 - timing_s/adv:0.007480671629309654 - timing_s/update_actor:9.33921186067164 - timing_s/step:86.6014958024025 - timing_s/stop_profile:4.491768777370453e-05 - timing_per_token_ms/adv:1.018191270652544e-05 - timing_per_token_ms/gen:0.12025329979966207 - timing_per_token_ms/ref:0.002778936081507994 - timing_per_token_ms/update_actor:0.012711564499173324 - perf/total_num_tokens:734702 - perf/time_per_step:86.6014958024025 - perf/throughput:1060.4637847081187
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4390625059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4390625059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.014111816883087158, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.5652457475662231, 'critic/returns/mean': -0.014111816883087158, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.5652457475662231, 'response_length/mean': 1991.5625, 'response_length/max': 2048.0, 'response_length/min': 252.0, 'response_length/clip_ratio': 0.965624988079071, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:440 - global_seqlen/min:83725 - global_seqlen/max:98340 - global_seqlen/minmax_diff:14615 - global_seqlen/balanced_min:95045 - global_seqlen/balanced_max:96607 - global_seqlen/mean:96038.75 - actor/entropy:0.0036697154864668846 - actor/kl_loss:0.3546231105923653 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.014069890975952149 - actor/pg_clipfrac:8.291873964481056e-05 - actor/ppo_kl:-3.7662030081264675e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.22705272226634143 - perf/mfu/actor:0.23176861320645664 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.38731002807617 - actor/lr:1e-06 - training/global_step:440 - training/epoch:12 - critic/score/mean:-0.4390625059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4390625059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.014111816883087158 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.5652457475662231 - critic/returns/mean:-0.014111816883087158 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.5652457475662231 - response_length/mean:1991.5625 - response_length/max:2048.0 - response_length/min:252.0 - response_length/clip_ratio:0.965624988079071 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.416175842285156e-05 - timing_s/generate_sequences:70.35482788085938 - timing_s/reshard:0.7744497656822205 - timing_s/gen:72.6269320435822 - timing_s/reward:0.24137547984719276 - timing_s/old_log_prob:2.3715328257530928 - timing_s/ref:2.053314484655857 - timing_s/adv:0.007558153942227364 - timing_s/update_actor:9.461619723588228 - timing_s/save_checkpoint:10.006377529352903 - timing_s/step:96.78276826255023 - timing_s/stop_profile:4.9350783228874207e-05 - timing_per_token_ms/adv:9.837375463325172e-06 - timing_per_token_ms/gen:0.11396035155120383 - timing_per_token_ms/ref:0.002672507821915447 - timing_per_token_ms/update_actor:0.012314846511939488 - perf/total_num_tokens:768310 - perf/time_per_step:96.78276826255023 - perf/throughput:992.312492441507
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4312500059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4312500059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01512114703655243, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.014783501625061, 'critic/returns/mean': -0.01512114703655243, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.014783501625061, 'response_length/mean': 1991.112548828125, 'response_length/max': 2048.0, 'response_length/min': 113.0, 'response_length/clip_ratio': 0.96875, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.43125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  84%|████████▍ | 441/525 [7:59:54<2:04:39, 89.05s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:38:13,638:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:38:13,641:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_440/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  84%|████████▍ | 442/525 [8:01:20<2:02:13, 88.36s/it]
[36m(TaskRunner pid=2949575)[0m step:441 - global_seqlen/min:88773 - global_seqlen/max:98340 - global_seqlen/minmax_diff:9567 - global_seqlen/balanced_min:94802 - global_seqlen/balanced_max:96418 - global_seqlen/mean:95998.875 - actor/entropy:0.0018608272075653076 - actor/kl_loss:0.35502714812755587 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.05618775944493315 - perf/mfu/actor:0.2315621726456699 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.48173904418945 - actor/lr:1e-06 - training/global_step:441 - training/epoch:12 - critic/score/mean:-0.4312500059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4312500059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01512114703655243 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.014783501625061 - critic/returns/mean:-0.01512114703655243 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.014783501625061 - response_length/mean:1991.112548828125 - response_length/max:2048.0 - response_length/min:113.0 - response_length/clip_ratio:0.96875 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.43125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.114000618457794e-05 - timing_s/generate_sequences:69.8865966796875 - timing_s/reshard:0.9372270703315735 - timing_s/gen:72.01880678907037 - timing_s/reward:0.2448036465793848 - timing_s/old_log_prob:2.8218098878860474 - timing_s/ref:2.0551091451197863 - timing_s/adv:0.00788828358054161 - timing_s/update_actor:9.466805521398783 - timing_s/step:86.62972141243517 - timing_s/stop_profile:4.466809332370758e-05 - timing_per_token_ms/adv:1.0271322945895995e-05 - timing_per_token_ms/gen:0.1130316700918933 - timing_per_token_ms/ref:0.0026759547248858206 - timing_per_token_ms/update_actor:0.012326714143002696 - perf/total_num_tokens:767991 - perf/time_per_step:86.62972141243517 - perf/throughput:1108.1517224666954
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4546875059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4546875059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005385841708630323, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -1.0954431295394897, 'critic/returns/mean': -0.005385841708630323, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -1.0954431295394897, 'response_length/mean': 2012.965576171875, 'response_length/max': 2048.0, 'response_length/min': 338.0, 'response_length/clip_ratio': 0.9781249761581421, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:442 - global_seqlen/min:90225 - global_seqlen/max:98340 - global_seqlen/minmax_diff:8115 - global_seqlen/balanced_min:96574 - global_seqlen/balanced_max:98277 - global_seqlen/mean:96881.75 - actor/entropy:0.0020777378231287003 - actor/kl_loss:0.35632030814886095 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.017374876141548156 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.0508654495621812 - perf/mfu/actor:0.2372941230084488 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.52708053588867 - actor/lr:1e-06 - training/global_step:442 - training/epoch:12 - critic/score/mean:-0.4546875059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4546875059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005385841708630323 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-1.0954431295394897 - critic/returns/mean:-0.005385841708630323 - critic/returns/max:1.4768644571304321 - critic/returns/min:-1.0954431295394897 - response_length/mean:2012.965576171875 - response_length/max:2048.0 - response_length/min:338.0 - response_length/clip_ratio:0.9781249761581421 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.402019739151001e-05 - timing_s/generate_sequences:70.2956314086914 - timing_s/reshard:0.9529961943626404 - timing_s/gen:72.45571304485202 - timing_s/reward:0.24625075794756413 - timing_s/old_log_prob:2.511802103370428 - timing_s/ref:2.062403777614236 - timing_s/adv:0.007915960624814034 - timing_s/update_actor:9.325340358540416 - timing_s/step:86.62432473152876 - timing_s/stop_profile:4.124268889427185e-05 - timing_per_token_ms/adv:1.0213431096173987e-05 - timing_per_token_ms/gen:0.11248284642971117 - timing_per_token_ms/ref:0.002660980754391611 - timing_per_token_ms/update_actor:0.01203185888794899 - perf/total_num_tokens:775054 - perf/time_per_step:86.62432473152876 - perf/throughput:1118.4127587748783
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.359375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.359375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.029698334634304047, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.029698334634304047, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1935.378173828125, 'response_length/max': 2048.0, 'response_length/min': 110.0, 'response_length/clip_ratio': 0.9375, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  84%|████████▍ | 443/525 [8:02:46<1:59:46, 87.64s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  85%|████████▍ | 444/525 [8:04:13<1:57:47, 87.26s/it]
[36m(TaskRunner pid=2949575)[0m step:443 - global_seqlen/min:82189 - global_seqlen/max:98410 - global_seqlen/minmax_diff:16221 - global_seqlen/balanced_min:92965 - global_seqlen/balanced_max:94602 - global_seqlen/mean:93822.0 - actor/entropy:0.005189396906644106 - actor/kl_loss:0.3531506136059761 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.012808505445718765 - actor/pg_clipfrac:4.481462383409962e-05 - actor/ppo_kl:-3.105231153313071e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.10908225737512112 - perf/mfu/actor:0.22773357239454423 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.5576171875 - actor/lr:1e-06 - training/global_step:443 - training/epoch:12 - critic/score/mean:-0.359375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.359375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.029698334634304047 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.029698334634304047 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1935.378173828125 - response_length/max:2048.0 - response_length/min:110.0 - response_length/clip_ratio:0.9375 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.301382720470428e-05 - timing_s/generate_sequences:69.88442993164062 - timing_s/reshard:0.7818676233291626 - timing_s/gen:71.91271279379725 - timing_s/reward:0.23747913725674152 - timing_s/old_log_prob:2.3425783291459084 - timing_s/ref:2.0247163977473974 - timing_s/adv:0.007793858647346497 - timing_s/update_actor:9.404610989615321 - timing_s/step:85.94380252622068 - timing_s/stop_profile:4.4774264097213745e-05 - timing_per_token_ms/adv:1.038383674317657e-05 - timing_per_token_ms/gen:0.11611541154554303 - timing_per_token_ms/ref:0.00269755014515172 - timing_per_token_ms/update_actor:0.012529858388244922 - perf/total_num_tokens:750576 - perf/time_per_step:85.94380252622068 - perf/throughput:1091.666847896051
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.34687501192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.34687501192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.010649639181792736, 'critic/advantages/max': 1.2298359870910645, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.010649639181792736, 'critic/returns/max': 1.2298359870910645, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1927.215576171875, 'response_length/max': 2048.0, 'response_length/min': 151.0, 'response_length/clip_ratio': 0.9312499761581421, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.346875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:444 - global_seqlen/min:89323 - global_seqlen/max:98340 - global_seqlen/minmax_diff:9017 - global_seqlen/balanced_min:93044 - global_seqlen/balanced_max:94640 - global_seqlen/mean:93486.75 - actor/entropy:0.004862429574131966 - actor/kl_loss:0.35622823536396026 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.005287192668765784 - actor/pg_clipfrac:0.00011164844763698057 - actor/ppo_kl:-6.934641860425472e-05 - actor/pg_clipfrac_lower:2.1881838620174676e-05 - actor/grad_norm:0.06303788628429174 - perf/mfu/actor:0.22917032676324747 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.54985809326172 - actor/lr:1e-06 - training/global_step:444 - training/epoch:12 - critic/score/mean:-0.34687501192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.34687501192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.010649639181792736 - critic/advantages/max:1.2298359870910645 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.010649639181792736 - critic/returns/max:1.2298359870910645 - critic/returns/min:-1.78885018825531 - response_length/mean:1927.215576171875 - response_length/max:2048.0 - response_length/min:151.0 - response_length/clip_ratio:0.9312499761581421 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.346875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.426738739013672e-05 - timing_s/generate_sequences:69.97613525390625 - timing_s/reshard:0.9321528673171997 - timing_s/gen:72.32788564264774 - timing_s/reward:0.23854263499379158 - timing_s/old_log_prob:2.413924539461732 - timing_s/ref:2.044912764802575 - timing_s/adv:0.007986584678292274 - timing_s/update_actor:9.309332359582186 - timing_s/step:86.35851824842393 - timing_s/stop_profile:4.29004430770874e-05 - timing_per_token_ms/adv:1.06787655447059e-05 - timing_per_token_ms/gen:0.1172804120624926 - timing_per_token_ms/ref:0.0027342280654779625 - timing_per_token_ms/update_actor:0.012447395432483997 - perf/total_num_tokens:747894 - perf/time_per_step:86.35851824842393 - perf/throughput:1082.5423119358136
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3890624940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3890624940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.032701507210731506, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.643166184425354, 'critic/returns/mean': -0.032701507210731506, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.643166184425354, 'response_length/mean': 1952.268798828125, 'response_length/max': 2048.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.9468749761581421, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  85%|████████▍ | 445/525 [8:05:40<1:56:11, 87.14s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  85%|████████▍ | 446/525 [8:07:06<1:54:31, 86.99s/it]
[36m(TaskRunner pid=2949575)[0m step:445 - global_seqlen/min:87160 - global_seqlen/max:98375 - global_seqlen/minmax_diff:11215 - global_seqlen/balanced_min:93241 - global_seqlen/balanced_max:94687 - global_seqlen/mean:94480.125 - actor/entropy:0.0037867617793381214 - actor/kl_loss:0.35257978141307833 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.010492188483476638 - actor/pg_clipfrac:2.2799817088525742e-05 - actor/ppo_kl:-3.999309265054762e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.08176774717867374 - perf/mfu/actor:0.23089115449086065 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.53768539428711 - actor/lr:1e-06 - training/global_step:445 - training/epoch:12 - critic/score/mean:-0.3890624940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3890624940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.032701507210731506 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.643166184425354 - critic/returns/mean:-0.032701507210731506 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.643166184425354 - response_length/mean:1952.268798828125 - response_length/max:2048.0 - response_length/min:101.0 - response_length/clip_ratio:0.9468749761581421 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.602626621723175e-05 - timing_s/generate_sequences:70.20280456542969 - timing_s/reshard:0.9093033075332642 - timing_s/gen:72.6768679600209 - timing_s/reward:0.24111024290323257 - timing_s/old_log_prob:2.37765384092927 - timing_s/ref:2.038425236940384 - timing_s/adv:0.007666418328881264 - timing_s/update_actor:9.340516656637192 - timing_s/step:86.69614492170513 - timing_s/stop_profile:4.476122558116913e-05 - timing_per_token_ms/adv:1.0142898213885279e-05 - timing_per_token_ms/gen:0.11633398955705525 - timing_per_token_ms/ref:0.002696896882995741 - timing_per_token_ms/update_actor:0.012357779819614431 - perf/total_num_tokens:755841 - perf/time_per_step:86.69614492170513 - perf/throughput:1089.7846159748458
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.47187501192092896, 'critic/score/max': 1.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.47187501192092896, 'critic/rewards/max': 1.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01294606365263462, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.0954437255859375, 'critic/returns/mean': -0.01294606365263462, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.0954437255859375, 'response_length/mean': 2014.481201171875, 'response_length/max': 2048.0, 'response_length/min': 291.0, 'response_length/clip_ratio': 0.9781249761581421, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.471875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:446 - global_seqlen/min:93375 - global_seqlen/max:98340 - global_seqlen/minmax_diff:4965 - global_seqlen/balanced_min:96541 - global_seqlen/balanced_max:98291 - global_seqlen/mean:96951.125 - actor/entropy:0.002216507215052843 - actor/kl_loss:0.35674139857292175 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:6.850180845187626 - perf/mfu/actor:0.23765097637144803 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.55785369873047 - actor/lr:1e-06 - training/global_step:446 - training/epoch:12 - critic/score/mean:-0.47187501192092896 - critic/score/max:1.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.47187501192092896 - critic/rewards/max:1.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01294606365263462 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.0954437255859375 - critic/returns/mean:-0.01294606365263462 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.0954437255859375 - response_length/mean:2014.481201171875 - response_length/max:2048.0 - response_length/min:291.0 - response_length/clip_ratio:0.9781249761581421 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.471875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.056871592998505e-05 - timing_s/generate_sequences:70.31177520751953 - timing_s/reshard:0.8471181392669678 - timing_s/gen:72.48405493609607 - timing_s/reward:0.24497070722281933 - timing_s/old_log_prob:2.387064104899764 - timing_s/ref:2.079923966899514 - timing_s/adv:0.007657729089260101 - timing_s/update_actor:9.317454848438501 - timing_s/step:86.53523973375559 - timing_s/stop_profile:4.165433347225189e-05 - timing_per_token_ms/adv:9.873182349947076e-06 - timing_per_token_ms/gen:0.11244218414805311 - timing_per_token_ms/ref:0.0026816655903935025 - timing_per_token_ms/update_actor:0.012013082427406724 - perf/total_num_tokens:775609 - perf/time_per_step:86.53523973375559 - perf/throughput:1120.365822043033
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.40312498807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.40312498807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.004717202857136726, 'critic/advantages/max': 1.0954431295394897, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.004717202857136726, 'critic/returns/max': 1.0954431295394897, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1973.765625, 'response_length/max': 2048.0, 'response_length/min': 259.0, 'response_length/clip_ratio': 0.956250011920929, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.403125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  85%|████████▌ | 447/525 [8:08:33<1:52:59, 86.92s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  85%|████████▌ | 448/525 [8:10:00<1:51:30, 86.89s/it]
[36m(TaskRunner pid=2949575)[0m step:447 - global_seqlen/min:89653 - global_seqlen/max:98480 - global_seqlen/minmax_diff:8827 - global_seqlen/balanced_min:94942 - global_seqlen/balanced_max:96561 - global_seqlen/mean:95348.75 - actor/entropy:0.0016420878237113357 - actor/kl_loss:0.35561018288135526 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.004630351439118385 - actor/pg_clipfrac:0.0 - actor/ppo_kl:-6.044017573003657e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.04154703486710787 - perf/mfu/actor:0.2324888693827403 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.52692794799805 - actor/lr:1e-06 - training/global_step:447 - training/epoch:12 - critic/score/mean:-0.40312498807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.40312498807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.004717202857136726 - critic/advantages/max:1.0954431295394897 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.004717202857136726 - critic/returns/max:1.0954431295394897 - critic/returns/min:-1.7888528108596802 - response_length/mean:1973.765625 - response_length/max:2048.0 - response_length/min:259.0 - response_length/clip_ratio:0.956250011920929 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.403125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.679181337356567e-05 - timing_s/generate_sequences:70.09701538085938 - timing_s/reshard:0.8148016333580017 - timing_s/gen:72.43489558435977 - timing_s/reward:0.24318000487983227 - timing_s/old_log_prob:2.3789312411099672 - timing_s/ref:2.053092524409294 - timing_s/adv:0.007677309215068817 - timing_s/update_actor:9.365825276821852 - timing_s/step:86.49767161905766 - timing_s/stop_profile:4.137493669986725e-05 - timing_per_token_ms/adv:1.0064774335097231e-05 - timing_per_token_ms/gen:0.11468385396626019 - timing_per_token_ms/ref:0.0026915566858628118 - timing_per_token_ms/update_actor:0.012278379733375965 - perf/total_num_tokens:762790 - perf/time_per_step:86.49767161905766 - perf/throughput:1102.3273599770773
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4703125059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4703125059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': 6.777120142942294e-05, 'critic/advantages/max': 1.0954431295394897, 'critic/advantages/min': -0.7302953004837036, 'critic/returns/mean': 6.777120142942294e-05, 'critic/returns/max': 1.0954431295394897, 'critic/returns/min': -0.7302953004837036, 'response_length/mean': 2020.484375, 'response_length/max': 2048.0, 'response_length/min': 211.0, 'response_length/clip_ratio': 0.984375, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:448 - global_seqlen/min:89465 - global_seqlen/max:98375 - global_seqlen/minmax_diff:8910 - global_seqlen/balanced_min:96468 - global_seqlen/balanced_max:98305 - global_seqlen/mean:97204.375 - actor/entropy:0.002427799394354224 - actor/kl_loss:0.35813944339752196 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.016551946147230545 - perf/mfu/actor:0.23733444691547248 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.43692398071289 - actor/lr:1e-06 - training/global_step:448 - training/epoch:12 - critic/score/mean:-0.4703125059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4703125059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:6.777120142942294e-05 - critic/advantages/max:1.0954431295394897 - critic/advantages/min:-0.7302953004837036 - critic/returns/mean:6.777120142942294e-05 - critic/returns/max:1.0954431295394897 - critic/returns/min:-0.7302953004837036 - response_length/mean:2020.484375 - response_length/max:2048.0 - response_length/min:211.0 - response_length/clip_ratio:0.984375 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.208118379116058e-05 - timing_s/generate_sequences:70.17776489257812 - timing_s/reshard:0.8693023920059204 - timing_s/gen:72.64387638308108 - timing_s/reward:0.24809662997722626 - timing_s/old_log_prob:2.3727731872349977 - timing_s/ref:2.06990903057158 - timing_s/adv:0.007831742987036705 - timing_s/update_actor:9.356661844998598 - timing_s/step:86.71294898539782 - timing_s/stop_profile:4.17809933423996e-05 - timing_per_token_ms/adv:1.0071232631037318e-05 - timing_per_token_ms/gen:0.11235529287234818 - timing_per_token_ms/ref:0.002661800241207739 - timing_per_token_ms/update_actor:0.012032202569326996 - perf/total_num_tokens:777635 - perf/time_per_step:86.71294898539782 - perf/throughput:1120.9903034939903
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.43281251192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.43281251192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.024129658937454224, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.024129658937454224, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1975.293701171875, 'response_length/max': 2048.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.956250011920929, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4328125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  86%|████████▌ | 449/525 [8:11:26<1:49:46, 86.66s/it]
[36m(TaskRunner pid=2949575)[0m step:449 - global_seqlen/min:85916 - global_seqlen/max:98305 - global_seqlen/minmax_diff:12389 - global_seqlen/balanced_min:94986 - global_seqlen/balanced_max:96367 - global_seqlen/mean:95383.625 - actor/entropy:0.0068929195404052734 - actor/kl_loss:0.35628495514392855 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.008052337542176246 - actor/pg_clipfrac:4.6040516463108363e-05 - actor/ppo_kl:-2.9511324828490616e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.08670274696032232 - perf/mfu/actor:0.23119100450362684 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.52659225463867 - actor/lr:1e-06 - training/global_step:449 - training/epoch:12 - critic/score/mean:-0.43281251192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.43281251192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.024129658937454224 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.024129658937454224 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1975.293701171875 - response_length/max:2048.0 - response_length/min:97.0 - response_length/clip_ratio:0.956250011920929 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4328125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.265061140060425e-05 - timing_s/generate_sequences:69.83707427978516 - timing_s/reshard:0.781214714050293 - timing_s/gen:71.97798705659807 - timing_s/reward:0.2420029640197754 - timing_s/old_log_prob:2.374174440279603 - timing_s/ref:2.0615498367697 - timing_s/adv:0.008356183767318726 - timing_s/update_actor:9.420784756541252 - timing_s/step:86.09829486720264 - timing_s/stop_profile:4.711560904979706e-05 - timing_per_token_ms/adv:1.0950757752337895e-05 - timing_per_token_ms/gen:0.11387228332589468 - timing_per_token_ms/ref:0.002701655861749986 - timing_per_token_ms/update_actor:0.01234591466373454 - perf/total_num_tokens:763069 - perf/time_per_step:86.09829486720264 - perf/throughput:1107.84569133592
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 450}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] أوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاع[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 07:53:51,744:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 07:53:56,373:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 07:53:56,376:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:53:52,315:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 07:53:57,549:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/huggingface

[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] -0.5
[36m(TaskRunner pid=2949575)[0m [structure] -0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.0
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.47187501192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.47187501192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.004487747326493263, 'critic/advantages/max': 0.6390091180801392, 'critic/advantages/min': -1.643166184425354, 'critic/returns/mean': -0.004487747326493263, 'critic/returns/max': 0.6390091180801392, 'critic/returns/min': -1.643166184425354, 'response_length/mean': 2025.875, 'response_length/max': 2048.0, 'response_length/min': 241.0, 'response_length/clip_ratio': 0.987500011920929, 'prompt_length/mean': 410.609375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.471875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:450 - global_seqlen/min:91295 - global_seqlen/max:98410 - global_seqlen/minmax_diff:7115 - global_seqlen/balanced_min:96540 - global_seqlen/balanced_max:98347 - global_seqlen/mean:97459.375 - actor/entropy:0.0006400812999345362 - actor/kl_loss:0.3584257498383522 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.008633522157884599 - perf/mfu/actor:0.2332828224035241 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.45055389404297 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:-0.14 - val-aux/grpo_convert/reward/std@50:0.5388877434122992 - val-aux/grpo_convert/reward/best@2/mean:0.11149999999999999 - val-aux/grpo_convert/reward/best@2/std:0.5934582967656615 - val-aux/grpo_convert/reward/worst@2/mean:-0.38325 - val-aux/grpo_convert/reward/worst@2/std:0.343048010488328 - val-aux/grpo_convert/reward/best@4/mean:0.4245 - val-aux/grpo_convert/reward/best@4/std:0.5110525902487922 - val-aux/grpo_convert/reward/worst@4/mean:-0.49175 - val-aux/grpo_convert/reward/worst@4/std:0.08941161837255827 - val-aux/grpo_convert/reward/best@8/mean:0.6665 - val-aux/grpo_convert/reward/best@8/std:0.27573130036323407 - val-aux/grpo_convert/reward/worst@8/mean:-0.5 - val-aux/grpo_convert/reward/worst@8/std:0.0 - val-aux/grpo_convert/reward/best@16/mean:0.74175 - val-aux/grpo_convert/reward/best@16/std:0.08288206983419273 - val-aux/grpo_convert/reward/worst@16/mean:-0.5 - val-aux/grpo_convert/reward/worst@16/std:0.0 - val-aux/grpo_convert/reward/best@32/mean:0.75 - val-aux/grpo_convert/reward/best@32/std:0.0 - val-aux/grpo_convert/reward/worst@32/mean:-0.5 - val-aux/grpo_convert/reward/worst@32/std:0.0 - val-aux/grpo_convert/reward/best@50/mean:0.75 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:-0.14 - val-aux/grpo_convert/score/std@50:0.5388877434122992 - val-aux/grpo_convert/score/best@2/mean:0.11149999999999999 - val-aux/grpo_convert/score/best@2/std:0.5934582967656615 - val-aux/grpo_convert/score/worst@2/mean:-0.38325 - val-aux/grpo_convert/score/worst@2/std:0.343048010488328 - val-aux/grpo_convert/score/best@4/mean:0.4245 - val-aux/grpo_convert/score/best@4/std:0.5110525902487922 - val-aux/grpo_convert/score/worst@4/mean:-0.49175 - val-aux/grpo_convert/score/worst@4/std:0.08941161837255827 - val-aux/grpo_convert/score/best@8/mean:0.6665 - val-aux/grpo_convert/score/best@8/std:0.27573130036323407 - val-aux/grpo_convert/score/worst@8/mean:-0.5 - val-aux/grpo_convert/score/worst@8/std:0.0 - val-aux/grpo_convert/score/best@16/mean:0.74175 - val-aux/grpo_convert/score/best@16/std:0.08288206983419273 - val-aux/grpo_convert/score/worst@16/mean:-0.5 - val-aux/grpo_convert/score/worst@16/std:0.0 - val-aux/grpo_convert/score/best@32/mean:0.75 - val-aux/grpo_convert/score/best@32/std:0.0 - val-aux/grpo_convert/score/worst@32/mean:-0.5 - val-aux/grpo_convert/score/worst@32/std:0.0 - val-aux/grpo_convert/score/best@50/mean:0.75 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:-0.33999999999999997 - val-aux/grpo_convert/structure/std@50:0.23323807579381203 - val-aux/grpo_convert/structure/best@2/mean:-0.235 - val-aux/grpo_convert/structure/best@2/std:0.24954959426935558 - val-aux/grpo_convert/structure/worst@2/mean:-0.4455 - val-aux/grpo_convert/structure/worst@2/std:0.15581960723862706 - val-aux/grpo_convert/structure/best@4/mean:-0.10900000000000001 - val-aux/grpo_convert/structure/best@4/std:0.20644369692485168 - val-aux/grpo_convert/structure/worst@4/mean:-0.4955 - val-aux/grpo_convert/structure/worst@4/std:0.04722022871609158 - val-aux/grpo_convert/structure/best@8/mean:-0.021999999999999992 - val-aux/grpo_convert/structure/best@8/std:0.10254754994635416 - val-aux/grpo_convert/structure/worst@8/mean:-0.5 - val-aux/grpo_convert/structure/worst@8/std:0.0 - val-aux/grpo_convert/structure/best@16/mean:-0.0015000000000000013 - val-aux/grpo_convert/structure/best@16/std:0.02734501782775064 - val-aux/grpo_convert/structure/worst@16/mean:-0.5 - val-aux/grpo_convert/structure/worst@16/std:0.0 - val-aux/grpo_convert/structure/best@32/mean:0.0 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.5 - val-aux/grpo_convert/structure/worst@32/std:0.0 - val-aux/grpo_convert/structure/best@50/mean:0.0 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.08 - val-aux/grpo_convert/boxed/std@50:0.11661903789690602 - val-aux/grpo_convert/boxed/best@2/mean:0.1325 - val-aux/grpo_convert/boxed/best@2/std:0.12477479713467779 - val-aux/grpo_convert/boxed/worst@2/mean:0.02725 - val-aux/grpo_convert/boxed/worst@2/std:0.07790980361931353 - val-aux/grpo_convert/boxed/best@4/mean:0.1955 - val-aux/grpo_convert/boxed/best@4/std:0.10322184846242582 - val-aux/grpo_convert/boxed/worst@4/mean:0.00225 - val-aux/grpo_convert/boxed/worst@4/std:0.02361011435804579 - val-aux/grpo_convert/boxed/best@8/mean:0.239 - val-aux/grpo_convert/boxed/best@8/std:0.05127377497317708 - val-aux/grpo_convert/boxed/worst@8/mean:0.0 - val-aux/grpo_convert/boxed/worst@8/std:0.0 - val-aux/grpo_convert/boxed/best@16/mean:0.24925 - val-aux/grpo_convert/boxed/best@16/std:0.01367250891387532 - val-aux/grpo_convert/boxed/worst@16/mean:0.0 - val-aux/grpo_convert/boxed/worst@16/std:0.0 - val-aux/grpo_convert/boxed/best@32/mean:0.25 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.0 - val-aux/grpo_convert/boxed/worst@32/std:0.0 - val-aux/grpo_convert/boxed/best@50/mean:0.25 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.12 - val-aux/grpo_convert/correct/std@50:0.21354156504062624 - val-aux/grpo_convert/correct/best@2/mean:0.214 - val-aux/grpo_convert/correct/best@2/std:0.24739442192579847 - val-aux/grpo_convert/correct/worst@2/mean:0.035 - val-aux/grpo_convert/correct/worst@2/std:0.12757350822173072 - val-aux/grpo_convert/correct/best@4/mean:0.338 - val-aux/grpo_convert/correct/best@4/std:0.23400000000000004 - val-aux/grpo_convert/correct/worst@4/mean:0.0015 - val-aux/grpo_convert/correct/worst@4/std:0.027345017827750638 - val-aux/grpo_convert/correct/best@8/mean:0.4495 - val-aux/grpo_convert/correct/best@8/std:0.15066436207676984 - val-aux/grpo_convert/correct/worst@8/mean:0.0 - val-aux/grpo_convert/correct/worst@8/std:0.0 - val-aux/grpo_convert/correct/best@16/mean:0.494 - val-aux/grpo_convert/correct/best@16/std:0.05444263035526481 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.5 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.5 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.12 - val-aux/grpo_convert/acc/std@50:0.21354156504062624 - val-aux/grpo_convert/acc/best@2/mean:0.214 - val-aux/grpo_convert/acc/best@2/std:0.24739442192579847 - val-aux/grpo_convert/acc/worst@2/mean:0.035 - val-aux/grpo_convert/acc/worst@2/std:0.12757350822173072 - val-aux/grpo_convert/acc/best@4/mean:0.338 - val-aux/grpo_convert/acc/best@4/std:0.23400000000000004 - val-aux/grpo_convert/acc/worst@4/mean:0.0015 - val-aux/grpo_convert/acc/worst@4/std:0.027345017827750638 - val-aux/grpo_convert/acc/best@8/mean:0.4495 - val-aux/grpo_convert/acc/best@8/std:0.15066436207676984 - val-aux/grpo_convert/acc/worst@8/mean:0.0 - val-aux/grpo_convert/acc/worst@8/std:0.0 - val-aux/grpo_convert/acc/best@16/mean:0.494 - val-aux/grpo_convert/acc/best@16/std:0.05444263035526481 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.5 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.5 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:450 - training/epoch:12 - critic/score/mean:-0.47187501192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.47187501192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.004487747326493263 - critic/advantages/max:0.6390091180801392 - critic/advantages/min:-1.643166184425354 - critic/returns/mean:-0.004487747326493263 - critic/returns/max:0.6390091180801392 - critic/returns/min:-1.643166184425354 - response_length/mean:2025.875 - response_length/max:2048.0 - response_length/min:241.0 - response_length/clip_ratio:0.987500011920929 - prompt_length/mean:410.609375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.471875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010980665683746338 - timing_s/generate_sequences:69.41423797607422 - timing_s/reshard:0.9238919019699097 - timing_s/gen:72.09104774706066 - timing_s/reward:0.2484470997005701 - timing_s/old_log_prob:2.4313102159649134 - timing_s/ref:2.0586951412260532 - timing_s/adv:0.008258134126663208 - timing_s/update_actor:9.5476831831038 - timing_s/testing:69.15679848752916 - timing_s/save_checkpoint:10.623264020308852 - timing_s/step:166.1852948088199 - timing_s/stop_profile:5.08967787027359e-05 - timing_per_token_ms/adv:1.0591764679723227e-05 - timing_per_token_ms/gen:0.11120356597004483 - timing_per_token_ms/ref:0.0026404529338840584 - timing_per_token_ms/update_actor:0.0122457218496217 - perf/total_num_tokens:779675 - perf/time_per_step:166.1852948088199 - perf/throughput:586.4500533101776[36m(TaskRunner pid=2949575)[0m Training Progress:  86%|████████▌ | 450/525 [8:14:12<2:18:11, 110.56s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  86%|████████▌ | 451/525 [8:15:39<2:07:22, 103.28s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:53:58,883:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 07:53:58,885:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_450/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  86%|████████▌ | 452/525 [8:17:04<1:59:10, 97.95s/it] 

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4921875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4921875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0048691267147660255, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -0.44721320271492004, 'critic/returns/mean': -0.0048691267147660255, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -0.44721320271492004, 'response_length/mean': 2042.440673828125, 'response_length/max': 2048.0, 'response_length/min': 269.0, 'response_length/clip_ratio': 0.996874988079071, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:451 - global_seqlen/min:96526 - global_seqlen/max:98375 - global_seqlen/minmax_diff:1849 - global_seqlen/balanced_min:96547 - global_seqlen/balanced_max:98326 - global_seqlen/mean:98100.125 - actor/entropy:0.0001263213052880019 - actor/kl_loss:0.3577941179275513 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.011180330067873001 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.023508856526358812 - perf/mfu/actor:0.23847747220634502 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.41093444824219 - actor/lr:1e-06 - training/global_step:451 - training/epoch:12 - critic/score/mean:-0.4921875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4921875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0048691267147660255 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-0.44721320271492004 - critic/returns/mean:-0.0048691267147660255 - critic/returns/max:1.7888528108596802 - critic/returns/min:-0.44721320271492004 - response_length/mean:2042.440673828125 - response_length/max:2048.0 - response_length/min:269.0 - response_length/clip_ratio:0.996874988079071 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.837878704071045e-05 - timing_s/generate_sequences:70.04247283935547 - timing_s/reshard:0.5975209474563599 - timing_s/gen:72.06578765250742 - timing_s/reward:0.2502185422927141 - timing_s/old_log_prob:2.438209656625986 - timing_s/ref:2.0983743723481894 - timing_s/adv:0.008442653343081474 - timing_s/update_actor:9.399444917216897 - timing_s/step:86.28139253892004 - timing_s/stop_profile:4.4558197259902954e-05 - timing_per_token_ms/adv:1.075769952265794e-05 - timing_per_token_ms/gen:0.11026297834929018 - timing_per_token_ms/ref:0.0026737661806600518 - timing_per_token_ms/update_actor:0.011976851351128371 - perf/total_num_tokens:784801 - perf/time_per_step:86.28139253892004 - perf/throughput:1136.9789257370728
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.27812498807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.27812498807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0043967668898403645, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.0043967668898403645, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1868.090576171875, 'response_length/max': 2048.0, 'response_length/min': 214.0, 'response_length/clip_ratio': 0.893750011920929, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.278125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:452 - global_seqlen/min:81203 - global_seqlen/max:98340 - global_seqlen/minmax_diff:17137 - global_seqlen/balanced_min:90132 - global_seqlen/balanced_max:91446 - global_seqlen/mean:91113.0 - actor/entropy:0.006063548848032951 - actor/kl_loss:0.3495370835065842 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.011000541038811207 - actor/pg_clipfrac:8.255566644947976e-05 - actor/ppo_kl:-8.036248545977287e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.15052376501262188 - perf/mfu/actor:0.2223179027750733 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.35255432128906 - actor/lr:1e-06 - training/global_step:452 - training/epoch:12 - critic/score/mean:-0.27812498807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.27812498807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0043967668898403645 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.0043967668898403645 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1868.090576171875 - response_length/max:2048.0 - response_length/min:214.0 - response_length/clip_ratio:0.893750011920929 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.278125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.344464004039764e-05 - timing_s/generate_sequences:69.19833374023438 - timing_s/reshard:0.9257533550262451 - timing_s/gen:71.48732378333807 - timing_s/reward:0.23304512538015842 - timing_s/old_log_prob:2.3737571742385626 - timing_s/ref:2.0432880390435457 - timing_s/adv:0.008003763854503632 - timing_s/update_actor:9.344107521697879 - timing_s/step:85.50633771531284 - timing_s/stop_profile:4.44166362285614e-05 - timing_per_token_ms/adv:1.098054593540937e-05 - timing_per_token_ms/gen:0.11958621484058433 - timing_per_token_ms/ref:0.00280323340116606 - timing_per_token_ms/update_actor:0.012819393941723298 - perf/total_num_tokens:728904 - perf/time_per_step:85.50633771531284 - perf/throughput:1065.570137073981
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  86%|████████▋ | 453/525 [8:18:29<1:52:59, 94.16s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  86%|████████▋ | 454/525 [8:19:56<1:48:36, 91.78s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.375, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.375, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.013944952748715878, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.013944952748715878, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1958.5687255859375, 'response_length/max': 2048.0, 'response_length/min': 120.0, 'response_length/clip_ratio': 0.949999988079071, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:453 - global_seqlen/min:88873 - global_seqlen/max:98375 - global_seqlen/minmax_diff:9502 - global_seqlen/balanced_min:94603 - global_seqlen/balanced_max:95044 - global_seqlen/mean:94727.75 - actor/entropy:0.0032497227657586336 - actor/kl_loss:0.35291929841041564 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.004597910493612289 - actor/pg_clipfrac:1.8096272833645342e-05 - actor/ppo_kl:-8.171038061846047e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.8221134312625509 - perf/mfu/actor:0.23251081408926635 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.43442916870117 - actor/lr:1e-06 - training/global_step:453 - training/epoch:12 - critic/score/mean:-0.375 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.375 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.013944952748715878 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.013944952748715878 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1958.5687255859375 - response_length/max:2048.0 - response_length/min:120.0 - response_length/clip_ratio:0.949999988079071 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.454041719436646e-05 - timing_s/generate_sequences:68.83393859863281 - timing_s/reshard:0.878014326095581 - timing_s/gen:71.21066433377564 - timing_s/reward:0.24249211326241493 - timing_s/old_log_prob:2.4037756361067295 - timing_s/ref:2.042206771671772 - timing_s/adv:0.008126908913254738 - timing_s/update_actor:9.300147630274296 - timing_s/step:85.22249107435346 - timing_s/stop_profile:4.69014048576355e-05 - timing_per_token_ms/adv:1.0724034025476614e-05 - timing_per_token_ms/gen:0.11362038021031882 - timing_per_token_ms/ref:0.0026948370087854032 - timing_per_token_ms/update_actor:0.012272205914151735 - perf/total_num_tokens:757822 - perf/time_per_step:85.22249107435346 - perf/throughput:1111.53462901423
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3921875059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3921875059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.01811181753873825, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.01811181753873825, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1964.515625, 'response_length/max': 2048.0, 'response_length/min': 225.0, 'response_length/clip_ratio': 0.949999988079071, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:454 - global_seqlen/min:90001 - global_seqlen/max:98410 - global_seqlen/minmax_diff:8409 - global_seqlen/balanced_min:94926 - global_seqlen/balanced_max:94972 - global_seqlen/mean:94952.5 - actor/entropy:0.0037165756803005934 - actor/kl_loss:0.3542981430888176 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.012077100574970245 - actor/pg_clipfrac:6.070417002774775e-05 - actor/ppo_kl:0.000304124690592289 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.918267147615552 - perf/mfu/actor:0.23333410161096121 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.38631439208984 - actor/lr:1e-06 - training/global_step:454 - training/epoch:12 - critic/score/mean:-0.3921875059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3921875059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.01811181753873825 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.01811181753873825 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1964.515625 - response_length/max:2048.0 - response_length/min:225.0 - response_length/clip_ratio:0.949999988079071 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.71127301454544e-05 - timing_s/generate_sequences:69.62450408935547 - timing_s/reshard:0.8799275755882263 - timing_s/gen:72.04226354882121 - timing_s/reward:0.24216174334287643 - timing_s/old_log_prob:2.3701581209897995 - timing_s/ref:2.1281497683376074 - timing_s/adv:0.0078055597841739655 - timing_s/update_actor:9.288571679964662 - timing_s/step:86.09371872805059 - timing_s/stop_profile:4.425458610057831e-05 - timing_per_token_ms/adv:1.0275611205831817e-05 - timing_per_token_ms/gen:0.11459927868482404 - timing_per_token_ms/ref:0.002801597862533382 - timing_per_token_ms/update_actor:0.012227918801459495 - perf/total_num_tokens:759620 - perf/time_per_step:86.09371872805059 - perf/throughput:1102.8969523308915
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3890624940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3890624940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03687829524278641, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.03687829524278641, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1940.878173828125, 'response_length/max': 2048.0, 'response_length/min': 112.0, 'response_length/clip_ratio': 0.9375, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  87%|████████▋ | 455/525 [8:21:22<1:45:04, 90.07s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  87%|████████▋ | 456/525 [8:22:50<1:43:06, 89.66s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:455 - global_seqlen/min:84954 - global_seqlen/max:98375 - global_seqlen/minmax_diff:13421 - global_seqlen/balanced_min:93284 - global_seqlen/balanced_max:94740 - global_seqlen/mean:94024.5 - actor/entropy:0.004684919957071543 - actor/kl_loss:0.34725131988525393 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03264801055192947 - actor/pg_clipfrac:0.0005649717524647713 - actor/ppo_kl:-0.00017196418484672905 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.1300421799940108 - perf/mfu/actor:0.23100934739749546 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.36802291870117 - actor/lr:1e-06 - training/global_step:455 - training/epoch:12 - critic/score/mean:-0.3890624940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3890624940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03687829524278641 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.03687829524278641 - critic/returns/max:1.4768644571304321 - critic/returns/min:-1.7888517379760742 - response_length/mean:1940.878173828125 - response_length/max:2048.0 - response_length/min:112.0 - response_length/clip_ratio:0.9375 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.812973439693451e-05 - timing_s/generate_sequences:69.24524688720703 - timing_s/reshard:0.6750854253768921 - timing_s/gen:72.0044020768255 - timing_s/reward:0.24294584430754185 - timing_s/old_log_prob:2.3777239210903645 - timing_s/ref:2.046331314370036 - timing_s/adv:0.007863454520702362 - timing_s/update_actor:9.287940427660942 - timing_s/step:85.98204288259149 - timing_s/stop_profile:4.6504661440849304e-05 - timing_per_token_ms/adv:1.0453996725191789e-05 - timing_per_token_ms/gen:0.11593399585050179 - timing_per_token_ms/ref:0.0027204761981850954 - timing_per_token_ms/update_actor:0.012347766310457569 - perf/total_num_tokens:752196 - perf/time_per_step:85.98204288259149 - perf/throughput:1093.536473986673
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4296875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4296875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.009662818163633347, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.009662818163633347, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1986.9781494140625, 'response_length/max': 2048.0, 'response_length/min': 140.0, 'response_length/clip_ratio': 0.965624988079071, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:456 - global_seqlen/min:88936 - global_seqlen/max:98375 - global_seqlen/minmax_diff:9439 - global_seqlen/balanced_min:94931 - global_seqlen/balanced_max:96488 - global_seqlen/mean:95881.625 - actor/entropy:0.002831965684890747 - actor/kl_loss:0.35644389390945436 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.005871244519948959 - actor/pg_clipfrac:0.0 - actor/ppo_kl:1.9734405213966966e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.04783415873182184 - perf/mfu/actor:0.23386494315984618 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.12508010864258 - actor/lr:1e-06 - training/global_step:456 - training/epoch:13 - critic/score/mean:-0.4296875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4296875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.009662818163633347 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.009662818163633347 - critic/returns/max:1.4768644571304321 - critic/returns/min:-1.78885018825531 - response_length/mean:1986.9781494140625 - response_length/max:2048.0 - response_length/min:140.0 - response_length/clip_ratio:0.965624988079071 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00039517879486083984 - timing_s/generate_sequences:69.58863830566406 - timing_s/reshard:0.8818051218986511 - timing_s/gen:72.3110954258591 - timing_s/reward:0.24281041510403156 - timing_s/old_log_prob:2.3905511535704136 - timing_s/ref:2.0696974117308855 - timing_s/adv:0.009882060810923576 - timing_s/update_actor:9.36696632578969 - timing_s/step:86.42540976405144 - timing_s/stop_profile:4.3565407395362854e-05 - timing_per_token_ms/adv:1.288315254737753e-05 - timing_per_token_ms/gen:0.11372655308211291 - timing_per_token_ms/ref:0.002698245638477244 - timing_per_token_ms/update_actor:0.012211628565157414 - perf/total_num_tokens:767053 - perf/time_per_step:86.42540976405144 - perf/throughput:1109.4147573238567
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.26249998807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.26249998807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05697370693087578, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05697370693087578, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1852.0062255859375, 'response_length/max': 2048.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.8812500238418579, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  87%|████████▋ | 457/525 [8:24:16<1:40:19, 88.53s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  87%|████████▋ | 458/525 [8:25:41<1:37:43, 87.51s/it]
[36m(TaskRunner pid=2949575)[0m step:457 - global_seqlen/min:82873 - global_seqlen/max:98340 - global_seqlen/minmax_diff:15467 - global_seqlen/balanced_min:90144 - global_seqlen/balanced_max:91379 - global_seqlen/mean:90452.125 - actor/entropy:0.010230613872408867 - actor/kl_loss:0.34518505483865736 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0040939684957265856 - actor/pg_clipfrac:0.00014713883283548057 - actor/ppo_kl:-0.00010180056706303731 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:6.919496759772301 - perf/mfu/actor:0.22146679115574758 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.13380813598633 - actor/lr:1e-06 - training/global_step:457 - training/epoch:13 - critic/score/mean:-0.26249998807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.26249998807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05697370693087578 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05697370693087578 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1852.0062255859375 - response_length/max:2048.0 - response_length/min:76.0 - response_length/clip_ratio:0.8812500238418579 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.548850357532501e-05 - timing_s/generate_sequences:69.35418701171875 - timing_s/reshard:0.9283826947212219 - timing_s/gen:71.78159335441887 - timing_s/reward:0.22824102267622948 - timing_s/old_log_prob:2.363966442644596 - timing_s/ref:2.0300517193973064 - timing_s/adv:0.00751398503780365 - timing_s/update_actor:9.308154357597232 - timing_s/step:85.732645008713 - timing_s/stop_profile:4.4129788875579834e-05 - timing_per_token_ms/adv:1.0383925526630316e-05 - timing_per_token_ms/gen:0.12112134029383485 - timing_per_token_ms/ref:0.0028054229231724882 - timing_per_token_ms/update_actor:0.012863371586899191 - perf/total_num_tokens:723617 - perf/time_per_step:85.732645008713 - perf/throughput:1055.048808896627
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2906250059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2906250059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03664145618677139, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.03664145618677139, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1875.112548828125, 'response_length/max': 2048.0, 'response_length/min': 125.0, 'response_length/clip_ratio': 0.8999999761581421, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.290625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:458 - global_seqlen/min:80375 - global_seqlen/max:98270 - global_seqlen/minmax_diff:17895 - global_seqlen/balanced_min:91296 - global_seqlen/balanced_max:91505 - global_seqlen/mean:91372.0 - actor/entropy:0.008057243190705776 - actor/kl_loss:0.3500121206045151 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0038842814043164252 - actor/pg_clipfrac:3.532320843078196e-05 - actor/ppo_kl:0.0003122273214103188 - actor/pg_clipfrac_lower:1.766160421539098e-05 - actor/grad_norm:0.20705273002386093 - perf/mfu/actor:0.22465162965934368 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.11602020263672 - actor/lr:1e-06 - training/global_step:458 - training/epoch:13 - critic/score/mean:-0.2906250059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2906250059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03664145618677139 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.03664145618677139 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:1875.112548828125 - response_length/max:2048.0 - response_length/min:125.0 - response_length/clip_ratio:0.8999999761581421 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.290625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010968372225761414 - timing_s/generate_sequences:69.27302551269531 - timing_s/reshard:0.8800761699676514 - timing_s/gen:71.26884816028178 - timing_s/reward:0.23250829800963402 - timing_s/old_log_prob:2.3273555729538202 - timing_s/ref:2.00934692658484 - timing_s/adv:0.007599921897053719 - timing_s/update_actor:9.275083381682634 - timing_s/step:85.13412072882056 - timing_s/stop_profile:4.608184099197388e-05 - timing_per_token_ms/adv:1.039695133226497e-05 - timing_per_token_ms/gen:0.11877428714324104 - timing_per_token_ms/ref:0.0027488548551318237 - timing_per_token_ms/update_actor:0.0126886291501809 - perf/total_num_tokens:730976 - perf/time_per_step:85.13412072882056 - perf/throughput:1073.2712009917748
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.21718749403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.21718749403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04866631329059601, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.04866631329059601, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1813.0531005859375, 'response_length/max': 2048.0, 'response_length/min': 132.0, 'response_length/clip_ratio': 0.862500011920929, 'prompt_length/mean': 408.53125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2171875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  87%|████████▋ | 459/525 [8:27:07<1:35:41, 86.99s/it]
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 08:08:23,098:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 08:08:27,631:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 08:08:27,633:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:08:23,579:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/model_world_size_8_rank_0.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:08:28,928:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  88%|████████▊ | 460/525 [8:28:43<1:37:09, 89.68s/it]
[36m(TaskRunner pid=2949575)[0m step:459 - global_seqlen/min:73308 - global_seqlen/max:98270 - global_seqlen/minmax_diff:24962 - global_seqlen/balanced_min:88261 - global_seqlen/balanced_max:89455 - global_seqlen/mean:88863.375 - actor/entropy:0.01249730121344328 - actor/kl_loss:0.3488078758120537 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.01138951200991869 - actor/pg_clipfrac:0.00010594090563245117 - actor/ppo_kl:0.0004158810479566455 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:24.68197237327695 - perf/mfu/actor:0.2136361473859822 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.04349136352539 - actor/lr:1e-06 - training/global_step:459 - training/epoch:13 - critic/score/mean:-0.21718749403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.21718749403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04866631329059601 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.04866631329059601 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1813.0531005859375 - response_length/max:2048.0 - response_length/min:132.0 - response_length/clip_ratio:0.862500011920929 - prompt_length/mean:408.53125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2171875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.485334157943726e-05 - timing_s/generate_sequences:69.04834747314453 - timing_s/reshard:0.7802754640579224 - timing_s/gen:71.51994574069977 - timing_s/reward:0.22478406876325607 - timing_s/old_log_prob:2.3743945844471455 - timing_s/ref:2.0181812532246113 - timing_s/adv:0.007458914071321487 - timing_s/update_actor:9.474629189819098 - timing_s/step:85.63283164426684 - timing_s/stop_profile:4.555657505989075e-05 - timing_per_token_ms/adv:1.0492109476093901e-05 - timing_per_token_ms/gen:0.12327263187044603 - timing_per_token_ms/ref:0.0028388822352637 - timing_per_token_ms/update_actor:0.013327522713687019 - perf/total_num_tokens:710907 - perf/time_per_step:85.63283164426684 - perf/throughput:1037.7255229530815
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.421875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.421875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.015245125629007816, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.0954443216323853, 'critic/returns/mean': -0.015245125629007816, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.0954443216323853, 'response_length/mean': 1987.015625, 'response_length/max': 2048.0, 'response_length/min': 175.0, 'response_length/clip_ratio': 0.9624999761581421, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:460 - global_seqlen/min:90410 - global_seqlen/max:98340 - global_seqlen/minmax_diff:7930 - global_seqlen/balanced_min:95159 - global_seqlen/balanced_max:96618 - global_seqlen/mean:95865.625 - actor/entropy:0.003787920344620943 - actor/kl_loss:0.35542211830616 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.013413290679454803 - actor/pg_clipfrac:4.151100001763553e-05 - actor/ppo_kl:-1.6390609744121321e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.0953004521456915 - perf/mfu/actor:0.23529442599725303 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.07291793823242 - actor/lr:1e-06 - training/global_step:460 - training/epoch:13 - critic/score/mean:-0.421875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.421875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.015245125629007816 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.0954443216323853 - critic/returns/mean:-0.015245125629007816 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.0954443216323853 - response_length/mean:1987.015625 - response_length/max:2048.0 - response_length/min:175.0 - response_length/clip_ratio:0.9624999761581421 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.392706513404846e-05 - timing_s/generate_sequences:69.72789001464844 - timing_s/reshard:0.8879291415214539 - timing_s/gen:71.97941505350173 - timing_s/reward:0.24390155263245106 - timing_s/old_log_prob:2.3863496500998735 - timing_s/ref:2.0466978680342436 - timing_s/adv:0.007610896602272987 - timing_s/update_actor:9.304398139938712 - timing_s/save_checkpoint:9.968858152627945 - timing_s/step:95.95067374967039 - timing_s/stop_profile:5.218200385570526e-05 - timing_per_token_ms/adv:9.923912510705725e-06 - timing_per_token_ms/gen:0.11320276962703446 - timing_per_token_ms/ref:0.0026687066767079486 - timing_per_token_ms/update_actor:0.012132083502218225 - perf/total_num_tokens:766925 - perf/time_per_step:95.95067374967039 - perf/throughput:999.1136200888774
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4046874940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4046874940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.008153009228408337, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.008153009228408337, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1971.828125, 'response_length/max': 2048.0, 'response_length/min': 176.0, 'response_length/clip_ratio': 0.953125, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4046875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  88%|████████▊ | 461/525 [8:30:09<1:34:28, 88.58s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:08:29,787:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:08:29,789:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_460/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  88%|████████▊ | 462/525 [8:31:35<1:32:06, 87.72s/it]
[36m(TaskRunner pid=2949575)[0m step:461 - global_seqlen/min:89491 - global_seqlen/max:98410 - global_seqlen/minmax_diff:8919 - global_seqlen/balanced_min:94973 - global_seqlen/balanced_max:96426 - global_seqlen/mean:95253.75 - actor/entropy:0.002977663418278098 - actor/kl_loss:0.35620943307876585 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.015540079027414323 - actor/pg_clipfrac:2.2482014901470394e-05 - actor/ppo_kl:-1.4788727276027202e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.10763015380275753 - perf/mfu/actor:0.23056883474316417 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.07164001464844 - actor/lr:1e-06 - training/global_step:461 - training/epoch:13 - critic/score/mean:-0.4046874940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4046874940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.008153009228408337 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.008153009228408337 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:1971.828125 - response_length/max:2048.0 - response_length/min:176.0 - response_length/clip_ratio:0.953125 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4046875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.932873606681824e-05 - timing_s/generate_sequences:69.56600189208984 - timing_s/reshard:0.7968623638153076 - timing_s/gen:71.86116395890713 - timing_s/reward:0.2423356380313635 - timing_s/old_log_prob:2.3790680952370167 - timing_s/ref:2.048988312482834 - timing_s/adv:0.007640896365046501 - timing_s/update_actor:9.429397415369749 - timing_s/step:85.98558880575001 - timing_s/stop_profile:4.4735148549079895e-05 - timing_per_token_ms/adv:1.0027028286348963e-05 - timing_per_token_ms/gen:0.11388727776239868 - timing_per_token_ms/ref:0.002688855179563579 - timing_per_token_ms/update_actor:0.012374050123183798 - perf/total_num_tokens:762030 - perf/time_per_step:85.98558880575001 - perf/throughput:1107.787378361596
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2906250059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2906250059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.018991395831108093, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.018991395831108093, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1877.856201171875, 'response_length/max': 2048.0, 'response_length/min': 111.0, 'response_length/clip_ratio': 0.903124988079071, 'prompt_length/mean': 408.859375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.290625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:462 - global_seqlen/min:85158 - global_seqlen/max:98270 - global_seqlen/minmax_diff:13112 - global_seqlen/balanced_min:91233 - global_seqlen/balanced_max:92679 - global_seqlen/mean:91468.625 - actor/entropy:0.006457561161369085 - actor/kl_loss:0.3535818666219711 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08710965160280466 - actor/pg_clipfrac:2.3158869589678942e-05 - actor/ppo_kl:-5.567094776779413e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.24142597988247871 - perf/mfu/actor:0.22313102283072334 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.0672378540039 - actor/lr:1e-06 - training/global_step:462 - training/epoch:13 - critic/score/mean:-0.2906250059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2906250059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.018991395831108093 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.018991395831108093 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1877.856201171875 - response_length/max:2048.0 - response_length/min:111.0 - response_length/clip_ratio:0.903124988079071 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.290625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.276104927062988e-05 - timing_s/generate_sequences:69.39612579345703 - timing_s/reshard:0.897628903388977 - timing_s/gen:71.66569529101253 - timing_s/reward:0.23566939122974873 - timing_s/old_log_prob:2.409634690731764 - timing_s/ref:2.037173854187131 - timing_s/adv:0.007767857983708382 - timing_s/update_actor:9.347120933234692 - timing_s/step:85.71647826395929 - timing_s/stop_profile:4.457123577594757e-05 - timing_per_token_ms/adv:1.0615467849916271e-05 - timing_per_token_ms/gen:0.11926115099833341 - timing_per_token_ms/ref:0.0027839790067183297 - timing_per_token_ms/update_actor:0.012773670935299797 - perf/total_num_tokens:731749 - perf/time_per_step:85.71647826395929 - perf/throughput:1067.1066620157594
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.042717911303043365, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.042717911303043365, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1904.190673828125, 'response_length/max': 2048.0, 'response_length/min': 86.0, 'response_length/clip_ratio': 0.918749988079071, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  88%|████████▊ | 463/525 [8:33:02<1:30:18, 87.40s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  88%|████████▊ | 464/525 [8:34:28<1:28:42, 87.25s/it]
[36m(TaskRunner pid=2949575)[0m step:463 - global_seqlen/min:74601 - global_seqlen/max:98375 - global_seqlen/minmax_diff:23774 - global_seqlen/balanced_min:91624 - global_seqlen/balanced_max:92910 - global_seqlen/mean:92570.125 - actor/entropy:0.005094082094728947 - actor/kl_loss:0.34785562604665754 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0013158299028873444 - actor/pg_clipfrac:4.0032024844549594e-05 - actor/ppo_kl:-3.261497477069497e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.4672790340036599 - perf/mfu/actor:0.2263043352177189 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.05572128295898 - actor/lr:1e-06 - training/global_step:463 - training/epoch:13 - critic/score/mean:-0.3125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.042717911303043365 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.042717911303043365 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1904.190673828125 - response_length/max:2048.0 - response_length/min:86.0 - response_length/clip_ratio:0.918749988079071 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.401274681091309e-05 - timing_s/generate_sequences:69.42908477783203 - timing_s/reshard:0.9305294752120972 - timing_s/gen:72.62673400714993 - timing_s/reward:0.23611929826438427 - timing_s/old_log_prob:2.3751307614147663 - timing_s/ref:2.0364952832460403 - timing_s/adv:0.008855082094669342 - timing_s/update_actor:9.33120103366673 - timing_s/step:86.62811418063939 - timing_s/stop_profile:4.60892915725708e-05 - timing_per_token_ms/adv:1.1957262257490392e-05 - timing_per_token_ms/gen:0.11918898286370018 - timing_per_token_ms/ref:0.00274993590432934 - timing_per_token_ms/update_actor:0.012600178828842904 - perf/total_num_tokens:740561 - perf/time_per_step:86.62811418063939 - perf/throughput:1068.5921755952133
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2828125059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2828125059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04535657912492752, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.04535657912492752, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1853.578125, 'response_length/max': 2048.0, 'response_length/min': 116.0, 'response_length/clip_ratio': 0.890625, 'prompt_length/mean': 408.640625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2828125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:464 - global_seqlen/min:80369 - global_seqlen/max:98235 - global_seqlen/minmax_diff:17866 - global_seqlen/balanced_min:89621 - global_seqlen/balanced_max:90993 - global_seqlen/mean:90488.75 - actor/entropy:0.009319357573986053 - actor/kl_loss:0.35123311132192614 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0030541051179170608 - actor/pg_clipfrac:4.275543324183673e-05 - actor/ppo_kl:-2.3031275486573576e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.3847638536244631 - perf/mfu/actor:0.22186191473204633 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.17927551269531 - actor/lr:1e-06 - training/global_step:464 - training/epoch:13 - critic/score/mean:-0.2828125059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2828125059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04535657912492752 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.04535657912492752 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1853.578125 - response_length/max:2048.0 - response_length/min:116.0 - response_length/clip_ratio:0.890625 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2828125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.7714364528656e-05 - timing_s/generate_sequences:69.14508056640625 - timing_s/reshard:0.9354907870292664 - timing_s/gen:72.35060751251876 - timing_s/reward:0.23016342148184776 - timing_s/old_log_prob:2.3846510592848063 - timing_s/ref:2.0366541538387537 - timing_s/adv:0.007637837901711464 - timing_s/update_actor:9.3002820443362 - timing_s/step:86.32333894260228 - timing_s/stop_profile:4.631653428077698e-05 - timing_per_token_ms/adv:1.0550811429199022e-05 - timing_per_token_ms/gen:0.12197794386283078 - timing_per_token_ms/ref:0.002813407956567465 - timing_per_token_ms/update_actor:0.012847290470274206 - perf/total_num_tokens:723910 - perf/time_per_step:86.32333894260228 - perf/throughput:1048.2535906096887
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.37187498807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.37187498807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.017086438834667206, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.017086438834667206, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1947.231201171875, 'response_length/max': 2048.0, 'response_length/min': 149.0, 'response_length/clip_ratio': 0.9437500238418579, 'prompt_length/mean': 410.390625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.371875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  89%|████████▊ | 465/525 [8:35:54<1:26:49, 86.83s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  89%|████████▉ | 466/525 [8:37:19<1:24:53, 86.33s/it]
[36m(TaskRunner pid=2949575)[0m step:465 - global_seqlen/min:89152 - global_seqlen/max:98375 - global_seqlen/minmax_diff:9223 - global_seqlen/balanced_min:93200 - global_seqlen/balanced_max:94676 - global_seqlen/mean:94304.875 - actor/entropy:0.0021049801725894213 - actor/kl_loss:0.35562676638364793 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05717738792300224 - actor/pg_clipfrac:0.0 - actor/ppo_kl:-1.811981201171875e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.09498327504843473 - perf/mfu/actor:0.22824944682708806 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.21016693115234 - actor/lr:1e-06 - training/global_step:465 - training/epoch:13 - critic/score/mean:-0.37187498807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.37187498807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.017086438834667206 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.017086438834667206 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1947.231201171875 - response_length/max:2048.0 - response_length/min:149.0 - response_length/clip_ratio:0.9437500238418579 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.371875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.229592978954315e-05 - timing_s/generate_sequences:69.02760314941406 - timing_s/reshard:0.9724998474121094 - timing_s/gen:71.59036815725267 - timing_s/reward:0.23785093240439892 - timing_s/old_log_prob:2.375127963721752 - timing_s/ref:2.042659729719162 - timing_s/adv:0.00964272953569889 - timing_s/update_actor:9.436101369559765 - timing_s/step:85.70512254163623 - timing_s/stop_profile:4.534237086772919e-05 - timing_per_token_ms/adv:1.278132431607975e-05 - timing_per_token_ms/gen:0.11489128499319975 - timing_per_token_ms/ref:0.0027075213896937487 - timing_per_token_ms/update_actor:0.012507441117916445 - perf/total_num_tokens:754439 - perf/time_per_step:85.70512254163623 - perf/throughput:1100.3411721882312
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.48750001192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.48750001192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005834636744111776, 'critic/advantages/max': 1.4768644571304321, 'critic/advantages/min': -0.6949950456619263, 'critic/returns/mean': -0.005834636744111776, 'critic/returns/max': 1.4768644571304321, 'critic/returns/min': -0.6949950456619263, 'response_length/mean': 2036.59375, 'response_length/max': 2048.0, 'response_length/min': 220.0, 'response_length/clip_ratio': 0.9937499761581421, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:466 - global_seqlen/min:94620 - global_seqlen/max:98375 - global_seqlen/minmax_diff:3755 - global_seqlen/balanced_min:96477 - global_seqlen/balanced_max:98305 - global_seqlen/mean:97844.375 - actor/entropy:0.0003884098259732127 - actor/kl_loss:0.35716248452663424 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.017374876141548156 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.02878545756588924 - perf/mfu/actor:0.239564584447435 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.08129119873047 - actor/lr:1e-06 - training/global_step:466 - training/epoch:13 - critic/score/mean:-0.48750001192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.48750001192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005834636744111776 - critic/advantages/max:1.4768644571304321 - critic/advantages/min:-0.6949950456619263 - critic/returns/mean:-0.005834636744111776 - critic/returns/max:1.4768644571304321 - critic/returns/min:-0.6949950456619263 - response_length/mean:2036.59375 - response_length/max:2048.0 - response_length/min:220.0 - response_length/clip_ratio:0.9937499761581421 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.341670036315918e-05 - timing_s/generate_sequences:69.04051971435547 - timing_s/reshard:0.9238652586936951 - timing_s/gen:71.08579269051552 - timing_s/reward:0.2472850102931261 - timing_s/old_log_prob:2.383724084123969 - timing_s/ref:2.079964177682996 - timing_s/adv:0.0076241884380578995 - timing_s/update_actor:9.33339923992753 - timing_s/step:85.15787483006716 - timing_s/stop_profile:4.205293953418732e-05 - timing_per_token_ms/adv:9.740197683895854e-06 - timing_per_token_ms/gen:0.10907580471454408 - timing_per_token_ms/ref:0.002657235249449695 - timing_per_token_ms/update_actor:0.011923781055282343 - perf/total_num_tokens:782755 - perf/time_per_step:85.15787483006716 - perf/throughput:1148.9762420122483
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4703125059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4703125059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.014730747789144516, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.014783501625061, 'critic/returns/mean': -0.014730747789144516, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.014783501625061, 'response_length/mean': 2022.065673828125, 'response_length/max': 2048.0, 'response_length/min': 267.0, 'response_length/clip_ratio': 0.984375, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  89%|████████▉ | 467/525 [8:38:45<1:23:14, 86.11s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  89%|████████▉ | 468/525 [8:40:10<1:21:35, 85.89s/it]
[36m(TaskRunner pid=2949575)[0m step:467 - global_seqlen/min:93535 - global_seqlen/max:98375 - global_seqlen/minmax_diff:4840 - global_seqlen/balanced_min:96538 - global_seqlen/balanced_max:98319 - global_seqlen/mean:97280.75 - actor/entropy:0.001350659178569913 - actor/kl_loss:0.3575835764408112 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.025369587540626525 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.07023550971448955 - perf/mfu/actor:0.2385096059507842 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.15698623657227 - actor/lr:1e-06 - training/global_step:467 - training/epoch:13 - critic/score/mean:-0.4703125059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4703125059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.014730747789144516 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.014783501625061 - critic/returns/mean:-0.014730747789144516 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.014783501625061 - response_length/mean:2022.065673828125 - response_length/max:2048.0 - response_length/min:267.0 - response_length/clip_ratio:0.984375 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.559653699398041e-05 - timing_s/generate_sequences:68.934814453125 - timing_s/reshard:0.7632812261581421 - timing_s/gen:71.38306750915945 - timing_s/reward:0.24558984115719795 - timing_s/old_log_prob:2.423492817208171 - timing_s/ref:2.060178756713867 - timing_s/adv:0.0077242981642484665 - timing_s/update_actor:9.317927099764347 - timing_s/step:85.45127080567181 - timing_s/stop_profile:4.575960338115692e-05 - timing_per_token_ms/adv:9.92526548706767e-06 - timing_per_token_ms/gen:0.1103189150778048 - timing_per_token_ms/ref:0.0026472076396330557 - timing_per_token_ms/update_actor:0.011972984248893469 - perf/total_num_tokens:778246 - perf/time_per_step:85.45127080567181 - perf/throughput:1138.4353805718124
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.4296875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.4296875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.010581745766103268, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.0954443216323853, 'critic/returns/mean': -0.010581745766103268, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.0954443216323853, 'response_length/mean': 2000.956298828125, 'response_length/max': 2048.0, 'response_length/min': 124.0, 'response_length/clip_ratio': 0.971875011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:468 - global_seqlen/min:85105 - global_seqlen/max:98340 - global_seqlen/minmax_diff:13235 - global_seqlen/balanced_min:95359 - global_seqlen/balanced_max:96665 - global_seqlen/mean:96414.5 - actor/entropy:0.0010676846140995622 - actor/kl_loss:0.35421607792377474 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.004937060177326202 - actor/pg_clipfrac:2.024291461566463e-05 - actor/ppo_kl:-1.0491575812920928e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.033557948994322295 - perf/mfu/actor:0.23700076374715737 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.09026718139648 - actor/lr:1e-06 - training/global_step:468 - training/epoch:13 - critic/score/mean:-0.4296875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.4296875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.010581745766103268 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.0954443216323853 - critic/returns/mean:-0.010581745766103268 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.0954443216323853 - response_length/mean:2000.956298828125 - response_length/max:2048.0 - response_length/min:124.0 - response_length/clip_ratio:0.971875011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.788518607616425e-05 - timing_s/generate_sequences:68.6644287109375 - timing_s/reshard:0.8741172552108765 - timing_s/gen:71.40902199409902 - timing_s/reward:0.24377871863543987 - timing_s/old_log_prob:2.360202832147479 - timing_s/ref:2.043725086376071 - timing_s/adv:0.007598429918289185 - timing_s/update_actor:9.292014677077532 - timing_s/step:85.36945628374815 - timing_s/stop_profile:4.159845411777496e-05 - timing_per_token_ms/adv:9.851254114123374e-06 - timing_per_token_ms/gen:0.11152327480001596 - timing_per_token_ms/ref:0.0026496599141934965 - timing_per_token_ms/update_actor:0.012046962175136431 - perf/total_num_tokens:771316 - perf/time_per_step:85.36945628374815 - perf/throughput:1129.3793377287154
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.42500001192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.42500001192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.016570385545492172, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.0954443216323853, 'critic/returns/mean': -0.016570385545492172, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.0954443216323853, 'response_length/mean': 1980.559326171875, 'response_length/max': 2048.0, 'response_length/min': 99.0, 'response_length/clip_ratio': 0.9624999761581421, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.425, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  89%|████████▉ | 469/525 [8:41:36<1:20:10, 85.90s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:22:53,655:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:22:58,596:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:22:58,599:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:22:53,989:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:22:59,169:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  90%|████████▉ | 470/525 [8:43:14<1:22:00, 89.46s/it]
[36m(TaskRunner pid=2949575)[0m step:469 - global_seqlen/min:87764 - global_seqlen/max:98375 - global_seqlen/minmax_diff:10611 - global_seqlen/balanced_min:94759 - global_seqlen/balanced_max:96378 - global_seqlen/mean:95581.125 - actor/entropy:0.0020358143374323845 - actor/kl_loss:0.35577852874994276 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.00870390459895134 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.12233931381000218 - perf/mfu/actor:0.23333462462308394 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.14151382446289 - actor/lr:1e-06 - training/global_step:469 - training/epoch:13 - critic/score/mean:-0.42500001192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.42500001192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.016570385545492172 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.0954443216323853 - critic/returns/mean:-0.016570385545492172 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.0954443216323853 - response_length/mean:1980.559326171875 - response_length/max:2048.0 - response_length/min:99.0 - response_length/clip_ratio:0.9624999761581421 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.425 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.091144263744354e-05 - timing_s/generate_sequences:69.02676391601562 - timing_s/reshard:0.9250303506851196 - timing_s/gen:71.83591702580452 - timing_s/reward:0.2432921901345253 - timing_s/old_log_prob:2.3818229474127293 - timing_s/ref:2.056956997141242 - timing_s/adv:0.008306276053190231 - timing_s/update_actor:9.35459173657 - timing_s/step:85.89806421287358 - timing_s/stop_profile:4.4260174036026e-05 - timing_per_token_ms/adv:1.0862861330087702e-05 - timing_per_token_ms/gen:0.11334537279683378 - timing_per_token_ms/ref:0.0026900669420103105 - timing_per_token_ms/update_actor:0.012233837664823992 - perf/total_num_tokens:764649 - perf/time_per_step:85.89806421287358 - perf/throughput:1112.7273457889546
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.390625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.390625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.005147903226315975, 'critic/advantages/max': 0.44721320271492004, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.005147903226315975, 'critic/returns/max': 0.44721320271492004, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1967.128173828125, 'response_length/max': 2048.0, 'response_length/min': 101.0, 'response_length/clip_ratio': 0.956250011920929, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.390625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:470 - global_seqlen/min:88993 - global_seqlen/max:98375 - global_seqlen/minmax_diff:9382 - global_seqlen/balanced_min:94647 - global_seqlen/balanced_max:96393 - global_seqlen/mean:95092.0 - actor/entropy:0.002557378262281418 - actor/kl_loss:0.35737467259168626 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0 - actor/pg_clipfrac:0.0 - actor/ppo_kl:-3.076029533986002e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.023903430675722426 - perf/mfu/actor:0.22869758140470636 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.17093276977539 - actor/lr:1e-06 - training/global_step:470 - training/epoch:13 - critic/score/mean:-0.390625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.390625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.005147903226315975 - critic/advantages/max:0.44721320271492004 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.005147903226315975 - critic/returns/max:0.44721320271492004 - critic/returns/min:-1.7888528108596802 - response_length/mean:1967.128173828125 - response_length/max:2048.0 - response_length/min:101.0 - response_length/clip_ratio:0.956250011920929 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.390625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.514709770679474e-05 - timing_s/generate_sequences:70.49541473388672 - timing_s/reshard:0.9187412858009338 - timing_s/gen:72.9024616945535 - timing_s/reward:0.24343251436948776 - timing_s/old_log_prob:2.390919853001833 - timing_s/ref:2.0535607524216175 - timing_s/adv:0.00818011723458767 - timing_s/update_actor:9.494859153404832 - timing_s/save_checkpoint:10.634068271145225 - timing_s/step:97.74451505206525 - timing_s/stop_profile:4.7443434596061707e-05 - timing_per_token_ms/adv:1.0752898817181873e-05 - timing_per_token_ms/gen:0.11581360151387174 - timing_per_token_ms/ref:0.0026994394276353656 - timing_per_token_ms/update_actor:0.012481148720981827 - perf/total_num_tokens:760736 - perf/time_per_step:97.74451505206525 - perf/throughput:972.8627734185151
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.44218748807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.44218748807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.020690729841589928, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.035863995552063, 'critic/returns/mean': -0.020690729841589928, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.035863995552063, 'response_length/mean': 2002.1656494140625, 'response_length/max': 2048.0, 'response_length/min': 209.0, 'response_length/clip_ratio': 0.971875011920929, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.4421875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  90%|████████▉ | 471/525 [8:44:40<1:19:35, 88.43s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:23:00,731:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:23:00,734:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_470/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  90%|████████▉ | 472/525 [8:46:07<1:17:49, 88.10s/it]
[36m(TaskRunner pid=2949575)[0m step:471 - global_seqlen/min:91156 - global_seqlen/max:98410 - global_seqlen/minmax_diff:7254 - global_seqlen/balanced_min:95472 - global_seqlen/balanced_max:96775 - global_seqlen/mean:96493.5 - actor/entropy:0.002331514609977603 - actor/kl_loss:0.3549461647868156 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.005242485180497169 - actor/pg_clipfrac:0.0 - actor/ppo_kl:0.0 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:1.2226298584717048 - perf/mfu/actor:0.22855835056492013 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.15613555908203 - actor/lr:1e-06 - training/global_step:471 - training/epoch:13 - critic/score/mean:-0.44218748807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.44218748807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.020690729841589928 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.035863995552063 - critic/returns/mean:-0.020690729841589928 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.035863995552063 - response_length/mean:2002.1656494140625 - response_length/max:2048.0 - response_length/min:209.0 - response_length/clip_ratio:0.971875011920929 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.4421875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.600391447544098e-05 - timing_s/generate_sequences:69.71441650390625 - timing_s/reshard:1.0074124336242676 - timing_s/gen:71.66247684881091 - timing_s/reward:0.251263290643692 - timing_s/old_log_prob:2.3793099503964186 - timing_s/ref:2.056726135313511 - timing_s/adv:0.008326515555381775 - timing_s/update_actor:9.64209314621985 - timing_s/step:86.01865368708968 - timing_s/stop_profile:4.38448041677475e-05 - timing_per_token_ms/adv:1.0786368454069153e-05 - timing_per_token_ms/gen:0.11185150586756983 - timing_per_token_ms/ref:0.002664332487827562 - timing_per_token_ms/update_actor:0.012490599297128627 - perf/total_num_tokens:771948 - perf/time_per_step:86.01865368708968 - perf/throughput:1121.774125307921
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.34062498807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.34062498807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.033641085028648376, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.033641085028648376, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1925.1624755859375, 'response_length/max': 2048.0, 'response_length/min': 186.0, 'response_length/clip_ratio': 0.9312499761581421, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.340625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:472 - global_seqlen/min:85605 - global_seqlen/max:98410 - global_seqlen/minmax_diff:12805 - global_seqlen/balanced_min:92949 - global_seqlen/balanced_max:94634 - global_seqlen/mean:93391.5 - actor/entropy:0.005376908928155899 - actor/kl_loss:0.35561994910240174 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.025378669798374175 - actor/pg_clipfrac:2.2222222469281405e-05 - actor/ppo_kl:-4.366259963717311e-06 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.10005178329101305 - perf/mfu/actor:0.22549619768597493 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.37173080444336 - actor/lr:1e-06 - training/global_step:472 - training/epoch:13 - critic/score/mean:-0.34062498807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.34062498807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.033641085028648376 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.033641085028648376 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1925.1624755859375 - response_length/max:2048.0 - response_length/min:186.0 - response_length/clip_ratio:0.9312499761581421 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.340625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010243244469165802 - timing_s/generate_sequences:70.22582244873047 - timing_s/reshard:0.8410274982452393 - timing_s/gen:72.5002506505698 - timing_s/reward:0.23707499355077744 - timing_s/old_log_prob:2.432066874578595 - timing_s/ref:2.0509691294282675 - timing_s/adv:0.009005719795823097 - timing_s/update_actor:9.451769476756454 - timing_s/step:86.69749992527068 - timing_s/stop_profile:4.585646092891693e-05 - timing_per_token_ms/adv:1.2053719819018723e-05 - timing_per_token_ms/gen:0.11768527762359313 - timing_per_token_ms/ref:0.002745122855704571 - timing_per_token_ms/update_actor:0.012650735715718847 - perf/total_num_tokens:747132 - perf/time_per_step:86.69749992527068 - perf/throughput:1077.2109931716514
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.22187499701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.22187499701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04506678134202957, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.04506678134202957, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1775.4437255859375, 'response_length/max': 2048.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.840624988079071, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.221875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  90%|█████████ | 473/525 [8:47:34<1:15:56, 87.63s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  90%|█████████ | 474/525 [8:49:01<1:14:15, 87.37s/it]
[36m(TaskRunner pid=2949575)[0m step:473 - global_seqlen/min:75297 - global_seqlen/max:98340 - global_seqlen/minmax_diff:23043 - global_seqlen/balanced_min:86741 - global_seqlen/balanced_max:87758 - global_seqlen/mean:87380.875 - actor/entropy:0.013860530219972134 - actor/kl_loss:0.340374993532896 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08306048903614283 - actor/pg_clipfrac:0.00042821789684239776 - actor/ppo_kl:-0.00012856525572715327 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:3.321916803717613 - perf/mfu/actor:0.21282366059810817 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.3170166015625 - actor/lr:1e-06 - training/global_step:473 - training/epoch:13 - critic/score/mean:-0.22187499701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.22187499701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04506678134202957 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.04506678134202957 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1775.4437255859375 - response_length/max:2048.0 - response_length/min:92.0 - response_length/clip_ratio:0.840624988079071 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.221875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010300427675247192 - timing_s/generate_sequences:70.22899627685547 - timing_s/reshard:0.8485925197601318 - timing_s/gen:72.37441577576101 - timing_s/reward:0.22075224854052067 - timing_s/old_log_prob:2.3834924288094044 - timing_s/ref:2.035127878189087 - timing_s/adv:0.009859712794423103 - timing_s/update_actor:9.356705635786057 - timing_s/step:86.39548839256167 - timing_s/stop_profile:4.7069042921066284e-05 - timing_per_token_ms/adv:1.4104506269854678e-05 - timing_per_token_ms/gen:0.12738789910930895 - timing_per_token_ms/ref:0.002911289052365702 - timing_per_token_ms/update_actor:0.013384944983364575 - perf/total_num_tokens:699047 - perf/time_per_step:86.39548839256167 - perf/throughput:1011.4055331565573
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3375000059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3375000059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.04226323217153549, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.643166184425354, 'critic/returns/mean': -0.04226323217153549, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.643166184425354, 'response_length/mean': 1917.043701171875, 'response_length/max': 2048.0, 'response_length/min': 120.0, 'response_length/clip_ratio': 0.921875, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.3375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:474 - global_seqlen/min:80336 - global_seqlen/max:98410 - global_seqlen/minmax_diff:18074 - global_seqlen/balanced_min:92133 - global_seqlen/balanced_max:93237 - global_seqlen/mean:93066.75 - actor/entropy:0.006014266517013311 - actor/kl_loss:0.35119274258613586 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.012490700185298919 - actor/pg_clipfrac:1.881821663118899e-05 - actor/ppo_kl:-1.5965039710863494e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.2741278372704983 - perf/mfu/actor:0.2272508207585745 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.22002029418945 - actor/lr:1e-06 - training/global_step:474 - training/epoch:13 - critic/score/mean:-0.3375000059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3375000059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.04226323217153549 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.643166184425354 - critic/returns/mean:-0.04226323217153549 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.643166184425354 - response_length/mean:1917.043701171875 - response_length/max:2048.0 - response_length/min:120.0 - response_length/clip_ratio:0.921875 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.3375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.485093712806702e-05 - timing_s/generate_sequences:69.88690948486328 - timing_s/reshard:0.7573785185813904 - timing_s/gen:72.70039682090282 - timing_s/reward:0.23595415614545345 - timing_s/old_log_prob:2.386945180594921 - timing_s/ref:2.0489158406853676 - timing_s/adv:0.007992710918188095 - timing_s/update_actor:9.342434300109744 - timing_s/step:86.7518938537687 - timing_s/stop_profile:4.603341221809387e-05 - timing_per_token_ms/adv:1.0735185925945753e-05 - timing_per_token_ms/gen:0.11850994014368287 - timing_per_token_ms/ref:0.002751943955125444 - timing_per_token_ms/update_actor:0.012548029102915036 - perf/total_num_tokens:744534 - perf/time_per_step:86.7518938537687 - perf/throughput:1072.7921416548645
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.2750000059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.2750000059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.048971761018037796, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.048971761018037796, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1846.5406494140625, 'response_length/max': 2048.0, 'response_length/min': 117.0, 'response_length/clip_ratio': 0.8812500238418579, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.275, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  90%|█████████ | 475/525 [8:50:27<1:12:29, 86.99s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  91%|█████████ | 476/525 [8:51:54<1:11:02, 86.99s/it]
[36m(TaskRunner pid=2949575)[0m step:475 - global_seqlen/min:75021 - global_seqlen/max:98375 - global_seqlen/minmax_diff:23354 - global_seqlen/balanced_min:89930 - global_seqlen/balanced_max:91217 - global_seqlen/mean:90255.375 - actor/entropy:0.008993084542453289 - actor/kl_loss:0.3502029970288277 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06680225851014257 - actor/pg_clipfrac:8.583652233937756e-05 - actor/ppo_kl:-0.00010097713638970162 - actor/pg_clipfrac_lower:4.46019068476744e-05 - actor/grad_norm:0.24447864014655352 - perf/mfu/actor:0.21808129555408318 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.17037582397461 - actor/lr:1e-06 - training/global_step:475 - training/epoch:13 - critic/score/mean:-0.2750000059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.2750000059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.048971761018037796 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.048971761018037796 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1846.5406494140625 - response_length/max:2048.0 - response_length/min:117.0 - response_length/clip_ratio:0.8812500238418579 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.275 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010216981172561646 - timing_s/generate_sequences:69.908447265625 - timing_s/reshard:0.9538409113883972 - timing_s/gen:71.84360669180751 - timing_s/reward:0.2296090442687273 - timing_s/old_log_prob:2.3910145685076714 - timing_s/ref:2.0411802642047405 - timing_s/adv:0.008535226806998253 - timing_s/update_actor:9.437473682686687 - timing_s/step:85.96766144782305 - timing_s/stop_profile:4.474632441997528e-05 - timing_per_token_ms/adv:1.1820939759817979e-05 - timing_per_token_ms/gen:0.12158479909528037 - timing_per_token_ms/ref:0.0028269511153833503 - timing_per_token_ms/update_actor:0.013070514751457582 - perf/total_num_tokens:722043 - perf/time_per_step:85.96766144782305 - perf/throughput:1049.875889142097
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3531250059604645, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3531250059604645, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.019857749342918396, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.019857749342918396, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1927.21875, 'response_length/max': 2048.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.9312499761581421, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.353125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:476 - global_seqlen/min:82655 - global_seqlen/max:98340 - global_seqlen/minmax_diff:15685 - global_seqlen/balanced_min:93102 - global_seqlen/balanced_max:94616 - global_seqlen/mean:93495.625 - actor/entropy:0.006615090183913708 - actor/kl_loss:0.3617600008845329 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08314851522445679 - actor/pg_clipfrac:0.0 - actor/ppo_kl:1.7817960178945212e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:10.037692469462328 - perf/mfu/actor:0.22439658318316374 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.11127471923828 - actor/lr:1e-06 - training/global_step:476 - training/epoch:13 - critic/score/mean:-0.3531250059604645 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3531250059604645 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.019857749342918396 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.019857749342918396 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1927.21875 - response_length/max:2048.0 - response_length/min:92.0 - response_length/clip_ratio:0.9312499761581421 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.353125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.566677570343018e-05 - timing_s/generate_sequences:70.36814880371094 - timing_s/reshard:0.9095346927642822 - timing_s/gen:72.76244434900582 - timing_s/reward:0.23937631398439407 - timing_s/old_log_prob:2.38420975394547 - timing_s/ref:2.048742735758424 - timing_s/adv:0.008119398728013039 - timing_s/update_actor:9.509088331833482 - timing_s/step:86.96905042044818 - timing_s/stop_profile:4.3373554944992065e-05 - timing_per_token_ms/adv:1.085531906976e-05 - timing_per_token_ms/gen:0.11798486217023531 - timing_per_token_ms/ref:0.002739089042613523 - timing_per_token_ms/update_actor:0.012713279808324563 - perf/total_num_tokens:747965 - perf/time_per_step:86.96905042044818 - perf/throughput:1075.044795223121
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.3968749940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.3968749940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.021429721266031265, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.5652457475662231, 'critic/returns/mean': -0.021429721266031265, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.5652457475662231, 'response_length/mean': 1942.3375244140625, 'response_length/max': 2048.0, 'response_length/min': 115.0, 'response_length/clip_ratio': 0.940625011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.396875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  91%|█████████ | 477/525 [8:53:20<1:09:26, 86.81s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  91%|█████████ | 478/525 [8:54:47<1:07:56, 86.74s/it]
[36m(TaskRunner pid=2949575)[0m step:477 - global_seqlen/min:89167 - global_seqlen/max:98375 - global_seqlen/minmax_diff:9208 - global_seqlen/balanced_min:93113 - global_seqlen/balanced_max:94665 - global_seqlen/mean:94069.75 - actor/entropy:0.0053529292345047 - actor/kl_loss:0.3548878446221352 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07889278903603554 - actor/pg_clipfrac:2.1061499137431382e-05 - actor/ppo_kl:-6.661012666882015e-05 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:0.23488195657175215 - perf/mfu/actor:0.230062063587644 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.13566970825195 - actor/lr:1e-06 - training/global_step:477 - training/epoch:13 - critic/score/mean:-0.3968749940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.3968749940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.021429721266031265 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.5652457475662231 - critic/returns/mean:-0.021429721266031265 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.5652457475662231 - response_length/mean:1942.3375244140625 - response_length/max:2048.0 - response_length/min:115.0 - response_length/clip_ratio:0.940625011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.396875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.010732173919678e-05 - timing_s/generate_sequences:70.08142852783203 - timing_s/reshard:0.7629516124725342 - timing_s/gen:72.32840018719435 - timing_s/reward:0.2406213916838169 - timing_s/old_log_prob:2.386680692434311 - timing_s/ref:2.0527297910302877 - timing_s/adv:0.008303748443722725 - timing_s/update_actor:9.332847407087684 - timing_s/step:86.36666776239872 - timing_s/stop_profile:4.591792821884155e-05 - timing_per_token_ms/adv:1.103403118925415e-05 - timing_per_token_ms/gen:0.1163681649481526 - timing_per_token_ms/ref:0.0027276698819629686 - timing_per_token_ms/update_actor:0.012401499162971737 - perf/total_num_tokens:752558 - perf/time_per_step:86.36666776239872 - perf/throughput:1089.190453182622
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.20000000298023224, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.20000000298023224, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.049018025398254395, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.049018025398254395, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1799.6500244140625, 'response_length/max': 2048.0, 'response_length/min': 89.0, 'response_length/clip_ratio': 0.8500000238418579, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:478 - global_seqlen/min:81314 - global_seqlen/max:95352 - global_seqlen/minmax_diff:14038 - global_seqlen/balanced_min:88376 - global_seqlen/balanced_max:88383 - global_seqlen/mean:88379.75 - actor/entropy:0.01345023326575756 - actor/kl_loss:0.33701525442302227 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.034351945854723454 - actor/pg_clipfrac:0.00015888707130216063 - actor/ppo_kl:-0.00030251165298977867 - actor/pg_clipfrac_lower:7.76397529989481e-05 - actor/grad_norm:14.650552062317729 - perf/mfu/actor:0.2158612843602257 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.07328033447266 - actor/lr:1e-06 - training/global_step:478 - training/epoch:13 - critic/score/mean:-0.20000000298023224 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.20000000298023224 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.049018025398254395 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.049018025398254395 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1799.6500244140625 - response_length/max:2048.0 - response_length/min:89.0 - response_length/clip_ratio:0.8500000238418579 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.468570351600647e-05 - timing_s/generate_sequences:69.6842269897461 - timing_s/reshard:0.8461269736289978 - timing_s/gen:72.50293807312846 - timing_s/reward:0.22602902725338936 - timing_s/old_log_prob:2.4113886021077633 - timing_s/ref:2.074179919436574 - timing_s/adv:0.008513975888490677 - timing_s/update_actor:9.32692918740213 - timing_s/step:86.56722665578127 - timing_s/stop_profile:4.667229950428009e-05 - timing_per_token_ms/adv:1.2041751487884211e-05 - timing_per_token_ms/gen:0.12589763647293997 - timing_per_token_ms/ref:0.00293361872973811 - timing_per_token_ms/update_actor:0.01319155291144483 - perf/total_num_tokens:707038 - perf/time_per_step:86.56722665578127 - perf/throughput:1020.9377545549183
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.25312501192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.25312501192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07808700203895569, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07808700203895569, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1849.315673828125, 'response_length/max': 2048.0, 'response_length/min': 152.0, 'response_length/clip_ratio': 0.8812500238418579, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.253125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  91%|█████████ | 479/525 [8:56:13<1:06:28, 86.70s/it]
[36m(WorkerDict pid=2951186)[0m INFO:2025-08-06 08:37:30,068:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 08:37:35,067:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 08:37:35,069:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:37:30,215:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:37:36,099:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  91%|█████████▏| 480/525 [8:57:50<1:07:19, 89.76s/it]
[36m(TaskRunner pid=2949575)[0m step:479 - global_seqlen/min:84695 - global_seqlen/max:98340 - global_seqlen/minmax_diff:13645 - global_seqlen/balanced_min:90047 - global_seqlen/balanced_max:91229 - global_seqlen/mean:90344.5 - actor/entropy:0.013462246395647526 - actor/kl_loss:0.35889753699302673 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.055979407671838996 - actor/pg_clipfrac:0.0009556003889883869 - actor/ppo_kl:-0.005006185188540258 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:10.236386120319366 - perf/mfu/actor:0.20935205720174152 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.12393188476562 - actor/lr:1e-06 - training/global_step:479 - training/epoch:13 - critic/score/mean:-0.25312501192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.25312501192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07808700203895569 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07808700203895569 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1849.315673828125 - response_length/max:2048.0 - response_length/min:152.0 - response_length/clip_ratio:0.8812500238418579 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.253125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.530169725418091e-05 - timing_s/generate_sequences:70.02011108398438 - timing_s/reshard:0.9304044246673584 - timing_s/gen:71.98951946385205 - timing_s/reward:0.2310597226023674 - timing_s/old_log_prob:2.4563708659261465 - timing_s/ref:2.0417488403618336 - timing_s/adv:0.008216386660933495 - timing_s/update_actor:9.835231794044375 - timing_s/step:86.57921231351793 - timing_s/stop_profile:4.57223504781723e-05 - timing_per_token_ms/adv:1.1368133451584622e-05 - timing_per_token_ms/gen:0.1216489198941028 - timing_per_token_ms/ref:0.002824949001269908 - timing_per_token_ms/update_actor:0.013607955927096247 - perf/total_num_tokens:722756 - perf/time_per_step:86.57921231351793 - perf/throughput:1043.4895119263424
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.23281249403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.23281249403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07977118343114853, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07977118343114853, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1811.9000244140625, 'response_length/max': 2048.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.862500011920929, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.2328125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:480 - global_seqlen/min:81240 - global_seqlen/max:98375 - global_seqlen/minmax_diff:17135 - global_seqlen/balanced_min:88318 - global_seqlen/balanced_max:89447 - global_seqlen/mean:88882.875 - actor/entropy:0.011596135795116425 - actor/kl_loss:0.3449413329362869 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.036196493357419965 - actor/pg_clipfrac:0.0002566383685916662 - actor/ppo_kl:-0.0027106639660814833 - actor/pg_clipfrac_lower:1.220703125e-05 - actor/grad_norm:13.041471716016531 - perf/mfu/actor:0.21738837886192017 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.29971313476562 - actor/lr:1e-06 - training/global_step:480 - training/epoch:13 - critic/score/mean:-0.23281249403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.23281249403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07977118343114853 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07977118343114853 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1811.9000244140625 - response_length/max:2048.0 - response_length/min:84.0 - response_length/clip_ratio:0.862500011920929 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.2328125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010822713375091553 - timing_s/generate_sequences:69.59959411621094 - timing_s/reshard:0.9521076083183289 - timing_s/gen:71.4794890396297 - timing_s/reward:0.22574349120259285 - timing_s/old_log_prob:2.522677853703499 - timing_s/ref:2.0593573041260242 - timing_s/adv:0.011055594310164452 - timing_s/update_actor:9.319438738748431 - timing_s/save_checkpoint:10.692000711336732 - timing_s/step:96.3269031625241 - timing_s/stop_profile:5.2792951464653015e-05 - timing_per_token_ms/adv:1.554798141678649e-05 - timing_per_token_ms/gen:0.12328130870845125 - timing_per_token_ms/ref:0.002896167152736149 - timing_per_token_ms/update_actor:0.013106347452684828 - perf/total_num_tokens:711063 - perf/time_per_step:96.3269031625241 - perf/throughput:922.7211929572319
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.14687499403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.14687499403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.07220536470413208, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.07220536470413208, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1770.515625, 'response_length/max': 2048.0, 'response_length/min': 123.0, 'response_length/clip_ratio': 0.8374999761581421, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.146875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  92%|█████████▏| 481/525 [8:59:16<1:04:56, 88.56s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:37:36,928:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:37:36,930:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_480/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  92%|█████████▏| 482/525 [9:00:42<1:02:50, 87.68s/it]
[36m(TaskRunner pid=2949575)[0m step:481 - global_seqlen/min:76923 - global_seqlen/max:96668 - global_seqlen/minmax_diff:19745 - global_seqlen/balanced_min:86636 - global_seqlen/balanced_max:87737 - global_seqlen/mean:87188.125 - actor/entropy:0.012776332907378674 - actor/kl_loss:0.3347360581159592 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1115842298604548 - actor/pg_clipfrac:0.00023456964554497973 - actor/ppo_kl:0.00021598994355827018 - actor/pg_clipfrac_lower:4.393006529426202e-05 - actor/grad_norm:27.714019939303398 - perf/mfu/actor:0.212832235194612 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.37916946411133 - actor/lr:1e-06 - training/global_step:481 - training/epoch:13 - critic/score/mean:-0.14687499403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.14687499403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.07220536470413208 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.07220536470413208 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1770.515625 - response_length/max:2048.0 - response_length/min:123.0 - response_length/clip_ratio:0.8374999761581421 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.146875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010806508362293243 - timing_s/generate_sequences:69.75353240966797 - timing_s/reshard:0.930167555809021 - timing_s/gen:71.65412905812263 - timing_s/reward:0.22119390591979027 - timing_s/old_log_prob:2.372088558971882 - timing_s/ref:2.0357053335756063 - timing_s/adv:0.008220702409744263 - timing_s/update_actor:9.329812260344625 - timing_s/step:85.63650085404515 - timing_s/stop_profile:4.363246262073517e-05 - timing_per_token_ms/adv:1.1785868789104397e-05 - timing_per_token_ms/gen:0.12647115345657187 - timing_per_token_ms/ref:0.0029185530334199846 - timing_per_token_ms/update_actor:0.01337597904007086 - perf/total_num_tokens:697505 - perf/time_per_step:85.63650085404515 - perf/throughput:1018.1187242645442
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.02656250074505806, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.02656250074505806, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12729553878307343, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.12729553878307343, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1571.143798828125, 'response_length/max': 2048.0, 'response_length/min': 57.0, 'response_length/clip_ratio': 0.721875011920929, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.0265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:482 - global_seqlen/min:64158 - global_seqlen/max:95096 - global_seqlen/minmax_diff:30938 - global_seqlen/balanced_min:78445 - global_seqlen/balanced_max:79337 - global_seqlen/mean:79222.0 - actor/entropy:0.033088866621255875 - actor/kl_loss:0.3118002638220787 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08105403142981231 - actor/pg_clipfrac:0.0004766696729348041 - actor/ppo_kl:-0.000659565641763038 - actor/pg_clipfrac_lower:6.291946046985686e-05 - actor/grad_norm:7.403814114630222 - perf/mfu/actor:0.19159364993966782 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.31425857543945 - actor/lr:1e-06 - training/global_step:482 - training/epoch:13 - critic/score/mean:0.02656250074505806 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.02656250074505806 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12729553878307343 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.12729553878307343 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1571.143798828125 - response_length/max:2048.0 - response_length/min:57.0 - response_length/clip_ratio:0.721875011920929 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.0265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.051896631717682e-05 - timing_s/generate_sequences:68.90035247802734 - timing_s/reshard:0.8865611553192139 - timing_s/gen:71.65537186525762 - timing_s/reward:0.20321102440357208 - timing_s/old_log_prob:2.3352668788284063 - timing_s/ref:1.9808762799948454 - timing_s/adv:0.008242903277277946 - timing_s/update_actor:9.387758133932948 - timing_s/step:85.59990851767361 - timing_s/stop_profile:4.33456152677536e-05 - timing_per_token_ms/adv:1.3006019914414472e-05 - timing_per_token_ms/gen:0.14252231030988097 - timing_per_token_ms/ref:0.003125514819107769 - timing_per_token_ms/update_actor:0.014812422896943003 - perf/total_num_tokens:633776 - perf/time_per_step:85.59990851767361 - perf/throughput:925.4916432958946
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.11249999701976776, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.11249999701976776, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15522505342960358, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15522505342960358, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1522.925048828125, 'response_length/max': 2048.0, 'response_length/min': 115.0, 'response_length/clip_ratio': 0.6937500238418579, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.1125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  92%|█████████▏| 483/525 [9:02:07<1:00:56, 87.06s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  92%|█████████▏| 484/525 [9:03:32<59:05, 86.49s/it]  
[36m(TaskRunner pid=2949575)[0m step:483 - global_seqlen/min:53155 - global_seqlen/max:93149 - global_seqlen/minmax_diff:39994 - global_seqlen/balanced_min:76556 - global_seqlen/balanced_max:77564 - global_seqlen/mean:77319.5 - actor/entropy:0.033650897443294525 - actor/kl_loss:0.30747202038764954 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21563983764499425 - actor/pg_clipfrac:0.0012365796515950932 - actor/ppo_kl:0.0017389433618518525 - actor/pg_clipfrac_lower:0.00039303252269746737 - actor/grad_norm:8.382307350635529 - perf/mfu/actor:0.18549354657951456 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.3281364440918 - actor/lr:1e-06 - training/global_step:483 - training/epoch:13 - critic/score/mean:0.11249999701976776 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.11249999701976776 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15522505342960358 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15522505342960358 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1522.925048828125 - response_length/max:2048.0 - response_length/min:115.0 - response_length/clip_ratio:0.6937500238418579 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.1125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010227411985397339 - timing_s/generate_sequences:68.84822845458984 - timing_s/reshard:0.9043452143669128 - timing_s/gen:71.46188698336482 - timing_s/reward:0.1968501005321741 - timing_s/old_log_prob:2.3856194466352463 - timing_s/ref:1.958933124318719 - timing_s/adv:0.0080065056681633 - timing_s/update_actor:9.457212179899216 - timing_s/step:85.48441457934678 - timing_s/stop_profile:4.7342851758003235e-05 - timing_per_token_ms/adv:1.2943865499911567e-05 - timing_per_token_ms/gen:0.1466378165851996 - timing_per_token_ms/ref:0.0031669454735201324 - timing_per_token_ms/update_actor:0.015289177018571019 - perf/total_num_tokens:618556 - perf/time_per_step:85.48441457934678 - perf/throughput:904.4865123130943
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.02968749962747097, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.02968749962747097, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.19142641127109528, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.19142641127109528, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1570.5625, 'response_length/max': 2048.0, 'response_length/min': 119.0, 'response_length/clip_ratio': 0.721875011920929, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.0296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:484 - global_seqlen/min:65470 - global_seqlen/max:89504 - global_seqlen/minmax_diff:24034 - global_seqlen/balanced_min:78281 - global_seqlen/balanced_max:79342 - global_seqlen/mean:79207.5 - actor/entropy:0.029555408284068108 - actor/kl_loss:0.2951595686376095 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13344066590070724 - actor/pg_clipfrac:0.0007063504395773635 - actor/ppo_kl:0.00012437402838259005 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:7.559705227613449 - perf/mfu/actor:0.19464126300749743 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.23172760009766 - actor/lr:1e-06 - training/global_step:484 - training/epoch:13 - critic/score/mean:0.02968749962747097 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.02968749962747097 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.19142641127109528 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.19142641127109528 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1570.5625 - response_length/max:2048.0 - response_length/min:119.0 - response_length/clip_ratio:0.721875011920929 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.0296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.651427924633026e-05 - timing_s/generate_sequences:68.67887115478516 - timing_s/reshard:0.8943132758140564 - timing_s/gen:71.38692713156343 - timing_s/reward:0.20169506408274174 - timing_s/old_log_prob:2.3210989236831665 - timing_s/ref:1.9475720934569836 - timing_s/adv:0.008236736059188843 - timing_s/update_actor:9.236326796934009 - timing_s/step:85.11907522380352 - timing_s/stop_profile:4.4304877519607544e-05 - timing_per_token_ms/adv:1.2998668148831933e-05 - timing_per_token_ms/gen:0.14204092309993122 - timing_per_token_ms/ref:0.0030735285381071607 - timing_per_token_ms/update_actor:0.014576155662238438 - perf/total_num_tokens:633660 - perf/time_per_step:85.11907522380352 - perf/throughput:930.5493485654042
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': -0.00937500037252903, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': -0.00937500037252903, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15696823596954346, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15696823596954346, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1613.515625, 'response_length/max': 2048.0, 'response_length/min': 124.0, 'response_length/clip_ratio': 0.7406250238418579, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': -0.009375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  92%|█████████▏| 485/525 [9:04:57<57:18, 85.96s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  93%|█████████▎| 486/525 [9:06:23<55:46, 85.82s/it]
[36m(TaskRunner pid=2949575)[0m step:485 - global_seqlen/min:71117 - global_seqlen/max:89724 - global_seqlen/minmax_diff:18607 - global_seqlen/balanced_min:80265 - global_seqlen/balanced_max:81290 - global_seqlen/mean:80903.75 - actor/entropy:0.029063476249575615 - actor/kl_loss:0.3347747579216957 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08052661418914794 - actor/pg_clipfrac:0.0005845670137205161 - actor/ppo_kl:-0.00012213695770810773 - actor/pg_clipfrac_lower:0.00031592249870300294 - actor/grad_norm:4.4318249225616455 - perf/mfu/actor:0.19774908928301235 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.24686813354492 - actor/lr:1e-06 - training/global_step:485 - training/epoch:13 - critic/score/mean:-0.00937500037252903 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:-0.00937500037252903 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15696823596954346 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15696823596954346 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1613.515625 - response_length/max:2048.0 - response_length/min:124.0 - response_length/clip_ratio:0.7406250238418579 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:-0.009375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.60355794429779e-05 - timing_s/generate_sequences:68.95243072509766 - timing_s/reshard:0.7786592841148376 - timing_s/gen:70.86196392215788 - timing_s/reward:0.20562303066253662 - timing_s/old_log_prob:2.3398430179804564 - timing_s/ref:1.9922111760824919 - timing_s/adv:0.008304910734295845 - timing_s/update_actor:9.289380967617035 - timing_s/step:84.71446879021823 - timing_s/stop_profile:4.423409700393677e-05 - timing_per_token_ms/adv:1.2831467537499567e-05 - timing_per_token_ms/gen:0.1372429456682475 - timing_per_token_ms/ref:0.0030780575314532576 - timing_per_token_ms/update_actor:0.014352519147161033 - perf/total_num_tokens:647230 - perf/time_per_step:84.71446879021823 - perf/throughput:955.0169074464143
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1096254512667656, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.1096254512667656, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1526.8218994140625, 'response_length/max': 2048.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.6968749761581421, 'prompt_length/mean': 410.71875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:486 - global_seqlen/min:68404 - global_seqlen/max:85256 - global_seqlen/minmax_diff:16852 - global_seqlen/balanced_min:76507 - global_seqlen/balanced_max:77648 - global_seqlen/mean:77501.625 - actor/entropy:0.02918113023042679 - actor/kl_loss:0.30818256810307504 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11346202492713928 - actor/pg_clipfrac:0.0015379696982563474 - actor/ppo_kl:-0.0056352846324443815 - actor/pg_clipfrac_lower:0.0002427940213237889 - actor/grad_norm:1.3086904808878899 - perf/mfu/actor:0.18915618251294644 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.31631088256836 - actor/lr:1e-06 - training/global_step:486 - training/epoch:13 - critic/score/mean:0.125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1096254512667656 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.1096254512667656 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1526.8218994140625 - response_length/max:2048.0 - response_length/min:97.0 - response_length/clip_ratio:0.6968749761581421 - prompt_length/mean:410.71875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.514150977134705e-05 - timing_s/generate_sequences:69.35663604736328 - timing_s/reshard:0.887917160987854 - timing_s/gen:71.50451053120196 - timing_s/reward:0.19951279275119305 - timing_s/old_log_prob:2.4568471740931273 - timing_s/ref:1.985167445614934 - timing_s/adv:0.008295917883515358 - timing_s/update_actor:9.292744435369968 - timing_s/step:85.46416246332228 - timing_s/stop_profile:4.6405941247940063e-05 - timing_per_token_ms/adv:1.338023216209234e-05 - timing_per_token_ms/gen:0.14635079511813132 - timing_per_token_ms/ref:0.0032018158419499817 - timing_per_token_ms/update_actor:0.014987983212239047 - perf/total_num_tokens:620013 - perf/time_per_step:85.46416246332228 - perf/throughput:906.8318552031739
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.2874999940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.2874999940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.21084977686405182, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.21084977686405182, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1388.981201171875, 'response_length/max': 2048.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.625, 'prompt_length/mean': 409.625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.2875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  93%|█████████▎| 487/525 [9:07:47<54:07, 85.47s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  93%|█████████▎| 488/525 [9:09:11<52:19, 84.86s/it]
[36m(TaskRunner pid=2949575)[0m step:487 - global_seqlen/min:62056 - global_seqlen/max:84228 - global_seqlen/minmax_diff:22172 - global_seqlen/balanced_min:71942 - global_seqlen/balanced_max:71946 - global_seqlen/mean:71944.25 - actor/entropy:0.04714374989271164 - actor/kl_loss:0.2841593701392412 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11210699565708637 - actor/pg_clipfrac:0.001753993716556579 - actor/ppo_kl:0.01105743166845059 - actor/pg_clipfrac_lower:4.2105262400582434e-05 - actor/grad_norm:0.5160937458276749 - perf/mfu/actor:0.17650396080858685 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.33203125 - perf/cpu_memory_used_gb:97.28180694580078 - actor/lr:1e-06 - training/global_step:487 - training/epoch:13 - critic/score/mean:0.2874999940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.2874999940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.21084977686405182 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.21084977686405182 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1388.981201171875 - response_length/max:2048.0 - response_length/min:91.0 - response_length/clip_ratio:0.625 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.2875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.473917841911316e-05 - timing_s/generate_sequences:68.81397247314453 - timing_s/reshard:0.8539872169494629 - timing_s/gen:70.97219415195286 - timing_s/reward:0.18445184640586376 - timing_s/old_log_prob:2.2279136329889297 - timing_s/ref:2.006184371188283 - timing_s/adv:0.008279286324977875 - timing_s/update_actor:9.223319228738546 - timing_s/step:84.63916771300137 - timing_s/stop_profile:4.4655054807662964e-05 - timing_per_token_ms/adv:1.4384899288299403e-05 - timing_per_token_ms/gen:0.15967681833347477 - timing_per_token_ms/ref:0.003485657942066744 - timing_per_token_ms/update_actor:0.01602511533016632 - perf/total_num_tokens:575554 - perf/time_per_step:84.63916771300137 - perf/throughput:850.0113120671517
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5718749761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5718749761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.23909501731395721, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.23909501731395721, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1148.143798828125, 'response_length/max': 2048.0, 'response_length/min': 91.0, 'response_length/clip_ratio': 0.4749999940395355, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.571875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:488 - global_seqlen/min:47766 - global_seqlen/max:80622 - global_seqlen/minmax_diff:32856 - global_seqlen/balanced_min:62288 - global_seqlen/balanced_max:62289 - global_seqlen/mean:62288.875 - actor/entropy:0.07830237597227097 - actor/kl_loss:0.2959456544369459 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.18199030142277478 - actor/pg_clipfrac:0.00043015726114390416 - actor/ppo_kl:0.035257931976047985 - actor/pg_clipfrac_lower:0.00010789814405143261 - actor/grad_norm:26.169922165572643 - perf/mfu/actor:0.1540244660491206 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.25549697875977 - actor/lr:1e-06 - training/global_step:488 - training/epoch:13 - critic/score/mean:0.5718749761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5718749761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.23909501731395721 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.23909501731395721 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.78885018825531 - response_length/mean:1148.143798828125 - response_length/max:2048.0 - response_length/min:91.0 - response_length/clip_ratio:0.4749999940395355 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.571875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010287761688232422 - timing_s/generate_sequences:67.79644775390625 - timing_s/reshard:0.8403497338294983 - timing_s/gen:70.06815628893673 - timing_s/reward:0.15937276929616928 - timing_s/old_log_prob:2.129329279065132 - timing_s/ref:1.7872893549501896 - timing_s/adv:0.007988369092345238 - timing_s/update_actor:9.088947357609868 - timing_s/step:83.25809419155121 - timing_s/stop_profile:4.3934211134910583e-05 - timing_per_token_ms/adv:1.603089053291065e-05 - timing_per_token_ms/gen:0.19071043012072947 - timing_per_token_ms/ref:0.0035866945641380376 - timing_per_token_ms/update_actor:0.01823950777247516 - perf/total_num_tokens:498311 - perf/time_per_step:83.25809419155121 - perf/throughput:748.1419747213106
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.668749988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.668749988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.23868180811405182, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.23868180811405182, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1023.0906372070312, 'response_length/max': 2048.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.40312498807907104, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.66875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  93%|█████████▎| 489/525 [9:10:33<50:29, 84.15s/it]
[36m(WorkerDict pid=2951184)[0m INFO:2025-08-06 08:51:45,874:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 08:51:50,586:[Rank 7] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/optim_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951187)[0m INFO:2025-08-06 08:51:50,589:[Rank 7] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/extra_state_world_size_8_rank_7.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:51:46,035:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 08:51:51,656:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  93%|█████████▎| 490/525 [9:12:06<50:36, 86.75s/it]
[36m(TaskRunner pid=2949575)[0m step:489 - global_seqlen/min:42774 - global_seqlen/max:76217 - global_seqlen/minmax_diff:33443 - global_seqlen/balanced_min:57128 - global_seqlen/balanced_max:58247 - global_seqlen/mean:57282.375 - actor/entropy:0.10342562943696976 - actor/kl_loss:0.28164933137595655 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.32720393799245356 - actor/pg_clipfrac:0.001242736777930986 - actor/ppo_kl:-0.01886711336856024 - actor/pg_clipfrac_lower:0.0015513180202106013 - actor/grad_norm:34.95744650438428 - perf/mfu/actor:0.14844397438347925 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.23779678344727 - actor/lr:1e-06 - training/global_step:489 - training/epoch:13 - critic/score/mean:0.668749988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.668749988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.23868180811405182 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.23868180811405182 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1023.0906372070312 - response_length/max:2048.0 - response_length/min:74.0 - response_length/clip_ratio:0.40312498807907104 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.66875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010208785533905029 - timing_s/generate_sequences:66.96563720703125 - timing_s/reshard:0.840043842792511 - timing_s/gen:70.04282497800887 - timing_s/reward:0.14796465262770653 - timing_s/old_log_prob:1.888021256774664 - timing_s/ref:1.6598498094826937 - timing_s/adv:0.008219029754400253 - timing_s/update_actor:8.642743965610862 - timing_s/step:82.40655658394098 - timing_s/stop_profile:4.301778972148895e-05 - timing_per_token_ms/adv:1.7935337340674712e-05 - timing_per_token_ms/gen:0.21394373353414092 - timing_per_token_ms/ref:0.003622077928600843 - timing_per_token_ms/update_actor:0.018859954666707826 - perf/total_num_tokens:458259 - perf/time_per_step:82.40655658394098 - perf/throughput:695.1191431188005
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.690625011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.690625011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.20058991014957428, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.20058991014957428, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1042.409423828125, 'response_length/max': 2048.0, 'response_length/min': 82.0, 'response_length/clip_ratio': 0.4156250059604645, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.690625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:490 - global_seqlen/min:32305 - global_seqlen/max:77800 - global_seqlen/minmax_diff:45495 - global_seqlen/balanced_min:57404 - global_seqlen/balanced_max:58435 - global_seqlen/mean:58063.875 - actor/entropy:0.09894296526908875 - actor/kl_loss:0.24830989800393583 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.04599200654774904 - actor/pg_clipfrac:0.0012731861614156514 - actor/ppo_kl:0.00026819180020538625 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:16.15973900258541 - perf/mfu/actor:0.1520560483099946 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.24483489990234 - actor/lr:1e-06 - training/global_step:490 - training/epoch:13 - critic/score/mean:0.690625011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.690625011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.20058991014957428 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.20058991014957428 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1042.409423828125 - response_length/max:2048.0 - response_length/min:82.0 - response_length/clip_ratio:0.4156250059604645 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.690625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.476711809635162e-05 - timing_s/generate_sequences:66.62749481201172 - timing_s/reshard:0.7886420488357544 - timing_s/gen:70.10787691548467 - timing_s/reward:0.1495407298207283 - timing_s/old_log_prob:1.8727066442370415 - timing_s/ref:1.6406827103346586 - timing_s/adv:0.007821623235940933 - timing_s/update_actor:8.554370924830437 - timing_s/save_checkpoint:10.436306731775403 - timing_s/step:92.78299229592085 - timing_s/stop_profile:4.851445555686951e-05 - timing_per_token_ms/adv:1.68384026125128e-05 - timing_per_token_ms/gen:0.21017377684356453 - timing_per_token_ms/ref:0.0035320642790690826 - timing_per_token_ms/update_actor:0.018415862971663612 - perf/total_num_tokens:464511 - perf/time_per_step:92.78299229592085 - perf/throughput:625.8030007785462
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.643750011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.643750011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.22370527684688568, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.22370527684688568, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1090.53125, 'response_length/max': 2048.0, 'response_length/min': 93.0, 'response_length/clip_ratio': 0.45625001192092896, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.64375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  94%|█████████▎| 491/525 [9:13:32<48:58, 86.41s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:51:52,712:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 08:51:52,714:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_490/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  94%|█████████▎| 492/525 [9:14:56<47:05, 85.63s/it]
[36m(TaskRunner pid=2949575)[0m step:491 - global_seqlen/min:42321 - global_seqlen/max:87742 - global_seqlen/minmax_diff:45421 - global_seqlen/balanced_min:59680 - global_seqlen/balanced_max:60910 - global_seqlen/mean:59988.75 - actor/entropy:0.082106813788414 - actor/kl_loss:0.2920220516622066 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03810372669249773 - actor/pg_clipfrac:0.0006400802783900871 - actor/ppo_kl:-0.011640021352286567 - actor/pg_clipfrac_lower:0.0009593456852599047 - actor/grad_norm:11.40729121863842 - perf/mfu/actor:0.15323313907077651 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.27567672729492 - actor/lr:1e-06 - training/global_step:491 - training/epoch:14 - critic/score/mean:0.643750011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.643750011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.22370527684688568 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.22370527684688568 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1090.53125 - response_length/max:2048.0 - response_length/min:93.0 - response_length/clip_ratio:0.45625001192092896 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.64375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0003350377082824707 - timing_s/generate_sequences:67.29915618896484 - timing_s/reshard:0.841076672077179 - timing_s/gen:70.93672126345336 - timing_s/reward:0.15637778118252754 - timing_s/old_log_prob:2.064654126763344 - timing_s/ref:1.74880656786263 - timing_s/adv:0.008913233876228333 - timing_s/update_actor:8.791725846007466 - timing_s/step:83.73819177038968 - timing_s/stop_profile:4.187040030956268e-05 - timing_per_token_ms/adv:1.8572719627072434e-05 - timing_per_token_ms/gen:0.2032745544415089 - timing_per_token_ms/ref:0.0036440302720564897 - timing_per_token_ms/update_actor:0.018319530424470144 - perf/total_num_tokens:479910 - perf/time_per_step:83.73819177038968 - perf/throughput:716.3845878651082
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4296875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4296875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.19621597230434418, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.19621597230434418, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1221.206298828125, 'response_length/max': 2048.0, 'response_length/min': 100.0, 'response_length/clip_ratio': 0.5062500238418579, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4296875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:492 - global_seqlen/min:44647 - global_seqlen/max:83627 - global_seqlen/minmax_diff:38980 - global_seqlen/balanced_min:64971 - global_seqlen/balanced_max:65914 - global_seqlen/mean:65211.375 - actor/entropy:0.07645069807767868 - actor/kl_loss:0.28046047389507295 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10060921059921384 - actor/pg_clipfrac:0.001619281288003549 - actor/ppo_kl:-0.00942645004906808 - actor/pg_clipfrac_lower:0.0006150160159450024 - actor/grad_norm:3.0750403851270676 - perf/mfu/actor:0.1618664439834032 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.3933334350586 - actor/lr:1e-06 - training/global_step:492 - training/epoch:14 - critic/score/mean:0.4296875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4296875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.19621597230434418 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.19621597230434418 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1221.206298828125 - response_length/max:2048.0 - response_length/min:100.0 - response_length/clip_ratio:0.5062500238418579 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4296875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.328126907348633e-05 - timing_s/generate_sequences:67.3106689453125 - timing_s/reshard:0.8664998412132263 - timing_s/gen:70.3900201395154 - timing_s/reward:0.16569924168288708 - timing_s/old_log_prob:2.1943693552166224 - timing_s/ref:1.7474695891141891 - timing_s/adv:0.007546592503786087 - timing_s/update_actor:9.066961711272597 - timing_s/step:83.585199393332 - timing_s/stop_profile:4.275515675544739e-05 - timing_per_token_ms/adv:1.4465636753913881e-05 - timing_per_token_ms/gen:0.18012421156212197 - timing_per_token_ms/ref:0.003349625715441112 - timing_per_token_ms/update_actor:0.01737994658001115 - perf/total_num_tokens:521691 - perf/time_per_step:83.585199393332 - perf/throughput:780.1784941988453
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6703125238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6703125238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1297461986541748, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1297461986541748, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1044.1343994140625, 'response_length/max': 2048.0, 'response_length/min': 90.0, 'response_length/clip_ratio': 0.4000000059604645, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  94%|█████████▍| 493/525 [9:16:17<45:01, 84.44s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  94%|█████████▍| 494/525 [9:17:39<43:09, 83.53s/it]
[36m(TaskRunner pid=2949575)[0m step:493 - global_seqlen/min:49435 - global_seqlen/max:72331 - global_seqlen/minmax_diff:22896 - global_seqlen/balanced_min:58132 - global_seqlen/balanced_max:58133 - global_seqlen/mean:58132.875 - actor/entropy:0.11465419083833694 - actor/kl_loss:0.2610884353518486 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.015952456928789615 - actor/pg_clipfrac:0.0009430067540961318 - actor/ppo_kl:-0.00020895323705190095 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:48.489527463912964 - perf/mfu/actor:0.1490256550926514 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.32160568237305 - actor/lr:1e-06 - training/global_step:493 - training/epoch:14 - critic/score/mean:0.6703125238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6703125238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1297461986541748 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1297461986541748 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1044.1343994140625 - response_length/max:2048.0 - response_length/min:90.0 - response_length/clip_ratio:0.4000000059604645 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.679872214794159e-05 - timing_s/generate_sequences:66.68891143798828 - timing_s/reshard:0.8320346474647522 - timing_s/gen:69.14677185192704 - timing_s/reward:0.1477815005928278 - timing_s/old_log_prob:1.954447753727436 - timing_s/ref:1.6533277332782745 - timing_s/adv:0.007514718919992447 - timing_s/update_actor:8.727067355066538 - timing_s/step:81.65006068535149 - timing_s/stop_profile:4.210323095321655e-05 - timing_per_token_ms/adv:1.615849663377316e-05 - timing_per_token_ms/gen:0.206950050885234 - timing_per_token_ms/ref:0.0035550618588842254 - timing_per_token_ms/update_actor:0.018765344383592196 - perf/total_num_tokens:465063 - perf/time_per_step:81.65006068535149 - perf/throughput:711.9758945926832
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6968749761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6968749761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12382560223340988, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12382560223340988, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1018.1843872070312, 'response_length/max': 2048.0, 'response_length/min': 7.0, 'response_length/clip_ratio': 0.3968749940395355, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.696875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:494 - global_seqlen/min:50465 - global_seqlen/max:63902 - global_seqlen/minmax_diff:13437 - global_seqlen/balanced_min:56333 - global_seqlen/balanced_max:57207 - global_seqlen/mean:57094.875 - actor/entropy:0.11388351768255234 - actor/kl_loss:0.26353289745748043 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.013335296697914601 - actor/pg_clipfrac:0.0005336529080523178 - actor/ppo_kl:7.357394779319292e-05 - actor/pg_clipfrac_lower:6.578947650268674e-05 - actor/grad_norm:1.2383342236280441 - perf/mfu/actor:0.14502345733587652 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.27920532226562 - actor/lr:1e-06 - training/global_step:494 - training/epoch:14 - critic/score/mean:0.6968749761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6968749761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12382560223340988 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12382560223340988 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1018.1843872070312 - response_length/max:2048.0 - response_length/min:7.0 - response_length/clip_ratio:0.3968749940395355 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.696875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010162033140659332 - timing_s/generate_sequences:66.63141632080078 - timing_s/reshard:0.7521107792854309 - timing_s/gen:68.95062289945781 - timing_s/reward:0.1462377943098545 - timing_s/old_log_prob:1.8688922673463821 - timing_s/ref:1.606747230514884 - timing_s/adv:0.007747197523713112 - timing_s/update_actor:8.809332193806767 - timing_s/step:81.40298901125789 - timing_s/stop_profile:4.310533404350281e-05 - timing_per_token_ms/adv:1.6961236721582087e-05 - timing_per_token_ms/gen:0.21162247413274798 - timing_per_token_ms/ref:0.0035177133466770968 - timing_per_token_ms/update_actor:0.019286608898361646 - perf/total_num_tokens:456759 - perf/time_per_step:81.40298901125789 - perf/throughput:701.3854858831274
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4921875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4921875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.17844060063362122, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.17844060063362122, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1203.753173828125, 'response_length/max': 2048.0, 'response_length/min': 85.0, 'response_length/clip_ratio': 0.5093749761581421, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  94%|█████████▍| 495/525 [9:19:02<41:40, 83.35s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  94%|█████████▍| 496/525 [9:20:24<40:13, 83.22s/it]
[36m(TaskRunner pid=2949575)[0m step:495 - global_seqlen/min:46472 - global_seqlen/max:76240 - global_seqlen/minmax_diff:29768 - global_seqlen/balanced_min:64154 - global_seqlen/balanced_max:65143 - global_seqlen/mean:64530.75 - actor/entropy:0.06589693576097488 - actor/kl_loss:0.2921496149152517 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1901534458156675 - actor/pg_clipfrac:0.00040745509177213534 - actor/ppo_kl:0.00035732297710637794 - actor/pg_clipfrac_lower:6.675567710772157e-05 - actor/grad_norm:3.8183454796671867 - perf/mfu/actor:0.1618085159966777 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.20637130737305 - actor/lr:1e-06 - training/global_step:495 - training/epoch:14 - critic/score/mean:0.4921875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4921875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.17844060063362122 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.17844060063362122 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1203.753173828125 - response_length/max:2048.0 - response_length/min:85.0 - response_length/clip_ratio:0.5093749761581421 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.346753358840942e-05 - timing_s/generate_sequences:67.55494689941406 - timing_s/reshard:0.7861469984054565 - timing_s/gen:69.91061305627227 - timing_s/reward:0.16561969183385372 - timing_s/old_log_prob:1.9814615566283464 - timing_s/ref:1.7016132287681103 - timing_s/adv:0.007629832252860069 - timing_s/update_actor:8.97882735542953 - timing_s/step:82.75889660045505 - timing_s/stop_profile:4.2377039790153503e-05 - timing_per_token_ms/adv:1.4779450596924856e-05 - timing_per_token_ms/gen:0.1814912553608954 - timing_per_token_ms/ref:0.003296128645583908 - timing_per_token_ms/update_actor:0.01739253641757908 - perf/total_num_tokens:516246 - perf/time_per_step:82.75889660045505 - perf/throughput:779.743962894319
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.598437488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.598437488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08025200664997101, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.08025200664997101, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1091.074951171875, 'response_length/max': 2048.0, 'response_length/min': 48.0, 'response_length/clip_ratio': 0.43437498807907104, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5984375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:496 - global_seqlen/min:42818 - global_seqlen/max:71885 - global_seqlen/minmax_diff:29067 - global_seqlen/balanced_min:59697 - global_seqlen/balanced_max:60589 - global_seqlen/mean:60032.375 - actor/entropy:0.09384027868509293 - actor/kl_loss:0.2702958628535271 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07619444099254906 - actor/pg_clipfrac:0.0010742768121417613 - actor/ppo_kl:0.004245068983436795 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.466363251209259 - perf/mfu/actor:0.15055460301335163 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.16433334350586 - actor/lr:1e-06 - training/global_step:496 - training/epoch:14 - critic/score/mean:0.598437488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.598437488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08025200664997101 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.08025200664997101 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1091.074951171875 - response_length/max:2048.0 - response_length/min:48.0 - response_length/clip_ratio:0.43437498807907104 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5984375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.120201528072357e-05 - timing_s/generate_sequences:67.42132568359375 - timing_s/reshard:0.8071801662445068 - timing_s/gen:69.99164171516895 - timing_s/reward:0.15238606929779053 - timing_s/old_log_prob:2.0447735022753477 - timing_s/ref:1.7511454597115517 - timing_s/adv:0.007941154763102531 - timing_s/update_actor:8.947478175163269 - timing_s/step:82.90877656079829 - timing_s/stop_profile:4.2904168367385864e-05 - timing_per_token_ms/adv:1.6535150331597184e-05 - timing_per_token_ms/gen:0.20046640273116237 - timing_per_token_ms/ref:0.0036462522507887444 - timing_per_token_ms/update_actor:0.018630526809832338 - perf/total_num_tokens:480259 - perf/time_per_step:82.90877656079829 - perf/throughput:724.0774437912171
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11261407285928726, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.11261407285928726, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1025.925048828125, 'response_length/max': 2048.0, 'response_length/min': 70.0, 'response_length/clip_ratio': 0.40312498807907104, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  95%|█████████▍| 497/525 [9:21:46<38:39, 82.85s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  95%|█████████▍| 498/525 [9:23:09<37:15, 82.81s/it]
[36m(TaskRunner pid=2949575)[0m step:497 - global_seqlen/min:47035 - global_seqlen/max:66615 - global_seqlen/minmax_diff:19580 - global_seqlen/balanced_min:57272 - global_seqlen/balanced_max:58352 - global_seqlen/mean:57408.875 - actor/entropy:0.10144414752721786 - actor/kl_loss:0.27756507843732836 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15852829515933992 - actor/pg_clipfrac:0.0005429919838206843 - actor/ppo_kl:0.0037679389120967243 - actor/pg_clipfrac_lower:9.157509193755687e-05 - actor/grad_norm:2.1618722453713417 - perf/mfu/actor:0.14484608994601092 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.24597549438477 - actor/lr:1e-06 - training/global_step:497 - training/epoch:14 - critic/score/mean:0.6875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11261407285928726 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.11261407285928726 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888517379760742 - response_length/mean:1025.925048828125 - response_length/max:2048.0 - response_length/min:70.0 - response_length/clip_ratio:0.40312498807907104 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.233636617660522e-05 - timing_s/generate_sequences:66.8367919921875 - timing_s/reshard:0.84486985206604 - timing_s/gen:69.34393257647753 - timing_s/reward:0.149013452231884 - timing_s/old_log_prob:1.929017411544919 - timing_s/ref:1.6660380028188229 - timing_s/adv:0.007689904421567917 - timing_s/update_actor:8.87228642962873 - timing_s/step:81.9811019282788 - timing_s/stop_profile:4.3530017137527466e-05 - timing_per_token_ms/adv:1.6743718679315517e-05 - timing_per_token_ms/gen:0.21122381197601411 - timing_per_token_ms/ref:0.0036275706561459853 - timing_per_token_ms/update_actor:0.019318194333255812 - perf/total_num_tokens:459271 - perf/time_per_step:81.9811019282788 - perf/throughput:700.2696188473311
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.38593751192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.38593751192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09708182513713837, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09708182513713837, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1261.043701171875, 'response_length/max': 2048.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.5406249761581421, 'prompt_length/mean': 410.171875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.3859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:498 - global_seqlen/min:58522 - global_seqlen/max:75256 - global_seqlen/minmax_diff:16734 - global_seqlen/balanced_min:66195 - global_seqlen/balanced_max:67190 - global_seqlen/mean:66848.625 - actor/entropy:0.07219953089952469 - actor/kl_loss:0.2874185897409916 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06111205406486988 - actor/pg_clipfrac:0.0004683422797825187 - actor/ppo_kl:0.0044283170431299364 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:4.744398921728134 - perf/mfu/actor:0.16072997799815156 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.21150207519531 - actor/lr:1e-06 - training/global_step:498 - training/epoch:14 - critic/score/mean:0.38593751192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.38593751192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09708182513713837 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09708182513713837 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1261.043701171875 - response_length/max:2048.0 - response_length/min:92.0 - response_length/clip_ratio:0.5406249761581421 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.3859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.776411414146423e-05 - timing_s/generate_sequences:67.13172912597656 - timing_s/reshard:0.7204536199569702 - timing_s/gen:69.09577410109341 - timing_s/reward:0.17126012593507767 - timing_s/old_log_prob:2.1282738149166107 - timing_s/ref:1.8201324604451656 - timing_s/adv:0.008359577506780624 - timing_s/update_actor:9.378063095733523 - timing_s/step:82.61977767013013 - timing_s/stop_profile:4.678778350353241e-05 - timing_per_token_ms/adv:1.5631543481224603e-05 - timing_per_token_ms/gen:0.17122664781925045 - timing_per_token_ms/ref:0.003403459047297468 - timing_per_token_ms/update_actor:0.01753600596821087 - perf/total_num_tokens:534789 - perf/time_per_step:82.61977767013013 - perf/throughput:809.1116544382576
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.46406251192092896, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.46406251192092896, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10200976580381393, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10200976580381393, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1200.8125, 'response_length/max': 2048.0, 'response_length/min': 97.0, 'response_length/clip_ratio': 0.503125011920929, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  95%|█████████▌| 499/525 [9:24:34<36:10, 83.49s/it]
[36m(TaskRunner pid=2949575)[0m step:499 - global_seqlen/min:47956 - global_seqlen/max:82076 - global_seqlen/minmax_diff:34120 - global_seqlen/balanced_min:64262 - global_seqlen/balanced_max:65402 - global_seqlen/mean:64426.25 - actor/entropy:0.0736062079668045 - actor/kl_loss:0.27313151098787786 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.24894991237670183 - actor/pg_clipfrac:0.0011942186407395638 - actor/ppo_kl:0.0037523946099099702 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:9.636460419744253 - perf/mfu/actor:0.15516725536686854 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.38448715209961 - actor/lr:1e-06 - training/global_step:499 - training/epoch:14 - critic/score/mean:0.46406251192092896 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.46406251192092896 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10200976580381393 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10200976580381393 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1200.8125 - response_length/max:2048.0 - response_length/min:97.0 - response_length/clip_ratio:0.503125011920929 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010378845036029816 - timing_s/generate_sequences:68.11454010009766 - timing_s/reshard:0.8594772815704346 - timing_s/gen:71.25037675537169 - timing_s/reward:0.1663480345159769 - timing_s/old_log_prob:2.2201518174260855 - timing_s/ref:1.8505250699818134 - timing_s/adv:0.008246239274740219 - timing_s/update_actor:9.34702187590301 - timing_s/step:84.85991346091032 - timing_s/stop_profile:4.704296588897705e-05 - timing_per_token_ms/adv:1.5999377727906364e-05 - timing_per_token_ms/gen:0.18542230977820146 - timing_per_token_ms/ref:0.0035903941909970964 - timing_per_token_ms/update_actor:0.018135119372738227 - perf/total_num_tokens:515410 - perf/time_per_step:84.85991346091032 - perf/throughput:759.2071140831079
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 500}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, the standard form of the equation of the hyperbola is:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \frac{x^2}{a^2} - \frac{y^2}{b^2} = 1
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Since the hyperbola is equilateral, \(a = b\). Therefore, the equation simplifies to:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x^2 - y^2 = a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The equation of the parabola is:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m y^2 = 16x
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The focus of the parabola \(y^2 = 16x\) is at \((4, 0)\) and the directrix is the line \(x = -4\). The hyperbola intersects the parabola at points \(A\) and \(B\), and the distance between the points of intersection is given as \(|AB| = 4\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the parabola can be found using the properties of the hyperbola and the parabola. The distance between the points of intersection of the hyperbola and the parabola is related to the distance between the foci of the hyperbola and the directrix of the parabola.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the parabola is given by:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m |AB| = 4\sqrt{3}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the parabola is also related to the distance between the foci of the hyperbola and the directrix of the parabola. The distance between the foci of the hyperbola is \(2c\) and the distance between the directrix of the parabola and the point of intersection of the hyperbola and the parabola is \(4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the parabola is given by:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m |AB| = 4\sqrt{3}
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the parabola is also related to the distance between the foci of the hyperbola and the directrix of the parabola. The distance between the foci of the hyperbola is \(2c\) and the distance between the directأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاع[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:06:58,741:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:07:03,538:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:07:03,540:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:06:59,175:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:07:04,070:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/huggingface

[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] -0.5
[36m(TaskRunner pid=2949575)[0m [structure] -0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.0
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4515624940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4515624940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09744983166456223, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.09744983166456223, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1199.1937255859375, 'response_length/max': 2048.0, 'response_length/min': 60.0, 'response_length/clip_ratio': 0.5, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:500 - global_seqlen/min:55294 - global_seqlen/max:73628 - global_seqlen/minmax_diff:18334 - global_seqlen/balanced_min:64361 - global_seqlen/balanced_max:64362 - global_seqlen/mean:64361.5 - actor/entropy:0.07415705919265747 - actor/kl_loss:0.3182614505290985 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09687367090955376 - actor/pg_clipfrac:0.0007707303506322205 - actor/ppo_kl:0.0003800191700065625 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:63.88699496537447 - perf/mfu/actor:0.1586060851910892 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.41716003417969 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:0.395 - val-aux/grpo_convert/reward/std@50:0.4692813654940925 - val-aux/grpo_convert/reward/best@2/mean:0.62875 - val-aux/grpo_convert/reward/best@2/std:0.283920653528411 - val-aux/grpo_convert/reward/worst@2/mean:0.15550000000000003 - val-aux/grpo_convert/reward/worst@2/std:0.5068971789229054 - val-aux/grpo_convert/reward/best@4/mean:0.73125 - val-aux/grpo_convert/reward/best@4/std:0.09980449639169571 - val-aux/grpo_convert/reward/worst@4/mean:-0.12575 - val-aux/grpo_convert/reward/worst@4/std:0.4458132316340554 - val-aux/grpo_convert/reward/best@8/mean:0.7495 - val-aux/grpo_convert/reward/best@8/std:0.01580348062927911 - val-aux/grpo_convert/reward/worst@8/mean:-0.33825 - val-aux/grpo_convert/reward/worst@8/std:0.31547493957523787 - val-aux/grpo_convert/reward/best@16/mean:0.75 - val-aux/grpo_convert/reward/best@16/std:0.0 - val-aux/grpo_convert/reward/worst@16/mean:-0.46175 - val-aux/grpo_convert/reward/worst@16/std:0.16499829544574085 - val-aux/grpo_convert/reward/best@32/mean:0.75 - val-aux/grpo_convert/reward/best@32/std:0.0 - val-aux/grpo_convert/reward/worst@32/mean:-0.4985 - val-aux/grpo_convert/reward/worst@32/std:0.03350746185553301 - val-aux/grpo_convert/reward/best@50/mean:0.75 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.5 - val-aux/grpo_convert/reward/worst@50/std:0.0 - val-aux/grpo_convert/score/mean@50:0.395 - val-aux/grpo_convert/score/std@50:0.4692813654940925 - val-aux/grpo_convert/score/best@2/mean:0.62875 - val-aux/grpo_convert/score/best@2/std:0.283920653528411 - val-aux/grpo_convert/score/worst@2/mean:0.15550000000000003 - val-aux/grpo_convert/score/worst@2/std:0.5068971789229054 - val-aux/grpo_convert/score/best@4/mean:0.73125 - val-aux/grpo_convert/score/best@4/std:0.09980449639169571 - val-aux/grpo_convert/score/worst@4/mean:-0.12575 - val-aux/grpo_convert/score/worst@4/std:0.4458132316340554 - val-aux/grpo_convert/score/best@8/mean:0.7495 - val-aux/grpo_convert/score/best@8/std:0.01580348062927911 - val-aux/grpo_convert/score/worst@8/mean:-0.33825 - val-aux/grpo_convert/score/worst@8/std:0.31547493957523787 - val-aux/grpo_convert/score/best@16/mean:0.75 - val-aux/grpo_convert/score/best@16/std:0.0 - val-aux/grpo_convert/score/worst@16/mean:-0.46175 - val-aux/grpo_convert/score/worst@16/std:0.16499829544574085 - val-aux/grpo_convert/score/best@32/mean:0.75 - val-aux/grpo_convert/score/best@32/std:0.0 - val-aux/grpo_convert/score/worst@32/mean:-0.4985 - val-aux/grpo_convert/score/worst@32/std:0.03350746185553301 - val-aux/grpo_convert/score/best@50/mean:0.75 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.5 - val-aux/grpo_convert/score/worst@50/std:0.0 - val-aux/grpo_convert/structure/mean@50:-0.09 - val-aux/grpo_convert/structure/std@50:0.19209372712298547 - val-aux/grpo_convert/structure/best@2/mean:-0.01849999999999999 - val-aux/grpo_convert/structure/best@2/std:0.09438087730043622 - val-aux/grpo_convert/structure/worst@2/mean:-0.16699999999999998 - val-aux/grpo_convert/structure/worst@2/std:0.23581984649303797 - val-aux/grpo_convert/structure/best@4/mean:-0.0005000000000000004 - val-aux/grpo_convert/structure/best@4/std:0.01580348062927911 - val-aux/grpo_convert/structure/worst@4/mean:-0.2815 - val-aux/grpo_convert/structure/worst@4/std:0.24800756036863067 - val-aux/grpo_convert/structure/best@8/mean:0.0 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.39449999999999996 - val-aux/grpo_convert/structure/worst@8/std:0.20400919096942666 - val-aux/grpo_convert/structure/best@16/mean:0.0 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.47450000000000003 - val-aux/grpo_convert/structure/worst@16/std:0.10999886363049392 - val-aux/grpo_convert/structure/best@32/mean:0.0 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.499 - val-aux/grpo_convert/structure/worst@32/std:0.022338307903688678 - val-aux/grpo_convert/structure/best@50/mean:0.0 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.5 - val-aux/grpo_convert/structure/worst@50/std:0.0 - val-aux/grpo_convert/boxed/mean@50:0.205 - val-aux/grpo_convert/boxed/std@50:0.09604686356149272 - val-aux/grpo_convert/boxed/best@2/mean:0.24075 - val-aux/grpo_convert/boxed/best@2/std:0.04719043865021811 - val-aux/grpo_convert/boxed/worst@2/mean:0.1665 - val-aux/grpo_convert/boxed/worst@2/std:0.11790992324651899 - val-aux/grpo_convert/boxed/best@4/mean:0.24975 - val-aux/grpo_convert/boxed/best@4/std:0.007901740314639555 - val-aux/grpo_convert/boxed/worst@4/mean:0.10925 - val-aux/grpo_convert/boxed/worst@4/std:0.12400378018431533 - val-aux/grpo_convert/boxed/best@8/mean:0.25 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.05275 - val-aux/grpo_convert/boxed/worst@8/std:0.10200459548471334 - val-aux/grpo_convert/boxed/best@16/mean:0.25 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.01275 - val-aux/grpo_convert/boxed/worst@16/std:0.054999431815246955 - val-aux/grpo_convert/boxed/best@32/mean:0.25 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.0005 - val-aux/grpo_convert/boxed/worst@32/std:0.011169153951844339 - val-aux/grpo_convert/boxed/best@50/mean:0.25 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.0 - val-aux/grpo_convert/boxed/worst@50/std:0.0 - val-aux/grpo_convert/correct/mean@50:0.28 - val-aux/grpo_convert/correct/std@50:0.2481934729198171 - val-aux/grpo_convert/correct/best@2/mean:0.4065 - val-aux/grpo_convert/correct/best@2/std:0.19495576421332095 - val-aux/grpo_convert/correct/worst@2/mean:0.156 - val-aux/grpo_convert/correct/worst@2/std:0.23165491576912414 - val-aux/grpo_convert/correct/best@4/mean:0.482 - val-aux/grpo_convert/correct/best@4/std:0.09314504817756013 - val-aux/grpo_convert/correct/worst@4/mean:0.0465 - val-aux/grpo_convert/correct/worst@4/std:0.1452162181025246 - val-aux/grpo_convert/correct/best@8/mean:0.4995 - val-aux/grpo_convert/correct/best@8/std:0.01580348062927911 - val-aux/grpo_convert/correct/worst@8/mean:0.0035 - val-aux/grpo_convert/correct/worst@8/std:0.041686328694189416 - val-aux/grpo_convert/correct/best@16/mean:0.5 - val-aux/grpo_convert/correct/best@16/std:0.0 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.5 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.5 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.28 - val-aux/grpo_convert/acc/std@50:0.2481934729198171 - val-aux/grpo_convert/acc/best@2/mean:0.4065 - val-aux/grpo_convert/acc/best@2/std:0.19495576421332095 - val-aux/grpo_convert/acc/worst@2/mean:0.156 - val-aux/grpo_convert/acc/worst@2/std:0.23165491576912414 - val-aux/grpo_convert/acc/best@4/mean:0.482 - val-aux/grpo_convert/acc/best@4/std:0.09314504817756013 - val-aux/grpo_convert/acc/worst@4/mean:0.0465 - val-aux/grpo_convert/acc/worst@4/std:0.1452162181025246 - val-aux/grpo_convert/acc/best@8/mean:0.4995 - val-aux/grpo_convert/acc/best@8/std:0.01580348062927911 - val-aux/grpo_convert/acc/worst@8/mean:0.0035 - val-aux/grpo_convert/acc/worst@8/std:0.041686328694189416 - val-aux/grpo_convert/acc/best@16/mean:0.5 - val-aux/grpo_convert/acc/best@16/std:0.0 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.5 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.5 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:500 - training/epoch:14 - critic/score/mean:0.4515624940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4515624940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09744983166456223 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.09744983166456223 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:1199.1937255859375 - response_length/max:2048.0 - response_length/min:60.0 - response_length/clip_ratio:0.5 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.00010403245687484741 - timing_s/generate_sequences:68.8233413696289 - timing_s/reshard:0.9046053886413574 - timing_s/gen:70.90463053248823 - timing_s/reward:0.16524410247802734 - timing_s/old_log_prob:2.020937627181411 - timing_s/ref:1.7458135392516851 - timing_s/adv:0.00812157429754734 - timing_s/update_actor:9.13698848709464 - timing_s/testing:70.05559332482517 - timing_s/save_checkpoint:10.391154082491994 - timing_s/step:164.4462292511016 - timing_s/stop_profile:5.747005343437195e-05 - timing_per_token_ms/adv:1.5773354990070423e-05 - timing_per_token_ms/gen:0.18477161877638681 - timing_per_token_ms/ref:0.0033906402493176922 - timing_per_token_ms/update_actor:0.017745446592867323 - perf/total_num_tokens:514892 - perf/time_per_step:164.4462292511016 - perf/throughput:391.3832521007401[36m(TaskRunner pid=2949575)[0m Training Progress:  95%|█████████▌| 500/525 [9:27:19<44:56, 107.86s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  95%|█████████▌| 501/525 [9:28:44<40:25, 101.05s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:07:05,573:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:07:05,575:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_500/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  96%|█████████▌| 502/525 [9:30:09<36:49, 96.06s/it] 

[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.2578125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.2578125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14344696700572968, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14344696700572968, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1403.496826171875, 'response_length/max': 2048.0, 'response_length/min': 102.0, 'response_length/clip_ratio': 0.625, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.2578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:501 - global_seqlen/min:57467 - global_seqlen/max:87592 - global_seqlen/minmax_diff:30125 - global_seqlen/balanced_min:72542 - global_seqlen/balanced_max:72543 - global_seqlen/mean:72542.375 - actor/entropy:0.04535199701786041 - actor/kl_loss:0.31679935231804845 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.018950864486396313 - actor/pg_clipfrac:0.0018440651329001412 - actor/ppo_kl:-0.013468593107609195 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:32.92372427135706 - perf/mfu/actor:0.17640644384884258 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.40343475341797 - actor/lr:1e-06 - training/global_step:501 - training/epoch:14 - critic/score/mean:0.2578125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.2578125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14344696700572968 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14344696700572968 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1403.496826171875 - response_length/max:2048.0 - response_length/min:102.0 - response_length/clip_ratio:0.625 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.2578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.709674537181854e-05 - timing_s/generate_sequences:68.54092407226562 - timing_s/reshard:0.6061321496963501 - timing_s/gen:71.24174935929477 - timing_s/reward:0.18565675429999828 - timing_s/old_log_prob:2.4507012721151114 - timing_s/ref:1.9302869327366352 - timing_s/adv:0.008295923471450806 - timing_s/update_actor:9.30363355949521 - timing_s/step:85.14042779803276 - timing_s/stop_profile:4.653073847293854e-05 - timing_per_token_ms/adv:1.4294961171747558e-05 - timing_per_token_ms/gen:0.15862555215721172 - timing_per_token_ms/ref:0.003326136848870462 - timing_per_token_ms/update_actor:0.016031377452653036 - perf/total_num_tokens:580339 - perf/time_per_step:85.14042779803276 - perf/throughput:852.0320707347462
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.4203124940395355, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.4203124940395355, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.16496996581554413, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.16496996581554413, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1280.2874755859375, 'response_length/max': 2048.0, 'response_length/min': 65.0, 'response_length/clip_ratio': 0.550000011920929, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4203125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:502 - global_seqlen/min:49906 - global_seqlen/max:76083 - global_seqlen/minmax_diff:26177 - global_seqlen/balanced_min:67600 - global_seqlen/balanced_max:67602 - global_seqlen/mean:67600.875 - actor/entropy:0.06046782806515694 - actor/kl_loss:0.2956043131649494 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.18200051691383123 - actor/pg_clipfrac:0.0005707136879209429 - actor/ppo_kl:0.0009797913836337101 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:10.450629375874996 - perf/mfu/actor:0.16509118800946684 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.36415481567383 - actor/lr:1e-06 - training/global_step:502 - training/epoch:14 - critic/score/mean:0.4203124940395355 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.4203124940395355 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.16496996581554413 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.16496996581554413 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1280.2874755859375 - response_length/max:2048.0 - response_length/min:65.0 - response_length/clip_ratio:0.550000011920929 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4203125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.649511098861694e-05 - timing_s/generate_sequences:68.26953887939453 - timing_s/reshard:1.0418612957000732 - timing_s/gen:70.97339597158134 - timing_s/reward:0.17443320155143738 - timing_s/old_log_prob:2.1302905213087797 - timing_s/ref:1.8437416013330221 - timing_s/adv:0.007918443530797958 - timing_s/update_actor:9.23573644272983 - timing_s/step:84.38217719271779 - timing_s/stop_profile:4.5672059059143066e-05 - timing_per_token_ms/adv:1.464190280598801e-05 - timing_per_token_ms/gen:0.1732359820830803 - timing_per_token_ms/ref:0.0034092413769293336 - timing_per_token_ms/update_actor:0.01707769396980777 - perf/total_num_tokens:540807 - perf/time_per_step:84.38217719271779 - perf/throughput:801.1274092348731
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m Training Progress:  96%|█████████▌| 503/525 [9:31:30<33:36, 91.64s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  96%|█████████▌| 504/525 [9:32:52<31:05, 88.85s/it]
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.809374988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.809374988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15174444019794464, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15174444019794464, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 903.3718872070312, 'response_length/max': 2048.0, 'response_length/min': 74.0, 'response_length/clip_ratio': 0.3375000059604645, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.809375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:503 - global_seqlen/min:36840 - global_seqlen/max:69808 - global_seqlen/minmax_diff:32968 - global_seqlen/balanced_min:51930 - global_seqlen/balanced_max:53057 - global_seqlen/mean:52493.625 - actor/entropy:0.13069486618041992 - actor/kl_loss:0.3381070114672184 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1632838487625122 - actor/pg_clipfrac:0.006387132470263168 - actor/ppo_kl:0.06729007671741982 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:53.97499902546406 - perf/mfu/actor:0.13655641317206613 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.40626525878906 - actor/lr:1e-06 - training/global_step:503 - training/epoch:14 - critic/score/mean:0.809374988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.809374988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15174444019794464 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15174444019794464 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:903.3718872070312 - response_length/max:2048.0 - response_length/min:74.0 - response_length/clip_ratio:0.3375000059604645 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.809375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.02768224477768e-05 - timing_s/generate_sequences:66.35160827636719 - timing_s/reshard:0.826411247253418 - timing_s/gen:68.70524129644036 - timing_s/reward:0.13499251566827297 - timing_s/old_log_prob:1.9093217253684998 - timing_s/ref:1.7078795153647661 - timing_s/adv:0.00814659334719181 - timing_s/update_actor:8.571742612868547 - timing_s/step:81.0546910353005 - timing_s/stop_profile:4.478543996810913e-05 - timing_per_token_ms/adv:1.9399006420283916e-05 - timing_per_token_ms/gen:0.23766943048938305 - timing_per_token_ms/ref:0.0040668736331429915 - timing_per_token_ms/update_actor:0.020411389508889287 - perf/total_num_tokens:419949 - perf/time_per_step:81.0546910353005 - perf/throughput:647.6321645238061
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.651562511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.651562511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1556447297334671, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1556447297334671, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1075.59375, 'response_length/max': 2048.0, 'response_length/min': 46.0, 'response_length/clip_ratio': 0.4468750059604645, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6515625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:504 - global_seqlen/min:39905 - global_seqlen/max:73573 - global_seqlen/minmax_diff:33668 - global_seqlen/balanced_min:58369 - global_seqlen/balanced_max:59545 - global_seqlen/mean:59395.625 - actor/entropy:0.08533111959695816 - actor/kl_loss:0.3172751247882843 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.05623714961111546 - actor/pg_clipfrac:0.002305655553936958 - actor/ppo_kl:0.12648698568864347 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:15.63680762052536 - perf/mfu/actor:0.15051436370131088 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.25647735595703 - actor/lr:1e-06 - training/global_step:504 - training/epoch:14 - critic/score/mean:0.651562511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.651562511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1556447297334671 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1556447297334671 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1075.59375 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.4468750059604645 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6515625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.825158536434174e-05 - timing_s/generate_sequences:67.4847183227539 - timing_s/reshard:0.7554109692573547 - timing_s/gen:69.66421454586089 - timing_s/reward:0.15463740937411785 - timing_s/old_log_prob:1.9616340268403292 - timing_s/ref:1.6643651500344276 - timing_s/adv:0.007994741201400757 - timing_s/update_actor:8.858965799212456 - timing_s/step:82.32728872448206 - timing_s/stop_profile:4.291161894798279e-05 - timing_per_token_ms/adv:1.6825189568677737e-05 - timing_per_token_ms/gen:0.20240046063471015 - timing_per_token_ms/ref:0.003502709900843765 - timing_per_token_ms/update_actor:0.018643977984936718 - perf/total_num_tokens:475165 - perf/time_per_step:82.32728872448206 - perf/throughput:721.4573189550118
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5093749761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5093749761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.18780077993869781, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.18780077993869781, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1170.5687255859375, 'response_length/max': 2048.0, 'response_length/min': 81.0, 'response_length/clip_ratio': 0.49687498807907104, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.509375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  96%|█████████▌| 505/525 [9:34:16<29:04, 87.20s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  96%|█████████▋| 506/525 [9:35:39<27:16, 86.14s/it]
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:505 - global_seqlen/min:46973 - global_seqlen/max:77626 - global_seqlen/minmax_diff:30653 - global_seqlen/balanced_min:62173 - global_seqlen/balanced_max:63342 - global_seqlen/mean:63194.625 - actor/entropy:0.0796833485364914 - actor/kl_loss:0.31434725783765316 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.003311527008190751 - actor/pg_clipfrac:0.002322921543964185 - actor/ppo_kl:-0.016493546014316962 - actor/pg_clipfrac_lower:0.00020146658644080163 - actor/grad_norm:34.06079053878784 - perf/mfu/actor:0.1613389407868691 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.26372909545898 - actor/lr:1e-06 - training/global_step:505 - training/epoch:14 - critic/score/mean:0.5093749761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5093749761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.18780077993869781 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.18780077993869781 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1170.5687255859375 - response_length/max:2048.0 - response_length/min:81.0 - response_length/clip_ratio:0.49687498807907104 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.509375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.35321843624115e-05 - timing_s/generate_sequences:67.76556396484375 - timing_s/reshard:0.8161818981170654 - timing_s/gen:70.48753784224391 - timing_s/reward:0.1652271170169115 - timing_s/old_log_prob:2.0730811897665262 - timing_s/ref:1.7792932130396366 - timing_s/adv:0.008015066385269165 - timing_s/update_actor:8.814385710284114 - timing_s/step:83.34350625053048 - timing_s/stop_profile:4.35803085565567e-05 - timing_per_token_ms/adv:1.5853932168418527e-05 - timing_per_token_ms/gen:0.18817652167547802 - timing_per_token_ms/ref:0.0035194710251062423 - timing_per_token_ms/update_actor:0.01743499884342243 - perf/total_num_tokens:505557 - perf/time_per_step:83.34350625053048 - perf/throughput:758.2429374885793
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5640624761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5640624761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.13277579843997955, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.13277579843997955, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1144.050048828125, 'response_length/max': 2048.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.4906249940395355, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5640625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:506 - global_seqlen/min:36241 - global_seqlen/max:78690 - global_seqlen/minmax_diff:42449 - global_seqlen/balanced_min:61392 - global_seqlen/balanced_max:62616 - global_seqlen/mean:62155.75 - actor/entropy:0.06626889854669571 - actor/kl_loss:0.29101680777966976 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17423669025301933 - actor/pg_clipfrac:0.00027796884533017876 - actor/ppo_kl:0.0075926447608480885 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:53.19803313910961 - perf/mfu/actor:0.15199134992501268 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.29008865356445 - actor/lr:1e-06 - training/global_step:506 - training/epoch:14 - critic/score/mean:0.5640624761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5640624761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.13277579843997955 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.13277579843997955 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1144.050048828125 - response_length/max:2048.0 - response_length/min:76.0 - response_length/clip_ratio:0.4906249940395355 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5640625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.605793118476868e-05 - timing_s/generate_sequences:67.56683349609375 - timing_s/reshard:0.8783456683158875 - timing_s/gen:70.38195890933275 - timing_s/reward:0.16075223684310913 - timing_s/old_log_prob:2.0088414046913385 - timing_s/ref:1.7309711631387472 - timing_s/adv:0.008021319285035133 - timing_s/update_actor:9.202752551063895 - timing_s/step:83.50909733399749 - timing_s/stop_profile:4.2479485273361206e-05 - timing_per_token_ms/adv:1.613149082151517e-05 - timing_per_token_ms/gen:0.19225000794691216 - timing_per_token_ms/ref:0.003481116314940185 - timing_per_token_ms/update_actor:0.01850744410425402 - perf/total_num_tokens:497246 - perf/time_per_step:83.50909733399749 - perf/throughput:744.2991480485767
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.671875, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.671875, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15670379996299744, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15670379996299744, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1057.3343505859375, 'response_length/max': 2048.0, 'response_length/min': 63.0, 'response_length/clip_ratio': 0.4312500059604645, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  97%|█████████▋| 507/525 [9:37:02<25:32, 85.13s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  97%|█████████▋| 508/525 [9:38:26<24:01, 84.81s/it]
[36m(TaskRunner pid=2949575)[0m step:507 - global_seqlen/min:41806 - global_seqlen/max:79480 - global_seqlen/minmax_diff:37674 - global_seqlen/balanced_min:58372 - global_seqlen/balanced_max:59508 - global_seqlen/mean:58656.5 - actor/entropy:0.08518768846988678 - actor/kl_loss:0.401223735883832 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13617151863873006 - actor/pg_clipfrac:0.01061244996089954 - actor/ppo_kl:-0.11173190949557466 - actor/pg_clipfrac_lower:0.0005575344373937696 - actor/grad_norm:66.8601944744587 - perf/mfu/actor:0.1504141947101858 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.2941665649414 - actor/lr:1e-06 - training/global_step:507 - training/epoch:14 - critic/score/mean:0.671875 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.671875 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15670379996299744 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15670379996299744 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1057.3343505859375 - response_length/max:2048.0 - response_length/min:63.0 - response_length/clip_ratio:0.4312500059604645 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.122863411903381e-05 - timing_s/generate_sequences:66.96438598632812 - timing_s/reshard:0.8136942386627197 - timing_s/gen:69.93462599441409 - timing_s/reward:0.15164246968925 - timing_s/old_log_prob:2.0096204541623592 - timing_s/ref:1.7133043389767408 - timing_s/adv:0.007857570424675941 - timing_s/update_actor:8.747683307155967 - timing_s/step:82.5803347863257 - timing_s/stop_profile:4.634074866771698e-05 - timing_per_token_ms/adv:1.674488425126785e-05 - timing_per_token_ms/gen:0.2066949788070061 - timing_per_token_ms/ref:0.0036511391298848822 - timing_per_token_ms/update_actor:0.018641760306095587 - perf/total_num_tokens:469252 - perf/time_per_step:82.5803347863257 - perf/throughput:710.2962242980977
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5218750238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5218750238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.09206094592809677, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.09206094592809677, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1125.1812744140625, 'response_length/max': 2048.0, 'response_length/min': 80.0, 'response_length/clip_ratio': 0.46875, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.521875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:508 - global_seqlen/min:47127 - global_seqlen/max:81978 - global_seqlen/minmax_diff:34851 - global_seqlen/balanced_min:60614 - global_seqlen/balanced_max:61660 - global_seqlen/mean:61396.625 - actor/entropy:0.07792440056800842 - actor/kl_loss:0.3257416609674692 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1113818535581231 - actor/pg_clipfrac:0.0010600881694699637 - actor/ppo_kl:-0.014525362631411553 - actor/pg_clipfrac_lower:0.000723140500485897 - actor/grad_norm:68.352124735713 - perf/mfu/actor:0.15404305430374665 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.3767204284668 - actor/lr:1e-06 - training/global_step:508 - training/epoch:14 - critic/score/mean:0.5218750238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5218750238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.09206094592809677 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.09206094592809677 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1125.1812744140625 - response_length/max:2048.0 - response_length/min:80.0 - response_length/clip_ratio:0.46875 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.521875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.955970406532288e-05 - timing_s/generate_sequences:67.66185760498047 - timing_s/reshard:0.8345357179641724 - timing_s/gen:70.84014635719359 - timing_s/reward:0.15847095660865307 - timing_s/old_log_prob:2.0580473002046347 - timing_s/ref:1.7625893950462341 - timing_s/adv:0.007884316146373749 - timing_s/update_actor:8.957365406677127 - timing_s/step:83.79994367063046 - timing_s/stop_profile:4.4172629714012146e-05 - timing_per_token_ms/adv:1.6052014557750016e-05 - timing_per_token_ms/gen:0.19674648628052588 - timing_per_token_ms/ref:0.003588530711269215 - timing_per_token_ms/update_actor:0.0182366811829582 - perf/total_num_tokens:491173 - perf/time_per_step:83.79994367063046 - perf/throughput:732.657115395148
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5921875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5921875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.03900229185819626, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.03900229185819626, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1071.4000244140625, 'response_length/max': 2048.0, 'response_length/min': 65.0, 'response_length/clip_ratio': 0.44062501192092896, 'prompt_length/mean': 409.953125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5921875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  97%|█████████▋| 509/525 [9:39:49<22:27, 84.24s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:21:03,153:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:21:08,051:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:21:08,054:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951183)[0m INFO:2025-08-06 09:21:03,505:[Rank 3] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:21:08,581:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  97%|█████████▋| 510/525 [9:41:23<21:48, 87.26s/it]
[36m(TaskRunner pid=2949575)[0m step:509 - global_seqlen/min:33047 - global_seqlen/max:81174 - global_seqlen/minmax_diff:48127 - global_seqlen/balanced_min:58489 - global_seqlen/balanced_max:59710 - global_seqlen/mean:59254.125 - actor/entropy:0.08344714343547821 - actor/kl_loss:0.33344495072960856 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05891399160027504 - actor/pg_clipfrac:0.00309063887107186 - actor/ppo_kl:0.09770478584669036 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:92.73316086828709 - perf/mfu/actor:0.14863954261962656 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.36029434204102 - actor/lr:1e-06 - training/global_step:509 - training/epoch:14 - critic/score/mean:0.5921875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5921875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.03900229185819626 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.03900229185819626 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1071.4000244140625 - response_length/max:2048.0 - response_length/min:65.0 - response_length/clip_ratio:0.44062501192092896 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5921875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.788650691509247e-05 - timing_s/generate_sequences:67.1524658203125 - timing_s/reshard:0.8907782435417175 - timing_s/gen:70.09522553905845 - timing_s/reward:0.15564140491187572 - timing_s/old_log_prob:1.974082550033927 - timing_s/ref:1.6919467467814684 - timing_s/adv:0.008112078532576561 - timing_s/update_actor:8.945939177647233 - timing_s/step:82.88802977465093 - timing_s/stop_profile:4.396028816699982e-05 - timing_per_token_ms/adv:1.7112898326860285e-05 - timing_per_token_ms/gen:0.20444985981851563 - timing_per_token_ms/ref:0.0035692594118583902 - timing_per_token_ms/update_actor:0.01887197553260476 - perf/total_num_tokens:474033 - perf/time_per_step:82.88802977465093 - perf/throughput:714.8695072267392
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.42656248807907104, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.42656248807907104, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11121910065412521, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.11121910065412521, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1238.378173828125, 'response_length/max': 2048.0, 'response_length/min': 69.0, 'response_length/clip_ratio': 0.534375011920929, 'prompt_length/mean': 410.0625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.4265625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:510 - global_seqlen/min:47296 - global_seqlen/max:84858 - global_seqlen/minmax_diff:37562 - global_seqlen/balanced_min:65479 - global_seqlen/balanced_max:66696 - global_seqlen/mean:65937.625 - actor/entropy:0.06775537878274918 - actor/kl_loss:0.35338604748249053 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1705369665287435 - actor/pg_clipfrac:0.00557962655875599 - actor/ppo_kl:0.07546263730328065 - actor/pg_clipfrac_lower:0.0002090599504299462 - actor/grad_norm:17.781002819538116 - perf/mfu/actor:0.16217472449292133 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.41423034667969 - actor/lr:1e-06 - training/global_step:510 - training/epoch:14 - critic/score/mean:0.42656248807907104 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.42656248807907104 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11121910065412521 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.11121910065412521 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1238.378173828125 - response_length/max:2048.0 - response_length/min:69.0 - response_length/clip_ratio:0.534375011920929 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.4265625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.686950266361237e-05 - timing_s/generate_sequences:68.54928588867188 - timing_s/reshard:0.7701327204704285 - timing_s/gen:70.82014161348343 - timing_s/reward:0.17184093035757542 - timing_s/old_log_prob:2.201402299106121 - timing_s/ref:1.8277792874723673 - timing_s/adv:0.00817415863275528 - timing_s/update_actor:9.165762849152088 - timing_s/save_checkpoint:10.076235573738813 - timing_s/step:94.28699965029955 - timing_s/stop_profile:5.1077455282211304e-05 - timing_per_token_ms/adv:1.5496005946444233e-05 - timing_per_token_ms/gen:0.17871192818601808 - timing_per_token_ms/ref:0.003464977862548824 - timing_per_token_ms/update_actor:0.017375820802523763 - perf/total_num_tokens:527501 - perf/time_per_step:94.28699965029955 - perf/throughput:699.3289132601062
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.20156249403953552, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.20156249403953552, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12590521574020386, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12590521574020386, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1424.418701171875, 'response_length/max': 2048.0, 'response_length/min': 69.0, 'response_length/clip_ratio': 0.6468750238418579, 'prompt_length/mean': 410.390625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.2015625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  97%|█████████▋| 511/525 [9:42:49<20:14, 86.74s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:21:09,859:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:21:09,861:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_510/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  98%|█████████▊| 512/525 [9:44:12<18:34, 85.71s/it]
[36m(TaskRunner pid=2949575)[0m step:511 - global_seqlen/min:62673 - global_seqlen/max:92616 - global_seqlen/minmax_diff:29943 - global_seqlen/balanced_min:72408 - global_seqlen/balanced_max:73538 - global_seqlen/mean:73392.375 - actor/entropy:0.047963935881853104 - actor/kl_loss:0.3354057341814041 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.008400270156562329 - actor/pg_clipfrac:0.003116602171212435 - actor/ppo_kl:-0.020903086352336685 - actor/pg_clipfrac_lower:0.0013440989889204503 - actor/grad_norm:36.54248854517937 - perf/mfu/actor:0.17967097018586836 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.47261428833008 - actor/lr:1e-06 - training/global_step:511 - training/epoch:14 - critic/score/mean:0.20156249403953552 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.20156249403953552 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12590521574020386 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12590521574020386 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1424.418701171875 - response_length/max:2048.0 - response_length/min:69.0 - response_length/clip_ratio:0.6468750238418579 - prompt_length/mean:410.390625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.2015625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.21059399843216e-05 - timing_s/generate_sequences:69.10547637939453 - timing_s/reshard:0.8553571105003357 - timing_s/gen:71.7604854349047 - timing_s/reward:0.19144432060420513 - timing_s/old_log_prob:2.2410416081547737 - timing_s/ref:1.8769095931202173 - timing_s/adv:0.007949206978082657 - timing_s/update_actor:9.251514997333288 - timing_s/step:85.34526897780597 - timing_s/stop_profile:4.282034933567047e-05 - timing_per_token_ms/adv:1.3538884281375717e-05 - timing_per_token_ms/gen:0.1574337019813009 - timing_per_token_ms/ref:0.0031967040055595306 - timing_per_token_ms/update_actor:0.01575694170772728 - perf/total_num_tokens:587139 - perf/time_per_step:85.34526897780597 - perf/throughput:859.946613081572
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.5703125, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.5703125, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11670238524675369, 'critic/advantages/max': 1.7888517379760742, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11670238524675369, 'critic/returns/max': 1.7888517379760742, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1078.7406005859375, 'response_length/max': 2048.0, 'response_length/min': 77.0, 'response_length/clip_ratio': 0.453125, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5703125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:512 - global_seqlen/min:36846 - global_seqlen/max:74214 - global_seqlen/minmax_diff:37368 - global_seqlen/balanced_min:59377 - global_seqlen/balanced_max:60667 - global_seqlen/mean:59539.0 - actor/entropy:0.07907642424106598 - actor/kl_loss:0.3548491936177015 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12205283753573895 - actor/pg_clipfrac:0.00808733162120916 - actor/ppo_kl:-0.1101141684113827 - actor/pg_clipfrac_lower:0.001721526891924441 - actor/grad_norm:82.77180325984955 - perf/mfu/actor:0.148345909301609 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.4706916809082 - actor/lr:1e-06 - training/global_step:512 - training/epoch:14 - critic/score/mean:0.5703125 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.5703125 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11670238524675369 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11670238524675369 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888528108596802 - response_length/mean:1078.7406005859375 - response_length/max:2048.0 - response_length/min:77.0 - response_length/clip_ratio:0.453125 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5703125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.219426333904266e-05 - timing_s/generate_sequences:67.38604736328125 - timing_s/reshard:0.9819741249084473 - timing_s/gen:70.24203277565539 - timing_s/reward:0.1532634012401104 - timing_s/old_log_prob:2.0738813783973455 - timing_s/ref:1.771423902362585 - timing_s/adv:0.008011166006326675 - timing_s/update_actor:9.013850044459105 - timing_s/step:83.27799065224826 - timing_s/stop_profile:4.6232715249061584e-05 - timing_per_token_ms/adv:1.6819156364581777e-05 - timing_per_token_ms/gen:0.20348390274439057 - timing_per_token_ms/ref:0.003719041095673813 - timing_per_token_ms/update_actor:0.018924255623329046 - perf/total_num_tokens:476312 - perf/time_per_step:83.27799065224826 - perf/throughput:714.9428022179666
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.635937511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.635937511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.14809563755989075, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.14809563755989075, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1024.2874755859375, 'response_length/max': 2048.0, 'response_length/min': 63.0, 'response_length/clip_ratio': 0.4156250059604645, 'prompt_length/mean': 409.296875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  98%|█████████▊| 513/525 [9:45:35<16:58, 84.83s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  98%|█████████▊| 514/525 [9:46:59<15:29, 84.50s/it]
[36m(TaskRunner pid=2949575)[0m step:513 - global_seqlen/min:43802 - global_seqlen/max:73663 - global_seqlen/minmax_diff:29861 - global_seqlen/balanced_min:56599 - global_seqlen/balanced_max:57790 - global_seqlen/mean:57343.375 - actor/entropy:0.1003178060054779 - actor/kl_loss:0.4626276805996895 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10269694153685123 - actor/pg_clipfrac:0.0037667443248210475 - actor/ppo_kl:-0.08349598570057423 - actor/pg_clipfrac_lower:0.0033674071077257396 - actor/grad_norm:105.2546089887619 - perf/mfu/actor:0.14395686325983695 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.51910400390625 - actor/lr:1e-06 - training/global_step:513 - training/epoch:14 - critic/score/mean:0.635937511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.635937511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.14809563755989075 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.14809563755989075 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1024.2874755859375 - response_length/max:2048.0 - response_length/min:63.0 - response_length/clip_ratio:0.4156250059604645 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.458962500095367e-05 - timing_s/generate_sequences:67.10324096679688 - timing_s/reshard:0.8727385401725769 - timing_s/gen:69.99915791116655 - timing_s/reward:0.14929055981338024 - timing_s/old_log_prob:1.978968195617199 - timing_s/ref:1.7090379055589437 - timing_s/adv:0.008125122636556625 - timing_s/update_actor:8.92676099576056 - timing_s/step:82.78700646013021 - timing_s/stop_profile:4.473887383937836e-05 - timing_per_token_ms/adv:1.7711554814650833e-05 - timing_per_token_ms/gen:0.21356051740589968 - timing_per_token_ms/ref:0.0037254475899764876 - timing_per_token_ms/update_actor:0.019459006807152002 - perf/total_num_tokens:458747 - perf/time_per_step:82.78700646013021 - perf/throughput:692.6615353294151
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6000000238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6000000238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.12613870203495026, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.12613870203495026, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1087.284423828125, 'response_length/max': 2048.0, 'response_length/min': 76.0, 'response_length/clip_ratio': 0.4437499940395355, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:514 - global_seqlen/min:46573 - global_seqlen/max:79070 - global_seqlen/minmax_diff:32497 - global_seqlen/balanced_min:59011 - global_seqlen/balanced_max:60147 - global_seqlen/mean:59872.0 - actor/entropy:0.08977113664150238 - actor/kl_loss:0.4284782446920872 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15045098327100276 - actor/pg_clipfrac:0.0033992703014519066 - actor/ppo_kl:-0.033966943468931275 - actor/pg_clipfrac_lower:0.0038156070746481418 - actor/grad_norm:62.745188653469086 - perf/mfu/actor:0.13346305853244284 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.44467163085938 - actor/lr:1e-06 - training/global_step:514 - training/epoch:14 - critic/score/mean:0.6000000238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6000000238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.12613870203495026 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.12613870203495026 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1087.284423828125 - response_length/max:2048.0 - response_length/min:76.0 - response_length/clip_ratio:0.4437499940395355 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.607469499111176e-05 - timing_s/generate_sequences:67.51240539550781 - timing_s/reshard:0.7971401214599609 - timing_s/gen:69.4997754599899 - timing_s/reward:0.15826294757425785 - timing_s/old_log_prob:2.106704894453287 - timing_s/ref:1.7552657257765532 - timing_s/adv:0.008025923743844032 - timing_s/update_actor:10.064490320160985 - timing_s/step:83.60811270773411 - timing_s/stop_profile:4.657357931137085e-05 - timing_per_token_ms/adv:1.6756421498872663e-05 - timing_per_token_ms/gen:0.19975160436980294 - timing_per_token_ms/ref:0.0036646214544706897 - timing_per_token_ms/update_actor:0.021012514865381533 - perf/total_num_tokens:478976 - perf/time_per_step:83.60811270773411 - perf/throughput:716.1027567897916
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6546875238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6546875238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1279580295085907, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1279580295085907, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1008.2531127929688, 'response_length/max': 2048.0, 'response_length/min': 64.0, 'response_length/clip_ratio': 0.40312498807907104, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6546875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  98%|█████████▊| 515/525 [9:48:22<14:02, 84.20s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  98%|█████████▊| 516/525 [9:49:45<12:35, 83.95s/it]
[36m(TaskRunner pid=2949575)[0m step:515 - global_seqlen/min:43879 - global_seqlen/max:64419 - global_seqlen/minmax_diff:20540 - global_seqlen/balanced_min:56557 - global_seqlen/balanced_max:57742 - global_seqlen/mean:56706.375 - actor/entropy:0.10199329257011414 - actor/kl_loss:0.31012505851686 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.020751703018322586 - actor/pg_clipfrac:0.003775183652760461 - actor/ppo_kl:0.06897960432397668 - actor/pg_clipfrac_lower:0.00013736264081671835 - actor/grad_norm:96.37555366754532 - perf/mfu/actor:0.13647459360412 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.44606399536133 - actor/lr:1e-06 - training/global_step:515 - training/epoch:14 - critic/score/mean:0.6546875238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6546875238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1279580295085907 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1279580295085907 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1008.2531127929688 - response_length/max:2048.0 - response_length/min:64.0 - response_length/clip_ratio:0.40312498807907104 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6546875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.10591334104538e-05 - timing_s/generate_sequences:67.79056549072266 - timing_s/reshard:0.8069794774055481 - timing_s/gen:70.22766026109457 - timing_s/reward:0.14706815034151077 - timing_s/old_log_prob:1.9338606521487236 - timing_s/ref:1.6921278461813927 - timing_s/adv:0.008097440004348755 - timing_s/update_actor:9.303829245269299 - timing_s/step:83.32842794805765 - timing_s/stop_profile:4.581362009048462e-05 - timing_per_token_ms/adv:1.7849492240397916e-05 - timing_per_token_ms/gen:0.2176650216838361 - timing_per_token_ms/ref:0.0037300211973111327 - timing_per_token_ms/update_actor:0.02050878151986725 - perf/total_num_tokens:453651 - perf/time_per_step:83.32842794805765 - perf/throughput:680.5165583508623
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.643750011920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.643750011920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.05183427035808563, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.05183427035808563, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1041.0218505859375, 'response_length/max': 2048.0, 'response_length/min': 93.0, 'response_length/clip_ratio': 0.4281249940395355, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.64375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:516 - global_seqlen/min:49254 - global_seqlen/max:64623 - global_seqlen/minmax_diff:15369 - global_seqlen/balanced_min:57870 - global_seqlen/balanced_max:59182 - global_seqlen/mean:58034.625 - actor/entropy:0.08465452492237091 - actor/kl_loss:0.2914577808231115 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.2027196330484003 - actor/pg_clipfrac:0.0010579170237178914 - actor/ppo_kl:-0.013373837299513979 - actor/pg_clipfrac_lower:0.0001300390111282468 - actor/grad_norm:43.99434319138527 - perf/mfu/actor:0.146442200467207 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.39661407470703 - actor/lr:1e-06 - training/global_step:516 - training/epoch:14 - critic/score/mean:0.643750011920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.643750011920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.05183427035808563 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.05183427035808563 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1041.0218505859375 - response_length/max:2048.0 - response_length/min:93.0 - response_length/clip_ratio:0.4281249940395355 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.64375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.107217192649841e-05 - timing_s/generate_sequences:67.71273040771484 - timing_s/reshard:0.8197208642959595 - timing_s/gen:70.27549335174263 - timing_s/reward:0.1502008903771639 - timing_s/old_log_prob:2.0290500689297915 - timing_s/ref:1.66416497528553 - timing_s/adv:0.007907748222351074 - timing_s/update_actor:8.891323033720255 - timing_s/step:83.0344541799277 - timing_s/stop_profile:4.2747706174850464e-05 - timing_per_token_ms/adv:1.7032392779205247e-05 - timing_per_token_ms/gen:0.21095706247690107 - timing_per_token_ms/ref:0.0035844226082393273 - timing_per_token_ms/update_actor:0.019150901366469273 - perf/total_num_tokens:464277 - perf/time_per_step:83.0344541799277 - perf/throughput:698.9222193746771
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6890624761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6890624761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.08375377207994461, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.78885018825531, 'critic/returns/mean': -0.08375377207994461, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.78885018825531, 'response_length/mean': 1011.8250122070312, 'response_length/max': 2048.0, 'response_length/min': 68.0, 'response_length/clip_ratio': 0.40625, 'prompt_length/mean': 409.515625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  98%|█████████▊| 517/525 [9:51:07<11:06, 83.29s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress:  99%|█████████▊| 518/525 [9:52:30<09:41, 83.06s/it]
[36m(TaskRunner pid=2949575)[0m step:517 - global_seqlen/min:43544 - global_seqlen/max:79875 - global_seqlen/minmax_diff:36331 - global_seqlen/balanced_min:56536 - global_seqlen/balanced_max:57803 - global_seqlen/mean:56853.625 - actor/entropy:0.0917012095451355 - actor/kl_loss:0.3808835528790951 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07662842813879252 - actor/pg_clipfrac:0.004690929385833442 - actor/ppo_kl:-0.03297430800485017 - actor/pg_clipfrac_lower:0.000752438887138851 - actor/grad_norm:65.85146230459213 - perf/mfu/actor:0.14718946165105937 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.40482711791992 - actor/lr:1e-06 - training/global_step:517 - training/epoch:14 - critic/score/mean:0.6890624761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6890624761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.08375377207994461 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.08375377207994461 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.78885018825531 - response_length/mean:1011.8250122070312 - response_length/max:2048.0 - response_length/min:68.0 - response_length/clip_ratio:0.40625 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.349252700805664e-05 - timing_s/generate_sequences:67.25567626953125 - timing_s/reshard:0.7714375853538513 - timing_s/gen:69.34976063109934 - timing_s/reward:0.14664634130895138 - timing_s/old_log_prob:1.934549594298005 - timing_s/ref:1.638924540951848 - timing_s/adv:0.008014293387532234 - timing_s/update_actor:8.651669567450881 - timing_s/step:81.74577516317368 - timing_s/stop_profile:4.513002932071686e-05 - timing_per_token_ms/adv:1.7620453813482064e-05 - timing_per_token_ms/gen:0.21418526125781182 - timing_per_token_ms/ref:0.003603386197783888 - timing_per_token_ms/update_actor:0.019021807245032486 - perf/total_num_tokens:454829 - perf/time_per_step:81.74577516317368 - perf/throughput:695.4931296022801
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6578124761581421, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6578124761581421, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.10333491116762161, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.10333491116762161, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1063.3687744140625, 'response_length/max': 2048.0, 'response_length/min': 63.0, 'response_length/clip_ratio': 0.4437499940395355, 'prompt_length/mean': 409.734375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6578125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:518 - global_seqlen/min:52563 - global_seqlen/max:66970 - global_seqlen/minmax_diff:14407 - global_seqlen/balanced_min:58041 - global_seqlen/balanced_max:59220 - global_seqlen/mean:58924.125 - actor/entropy:0.07281483709812164 - actor/kl_loss:0.49514591321349144 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.016881239600479603 - actor/pg_clipfrac:0.003356322670879308 - actor/ppo_kl:0.04114104747577585 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:70.06371515989304 - perf/mfu/actor:0.14655872935109743 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.36516189575195 - actor/lr:1e-06 - training/global_step:518 - training/epoch:14 - critic/score/mean:0.6578124761581421 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6578124761581421 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.10333491116762161 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.10333491116762161 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1063.3687744140625 - response_length/max:2048.0 - response_length/min:63.0 - response_length/clip_ratio:0.4437499940395355 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6578125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.436610758304596e-05 - timing_s/generate_sequences:67.73188018798828 - timing_s/reshard:0.7572289705276489 - timing_s/gen:69.62573619559407 - timing_s/reward:0.15331858955323696 - timing_s/old_log_prob:1.975740011781454 - timing_s/ref:1.6954856496304274 - timing_s/adv:0.008092150092124939 - timing_s/update_actor:9.027845038101077 - timing_s/step:82.50434020161629 - timing_s/stop_profile:4.438124597072601e-05 - timing_per_token_ms/adv:1.7166462149681772e-05 - timing_per_token_ms/gen:0.20461427478589292 - timing_per_token_ms/ref:0.003596756102934128 - timing_per_token_ms/update_actor:0.019151419384889207 - perf/total_num_tokens:471393 - perf/time_per_step:82.50434020161629 - perf/throughput:714.1942454906833
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.667187511920929, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.667187511920929, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.15256015956401825, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.15256015956401825, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1022.0906372070312, 'response_length/max': 2048.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.40937501192092896, 'prompt_length/mean': 409.40625, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6671875, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  99%|█████████▉| 519/525 [9:53:53<08:18, 83.01s/it]
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:35:04,366:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:35:09,011:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:35:09,013:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:35:04,752:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:35:09,566:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/huggingface
[36m(TaskRunner pid=2949575)[0m Training Progress:  99%|█████████▉| 520/525 [9:55:25<07:08, 85.75s/it]
[36m(TaskRunner pid=2949575)[0m step:519 - global_seqlen/min:38082 - global_seqlen/max:71822 - global_seqlen/minmax_diff:33740 - global_seqlen/balanced_min:56835 - global_seqlen/balanced_max:57969 - global_seqlen/mean:57259.875 - actor/entropy:0.09200586378574371 - actor/kl_loss:0.501988822594285 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.031549428962171076 - actor/pg_clipfrac:0.008847420747042634 - actor/ppo_kl:-0.12540574506274424 - actor/pg_clipfrac_lower:0.001829102031479124 - actor/grad_norm:89.88022458553314 - perf/mfu/actor:0.14145499206848355 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.32067489624023 - actor/lr:1e-06 - training/global_step:519 - training/epoch:14 - critic/score/mean:0.667187511920929 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.667187511920929 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.15256015956401825 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.15256015956401825 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:1022.0906372070312 - response_length/max:2048.0 - response_length/min:84.0 - response_length/clip_ratio:0.40937501192092896 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6671875 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.022653102874756e-05 - timing_s/generate_sequences:67.29157257080078 - timing_s/reshard:0.866682231426239 - timing_s/gen:69.93187258951366 - timing_s/reward:0.14697164669632912 - timing_s/old_log_prob:1.8963690884411335 - timing_s/ref:1.6521702390164137 - timing_s/adv:0.00791134126484394 - timing_s/update_actor:9.066948615014553 - timing_s/step:82.71784618869424 - timing_s/stop_profile:4.5258551836013794e-05 - timing_per_token_ms/adv:1.7270691878134428e-05 - timing_per_token_ms/gen:0.21381382090480497 - timing_per_token_ms/ref:0.00360673647780495 - timing_per_token_ms/update_actor:0.019793416888821695 - perf/total_num_tokens:458079 - perf/time_per_step:82.71784618869424 - perf/throughput:692.2312129522807
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.7890625, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.7890625, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11483503878116608, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11483503878116608, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 901.1656494140625, 'response_length/max': 2048.0, 'response_length/min': 78.0, 'response_length/clip_ratio': 0.34687501192092896, 'prompt_length/mean': 408.96875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.7890625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:520 - global_seqlen/min:42214 - global_seqlen/max:64009 - global_seqlen/minmax_diff:21795 - global_seqlen/balanced_min:51347 - global_seqlen/balanced_max:52557 - global_seqlen/mean:52405.375 - actor/entropy:0.11250851303339005 - actor/kl_loss:0.5031852863729 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03081052638590336 - actor/pg_clipfrac:0.009404035164334346 - actor/ppo_kl:-0.020306851287205063 - actor/pg_clipfrac_lower:0.0021554107777774336 - actor/grad_norm:39.55312377214432 - perf/mfu/actor:0.13633406919933394 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.31386184692383 - actor/lr:1e-06 - training/global_step:520 - training/epoch:14 - critic/score/mean:0.7890625 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.7890625 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11483503878116608 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11483503878116608 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:901.1656494140625 - response_length/max:2048.0 - response_length/min:78.0 - response_length/clip_ratio:0.34687501192092896 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.7890625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:0.0001580026000738144 - timing_s/generate_sequences:66.48294067382812 - timing_s/reshard:0.7890759706497192 - timing_s/gen:69.52722932770848 - timing_s/reward:0.13667383417487144 - timing_s/old_log_prob:1.8559618219733238 - timing_s/ref:1.6023758091032505 - timing_s/adv:0.00810568779706955 - timing_s/update_actor:8.578179826959968 - timing_s/save_checkpoint:10.404342256486416 - timing_s/step:92.12932360358536 - timing_s/stop_profile:5.210377275943756e-05 - timing_per_token_ms/adv:1.9334104080615655e-05 - timing_per_token_ms/gen:0.241101730493869 - timing_per_token_ms/ref:0.0038220693228109962 - timing_per_token_ms/update_actor:0.020461116409719347 - perf/total_num_tokens:419243 - perf/time_per_step:92.12932360358536 - perf/throughput:568.8240502610241
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.528124988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.528124988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.11979974061250687, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.11979974061250687, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1146.3218994140625, 'response_length/max': 2048.0, 'response_length/min': 92.0, 'response_length/clip_ratio': 0.4781250059604645, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.528125, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress:  99%|█████████▉| 521/525 [9:56:49<05:40, 85.16s/it]
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:35:11,388:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:35:11,390:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_520/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2949575)[0m Training Progress:  99%|█████████▉| 522/525 [9:58:12<04:14, 84.74s/it]
[36m(TaskRunner pid=2949575)[0m step:521 - global_seqlen/min:49495 - global_seqlen/max:76488 - global_seqlen/minmax_diff:26993 - global_seqlen/balanced_min:62086 - global_seqlen/balanced_max:63353 - global_seqlen/mean:62246.625 - actor/entropy:0.06129588931798935 - actor/kl_loss:0.32633580788969996 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.028875787742435932 - actor/pg_clipfrac:0.0014990418960223906 - actor/ppo_kl:0.007453623599940329 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:80.87790152430534 - perf/mfu/actor:0.15093043810038267 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.6331901550293 - actor/lr:1e-06 - training/global_step:521 - training/epoch:14 - critic/score/mean:0.528124988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.528124988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.11979974061250687 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.11979974061250687 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1146.3218994140625 - response_length/max:2048.0 - response_length/min:92.0 - response_length/clip_ratio:0.4781250059604645 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.528125 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.34720379114151e-05 - timing_s/generate_sequences:68.06442260742188 - timing_s/reshard:0.7491653561592102 - timing_s/gen:70.5003414247185 - timing_s/reward:0.16144240461289883 - timing_s/old_log_prob:2.0410947520285845 - timing_s/ref:1.755982095375657 - timing_s/adv:0.008006233721971512 - timing_s/update_actor:9.271539470180869 - timing_s/step:83.7545470893383 - timing_s/stop_profile:4.429928958415985e-05 - timing_per_token_ms/adv:1.60776462217259e-05 - timing_per_token_ms/gen:0.1921917148726184 - timing_per_token_ms/ref:0.0035262596473617184 - timing_per_token_ms/update_actor:0.018618558576832218 - perf/total_num_tokens:497973 - perf/time_per_step:83.7545470893383 - perf/throughput:743.202932416356
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.590624988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.590624988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1146392673254013, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1146392673254013, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1129.7281494140625, 'response_length/max': 2048.0, 'response_length/min': 64.0, 'response_length/clip_ratio': 0.4781250059604645, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.590625, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:522 - global_seqlen/min:51544 - global_seqlen/max:80881 - global_seqlen/minmax_diff:29337 - global_seqlen/balanced_min:61428 - global_seqlen/balanced_max:62661 - global_seqlen/mean:61582.875 - actor/entropy:0.06346502155065536 - actor/kl_loss:0.6092703387141227 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.029384789429605006 - actor/pg_clipfrac:0.007424791302764788 - actor/ppo_kl:-0.05674713699263521 - actor/pg_clipfrac_lower:0.0009299969126004726 - actor/grad_norm:49.07888373732567 - perf/mfu/actor:0.1488409943534177 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.58190155029297 - actor/lr:1e-06 - training/global_step:522 - training/epoch:14 - critic/score/mean:0.590624988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.590624988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1146392673254013 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1146392673254013 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1129.7281494140625 - response_length/max:2048.0 - response_length/min:64.0 - response_length/clip_ratio:0.4781250059604645 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.590625 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.469633758068085e-05 - timing_s/generate_sequences:67.50406646728516 - timing_s/reshard:0.8888429403305054 - timing_s/gen:70.38673854991794 - timing_s/reward:0.15903791971504688 - timing_s/old_log_prob:2.07681467756629 - timing_s/ref:1.7055172491818666 - timing_s/adv:0.008016495034098625 - timing_s/update_actor:9.303785663098097 - timing_s/step:83.65629659034312 - timing_s/stop_profile:4.480965435504913e-05 - timing_per_token_ms/adv:1.627176190235237e-05 - timing_per_token_ms/gen:0.19470043553044547 - timing_per_token_ms/ref:0.0034618334422959847 - timing_per_token_ms/update_actor:0.01888468519677365 - perf/total_num_tokens:492663 - perf/time_per_step:83.65629659034312 - perf/throughput:736.1415399675825
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.6859375238418579, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.6859375238418579, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1655346155166626, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1655346155166626, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 1056.9749755859375, 'response_length/max': 2048.0, 'response_length/min': 93.0, 'response_length/clip_ratio': 0.4156250059604645, 'prompt_length/mean': 409.1875, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.6859375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m Training Progress: 100%|█████████▉| 523/525 [9:59:35<02:48, 84.01s/it]
[36m(TaskRunner pid=2949575)[0m Training Progress: 100%|█████████▉| 524/525 [10:00:56<01:23, 83.26s/it]
[36m(TaskRunner pid=2949575)[0m step:523 - global_seqlen/min:50975 - global_seqlen/max:62682 - global_seqlen/minmax_diff:11707 - global_seqlen/balanced_min:58006 - global_seqlen/balanced_max:59029 - global_seqlen/mean:58646.5 - actor/entropy:0.09330248832702637 - actor/kl_loss:0.4511134494096041 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15294485506165073 - actor/pg_clipfrac:0.0031351960613392295 - actor/ppo_kl:0.009130345531957573 - actor/pg_clipfrac_lower:0.00016189546440728008 - actor/grad_norm:83.95039451122284 - perf/mfu/actor:0.1475227029955594 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.54582977294922 - actor/lr:1e-06 - training/global_step:523 - training/epoch:14 - critic/score/mean:0.6859375238418579 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.6859375238418579 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1655346155166626 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1655346155166626 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888528108596802 - response_length/mean:1056.9749755859375 - response_length/max:2048.0 - response_length/min:93.0 - response_length/clip_ratio:0.4156250059604645 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.6859375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:9.502097964286804e-05 - timing_s/generate_sequences:67.53377532958984 - timing_s/reshard:0.8620803952217102 - timing_s/gen:69.52107273414731 - timing_s/reward:0.15254362486302853 - timing_s/old_log_prob:1.9241850096732378 - timing_s/ref:1.6811557337641716 - timing_s/adv:0.008022807538509369 - timing_s/update_actor:8.9057887326926 - timing_s/step:82.2083608713001 - timing_s/stop_profile:4.3720006942749023e-05 - timing_per_token_ms/adv:1.709992825341105e-05 - timing_per_token_ms/gen:0.2055425646720219 - timing_per_token_ms/ref:0.0035832396941082837 - timing_per_token_ms/update_actor:0.0189819271667802 - perf/total_num_tokens:469172 - perf/time_per_step:82.2083608713001 - perf/throughput:713.3885091300267
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.809374988079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.809374988079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.1192503571510315, 'critic/advantages/max': 1.78885018825531, 'critic/advantages/min': -1.7888528108596802, 'critic/returns/mean': -0.1192503571510315, 'critic/returns/max': 1.78885018825531, 'critic/returns/min': -1.7888528108596802, 'response_length/mean': 955.515625, 'response_length/max': 2048.0, 'response_length/min': 90.0, 'response_length/clip_ratio': 0.3531250059604645, 'prompt_length/mean': 409.078125, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.809375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:524 - global_seqlen/min:38106 - global_seqlen/max:68541 - global_seqlen/minmax_diff:30435 - global_seqlen/balanced_min:54453 - global_seqlen/balanced_max:55491 - global_seqlen/mean:54583.75 - actor/entropy:0.10765562951564789 - actor/kl_loss:0.5125597968697548 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21774133965373038 - actor/pg_clipfrac:0.010117900975455996 - actor/ppo_kl:0.07904270740255015 - actor/pg_clipfrac_lower:0.0002797768916934729 - actor/grad_norm:53.084297597408295 - perf/mfu/actor:0.1395161847066844 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.50110626220703 - actor/lr:1e-06 - training/global_step:524 - training/epoch:14 - critic/score/mean:0.809374988079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.809374988079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.1192503571510315 - critic/advantages/max:1.78885018825531 - critic/advantages/min:-1.7888528108596802 - critic/returns/mean:-0.1192503571510315 - critic/returns/max:1.78885018825531 - critic/returns/min:-1.7888528108596802 - response_length/mean:955.515625 - response_length/max:2048.0 - response_length/min:90.0 - response_length/clip_ratio:0.3531250059604645 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.809375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:8.68774950504303e-05 - timing_s/generate_sequences:66.73076629638672 - timing_s/reshard:0.8827264308929443 - timing_s/gen:68.95726974867284 - timing_s/reward:0.1385498009622097 - timing_s/old_log_prob:1.8475667517632246 - timing_s/ref:1.6196312922984362 - timing_s/adv:0.007807387039065361 - timing_s/update_actor:8.729530496522784 - timing_s/step:81.31637553684413 - timing_s/stop_profile:4.4129788875579834e-05 - timing_per_token_ms/adv:1.7879375819418235e-05 - timing_per_token_ms/gen:0.22552375107900788 - timing_per_token_ms/ref:0.0037090509819736554 - timing_per_token_ms/update_actor:0.019991138609299436 - perf/total_num_tokens:436670 - perf/time_per_step:81.31637553684413 - perf/throughput:671.2516346140922
[36m(TaskRunner pid=2949575)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 525}
[36m(TaskRunner pid=2949575)[0m validation generation end
[36m(TaskRunner pid=2949575)[0m [prompt] system
[36m(TaskRunner pid=2949575)[0m You are a helpful assistant.
[36m(TaskRunner pid=2949575)[0m user
[36m(TaskRunner pid=2949575)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m Solve the problem in the image.
[36m(TaskRunner pid=2949575)[0m assistant
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m [response] <think>
[36m(TaskRunner pid=2949575)[0m Given that the hyperbola \(C\) is an equilateral hyperbola with its center at the origin and foci on the \(x\)-axis, the standard form of the equation of the hyperbola is:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m \frac{x^2}{a^2} - \frac{y^2}{b^2} = 1
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m For an equilateral hyperbola, \(a = b\), so the equation simplifies to:
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m \[
[36m(TaskRunner pid=2949575)[0m x^2 - y^2 = a^2
[36m(TaskRunner pid=2949575)[0m \]
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The foci of the hyperbola are at \((\pm c, 0)\) where \(c = \sqrt{a^2 + b^2} = \sqrt{2a^2} = a\sqrt{2}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The given parabola is \(y^2 = 16x\). The standard form of a parabola \(y^2 = 4px\) has its focus at \((p, 0)\) and its directrix at \(x = -p\). Here, \(4p = 16\), so \(p = 4\). Therefore, the focus of the parabola is \((4, 0)\) and the directrix is \(x = -4\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The hyperbola intersects the parabola at points \(A\) and \(B\). The distance between the foci of the hyperbola is \(2a\sqrt{2}\), and the distance between the points of intersection \(A\) and \(B\) is given as \(4\sqrt{3}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the parabola is the same as the distance between the points of intersection of the hyperbola and the directrix of the parabola. The distance between the points of intersection of the hyperbola and the directrix of the parabola is the same as the distance between the points of intersection of the hyperbola and the directrix of the parabola, which is \(2a\sqrt{2}\).
[36m(TaskRunner pid=2949575)[0m 
[36m(TaskRunner pid=2949575)[0m The distance between the points of intersection of the hyperbola and the directrix of the parabola is the same as the distance between the points of intersection of the hyperbأوضاع the directrix of the parabola. The distance between the points of intersection of the hyperbأوضاع the directأوضاع the direct of the parabola. The distance between the pointsأوضاع the direct of the parabola. The distance betweenأوضاع the direct ofأوضاع theأوضاع the <أوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاعأوضاع[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:43:19,010:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 09:43:23,545:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951182)[0m INFO:2025-08-06 09:43:23,547:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:43:19,286:[Rank 1] Saved model to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/model_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2950917)[0m INFO:2025-08-06 09:43:24,268:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/huggingface

[36m(TaskRunner pid=2949575)[0m [ground_truth] C
[36m(TaskRunner pid=2949575)[0m [score] -0.5
[36m(TaskRunner pid=2949575)[0m [structure] -0.5
[36m(TaskRunner pid=2949575)[0m [boxed] 0.0
[36m(TaskRunner pid=2949575)[0m [correct] 0.0
[36m(TaskRunner pid=2949575)[0m [acc] False
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['score']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['structure']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['boxed']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['correct']: 100
[36m(TaskRunner pid=2949575)[0m len reward_extra_infos_dict['acc']: 100
[36m(TaskRunner pid=2949575)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525
[36m(TaskRunner pid=2949575)[0m batch.non_tensor_batch 14 dict_keys(['type', 'data_source', 'ability', 'reward_model', 'extra_info', 'uid', 'tools_kwargs', 'interaction_kwargs', 'index', 'score', 'structure', 'boxed', 'correct', 'acc'])
[36m(TaskRunner pid=2949575)[0m metrics {'critic/score/mean': 0.535937488079071, 'critic/score/max': 2.0, 'critic/score/min': -0.5, 'critic/rewards/mean': 0.535937488079071, 'critic/rewards/max': 2.0, 'critic/rewards/min': -0.5, 'critic/advantages/mean': -0.0991881713271141, 'critic/advantages/max': 1.7888528108596802, 'critic/advantages/min': -1.7888517379760742, 'critic/returns/mean': -0.0991881713271141, 'critic/returns/max': 1.7888528108596802, 'critic/returns/min': -1.7888517379760742, 'response_length/mean': 1158.2281494140625, 'response_length/max': 2048.0, 'response_length/min': 84.0, 'response_length/clip_ratio': 0.484375, 'prompt_length/mean': 409.84375, 'prompt_length/max': 414.0, 'prompt_length/min': 407.0, 'prompt_length/clip_ratio': 0.0, 'train-reward/score/mean': 0.5359375, 'train-acc/score/ratio': 0.0}
[36m(TaskRunner pid=2949575)[0m group_metrics {'train-acc/group_all_correct/ratio': 0.0, 'train-acc/group_any_correct/ratio': 0.0, 'train-acc/group_all_wrong/ratio': 1.0}
[36m(TaskRunner pid=2949575)[0m step:525 - global_seqlen/min:46274 - global_seqlen/max:77493 - global_seqlen/minmax_diff:31219 - global_seqlen/balanced_min:62289 - global_seqlen/balanced_max:63443 - global_seqlen/mean:62722.875 - actor/entropy:0.06959914416074753 - actor/kl_loss:0.39708100743591784 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1251071685925126 - actor/pg_clipfrac:0.00583620057295775 - actor/ppo_kl:0.025631543347822118 - actor/pg_clipfrac_lower:0.0005782648295280524 - actor/grad_norm:35.96498167514801 - perf/mfu/actor:0.15746057674853936 - perf/max_memory_allocated_gb:74.08129787445068 - perf/max_memory_reserved_gb:123.484375 - perf/cpu_memory_used_gb:97.50135803222656 - actor/lr:1e-06 - val-aux/grpo_convert/reward/mean@50:0.45999999999999996 - val-aux/grpo_convert/reward/std@50:0.36864617182333526 - val-aux/grpo_convert/reward/best@2/mean:0.63775 - val-aux/grpo_convert/reward/best@2/std:0.22380222854118323 - val-aux/grpo_convert/reward/worst@2/mean:0.27825 - val-aux/grpo_convert/reward/worst@2/std:0.41217646402966773 - val-aux/grpo_convert/reward/best@4/mean:0.727 - val-aux/grpo_convert/reward/best@4/std:0.10474254150057655 - val-aux/grpo_convert/reward/worst@4/mean:0.07674999999999998 - val-aux/grpo_convert/reward/worst@4/std:0.39280648861748707 - val-aux/grpo_convert/reward/best@8/mean:0.749 - val-aux/grpo_convert/reward/best@8/std:0.022338307903688678 - val-aux/grpo_convert/reward/worst@8/mean:-0.11274999999999999 - val-aux/grpo_convert/reward/worst@8/std:0.3814117689584316 - val-aux/grpo_convert/reward/best@16/mean:0.75 - val-aux/grpo_convert/reward/best@16/std:0.0 - val-aux/grpo_convert/reward/worst@16/mean:-0.308 - val-aux/grpo_convert/reward/worst@16/std:0.32731636072766057 - val-aux/grpo_convert/reward/best@32/mean:0.75 - val-aux/grpo_convert/reward/best@32/std:0.0 - val-aux/grpo_convert/reward/worst@32/mean:-0.4445 - val-aux/grpo_convert/reward/worst@32/std:0.19632816914543874 - val-aux/grpo_convert/reward/best@50/mean:0.75 - val-aux/grpo_convert/reward/best@50/std:0.0 - val-aux/grpo_convert/reward/worst@50/mean:-0.49324999999999997 - val-aux/grpo_convert/reward/worst@50/std:0.07083034307413735 - val-aux/grpo_convert/score/mean@50:0.45999999999999996 - val-aux/grpo_convert/score/std@50:0.36864617182333526 - val-aux/grpo_convert/score/best@2/mean:0.63775 - val-aux/grpo_convert/score/best@2/std:0.22380222854118323 - val-aux/grpo_convert/score/worst@2/mean:0.27825 - val-aux/grpo_convert/score/worst@2/std:0.41217646402966773 - val-aux/grpo_convert/score/best@4/mean:0.727 - val-aux/grpo_convert/score/best@4/std:0.10474254150057655 - val-aux/grpo_convert/score/worst@4/mean:0.07674999999999998 - val-aux/grpo_convert/score/worst@4/std:0.39280648861748707 - val-aux/grpo_convert/score/best@8/mean:0.749 - val-aux/grpo_convert/score/best@8/std:0.022338307903688678 - val-aux/grpo_convert/score/worst@8/mean:-0.11274999999999999 - val-aux/grpo_convert/score/worst@8/std:0.3814117689584316 - val-aux/grpo_convert/score/best@16/mean:0.75 - val-aux/grpo_convert/score/best@16/std:0.0 - val-aux/grpo_convert/score/worst@16/mean:-0.308 - val-aux/grpo_convert/score/worst@16/std:0.32731636072766057 - val-aux/grpo_convert/score/best@32/mean:0.75 - val-aux/grpo_convert/score/best@32/std:0.0 - val-aux/grpo_convert/score/worst@32/mean:-0.4445 - val-aux/grpo_convert/score/worst@32/std:0.19632816914543874 - val-aux/grpo_convert/score/best@50/mean:0.75 - val-aux/grpo_convert/score/best@50/std:0.0 - val-aux/grpo_convert/score/worst@50/mean:-0.49324999999999997 - val-aux/grpo_convert/score/worst@50/std:0.07083034307413735 - val-aux/grpo_convert/structure/mean@50:-0.04000000000000001 - val-aux/grpo_convert/structure/std@50:0.13564659966250533 - val-aux/grpo_convert/structure/best@2/mean:-0.003500000000000003 - val-aux/grpo_convert/structure/best@2/std:0.041686328694189416 - val-aux/grpo_convert/structure/worst@2/mean:-0.08349999999999999 - val-aux/grpo_convert/structure/worst@2/std:0.1864879352666011 - val-aux/grpo_convert/structure/best@4/mean:0.0 - val-aux/grpo_convert/structure/best@4/std:0.0 - val-aux/grpo_convert/structure/worst@4/mean:-0.14450000000000002 - val-aux/grpo_convert/structure/worst@4/std:0.22664895764154755 - val-aux/grpo_convert/structure/best@8/mean:0.0 - val-aux/grpo_convert/structure/best@8/std:0.0 - val-aux/grpo_convert/structure/worst@8/mean:-0.2445 - val-aux/grpo_convert/structure/worst@8/std:0.2499394926777279 - val-aux/grpo_convert/structure/best@16/mean:0.0 - val-aux/grpo_convert/structure/best@16/std:0.0 - val-aux/grpo_convert/structure/worst@16/mean:-0.372 - val-aux/grpo_convert/structure/worst@16/std:0.2182109071517737 - val-aux/grpo_convert/structure/best@32/mean:0.0 - val-aux/grpo_convert/structure/best@32/std:0.0 - val-aux/grpo_convert/structure/worst@32/mean:-0.46299999999999997 - val-aux/grpo_convert/structure/worst@32/std:0.13088544609695915 - val-aux/grpo_convert/structure/best@50/mean:0.0 - val-aux/grpo_convert/structure/best@50/std:0.0 - val-aux/grpo_convert/structure/worst@50/mean:-0.4955 - val-aux/grpo_convert/structure/worst@50/std:0.04722022871609158 - val-aux/grpo_convert/boxed/mean@50:0.23 - val-aux/grpo_convert/boxed/std@50:0.06782329983125268 - val-aux/grpo_convert/boxed/best@2/mean:0.24825 - val-aux/grpo_convert/boxed/best@2/std:0.020843164347094708 - val-aux/grpo_convert/boxed/worst@2/mean:0.20825 - val-aux/grpo_convert/boxed/worst@2/std:0.09324396763330055 - val-aux/grpo_convert/boxed/best@4/mean:0.25 - val-aux/grpo_convert/boxed/best@4/std:0.0 - val-aux/grpo_convert/boxed/worst@4/mean:0.17775 - val-aux/grpo_convert/boxed/worst@4/std:0.11332447882077377 - val-aux/grpo_convert/boxed/best@8/mean:0.25 - val-aux/grpo_convert/boxed/best@8/std:0.0 - val-aux/grpo_convert/boxed/worst@8/mean:0.12775 - val-aux/grpo_convert/boxed/worst@8/std:0.12496974633886394 - val-aux/grpo_convert/boxed/best@16/mean:0.25 - val-aux/grpo_convert/boxed/best@16/std:0.0 - val-aux/grpo_convert/boxed/worst@16/mean:0.064 - val-aux/grpo_convert/boxed/worst@16/std:0.10910545357588684 - val-aux/grpo_convert/boxed/best@32/mean:0.25 - val-aux/grpo_convert/boxed/best@32/std:0.0 - val-aux/grpo_convert/boxed/worst@32/mean:0.0185 - val-aux/grpo_convert/boxed/worst@32/std:0.06544272304847959 - val-aux/grpo_convert/boxed/best@50/mean:0.25 - val-aux/grpo_convert/boxed/best@50/std:0.0 - val-aux/grpo_convert/boxed/worst@50/mean:0.00225 - val-aux/grpo_convert/boxed/worst@50/std:0.02361011435804579 - val-aux/grpo_convert/correct/mean@50:0.27 - val-aux/grpo_convert/correct/std@50:0.24919871588754228 - val-aux/grpo_convert/correct/best@2/mean:0.393 - val-aux/grpo_convert/correct/best@2/std:0.20506340482884802 - val-aux/grpo_convert/correct/worst@2/mean:0.1535 - val-aux/grpo_convert/correct/worst@2/std:0.2306246951217497 - val-aux/grpo_convert/correct/best@4/mean:0.477 - val-aux/grpo_convert/correct/best@4/std:0.10474254150057655 - val-aux/grpo_convert/correct/worst@4/mean:0.0435 - val-aux/grpo_convert/correct/worst@4/std:0.1409175290728588 - val-aux/grpo_convert/correct/best@8/mean:0.499 - val-aux/grpo_convert/correct/best@8/std:0.022338307903688678 - val-aux/grpo_convert/correct/worst@8/mean:0.004 - val-aux/grpo_convert/correct/worst@8/std:0.044542114902640165 - val-aux/grpo_convert/correct/best@16/mean:0.5 - val-aux/grpo_convert/correct/best@16/std:0.0 - val-aux/grpo_convert/correct/worst@16/mean:0.0 - val-aux/grpo_convert/correct/worst@16/std:0.0 - val-aux/grpo_convert/correct/best@32/mean:0.5 - val-aux/grpo_convert/correct/best@32/std:0.0 - val-aux/grpo_convert/correct/worst@32/mean:0.0 - val-aux/grpo_convert/correct/worst@32/std:0.0 - val-aux/grpo_convert/correct/best@50/mean:0.5 - val-aux/grpo_convert/correct/best@50/std:0.0 - val-aux/grpo_convert/correct/worst@50/mean:0.0 - val-aux/grpo_convert/correct/worst@50/std:0.0 - val-core/grpo_convert/acc/mean@50:0.27 - val-aux/grpo_convert/acc/std@50:0.24919871588754228 - val-aux/grpo_convert/acc/best@2/mean:0.393 - val-aux/grpo_convert/acc/best@2/std:0.20506340482884802 - val-aux/grpo_convert/acc/worst@2/mean:0.1535 - val-aux/grpo_convert/acc/worst@2/std:0.2306246951217497 - val-aux/grpo_convert/acc/best@4/mean:0.477 - val-aux/grpo_convert/acc/best@4/std:0.10474254150057655 - val-aux/grpo_convert/acc/worst@4/mean:0.0435 - val-aux/grpo_convert/acc/worst@4/std:0.1409175290728588 - val-aux/grpo_convert/acc/best@8/mean:0.499 - val-aux/grpo_convert/acc/best@8/std:0.022338307903688678 - val-aux/grpo_convert/acc/worst@8/mean:0.004 - val-aux/grpo_convert/acc/worst@8/std:0.044542114902640165 - val-aux/grpo_convert/acc/best@16/mean:0.5 - val-aux/grpo_convert/acc/best@16/std:0.0 - val-aux/grpo_convert/acc/worst@16/mean:0.0 - val-aux/grpo_convert/acc/worst@16/std:0.0 - val-aux/grpo_convert/acc/best@32/mean:0.5 - val-aux/grpo_convert/acc/best@32/std:0.0 - val-aux/grpo_convert/acc/worst@32/mean:0.0 - val-aux/grpo_convert/acc/worst@32/std:0.0 - val-core/grpo_convert/acc/best@50/mean:0.5 - val-core/grpo_convert/acc/best@50/std:0.0 - val-aux/grpo_convert/acc/worst@50/mean:0.0 - val-aux/grpo_convert/acc/worst@50/std:0.0 - training/global_step:525 - training/epoch:14 - critic/score/mean:0.535937488079071 - critic/score/max:2.0 - critic/score/min:-0.5 - critic/rewards/mean:0.535937488079071 - critic/rewards/max:2.0 - critic/rewards/min:-0.5 - critic/advantages/mean:-0.0991881713271141 - critic/advantages/max:1.7888528108596802 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.0991881713271141 - critic/returns/max:1.7888528108596802 - critic/returns/min:-1.7888517379760742 - response_length/mean:1158.2281494140625 - response_length/max:2048.0 - response_length/min:84.0 - response_length/clip_ratio:0.484375 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - train-reward/score/mean:0.5359375 - train-acc/score/ratio:0.0 - train-acc/group_all_correct/ratio:0.0 - train-acc/group_any_correct/ratio:0.0 - train-acc/group_all_wrong/ratio:1.0 - timing_s/start_profile:7.325783371925354e-05 - timing_s/generate_sequences:68.03157806396484 - timing_s/reshard:0.8343246579170227 - timing_s/gen:71.11021743901074 - timing_s/reward:0.16257513128221035 - timing_s/old_log_prob:2.091417232528329 - timing_s/ref:1.7955937888473272 - timing_s/adv:0.007993388921022415 - timing_s/update_actor:8.958286827430129 - timing_s/testing:68.64933813922107 - timing_s/save_checkpoint:10.315358074381948 - timing_s/step:163.10670833848417 - timing_s/stop_profile:5.206838250160217e-05 - timing_per_token_ms/adv:1.5929971563449568e-05 - timing_per_token_ms/gen:0.1918615380686845 - timing_per_token_ms/ref:0.003578426907343069 - timing_per_token_ms/update_actor:0.017852910177168474 - perf/total_num_tokens:501783 - perf/time_per_step:163.10670833848417 - perf/throughput:384.5511667725862
[36m(TaskRunner pid=2949575)[0m ("Final validation metrics: {'val-aux/grpo_convert/reward/mean@50': "
[36m(TaskRunner pid=2949575)[0m  "0.45999999999999996, 'val-aux/grpo_convert/reward/std@50': "
[36m(TaskRunner pid=2949575)[0m  "0.36864617182333526, 'val-aux/grpo_convert/reward/best@2/mean': 0.63775, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@2/std': 0.22380222854118323, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@2/mean': 0.27825, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@2/std': 0.41217646402966773, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@4/mean': 0.727, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@4/std': 0.10474254150057655, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@4/mean': 0.07674999999999998, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@4/std': 0.39280648861748707, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@8/mean': 0.749, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@8/std': 0.022338307903688678, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@8/mean': -0.11274999999999999, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@8/std': 0.3814117689584316, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@16/mean': 0.75, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@16/mean': -0.308, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@16/std': 0.32731636072766057, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@32/mean': 0.75, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@32/mean': -0.4445, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@32/std': 0.19632816914543874, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@50/mean': 0.75, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@50/mean': -0.49324999999999997, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/reward/worst@50/std': 0.07083034307413735, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/mean@50': 0.45999999999999996, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/std@50': 0.36864617182333526, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@2/mean': 0.63775, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@2/std': 0.22380222854118323, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@2/mean': 0.27825, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@2/std': 0.41217646402966773, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@4/mean': 0.727, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@4/std': 0.10474254150057655, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@4/mean': 0.07674999999999998, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@4/std': 0.39280648861748707, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@8/mean': 0.749, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@8/std': 0.022338307903688678, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@8/mean': -0.11274999999999999, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@8/std': 0.3814117689584316, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@16/mean': 0.75, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@16/mean': -0.308, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@16/std': 0.32731636072766057, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@32/mean': 0.75, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@32/mean': -0.4445, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@32/std': 0.19632816914543874, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@50/mean': 0.75, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@50/mean': -0.49324999999999997, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/score/worst@50/std': 0.07083034307413735, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/mean@50': -0.04000000000000001, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/std@50': 0.13564659966250533, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@2/mean': -0.003500000000000003, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@2/std': 0.041686328694189416, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@2/mean': -0.08349999999999999, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@2/std': 0.1864879352666011, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@4/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@4/mean': -0.14450000000000002, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@4/std': 0.22664895764154755, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@8/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@8/mean': -0.2445, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@8/std': 0.2499394926777279, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@16/mean': -0.372, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@16/std': 0.2182109071517737, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@32/mean': -0.46299999999999997, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@32/std': 0.13088544609695915, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@50/mean': -0.4955, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/structure/worst@50/std': 0.04722022871609158, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/mean@50': 0.23, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/std@50': 0.06782329983125268, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@2/mean': 0.24825, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@2/std': 0.020843164347094708, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@2/mean': 0.20825, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@2/std': 0.09324396763330055, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@4/mean': 0.25, "
[36m(TaskRunner pid=2949575)[0m Training Progress: 100%|██████████| 525/525 [10:03:39<00:00, 107.22s/it]Training Progress: 100%|██████████| 525/525 [10:03:39<00:00, 68.99s/it] 
[36m(TaskRunner pid=2949575)[0m wandb:                                                                                
[36m(TaskRunner pid=2949575)[0m wandb: 
[36m(TaskRunner pid=2949575)[0m wandb: Run history:
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/entropy █▇▆▅▄▄▄▄▄▄▃▃▃▃▃▃▃▃▃▃▅▇▆▂▁▂▂▂▂▂▂▂▁▁▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:                              actor/grad_norm ▁▁▁▁▁▁▁▂▂▁▂▂▂▂▂▆█▂▁▁▂▂▁▁▃▂▂▁▂▁▁▁▁▁▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/kl_coef ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/kl_loss ▁▁▁▁▁▂▃▂▂▃▄▄▅▅▅▆▆▅█▇▆▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                                     actor/lr ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                            actor/pg_clipfrac ▁▁▁▁▁▁▁▂▂▅▃▁▂▃▄▂▄▃▇█▇█▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                      actor/pg_clipfrac_lower ▁▁▁▁▁▁▁█▁▂▂▇▁▁▃▆▅▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/pg_loss ▄▄▅▂▃▃▄▁▆▄▂▇▅▄▅▄▄▄▂▄▅▆▂▅▇▅▅▆▅▄▅▅▄▄▅▄▄▅█▅
[36m(TaskRunner pid=2949575)[0m wandb:                                 actor/ppo_kl ▅▅▅▅▅▅▅▅▅▅▅▅▇▃▆▅▆▆█▁▂▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
[36m(TaskRunner pid=2949575)[0m wandb:                        critic/advantages/max ████████████████████████████████▂▁██████
[36m(TaskRunner pid=2949575)[0m wandb:                       critic/advantages/mean ▇▇▇▆▆▇▇▇▇▇▇▇▇██▅▄▁▁▁▅▆▅▄▅▆▆▇▆▆▆▇▇▇▇▇▇▇▄▅
[36m(TaskRunner pid=2949575)[0m wandb:                        critic/advantages/min ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▄▂▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/returns/max ▅▁▁▁▁▁▁▁▅▁█▅███▅████▅▁▁▅█▅███████▅██▅███
[36m(TaskRunner pid=2949575)[0m wandb:                          critic/returns/mean ▇▇▇▆▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇██▄▃▂▂▁▃▆▅▆▆▆▇▇▇▇▆▇▇▆
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/returns/min ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/rewards/max ██████████████████████████████▁█████████
[36m(TaskRunner pid=2949575)[0m wandb:                          critic/rewards/mean ▄▆▇▇▇▇█▇████▇▇▇▇▇▇▇▇▇▆▇▅▇▆▆▆▆▆▅▂▂▁▁▁▁▂▃▅
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/rewards/min ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                             critic/score/max ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                            critic/score/mean ▂▃▇████████████▇▇▇▇▇▆▆▆▇▇▆▆▅▅▅▄▅▂▃▂▁▁▁▁▅
[36m(TaskRunner pid=2949575)[0m wandb:                             critic/score/min ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                   global_seqlen/balanced_max ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▃▂▄▄▅▅▅▄▆▇▇██▇█▄▅
[36m(TaskRunner pid=2949575)[0m wandb:                   global_seqlen/balanced_min ▁▁▂▁▁▂▂▁▂▁▁▁▁▁▂▂▃▃▂▂▅▅▄▄▅▅▇▇▇▇█████▇▄▅▅▄
[36m(TaskRunner pid=2949575)[0m wandb:                            global_seqlen/max ▁▂▁▁▂▂▂▂▂▂▂▂▁▁▁▁▂▂▃▅▃▂▃▆▆▇▇█████████▇▅▆▄
[36m(TaskRunner pid=2949575)[0m wandb:                           global_seqlen/mean ▁▁▁▁▁▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▂▂▃▃▄▅▅▅▆▄▇███▆▆▅▄▅
[36m(TaskRunner pid=2949575)[0m wandb:                            global_seqlen/min ▁▁▁▁▁▂▂▂▂▁▂▂▁▂▂▁▁▁▁▁▁▂▂▃▂▂▄▃▃▆▇█████▄▄▄▄
[36m(TaskRunner pid=2949575)[0m wandb:                    global_seqlen/minmax_diff ▁▂▁▁▁▁▁▂▂▁▂▂▁▁▁▁▂▂▂▃▅▅▇▅▇▆▄▄▄▄▂▂▂▃▂▇▆█▆▄
[36m(TaskRunner pid=2949575)[0m wandb:                      perf/cpu_memory_used_gb ▃▃▃▃▁▁▂▂▃▂▂▂▃▃▃▄▄▃▄▄▄▅▄▄▄▅██▃▄▆▆▆▆▅▅▅▅▄▅
[36m(TaskRunner pid=2949575)[0m wandb:                 perf/max_memory_allocated_gb ▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▆▆██████████████████
[36m(TaskRunner pid=2949575)[0m wandb:                  perf/max_memory_reserved_gb ▁▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▅▅▅▇▇█████████████
[36m(TaskRunner pid=2949575)[0m wandb:                               perf/mfu/actor ▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▂▃▂▄▅▅▇▇▇▆▇██▇█▇▇▄▅▄
[36m(TaskRunner pid=2949575)[0m wandb:                              perf/throughput ▂▃▁▃▄▃▃▄▄▅▄▅▆▆▅▅▅▂▃▃▄▃▃▃▅▂▅▅▅▇▇▇▇▇▇█▇▅▅▄
[36m(TaskRunner pid=2949575)[0m wandb:                           perf/time_per_step ▃▅▂▃▃▅▆▅▆▄▃▂▃▂▃▂▂▂▁▁▁▁▆▆▆▆█▇▆█▇▇█▇▇██▇▆▇
[36m(TaskRunner pid=2949575)[0m wandb:                        perf/total_num_tokens ▁▁▁▁▁▂▁▂▁▁▂▁▂▁▁▁▁▁▁▁▁▂▂▂▂▃▂▂▂▅▄▇██▇▇██▇▄
[36m(TaskRunner pid=2949575)[0m wandb:                     prompt_length/clip_ratio ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                            prompt_length/max ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                           prompt_length/mean ▆▄▅▄▄▅▅▅▄▇▄▅▅▅▅▆▅▅▅▄▂▃▅▆▅█▃▅▃▇▄█▄▄▁▇▅▇▃▆
[36m(TaskRunner pid=2949575)[0m wandb:                            prompt_length/min ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                   response_length/clip_ratio ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▂▂▂▅▄▇▇▆▇███▆▆▅
[36m(TaskRunner pid=2949575)[0m wandb:                          response_length/max ▄██▇▅▄█▃▃▃▃▂▃▃▂▂▃▂▂▁▇███████████████████
[36m(TaskRunner pid=2949575)[0m wandb:                         response_length/mean ▁▁▁▁▁▂▁▂▁▁▂▁▁▁▁▁▁▁▁▁▁▂▂▃▃▃▂▅▄▄▇█▇██▇▇▅▅▄
[36m(TaskRunner pid=2949575)[0m wandb:                          response_length/min ▂▂▂▂▂▃▃▃▃▃▃▃▃▃▂▃▁▃▁▁▁▄▃▃▃▃▃▄▃▃▅▄▃█▅▄▃▃▁▃
[36m(TaskRunner pid=2949575)[0m wandb:                      timing_per_token_ms/adv █▅▅▅▇▅▅▅▆▅▅▅▅▇▅▆▅▄▃▅▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂
[36m(TaskRunner pid=2949575)[0m wandb:                      timing_per_token_ms/gen ▆▅▄█▄▄▆▄▃▄▃▃▂▃▂▃▆▆▆▄▃▃▃▃▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:                      timing_per_token_ms/ref ██▆▇▆▆▆▇▇▆▆▆▇▇▇██▇▆▆▅▄▄▄▄▂▂▁▁▁▁▁▁▁▁▁▂▂▂▃
[36m(TaskRunner pid=2949575)[0m wandb:             timing_per_token_ms/update_actor ███▇▇▇▇█▇█▇▇▇▇▇███▇▅▅▆▆▆▃▄▄▂▁▂▂▁▁▂▁▁▂▂▃▃
[36m(TaskRunner pid=2949575)[0m wandb:                                 timing_s/adv ▇▂▁▁▁▂▂▆▂▁▁▂█▂▂▂▁▁▂▁▁▁▂▂▆▂▁▁▁▁▂▂▁▁▃▂▂▂▂▂
[36m(TaskRunner pid=2949575)[0m wandb:                                 timing_s/gen ▃▄▆▆▃▃▃▂▃▆▃▅▄▂▂▃▂▂▂▁▁▅▇▇▇████▇██████████
[36m(TaskRunner pid=2949575)[0m wandb:                  timing_s/generate_sequences ▂▂▃▃▄▂▅▄▃▂▃▃▃▂▂▂▂▁▁▁▁▃▆▇▇▇▇▇▇███▇███████
[36m(TaskRunner pid=2949575)[0m wandb:                        timing_s/old_log_prob ▂▂▁▂▁▂▂▂▂▂▂▁▁▁▂▂▁▁▁▂▃▃▃▃▄▆▆▇▇▇▇▇▇▇▇██▆▅▆
[36m(TaskRunner pid=2949575)[0m wandb:                                 timing_s/ref ▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▂▁▂▂▂▂▂▆▇██▇█████████▆
[36m(TaskRunner pid=2949575)[0m wandb:                             timing_s/reshard ▃▆▂▃▁▄▂▃▂▃▂▂▂▁▃▃▂▅▄▄▃▄▄▄▄▆▆▇▆▆▂█▇█▆▆▆▆▅▅
[36m(TaskRunner pid=2949575)[0m wandb:                              timing_s/reward ▁▁▁▁▁▁▁▁▁▁▁▁▂▂▃▃▃▂▄▅▅▄▄▅▇▇▇▇▇██████▆▄▄▅▄
[36m(TaskRunner pid=2949575)[0m wandb:                     timing_s/save_checkpoint ▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▂▁▇▇▇▆▇▇▇▇▇▇█▇▆▇▆▆▇▇▆▇
[36m(TaskRunner pid=2949575)[0m wandb:                       timing_s/start_profile ▁▁▁▁▂▁▂▁▁▂▁▂▂▂▂▁▁▁▁▁▁▁▂▂▂▂▂▁▁█▁▂▁▁▁▁▂▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                                timing_s/step ▃▁▃▄▃▃▂▂▂▂▂▂▄▁▁▁▁▁▁▃▄▄▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█
[36m(TaskRunner pid=2949575)[0m wandb:                        timing_s/stop_profile ▂▁▄▁▂▃▃█▃▂▂▃▅▃▂▃▁▂▂▃▃▃▄▃▃▂▃█▂▆▇▃▂▂▁▂▃▂▂▂
[36m(TaskRunner pid=2949575)[0m wandb:                             timing_s/testing ▇▃▃▁▇██████
[36m(TaskRunner pid=2949575)[0m wandb:                        timing_s/update_actor ▁▁▂▁▃▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▄▅▃▄▆▇█▇▇▇▇██████▇▆█
[36m(TaskRunner pid=2949575)[0m wandb:            train-acc/group_all_correct/ratio ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:              train-acc/group_all_wrong/ratio ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:            train-acc/group_any_correct/ratio ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                        train-acc/score/ratio ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:                      train-reward/score/mean ▇▇▇▇▇█████▇▇███▇▇▇▇▇▇▇▇▇▅▆▆▆▆▅▄▅▂▂▁▁▂▃▄▄
[36m(TaskRunner pid=2949575)[0m wandb:                               training/epoch ▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇████
[36m(TaskRunner pid=2949575)[0m wandb:                         training/global_step ▁▁▁▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▇▇▇█████
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/best@16/mean ▁██████▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@16/std ▁▆▅▄█▅▆▁▁▄▁▁
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@2/mean ▁███▇█▇▅▅▃▆▅
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/acc/best@2/std ▁▇▇▇▇▇█▅▄▅▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/best@32/mean ▁██████▅▅▅▅▅
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@32/std ▁▅▃▃█▁▃▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@4/mean ▁███▇█▇▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/acc/best@4/std ▁▆▆▇▆▇█▄▃▅▃▃
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@8/mean ▁███▇██▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/acc/best@8/std ▁▆▆▆▇▆█▃▂▅▁▂
[36m(TaskRunner pid=2949575)[0m wandb:              val-aux/grpo_convert/acc/std@50 ▁███▇██▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/acc/worst@16/mean ▁▁█▁█▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@16/std ▁▁█▁█▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@2/mean ▁██▇▇▇▄▃▅▂▆▅
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/worst@2/std ▁███▇█▇▅▅▄▆▆
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/acc/worst@32/mean ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@32/std ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@4/mean ▁█▇▅█▆▂▂▃▁▅▅
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/worst@4/std ▁██▇█▇▄▃▅▂▆▆
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/acc/worst@50/mean ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@50/std ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@8/mean ▁█▆▃█▄▂▁▁▁▂▃
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/worst@8/std ▁█▇▅█▆▃▁▂▁▄▄
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/best@16/mean ▁██████▃▃▃▃▃
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@16/std █▁▁▁▁▁▁▁▁▂▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@2/mean ▁███▇██▄▄▃▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/boxed/best@2/std ▅▂▁▂█▄▇▃▃█▃▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/best@32/mean ▁██████▂▂▂▂▂
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@32/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@4/mean ▁██████▄▄▃▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/boxed/best@4/std █▁▁▁▄▂▃▁▂█▂▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/best@50/mean ▁██████▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@50/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@8/mean ▁██████▄▄▄▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/boxed/best@8/std █▁▁▁▁▁▁▁▁▄▁▁
[36m(TaskRunner pid=2949575)[0m wandb:           val-aux/grpo_convert/boxed/mean@50 ▁███▆▇▇▄▄▂▄▄
[36m(TaskRunner pid=2949575)[0m wandb:            val-aux/grpo_convert/boxed/std@50 ▁▃▁▄█▆▇▃▃▄▃▂
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/boxed/worst@16/mean ▁▆█▄▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@16/std ▁█▄█▃▆▄▂▂▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@2/mean ▁██▇▅▇▆▄▃▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/worst@2/std ▁▅▃▆█▇█▄▄▃▄▃
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/boxed/worst@32/mean ▁▄█▂▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@32/std ▁█▅▆▁▃▂▁▁▁▁▃
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@4/mean ▁▇█▇▄▆▄▃▃▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/worst@4/std ▁▆▄▇▇██▅▅▂▅▄
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/boxed/worst@50/mean ▁▃█▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@50/std ▁█▅▅▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@8/mean ▁▇█▆▂▄▃▂▂▁▂▃
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/worst@8/std ▁▇▄█▅█▆▄▄▁▄▅
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/best@16/mean ▁██████▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@16/std ▁▆▅▄█▅▆▁▁▄▁▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@2/mean ▁███▇█▇▅▅▃▆▅
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/correct/best@2/std ▁▇▇▇▇▇█▅▄▅▄▄
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/best@32/mean ▁██████▅▅▅▅▅
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@32/std ▁▅▃▃█▁▃▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@4/mean ▁███▇█▇▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/correct/best@4/std ▁▆▆▇▆▇█▄▃▅▃▃
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/best@50/mean ▁██████▅▅▅▅▅
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@50/std ▁▁▁▁█▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@8/mean ▁███▇██▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/correct/best@8/std ▁▆▆▆▇▆█▃▂▅▁▂
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/correct/mean@50 ▁███▇█▆▄▅▃▆▆
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/correct/std@50 ▁███▇██▅▅▄▅▅
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/correct/worst@16/mean ▁▁█▁█▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@16/std ▁▁█▁█▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@2/mean ▁██▇▇▇▄▃▅▂▆▅
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/worst@2/std ▁███▇█▇▅▅▄▆▆
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/correct/worst@32/mean ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@32/std ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@4/mean ▁█▇▅█▆▂▂▃▁▅▅
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/worst@4/std ▁██▇█▇▄▃▅▂▆▆
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/correct/worst@50/mean ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@50/std ▁▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@8/mean ▁█▆▃█▄▂▁▁▁▂▃
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/worst@8/std ▁█▇▅█▆▃▁▂▁▄▄
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/best@16/mean ▁██████▃▃▃▃▃
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@16/std █▂▂▂▃▂▂▁▁▂▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@2/mean ▁███▇█▇▄▄▃▅▅
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/reward/best@2/std ▃▄▄▅▇▆█▂▂▇▂▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/best@32/mean ▁██████▂▂▂▂▂
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@32/std █▁▁▁▂▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@4/mean ▁██████▄▄▃▄▄
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/reward/best@4/std ▇▅▅▅▅▅▇▂▂█▁▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/best@50/mean ▁██████▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@50/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@8/mean ▁██████▄▄▄▄▄
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/reward/best@8/std █▃▃▃▄▃▄▂▁▄▁▁
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/reward/mean@50 ▁███▇▇▆▄▄▂▄▄
[36m(TaskRunner pid=2949575)[0m wandb:           val-aux/grpo_convert/reward/std@50 ▁▄▄▅█▆█▃▃▄▃▂
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/reward/worst@16/mean ▁▆█▄▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@16/std ▁█▅█▃▆▄▂▂▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@2/mean ▁██▇▆▇▅▄▄▁▄▄
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/worst@2/std ▁▅▅▆█▇▇▄▅▃▅▄
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/reward/worst@32/mean ▁▄█▂▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@32/std ▁█▅▆▁▃▂▁▁▁▁▃
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@4/mean ▁██▇▄▆▄▃▃▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/worst@4/std ▁▆▅▇██▇▄▅▂▅▄
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/reward/worst@50/mean ▁▃█▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@50/std ▁█▅▅▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@8/mean ▁▇█▆▂▄▃▂▂▁▂▃
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/worst@8/std ▁▇▅█▆█▆▄▄▁▄▅
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/best@16/mean ▁██████▃▃▃▃▃
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@16/std █▂▂▂▃▂▂▁▁▂▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@2/mean ▁███▇█▇▄▄▃▅▅
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/score/best@2/std ▃▄▄▅▇▆█▂▂▇▂▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/best@32/mean ▁██████▂▂▂▂▂
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@32/std █▁▁▁▂▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@4/mean ▁██████▄▄▃▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/score/best@4/std ▇▅▅▅▅▅▇▂▂█▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/best@50/mean ▁██████▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@50/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@8/mean ▁██████▄▄▄▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/score/best@8/std █▃▃▃▄▃▄▂▁▄▁▁
[36m(TaskRunner pid=2949575)[0m wandb:           val-aux/grpo_convert/score/mean@50 ▁███▇▇▆▄▄▂▄▄
[36m(TaskRunner pid=2949575)[0m wandb:            val-aux/grpo_convert/score/std@50 ▁▄▄▅█▆█▃▃▄▃▂
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/score/worst@16/mean ▁▆█▄▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@16/std ▁█▅█▃▆▄▂▂▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@2/mean ▁██▇▆▇▅▄▄▁▄▄
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/worst@2/std ▁▅▅▆█▇▇▄▅▃▅▄
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/score/worst@32/mean ▁▄█▂▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@32/std ▁█▅▆▁▃▂▁▁▁▁▃
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@4/mean ▁██▇▄▆▄▃▃▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/worst@4/std ▁▆▅▇██▇▄▅▂▅▄
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/score/worst@50/mean ▁▃█▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@50/std ▁█▅▅▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@8/mean ▁▇█▆▂▄▃▂▂▁▂▃
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/worst@8/std ▁▇▅█▆█▆▄▄▁▄▅
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/best@16/mean ▂██████▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@16/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@2/mean ▁██████▄▄▂▄▄
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/structure/best@2/std █▂▁▂▇▄▆▃▃▇▃▁
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/best@32/mean ▅██████▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@32/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@4/mean ▁██████▄▄▃▄▄
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/structure/best@4/std █▁▁▁▂▁▂▁▁▅▁▁
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/best@50/mean ▇██████▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@50/std █▁▁▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@8/mean ▁██████▃▃▃▃▃
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/structure/best@8/std █▁▁▁▁▁▁▁▁▃▁▁
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/structure/mean@50 ▁███▆▇▆▄▄▂▄▄
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/structure/std@50 ▄▃▁▄█▆█▃▃▄▃▂
[36m(TaskRunner pid=2949575)[0m wandb: val-aux/grpo_convert/structure/worst@16/mean ▁▆█▄▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@16/std ▁█▄█▃▆▄▂▂▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@2/mean ▁██▇▅▇▆▄▃▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/worst@2/std ▁▅▃▆█▇█▄▄▃▄▃
[36m(TaskRunner pid=2949575)[0m wandb: val-aux/grpo_convert/structure/worst@32/mean ▁▄█▂▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@32/std ▁█▅▆▁▃▂▁▁▁▁▃
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@4/mean ▁▇█▇▄▆▄▃▃▁▃▄
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/worst@4/std ▁▆▄▇███▅▅▂▅▄
[36m(TaskRunner pid=2949575)[0m wandb: val-aux/grpo_convert/structure/worst@50/mean ▁▃█▁▁▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@50/std ▁█▅▅▁▂▁▁▁▁▁▂
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@8/mean ▁▇█▆▂▄▃▂▂▁▂▃
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/worst@8/std ▁▇▄█▆█▆▄▄▁▄▅
[36m(TaskRunner pid=2949575)[0m wandb:       val-core/grpo_convert/acc/best@50/mean ▁██████▅▅▅▅▅
[36m(TaskRunner pid=2949575)[0m wandb:        val-core/grpo_convert/acc/best@50/std ▁▁▁▁█▁▁▁▁▁▁▁
[36m(TaskRunner pid=2949575)[0m wandb:            val-core/grpo_convert/acc/mean@50 ▁███▇█▆▄▅▃▆▆
[36m(TaskRunner pid=2949575)[0m wandb: 
[36m(TaskRunner pid=2949575)[0m wandb: Run summary:
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/entropy 0.0696
[36m(TaskRunner pid=2949575)[0m wandb:                              actor/grad_norm 35.96498
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/kl_coef 0.01
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/kl_loss 0.39708
[36m(TaskRunner pid=2949575)[0m wandb:                                     actor/lr 0.0
[36m(TaskRunner pid=2949575)[0m wandb:                            actor/pg_clipfrac 0.00584
[36m(TaskRunner pid=2949575)[0m wandb:                      actor/pg_clipfrac_lower 0.00058
[36m(TaskRunner pid=2949575)[0m wandb:                                actor/pg_loss 0.12511
[36m(TaskRunner pid=2949575)[0m wandb:                                 actor/ppo_kl 0.02563
[36m(TaskRunner pid=2949575)[0m wandb:                        critic/advantages/max 1.78885
[36m(TaskRunner pid=2949575)[0m wandb:                       critic/advantages/mean -0.09919
[36m(TaskRunner pid=2949575)[0m wandb:                        critic/advantages/min -1.78885
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/returns/max 1.78885
[36m(TaskRunner pid=2949575)[0m wandb:                          critic/returns/mean -0.09919
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/returns/min -1.78885
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/rewards/max 2
[36m(TaskRunner pid=2949575)[0m wandb:                          critic/rewards/mean 0.53594
[36m(TaskRunner pid=2949575)[0m wandb:                           critic/rewards/min -0.5
[36m(TaskRunner pid=2949575)[0m wandb:                             critic/score/max 2
[36m(TaskRunner pid=2949575)[0m wandb:                            critic/score/mean 0.53594
[36m(TaskRunner pid=2949575)[0m wandb:                             critic/score/min -0.5
[36m(TaskRunner pid=2949575)[0m wandb:                   global_seqlen/balanced_max 63443
[36m(TaskRunner pid=2949575)[0m wandb:                   global_seqlen/balanced_min 62289
[36m(TaskRunner pid=2949575)[0m wandb:                            global_seqlen/max 77493
[36m(TaskRunner pid=2949575)[0m wandb:                           global_seqlen/mean 62722.875
[36m(TaskRunner pid=2949575)[0m wandb:                            global_seqlen/min 46274
[36m(TaskRunner pid=2949575)[0m wandb:                    global_seqlen/minmax_diff 31219
[36m(TaskRunner pid=2949575)[0m wandb:                      perf/cpu_memory_used_gb 97.50136
[36m(TaskRunner pid=2949575)[0m wandb:                 perf/max_memory_allocated_gb 74.0813
[36m(TaskRunner pid=2949575)[0m wandb:                  perf/max_memory_reserved_gb 123.48438
[36m(TaskRunner pid=2949575)[0m wandb:                               perf/mfu/actor 0.15746
[36m(TaskRunner pid=2949575)[0m wandb:                              perf/throughput 384.55117
[36m(TaskRunner pid=2949575)[0m wandb:                           perf/time_per_step 163.10671
[36m(TaskRunner pid=2949575)[0m wandb:                        perf/total_num_tokens 501783
[36m(TaskRunner pid=2949575)[0m wandb:                     prompt_length/clip_ratio 0
[36m(TaskRunner pid=2949575)[0m wandb:                            prompt_length/max 414
[36m(TaskRunner pid=2949575)[0m wandb:                           prompt_length/mean 409.84375
[36m(TaskRunner pid=2949575)[0m wandb:                            prompt_length/min 407
[36m(TaskRunner pid=2949575)[0m wandb:                   response_length/clip_ratio 0.48438
[36m(TaskRunner pid=2949575)[0m wandb:                          response_length/max 2048
[36m(TaskRunner pid=2949575)[0m wandb:                         response_length/mean 1158.22815
[36m(TaskRunner pid=2949575)[0m wandb:                          response_length/min 84
[36m(TaskRunner pid=2949575)[0m wandb:                      timing_per_token_ms/adv 2e-05
[36m(TaskRunner pid=2949575)[0m wandb:                      timing_per_token_ms/gen 0.19186
[36m(TaskRunner pid=2949575)[0m wandb:                      timing_per_token_ms/ref 0.00358
[36m(TaskRunner pid=2949575)[0m wandb:             timing_per_token_ms/update_actor 0.01785
[36m(TaskRunner pid=2949575)[0m wandb:                                 timing_s/adv 0.00799
[36m(TaskRunner pid=2949575)[0m wandb:                                 timing_s/gen 71.11022
[36m(TaskRunner pid=2949575)[0m wandb:                  timing_s/generate_sequences 68.03158
[36m(TaskRunner pid=2949575)[0m wandb:                        timing_s/old_log_prob 2.09142
[36m(TaskRunner pid=2949575)[0m wandb:                                 timing_s/ref 1.79559
[36m(TaskRunner pid=2949575)[0m wandb:                             timing_s/reshard 0.83432
[36m(TaskRunner pid=2949575)[0m wandb:                              timing_s/reward 0.16258
[36m(TaskRunner pid=2949575)[0m wandb:                     timing_s/save_checkpoint 10.31536
[36m(TaskRunner pid=2949575)[0m wandb:                       timing_s/start_profile 7e-05
[36m(TaskRunner pid=2949575)[0m wandb:                                timing_s/step 163.10671
[36m(TaskRunner pid=2949575)[0m wandb:                        timing_s/stop_profile 5e-05
[36m(TaskRunner pid=2949575)[0m wandb:                             timing_s/testing 68.64934
[36m(TaskRunner pid=2949575)[0m wandb:                        timing_s/update_actor 8.95829
[36m(TaskRunner pid=2949575)[0m wandb:            train-acc/group_all_correct/ratio 0
[36m(TaskRunner pid=2949575)[0m wandb:              train-acc/group_all_wrong/ratio 1
[36m(TaskRunner pid=2949575)[0m wandb:            train-acc/group_any_correct/ratio 0
[36m(TaskRunner pid=2949575)[0m wandb:                        train-acc/score/ratio 0
[36m(TaskRunner pid=2949575)[0m wandb:                      train-reward/score/mean 0.53594
[36m(TaskRunner pid=2949575)[0m wandb:                               training/epoch 14
[36m(TaskRunner pid=2949575)[0m wandb:                         training/global_step 525
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/best@16/mean 0.5
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@2/mean 0.393
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/acc/best@2/std 0.20506
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/best@32/mean 0.5
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@4/mean 0.477
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/acc/best@4/std 0.10474
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/best@8/mean 0.499
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/acc/best@8/std 0.02234
[36m(TaskRunner pid=2949575)[0m wandb:              val-aux/grpo_convert/acc/std@50 0.2492
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/acc/worst@16/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@2/mean 0.1535
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/worst@2/std 0.23062
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/acc/worst@32/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@4/mean 0.0435
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/worst@4/std 0.14092
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/acc/worst@50/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/acc/worst@8/mean 0.004
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/acc/worst@8/std 0.04454
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/best@16/mean 0.25
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@2/mean 0.24825
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/boxed/best@2/std 0.02084
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/best@32/mean 0.25
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@4/mean 0.25
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/boxed/best@4/std 0
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/best@50/mean 0.25
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/best@8/mean 0.25
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/boxed/best@8/std 0
[36m(TaskRunner pid=2949575)[0m wandb:           val-aux/grpo_convert/boxed/mean@50 0.23
[36m(TaskRunner pid=2949575)[0m wandb:            val-aux/grpo_convert/boxed/std@50 0.06782
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/boxed/worst@16/mean 0.064
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@16/std 0.10911
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@2/mean 0.20825
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/worst@2/std 0.09324
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/boxed/worst@32/mean 0.0185
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@32/std 0.06544
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@4/mean 0.17775
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/worst@4/std 0.11332
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/boxed/worst@50/mean 0.00225
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@50/std 0.02361
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/boxed/worst@8/mean 0.12775
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/boxed/worst@8/std 0.12497
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/best@16/mean 0.5
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@2/mean 0.393
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/correct/best@2/std 0.20506
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/best@32/mean 0.5
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@4/mean 0.477
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/correct/best@4/std 0.10474
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/best@50/mean 0.5
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/best@8/mean 0.499
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/correct/best@8/std 0.02234
[36m(TaskRunner pid=2949575)[0m wandb:         val-aux/grpo_convert/correct/mean@50 0.27
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/correct/std@50 0.2492
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/correct/worst@16/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@2/mean 0.1535
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/worst@2/std 0.23062
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/correct/worst@32/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@4/mean 0.0435
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/worst@4/std 0.14092
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/correct/worst@50/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/correct/worst@8/mean 0.004
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/correct/worst@8/std 0.04454
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/best@16/mean 0.75
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@2/mean 0.63775
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/reward/best@2/std 0.2238
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/best@32/mean 0.75
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@4/mean 0.727
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/reward/best@4/std 0.10474
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/best@50/mean 0.75
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/best@8/mean 0.749
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/reward/best@8/std 0.02234
[36m(TaskRunner pid=2949575)[0m wandb:          val-aux/grpo_convert/reward/mean@50 0.46
[36m(TaskRunner pid=2949575)[0m wandb:           val-aux/grpo_convert/reward/std@50 0.36865
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/reward/worst@16/mean -0.308
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@16/std 0.32732
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@2/mean 0.27825
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/worst@2/std 0.41218
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/reward/worst@32/mean -0.4445
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@32/std 0.19633
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@4/mean 0.07675
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/worst@4/std 0.39281
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/reward/worst@50/mean -0.49325
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@50/std 0.07083
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/reward/worst@8/mean -0.11275
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/reward/worst@8/std 0.38141
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/best@16/mean 0.75
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@2/mean 0.63775
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/score/best@2/std 0.2238
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/best@32/mean 0.75
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@4/mean 0.727
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/score/best@4/std 0.10474
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/best@50/mean 0.75
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/best@8/mean 0.749
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/score/best@8/std 0.02234
[36m(TaskRunner pid=2949575)[0m wandb:           val-aux/grpo_convert/score/mean@50 0.46
[36m(TaskRunner pid=2949575)[0m wandb:            val-aux/grpo_convert/score/std@50 0.36865
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/score/worst@16/mean -0.308
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@16/std 0.32732
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@2/mean 0.27825
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/worst@2/std 0.41218
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/score/worst@32/mean -0.4445
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@32/std 0.19633
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@4/mean 0.07675
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/worst@4/std 0.39281
[36m(TaskRunner pid=2949575)[0m wandb:     val-aux/grpo_convert/score/worst@50/mean -0.49325
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@50/std 0.07083
[36m(TaskRunner pid=2949575)[0m wandb:      val-aux/grpo_convert/score/worst@8/mean -0.11275
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/score/worst@8/std 0.38141
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/best@16/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@16/std 0
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@2/mean -0.0035
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/structure/best@2/std 0.04169
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/best@32/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@32/std 0
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@4/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/structure/best@4/std 0
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/best@50/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/best@8/mean 0
[36m(TaskRunner pid=2949575)[0m wandb:    val-aux/grpo_convert/structure/best@8/std 0
[36m(TaskRunner pid=2949575)[0m wandb:       val-aux/grpo_convert/structure/mean@50 -0.04
[36m(TaskRunner pid=2949575)[0m wandb:        val-aux/grpo_convert/structure/std@50 0.13565
[36m(TaskRunner pid=2949575)[0m wandb: val-aux/grpo_convert/structure/worst@16/mean -0.372
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@16/std 0.21821
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@2/mean -0.0835
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/worst@2/std 0.18649
[36m(TaskRunner pid=2949575)[0m wandb: val-aux/grpo_convert/structure/worst@32/mean -0.463
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@32/std 0.13089
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@4/mean -0.1445
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/worst@4/std 0.22665
[36m(TaskRunner pid=2949575)[0m wandb: val-aux/grpo_convert/structure/worst@50/mean -0.4955
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@50/std 0.04722
[36m(TaskRunner pid=2949575)[0m wandb:  val-aux/grpo_convert/structure/worst@8/mean -0.2445
[36m(TaskRunner pid=2949575)[0m wandb:   val-aux/grpo_convert/structure/worst@8/std 0.24994
[36m(TaskRunner pid=2949575)[0m wandb:       val-core/grpo_convert/acc/best@50/mean 0.5
[36m(TaskRunner pid=2949575)[0m wandb:        val-core/grpo_convert/acc/best@50/std 0
[36m(TaskRunner pid=2949575)[0m wandb:            val-core/grpo_convert/acc/mean@50 0.27
[36m(TaskRunner pid=2949575)[0m wandb: 
[36m(TaskRunner pid=2949575)[0m wandb: You can sync this run to the cloud by running:
[36m(TaskRunner pid=2949575)[0m wandb: wandb sync /gemini/user/private/table_reasoning/zhaiyanbo/verl/wandb/offline-run-20250805_233839-g3y04tqq
[36m(TaskRunner pid=2949575)[0m wandb: Find logs at: ./wandb/offline-run-20250805_233839-g3y04tqq/logs
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@4/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@4/mean': 0.17775, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@4/std': 0.11332447882077377, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@8/mean': 0.25, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@8/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@8/mean': 0.12775, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@8/std': 0.12496974633886394, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@16/mean': 0.25, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@16/mean': 0.064, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@16/std': 0.10910545357588684, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@32/mean': 0.25, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@32/mean': 0.0185, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@32/std': 0.06544272304847959, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@50/mean': 0.25, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@50/mean': 0.00225, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/boxed/worst@50/std': 0.02361011435804579, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/mean@50': 0.27, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/std@50': 0.24919871588754228, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@2/mean': 0.393, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@2/std': 0.20506340482884802, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@2/mean': 0.1535, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@2/std': 0.2306246951217497, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@4/mean': 0.477, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@4/std': 0.10474254150057655, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@4/mean': 0.0435, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@4/std': 0.1409175290728588, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@8/mean': 0.499, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@8/std': 0.022338307903688678, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@8/mean': 0.004, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@8/std': 0.044542114902640165, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@16/mean': 0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@32/mean': 0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@50/mean': 0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/correct/worst@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-core/grpo_convert/acc/mean@50': 0.27, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/std@50': 0.24919871588754228, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@2/mean': 0.393, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@2/std': 0.20506340482884802, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@2/mean': 0.1535, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@2/std': 0.2306246951217497, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@4/mean': 0.477, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@4/std': 0.10474254150057655, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@4/mean': 0.0435, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@4/std': 0.1409175290728588, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@8/mean': 0.499, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@8/std': 0.022338307903688678, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@8/mean': 0.004, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@8/std': 0.044542114902640165, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@16/mean': 0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@16/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@16/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@32/mean': 0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/best@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@32/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@32/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-core/grpo_convert/acc/best@50/mean': 0.5, "
[36m(TaskRunner pid=2949575)[0m  "'val-core/grpo_convert/acc/best@50/std': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@50/mean': 0.0, "
[36m(TaskRunner pid=2949575)[0m  "'val-aux/grpo_convert/acc/worst@50/std': 0.0}")
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:43:25,847:[Rank 1] Saved optim to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/optim_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2951181)[0m INFO:2025-08-06 09:43:25,849:[Rank 1] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/grpo_0805/global_step_525/actor/extra_state_world_size_8_rank_1.pt[32m [repeated 7x across cluster][0m
