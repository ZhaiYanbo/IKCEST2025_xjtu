2025-08-05 00:16:10,279	INFO worker.py:1879 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=2922365)[0m TaskRunner hostname: c9b4e48bcef9567f98037c541e0f5862-taskrole1-0, PID: 2922365
[36m(TaskRunner pid=2922365)[0m {'actor_rollout_ref': {'actor': {'_target_': 'verl.workers.config.FSDPActorConfig',
[36m(TaskRunner pid=2922365)[0m                                  'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2922365)[0m                                                 'async_save': False,
[36m(TaskRunner pid=2922365)[0m                                                 'load_contents': ['model',
[36m(TaskRunner pid=2922365)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2922365)[0m                                                                   'extra'],
[36m(TaskRunner pid=2922365)[0m                                                 'save_contents': ['model',
[36m(TaskRunner pid=2922365)[0m                                                                   'optimizer',
[36m(TaskRunner pid=2922365)[0m                                                                   'extra']},
[36m(TaskRunner pid=2922365)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2922365)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2922365)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2922365)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2922365)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=2922365)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2922365)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2922365)[0m                                  'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2922365)[0m                                                  'forward_prefetch': False,
[36m(TaskRunner pid=2922365)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=2922365)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=2922365)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2922365)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2922365)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=2922365)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2922365)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2922365)[0m                                  'kl_loss_coef': 0.01,
[36m(TaskRunner pid=2922365)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2922365)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2922365)[0m                                  'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2922365)[0m                                            'lr': 1e-06,
[36m(TaskRunner pid=2922365)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2922365)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2922365)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=2922365)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=2922365)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2922365)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2922365)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2922365)[0m                                  'policy_loss': {'_target_': 'verl.workers.config.PolicyLossConfig',
[36m(TaskRunner pid=2922365)[0m                                                  'clip_cov_lb': 1.0,
[36m(TaskRunner pid=2922365)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=2922365)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=2922365)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=2922365)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=2922365)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=2922365)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2922365)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2922365)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2922365)[0m                                  'ppo_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=2922365)[0m                                  'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=2922365)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2922365)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2922365)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2922365)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2922365)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2922365)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=2922365)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2922365)[0m                                  'use_torch_compile': False},
[36m(TaskRunner pid=2922365)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2922365)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=2922365)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=2922365)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2922365)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=2922365)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2922365)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=2922365)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=2922365)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=2922365)[0m                                  'override_config': {},
[36m(TaskRunner pid=2922365)[0m                                  'path': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2922365)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=2922365)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=2922365)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=2922365)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2922365)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=2922365)[0m                                  'use_shm': False},
[36m(TaskRunner pid=2922365)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2922365)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=2922365)[0m                                     'discrete': False,
[36m(TaskRunner pid=2922365)[0m                                     'ranks': []},
[36m(TaskRunner pid=2922365)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=2922365)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=2922365)[0m                                'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2922365)[0m                                                'forward_prefetch': False,
[36m(TaskRunner pid=2922365)[0m                                                'param_offload': False,
[36m(TaskRunner pid=2922365)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=2922365)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2922365)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2922365)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2922365)[0m                                'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2922365)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2922365)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2922365)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2922365)[0m                                'use_torch_compile': False},
[36m(TaskRunner pid=2922365)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=2922365)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=2922365)[0m                                                                      'path': None},
[36m(TaskRunner pid=2922365)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=2922365)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=2922365)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=2922365)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2922365)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2922365)[0m                                    'enable_chunked_prefill': False,
[36m(TaskRunner pid=2922365)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2922365)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=2922365)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': True,
[36m(TaskRunner pid=2922365)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=2922365)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2922365)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=2922365)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2922365)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=2922365)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2922365)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2922365)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2922365)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=2922365)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2922365)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2922365)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2922365)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2922365)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=2922365)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=2922365)[0m                                    'multi_turn': {'enable': False,
[36m(TaskRunner pid=2922365)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=2922365)[0m                                                   'interaction_config_path': None,
[36m(TaskRunner pid=2922365)[0m                                                   'max_assistant_turns': None,
[36m(TaskRunner pid=2922365)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=2922365)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=2922365)[0m                                                   'max_user_turns': None,
[36m(TaskRunner pid=2922365)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=2922365)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=2922365)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=2922365)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=2922365)[0m                                    'n': 5,
[36m(TaskRunner pid=2922365)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2922365)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2922365)[0m                                    'response_length': 2048,
[36m(TaskRunner pid=2922365)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2922365)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=2922365)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2922365)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2922365)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=2922365)[0m                                              'token2text': False},
[36m(TaskRunner pid=2922365)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=2922365)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2922365)[0m                                                   'n': 1,
[36m(TaskRunner pid=2922365)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2922365)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2922365)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2922365)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=2922365)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=2922365)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2922365)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=2922365)[0m                            'horizon': 10000,
[36m(TaskRunner pid=2922365)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2922365)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2922365)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2922365)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2922365)[0m                'lam': 1.0,
[36m(TaskRunner pid=2922365)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2922365)[0m                'pf_ppo': {'reweight_method': 'pow', 'weight_pow': 2.0},
[36m(TaskRunner pid=2922365)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=2922365)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=2922365)[0m  'critic': {'_target_': 'verl.workers.config.FSDPCriticConfig',
[36m(TaskRunner pid=2922365)[0m             'checkpoint': {'_target_': 'verl.trainer.config.CheckpointConfig',
[36m(TaskRunner pid=2922365)[0m                            'async_save': False,
[36m(TaskRunner pid=2922365)[0m                            'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=2922365)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2922365)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2922365)[0m             'enable': None,
[36m(TaskRunner pid=2922365)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2922365)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2922365)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2922365)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2922365)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2922365)[0m             'model': {'_target_': 'verl.workers.config.FSDPCriticModelCfg',
[36m(TaskRunner pid=2922365)[0m                       'enable_activation_offload': False,
[36m(TaskRunner pid=2922365)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2922365)[0m                       'external_lib': None,
[36m(TaskRunner pid=2922365)[0m                       'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2922365)[0m                                       'forward_prefetch': False,
[36m(TaskRunner pid=2922365)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=2922365)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=2922365)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2922365)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2922365)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=2922365)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2922365)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=2922365)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=2922365)[0m                       'override_config': {},
[36m(TaskRunner pid=2922365)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2922365)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=2922365)[0m                       'tokenizer_path': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2922365)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=2922365)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=2922365)[0m                       'use_shm': False},
[36m(TaskRunner pid=2922365)[0m             'optim': {'_target_': 'verl.workers.config.FSDPOptimizerConfig',
[36m(TaskRunner pid=2922365)[0m                       'lr': 1e-05,
[36m(TaskRunner pid=2922365)[0m                       'lr_warmup_steps': -1,
[36m(TaskRunner pid=2922365)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2922365)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2922365)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2922365)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2922365)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2922365)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2922365)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2922365)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2922365)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2922365)[0m             'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=2922365)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2922365)[0m                          'all_ranks': False,
[36m(TaskRunner pid=2922365)[0m                          'discrete': False,
[36m(TaskRunner pid=2922365)[0m                          'ranks': []},
[36m(TaskRunner pid=2922365)[0m             'rollout_n': 5,
[36m(TaskRunner pid=2922365)[0m             'shuffle': False,
[36m(TaskRunner pid=2922365)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2922365)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2922365)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2922365)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2922365)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2922365)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=2922365)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=2922365)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=2922365)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2922365)[0m           'image_key': 'images',
[36m(TaskRunner pid=2922365)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2922365)[0m           'max_response_length': 2048,
[36m(TaskRunner pid=2922365)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2922365)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=2922365)[0m           'return_multi_modal_inputs': False,
[36m(TaskRunner pid=2922365)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2922365)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2922365)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2922365)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=2922365)[0m           'shuffle': True,
[36m(TaskRunner pid=2922365)[0m           'tokenizer': None,
[36m(TaskRunner pid=2922365)[0m           'train_batch_size': 64,
[36m(TaskRunner pid=2922365)[0m           'train_files': '/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/train.parquet',
[36m(TaskRunner pid=2922365)[0m           'truncation': 'error',
[36m(TaskRunner pid=2922365)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=2922365)[0m           'use_shm': False,
[36m(TaskRunner pid=2922365)[0m           'val_batch_size': None,
[36m(TaskRunner pid=2922365)[0m           'val_files': '/gemini/user/private/table_reasoning/zhaiyanbo/verl/data/rl_data/test.parquet',
[36m(TaskRunner pid=2922365)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=2922365)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2922365)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=2922365)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2922365)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2922365)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=2922365)[0m                   'max_length': None,
[36m(TaskRunner pid=2922365)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2922365)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2922365)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2922365)[0m                             'fsdp_config': {'_target_': 'verl.workers.config.FSDPEngineConfig',
[36m(TaskRunner pid=2922365)[0m                                             'forward_prefetch': False,
[36m(TaskRunner pid=2922365)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=2922365)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2922365)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=2922365)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens:   0%|          | 0/2255 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens:  44%|████▍     | 1000/2255 [00:15<00:19, 63.15 examples/s]
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens:  44%|████▍     | 1000/2255 [00:29<00:19, 63.15 examples/s]
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens:  89%|████████▊ | 2000/2255 [00:31<00:03, 64.73 examples/s]
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens: 100%|██████████| 2255/2255 [00:34<00:00, 64.62 examples/s]
Filtering prompts longer than 1024 tokens: 100%|██████████| 2255/2255 [00:34<00:00, 64.45 examples/s]
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens:   0%|          | 0/100 [00:00<?, ? examples/s]
[36m(TaskRunner pid=2922365)[0m 
Filtering prompts longer than 1024 tokens: 100%|██████████| 100/100 [00:01<00:00, 66.29 examples/s]
Filtering prompts longer than 1024 tokens: 100%|██████████| 100/100 [00:01<00:00, 66.24 examples/s]
[36m(TaskRunner pid=2922365)[0m /gemini/user/private/table_reasoning/zhaiyanbo/verl/verl/trainer/main_ppo.py:227: UserWarning: Disabled critic as algorithm.adv_estimator != gae. If it is not intended, please set critic.enable=True
[36m(TaskRunner pid=2922365)[0m   trainer = RayPPOTrainer(
[36m(TaskRunner pid=2922365)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2922365)[0m WARNING:2025-08-05 00:17:04,746:Waiting for register center actor MHJzwt_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2923972)[0m Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
[36m(WorkerDict pid=2923974)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VLForConditionalGeneration is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2923974)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2923974)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VisionTransformerPretrainedModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2923974)[0m 
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(TaskRunner pid=2922365)[0m                             'input_tokenizer': '/gemini/platform/public/NLP/private/zhaiyanbo/model/Qwen2.5-VL-3B-Instruct',
[36m(TaskRunner pid=2922365)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2922365)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=2922365)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=2922365)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=2922365)[0m                             'use_shm': False},
[36m(TaskRunner pid=2922365)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=2922365)[0m                                'all_ranks': False,
[36m(TaskRunner pid=2922365)[0m                                'discrete': False,
[36m(TaskRunner pid=2922365)[0m                                'ranks': []},
[36m(TaskRunner pid=2922365)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2922365)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=2922365)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=2922365)[0m                                      'url': None},
[36m(TaskRunner pid=2922365)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2922365)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2922365)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2922365)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2922365)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2922365)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2922365)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=2922365)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2922365)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2922365)[0m              'default_local_dir': '/gemini/platform/public/NLP/model/project_model/math/ckpts',
[36m(TaskRunner pid=2922365)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2922365)[0m              'device': 'cuda',
[36m(TaskRunner pid=2922365)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=2922365)[0m              'experiment_name': 'qwen2_5_vl_3b_function_rm',
[36m(TaskRunner pid=2922365)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2922365)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=2922365)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2922365)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2922365)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=2922365)[0m              'nnodes': 1,
[36m(TaskRunner pid=2922365)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=2922365)[0m                                          'level': 'level1',
[36m(TaskRunner pid=2922365)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=2922365)[0m                                          'roles': ['all'],
[36m(TaskRunner pid=2922365)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=2922365)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=2922365)[0m                                          'with_memory': False,
[36m(TaskRunner pid=2922365)[0m                                          'with_module': False,
[36m(TaskRunner pid=2922365)[0m                                          'with_npu': True,
[36m(TaskRunner pid=2922365)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=2922365)[0m              'profile_continuous_steps': False,
[36m(TaskRunner pid=2922365)[0m              'profile_steps': None,
[36m(TaskRunner pid=2922365)[0m              'project_name': 'grpo_math_0803',
[36m(TaskRunner pid=2922365)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2922365)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2922365)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2922365)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=2922365)[0m              'save_freq': 10,
[36m(TaskRunner pid=2922365)[0m              'test_freq': 50,
[36m(TaskRunner pid=2922365)[0m              'total_epochs': 15,
[36m(TaskRunner pid=2922365)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2922365)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=2922365)[0m              'val_before_train': True,
[36m(TaskRunner pid=2922365)[0m              'val_only': False,
[36m(TaskRunner pid=2922365)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=2922365)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=2922365)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=2922365)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=2922365)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=2922365)[0m                                        'kill': 'none',
[36m(TaskRunner pid=2922365)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=2922365)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2922365)[0m dataset len: 2255
[36m(TaskRunner pid=2922365)[0m filter dataset len: 2255
[36m(TaskRunner pid=2922365)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=2922365)[0m dataset len: 100
[36m(TaskRunner pid=2922365)[0m filter dataset len: 100
[36m(TaskRunner pid=2922365)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2922365)[0m Size of train dataloader: 35, Size of val dataloader: 1
[36m(TaskRunner pid=2922365)[0m Total training steps: 525
[36m(TaskRunner pid=2922365)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(WorkerDict pid=2923707)[0m Model config after override: Qwen2_5_VLConfig {
[36m(WorkerDict pid=2923707)[0m   "architectures": [
[36m(WorkerDict pid=2923707)[0m     "Qwen2_5_VLForConditionalGeneration"
[36m(WorkerDict pid=2923707)[0m   ],
[36m(WorkerDict pid=2923707)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2923707)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2923707)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2923707)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=2923707)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2923707)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2923707)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=2923707)[0m   "max_position_embeddings": 128000,
[36m(WorkerDict pid=2923707)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=2923707)[0m   "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2923707)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=2923707)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=2923707)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2923707)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2923707)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2923707)[0m   "rope_scaling": {
[36m(WorkerDict pid=2923707)[0m     "mrope_section": [
[36m(WorkerDict pid=2923707)[0m       16,
[36m(WorkerDict pid=2923707)[0m       24,
[36m(WorkerDict pid=2923707)[0m       24
[36m(WorkerDict pid=2923707)[0m     ],
[36m(WorkerDict pid=2923707)[0m     "rope_type": "default",
[36m(WorkerDict pid=2923707)[0m     "type": "default"
[36m(WorkerDict pid=2923707)[0m   },
[36m(WorkerDict pid=2923707)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2923707)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=2923707)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2923974)[0m 
Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.30s/it]
[36m(WorkerDict pid=2923707)[0m Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2923975)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2_5_VisionTransformerPretrainedModel is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=2923975)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m 
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923971)[0m 
Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.05s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.15s/it]
[36m(WorkerDict pid=2923975)[0m 
Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.66s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923707)[0m 
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=2923975)[0m 
Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.19s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.26s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923707)[0m 
Loading checkpoint shards:  50%|█████     | 1/2 [00:06<00:06,  6.30s/it]
[36m(WorkerDict pid=2923974)[0m 
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923977)[0m 
Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.16s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:12<00:00,  6.29s/it]
[36m(WorkerDict pid=2923975)[0m 
Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.08s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923707)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2923707)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=2923707)[0m   "use_cache": true,
[36m(WorkerDict pid=2923707)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2923707)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2923707)[0m   "vision_config": {
[36m(WorkerDict pid=2923707)[0m     "depth": 32,
[36m(WorkerDict pid=2923707)[0m     "fullatt_block_indexes": [
[36m(WorkerDict pid=2923707)[0m       7,
[36m(WorkerDict pid=2923707)[0m       15,
[36m(WorkerDict pid=2923707)[0m       23,
[36m(WorkerDict pid=2923707)[0m       31
[36m(WorkerDict pid=2923707)[0m     ],
[36m(WorkerDict pid=2923707)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2923707)[0m     "hidden_size": 1280,
[36m(WorkerDict pid=2923707)[0m     "in_channels": 3,
[36m(WorkerDict pid=2923707)[0m     "in_chans": 3,
[36m(WorkerDict pid=2923707)[0m     "intermediate_size": 3420,
[36m(WorkerDict pid=2923707)[0m     "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2923707)[0m     "num_heads": 16,
[36m(WorkerDict pid=2923707)[0m     "out_hidden_size": 2048,
[36m(WorkerDict pid=2923707)[0m     "patch_size": 14,
[36m(WorkerDict pid=2923707)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2923707)[0m     "spatial_patch_size": 14,
[36m(WorkerDict pid=2923707)[0m     "temporal_patch_size": 2,
[36m(WorkerDict pid=2923707)[0m     "tokens_per_second": 2,
[36m(WorkerDict pid=2923707)[0m     "window_size": 112
[36m(WorkerDict pid=2923707)[0m   },
[36m(WorkerDict pid=2923707)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2923707)[0m   "vision_start_token_id": 151652,
[36m(WorkerDict pid=2923707)[0m   "vision_token_id": 151654,
[36m(WorkerDict pid=2923707)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2923707)[0m }
[36m(WorkerDict pid=2923707)[0m 
[36m(WorkerDict pid=2923971)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2923971)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2923971)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2923971)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2923707)[0m Qwen2_5_VLForConditionalGeneration contains 3.75B parameters
[36m(WorkerDict pid=2923707)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f03b5891360>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f03b5891240>, transformer_layer_cls={<class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLDecoderLayer'>, <class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLVisionBlock'>})])
[36m(WorkerDict pid=2923707)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2923707)[0m Ref use_remove_padding=True
[36m(WorkerDict pid=2923707)[0m Ref use_fused_kernels=False
[36m(WorkerDict pid=2923975)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923707)[0m Model config after override: Qwen2_5_VLConfig {
[36m(WorkerDict pid=2923707)[0m   "architectures": [
[36m(WorkerDict pid=2923707)[0m     "Qwen2_5_VLForConditionalGeneration"
[36m(WorkerDict pid=2923707)[0m   ],
[36m(WorkerDict pid=2923707)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2923707)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2923707)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2923707)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=2923707)[0m   "image_token_id": 151655,
[36m(WorkerDict pid=2923707)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2923707)[0m   "intermediate_size": 11008,
[36m(WorkerDict pid=2923707)[0m   "max_position_embeddings": 128000,
[36m(WorkerDict pid=2923707)[0m   "max_window_layers": 70,
[36m(WorkerDict pid=2923707)[0m   "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2923707)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=2923707)[0m   "num_hidden_layers": 36,
[36m(WorkerDict pid=2923707)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=2923707)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2923707)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2923707)[0m   "rope_scaling": {
[36m(WorkerDict pid=2923707)[0m     "mrope_section": [
[36m(WorkerDict pid=2923707)[0m       16,
[36m(WorkerDict pid=2923707)[0m       24,
[36m(WorkerDict pid=2923707)[0m       24
[36m(WorkerDict pid=2923707)[0m     ],
[36m(WorkerDict pid=2923707)[0m     "rope_type": "default",
[36m(WorkerDict pid=2923707)[0m     "type": "default"
[36m(WorkerDict pid=2923707)[0m   },
[36m(WorkerDict pid=2923707)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2923707)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=2923707)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=2923707)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2923707)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=2923707)[0m   "use_cache": true,
[36m(WorkerDict pid=2923707)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2923707)[0m   "video_token_id": 151656,
[36m(WorkerDict pid=2923707)[0m   "vision_config": {
[36m(WorkerDict pid=2923707)[0m     "depth": 32,
[36m(WorkerDict pid=2923707)[0m     "fullatt_block_indexes": [
[36m(WorkerDict pid=2923707)[0m       7,
[36m(WorkerDict pid=2923707)[0m       15,
[36m(WorkerDict pid=2923707)[0m       23,
[36m(WorkerDict pid=2923707)[0m       31
[36m(WorkerDict pid=2923707)[0m     ],
[36m(WorkerDict pid=2923707)[0m     "hidden_act": "silu",
[36m(WorkerDict pid=2923707)[0m     "hidden_size": 1280,
[36m(WorkerDict pid=2923707)[0m     "in_channels": 3,
[36m(WorkerDict pid=2923707)[0m     "in_chans": 3,
[36m(WorkerDict pid=2923707)[0m     "intermediate_size": 3420,
[36m(WorkerDict pid=2923707)[0m     "model_type": "qwen2_5_vl",
[36m(WorkerDict pid=2923707)[0m     "num_heads": 16,
[36m(WorkerDict pid=2923707)[0m     "out_hidden_size": 2048,
[36m(WorkerDict pid=2923707)[0m     "patch_size": 14,
[36m(WorkerDict pid=2923707)[0m     "spatial_merge_size": 2,
[36m(WorkerDict pid=2923707)[0m     "spatial_patch_size": 14,
[36m(WorkerDict pid=2923707)[0m     "temporal_patch_size": 2,
[36m(WorkerDict pid=2923707)[0m     "tokens_per_second": 2,
[36m(WorkerDict pid=2923707)[0m     "window_size": 112
[36m(WorkerDict pid=2923707)[0m   },
[36m(WorkerDict pid=2923707)[0m   "vision_end_token_id": 151653,
[36m(WorkerDict pid=2923707)[0m   "vision_start_token_id": 151652,
[36m(WorkerDict pid=2923707)[0m   "vision_token_id": 151654,
[36m(WorkerDict pid=2923707)[0m   "vocab_size": 151936
[36m(WorkerDict pid=2923707)[0m }
[36m(WorkerDict pid=2923707)[0m 
[36m(WorkerDict pid=2923977)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2923977)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2923977)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2923977)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2923707)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. 
[36m(WorkerDict pid=2923707)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL
[36m(WorkerDict pid=2923707)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl
[36m(WorkerDict pid=2923973)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2923973)[0m   warnings.warn(
[36m(WorkerDict pid=2923975)[0m 
Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.50s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.59s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m wandb: Tracking run with wandb version 0.20.1
[36m(TaskRunner pid=2922365)[0m wandb: W&B syncing is set to `offline` in this directory. Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 00:18:55,870:[Rank 0] Loaded model from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923974)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923974)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923973)[0m INFO:2025-08-05 00:18:58,729:[Rank 3] Loaded optimizer from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2923973)[0m INFO:2025-08-05 00:18:58,736:[Rank 3] Loaded rng from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2923973)[0m INFO:2025-08-05 00:18:58,736:[Rank 3] Loaded lr_scheduler from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2923707)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=2923707)[0m Qwen2_5_VLForConditionalGeneration contains 3.75B parameters
[36m(WorkerDict pid=2923707)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f03b5891360>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f03b5891240>, transformer_layer_cls={<class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLDecoderLayer'>, <class 'transformers.models.qwen2_5_vl.modeling_qwen2_5_vl.Qwen2_5_VLVisionBlock'>})])
[36m(WorkerDict pid=2923707)[0m Total steps: 525, num_warmup_steps: 0
[36m(WorkerDict pid=2923707)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2923707)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=2923973)[0m WARNING 08-05 00:18:21 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2923975)[0m Monkey patch state_dict in AutoModelForCausalLMWithValueHead. [32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2923975)[0m Monkey patch FlashAttention2.forward in Qwen2.5VL[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2923975)[0m Monkey patch _flash_attention_forward in transformers.models.qwen2_5_vl.modeling_qwen2_5_vl[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2923975)[0m Skipping monkey patch for Qwen2_5_VLForConditionalGeneration as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2923973)[0m WARNING 08-05 00:18:22 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fa8bb302cb0>
[36m(WorkerDict pid=2923972)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2923973)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2923975)[0m WARNING 08-05 00:18:23 [cuda.py:93] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m WARNING 08-05 00:18:23 [utils.py:2522] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f5bf99ded70>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923974)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=2922365)[0m Found checkpoint: %s /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340
[36m(TaskRunner pid=2922365)[0m Load from checkpoint folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340
[36m(TaskRunner pid=2922365)[0m Setting global step to 340
[36m(TaskRunner pid=2922365)[0m Resuming from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340
[36m(TaskRunner pid=2922365)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 340}
[36m(WorkerDict pid=2923974)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 2048, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m validation generation end
[36m(TaskRunner pid=2922365)[0m [prompt] system
[36m(TaskRunner pid=2922365)[0m You are a helpful assistant.
[36m(TaskRunner pid=2922365)[0m user
[36m(TaskRunner pid=2922365)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m Solve the problem in the image.
[36m(TaskRunner pid=2922365)[0m assistant
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m [response] <think>
[36m(TaskRunner pid=2922365)[0m The problem states that the hyperbola is equal-axis (isoaxial) with its center at the origin and foci on the x-axis. The hyperbola intersects the parabola y^2=16x at points A and B, and |AB|=4√3. We need to find the real axis of the hyperbola.
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m Since the hyperbola is equal-axis, it has the standard form x^2/a^2-y^2/a^2=1. The准线（directrix）of the parabola y^2=16x is x=-4. The hyperbola and the parabola intersect at points where x=-4. Substituting x=-4 into the hyperbola's equation, we get (-4)^2/a^2-y^2/a^2=1, so y^2=a^2(4-a^2). The distance between the intersection points is 4√3, so √(y^2+4^2)=4√3. Substituting y^2=a^2(4-a^2), we get √(a^2(4-a^2)+16)=4√3. Solving this equation for a, we get a=2. </think>
[36m(TaskRunner pid=2922365)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2922365)[0m [ground_truth] C
[36m(TaskRunner pid=2922365)[0m [score] 0.6
[36m(TaskRunner pid=2922365)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2922365)[0m ("Initial validation metrics: {'val-core/grpo_convert/reward/mean@50': "
[36m(TaskRunner pid=2922365)[0m  "0.697000020518899, 'val-aux/grpo_convert/reward/std@50': 0.439886077710098, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@2/mean': 0.8964000233933329, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@2/std': 0.42589998656386896, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@2/mean': 0.48860001747310167, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@2/std': 0.3487697639097461, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@4/mean': 1.078000023841858, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@4/std': 0.42383040416832796, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@4/mean': 0.3403000133335591, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@4/std': 0.30217724767922716, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@8/mean': 1.2680000238418578, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@8/std': 0.36327562733815716, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@8/mean': 0.18860000740736724, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@8/std': 0.2736521943674469, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@16/mean': 1.412000023841858, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@16/std': 0.2578649397672427, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@16/mean': 0.06195000239089131, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@16/std': 0.17667625671314194, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@32/mean': 1.5320000238418578, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/best@32/std': 0.1713942822850284, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@32/mean': 0.00675000024959445, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@32/std': 0.0580374366879313, "
[36m(TaskRunner pid=2922365)[0m  "'val-core/grpo_convert/reward/best@50/mean': 1.5770000238418578, "
[36m(TaskRunner pid=2922365)[0m  "'val-core/grpo_convert/reward/best@50/std': 0.10474254150057655, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@50/mean': 0.001400000050663948, "
[36m(TaskRunner pid=2922365)[0m  "'val-aux/grpo_convert/reward/worst@50/std': 0.026179095122873718}")
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  65%|██████▍   | 340/525 [00:00<?, ?it/s]
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 00:18:55,870:[Rank 5] Loaded model from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 00:18:59,049:[Rank 4] Loaded optimizer from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 00:18:59,056:[Rank 4] Loaded rng from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 00:18:59,056:[Rank 4] Loaded lr_scheduler from /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_340/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
                                                                                                                        [36m(TaskRunner pid=2922365)[0m 
Training Progress:  65%|██████▌   | 342/525 [02:39<4:01:20, 79.13s/it]
[36m(TaskRunner pid=2922365)[0m step:340 - val-core/grpo_convert/reward/mean@50:0.697000020518899 - val-aux/grpo_convert/reward/std@50:0.439886077710098 - val-aux/grpo_convert/reward/best@2/mean:0.8964000233933329 - val-aux/grpo_convert/reward/best@2/std:0.42589998656386896 - val-aux/grpo_convert/reward/worst@2/mean:0.48860001747310167 - val-aux/grpo_convert/reward/worst@2/std:0.3487697639097461 - val-aux/grpo_convert/reward/best@4/mean:1.078000023841858 - val-aux/grpo_convert/reward/best@4/std:0.42383040416832796 - val-aux/grpo_convert/reward/worst@4/mean:0.3403000133335591 - val-aux/grpo_convert/reward/worst@4/std:0.30217724767922716 - val-aux/grpo_convert/reward/best@8/mean:1.2680000238418578 - val-aux/grpo_convert/reward/best@8/std:0.36327562733815716 - val-aux/grpo_convert/reward/worst@8/mean:0.18860000740736724 - val-aux/grpo_convert/reward/worst@8/std:0.2736521943674469 - val-aux/grpo_convert/reward/best@16/mean:1.412000023841858 - val-aux/grpo_convert/reward/best@16/std:0.2578649397672427 - val-aux/grpo_convert/reward/worst@16/mean:0.06195000239089131 - val-aux/grpo_convert/reward/worst@16/std:0.17667625671314194 - val-aux/grpo_convert/reward/best@32/mean:1.5320000238418578 - val-aux/grpo_convert/reward/best@32/std:0.1713942822850284 - val-aux/grpo_convert/reward/worst@32/mean:0.00675000024959445 - val-aux/grpo_convert/reward/worst@32/std:0.0580374366879313 - val-core/grpo_convert/reward/best@50/mean:1.5770000238418578 - val-core/grpo_convert/reward/best@50/std:0.10474254150057655 - val-aux/grpo_convert/reward/worst@50/mean:0.001400000050663948 - val-aux/grpo_convert/reward/worst@50/std:0.026179095122873718
[36m(TaskRunner pid=2922365)[0m step:341 - global_seqlen/min:21144 - global_seqlen/max:36557 - global_seqlen/minmax_diff:15413 - global_seqlen/balanced_min:27028 - global_seqlen/balanced_max:28369 - global_seqlen/mean:27195.75 - actor/entropy:0.056773681193590164 - actor/kl_loss:2.1005922690033914 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1285962663590908 - actor/pg_clipfrac:0.03607777168508619 - actor/ppo_kl:-0.16338271051645278 - actor/pg_clipfrac_lower:0.006049510068260133 - actor/grad_norm:16.812159538269043 - perf/mfu/actor:0.07571078066184392 - perf/max_memory_allocated_gb:66.50260019302368 - perf/max_memory_reserved_gb:73.5625 - perf/cpu_memory_used_gb:92.53807830810547 - actor/lr:1e-06 - training/global_step:341 - training/epoch:0 - critic/score/mean:0.9184374809265137 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9184374809265137 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3829468786716461 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3829468786716461 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:270.04998779296875 - response_length/max:2048.0 - response_length/min:59.0 - response_length/clip_ratio:0.05312500149011612 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003513600677251816 - timing_s/generate_sequences:61.47468185424805 - timing_s/reshard:0.6571608781814575 - timing_s/gen:65.36200718022883 - timing_s/reward:0.06946009024977684 - timing_s/old_log_prob:1.3993191197514534 - timing_s/ref:5.917042780667543 - timing_s/adv:0.007423197850584984 - timing_s/update_actor:7.72715026140213 - timing_s/step:80.79615564458072 - timing_s/stop_profile:4.3822452425956726e-05 - timing_per_token_ms/adv:3.411929184976046e-05 - timing_per_token_ms/gen:0.7563646452072398 - timing_per_token_ms/ref:0.0271965416502006 - timing_per_token_ms/update_actor:0.03551635026337815 - perf/total_num_tokens:217566 - perf/time_per_step:80.79615564458072 - perf/throughput:336.5970791931375
[36m(TaskRunner pid=2922365)[0m step:342 - global_seqlen/min:21141 - global_seqlen/max:30407 - global_seqlen/minmax_diff:9266 - global_seqlen/balanced_min:24951 - global_seqlen/balanced_max:26277 - global_seqlen/mean:25116.875 - actor/entropy:0.07274746894836426 - actor/kl_loss:2.186938887834549 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.21197616439312697 - actor/pg_clipfrac:0.030844021076336502 - actor/ppo_kl:0.044212078442797065 - actor/pg_clipfrac_lower:0.005261355979018845 - actor/grad_norm:14.23661184310913 - perf/mfu/actor:0.07548164996122524 - perf/max_memory_allocated_gb:66.50260019302368 - perf/max_memory_reserved_gb:80.53125 - perf/cpu_memory_used_gb:92.64779281616211 - actor/lr:1e-06 - training/global_step:342 - training/epoch:0 - critic/score/mean:0.9521875381469727 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9521875381469727 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.24217702448368073 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.24217702448368073 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:218.625 - response_length/max:2048.0 - response_length/min:39.0 - response_length/clip_ratio:0.02812499925494194 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.852834045886993e-05 - timing_s/generate_sequences:50.94145965576172 - timing_s/reshard:0.7689015865325928 - timing_s/gen:66.65385554917157 - timing_s/reward:0.0640783105045557 - timing_s/old_log_prob:1.1730673108249903 - timing_s/ref:1.369644958525896 - timing_s/adv:0.010002972558140755 - timing_s/update_actor:7.1250267922878265 - timing_s/step:76.41587679833174 - timing_s/stop_profile:4.227831959724426e-05 - timing_per_token_ms/adv:4.978213132675121e-05 - timing_per_token_ms/gen:0.9527423606228068 - timing_per_token_ms/ref:0.0068163583174951905 - timing_per_token_ms/update_actor:0.03545936144667592 - perf/total_num_tokens:200935 - perf/time_per_step:76.41587679833174 - perf/throughput:328.68660352200965
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  65%|██████▌   | 343/525 [03:54<3:54:39, 77.36s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  66%|██████▌   | 344/525 [05:09<3:50:20, 76.35s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  66%|██████▌   | 345/525 [06:24<3:48:04, 76.02s/it]
[36m(TaskRunner pid=2922365)[0m step:343 - global_seqlen/min:22733 - global_seqlen/max:27685 - global_seqlen/minmax_diff:4952 - global_seqlen/balanced_min:24351 - global_seqlen/balanced_max:25719 - global_seqlen/mean:25035.25 - actor/entropy:0.06285429000854492 - actor/kl_loss:2.44384945333004 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06762016601860524 - actor/pg_clipfrac:0.03151391597930342 - actor/ppo_kl:0.1368068555369973 - actor/pg_clipfrac_lower:0.0015580257735564374 - actor/grad_norm:16.817808151245117 - perf/mfu/actor:0.07393673633564302 - perf/max_memory_allocated_gb:66.50260019302368 - perf/max_memory_reserved_gb:80.53125 - perf/cpu_memory_used_gb:92.67242050170898 - actor/lr:1e-06 - training/global_step:343 - training/epoch:0 - critic/score/mean:0.9934375882148743 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9934375882148743 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.44091323018074036 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.44091323018074036 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:217.35000610351562 - response_length/max:2048.0 - response_length/min:43.0 - response_length/clip_ratio:0.03750000149011612 - prompt_length/mean:408.53125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.790435433387756e-05 - timing_s/generate_sequences:51.66352081298828 - timing_s/reshard:0.6809737682342529 - timing_s/gen:65.14522327296436 - timing_s/reward:0.06256596557796001 - timing_s/old_log_prob:1.2821486722677946 - timing_s/ref:1.3686742912977934 - timing_s/adv:0.00737990066409111 - timing_s/update_actor:7.252942159771919 - timing_s/step:75.13220519013703 - timing_s/stop_profile:5.270726978778839e-05 - timing_per_token_ms/adv:3.684754827738444e-05 - timing_per_token_ms/gen:0.9366405462526507 - timing_per_token_ms/ref:0.006833735888885638 - timing_per_token_ms/update_actor:0.036213649552989884 - perf/total_num_tokens:200282 - perf/time_per_step:75.13220519013703 - perf/throughput:333.2159616058561
[36m(TaskRunner pid=2922365)[0m step:344 - global_seqlen/min:21910 - global_seqlen/max:36630 - global_seqlen/minmax_diff:14720 - global_seqlen/balanced_min:26511 - global_seqlen/balanced_max:27895 - global_seqlen/mean:27030.125 - actor/entropy:0.05077096447348595 - actor/kl_loss:2.0127635307610037 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06372851841151714 - actor/pg_clipfrac:0.03973951952066272 - actor/ppo_kl:-0.09407709758961573 - actor/pg_clipfrac_lower:0.0074791800056118515 - actor/grad_norm:18.020309686660767 - perf/mfu/actor:0.08022886689364779 - perf/max_memory_allocated_gb:66.50260019302368 - perf/max_memory_reserved_gb:80.53125 - perf/cpu_memory_used_gb:92.5803451538086 - actor/lr:1e-06 - training/global_step:344 - training/epoch:0 - critic/score/mean:0.9156249761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9156249761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4996182918548584 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4996182918548584 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:266.01873779296875 - response_length/max:2048.0 - response_length/min:59.0 - response_length/clip_ratio:0.05937499925494194 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.28821212053299e-05 - timing_s/generate_sequences:61.6732292175293 - timing_s/reshard:0.6568620204925537 - timing_s/gen:64.88290971331298 - timing_s/reward:0.06656978465616703 - timing_s/old_log_prob:1.1973590217530727 - timing_s/ref:1.3742563873529434 - timing_s/adv:0.007458237931132317 - timing_s/update_actor:7.255682831630111 - timing_s/step:74.79736480861902 - timing_s/stop_profile:4.462897777557373e-05 - timing_per_token_ms/adv:3.449039696973431e-05 - timing_per_token_ms/gen:0.7621985023766298 - timing_per_token_ms/ref:0.006355207325867636 - timing_per_token_ms/update_actor:0.03355368700491632 - perf/total_num_tokens:216241 - perf/time_per_step:74.79736480861902 - perf/throughput:361.3780387739713
[36m(TaskRunner pid=2922365)[0m step:345 - global_seqlen/min:21871 - global_seqlen/max:40472 - global_seqlen/minmax_diff:18601 - global_seqlen/balanced_min:27853 - global_seqlen/balanced_max:29443 - global_seqlen/mean:28289.875 - actor/entropy:0.046409327536821365 - actor/kl_loss:2.046436605975032 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12027299404144287 - actor/pg_clipfrac:0.04025442553684115 - actor/ppo_kl:0.10309685082174838 - actor/pg_clipfrac_lower:0.0017721454962156713 - actor/grad_norm:16.406278133392334 - perf/mfu/actor:0.08150335598226999 - perf/max_memory_allocated_gb:66.93583250045776 - perf/max_memory_reserved_gb:80.53125 - perf/cpu_memory_used_gb:92.46583938598633 - actor/lr:1e-06 - training/global_step:345 - training/epoch:0 - critic/score/mean:0.9431250691413879 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9431250691413879 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4790952801704407 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4790952801704407 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:298.05938720703125 - response_length/max:2048.0 - response_length/min:36.0 - response_length/clip_ratio:0.08124999701976776 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.503161370754242e-05 - timing_s/generate_sequences:62.76305389404297 - timing_s/reshard:0.7858067750930786 - timing_s/gen:65.14510538615286 - timing_s/reward:0.06868616119027138 - timing_s/old_log_prob:1.2942659221589565 - timing_s/ref:1.3853187002241611 - timing_s/adv:0.00735023058950901 - timing_s/update_actor:7.510067190974951 - timing_s/step:75.42408575490117 - timing_s/stop_profile:4.419498145580292e-05 - timing_per_token_ms/adv:3.247730234540189e-05 - timing_per_token_ms/gen:0.6830130886898884 - timing_per_token_ms/ref:0.006121088818102595 - timing_per_token_ms/update_actor:0.03318354707724473 - perf/total_num_tokens:226319 - perf/time_per_step:75.42408575490117 - perf/throughput:375.0774665261578
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  66%|██████▌   | 346/525 [07:41<3:47:09, 76.14s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  66%|██████▌   | 347/525 [08:59<3:48:00, 76.86s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  66%|██████▋   | 348/525 [10:17<3:47:23, 77.08s/it]
[36m(TaskRunner pid=2922365)[0m step:346 - global_seqlen/min:26086 - global_seqlen/max:39740 - global_seqlen/minmax_diff:13654 - global_seqlen/balanced_min:32411 - global_seqlen/balanced_max:33880 - global_seqlen/mean:32595.375 - actor/entropy:0.03634649142622948 - actor/kl_loss:1.9781449422240258 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07449150700122117 - actor/pg_clipfrac:0.04554992857156322 - actor/ppo_kl:-0.04587603554828092 - actor/pg_clipfrac_lower:0.005360124040453229 - actor/grad_norm:17.44650149345398 - perf/mfu/actor:0.09125908988551083 - perf/max_memory_allocated_gb:66.93583250045776 - perf/max_memory_reserved_gb:80.53125 - perf/cpu_memory_used_gb:92.43996810913086 - actor/lr:1e-06 - training/global_step:346 - training/epoch:0 - critic/score/mean:0.7484375238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7484375238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.43695420026779175 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.43695420026779175 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:404.9312438964844 - response_length/max:2048.0 - response_length/min:59.0 - response_length/clip_ratio:0.12812499701976776 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.04997980594635e-05 - timing_s/generate_sequences:63.775394439697266 - timing_s/reshard:0.7577230930328369 - timing_s/gen:65.6935546528548 - timing_s/reward:0.08045479096472263 - timing_s/old_log_prob:1.36769275739789 - timing_s/ref:1.4079870209097862 - timing_s/adv:0.007460230961441994 - timing_s/update_actor:7.794425571337342 - timing_s/step:76.36495176516473 - timing_s/stop_profile:4.4673681259155273e-05 - timing_per_token_ms/adv:2.8609238892948744e-05 - timing_per_token_ms/gen:0.5069807733786198 - timing_per_token_ms/ref:0.005399489271521597 - timing_per_token_ms/update_actor:0.029890841765654416 - perf/total_num_tokens:260763 - perf/time_per_step:76.36495176516473 - perf/throughput:426.83684395213584
[36m(TaskRunner pid=2922365)[0m step:347 - global_seqlen/min:32429 - global_seqlen/max:55229 - global_seqlen/minmax_diff:22800 - global_seqlen/balanced_min:41399 - global_seqlen/balanced_max:42993 - global_seqlen/mean:41798.125 - actor/entropy:0.019962187856435776 - actor/kl_loss:1.4496169112622739 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23873386830091475 - actor/pg_clipfrac:0.025874087959527968 - actor/ppo_kl:-0.09083283357103937 - actor/pg_clipfrac_lower:0.006492851689108648 - actor/grad_norm:15.725101113319397 - perf/mfu/actor:0.11431628778895764 - perf/max_memory_allocated_gb:66.9571623802185 - perf/max_memory_reserved_gb:90.833984375 - perf/cpu_memory_used_gb:92.60274887084961 - actor/lr:1e-06 - training/global_step:347 - training/epoch:0 - critic/score/mean:0.6856250166893005 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.6856250166893005 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.48384201526641846 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.48384201526641846 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:636.203125 - response_length/max:2048.0 - response_length/min:57.0 - response_length/clip_ratio:0.2562499940395355 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.172037243843079e-05 - timing_s/generate_sequences:64.67870330810547 - timing_s/reshard:0.6618098020553589 - timing_s/gen:66.81398413144052 - timing_s/reward:0.10566630959510803 - timing_s/old_log_prob:1.6781296785920858 - timing_s/ref:1.5108733270317316 - timing_s/adv:0.007480781525373459 - timing_s/update_actor:8.109377074986696 - timing_s/step:78.2399188913405 - timing_s/stop_profile:4.1503459215164185e-05 - timing_per_token_ms/adv:2.2371761668057655e-05 - timing_per_token_ms/gen:0.3281871657118183 - timing_per_token_ms/ref:0.00451836454096844 - timing_per_token_ms/update_actor:0.024251617372150952 - perf/total_num_tokens:334385 - perf/time_per_step:78.2399188913405 - perf/throughput:534.230167825828
[36m(TaskRunner pid=2922365)[0m step:348 - global_seqlen/min:32840 - global_seqlen/max:50633 - global_seqlen/minmax_diff:17793 - global_seqlen/balanced_min:39649 - global_seqlen/balanced_max:41226 - global_seqlen/mean:40043.5 - actor/entropy:0.019989565014839172 - actor/kl_loss:1.4244881251826882 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23119232282042504 - actor/pg_clipfrac:0.052361320896307004 - actor/ppo_kl:-0.17162002823897637 - actor/pg_clipfrac_lower:0.01231960133445682 - actor/grad_norm:15.657932996749878 - perf/mfu/actor:0.10893615645618875 - perf/max_memory_allocated_gb:70.47923803329468 - perf/max_memory_reserved_gb:90.833984375 - perf/cpu_memory_used_gb:92.66902160644531 - actor/lr:1e-06 - training/global_step:348 - training/epoch:0 - critic/score/mean:0.7356250286102295 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7356250286102295 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5858637690544128 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5858637690544128 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:591.2437744140625 - response_length/max:2048.0 - response_length/min:55.0 - response_length/clip_ratio:0.23125000298023224 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.42846930027008e-05 - timing_s/generate_sequences:64.4153823852539 - timing_s/reshard:0.6853007078170776 - timing_s/gen:66.17591790296137 - timing_s/reward:0.0839998871088028 - timing_s/old_log_prob:1.6320566572248936 - timing_s/ref:1.5049184951931238 - timing_s/adv:0.007903818041086197 - timing_s/update_actor:8.134300919249654 - timing_s/step:77.55332485586405 - timing_s/stop_profile:4.5279040932655334e-05 - timing_per_token_ms/adv:2.467259992597487e-05 - timing_per_token_ms/gen:0.34977070530852006 - timing_per_token_ms/ref:0.004697761481866981 - timing_per_token_ms/update_actor:0.025392076489472868 - perf/total_num_tokens:320348 - perf/time_per_step:77.55332485586405 - perf/throughput:516.3350517134171
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  66%|██████▋   | 349/525 [11:39<3:51:03, 78.77s/it]
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 00:34:16,457:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 00:34:22,953:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 00:34:22,956:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 00:34:16,992:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/model_world_size_8_rank_0.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 00:34:24,297:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/huggingface
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  67%|██████▋   | 350/525 [14:16<5:00:28, 103.02s/it]
[36m(TaskRunner pid=2922365)[0m step:349 - global_seqlen/min:47302 - global_seqlen/max:74205 - global_seqlen/minmax_diff:26903 - global_seqlen/balanced_min:58589 - global_seqlen/balanced_max:58619 - global_seqlen/mean:58596.625 - actor/entropy:0.008692195639014244 - actor/kl_loss:0.6235115960240364 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.27827288061380384 - actor/pg_clipfrac:0.019835869927192107 - actor/ppo_kl:-0.04168080709641799 - actor/pg_clipfrac_lower:0.004525390152412001 - actor/grad_norm:10.772720217704773 - perf/mfu/actor:0.14936745155143624 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.833984375 - perf/cpu_memory_used_gb:92.73751449584961 - actor/lr:1e-06 - training/global_step:349 - training/epoch:0 - critic/score/mean:0.4324999749660492 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.4324999749660492 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.23434747755527496 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.23434747755527496 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:1055.8375244140625 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.4749999940395355 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010227784514427185 - timing_s/generate_sequences:66.521728515625 - timing_s/reshard:0.6780451536178589 - timing_s/gen:69.80131713114679 - timing_s/reward:0.10750715620815754 - timing_s/old_log_prob:1.9256999865174294 - timing_s/ref:1.681701922789216 - timing_s/adv:0.007728494703769684 - timing_s/update_actor:8.828898901119828 - timing_s/step:82.3669494818896 - timing_s/stop_profile:4.707463085651398e-05 - timing_per_token_ms/adv:1.648664642325749e-05 - timing_per_token_ms/gen:0.2065934540446174 - timing_per_token_ms/ref:0.00358745474417088 - timing_per_token_ms/update_actor:0.01883406019783526 - perf/total_num_tokens:468773 - perf/time_per_step:82.3669494818896 - perf/throughput:711.4094350778877
[36m(TaskRunner pid=2922365)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 350}
[36m(TaskRunner pid=2922365)[0m validation generation end
[36m(TaskRunner pid=2922365)[0m [prompt] system
[36m(TaskRunner pid=2922365)[0m You are a helpful assistant.
[36m(TaskRunner pid=2922365)[0m user
[36m(TaskRunner pid=2922365)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m Solve the problem in the image.
[36m(TaskRunner pid=2922365)[0m assistant
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m [response]  <think>
[36m(TaskRunner pid=2922365)[0m The problem states that the hyperbola is equal-axis with its center at the origin and foci on the x-axis. This means the hyperbola has the form x^2/a^2 - y^2/b^2 = 1. The抛物线y^2=16x has a准线x=-4. The hyperbola and the抛物线 intersect at points A and B, and |AB|=4√3. We need to find the real axis length, which is 2a.
[36m(TaskRunner pid=2922365)[0m  </think>
[36m(TaskRunner pid=2922365)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2922365)[0m [ground_truth] C
[36m(TaskRunner pid=2922365)[0m [score] 0.6
[36m(TaskRunner pid=2922365)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350
[36m(TaskRunner pid=2922365)[0m step:350 - global_seqlen/min:40918 - global_seqlen/max:69665 - global_seqlen/minmax_diff:28747 - global_seqlen/balanced_min:53422 - global_seqlen/balanced_max:54899 - global_seqlen/mean:54160.125 - actor/entropy:0.010785073041915894 - actor/kl_loss:0.6605370087549091 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08237045425921678 - actor/pg_clipfrac:0.018994763022055848 - actor/ppo_kl:-0.036220690877962626 - actor/pg_clipfrac_lower:0.0019694928516400976 - actor/grad_norm:11.494064450263977 - perf/mfu/actor:0.14183290124877806 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.833984375 - perf/cpu_memory_used_gb:92.8309555053711 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.8310000226646662 - val-aux/grpo_convert/reward/std@50:0.42219459580183744 - val-aux/grpo_convert/reward/best@2/mean:1.016100023806095 - val-aux/grpo_convert/reward/best@2/std:0.41151065214397475 - val-aux/grpo_convert/reward/worst@2/mean:0.6395500215180219 - val-aux/grpo_convert/reward/worst@2/std:0.3041133956832824 - val-aux/grpo_convert/reward/best@4/mean:1.198000023841858 - val-aux/grpo_convert/reward/best@4/std:0.3808893561783923 - val-aux/grpo_convert/reward/worst@4/mean:0.5103500195853412 - val-aux/grpo_convert/reward/worst@4/std:0.2377032253507813 - val-aux/grpo_convert/reward/best@8/mean:1.341500023841858 - val-aux/grpo_convert/reward/best@8/std:0.29972487065471337 - val-aux/grpo_convert/reward/worst@8/mean:0.4130000161901116 - val-aux/grpo_convert/reward/worst@8/std:0.24339969170212616 - val-aux/grpo_convert/reward/best@16/mean:1.467000023841858 - val-aux/grpo_convert/reward/best@16/std:0.22093211627103923 - val-aux/grpo_convert/reward/worst@16/mean:0.3133000121116638 - val-aux/grpo_convert/reward/worst@16/std:0.2445903109816546 - val-aux/grpo_convert/reward/best@32/mean:1.563000023841858 - val-aux/grpo_convert/reward/best@32/std:0.13088544609695915 - val-aux/grpo_convert/reward/worst@32/mean:0.2034500075019896 - val-aux/grpo_convert/reward/worst@32/std:0.2007957686324961 - val-core/grpo_convert/reward/best@50/mean:1.589500023841858 - val-core/grpo_convert/reward/best@50/std:0.07169204976843667 - val-aux/grpo_convert/reward/worst@50/mean:0.14695000505819916 - val-aux/grpo_convert/reward/worst@50/std:0.15601524892516827 - training/global_step:350 - training/epoch:0 - critic/score/mean:0.44874995946884155 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.44874995946884155 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.23021049797534943 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.23021049797534943 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:944.4874877929688 - response_length/max:2048.0 - response_length/min:54.0 - response_length/clip_ratio:0.4124999940395355 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.649060666561127e-05 - timing_s/generate_sequences:66.33553314208984 - timing_s/reshard:0.9033486843109131 - timing_s/gen:68.4995019286871 - timing_s/reward:0.10075747966766357 - timing_s/old_log_prob:1.8544885013252497 - timing_s/ref:1.641363712027669 - timing_s/adv:0.007721899077296257 - timing_s/update_actor:8.564134223386645 - timing_s/testing:65.55531643144786 - timing_s/save_checkpoint:10.992943862453103 - timing_s/step:157.22988610900939 - timing_s/stop_profile:5.3025782108306885e-05 - timing_per_token_ms/adv:1.7821919440954617e-05 - timing_per_token_ms/gen:0.22664243150613128 - timing_per_token_ms/ref:0.0037882199127763946 - timing_per_token_ms/update_actor:0.019765773766647152 - perf/total_num_tokens:433281 - perf/time_per_step:157.22988610900939 - perf/throughput:344.46456930236616
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  67%|██████▋   | 351/525 [15:41<4:42:11, 97.31s/it] 
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 00:34:23,784:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/optim_world_size_8_rank_0.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 00:34:23,786:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_350/actor/extra_state_world_size_8_rank_0.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  67%|██████▋   | 352/525 [16:58<4:23:22, 91.34s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  67%|██████▋   | 353/525 [18:15<4:09:24, 87.00s/it]
[36m(TaskRunner pid=2922365)[0m step:351 - global_seqlen/min:43523 - global_seqlen/max:73828 - global_seqlen/minmax_diff:30305 - global_seqlen/balanced_min:55124 - global_seqlen/balanced_max:56732 - global_seqlen/mean:56129.25 - actor/entropy:0.00898370798677206 - actor/kl_loss:0.7377469046041369 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.025803710985928773 - actor/pg_clipfrac:0.012771117576630787 - actor/ppo_kl:0.010011921469049412 - actor/pg_clipfrac_lower:0.000767521325906273 - actor/grad_norm:9.138989806175232 - perf/mfu/actor:0.14306867745466748 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.83390045166016 - actor/lr:1e-06 - training/global_step:351 - training/epoch:1 - critic/score/mean:0.46593746542930603 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.46593746542930603 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.15529394149780273 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.15529394149780273 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:993.6062622070312 - response_length/max:2048.0 - response_length/min:33.0 - response_length/clip_ratio:0.44062501192092896 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00031552650034427643 - timing_s/generate_sequences:66.5194091796875 - timing_s/reshard:0.6124106049537659 - timing_s/gen:68.60826871171594 - timing_s/reward:0.10217776894569397 - timing_s/old_log_prob:1.959758823737502 - timing_s/ref:1.6822113413363695 - timing_s/adv:0.007431056350469589 - timing_s/update_actor:8.814536144956946 - timing_s/step:81.2028638496995 - timing_s/stop_profile:4.5921653509140015e-05 - timing_per_token_ms/adv:1.6548983708292888e-05 - timing_per_token_ms/gen:0.21578048620780343 - timing_per_token_ms/ref:0.0037462894598991824 - timing_per_token_ms/update_actor:0.01962999716047548 - perf/total_num_tokens:449034 - perf/time_per_step:81.2028638496995 - perf/throughput:691.2225423956857
[36m(TaskRunner pid=2922365)[0m step:352 - global_seqlen/min:32358 - global_seqlen/max:48048 - global_seqlen/minmax_diff:15690 - global_seqlen/balanced_min:37327 - global_seqlen/balanced_max:38946 - global_seqlen/mean:38136.5 - actor/entropy:0.019237441942095757 - actor/kl_loss:1.3717478089034558 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1401856048963964 - actor/pg_clipfrac:0.027416353093576616 - actor/ppo_kl:-0.02912187777001236 - actor/pg_clipfrac_lower:0.0004618928243871778 - actor/grad_norm:10.242404580116272 - perf/mfu/actor:0.10594705623939862 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.86671447753906 - actor/lr:1e-06 - training/global_step:352 - training/epoch:1 - critic/score/mean:0.6734374761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.6734374761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.30671149492263794 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.30671149492263794 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:544.6624755859375 - response_length/max:2048.0 - response_length/min:62.0 - response_length/clip_ratio:0.21250000596046448 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.091144263744354e-05 - timing_s/generate_sequences:64.47906494140625 - timing_s/reshard:0.7221028804779053 - timing_s/gen:66.78233845718205 - timing_s/reward:0.08004521206021309 - timing_s/old_log_prob:1.4188369736075401 - timing_s/ref:1.4399731494486332 - timing_s/adv:0.0073702372610569 - timing_s/update_actor:7.947482170537114 - timing_s/step:77.68912415206432 - timing_s/stop_profile:4.56441193819046e-05 - timing_per_token_ms/adv:2.4157425501346806e-05 - timing_per_token_ms/gen:0.38316353279084553 - timing_per_token_ms/ref:0.004719799763509476 - timing_per_token_ms/update_actor:0.026049461049575583 - perf/total_num_tokens:305092 - perf/time_per_step:77.68912415206432 - perf/throughput:490.8859562550063
[36m(TaskRunner pid=2922365)[0m step:353 - global_seqlen/min:25627 - global_seqlen/max:40534 - global_seqlen/minmax_diff:14907 - global_seqlen/balanced_min:34039 - global_seqlen/balanced_max:35550 - global_seqlen/mean:34464.5 - actor/entropy:0.030784107744693756 - actor/kl_loss:1.6451202362775803 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06112911161035299 - actor/pg_clipfrac:0.018545096414163707 - actor/ppo_kl:0.00016958352643996476 - actor/pg_clipfrac_lower:0.0029776034876704215 - actor/grad_norm:15.45787513256073 - perf/mfu/actor:0.0958499634377492 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.75659942626953 - actor/lr:1e-06 - training/global_step:353 - training/epoch:1 - critic/score/mean:0.6478124856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.6478124856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3700336813926697 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.3700336813926697 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:451.44061279296875 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.15625 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.277595043182373e-05 - timing_s/generate_sequences:63.882041931152344 - timing_s/reshard:0.6651285886764526 - timing_s/gen:66.15778823196888 - timing_s/reward:0.07531093806028366 - timing_s/old_log_prob:1.4435340277850628 - timing_s/ref:1.4254006743431091 - timing_s/adv:0.007448464632034302 - timing_s/update_actor:7.880871534347534 - timing_s/step:77.0032778903842 - timing_s/stop_profile:4.1641294956207275e-05 - timing_per_token_ms/adv:2.701498872765564e-05 - timing_per_token_ms/gen:0.4579629673889069 - timing_per_token_ms/ref:0.005169814861462915 - timing_per_token_ms/update_actor:0.028583294166270853 - perf/total_num_tokens:275716 - perf/time_per_step:77.0032778903842 - perf/throughput:447.5718559547679
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  67%|██████▋   | 354/525 [19:31<3:58:05, 83.54s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  68%|██████▊   | 355/525 [20:47<3:49:55, 81.15s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  68%|██████▊   | 356/525 [22:01<3:43:06, 79.21s/it]
[36m(TaskRunner pid=2922365)[0m step:354 - global_seqlen/min:21546 - global_seqlen/max:37999 - global_seqlen/minmax_diff:16453 - global_seqlen/balanced_min:26264 - global_seqlen/balanced_max:27783 - global_seqlen/mean:27213.25 - actor/entropy:0.04830116778612137 - actor/kl_loss:1.9970327451825143 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.08273210860788822 - actor/pg_clipfrac:0.02575089377351105 - actor/ppo_kl:-0.004533196406555362 - actor/pg_clipfrac_lower:0.00016949152341112496 - actor/grad_norm:17.235889434814453 - perf/mfu/actor:0.07860726681780165 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.62409973144531 - actor/lr:1e-06 - training/global_step:354 - training/epoch:1 - critic/score/mean:0.8218749761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8218749761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2952728867530823 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.2952728867530823 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:270.92498779296875 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.881464600563049e-05 - timing_s/generate_sequences:50.29584884643555 - timing_s/reshard:0.6759418845176697 - timing_s/gen:65.08282713033259 - timing_s/reward:0.06546815112233162 - timing_s/old_log_prob:1.2720811814069748 - timing_s/ref:1.3831672109663486 - timing_s/adv:0.0073849838227033615 - timing_s/update_actor:7.466223850846291 - timing_s/step:75.2909437213093 - timing_s/stop_profile:4.459172487258911e-05 - timing_per_token_ms/adv:3.3921820357286255e-05 - timing_per_token_ms/gen:0.7507016140344721 - timing_per_token_ms/ref:0.006353372029095885 - timing_per_token_ms/update_actor:0.03429498429462803 - perf/total_num_tokens:217706 - perf/time_per_step:75.2909437213093 - perf/throughput:361.44121264743745
[36m(TaskRunner pid=2922365)[0m step:355 - global_seqlen/min:21058 - global_seqlen/max:34317 - global_seqlen/minmax_diff:13259 - global_seqlen/balanced_min:25894 - global_seqlen/balanced_max:27238 - global_seqlen/mean:26566.25 - actor/entropy:0.04590405523777008 - actor/kl_loss:2.1454832807183264 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.035238908231258394 - actor/pg_clipfrac:0.021625692991074176 - actor/ppo_kl:0.001069385278970003 - actor/pg_clipfrac_lower:0.00334596810862422 - actor/grad_norm:19.29336905479431 - perf/mfu/actor:0.0782500498433789 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.51099014282227 - actor/lr:1e-06 - training/global_step:355 - training/epoch:1 - critic/score/mean:0.8146875500679016 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8146875500679016 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.45451483130455017 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.45451483130455017 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:255.078125 - response_length/max:2048.0 - response_length/min:40.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.879974484443665e-05 - timing_s/generate_sequences:61.87343978881836 - timing_s/reshard:0.7102682590484619 - timing_s/gen:65.35215224325657 - timing_s/reward:0.22452056221663952 - timing_s/old_log_prob:1.1963786743581295 - timing_s/ref:1.384266758337617 - timing_s/adv:0.007303686812520027 - timing_s/update_actor:7.314416192471981 - timing_s/step:75.4920441750437 - timing_s/stop_profile:4.030950367450714e-05 - timing_per_token_ms/adv:3.436543929101787e-05 - timing_per_token_ms/gen:0.8006389248791004 - timing_per_token_ms/ref:0.006513276988366898 - timing_per_token_ms/update_actor:0.03441592336362857 - perf/total_num_tokens:212530 - perf/time_per_step:75.4920441750437 - perf/throughput:351.90794328473515
[36m(TaskRunner pid=2922365)[0m step:356 - global_seqlen/min:22240 - global_seqlen/max:31516 - global_seqlen/minmax_diff:9276 - global_seqlen/balanced_min:25705 - global_seqlen/balanced_max:25706 - global_seqlen/mean:25705.375 - actor/entropy:0.06065728887915611 - actor/kl_loss:2.220160847902298 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04684600988402963 - actor/pg_clipfrac:0.03239610805176198 - actor/ppo_kl:0.03941273312084377 - actor/pg_clipfrac_lower:0.003925202484242618 - actor/grad_norm:17.22054386138916 - perf/mfu/actor:0.07576272080048294 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.52999496459961 - actor/lr:1e-06 - training/global_step:356 - training/epoch:1 - critic/score/mean:0.8521875143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8521875143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.30545032024383545 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.30545032024383545 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:232.35311889648438 - response_length/max:2048.0 - response_length/min:40.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.056871592998505e-05 - timing_s/generate_sequences:62.85165023803711 - timing_s/reshard:0.7246427536010742 - timing_s/gen:64.79377072304487 - timing_s/reward:0.06352450139820576 - timing_s/old_log_prob:1.156434753909707 - timing_s/ref:1.3774852380156517 - timing_s/adv:0.0074376557022333145 - timing_s/update_actor:7.286337316036224 - timing_s/step:74.69816899299622 - timing_s/stop_profile:4.171021282672882e-05 - timing_per_token_ms/adv:3.616780392346598e-05 - timing_per_token_ms/gen:0.8714345180832632 - timing_per_token_ms/ref:0.006698429987967748 - timing_per_token_ms/update_actor:0.03543197344930887 - perf/total_num_tokens:205643 - perf/time_per_step:74.69816899299622 - perf/throughput:344.1232274704105
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  68%|██████▊   | 357/525 [23:16<3:37:53, 77.82s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  68%|██████▊   | 358/525 [24:32<3:35:06, 77.29s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  68%|██████▊   | 359/525 [25:46<3:31:29, 76.44s/it]
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 00:47:12,563:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 00:47:19,047:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/optim_world_size_8_rank_2.pt
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 00:47:19,049:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/extra_state_world_size_8_rank_2.pt
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 00:47:12,936:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m step:357 - global_seqlen/min:21064 - global_seqlen/max:35727 - global_seqlen/minmax_diff:14663 - global_seqlen/balanced_min:26088 - global_seqlen/balanced_max:26089 - global_seqlen/mean:26088.5 - actor/entropy:0.05423683673143387 - actor/kl_loss:2.1950416855514048 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05329973250627518 - actor/pg_clipfrac:0.034297600388526917 - actor/ppo_kl:-0.003505831549409777 - actor/pg_clipfrac_lower:0.0030875000637024643 - actor/grad_norm:20.968085050582886 - perf/mfu/actor:0.07586099858221447 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.447021484375 - actor/lr:1e-06 - training/global_step:357 - training/epoch:1 - critic/score/mean:0.8921874761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8921874761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3826349973678589 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.3826349973678589 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:242.80624389648438 - response_length/max:2048.0 - response_length/min:54.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.235685527324677e-05 - timing_s/generate_sequences:61.45326232910156 - timing_s/reshard:0.6603480577468872 - timing_s/gen:64.50009555928409 - timing_s/reward:0.06354904174804688 - timing_s/old_log_prob:1.2102975454181433 - timing_s/ref:1.3792580217123032 - timing_s/adv:0.0074583906680345535 - timing_s/update_actor:7.388100430369377 - timing_s/step:74.56367640383542 - timing_s/stop_profile:4.4345855712890625e-05 - timing_per_token_ms/adv:3.5736007570550975e-05 - timing_per_token_ms/gen:0.8301384277495443 - timing_per_token_ms/ref:0.006608553681278643 - timing_per_token_ms/update_actor:0.03539922010833019 - perf/total_num_tokens:208708 - perf/time_per_step:74.56367640383542 - perf/throughput:349.8821578848284
[36m(TaskRunner pid=2922365)[0m step:358 - global_seqlen/min:21463 - global_seqlen/max:40599 - global_seqlen/minmax_diff:19136 - global_seqlen/balanced_min:26204 - global_seqlen/balanced_max:27593 - global_seqlen/mean:26917.5 - actor/entropy:0.049704115837812424 - actor/kl_loss:1.9473364979028702 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04264999702572823 - actor/pg_clipfrac:0.022819109115516767 - actor/ppo_kl:0.01744607402943075 - actor/pg_clipfrac_lower:0.0009754863727721386 - actor/grad_norm:16.070014476776123 - perf/mfu/actor:0.07721710220841002 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.51311492919922 - actor/lr:1e-06 - training/global_step:358 - training/epoch:1 - critic/score/mean:0.8637501001358032 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8637501001358032 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4296042025089264 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4296042025089264 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:263.203125 - response_length/max:2048.0 - response_length/min:57.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.049048483371735e-05 - timing_s/generate_sequences:61.902748107910156 - timing_s/reshard:0.6382434368133545 - timing_s/gen:65.79048476740718 - timing_s/reward:0.06484860368072987 - timing_s/old_log_prob:1.2723495103418827 - timing_s/ref:1.376034490764141 - timing_s/adv:0.007538437843322754 - timing_s/update_actor:7.513443097472191 - timing_s/step:76.03771622851491 - timing_s/stop_profile:4.3740496039390564e-05 - timing_per_token_ms/adv:3.500714146615935e-05 - timing_per_token_ms/gen:0.7811277502808808 - timing_per_token_ms/ref:0.006390055218557356 - timing_per_token_ms/update_actor:0.034891070388558515 - perf/total_num_tokens:215340 - perf/time_per_step:76.03771622851491 - perf/throughput:354.00195238775024
[36m(TaskRunner pid=2922365)[0m step:359 - global_seqlen/min:21842 - global_seqlen/max:30427 - global_seqlen/minmax_diff:8585 - global_seqlen/balanced_min:24012 - global_seqlen/balanced_max:25589 - global_seqlen/mean:24612.625 - actor/entropy:0.05926668643951416 - actor/kl_loss:2.207003375887871 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1664241410791874 - actor/pg_clipfrac:0.0339470795384841 - actor/ppo_kl:0.06048117319587618 - actor/pg_clipfrac_lower:0.0033598527079448104 - actor/grad_norm:17.13229727745056 - perf/mfu/actor:0.0720855118279457 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.54432678222656 - actor/lr:1e-06 - training/global_step:359 - training/epoch:1 - critic/score/mean:0.8921874761581421 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8921874761581421 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3092464506626129 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3092464506626129 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:205.5812530517578 - response_length/max:2048.0 - response_length/min:43.0 - response_length/clip_ratio:0.03437500074505806 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.0746209025383e-05 - timing_s/generate_sequences:48.31631851196289 - timing_s/reshard:0.6473821997642517 - timing_s/gen:64.24081072211266 - timing_s/reward:0.061431884765625 - timing_s/old_log_prob:1.1587648801505566 - timing_s/ref:1.3699860107153654 - timing_s/adv:0.007353710010647774 - timing_s/update_actor:7.3067108280956745 - timing_s/step:74.15821601636708 - timing_s/stop_profile:4.2537227272987366e-05 - timing_per_token_ms/adv:3.734724562418562e-05 - timing_per_token_ms/gen:0.9765118828035244 - timing_per_token_ms/ref:0.006957740238573523 - timing_per_token_ms/update_actor:0.037108551140398856 - perf/total_num_tokens:196901 - perf/time_per_step:74.15821601636708 - perf/throughput:331.89343436427697
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  69%|██████▊   | 360/525 [27:12<3:37:39, 79.15s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 00:47:19,799:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/huggingface
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  69%|██████▉   | 361/525 [28:27<3:32:44, 77.83s/it]
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 00:47:19,398:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/optim_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 00:47:19,400:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_360/actor/extra_state_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  69%|██████▉   | 362/525 [29:41<3:28:47, 76.86s/it]
[36m(TaskRunner pid=2922365)[0m step:360 - global_seqlen/min:21542 - global_seqlen/max:33543 - global_seqlen/minmax_diff:12001 - global_seqlen/balanced_min:25767 - global_seqlen/balanced_max:27364 - global_seqlen/mean:26765.125 - actor/entropy:0.04847517982125282 - actor/kl_loss:2.2415560469031335 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.024077045172452925 - actor/pg_clipfrac:0.04561779508367181 - actor/ppo_kl:0.010746116284281015 - actor/pg_clipfrac_lower:0.005248171801213175 - actor/grad_norm:17.553053379058838 - perf/mfu/actor:0.07927390005747638 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.5914192199707 - actor/lr:1e-06 - training/global_step:360 - training/epoch:1 - critic/score/mean:0.8709375262260437 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8709375262260437 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.407734215259552 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.407734215259552 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:259.50311279296875 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.944181561470032e-05 - timing_s/generate_sequences:61.606204986572266 - timing_s/reshard:0.6584110856056213 - timing_s/gen:64.71982195600867 - timing_s/reward:0.0674061868339777 - timing_s/old_log_prob:1.1781194098293781 - timing_s/ref:1.3807535786181688 - timing_s/adv:0.007396649569272995 - timing_s/update_actor:7.2804522421211 - timing_s/save_checkpoint:10.803041473031044 - timing_s/step:85.4512447360903 - timing_s/stop_profile:4.7555193305015564e-05 - timing_per_token_ms/adv:3.4544251004212545e-05 - timing_per_token_ms/gen:0.7793719000976466 - timing_per_token_ms/ref:0.006448473426792182 - timing_per_token_ms/update_actor:0.034001579677477224 - perf/total_num_tokens:214121 - perf/time_per_step:85.4512447360903 - perf/throughput:313.22100787018445
[36m(TaskRunner pid=2922365)[0m step:361 - global_seqlen/min:22748 - global_seqlen/max:30486 - global_seqlen/minmax_diff:7738 - global_seqlen/balanced_min:24191 - global_seqlen/balanced_max:25642 - global_seqlen/mean:25459.875 - actor/entropy:0.06039848178625107 - actor/kl_loss:2.307435056567192 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1334042776376009 - actor/pg_clipfrac:0.03119721983675845 - actor/ppo_kl:0.0460511623590719 - actor/pg_clipfrac_lower:0.003468573561985977 - actor/grad_norm:21.63321590423584 - perf/mfu/actor:0.0751273887844118 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.62854385375977 - actor/lr:1e-06 - training/global_step:361 - training/epoch:1 - critic/score/mean:0.8878124952316284 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8878124952316284 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.442205548286438 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.442205548286438 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:226.7624969482422 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.844530045986176e-05 - timing_s/generate_sequences:62.906280517578125 - timing_s/reshard:0.7304610013961792 - timing_s/gen:64.83121784031391 - timing_s/reward:0.06318380683660507 - timing_s/old_log_prob:1.1904783733189106 - timing_s/ref:1.366009647026658 - timing_s/adv:0.007597450166940689 - timing_s/update_actor:7.275342574343085 - timing_s/step:74.74698325619102 - timing_s/stop_profile:4.344433546066284e-05 - timing_per_token_ms/adv:3.73010971525817e-05 - timing_per_token_ms/gen:0.893435006894795 - timing_per_token_ms/ref:0.0067066788771874275 - timing_per_token_ms/update_actor:0.0357196499115917 - perf/total_num_tokens:203679 - perf/time_per_step:74.74698325619102 - perf/throughput:340.6140808751804
[36m(TaskRunner pid=2922365)[0m step:362 - global_seqlen/min:21567 - global_seqlen/max:34110 - global_seqlen/minmax_diff:12543 - global_seqlen/balanced_min:25516 - global_seqlen/balanced_max:27082 - global_seqlen/mean:25711.875 - actor/entropy:0.0560779944062233 - actor/kl_loss:2.3428467735648155 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.04981877403333783 - actor/pg_clipfrac:0.0405821762047708 - actor/ppo_kl:0.01290519773028791 - actor/pg_clipfrac_lower:0.002621343909413554 - actor/grad_norm:18.29051113128662 - perf/mfu/actor:0.07578245811975556 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.77555847167969 - actor/lr:1e-06 - training/global_step:362 - training/epoch:1 - critic/score/mean:0.9074999690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9074999690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4876720905303955 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4876720905303955 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:233.28125 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.05312500149011612 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.14260745048523e-05 - timing_s/generate_sequences:62.38434600830078 - timing_s/reshard:0.6681681275367737 - timing_s/gen:64.39431380480528 - timing_s/reward:0.06394527480006218 - timing_s/old_log_prob:1.2015548180788755 - timing_s/ref:1.3741740845143795 - timing_s/adv:0.007313858717679977 - timing_s/update_actor:7.293944807723165 - timing_s/step:74.34815554320812 - timing_s/stop_profile:4.3429434299468994e-05 - timing_per_token_ms/adv:3.555681332886058e-05 - timing_per_token_ms/gen:0.8626163939022811 - timing_per_token_ms/ref:0.006680639220760736 - timing_per_token_ms/update_actor:0.03546000052370337 - perf/total_num_tokens:205695 - perf/time_per_step:74.34815554320812 - perf/throughput:345.8307043684131
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  69%|██████▉   | 363/525 [30:56<3:25:36, 76.15s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  69%|██████▉   | 364/525 [32:12<3:24:02, 76.04s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  70%|██████▉   | 365/525 [33:27<3:22:39, 76.00s/it]
[36m(TaskRunner pid=2922365)[0m step:363 - global_seqlen/min:21052 - global_seqlen/max:27358 - global_seqlen/minmax_diff:6306 - global_seqlen/balanced_min:22128 - global_seqlen/balanced_max:23638 - global_seqlen/mean:23449.125 - actor/entropy:0.08361382782459259 - actor/kl_loss:2.6241310432553293 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.10285430625081063 - actor/pg_clipfrac:0.03999049603007734 - actor/ppo_kl:-0.09104890059679746 - actor/pg_clipfrac_lower:0.003784466627985239 - actor/grad_norm:22.03767442703247 - perf/mfu/actor:0.06986534209237982 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.72979354858398 - actor/lr:1e-06 - training/global_step:363 - training/epoch:1 - critic/score/mean:1.0112501382827759 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0112501382827759 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3127606511116028 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3127606511116028 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:176.82186889648438 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.02187499962747097 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.649379014968872e-05 - timing_s/generate_sequences:60.472129821777344 - timing_s/reshard:0.6576365828514099 - timing_s/gen:64.64297513104975 - timing_s/reward:0.060304414480924606 - timing_s/old_log_prob:1.1447765938937664 - timing_s/ref:1.366402756422758 - timing_s/adv:0.007238494232296944 - timing_s/update_actor:7.15150716342032 - timing_s/step:74.38621041923761 - timing_s/stop_profile:4.1525810956954956e-05 - timing_per_token_ms/adv:3.858616383498821e-05 - timing_per_token_ms/gen:1.142445171359768 - timing_per_token_ms/ref:0.007283868568777929 - timing_per_token_ms/update_actor:0.038122462796694546 - perf/total_num_tokens:187593 - perf/time_per_step:74.38621041923761 - perf/throughput:315.2348381217661
[36m(TaskRunner pid=2922365)[0m step:364 - global_seqlen/min:21341 - global_seqlen/max:32413 - global_seqlen/minmax_diff:11072 - global_seqlen/balanced_min:25642 - global_seqlen/balanced_max:27265 - global_seqlen/mean:26662.5 - actor/entropy:0.056318722665309906 - actor/kl_loss:2.40230338126421 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12585278898477553 - actor/pg_clipfrac:0.026798722171224653 - actor/ppo_kl:0.09581311304064002 - actor/pg_clipfrac_lower:0.003938256987021304 - actor/grad_norm:13.964380741119385 - perf/mfu/actor:0.07803935096045123 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.67476654052734 - actor/lr:1e-06 - training/global_step:364 - training/epoch:1 - critic/score/mean:0.7953125238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7953125238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.532001256942749 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.532001256942749 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:256.828125 - response_length/max:2048.0 - response_length/min:54.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.99465924501419e-05 - timing_s/generate_sequences:50.404747009277344 - timing_s/reshard:0.6360899209976196 - timing_s/gen:65.71762799471617 - timing_s/reward:0.06678453832864761 - timing_s/old_log_prob:1.2235292810946703 - timing_s/ref:1.3753052987158298 - timing_s/adv:0.007448282092809677 - timing_s/update_actor:7.366911059245467 - timing_s/step:75.77104302495718 - timing_s/stop_profile:4.419684410095215e-05 - timing_per_token_ms/adv:3.4919278447302754e-05 - timing_per_token_ms/gen:0.7996304434472977 - timing_per_token_ms/ref:0.0064477510488318325 - timing_per_token_ms/update_actor:0.03453779212023191 - perf/total_num_tokens:213300 - perf/time_per_step:75.77104302495718 - perf/throughput:351.88244658606595
[36m(TaskRunner pid=2922365)[0m step:365 - global_seqlen/min:22365 - global_seqlen/max:39454 - global_seqlen/minmax_diff:17089 - global_seqlen/balanced_min:27861 - global_seqlen/balanced_max:29485 - global_seqlen/mean:28673.0 - actor/entropy:0.04488879442214966 - actor/kl_loss:2.21801780462265 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12490369379520416 - actor/pg_clipfrac:0.019724742032121868 - actor/ppo_kl:-0.07301997203903739 - actor/pg_clipfrac_lower:0.005146139833959751 - actor/grad_norm:17.16536295413971 - perf/mfu/actor:0.0835858444249487 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.67948532104492 - actor/lr:1e-06 - training/global_step:365 - training/epoch:1 - critic/score/mean:0.7806249856948853 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7806249856948853 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4220053553581238 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.4220053553581238 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:306.87188720703125 - response_length/max:2048.0 - response_length/min:41.0 - response_length/clip_ratio:0.08749999850988388 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.171424269676208e-05 - timing_s/generate_sequences:62.45552062988281 - timing_s/reshard:0.6970440149307251 - timing_s/gen:65.7681877259165 - timing_s/reward:0.06962200812995434 - timing_s/old_log_prob:1.2058554738759995 - timing_s/ref:1.3840115368366241 - timing_s/adv:0.007470754906535149 - timing_s/update_actor:7.432897144928575 - timing_s/step:75.88135221786797 - timing_s/stop_profile:4.1697174310684204e-05 - timing_per_token_ms/adv:3.2568770736124354e-05 - timing_per_token_ms/gen:0.6697439660884175 - timing_per_token_ms/ref:0.006033601022026925 - timing_per_token_ms/update_actor:0.03240372974980197 - perf/total_num_tokens:229384 - perf/time_per_step:75.88135221786797 - perf/throughput:377.86622354429124
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  70%|██████▉   | 366/525 [34:43<3:20:42, 75.74s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  70%|██████▉   | 367/525 [35:58<3:19:11, 75.64s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  70%|███████   | 368/525 [37:13<3:17:23, 75.44s/it]
[36m(TaskRunner pid=2922365)[0m step:366 - global_seqlen/min:24517 - global_seqlen/max:40143 - global_seqlen/minmax_diff:15626 - global_seqlen/balanced_min:29488 - global_seqlen/balanced_max:30980 - global_seqlen/mean:29677.875 - actor/entropy:0.042959097772836685 - actor/kl_loss:2.2018939308822154 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23960543833673 - actor/pg_clipfrac:0.02685207336762687 - actor/ppo_kl:-0.05354385982500389 - actor/pg_clipfrac_lower:0.003104245284339413 - actor/grad_norm:22.75175929069519 - perf/mfu/actor:0.08576199287942157 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:90.84765625 - perf/cpu_memory_used_gb:94.64620208740234 - actor/lr:1e-06 - training/global_step:366 - training/epoch:1 - critic/score/mean:0.8071874380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8071874380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5434921979904175 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5434921979904175 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:332.9781188964844 - response_length/max:2048.0 - response_length/min:40.0 - response_length/clip_ratio:0.10312499850988388 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.825344800949097e-05 - timing_s/generate_sequences:63.16764831542969 - timing_s/reshard:0.6764654517173767 - timing_s/gen:64.80229838378727 - timing_s/reward:0.06974931433796883 - timing_s/old_log_prob:1.2963163275271654 - timing_s/ref:1.4137538112699986 - timing_s/adv:0.00750858336687088 - timing_s/update_actor:7.522263387218118 - timing_s/step:75.12512414343655 - timing_s/stop_profile:4.487670958042145e-05 - timing_per_token_ms/adv:3.162534112900132e-05 - timing_per_token_ms/gen:0.6081696281079583 - timing_per_token_ms/ref:0.0059545781633203124 - timing_per_token_ms/update_actor:0.03168295989528444 - perf/total_num_tokens:237423 - perf/time_per_step:75.12512414343655 - perf/throughput:395.0459362081848
[36m(TaskRunner pid=2922365)[0m step:367 - global_seqlen/min:21530 - global_seqlen/max:29144 - global_seqlen/minmax_diff:7614 - global_seqlen/balanced_min:24163 - global_seqlen/balanced_max:25661 - global_seqlen/mean:25099.125 - actor/entropy:0.0635853037238121 - actor/kl_loss:2.4033261224627496 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.27858278155326843 - actor/pg_clipfrac:0.041734963306225836 - actor/ppo_kl:-0.17770602493546903 - actor/pg_clipfrac_lower:0.01720718980068341 - actor/grad_norm:17.946847438812256 - perf/mfu/actor:0.07356886974335103 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.70796966552734 - actor/lr:1e-06 - training/global_step:367 - training/epoch:1 - critic/score/mean:0.9256249666213989 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9256249666213989 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.36775487661361694 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.36775487661361694 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:217.19686889648438 - response_length/max:2048.0 - response_length/min:64.0 - response_length/clip_ratio:0.04062499850988388 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.890032768249512e-05 - timing_s/generate_sequences:63.178260803222656 - timing_s/reshard:0.7004311680793762 - timing_s/gen:65.0763947032392 - timing_s/reward:0.06284870766103268 - timing_s/old_log_prob:1.2577377296984196 - timing_s/ref:1.3694163113832474 - timing_s/adv:0.007500467821955681 - timing_s/update_actor:7.314499566331506 - timing_s/step:75.10159889236093 - timing_s/stop_profile:4.435144364833832e-05 - timing_per_token_ms/adv:3.735422958945621e-05 - timing_per_token_ms/gen:0.9363105866399897 - timing_per_token_ms/ref:0.0068200400979279525 - timing_per_token_ms/update_actor:0.03642806057149157 - perf/total_num_tokens:200793 - perf/time_per_step:75.10159889236093 - perf/throughput:334.20227225752177
[36m(TaskRunner pid=2922365)[0m step:368 - global_seqlen/min:21439 - global_seqlen/max:31877 - global_seqlen/minmax_diff:10438 - global_seqlen/balanced_min:24139 - global_seqlen/balanced_max:25734 - global_seqlen/mean:24737.375 - actor/entropy:0.06498000025749207 - actor/kl_loss:2.3812860481441023 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08429211750626564 - actor/pg_clipfrac:0.029452909249812365 - actor/ppo_kl:0.15942158233374357 - actor/pg_clipfrac_lower:0.001543226046487689 - actor/grad_norm:20.05904746055603 - perf/mfu/actor:0.07356442872494602 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.59640502929688 - actor/lr:1e-06 - training/global_step:368 - training/epoch:1 - critic/score/mean:0.978437602519989 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.978437602519989 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.28259146213531494 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.28259146213531494 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:208.9187469482422 - response_length/max:2048.0 - response_length/min:53.0 - response_length/clip_ratio:0.03437500074505806 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.773749530315399e-05 - timing_s/generate_sequences:48.73958206176758 - timing_s/reshard:0.6502920389175415 - timing_s/gen:65.04538227804005 - timing_s/reward:0.06188447028398514 - timing_s/old_log_prob:1.239769198000431 - timing_s/ref:1.3788788132369518 - timing_s/adv:0.007399776950478554 - timing_s/update_actor:7.19443766400218 - timing_s/step:74.94097204133868 - timing_s/stop_profile:4.501640796661377e-05 - timing_per_token_ms/adv:3.739168439698308e-05 - timing_per_token_ms/gen:0.972946753792444 - timing_per_token_ms/ref:0.006967588584262436 - timing_per_token_ms/update_actor:0.03635408801460432 - perf/total_num_tokens:197899 - perf/time_per_step:74.94097204133868 - perf/throughput:330.0914616687178
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  70%|███████   | 369/525 [38:28<3:15:49, 75.31s/it]
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 00:59:54,892:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 01:00:01,386:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 01:00:01,390:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/extra_state_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 00:59:55,502:[Rank 5] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/model_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  70%|███████   | 370/525 [39:54<3:23:08, 78.63s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:00:02,226:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/huggingface
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  71%|███████   | 371/525 [41:11<3:20:05, 77.96s/it]
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 01:00:02,229:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/optim_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 01:00:02,231:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370/actor/extra_state_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m step:369 - global_seqlen/min:21151 - global_seqlen/max:32668 - global_seqlen/minmax_diff:11517 - global_seqlen/balanced_min:25854 - global_seqlen/balanced_max:25855 - global_seqlen/mean:25854.25 - actor/entropy:0.052887968719005585 - actor/kl_loss:2.124515397846699 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1827244982123375 - actor/pg_clipfrac:0.04023311294149608 - actor/ppo_kl:-0.08972985068394337 - actor/pg_clipfrac_lower:0.004252780566457659 - actor/grad_norm:17.735167860984802 - perf/mfu/actor:0.0764001929556236 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.5540771484375 - actor/lr:1e-06 - training/global_step:369 - training/epoch:1 - critic/score/mean:0.8812500238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8812500238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.38951393961906433 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.38951393961906433 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:236.0749969482422 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:410.28125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.758475840091705e-05 - timing_s/generate_sequences:50.236419677734375 - timing_s/reshard:0.7180733680725098 - timing_s/gen:65.08021480217576 - timing_s/reward:0.06442003697156906 - timing_s/old_log_prob:1.212518172338605 - timing_s/ref:1.3706017825752497 - timing_s/adv:0.007440822198987007 - timing_s/update_actor:7.270585883408785 - timing_s/step:75.01897007226944 - timing_s/stop_profile:4.17027622461319e-05 - timing_per_token_ms/adv:3.59748503581955e-05 - timing_per_token_ms/gen:0.861487541064489 - timing_per_token_ms/ref:0.006626578718079473 - timing_per_token_ms/update_actor:0.03515179266179054 - perf/total_num_tokens:206834 - perf/time_per_step:75.01897007226944 - perf/throughput:344.63616302774267
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_370
[36m(TaskRunner pid=2922365)[0m step:370 - global_seqlen/min:23149 - global_seqlen/max:34988 - global_seqlen/minmax_diff:11839 - global_seqlen/balanced_min:25853 - global_seqlen/balanced_max:27362 - global_seqlen/mean:26812.0 - actor/entropy:0.04624467343091965 - actor/kl_loss:2.1622707173228264 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.008298725448548793 - actor/pg_clipfrac:0.011776373209431767 - actor/ppo_kl:0.016015208314638586 - actor/pg_clipfrac_lower:0.0020624709606636314 - actor/grad_norm:15.356197118759155 - perf/mfu/actor:0.07798900038338326 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.54653549194336 - actor/lr:1e-06 - training/global_step:370 - training/epoch:1 - critic/score/mean:0.8728124499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8728124499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4030466377735138 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4030466377735138 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:260.34686279296875 - response_length/max:2048.0 - response_length/min:67.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.458325803279877e-05 - timing_s/generate_sequences:63.288238525390625 - timing_s/reshard:0.6839746832847595 - timing_s/gen:65.13806506060064 - timing_s/reward:0.06528270989656448 - timing_s/old_log_prob:1.2774599231779575 - timing_s/ref:1.3904054127633572 - timing_s/adv:0.007278976961970329 - timing_s/update_actor:7.416147639974952 - timing_s/save_checkpoint:10.81145110167563 - timing_s/step:86.11943515017629 - timing_s/stop_profile:5.194731056690216e-05 - timing_per_token_ms/adv:3.3935257356642215e-05 - timing_per_token_ms/gen:0.7818663209012092 - timing_per_token_ms/ref:0.006482197396517218 - timing_per_token_ms/update_actor:0.03457475962244028 - perf/total_num_tokens:214496 - perf/time_per_step:86.11943515017629 - perf/throughput:311.3350656938803
[36m(TaskRunner pid=2922365)[0m step:371 - global_seqlen/min:21783 - global_seqlen/max:44324 - global_seqlen/minmax_diff:22541 - global_seqlen/balanced_min:29273 - global_seqlen/balanced_max:30894 - global_seqlen/mean:29881.125 - actor/entropy:0.03567281365394592 - actor/kl_loss:1.9850783459842205 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.22698875293135642 - actor/pg_clipfrac:0.021509670559316872 - actor/ppo_kl:0.11410726853064261 - actor/pg_clipfrac_lower:0.002369434070715215 - actor/grad_norm:19.76198959350586 - perf/mfu/actor:0.08556956789135706 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.60756301879883 - actor/lr:1e-06 - training/global_step:371 - training/epoch:1 - critic/score/mean:0.8065624237060547 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8065624237060547 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.45963603258132935 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.45963603258132935 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:336.96563720703125 - response_length/max:2048.0 - response_length/min:48.0 - response_length/clip_ratio:0.109375 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.952617645263672e-05 - timing_s/generate_sequences:63.592811584472656 - timing_s/reshard:0.6698353290557861 - timing_s/gen:65.81641038879752 - timing_s/reward:0.06998737715184689 - timing_s/old_log_prob:1.3525369931012392 - timing_s/ref:1.4081042651087046 - timing_s/adv:0.007428083568811417 - timing_s/update_actor:7.600741321220994 - timing_s/step:76.26825738325715 - timing_s/stop_profile:4.4658780097961426e-05 - timing_per_token_ms/adv:3.1073476855420506e-05 - timing_per_token_ms/gen:0.6103776385647416 - timing_per_token_ms/ref:0.005890441980969193 - timing_per_token_ms/update_actor:0.0317957461492037 - perf/total_num_tokens:239049 - perf/time_per_step:76.26825738325715 - perf/throughput:391.7897959808333
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  71%|███████   | 372/525 [42:27<3:17:47, 77.57s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  71%|███████   | 373/525 [43:43<3:14:53, 76.93s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  71%|███████   | 374/525 [44:59<3:12:58, 76.68s/it]
[36m(TaskRunner pid=2922365)[0m step:372 - global_seqlen/min:25345 - global_seqlen/max:42299 - global_seqlen/minmax_diff:16954 - global_seqlen/balanced_min:31121 - global_seqlen/balanced_max:32802 - global_seqlen/mean:31331.875 - actor/entropy:0.032585591077804565 - actor/kl_loss:1.7432271234691143 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23633924797177314 - actor/pg_clipfrac:0.0310127311386168 - actor/ppo_kl:-0.07068880189035553 - actor/pg_clipfrac_lower:0.0018296069421921857 - actor/grad_norm:13.11262321472168 - perf/mfu/actor:0.08805561917746756 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.53931045532227 - actor/lr:1e-06 - training/global_step:372 - training/epoch:1 - critic/score/mean:0.7528125047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7528125047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5460212230682373 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5460212230682373 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:373.234375 - response_length/max:2048.0 - response_length/min:56.0 - response_length/clip_ratio:0.12812499701976776 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.010491728782654e-05 - timing_s/generate_sequences:63.29508590698242 - timing_s/reshard:0.7174585461616516 - timing_s/gen:66.06409915722907 - timing_s/reward:0.0751764327287674 - timing_s/old_log_prob:1.3114795666188002 - timing_s/ref:1.4000569600611925 - timing_s/adv:0.007377412170171738 - timing_s/update_actor:7.768033778294921 - timing_s/step:76.63935792259872 - timing_s/stop_profile:4.0762126445770264e-05 - timing_per_token_ms/adv:2.943253543783981e-05 - timing_per_token_ms/gen:0.5531385201760712 - timing_per_token_ms/ref:0.005585593585051934 - timing_per_token_ms/update_actor:0.030990938853383818 - perf/total_num_tokens:250655 - perf/time_per_step:76.63935792259872 - perf/throughput:408.82225333415977
[36m(TaskRunner pid=2922365)[0m step:373 - global_seqlen/min:23346 - global_seqlen/max:33537 - global_seqlen/minmax_diff:10191 - global_seqlen/balanced_min:27687 - global_seqlen/balanced_max:29208 - global_seqlen/mean:28269.5 - actor/entropy:0.042655013501644135 - actor/kl_loss:2.25514702796936 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11938523426651955 - actor/pg_clipfrac:0.05916063264012337 - actor/ppo_kl:0.0031557414680719376 - actor/pg_clipfrac_lower:0.004140167124569416 - actor/grad_norm:19.502418041229248 - perf/mfu/actor:0.08215069881025101 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.62054061889648 - actor/lr:1e-06 - training/global_step:373 - training/epoch:1 - critic/score/mean:0.8850000500679016 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8850000500679016 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3700181543827057 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3700181543827057 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:297.00311279296875 - response_length/max:2048.0 - response_length/min:47.0 - response_length/clip_ratio:0.08437500149011612 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.992982864379883e-05 - timing_s/generate_sequences:63.38837432861328 - timing_s/reshard:0.67332524061203 - timing_s/gen:65.27980510517955 - timing_s/reward:0.06690278649330139 - timing_s/old_log_prob:1.2223826311528683 - timing_s/ref:1.390471687540412 - timing_s/adv:0.007445050403475761 - timing_s/update_actor:7.451291652396321 - timing_s/step:75.43135150521994 - timing_s/stop_profile:4.345551133155823e-05 - timing_per_token_ms/adv:3.2919977376128694e-05 - timing_per_token_ms/gen:0.6868594091516246 - timing_per_token_ms/ref:0.006148285641505916 - timing_per_token_ms/update_actor:0.03294757447247175 - perf/total_num_tokens:226156 - perf/time_per_step:75.43135150521994 - perf/throughput:374.7712249069767
[36m(TaskRunner pid=2922365)[0m step:374 - global_seqlen/min:21031 - global_seqlen/max:34606 - global_seqlen/minmax_diff:13575 - global_seqlen/balanced_min:27163 - global_seqlen/balanced_max:27164 - global_seqlen/mean:27163.875 - actor/entropy:0.042208049446344376 - actor/kl_loss:2.2587041333317757 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.017600857466459275 - actor/pg_clipfrac:0.03571933936327696 - actor/ppo_kl:0.03939932927023619 - actor/pg_clipfrac_lower:0.0024949552491307257 - actor/grad_norm:18.3062744140625 - perf/mfu/actor:0.07905635113918195 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.60255813598633 - actor/lr:1e-06 - training/global_step:374 - training/epoch:1 - critic/score/mean:0.9146875143051147 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9146875143051147 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2643299102783203 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.2643299102783203 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:269.58123779296875 - response_length/max:2048.0 - response_length/min:55.0 - response_length/clip_ratio:0.07500000298023224 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.224882185459137e-05 - timing_s/generate_sequences:61.59297561645508 - timing_s/reshard:0.7237217426300049 - timing_s/gen:65.97991091385484 - timing_s/reward:0.06486689858138561 - timing_s/old_log_prob:1.2136283591389656 - timing_s/ref:1.3886150624603033 - timing_s/adv:0.007435411214828491 - timing_s/update_actor:7.4240439515560865 - timing_s/step:76.09186859987676 - timing_s/stop_profile:4.0512531995773315e-05 - timing_per_token_ms/adv:3.4215530805290533e-05 - timing_per_token_ms/gen:0.7648425905206552 - timing_per_token_ms/ref:0.006389989749530872 - timing_per_token_ms/update_actor:0.03416322207139117 - perf/total_num_tokens:217311 - perf/time_per_step:76.09186859987676 - perf/throughput:356.98788188313716
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  71%|███████▏  | 375/525 [46:16<3:11:54, 76.76s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  72%|███████▏  | 376/525 [47:35<3:12:16, 77.42s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  72%|███████▏  | 377/525 [48:51<3:10:24, 77.19s/it]
[36m(TaskRunner pid=2922365)[0m step:375 - global_seqlen/min:22374 - global_seqlen/max:55317 - global_seqlen/minmax_diff:32943 - global_seqlen/balanced_min:31079 - global_seqlen/balanced_max:32735 - global_seqlen/mean:32113.875 - actor/entropy:0.023638330399990082 - actor/kl_loss:1.8436333714053035 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.042795758694410324 - actor/pg_clipfrac:0.0377436769194901 - actor/ppo_kl:0.009737118054181338 - actor/pg_clipfrac_lower:0.001952955947490409 - actor/grad_norm:16.92412257194519 - perf/mfu/actor:0.09160007795793824 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.64304733276367 - actor/lr:1e-06 - training/global_step:375 - training/epoch:1 - critic/score/mean:0.8125 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8125 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.32077324390411377 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.32077324390411377 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:393.98748779296875 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.140625 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.676255285739899e-05 - timing_s/generate_sequences:63.785709381103516 - timing_s/reshard:0.7236306071281433 - timing_s/gen:66.1257504671812 - timing_s/reward:0.0715257115662098 - timing_s/old_log_prob:1.3251668941229582 - timing_s/ref:1.4085240345448256 - timing_s/adv:0.00737893208861351 - timing_s/update_actor:7.669698541983962 - timing_s/step:76.6214603856206 - timing_s/stop_profile:4.2518600821495056e-05 - timing_per_token_ms/adv:2.8721744450854615e-05 - timing_per_token_ms/gen:0.5244911836287731 - timing_per_token_ms/ref:0.005482536888435394 - timing_per_token_ms/update_actor:0.02985352336795218 - perf/total_num_tokens:256911 - perf/time_per_step:76.6214603856206 - perf/throughput:419.1237655661644
[36m(TaskRunner pid=2922365)[0m step:376 - global_seqlen/min:36474 - global_seqlen/max:50198 - global_seqlen/minmax_diff:13724 - global_seqlen/balanced_min:42538 - global_seqlen/balanced_max:42686 - global_seqlen/mean:42557.125 - actor/entropy:0.012863784097135067 - actor/kl_loss:1.4993775794282556 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11865870952606201 - actor/pg_clipfrac:0.02060421264031902 - actor/ppo_kl:0.012457788280153181 - actor/pg_clipfrac_lower:0.002910598926246166 - actor/grad_norm:17.89531898498535 - perf/mfu/actor:0.11798209032709712 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.5870246887207 - actor/lr:1e-06 - training/global_step:376 - training/epoch:1 - critic/score/mean:0.6731249094009399 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.6731249094009399 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3389699161052704 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.3389699161052704 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:654.5218505859375 - response_length/max:2048.0 - response_length/min:35.0 - response_length/clip_ratio:0.2750000059604645 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.567608892917633e-05 - timing_s/generate_sequences:65.46279907226562 - timing_s/reshard:0.6655683517456055 - timing_s/gen:67.75168890319765 - timing_s/reward:0.08449189737439156 - timing_s/old_log_prob:1.5858028084039688 - timing_s/ref:1.4910916592925787 - timing_s/adv:0.007381316274404526 - timing_s/update_actor:8.01926382444799 - timing_s/step:78.9530009701848 - timing_s/stop_profile:4.547834396362305e-05 - timing_per_token_ms/adv:2.1680612454449537e-05 - timing_per_token_ms/gen:0.32347891783218496 - timing_per_token_ms/ref:0.0043796769027882486 - timing_per_token_ms/update_actor:0.023554410173525553 - perf/total_num_tokens:340457 - perf/time_per_step:78.9530009701848 - perf/throughput:539.0184600591806
[36m(TaskRunner pid=2922365)[0m step:377 - global_seqlen/min:25018 - global_seqlen/max:42700 - global_seqlen/minmax_diff:17682 - global_seqlen/balanced_min:33045 - global_seqlen/balanced_max:34658 - global_seqlen/mean:33651.375 - actor/entropy:0.023700909689068794 - actor/kl_loss:1.7989915473386646 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.043226938042789695 - actor/pg_clipfrac:0.03298181185964495 - actor/ppo_kl:-0.03883237021509558 - actor/pg_clipfrac_lower:0.003091091965325177 - actor/grad_norm:13.964961051940918 - perf/mfu/actor:0.09653904527191419 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.64423370361328 - actor/lr:1e-06 - training/global_step:377 - training/epoch:1 - critic/score/mean:0.7231250405311584 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7231250405311584 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.36447766423225403 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.36447766423225403 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:431.87811279296875 - response_length/max:2048.0 - response_length/min:39.0 - response_length/clip_ratio:0.15937499701976776 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.264370262622833e-05 - timing_s/generate_sequences:63.991947174072266 - timing_s/reshard:0.6689908504486084 - timing_s/gen:66.08305391296744 - timing_s/reward:0.07331900484859943 - timing_s/old_log_prob:1.3896529711782932 - timing_s/ref:1.4161404129117727 - timing_s/adv:0.007385460659861565 - timing_s/update_actor:7.646938918158412 - timing_s/step:76.62956242263317 - timing_s/stop_profile:4.507787525653839e-05 - timing_per_token_ms/adv:2.7433725441611096e-05 - timing_per_token_ms/gen:0.47816624997624796 - timing_per_token_ms/ref:0.005260336364085318 - timing_per_token_ms/update_actor:0.028405001720429 - perf/total_num_tokens:269211 - perf/time_per_step:76.62956242263317 - perf/throughput:439.14350984289047
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  72%|███████▏  | 378/525 [50:08<3:08:40, 77.01s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  72%|███████▏  | 379/525 [51:24<3:06:31, 76.65s/it]
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 01:12:51,210:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:12:57,812:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:12:57,815:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:12:51,547:[Rank 0] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/model_world_size_8_rank_0.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  72%|███████▏  | 380/525 [52:50<3:12:26, 79.63s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:12:58,373:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/huggingface
[36m(TaskRunner pid=2922365)[0m step:378 - global_seqlen/min:21875 - global_seqlen/max:36892 - global_seqlen/minmax_diff:15017 - global_seqlen/balanced_min:27625 - global_seqlen/balanced_max:29176 - global_seqlen/mean:28012.625 - actor/entropy:0.03970404714345932 - actor/kl_loss:2.2434896770864725 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.12767505273222923 - actor/pg_clipfrac:0.03685517269186676 - actor/ppo_kl:0.07638504756614566 - actor/pg_clipfrac_lower:0.0044100219733081755 - actor/grad_norm:19.59352707862854 - perf/mfu/actor:0.08201177293267807 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.63894271850586 - actor/lr:1e-06 - training/global_step:378 - training/epoch:1 - critic/score/mean:0.8299999237060547 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8299999237060547 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.22764210402965546 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.22764210402965546 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:290.47186279296875 - response_length/max:2048.0 - response_length/min:55.0 - response_length/clip_ratio:0.08124999701976776 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.542517364025116e-05 - timing_s/generate_sequences:63.335411071777344 - timing_s/reshard:0.6490221619606018 - timing_s/gen:66.21371682360768 - timing_s/reward:0.0662875585258007 - timing_s/old_log_prob:1.2441408690065145 - timing_s/ref:1.4053348749876022 - timing_s/adv:0.007345236837863922 - timing_s/update_actor:7.394328910857439 - timing_s/step:76.34480198659003 - timing_s/stop_profile:4.5474618673324585e-05 - timing_per_token_ms/adv:3.2776457212881344e-05 - timing_per_token_ms/gen:0.7123507743177339 - timing_per_token_ms/ref:0.006270988862109505 - timing_per_token_ms/update_actor:0.03299551947941972 - perf/total_num_tokens:224101 - perf/time_per_step:76.34480198659003 - perf/throughput:366.9224920502174
[36m(TaskRunner pid=2922365)[0m step:379 - global_seqlen/min:21174 - global_seqlen/max:40874 - global_seqlen/minmax_diff:19700 - global_seqlen/balanced_min:27278 - global_seqlen/balanced_max:27279 - global_seqlen/mean:27278.375 - actor/entropy:0.04074523225426674 - actor/kl_loss:2.3834520615637302 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10318603925406933 - actor/pg_clipfrac:0.012433167884591968 - actor/ppo_kl:-0.0793666517274687 - actor/pg_clipfrac_lower:0.001052304939366877 - actor/grad_norm:22.082735776901245 - perf/mfu/actor:0.07919672975547207 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.57706069946289 - actor/lr:1e-06 - training/global_step:379 - training/epoch:1 - critic/score/mean:0.8856250643730164 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8856250643730164 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.358968585729599 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.358968585729599 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:272.4437561035156 - response_length/max:2048.0 - response_length/min:54.0 - response_length/clip_ratio:0.07500000298023224 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.156949818134308e-05 - timing_s/generate_sequences:63.17622375488281 - timing_s/reshard:0.6970920562744141 - timing_s/gen:65.50513617135584 - timing_s/reward:0.06592022068798542 - timing_s/old_log_prob:1.2603357825428247 - timing_s/ref:1.4053909238427877 - timing_s/adv:0.0075270794332027435 - timing_s/update_actor:7.442253544926643 - timing_s/step:75.69967234693468 - timing_s/stop_profile:4.206225275993347e-05 - timing_per_token_ms/adv:3.449197135644418e-05 - timing_per_token_ms/gen:0.7513607874487376 - timing_per_token_ms/ref:0.006440041442364088 - timing_per_token_ms/update_actor:0.03410326652946997 - perf/total_num_tokens:218227 - perf/time_per_step:75.69967234693468 - perf/throughput:360.34997450163456
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380
[36m(TaskRunner pid=2922365)[0m step:380 - global_seqlen/min:22057 - global_seqlen/max:36420 - global_seqlen/minmax_diff:14363 - global_seqlen/balanced_min:27013 - global_seqlen/balanced_max:28709 - global_seqlen/mean:27443.625 - actor/entropy:0.03915955126285553 - actor/kl_loss:2.2092191226780415 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23431546688079835 - actor/pg_clipfrac:0.033576986636035144 - actor/ppo_kl:0.04629204067750834 - actor/pg_clipfrac_lower:0.004173212515888735 - actor/grad_norm:18.783793449401855 - perf/mfu/actor:0.07830379153400933 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.63788986206055 - actor/lr:1e-06 - training/global_step:380 - training/epoch:1 - critic/score/mean:0.854687511920929 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.854687511920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4759843647480011 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4759843647480011 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:276.68438720703125 - response_length/max:2048.0 - response_length/min:62.0 - response_length/clip_ratio:0.08124999701976776 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.006393909454346e-05 - timing_s/generate_sequences:63.27384567260742 - timing_s/reshard:0.6426292061805725 - timing_s/gen:65.54450327530503 - timing_s/reward:0.06573609635233879 - timing_s/old_log_prob:1.2325499150902033 - timing_s/ref:1.3811986092478037 - timing_s/adv:0.007428919896483421 - timing_s/update_actor:7.582910746335983 - timing_s/save_checkpoint:10.731467423960567 - timing_s/step:86.55894787050784 - timing_s/stop_profile:4.9052760004997253e-05 - timing_per_token_ms/adv:3.383718393836192e-05 - timing_per_token_ms/gen:0.7402896268910314 - timing_per_token_ms/ref:0.006291072194579814 - timing_per_token_ms/update_actor:0.03453858020913775 - perf/total_num_tokens:219549 - perf/time_per_step:86.55894787050784 - perf/throughput:317.05127748382125
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  73%|███████▎  | 381/525 [54:06<3:08:11, 78.41s/it]
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 01:12:58,144:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/optim_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 01:12:58,146:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_380/actor/extra_state_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  73%|███████▎  | 382/525 [55:20<3:03:34, 77.02s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  73%|███████▎  | 383/525 [56:35<3:00:47, 76.39s/it]
[36m(TaskRunner pid=2922365)[0m step:381 - global_seqlen/min:22628 - global_seqlen/max:36771 - global_seqlen/minmax_diff:14143 - global_seqlen/balanced_min:28868 - global_seqlen/balanced_max:28869 - global_seqlen/mean:28868.125 - actor/entropy:0.033462971448898315 - actor/kl_loss:2.371759755909443 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.15411730408668517 - actor/pg_clipfrac:0.035471655311994255 - actor/ppo_kl:-0.08318975132424385 - actor/pg_clipfrac_lower:0.007563893520273268 - actor/grad_norm:21.142495155334473 - perf/mfu/actor:0.08059108702714249 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.7403564453125 - actor/lr:1e-06 - training/global_step:381 - training/epoch:1 - critic/score/mean:0.8515625 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8515625 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5088544487953186 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5088544487953186 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:312.953125 - response_length/max:2048.0 - response_length/min:41.0 - response_length/clip_ratio:0.10000000149011612 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.320435881614685e-05 - timing_s/generate_sequences:62.880279541015625 - timing_s/reshard:0.6547363996505737 - timing_s/gen:64.91208004765213 - timing_s/reward:0.06804353930056095 - timing_s/old_log_prob:1.3635808005928993 - timing_s/ref:1.4226233717054129 - timing_s/adv:0.00751882791519165 - timing_s/update_actor:7.780954262241721 - timing_s/step:75.56790423579514 - timing_s/stop_profile:4.0473416447639465e-05 - timing_per_token_ms/adv:3.255679021062006e-05 - timing_per_token_ms/gen:0.6481809381162527 - timing_per_token_ms/ref:0.006160009403561077 - timing_per_token_ms/update_actor:0.03369180654372998 - perf/total_num_tokens:230945 - perf/time_per_step:75.56790423579514 - perf/throughput:382.0156889613156
[36m(TaskRunner pid=2922365)[0m step:382 - global_seqlen/min:20322 - global_seqlen/max:25247 - global_seqlen/minmax_diff:4925 - global_seqlen/balanced_min:22911 - global_seqlen/balanced_max:22912 - global_seqlen/mean:22911.5 - actor/entropy:0.05607237294316292 - actor/kl_loss:2.611928863823414 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1344454690814018 - actor/pg_clipfrac:0.03981790104880929 - actor/ppo_kl:0.07937920298427344 - actor/pg_clipfrac_lower:0.00805783064570278 - actor/grad_norm:22.01770853996277 - perf/mfu/actor:0.06869124867958436 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.75136184692383 - actor/lr:1e-06 - training/global_step:382 - training/epoch:1 - critic/score/mean:1.0325000286102295 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0325000286102295 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.48140278458595276 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.48140278458595276 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:164.14688110351562 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.02500000037252903 - prompt_length/mean:408.640625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.222460746765137e-05 - timing_s/generate_sequences:49.57027816772461 - timing_s/reshard:0.6670112013816833 - timing_s/gen:64.06502915173769 - timing_s/reward:0.05817097797989845 - timing_s/old_log_prob:1.153906885534525 - timing_s/ref:1.360084768384695 - timing_s/adv:0.0076192207634449005 - timing_s/update_actor:7.113141750916839 - timing_s/step:73.77117996290326 - timing_s/stop_profile:4.3779611587524414e-05 - timing_per_token_ms/adv:4.156875784783242e-05 - timing_per_token_ms/gen:1.2196590163485006 - timing_per_token_ms/ref:0.007420317135416139 - timing_per_token_ms/update_actor:0.038807704378351696 - perf/total_num_tokens:183292 - perf/time_per_step:73.77117996290326 - perf/throughput:310.57521394562656
[36m(TaskRunner pid=2922365)[0m step:383 - global_seqlen/min:20651 - global_seqlen/max:36569 - global_seqlen/minmax_diff:15918 - global_seqlen/balanced_min:25170 - global_seqlen/balanced_max:26747 - global_seqlen/mean:25958.5 - actor/entropy:0.03905951604247093 - actor/kl_loss:2.2455847948789596 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.27505090050399306 - actor/pg_clipfrac:0.04260224163590465 - actor/ppo_kl:-0.05798184290761128 - actor/pg_clipfrac_lower:0.0034431315783876927 - actor/grad_norm:17.49773120880127 - perf/mfu/actor:0.0759045778641026 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.70911407470703 - actor/lr:1e-06 - training/global_step:383 - training/epoch:1 - critic/score/mean:0.9431250691413879 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9431250691413879 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.37720534205436707 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.37720534205436707 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:239.77499389648438 - response_length/max:2048.0 - response_length/min:51.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.514577686786652e-05 - timing_s/generate_sequences:61.67884826660156 - timing_s/reshard:0.6460534334182739 - timing_s/gen:64.66280279494822 - timing_s/reward:0.0644141174852848 - timing_s/old_log_prob:1.2057099658995867 - timing_s/ref:1.376099269837141 - timing_s/adv:0.0074079930782318115 - timing_s/update_actor:7.36814440228045 - timing_s/step:74.69762004166842 - timing_s/stop_profile:5.467049777507782e-05 - timing_per_token_ms/adv:3.5672289800218673e-05 - timing_per_token_ms/gen:0.8427536596151108 - timing_per_token_ms/ref:0.00662643868981808 - timing_per_token_ms/update_actor:0.035480403347075376 - perf/total_num_tokens:207668 - perf/time_per_step:74.69762004166842 - perf/throughput:347.5144186055677
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  73%|███████▎  | 384/525 [57:49<2:58:08, 75.80s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  73%|███████▎  | 385/525 [59:03<2:55:16, 75.12s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  74%|███████▎  | 386/525 [1:00:18<2:54:03, 75.13s/it]
[36m(TaskRunner pid=2922365)[0m step:384 - global_seqlen/min:21055 - global_seqlen/max:28566 - global_seqlen/minmax_diff:7511 - global_seqlen/balanced_min:23010 - global_seqlen/balanced_max:24708 - global_seqlen/mean:23445.5 - actor/entropy:0.05103065446019173 - actor/kl_loss:2.4787326127290727 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09336086548864841 - actor/pg_clipfrac:0.03841273137368262 - actor/ppo_kl:0.005031858524307609 - actor/pg_clipfrac_lower:0.002753785316599533 - actor/grad_norm:13.791911840438843 - perf/mfu/actor:0.07001968566967495 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.63463973999023 - actor/lr:1e-06 - training/global_step:384 - training/epoch:1 - critic/score/mean:0.9325000643730164 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9325000643730164 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.40106526017189026 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.40106526017189026 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:176.5124969482422 - response_length/max:2048.0 - response_length/min:48.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.102133870124817e-05 - timing_s/generate_sequences:60.364990234375 - timing_s/reshard:0.6323115229606628 - timing_s/gen:64.66153522208333 - timing_s/reward:0.06032129190862179 - timing_s/old_log_prob:1.1204440034925938 - timing_s/ref:1.3945405948907137 - timing_s/adv:0.008193299174308777 - timing_s/update_actor:7.1520383246243 - timing_s/step:74.41025617159903 - timing_s/stop_profile:4.451349377632141e-05 - timing_per_token_ms/adv:4.368268523975164e-05 - timing_per_token_ms/gen:1.1447761352256096 - timing_per_token_ms/ref:0.007435012021980303 - timing_per_token_ms/update_actor:0.03813118895216726 - perf/total_num_tokens:187564 - perf/time_per_step:74.41025617159903 - perf/throughput:315.0842532504101
[36m(TaskRunner pid=2922365)[0m step:385 - global_seqlen/min:20506 - global_seqlen/max:32137 - global_seqlen/minmax_diff:11631 - global_seqlen/balanced_min:24821 - global_seqlen/balanced_max:24821 - global_seqlen/mean:24821.0 - actor/entropy:0.04283655807375908 - actor/kl_loss:2.462598258256912 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.0981598341371864 - actor/pg_clipfrac:0.04061668768990785 - actor/ppo_kl:-0.037270799302496015 - actor/pg_clipfrac_lower:0.002084728569025174 - actor/grad_norm:15.922844886779785 - perf/mfu/actor:0.07241655362813423 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.51226425170898 - actor/lr:1e-06 - training/global_step:385 - training/epoch:1 - critic/score/mean:0.90562504529953 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.90562504529953 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.33316299319267273 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.33316299319267273 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:211.22811889648438 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.835271000862122e-05 - timing_s/generate_sequences:48.39732360839844 - timing_s/reshard:0.6477882266044617 - timing_s/gen:63.44425864703953 - timing_s/reward:0.06246875785291195 - timing_s/old_log_prob:1.237933672964573 - timing_s/ref:1.3807829823344946 - timing_s/adv:0.00823395885527134 - timing_s/update_actor:7.359736938029528 - timing_s/step:73.51093820296228 - timing_s/stop_profile:4.309229552745819e-05 - timing_per_token_ms/adv:4.146669581841656e-05 - timing_per_token_ms/gen:0.9386217307567283 - timing_per_token_ms/ref:0.006953703428218517 - timing_per_token_ms/update_actor:0.037064063383976914 - perf/total_num_tokens:198568 - perf/time_per_step:73.51093820296228 - perf/throughput:337.650431442865
[36m(TaskRunner pid=2922365)[0m step:386 - global_seqlen/min:20215 - global_seqlen/max:35890 - global_seqlen/minmax_diff:15675 - global_seqlen/balanced_min:22880 - global_seqlen/balanced_max:24519 - global_seqlen/mean:23290.125 - actor/entropy:0.04980870708823204 - actor/kl_loss:2.4442258432507513 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.027615061774849892 - actor/pg_clipfrac:0.03508329205214977 - actor/ppo_kl:-0.05865798213053495 - actor/pg_clipfrac_lower:0.0027749835047870875 - actor/grad_norm:17.80900001525879 - perf/mfu/actor:0.07125853587589426 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.79790878295898 - actor/lr:1e-06 - training/global_step:386 - training/epoch:2 - critic/score/mean:0.9493749737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9493749737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.33898869156837463 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.33898869156837463 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:172.3000030517578 - response_length/max:2048.0 - response_length/min:38.0 - response_length/clip_ratio:0.03125 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.0003264099359512329 - timing_s/generate_sequences:35.01396942138672 - timing_s/reshard:0.7385817766189575 - timing_s/gen:63.21008316427469 - timing_s/reward:0.060865916311740875 - timing_s/old_log_prob:1.1265051905065775 - timing_s/ref:1.3657972402870655 - timing_s/adv:0.009040940552949905 - timing_s/update_actor:6.97950872220099 - timing_s/step:72.78359420411289 - timing_s/stop_profile:4.1931867599487305e-05 - timing_per_token_ms/adv:4.852346516468839e-05 - timing_per_token_ms/gen:1.1464394073613373 - timing_per_token_ms/ref:0.007330345158554675 - timing_per_token_ms/update_actor:0.037459592435640586 - perf/total_num_tokens:186321 - perf/time_per_step:72.78359420411289 - perf/throughput:319.99141090347405
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  74%|███████▎  | 387/525 [1:01:31<2:51:22, 74.51s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  74%|███████▍  | 388/525 [1:02:45<2:49:42, 74.32s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  74%|███████▍  | 389/525 [1:03:54<2:44:38, 72.64s/it]
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 01:25:13,142:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=2923973)[0m INFO:2025-08-05 01:25:19,556:[Rank 3] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/optim_world_size_8_rank_3.pt
[36m(WorkerDict pid=2923973)[0m INFO:2025-08-05 01:25:19,558:[Rank 3] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/extra_state_world_size_8_rank_3.pt
[36m(WorkerDict pid=2923977)[0m INFO:2025-08-05 01:25:13,508:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/model_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m step:387 - global_seqlen/min:20667 - global_seqlen/max:24403 - global_seqlen/minmax_diff:3736 - global_seqlen/balanced_min:21498 - global_seqlen/balanced_max:23067 - global_seqlen/mean:22282.125 - actor/entropy:0.064773790538311 - actor/kl_loss:2.4864784643054008 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.03165038600564003 - actor/pg_clipfrac:0.019121205143164843 - actor/ppo_kl:0.02575768911046907 - actor/pg_clipfrac_lower:0.0 - actor/grad_norm:12.928524851799011 - perf/mfu/actor:0.06697772779257467 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.86775970458984 - actor/lr:1e-06 - training/global_step:387 - training/epoch:2 - critic/score/mean:0.934374988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.934374988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2929333448410034 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.2929333448410034 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:147.53750610351562 - response_length/max:2048.0 - response_length/min:38.0 - response_length/clip_ratio:0.012500000186264515 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.618272840976715e-05 - timing_s/generate_sequences:46.69667053222656 - timing_s/reshard:0.6813747882843018 - timing_s/gen:63.19992191530764 - timing_s/reward:0.05844375677406788 - timing_s/old_log_prob:1.1820585504174232 - timing_s/ref:1.3684095367789268 - timing_s/adv:0.008175492286682129 - timing_s/update_actor:7.066904431208968 - timing_s/step:72.9049995020032 - timing_s/stop_profile:4.439614713191986e-05 - timing_per_token_ms/adv:4.586351327960264e-05 - timing_per_token_ms/gen:1.3386410640368474 - timing_per_token_ms/ref:0.007676610381521774 - timing_per_token_ms/update_actor:0.039644470798953016 - perf/total_num_tokens:178257 - perf/time_per_step:72.9049995020032 - perf/throughput:305.6323318318898
[36m(TaskRunner pid=2922365)[0m step:388 - global_seqlen/min:19869 - global_seqlen/max:24907 - global_seqlen/minmax_diff:5038 - global_seqlen/balanced_min:21135 - global_seqlen/balanced_max:22766 - global_seqlen/mean:21950.5 - actor/entropy:0.06569444388151169 - actor/kl_loss:2.4151968613266943 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.14199315756559372 - actor/pg_clipfrac:0.0370817864080891 - actor/ppo_kl:-0.04535838395822793 - actor/pg_clipfrac_lower:0.008129106450360269 - actor/grad_norm:16.471420288085938 - perf/mfu/actor:0.06712277429705774 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.79207229614258 - actor/lr:1e-06 - training/global_step:388 - training/epoch:2 - critic/score/mean:0.9175000190734863 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9175000190734863 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.30921822786331177 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.30921822786331177 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:139.6843719482422 - response_length/max:2048.0 - response_length/min:54.0 - response_length/clip_ratio:0.012500000186264515 - prompt_length/mean:409.078125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.117461740970612e-05 - timing_s/generate_sequences:34.971710205078125 - timing_s/reshard:0.6440957188606262 - timing_s/gen:64.35985105857253 - timing_s/reward:0.05838773772120476 - timing_s/old_log_prob:1.1222426518797874 - timing_s/ref:1.354850098490715 - timing_s/adv:0.00811285711824894 - timing_s/update_actor:6.947419976815581 - timing_s/step:73.86630669981241 - timing_s/stop_profile:4.8298388719558716e-05 - timing_per_token_ms/adv:4.6199728470017424e-05 - timing_per_token_ms/gen:1.4398499084671363 - timing_per_token_ms/ref:0.00771537150913826 - timing_per_token_ms/update_actor:0.03956299387722137 - perf/total_num_tokens:175604 - perf/time_per_step:73.86630669981241 - perf/throughput:297.1652568092422
[36m(TaskRunner pid=2922365)[0m step:389 - global_seqlen/min:20518 - global_seqlen/max:23154 - global_seqlen/minmax_diff:2636 - global_seqlen/balanced_min:21039 - global_seqlen/balanced_max:22682 - global_seqlen/mean:21449.875 - actor/entropy:0.07532279193401337 - actor/kl_loss:2.4747855067253113 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0060519929975271225 - actor/pg_clipfrac:0.03301222180016339 - actor/ppo_kl:0.032596435106825083 - actor/pg_clipfrac_lower:0.004189964529359713 - actor/grad_norm:17.736511945724487 - perf/mfu/actor:0.06501250867706512 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.75837707519531 - actor/lr:1e-06 - training/global_step:389 - training/epoch:2 - critic/score/mean:0.9806249737739563 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9806249737739563 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.1579136848449707 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.1579136848449707 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:126.84062194824219 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.0062500000931322575 - prompt_length/mean:409.40625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.109079837799072e-05 - timing_s/generate_sequences:34.57295227050781 - timing_s/reshard:0.6256747841835022 - timing_s/gen:59.10899475030601 - timing_s/reward:0.0568748377263546 - timing_s/old_log_prob:1.144322395324707 - timing_s/ref:1.3556794542819262 - timing_s/adv:0.007912153378129005 - timing_s/update_actor:6.993101730942726 - timing_s/step:68.6822623219341 - timing_s/stop_profile:4.3800100684165955e-05 - timing_per_token_ms/adv:4.6108388616070055e-05 - timing_per_token_ms/gen:1.4562811291311935 - timing_per_token_ms/ref:0.007900275958962035 - timing_per_token_ms/update_actor:0.04075257857529896 - perf/total_num_tokens:171599 - perf/time_per_step:68.6822623219341 - perf/throughput:312.3058891021685
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  74%|███████▍  | 390/525 [1:05:13<2:47:47, 74.58s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:25:20,515:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/huggingface
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  74%|███████▍  | 391/525 [1:06:27<2:46:18, 74.47s/it]
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 01:25:20,009:[Rank 5] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/optim_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923975)[0m INFO:2025-08-05 01:25:20,010:[Rank 5] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_390/actor/extra_state_world_size_8_rank_5.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  75%|███████▍  | 392/525 [1:07:41<2:44:43, 74.31s/it]
[36m(TaskRunner pid=2922365)[0m step:390 - global_seqlen/min:20371 - global_seqlen/max:22368 - global_seqlen/minmax_diff:1997 - global_seqlen/balanced_min:20927 - global_seqlen/balanced_max:22663 - global_seqlen/mean:21144.5 - actor/entropy:0.08237221091985703 - actor/kl_loss:2.482451817393303 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.05455111302435398 - actor/pg_clipfrac:0.03030165082309395 - actor/ppo_kl:0.024176675593480468 - actor/pg_clipfrac_lower:0.004208321601618081 - actor/grad_norm:18.012646913528442 - perf/mfu/actor:0.06411548174387827 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.7942008972168 - actor/lr:1e-06 - training/global_step:390 - training/epoch:2 - critic/score/mean:0.9565625190734863 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9565625190734863 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.08813201636075974 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.08813201636075974 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:118.98750305175781 - response_length/max:2048.0 - response_length/min:47.0 - response_length/clip_ratio:0.0031250000465661287 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.645281195640564e-05 - timing_s/generate_sequences:21.709095001220703 - timing_s/reshard:0.6326213479042053 - timing_s/gen:58.47133174352348 - timing_s/reward:0.05646968260407448 - timing_s/old_log_prob:1.1596432980149984 - timing_s/ref:1.3561722226440907 - timing_s/adv:0.008069895207881927 - timing_s/update_actor:6.977863201871514 - timing_s/save_checkpoint:11.039590295404196 - timing_s/step:79.08577275834978 - timing_s/stop_profile:5.021505057811737e-05 - timing_per_token_ms/adv:4.770682215163475e-05 - timing_per_token_ms/gen:1.5356479604875375 - timing_per_token_ms/ref:0.008017287135213002 - timing_per_token_ms/update_actor:0.04125105347650402 - perf/total_num_tokens:169156 - perf/time_per_step:79.08577275834978 - perf/throughput:267.3616159079332
[36m(TaskRunner pid=2922365)[0m step:391 - global_seqlen/min:20193 - global_seqlen/max:25077 - global_seqlen/minmax_diff:4884 - global_seqlen/balanced_min:21215 - global_seqlen/balanced_max:22708 - global_seqlen/mean:22520.625 - actor/entropy:0.05955246835947037 - actor/kl_loss:2.69272386431694 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.038042318820953366 - actor/pg_clipfrac:0.02345446338877082 - actor/ppo_kl:-0.03198663911316544 - actor/pg_clipfrac_lower:0.0006610450567677617 - actor/grad_norm:15.25331735610962 - perf/mfu/actor:0.06813348480429998 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.87945938110352 - actor/lr:1e-06 - training/global_step:391 - training/epoch:2 - critic/score/mean:0.9690625071525574 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9690625071525574 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2831197679042816 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.2831197679042816 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:153.71875 - response_length/max:2048.0 - response_length/min:48.0 - response_length/clip_ratio:0.02187499962747097 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.244494140148163e-05 - timing_s/generate_sequences:48.443355560302734 - timing_s/reshard:0.6805067658424377 - timing_s/gen:64.61731015890837 - timing_s/reward:0.057856421917676926 - timing_s/old_log_prob:1.1028030160814524 - timing_s/ref:1.3586055263876915 - timing_s/adv:0.007931262254714966 - timing_s/update_actor:7.040359973907471 - timing_s/step:74.20098954811692 - timing_s/stop_profile:4.375725984573364e-05 - timing_per_token_ms/adv:4.4022214385230014e-05 - timing_per_token_ms/gen:1.3136269599290173 - timing_per_token_ms/ref:0.007540895991939009 - timing_per_token_ms/update_actor:0.03907729011687881 - perf/total_num_tokens:180165 - perf/time_per_step:74.20098954811692 - perf/throughput:303.50841864980936
[36m(TaskRunner pid=2922365)[0m step:392 - global_seqlen/min:20317 - global_seqlen/max:23110 - global_seqlen/minmax_diff:2793 - global_seqlen/balanced_min:20986 - global_seqlen/balanced_max:22668 - global_seqlen/mean:21617.25 - actor/entropy:0.07780485600233078 - actor/kl_loss:2.6886091083288193 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.07814503852277994 - actor/pg_clipfrac:0.023847899958491327 - actor/ppo_kl:0.056985893240198496 - actor/pg_clipfrac_lower:0.0023635843535885215 - actor/grad_norm:15.937970876693726 - perf/mfu/actor:0.06607703658773921 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.0260238647461 - actor/lr:1e-06 - training/global_step:392 - training/epoch:2 - critic/score/mean:0.9599999189376831 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9599999189376831 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.15802551805973053 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.15802551805973053 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:131.57186889648438 - response_length/max:2048.0 - response_length/min:40.0 - response_length/clip_ratio:0.00937500037252903 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010203570127487183 - timing_s/generate_sequences:34.98085021972656 - timing_s/reshard:0.6736863851547241 - timing_s/gen:64.39922654442489 - timing_s/reward:0.05635121650993824 - timing_s/old_log_prob:1.0588988326489925 - timing_s/ref:1.3636152409017086 - timing_s/adv:0.008720727637410164 - timing_s/update_actor:6.938945962116122 - timing_s/step:73.841337967664 - timing_s/stop_profile:4.481896758079529e-05 - timing_per_token_ms/adv:5.042690234309501e-05 - timing_per_token_ms/gen:1.5295638444867323 - timing_per_token_ms/ref:0.007884994858861029 - timing_per_token_ms/update_actor:0.04012389389328038 - perf/total_num_tokens:172938 - perf/time_per_step:73.841337967664 - perf/throughput:292.7526856226041
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  75%|███████▍  | 393/525 [1:08:55<2:43:21, 74.25s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  75%|███████▌  | 394/525 [1:10:10<2:42:52, 74.60s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  75%|███████▌  | 395/525 [1:11:26<2:42:33, 75.03s/it]
[36m(TaskRunner pid=2922365)[0m step:393 - global_seqlen/min:20229 - global_seqlen/max:25418 - global_seqlen/minmax_diff:5189 - global_seqlen/balanced_min:21318 - global_seqlen/balanced_max:22995 - global_seqlen/mean:22368.125 - actor/entropy:0.07635384052991867 - actor/kl_loss:2.678935815393925 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12810629718005656 - actor/pg_clipfrac:0.033564756764099 - actor/ppo_kl:0.029510636668419465 - actor/pg_clipfrac_lower:0.003919391427189112 - actor/grad_norm:17.780709266662598 - perf/mfu/actor:0.06816634734654431 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.9425163269043 - actor/lr:1e-06 - training/global_step:393 - training/epoch:2 - critic/score/mean:0.8740624189376831 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8740624189376831 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.25761479139328003 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.25761479139328003 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.78885018825531 - response_length/mean:149.46875 - response_length/max:2048.0 - response_length/min:50.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.381584823131561e-05 - timing_s/generate_sequences:47.99535369873047 - timing_s/reshard:0.6296371221542358 - timing_s/gen:64.55406989343464 - timing_s/reward:0.05834837816655636 - timing_s/old_log_prob:1.1273911409080029 - timing_s/ref:1.3594781458377838 - timing_s/adv:0.007913202047348022 - timing_s/update_actor:6.977190682664514 - timing_s/step:74.10067740827799 - timing_s/stop_profile:4.560500383377075e-05 - timing_per_token_ms/adv:4.42214202539776e-05 - timing_per_token_ms/gen:1.3496564895135823 - timing_per_token_ms/ref:0.007597184307121092 - timing_per_token_ms/update_actor:0.038990699280027456 - perf/total_num_tokens:178945 - perf/time_per_step:74.10067740827799 - perf/throughput:301.8612755286525
[36m(TaskRunner pid=2922365)[0m step:394 - global_seqlen/min:20974 - global_seqlen/max:31559 - global_seqlen/minmax_diff:10585 - global_seqlen/balanced_min:23723 - global_seqlen/balanced_max:25205 - global_seqlen/mean:25019.0 - actor/entropy:0.05273893475532532 - actor/kl_loss:2.5851791903376578 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.030101797357201577 - actor/pg_clipfrac:0.03579083080403507 - actor/ppo_kl:-0.11795485870679841 - actor/pg_clipfrac_lower:0.001955312141217291 - actor/grad_norm:16.102452516555786 - perf/mfu/actor:0.07334976568402451 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.94706726074219 - actor/lr:1e-06 - training/global_step:394 - training/epoch:2 - critic/score/mean:0.8746875524520874 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8746875524520874 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.40449002385139465 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.40449002385139465 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:215.85000610351562 - response_length/max:2048.0 - response_length/min:50.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010556913912296295 - timing_s/generate_sequences:63.18699264526367 - timing_s/reshard:0.6630491614341736 - timing_s/gen:65.04139760136604 - timing_s/reward:0.06324299983680248 - timing_s/old_log_prob:1.1686817109584808 - timing_s/ref:1.37490613758564 - timing_s/adv:0.007940556854009628 - timing_s/update_actor:7.324170783162117 - timing_s/step:74.99675428681076 - timing_s/stop_profile:4.6508386731147766e-05 - timing_per_token_ms/adv:3.967263306891577e-05 - timing_per_token_ms/gen:0.9416463632349729 - timing_per_token_ms/ref:0.006869310012318838 - timing_per_token_ms/update_actor:0.03659304320297632 - perf/total_num_tokens:200152 - perf/time_per_step:74.99675428681076 - perf/throughput:333.601103646694
[36m(TaskRunner pid=2922365)[0m step:395 - global_seqlen/min:21975 - global_seqlen/max:37381 - global_seqlen/minmax_diff:15406 - global_seqlen/balanced_min:25264 - global_seqlen/balanced_max:26878 - global_seqlen/mean:26272.75 - actor/entropy:0.040027230978012085 - actor/kl_loss:2.267763548344374 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02721259593963623 - actor/pg_clipfrac:0.03685591835528612 - actor/ppo_kl:-0.1178481638780795 - actor/pg_clipfrac_lower:0.000864668661961332 - actor/grad_norm:17.863049507141113 - perf/mfu/actor:0.07851866647284743 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.98492813110352 - actor/lr:1e-06 - training/global_step:395 - training/epoch:2 - critic/score/mean:0.8728124499320984 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8728124499320984 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5009204745292664 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5009204745292664 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:247.19375610351562 - response_length/max:2048.0 - response_length/min:54.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011104904115200043 - timing_s/generate_sequences:62.397666931152344 - timing_s/reshard:0.6503293514251709 - timing_s/gen:65.72571366839111 - timing_s/reward:0.06426394358277321 - timing_s/old_log_prob:1.229679087176919 - timing_s/ref:1.3824430461972952 - timing_s/adv:0.00796249508857727 - timing_s/update_actor:7.225929792970419 - timing_s/step:75.65254858136177 - timing_s/stop_profile:4.0257349610328674e-05 - timing_per_token_ms/adv:3.7883810643048744e-05 - timing_per_token_ms/gen:0.8308982537532693 - timing_per_token_ms/ref:0.006577361744570397 - timing_per_token_ms/update_actor:0.034379394015521876 - perf/total_num_tokens:210182 - perf/time_per_step:75.65254858136177 - perf/throughput:347.2817570943369
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  75%|███████▌  | 396/525 [1:12:41<2:41:13, 74.99s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  76%|███████▌  | 397/525 [1:13:56<2:40:06, 75.05s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  76%|███████▌  | 398/525 [1:15:11<2:38:49, 75.04s/it]
[36m(TaskRunner pid=2922365)[0m step:396 - global_seqlen/min:20437 - global_seqlen/max:29318 - global_seqlen/minmax_diff:8881 - global_seqlen/balanced_min:25667 - global_seqlen/balanced_max:25668 - global_seqlen/mean:25667.125 - actor/entropy:0.05044649541378021 - actor/kl_loss:2.250942660868168 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1268355721142143 - actor/pg_clipfrac:0.03457440725760534 - actor/ppo_kl:-0.1897080739494413 - actor/pg_clipfrac_lower:0.010094257097807712 - actor/grad_norm:16.64805829524994 - perf/mfu/actor:0.07538297484680795 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.89961624145508 - actor/lr:1e-06 - training/global_step:396 - training/epoch:2 - critic/score/mean:0.9153125882148743 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9153125882148743 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5260239243507385 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5260239243507385 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:231.94375610351562 - response_length/max:2048.0 - response_length/min:36.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.769147098064423e-05 - timing_s/generate_sequences:63.02114486694336 - timing_s/reshard:0.6536592245101929 - timing_s/gen:64.9020721707493 - timing_s/reward:0.06403262540698051 - timing_s/old_log_prob:1.1809243150055408 - timing_s/ref:1.3891461845487356 - timing_s/adv:0.008070526644587517 - timing_s/update_actor:7.315850595012307 - timing_s/step:74.87590593844652 - timing_s/stop_profile:5.905143916606903e-05 - timing_per_token_ms/adv:3.9303811025716345e-05 - timing_per_token_ms/gen:0.8744317341320539 - timing_per_token_ms/ref:0.006765201520177735 - timing_per_token_ms/update_actor:0.03562850628485031 - perf/total_num_tokens:205337 - perf/time_per_step:74.87590593844652 - perf/throughput:342.79551850898815
[36m(TaskRunner pid=2922365)[0m step:397 - global_seqlen/min:21976 - global_seqlen/max:32590 - global_seqlen/minmax_diff:10614 - global_seqlen/balanced_min:27401 - global_seqlen/balanced_max:28984 - global_seqlen/mean:27599.125 - actor/entropy:0.03705204278230667 - actor/kl_loss:2.214657922834158 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08781613446772099 - actor/pg_clipfrac:0.040211459854617715 - actor/ppo_kl:-0.23865854733157904 - actor/pg_clipfrac_lower:0.005153461653389968 - actor/grad_norm:19.19835889339447 - perf/mfu/actor:0.08024938782286714 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.95232009887695 - actor/lr:1e-06 - training/global_step:397 - training/epoch:2 - critic/score/mean:0.893750011920929 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.893750011920929 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5009490847587585 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5009490847587585 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:280.2437438964844 - response_length/max:2048.0 - response_length/min:31.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.648820221424103e-05 - timing_s/generate_sequences:63.19134521484375 - timing_s/reshard:0.6417681574821472 - timing_s/gen:64.99018769338727 - timing_s/reward:0.06665478646755219 - timing_s/old_log_prob:1.2768764235079288 - timing_s/ref:1.384864566847682 - timing_s/adv:0.007848236709833145 - timing_s/update_actor:7.4386922139674425 - timing_s/step:75.18232449702919 - timing_s/stop_profile:4.306621849536896e-05 - timing_per_token_ms/adv:3.554567721727204e-05 - timing_per_token_ms/gen:0.7247060337361144 - timing_per_token_ms/ref:0.006272230400636261 - timing_per_token_ms/update_actor:0.03369079732585473 - perf/total_num_tokens:220793 - perf/time_per_step:75.18232449702919 - perf/throughput:367.09592560004677
[36m(TaskRunner pid=2922365)[0m step:398 - global_seqlen/min:21630 - global_seqlen/max:34401 - global_seqlen/minmax_diff:12771 - global_seqlen/balanced_min:26090 - global_seqlen/balanced_max:27510 - global_seqlen/mean:27162.625 - actor/entropy:0.04298413172364235 - actor/kl_loss:2.2870054647326468 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.17382188141345978 - actor/pg_clipfrac:0.03216750249266624 - actor/ppo_kl:-0.05484400198511139 - actor/pg_clipfrac_lower:0.000561196985654533 - actor/grad_norm:22.6271812915802 - perf/mfu/actor:0.0795217984855783 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.85272216796875 - actor/lr:1e-06 - training/global_step:398 - training/epoch:2 - critic/score/mean:0.8628125190734863 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8628125190734863 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.6212216019630432 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.6212216019630432 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:269.11248779296875 - response_length/max:2048.0 - response_length/min:38.0 - response_length/clip_ratio:0.06875000149011612 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.027309715747833e-05 - timing_s/generate_sequences:63.34586715698242 - timing_s/reshard:0.6620035171508789 - timing_s/gen:64.8908572383225 - timing_s/reward:0.06703241541981697 - timing_s/old_log_prob:1.2539456821978092 - timing_s/ref:1.3884538505226374 - timing_s/adv:0.008026694878935814 - timing_s/update_actor:7.373788001015782 - timing_s/step:74.99929277598858 - timing_s/stop_profile:4.5282766222953796e-05 - timing_per_token_ms/adv:3.693814054668784e-05 - timing_per_token_ms/gen:0.7535284643773804 - timing_per_token_ms/ref:0.006389541928121073 - timing_per_token_ms/update_actor:0.033933520789208436 - perf/total_num_tokens:217301 - perf/time_per_step:74.99929277598858 - perf/throughput:362.1717484874238
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  76%|███████▌  | 399/525 [1:16:27<2:37:36, 75.06s/it]
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 01:38:59,467:[Rank 2] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/model_world_size_8_rank_2.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:39:05,989:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:39:05,991:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 01:38:59,999:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  76%|███████▌  | 400/525 [1:18:59<3:24:33, 98.18s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:39:06,578:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/huggingface
[36m(TaskRunner pid=2922365)[0m step:399 - global_seqlen/min:21281 - global_seqlen/max:32694 - global_seqlen/minmax_diff:11413 - global_seqlen/balanced_min:25456 - global_seqlen/balanced_max:25457 - global_seqlen/mean:25456.375 - actor/entropy:0.04527369514107704 - actor/kl_loss:2.2903599858284 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.01513214185833931 - actor/pg_clipfrac:0.036741474899463354 - actor/ppo_kl:-0.03168634405592456 - actor/pg_clipfrac_lower:0.0057600892148911955 - actor/grad_norm:15.974170207977295 - perf/mfu/actor:0.073688861576877 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.71875762939453 - actor/lr:1e-06 - training/global_step:399 - training/epoch:2 - critic/score/mean:1.0118749141693115 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:1.0118749141693115 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4138481318950653 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4138481318950653 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:227.1125030517578 - response_length/max:2048.0 - response_length/min:44.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:409.296875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.94591212272644e-05 - timing_s/generate_sequences:63.161705017089844 - timing_s/reshard:0.6399837732315063 - timing_s/gen:64.88756874203682 - timing_s/reward:0.06458995118737221 - timing_s/old_log_prob:1.2826643157750368 - timing_s/ref:1.3974885009229183 - timing_s/adv:0.00804031454026699 - timing_s/update_actor:7.42213274911046 - timing_s/step:75.07927655056119 - timing_s/stop_profile:4.715472459793091e-05 - timing_per_token_ms/adv:3.9480849788446854e-05 - timing_per_token_ms/gen:0.8928335178330786 - timing_per_token_ms/ref:0.006862173526881372 - timing_per_token_ms/update_actor:0.036445353811719365 - perf/total_num_tokens:203651 - perf/time_per_step:75.07927655056119 - perf/throughput:339.05993996701244
[36m(TaskRunner pid=2922365)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True, 'global_steps': 400}
[36m(TaskRunner pid=2922365)[0m validation generation end
[36m(TaskRunner pid=2922365)[0m [prompt] system
[36m(TaskRunner pid=2922365)[0m You are a helpful assistant.
[36m(TaskRunner pid=2922365)[0m user
[36m(TaskRunner pid=2922365)[0m You are a math teacher and now you need to complete a math multiple-choice question. Please put The thinking process in <think> thinking process </think>, and put the final chosen option in <answer>The answer is \boxed{capitalized option}.</answer>.
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m Solve the problem in the image.
[36m(TaskRunner pid=2922365)[0m assistant
[36m(TaskRunner pid=2922365)[0m 
[36m(TaskRunner pid=2922365)[0m [response] <think>
[36m(TaskRunner pid=2922365)[0m The problem involves a等轴双曲线$c$ with its center at the origin and foci on the x-axis. It intersects the parabola $y^2=16x$ at points A and B, with |AB|=4\sqrt{3}. We need to find the real axis length of the hyperbola. We can solve this by finding the value of a. </think>
[36m(TaskRunner pid=2922365)[0m <answer>The answer is \boxed{B}.</answer>
[36m(TaskRunner pid=2922365)[0m [ground_truth] C
[36m(TaskRunner pid=2922365)[0m [score] 0.6
[36m(TaskRunner pid=2922365)[0m len reward_extra_infos_dict['reward']: 100
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400
[36m(TaskRunner pid=2922365)[0m step:400 - global_seqlen/min:22031 - global_seqlen/max:31762 - global_seqlen/minmax_diff:9731 - global_seqlen/balanced_min:28237 - global_seqlen/balanced_max:28238 - global_seqlen/mean:28237.375 - actor/entropy:0.035550307482481 - actor/kl_loss:1.9318021766841411 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.16314108746591954 - actor/pg_clipfrac:0.05781645579263568 - actor/ppo_kl:-0.20317476345226168 - actor/pg_clipfrac_lower:0.0019016149919480086 - actor/grad_norm:23.788522481918335 - perf/mfu/actor:0.08116752035631489 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.75454330444336 - actor/lr:1e-06 - val-core/grpo_convert/reward/mean@50:0.7990000221878291 - val-aux/grpo_convert/reward/std@50:0.4181480098861518 - val-aux/grpo_convert/reward/best@2/mean:0.980300023689866 - val-aux/grpo_convert/reward/best@2/std:0.39578049138324545 - val-aux/grpo_convert/reward/worst@2/mean:0.6013500205166638 - val-aux/grpo_convert/reward/worst@2/std:0.33336276322544806 - val-aux/grpo_convert/reward/best@4/mean:1.1590000238418579 - val-aux/grpo_convert/reward/best@4/std:0.3554323182059266 - val-aux/grpo_convert/reward/worst@4/mean:0.46800001788884404 - val-aux/grpo_convert/reward/worst@4/std:0.2870982739456865 - val-aux/grpo_convert/reward/best@8/mean:1.2840000238418579 - val-aux/grpo_convert/reward/best@8/std:0.2971358523454968 - val-aux/grpo_convert/reward/worst@8/mean:0.3489500137530267 - val-aux/grpo_convert/reward/worst@8/std:0.2907794335780533 - val-aux/grpo_convert/reward/best@16/mean:1.4070000238418578 - val-aux/grpo_convert/reward/best@16/std:0.24341528300416965 - val-aux/grpo_convert/reward/worst@16/mean:0.19960000779479742 - val-aux/grpo_convert/reward/worst@16/std:0.2759142173995188 - val-aux/grpo_convert/reward/best@32/mean:1.533500023841858 - val-aux/grpo_convert/reward/best@32/std:0.16978736702122452 - val-aux/grpo_convert/reward/worst@32/mean:0.07155000277236104 - val-aux/grpo_convert/reward/worst@32/std:0.18715256480987452 - val-core/grpo_convert/reward/best@50/mean:1.579000023841858 - val-core/grpo_convert/reward/best@50/std:0.10029456615390486 - val-aux/grpo_convert/reward/worst@50/mean:0.023950000923126935 - val-aux/grpo_convert/reward/worst@50/std:0.11147802211783361 - training/global_step:400 - training/epoch:2 - critic/score/mean:0.8371874690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8371874690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5905660390853882 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5905660390853882 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:295.87188720703125 - response_length/max:2048.0 - response_length/min:36.0 - response_length/clip_ratio:0.07500000298023224 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010154396295547485 - timing_s/generate_sequences:63.54021072387695 - timing_s/reshard:0.6620047092437744 - timing_s/gen:65.28280622512102 - timing_s/reward:0.07061370089650154 - timing_s/old_log_prob:1.3459355160593987 - timing_s/ref:1.405707536265254 - timing_s/adv:0.007890470325946808 - timing_s/update_actor:7.523523777723312 - timing_s/testing:65.6997833698988 - timing_s/save_checkpoint:10.669523544609547 - timing_s/step:152.02279615402222 - timing_s/stop_profile:5.5285170674324036e-05 - timing_per_token_ms/adv:3.4929195463223864e-05 - timing_per_token_ms/gen:0.6895172765356734 - timing_per_token_ms/ref:0.006222725803413269 - timing_per_token_ms/update_actor:0.03330481222901966 - perf/total_num_tokens:225899 - perf/time_per_step:152.02279615402222 - perf/throughput:185.74434699511278
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  76%|███████▋  | 401/525 [1:20:15<3:09:21, 91.62s/it]
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 01:39:06,406:[Rank 4] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/optim_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 01:39:06,408:[Rank 4] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_400/actor/extra_state_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  77%|███████▋  | 402/525 [1:21:30<2:57:44, 86.71s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  77%|███████▋  | 403/525 [1:22:47<2:50:23, 83.80s/it]
[36m(TaskRunner pid=2922365)[0m step:401 - global_seqlen/min:21614 - global_seqlen/max:33851 - global_seqlen/minmax_diff:12237 - global_seqlen/balanced_min:26536 - global_seqlen/balanced_max:27777 - global_seqlen/mean:27311.875 - actor/entropy:0.040385790169239044 - actor/kl_loss:2.10955521017313 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.23863128200173378 - actor/pg_clipfrac:0.02514087735908106 - actor/ppo_kl:0.0070949462126009165 - actor/pg_clipfrac_lower:0.0031690698000602425 - actor/grad_norm:19.669785499572754 - perf/mfu/actor:0.07942793872065856 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.95619583129883 - actor/lr:1e-06 - training/global_step:401 - training/epoch:2 - critic/score/mean:0.918749988079071 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.918749988079071 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5750699043273926 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5750699043273926 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:273.9375 - response_length/max:2048.0 - response_length/min:44.0 - response_length/clip_ratio:0.06562499701976776 - prompt_length/mean:408.859375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.14627856016159e-05 - timing_s/generate_sequences:63.31013488769531 - timing_s/reshard:0.5922776460647583 - timing_s/gen:66.09939793497324 - timing_s/reward:0.06734528578817844 - timing_s/old_log_prob:1.2913313750177622 - timing_s/ref:1.3902696296572685 - timing_s/adv:0.00788009725511074 - timing_s/update_actor:7.419454017654061 - timing_s/step:76.29681057669222 - timing_s/stop_profile:4.3334439396858215e-05 - timing_per_token_ms/adv:3.606534362393071e-05 - timing_per_token_ms/gen:0.7540428694384353 - timing_per_token_ms/ref:0.0063629356720166065 - timing_per_token_ms/update_actor:0.033957088343687776 - perf/total_num_tokens:218495 - perf/time_per_step:76.29681057669222 - perf/throughput:357.9687642715626
[36m(TaskRunner pid=2922365)[0m step:402 - global_seqlen/min:20270 - global_seqlen/max:29141 - global_seqlen/minmax_diff:8871 - global_seqlen/balanced_min:25923 - global_seqlen/balanced_max:27320 - global_seqlen/mean:26446.875 - actor/entropy:0.041317716240882874 - actor/kl_loss:2.2605261858552694 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03778274804353714 - actor/pg_clipfrac:0.03333842749707401 - actor/ppo_kl:-0.008711060031782836 - actor/pg_clipfrac_lower:0.002889380796113983 - actor/grad_norm:15.916962146759033 - perf/mfu/actor:0.07734967934395004 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.96544647216797 - actor/lr:1e-06 - training/global_step:402 - training/epoch:2 - critic/score/mean:0.8762499690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8762499690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.5701167583465576 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.5701167583465576 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:251.984375 - response_length/max:2048.0 - response_length/min:37.0 - response_length/clip_ratio:0.05937499925494194 - prompt_length/mean:409.1875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.34060662984848e-05 - timing_s/generate_sequences:62.818904876708984 - timing_s/reshard:0.7340104579925537 - timing_s/gen:64.64940175414085 - timing_s/reward:0.06553306989371777 - timing_s/old_log_prob:1.275273371487856 - timing_s/ref:1.3768308516591787 - timing_s/adv:0.007745249196887016 - timing_s/update_actor:7.367129186168313 - timing_s/step:74.75778499618173 - timing_s/stop_profile:4.79184091091156e-05 - timing_per_token_ms/adv:3.6607582166546216e-05 - timing_per_token_ms/gen:0.8017536027052875 - timing_per_token_ms/ref:0.006507530907050354 - timing_per_token_ms/update_actor:0.0348204144448461 - perf/total_num_tokens:211575 - perf/time_per_step:74.75778499618173 - perf/throughput:353.7675039643133
[36m(TaskRunner pid=2922365)[0m step:403 - global_seqlen/min:21671 - global_seqlen/max:37016 - global_seqlen/minmax_diff:15345 - global_seqlen/balanced_min:27774 - global_seqlen/balanced_max:29147 - global_seqlen/mean:27945.625 - actor/entropy:0.03717111051082611 - actor/kl_loss:2.2443479649722575 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.08581694802269339 - actor/pg_clipfrac:0.03769985591061413 - actor/ppo_kl:-0.037538333376869557 - actor/pg_clipfrac_lower:0.009063596709165723 - actor/grad_norm:19.611727476119995 - perf/mfu/actor:0.08058842200906582 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.10619354248047 - actor/lr:1e-06 - training/global_step:403 - training/epoch:2 - critic/score/mean:0.8774999380111694 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8774999380111694 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4360799491405487 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4360799491405487 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:289.890625 - response_length/max:2048.0 - response_length/min:37.0 - response_length/clip_ratio:0.078125 - prompt_length/mean:408.75 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.420141577720642e-05 - timing_s/generate_sequences:63.44538116455078 - timing_s/reshard:0.6510919332504272 - timing_s/gen:66.3580223377794 - timing_s/reward:0.06714908964931965 - timing_s/old_log_prob:1.2920912727713585 - timing_s/ref:1.3862831052392721 - timing_s/adv:0.010353753343224525 - timing_s/update_actor:7.5128916166722775 - timing_s/step:76.64273321442306 - timing_s/stop_profile:4.412606358528137e-05 - timing_per_token_ms/adv:4.631204948549427e-05 - timing_per_token_ms/gen:0.7153346880588519 - timing_per_token_ms/ref:0.006200805605704257 - timing_per_token_ms/update_actor:0.03360495433843525 - perf/total_num_tokens:223565 - perf/time_per_step:76.64273321442306 - perf/throughput:364.62197820916225
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  77%|███████▋  | 404/525 [1:24:02<2:43:48, 81.23s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  77%|███████▋  | 405/525 [1:25:19<2:39:38, 79.82s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  77%|███████▋  | 406/525 [1:26:35<2:36:07, 78.72s/it]
[36m(TaskRunner pid=2922365)[0m step:404 - global_seqlen/min:23509 - global_seqlen/max:32022 - global_seqlen/minmax_diff:8513 - global_seqlen/balanced_min:26911 - global_seqlen/balanced_max:28235 - global_seqlen/mean:27242.375 - actor/entropy:0.03992559388279915 - actor/kl_loss:1.9190108150243759 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.016899360716342925 - actor/pg_clipfrac:0.028626357251778246 - actor/ppo_kl:0.11782513211364858 - actor/pg_clipfrac_lower:0.0014768032706342638 - actor/grad_norm:21.206039786338806 - perf/mfu/actor:0.08044896747376352 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.0101318359375 - actor/lr:1e-06 - training/global_step:404 - training/epoch:2 - critic/score/mean:0.8584375381469727 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8584375381469727 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.41870442032814026 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.41870442032814026 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:271.54376220703125 - response_length/max:2048.0 - response_length/min:53.0 - response_length/clip_ratio:0.05624999850988388 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.210539817810059e-05 - timing_s/generate_sequences:62.50788879394531 - timing_s/reshard:0.6673121452331543 - timing_s/gen:65.25191700644791 - timing_s/reward:0.06663621217012405 - timing_s/old_log_prob:1.192575678229332 - timing_s/ref:1.3812538050115108 - timing_s/adv:0.007726510986685753 - timing_s/update_actor:7.292729448527098 - timing_s/step:75.20829535834491 - timing_s/stop_profile:4.226900637149811e-05 - timing_per_token_ms/adv:3.5452631179760176e-05 - timing_per_token_ms/gen:0.7509369692550454 - timing_per_token_ms/ref:0.006337800049607967 - timing_per_token_ms/update_actor:0.03346225066888945 - perf/total_num_tokens:217939 - perf/time_per_step:75.20829535834491 - perf/throughput:362.22566766336445
[36m(TaskRunner pid=2922365)[0m step:405 - global_seqlen/min:22724 - global_seqlen/max:35068 - global_seqlen/minmax_diff:12344 - global_seqlen/balanced_min:28972 - global_seqlen/balanced_max:30299 - global_seqlen/mean:29470.0 - actor/entropy:0.032203931361436844 - actor/kl_loss:1.8794040851294995 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0959472630172968 - actor/pg_clipfrac:0.020475196151528506 - actor/ppo_kl:-0.08970864807488396 - actor/pg_clipfrac_lower:0.0028071846929378806 - actor/grad_norm:14.523745059967041 - perf/mfu/actor:0.08413994324267686 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.9868392944336 - actor/lr:1e-06 - training/global_step:405 - training/epoch:2 - critic/score/mean:0.8493750691413879 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8493750691413879 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.4013057351112366 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.4013057351112366 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:326.6875 - response_length/max:2048.0 - response_length/min:50.0 - response_length/clip_ratio:0.08437500149011612 - prompt_length/mean:410.0625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.152797818183899e-05 - timing_s/generate_sequences:63.59112548828125 - timing_s/reshard:0.7192490100860596 - timing_s/gen:66.00792724639177 - timing_s/reward:0.07040981017053127 - timing_s/old_log_prob:1.412785142660141 - timing_s/ref:1.42094187438488 - timing_s/adv:0.007567904889583588 - timing_s/update_actor:7.591957015916705 - timing_s/step:76.52672372758389 - timing_s/stop_profile:4.822574555873871e-05 - timing_per_token_ms/adv:3.210003770607223e-05 - timing_per_token_ms/gen:0.6314131169541972 - timing_per_token_ms/ref:0.006027069368785545 - timing_per_token_ms/update_actor:0.03220205724430228 - perf/total_num_tokens:235760 - perf/time_per_step:76.52672372758389 - perf/throughput:385.09423328909094
[36m(TaskRunner pid=2922365)[0m step:406 - global_seqlen/min:24118 - global_seqlen/max:31205 - global_seqlen/minmax_diff:7087 - global_seqlen/balanced_min:26834 - global_seqlen/balanced_max:27912 - global_seqlen/mean:27777.25 - actor/entropy:0.045639827847480774 - actor/kl_loss:1.9961447402834893 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.11765157729387284 - actor/pg_clipfrac:0.04135502278804779 - actor/ppo_kl:0.02303155406843871 - actor/pg_clipfrac_lower:0.005478247994324193 - actor/grad_norm:33.386422634124756 - perf/mfu/actor:0.08179633708718315 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.0398941040039 - actor/lr:1e-06 - training/global_step:406 - training/epoch:2 - critic/score/mean:0.7971875071525574 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7971875071525574 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.40709057450294495 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.40709057450294495 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:284.2593688964844 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:410.171875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.193217217922211e-05 - timing_s/generate_sequences:63.156368255615234 - timing_s/reshard:0.7475407719612122 - timing_s/gen:66.08030561357737 - timing_s/reward:0.06777740642428398 - timing_s/old_log_prob:1.26847480610013 - timing_s/ref:1.3966204151511192 - timing_s/adv:0.007464488968253136 - timing_s/update_actor:7.30222481675446 - timing_s/step:76.1389843672514 - timing_s/stop_profile:4.668906331062317e-05 - timing_per_token_ms/adv:3.3590838583072186e-05 - timing_per_token_ms/gen:0.7264525753721554 - timing_per_token_ms/ref:0.006284911281494385 - timing_per_token_ms/update_actor:0.032860636027479594 - perf/total_num_tokens:222218 - perf/time_per_step:76.1389843672514 - perf/throughput:364.8229646197834
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  78%|███████▊  | 407/525 [1:27:51<2:33:11, 77.90s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  78%|███████▊  | 408/525 [1:29:08<2:31:05, 77.48s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  78%|███████▊  | 409/525 [1:30:24<2:28:54, 77.02s/it]
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 01:51:51,329:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 01:51:57,722:[Rank 6] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/optim_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923977)[0m INFO:2025-08-05 01:51:51,652:[Rank 7] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/model_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 01:51:57,725:[Rank 6] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/extra_state_world_size_8_rank_6.pt
[36m(TaskRunner pid=2922365)[0m step:407 - global_seqlen/min:22544 - global_seqlen/max:32450 - global_seqlen/minmax_diff:9906 - global_seqlen/balanced_min:27561 - global_seqlen/balanced_max:28846 - global_seqlen/mean:28203.875 - actor/entropy:0.0392746664583683 - actor/kl_loss:2.070947901904583 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.09076654314994811 - actor/pg_clipfrac:0.018408992316108198 - actor/ppo_kl:-0.19964821058383678 - actor/pg_clipfrac_lower:0.002674398198723793 - actor/grad_norm:22.91252636909485 - perf/mfu/actor:0.08181378676304739 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.01971435546875 - actor/lr:1e-06 - training/global_step:407 - training/epoch:2 - critic/score/mean:0.872499942779541 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.872499942779541 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.49419108033180237 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.49419108033180237 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:295.47186279296875 - response_length/max:2048.0 - response_length/min:42.0 - response_length/clip_ratio:0.0625 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.053146302700043e-05 - timing_s/generate_sequences:63.66515350341797 - timing_s/reshard:0.6593626141548157 - timing_s/gen:65.79927356727421 - timing_s/reward:0.06791268475353718 - timing_s/old_log_prob:1.2398592382669449 - timing_s/ref:1.3921332526952028 - timing_s/adv:0.007832849398255348 - timing_s/update_actor:7.437311692163348 - timing_s/step:75.95925620384514 - timing_s/stop_profile:4.336424171924591e-05 - timing_per_token_ms/adv:3.4715306842833425e-05 - timing_per_token_ms/gen:0.6959130370622649 - timing_per_token_ms/ref:0.006169955603153835 - timing_per_token_ms/update_actor:0.03296227775511055 - perf/total_num_tokens:225631 - perf/time_per_step:75.95925620384514 - perf/throughput:371.3026747433091
[36m(TaskRunner pid=2922365)[0m step:408 - global_seqlen/min:20907 - global_seqlen/max:40542 - global_seqlen/minmax_diff:19635 - global_seqlen/balanced_min:28087 - global_seqlen/balanced_max:28088 - global_seqlen/mean:28087.25 - actor/entropy:0.04587205871939659 - actor/kl_loss:2.055484640598297 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.11534156948328018 - actor/pg_clipfrac:0.04953145855106413 - actor/ppo_kl:-0.3147150608012453 - actor/pg_clipfrac_lower:0.004084617414628155 - actor/grad_norm:26.640074729919434 - perf/mfu/actor:0.08164792298330038 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.06068801879883 - actor/lr:1e-06 - training/global_step:408 - training/epoch:2 - critic/score/mean:0.9081249237060547 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9081249237060547 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.32613271474838257 - critic/advantages/max:1.7888517379760742 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.32613271474838257 - critic/returns/max:1.7888517379760742 - critic/returns/min:-1.7888517379760742 - response_length/mean:292.2281188964844 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.05000000074505806 - prompt_length/mean:409.953125 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.375065565109253e-05 - timing_s/generate_sequences:62.64976501464844 - timing_s/reshard:0.7091584801673889 - timing_s/gen:66.24332401528955 - timing_s/reward:0.06833965890109539 - timing_s/old_log_prob:1.276938846334815 - timing_s/ref:1.4043772239238024 - timing_s/adv:0.007438149303197861 - timing_s/update_actor:7.405843868851662 - timing_s/step:76.42159035429358 - timing_s/stop_profile:4.6061351895332336e-05 - timing_per_token_ms/adv:3.3102872758982545e-05 - timing_per_token_ms/gen:0.7083862566198234 - timing_per_token_ms/ref:0.006250065527613964 - timing_per_token_ms/update_actor:0.03295910007588702 - perf/total_num_tokens:224698 - perf/time_per_step:76.42159035429358 - perf/throughput:367.5302996154146
[36m(TaskRunner pid=2922365)[0m step:409 - global_seqlen/min:23865 - global_seqlen/max:34624 - global_seqlen/minmax_diff:10759 - global_seqlen/balanced_min:28243 - global_seqlen/balanced_max:29316 - global_seqlen/mean:28377.5 - actor/entropy:0.04649835079908371 - actor/kl_loss:1.9752158656716348 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.02597666680812836 - actor/pg_clipfrac:0.03291726424358785 - actor/ppo_kl:0.06048940628534183 - actor/pg_clipfrac_lower:0.0011481226625619455 - actor/grad_norm:46.4328498840332 - perf/mfu/actor:0.081870737521826 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.04991912841797 - actor/lr:1e-06 - training/global_step:409 - training/epoch:2 - critic/score/mean:0.8268750309944153 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8268750309944153 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.42132148146629333 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.42132148146629333 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:299.703125 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.05312500149011612 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.312985301017761e-05 - timing_s/generate_sequences:62.59172821044922 - timing_s/reshard:0.6552276611328125 - timing_s/gen:65.63970920443535 - timing_s/reward:0.06940214149653912 - timing_s/old_log_prob:1.335217585787177 - timing_s/ref:1.396398600190878 - timing_s/adv:0.007589159533381462 - timing_s/update_actor:7.46770309843123 - timing_s/step:75.93048561550677 - timing_s/stop_profile:4.373863339424133e-05 - timing_per_token_ms/adv:3.3429475523660746e-05 - timing_per_token_ms/gen:0.684424265725826 - timing_per_token_ms/ref:0.006150993745885287 - timing_per_token_ms/update_actor:0.03289447228627975 - perf/total_num_tokens:227020 - perf/time_per_step:75.93048561550677 - perf/throughput:373.7299948757954
[36m(TaskRunner pid=2922365)[0m local_global_step_folder: /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  78%|███████▊  | 410/525 [1:31:51<2:33:22, 80.02s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 01:51:58,518:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/huggingface
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  78%|███████▊  | 411/525 [1:33:07<2:29:44, 78.81s/it]
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 01:51:57,973:[Rank 2] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/optim_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2923972)[0m INFO:2025-08-05 01:51:57,975:[Rank 2] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_410/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  78%|███████▊  | 412/525 [1:34:22<2:26:21, 77.72s/it]
[36m(TaskRunner pid=2922365)[0m step:410 - global_seqlen/min:23365 - global_seqlen/max:33956 - global_seqlen/minmax_diff:10591 - global_seqlen/balanced_min:28825 - global_seqlen/balanced_max:29763 - global_seqlen/mean:29528.5 - actor/entropy:0.04010103642940521 - actor/kl_loss:2.0538374543190003 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.10102387145161629 - actor/pg_clipfrac:0.0350434563588351 - actor/ppo_kl:-0.21830701939179561 - actor/pg_clipfrac_lower:0.0031678285158704966 - actor/grad_norm:33.31238770484924 - perf/mfu/actor:0.0847041381858469 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.05098342895508 - actor/lr:1e-06 - training/global_step:410 - training/epoch:2 - critic/score/mean:0.8121874928474426 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8121874928474426 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.46739426255226135 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.46739426255226135 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:328.6968688964844 - response_length/max:2048.0 - response_length/min:43.0 - response_length/clip_ratio:0.06875000149011612 - prompt_length/mean:409.515625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.614229202270508e-05 - timing_s/generate_sequences:63.62168884277344 - timing_s/reshard:0.6748476624488831 - timing_s/gen:65.52821204997599 - timing_s/reward:0.0704509187489748 - timing_s/old_log_prob:1.414083817973733 - timing_s/ref:1.4051803145557642 - timing_s/adv:0.007933905348181725 - timing_s/update_actor:7.535207891836762 - timing_s/save_checkpoint:10.683238318189979 - timing_s/step:86.66067503765225 - timing_s/stop_profile:4.9404799938201904e-05 - timing_per_token_ms/adv:3.358579570661278e-05 - timing_per_token_ms/gen:0.6229924232050426 - timing_per_token_ms/ref:0.005948407109046193 - timing_per_token_ms/update_actor:0.0318980302582114 - perf/total_num_tokens:236228 - perf/time_per_step:86.66067503765225 - perf/throughput:340.7370181131232
[36m(TaskRunner pid=2922365)[0m step:411 - global_seqlen/min:21624 - global_seqlen/max:32432 - global_seqlen/minmax_diff:10808 - global_seqlen/balanced_min:27311 - global_seqlen/balanced_max:28290 - global_seqlen/mean:27678.0 - actor/entropy:0.047738153487443924 - actor/kl_loss:2.1425329774618147 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.018952663987874985 - actor/pg_clipfrac:0.0283880703849718 - actor/ppo_kl:-0.2778438058216125 - actor/pg_clipfrac_lower:0.0038779519440140576 - actor/grad_norm:22.819172143936157 - perf/mfu/actor:0.08053089223031332 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.24953842163086 - actor/lr:1e-06 - training/global_step:411 - training/epoch:2 - critic/score/mean:0.8996874690055847 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8996874690055847 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.2458406686782837 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.2458406686782837 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:282.21563720703125 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.03437500074505806 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00010211765766143799 - timing_s/generate_sequences:61.41081237792969 - timing_s/reshard:0.6707478761672974 - timing_s/gen:65.45633020997047 - timing_s/reward:0.06794269382953644 - timing_s/old_log_prob:1.2695157043635845 - timing_s/ref:1.384479884058237 - timing_s/adv:0.007589021697640419 - timing_s/update_actor:7.382242098450661 - timing_s/step:75.58399715833366 - timing_s/stop_profile:4.4209882616996765e-05 - timing_per_token_ms/adv:3.4273708801396505e-05 - timing_per_token_ms/gen:0.7248040639357148 - timing_per_token_ms/ref:0.006252618885298058 - timing_per_token_ms/update_actor:0.03333984617047231 - perf/total_num_tokens:221424 - perf/time_per_step:75.58399715833366 - perf/throughput:366.188625113594
[36m(TaskRunner pid=2922365)[0m step:412 - global_seqlen/min:22923 - global_seqlen/max:35402 - global_seqlen/minmax_diff:12479 - global_seqlen/balanced_min:28782 - global_seqlen/balanced_max:29220 - global_seqlen/mean:29165.0 - actor/entropy:0.048964016139507294 - actor/kl_loss:2.03325846940279 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.0860247977077961 - actor/pg_clipfrac:0.02627932159230113 - actor/ppo_kl:-0.22525312766665592 - actor/pg_clipfrac_lower:0.007590199075639248 - actor/grad_norm:35.08866500854492 - perf/mfu/actor:0.0852589679417991 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.22302627563477 - actor/lr:1e-06 - training/global_step:412 - training/epoch:2 - critic/score/mean:0.7465624213218689 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.7465624213218689 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.3758646249771118 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.3758646249771118 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:319.5 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.046875 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.371658623218536e-05 - timing_s/generate_sequences:62.40928268432617 - timing_s/reshard:0.6436600685119629 - timing_s/gen:65.00240178965032 - timing_s/reward:0.07147257961332798 - timing_s/old_log_prob:1.2816483080387115 - timing_s/ref:1.3867783043533564 - timing_s/adv:0.007606986910104752 - timing_s/update_actor:7.3707033805549145 - timing_s/step:75.13750755041838 - timing_s/stop_profile:4.270672798156738e-05 - timing_per_token_ms/adv:3.260323551390687e-05 - timing_per_token_ms/gen:0.635782490117863 - timing_per_token_ms/ref:0.005943675228670308 - timing_per_token_ms/update_actor:0.03159053394717519 - perf/total_num_tokens:233320 - perf/time_per_step:75.13750755041838 - perf/throughput:388.1550100717655
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  79%|███████▊  | 413/525 [1:35:36<2:23:02, 76.63s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  79%|███████▉  | 414/525 [1:36:51<2:21:01, 76.23s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  79%|███████▉  | 415/525 [1:38:05<2:18:43, 75.66s/it]
[36m(TaskRunner pid=2922365)[0m step:413 - global_seqlen/min:24239 - global_seqlen/max:32433 - global_seqlen/minmax_diff:8194 - global_seqlen/balanced_min:28291 - global_seqlen/balanced_max:28735 - global_seqlen/mean:28678.75 - actor/entropy:0.05868251994252205 - actor/kl_loss:2.23149905949831 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.06021502502262592 - actor/pg_clipfrac:0.021676457952708006 - actor/ppo_kl:-0.0995794378221035 - actor/pg_clipfrac_lower:0.0012841935269534588 - actor/grad_norm:35.4983549118042 - perf/mfu/actor:0.08367752250555568 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.10071182250977 - actor/lr:1e-06 - training/global_step:413 - training/epoch:2 - critic/score/mean:0.9325000047683716 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9325000047683716 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.19324906170368195 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.19324906170368195 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:307.34375 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.02187499962747097 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.037500083446503e-05 - timing_s/generate_sequences:61.61722946166992 - timing_s/reshard:0.6492515206336975 - timing_s/gen:63.92543364316225 - timing_s/reward:0.07446324452757835 - timing_s/old_log_prob:1.314180901274085 - timing_s/ref:1.3836284466087818 - timing_s/adv:0.007792236283421516 - timing_s/update_actor:7.3651130478829145 - timing_s/step:74.08627775497735 - timing_s/stop_profile:4.383362829685211e-05 - timing_per_token_ms/adv:3.396345849898233e-05 - timing_per_token_ms/gen:0.6499789897627072 - timing_per_token_ms/ref:0.006030721556068438 - timing_per_token_ms/update_actor:0.032101787246144424 - perf/total_num_tokens:229430 - perf/time_per_step:74.08627775497735 - perf/throughput:387.0993505011564
[36m(TaskRunner pid=2922365)[0m step:414 - global_seqlen/min:23946 - global_seqlen/max:41609 - global_seqlen/minmax_diff:17663 - global_seqlen/balanced_min:30680 - global_seqlen/balanced_max:30763 - global_seqlen/mean:30731.625 - actor/entropy:0.05565763637423515 - actor/kl_loss:1.9519342735409737 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.12034194078296423 - actor/pg_clipfrac:0.02487381352111697 - actor/ppo_kl:0.015441108116647229 - actor/pg_clipfrac_lower:0.003952290554298088 - actor/grad_norm:17.460378170013428 - perf/mfu/actor:0.08914312289989164 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.02786636352539 - actor/lr:1e-06 - training/global_step:414 - training/epoch:2 - critic/score/mean:0.9384374618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9384374618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.06494888663291931 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.06494888663291931 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:358.4468688964844 - response_length/max:2048.0 - response_length/min:46.0 - response_length/clip_ratio:0.015625 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.964670658111572e-05 - timing_s/generate_sequences:57.2684326171875 - timing_s/reshard:0.6678078770637512 - timing_s/gen:65.05977765843272 - timing_s/reward:0.07258668541908264 - timing_s/old_log_prob:1.2824086267501116 - timing_s/ref:1.4045881628990173 - timing_s/adv:0.007660973817110062 - timing_s/update_actor:7.427272753790021 - timing_s/step:75.26865007914603 - timing_s/stop_profile:4.2516738176345825e-05 - timing_per_token_ms/adv:3.116079046060069e-05 - timing_per_token_ms/gen:0.5672020579970247 - timing_per_token_ms/ref:0.005713121917971378 - timing_per_token_ms/update_actor:0.030210218113222213 - perf/total_num_tokens:245853 - perf/time_per_step:75.26865007914603 - perf/throughput:408.29249584900583
[36m(TaskRunner pid=2922365)[0m step:415 - global_seqlen/min:20449 - global_seqlen/max:34400 - global_seqlen/minmax_diff:13951 - global_seqlen/balanced_min:27925 - global_seqlen/balanced_max:27925 - global_seqlen/mean:27925.0 - actor/entropy:0.06198526918888092 - actor/kl_loss:2.239626568555832 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.13637698348611593 - actor/pg_clipfrac:0.029995976062491537 - actor/ppo_kl:0.11863485710928216 - actor/pg_clipfrac_lower:0.0019337957724928855 - actor/grad_norm:26.86684226989746 - perf/mfu/actor:0.08222338530921011 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:94.08695602416992 - actor/lr:1e-06 - training/global_step:415 - training/epoch:2 - critic/score/mean:0.9906250238418579 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9906250238418579 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.14342360198497772 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.14342360198497772 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:289.15625 - response_length/max:2048.0 - response_length/min:49.0 - response_length/clip_ratio:0.02500000037252903 - prompt_length/mean:408.96875 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:0.00011568702757358551 - timing_s/generate_sequences:54.99473571777344 - timing_s/reshard:0.6542841196060181 - timing_s/gen:64.32027381658554 - timing_s/reward:0.06752637028694153 - timing_s/old_log_prob:1.2510990966111422 - timing_s/ref:1.3798155914992094 - timing_s/adv:0.007643435150384903 - timing_s/update_actor:7.299939446151257 - timing_s/step:74.34124831855297 - timing_s/stop_profile:4.678778350353241e-05 - timing_per_token_ms/adv:3.4214123323119526e-05 - timing_per_token_ms/gen:0.6951288643314119 - timing_per_token_ms/ref:0.006176435055949908 - timing_per_token_ms/update_actor:0.03267654183595012 - perf/total_num_tokens:223400 - perf/time_per_step:74.34124831855297 - perf/throughput:375.63264851756463
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  79%|███████▉  | 416/525 [1:39:20<2:17:02, 75.43s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  79%|███████▉  | 417/525 [1:40:37<2:16:21, 75.75s/it]
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  80%|███████▉  | 418/525 [1:41:53<2:15:04, 75.74s/it]
[36m(TaskRunner pid=2922365)[0m step:416 - global_seqlen/min:22116 - global_seqlen/max:32417 - global_seqlen/minmax_diff:10301 - global_seqlen/balanced_min:27327 - global_seqlen/balanced_max:27701 - global_seqlen/mean:27653.625 - actor/entropy:0.05535730719566345 - actor/kl_loss:2.0567741617560387 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:-0.17130124904215335 - actor/pg_clipfrac:0.027067988202907144 - actor/ppo_kl:-0.23837295158882627 - actor/pg_clipfrac_lower:0.00033946161856874825 - actor/grad_norm:19.60924482345581 - perf/mfu/actor:0.08040655143299728 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.96844482421875 - actor/lr:1e-06 - training/global_step:416 - training/epoch:2 - critic/score/mean:0.864687442779541 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.864687442779541 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.19161759316921234 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.19161759316921234 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:281.71563720703125 - response_length/max:2048.0 - response_length/min:47.0 - response_length/clip_ratio:0.02187499962747097 - prompt_length/mean:409.625 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:8.983723819255829e-05 - timing_s/generate_sequences:56.091407775878906 - timing_s/reshard:0.6619857549667358 - timing_s/gen:64.71926661767066 - timing_s/reward:0.06763145513832569 - timing_s/old_log_prob:1.233457526192069 - timing_s/ref:1.3782955780625343 - timing_s/adv:0.007555786520242691 - timing_s/update_actor:7.379950115457177 - timing_s/step:74.80127445049584 - timing_s/stop_profile:4.417635500431061e-05 - timing_per_token_ms/adv:3.4153689255218306e-05 - timing_per_token_ms/gen:0.7179144152200319 - timing_per_token_ms/ref:0.0062301758723428404 - timing_per_token_ms/update_actor:0.03335887300244171 - perf/total_num_tokens:221229 - perf/time_per_step:74.80127445049584 - perf/throughput:369.69457008785884
[36m(TaskRunner pid=2922365)[0m step:417 - global_seqlen/min:23558 - global_seqlen/max:37164 - global_seqlen/minmax_diff:13606 - global_seqlen/balanced_min:28221 - global_seqlen/balanced_max:28594 - global_seqlen/mean:28547.375 - actor/entropy:0.05600530654191971 - actor/kl_loss:2.1434976533055305 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.1913771905004978 - actor/pg_clipfrac:0.04312559977406636 - actor/ppo_kl:0.013786597922444344 - actor/pg_clipfrac_lower:0.00773111674352549 - actor/grad_norm:16.68380641937256 - perf/mfu/actor:0.0832156352985258 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.98530960083008 - actor/lr:1e-06 - training/global_step:417 - training/epoch:2 - critic/score/mean:0.9412500262260437 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.9412500262260437 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.15841571986675262 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.78885018825531 - critic/returns/mean:-0.15841571986675262 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.78885018825531 - response_length/mean:303.84063720703125 - response_length/max:2048.0 - response_length/min:50.0 - response_length/clip_ratio:0.02187499962747097 - prompt_length/mean:409.84375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:7.804296910762787e-05 - timing_s/generate_sequences:56.617103576660156 - timing_s/reshard:0.7425466775894165 - timing_s/gen:66.33763604424894 - timing_s/reward:0.06868087686598301 - timing_s/old_log_prob:1.2891226559877396 - timing_s/ref:1.3948201574385166 - timing_s/adv:0.007597858086228371 - timing_s/update_actor:7.371959222480655 - timing_s/step:76.48529990017414 - timing_s/stop_profile:4.1954219341278076e-05 - timing_per_token_ms/adv:3.3268637161159175e-05 - timing_per_token_ms/gen:0.6822824059102628 - timing_per_token_ms/ref:0.006107479923454068 - timing_per_token_ms/update_actor:0.03227949689980539 - perf/total_num_tokens:228379 - perf/time_per_step:76.48529990017414 - perf/throughput:373.24002177227527
[36m(TaskRunner pid=2922365)[0m step:418 - global_seqlen/min:25946 - global_seqlen/max:35974 - global_seqlen/minmax_diff:10028 - global_seqlen/balanced_min:29521 - global_seqlen/balanced_max:29876 - global_seqlen/mean:29698.375 - actor/entropy:0.049591418355703354 - actor/kl_loss:2.084545776247978 - actor/kl_coef:0.010000000000000002 - actor/pg_loss:0.03790590539574623 - actor/pg_clipfrac:0.028588323015719654 - actor/ppo_kl:0.09055948117747903 - actor/pg_clipfrac_lower:0.005168402672279626 - actor/grad_norm:27.445451736450195 - perf/mfu/actor:0.08646947297474525 - perf/max_memory_allocated_gb:70.61051559448242 - perf/max_memory_reserved_gb:92.947265625 - perf/cpu_memory_used_gb:93.93658828735352 - actor/lr:1e-06 - training/global_step:418 - training/epoch:2 - critic/score/mean:0.8993749618530273 - critic/score/max:1.600000023841858 - critic/score/min:0.0 - critic/rewards/mean:0.8993749618530273 - critic/rewards/max:1.600000023841858 - critic/rewards/min:0.0 - critic/advantages/mean:-0.25283631682395935 - critic/advantages/max:1.7888504266738892 - critic/advantages/min:-1.7888517379760742 - critic/returns/mean:-0.25283631682395935 - critic/returns/max:1.7888504266738892 - critic/returns/min:-1.7888517379760742 - response_length/mean:332.7250061035156 - response_length/max:2048.0 - response_length/min:40.0 - response_length/clip_ratio:0.03750000149011612 - prompt_length/mean:409.734375 - prompt_length/max:414.0 - prompt_length/min:407.0 - prompt_length/clip_ratio:0.0 - timing_s/start_profile:9.16551798582077e-05 - timing_s/generate_sequences:63.261314392089844 - timing_s/reshard:0.6566610336303711 - timing_s/gen:65.42735164053738 - timing_s/reward:0.07197225093841553 - timing_s/old_log_prob:1.29748897254467 - timing_s/ref:1.3935969211161137 - timing_s/adv:0.007783541455864906 - timing_s/update_actor:7.405275035649538 - timing_s/step:75.61869741789997 - timing_s/stop_profile:4.416331648826599e-05 - timing_per_token_ms/adv:3.276080532968936e-05 - timing_per_token_ms/gen:0.6145028894031987 - timing_per_token_ms/ref:0.0058656278378703955 - timing_per_token_ms/update_actor:0.031168687830771626 - perf/total_num_tokens:237587 - perf/time_per_step:75.61869741789997 - perf/throughput:392.73851592384074
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  80%|███████▉  | 419/525 [1:43:08<2:13:47, 75.73s/it]
[36m(WorkerDict pid=2923976)[0m INFO:2025-08-05 02:04:35,978:[Rank 6] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_420/actor/model_world_size_8_rank_6.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 02:04:42,376:[Rank 0] Saved optim to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_420/actor/optim_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 02:04:42,378:[Rank 0] Saved extra_state to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_420/actor/extra_state_world_size_8_rank_0.pt
[36m(WorkerDict pid=2923974)[0m INFO:2025-08-05 02:04:36,189:[Rank 4] Saved model to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_420/actor/model_world_size_8_rank_4.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2922365)[0m 
Training Progress:  80%|████████  | 420/525 [1:44:35<2:18:18, 79.03s/it]
[36m(WorkerDict pid=2923707)[0m INFO:2025-08-05 02:04:42,956:[Rank 0] Saved model config and tokenizer class to /gemini/platform/public/NLP/model/project_model/math/ckpts/global_step_420/actor/huggingface
